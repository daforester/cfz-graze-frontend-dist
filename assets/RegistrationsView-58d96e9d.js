import{p as bt,n as Vt,e as ve,t as ge,c as Nt,G as Lt,v as t,H as N,x as xe,I as le,a0 as Te,a1 as we,r as _,K as _e,M as s,N as H,O as o,a3 as Ee,W as q,a2 as Ke,a4 as Z,S as j,w as ne,X as b,Q as k,V as p,P as Y,_ as $e,ab as kt,E as tt,k as Ft,f as Pt,d as wt,o as $t,ac as at,Y as ct,Z as vt,a6 as Gt,a5 as Bt}from"./index-163a1676.js";import{e as Yt,T as Ht,d as xt,c as qt}from"./FormRenderer.vue_vue_type_style_index_0_lang-5adf741c.js";import{a as jt,F as Ae}from"./form-29fd1dbb.js";import{_ as Ge}from"./ModelDialog.vue_vue_type_script_setup_true_lang-a8c83da7.js";import{m as Kt,k as Qt,l as zt,n as Wt,o as Jt,p as Xt,q as Zt,u as ea,r as ta,s as aa,t as oa,v as na,w as la,x as ia,y as sa,z as ot,A as nt,B as lt,a as ua,_ as ra,f as it,c as _t,d as At,e as Ut,b as Tt,V as Et,g as da,h as ma,i as ca,j as va}from"./VWindowItem-85b86832.js";import{V as ee,a as F}from"./VRow-fc81447a.js";import{V as Ue}from"./VTextField-8e86d662.js";import{V as oe}from"./copyToClipboard-bc29e8eb.js";import{u as _a,j as Ce,V as Aa}from"./VContainer-f183f1df.js";import{V as Ua,u as ze}from"./VCheckbox-e19ba833.js";import{v as he}from"./v4-a960c1f4.js";import{h as Fe,b as Ta,a as Ea,c as fa,d as Sa,P as ft,u as St}from"./useDisplayTransactions-55f30f02.js";import{V as Pe,a as Ne}from"./VList-b4913f8e.js";import{V as se}from"./VBtn-6fb503a0.js";import{b as pt,c as st}from"./submission-9dd916bb.js";import{V as pa}from"./VAvatar-898e9ee1.js";import{c as Ra,e as Rt,V as Da}from"./VCard-4ded4460.js";import{V as Ia}from"./VDialog-28e6e779.js";import{s as ya}from"./sortSubmissions-8ed80f07.js";import{V as Dt,a as ga}from"./scopeId-c6d152b2.js";import{_ as Qe}from"./SaveButton.vue_vue_type_script_setup_true_lang-775050ad.js";import{u as qe}from"./nil-d01db1aa.js";import{V as Oa}from"./VToolbar-4bdbbb78.js";import{V as ut,a as Ca}from"./VTable-bfc0ab8f.js";import"./index-26b71cef.js";import"./VTextarea-66fc3bc4.js";import"./forwardRefs-ef567e1b.js";import"./VChip-70a7e3d1.js";import"./userData-23482a0e.js";import"./VForm-e9a5228d.js";import"./VToolbarItems-6d597805.js";import"./VDivider-cc781c24.js";import"./createSimpleFunctional-8582d001.js";var It=(e=>(e.ADMIN_LAYOUT_PANELS="ADMIN_LAYOUT_PANELS",e.ADMIN_LAYOUT_TABLE="ADMIN_LAYOUT_TABLE",e))(It||{});const ha=[{title:"Panel Layout",value:"ADMIN_LAYOUT_PANELS"},{title:"Table Layout",value:"ADMIN_LAYOUT_TABLE"}];var Le=(e=>(e.LAYOUT_ITEM_SOURCE_FORM="LAYOUT_ITEM_SOURCE_FORM",e.LAYOUT_ITEM_SOURCE_META="LAYOUT_ITEM_SOURCE_META",e.LAYOUT_ITEM_SOURCE_USER="LAYOUT_ITEM_SOURCE_USER",e))(Le||{});const Ma=[{title:"Form Field Submission Data",value:"LAYOUT_ITEM_SOURCE_FORM"},{title:"Miscellaneous Data",value:"LAYOUT_ITEM_SOURCE_META"},{title:"User Profile Data",value:"LAYOUT_ITEM_SOURCE_USER"}];var K=(e=>(e.META_DATA_SOURCE_ACCOMMODATION_ALLOCATION="META_DATA_SOURCE_ACCOMMODATION_ALLOCATION",e.META_DATA_SOURCE_ACCOMMODATION_FORM="META_DATA_SOURCE_ACCOMMODATION_FORM",e.META_DATA_SOURCE_BADGE_FORM="META_DATA_SOURCE_BADGE_FORM",e.META_DATA_SOURCE_DEALER_FORM="META_DATA_SOURCE_DEALER_FORM",e.META_DATA_SOURCE_PAYMENT_STATUS="META_DATA_SOURCE_PAYMENT_STATUS",e.META_DATA_SOURCE_REGISTRATION_ACTIONS="META_DATA_SOURCE_REGISTRATION_ACTIONS",e.META_DATA_SOURCE_REGISTRATION_FORM="META_DATA_SOURCE_REGISTRATION_FORM",e.META_DATA_SOURCE_REGISTRATION_GROUP="META_DATA_SOURCE_REGISTRATION_GROUP",e.META_DATA_SOURCE_REGISTRATION_REFERENCE="META_DATA_SOURCE_REGISTRATION_REFERENCE",e.META_DATA_SOURCE_SUBMISSION_DATE="META_DATA_SOURCE_SUBMISSION_DATE",e.META_DATA_SOURCE_SUBMISSION_STATUS="META_DATA_SOURCE_SUBMISSION_STATUS",e))(K||{});const ba=[{title:"Accommodation Allocation",value:"META_DATA_SOURCE_ACCOMMODATION_ALLOCATION"},{title:"Accommodation Form",value:"META_DATA_SOURCE_ACCOMMODATION_FORM"},{title:"Actions",value:"META_DATA_SOURCE_REGISTRATION_ACTIONS"},{title:"Badge Form",value:"META_DATA_SOURCE_BADGE_FORM"},{title:"Dealer Form",value:"META_DATA_SOURCE_DEALER_FORM"},{title:"Payment Status",value:"META_DATA_SOURCE_PAYMENT_STATUS"},{title:"Registration Group",value:"META_DATA_SOURCE_REGISTRATION_GROUP"},{title:"Registration Reference",value:"META_DATA_SOURCE_REGISTRATION_REFERENCE"},{title:"Registration Form",value:"META_DATA_SOURCE_REGISTRATION_FORM"},{title:"Submission Date",value:"META_DATA_SOURCE_SUBMISSION_DATE"},{title:"Submission Status",value:"META_DATA_SOURCE_SUBMISSION_STATUS"}];var X=(e=>(e.USER_DATA_SOURCE_NULL="",e.USER_DATA_SOURCE_DISPLAY_NAME="USER_DATA_SOURCE_DISPLAY_NAME",e.USER_DATA_SOURCE_HANDLE="USER_DATA_SOURCE_HANDLE",e.USER_DATA_SOURCE_AVATAR="USER_DATA_SOURCE_AVATAR",e.USER_DATA_SOURCE_FIRST_NAME="USER_DATA_SOURCE_FIRST_NAME",e.USER_DATA_SOURCE_LAST_NAME="USER_DATA_SOURCE_LAST_NAME",e.USER_DATA_SOURCE_DATE_OF_BIRTH="USER_DATA_SOURCE_DATE_OF_BIRTH",e.USER_DATA_SOURCE_EMAIL="USER_DATA_SOURCE_EMAIL",e.USER_DATA_SOURCE_TELEGRAM="USER_DATA_SOURCE_TELEGRAM",e))(X||{});const Va=[{title:"Display Name",value:"USER_DATA_SOURCE_DISPLAY_NAME"},{title:"Handle",value:"USER_DATA_SOURCE_HANDLE"},{title:"Avatar",value:"USER_DATA_SOURCE_AVATAR"},{title:"First Name",value:"USER_DATA_SOURCE_FIRST_NAME"},{title:"Last Name",value:"USER_DATA_SOURCE_LAST_NAME"},{title:"Date of Birth",value:"USER_DATA_SOURCE_DATE_OF_BIRTH"},{title:"Email Address",value:"USER_DATA_SOURCE_EMAIL"},{title:"Telegram Username",value:"USER_DATA_SOURCE_TELEGRAM"}],Na=e=>{switch(e){case"EMAIL_STATUS_QUEUED":return"Queued";case"EMAIL_STATUS_SENDING":return"Sending";case"EMAIL_STATUS_SENT":return"Sent";case"EMAIL_STATUS_SEND_ERROR":return"Send Error"}return"Unknown"},La=bt({itemsLength:{type:[Number,String],required:!0},...Kt(),...Qt(),...zt()},"VDataTableServer"),ka=Vt()({name:"VDataTableServer",props:La(),emits:{"update:modelValue":e=>!0,"update:page":e=>!0,"update:itemsPerPage":e=>!0,"update:sortBy":e=>!0,"update:options":e=>!0,"update:expanded":e=>!0,"update:groupBy":e=>!0,"click:row":(e,E)=>!0},setup(e,E){let{emit:u,slots:n}=E;const{groupBy:l}=Wt(e),{sortBy:i,multiSort:T,mustSort:m}=Jt(e),{page:f,itemsPerPage:R}=Xt(e),S=ve(()=>parseInt(e.itemsLength,10)),{columns:a,headers:r}=Zt(e,{groupBy:l,showSelect:ge(e,"showSelect"),showExpand:ge(e,"showExpand")}),{items:A}=ea(e,a),{toggleSort:c}=ta({sortBy:i,multiSort:T,mustSort:m,page:f}),{opened:V,isGroupOpen:v,toggleGroup:O,extractRows:y}=aa({groupBy:l,sortBy:i}),{pageCount:G,setItemsPerPage:Q}=oa({page:f,itemsPerPage:R,itemsLength:S}),{flatItems:ie}=na(A,l,V),{isSelected:fe,select:Se,selectAll:h,toggleSelect:M,someSelected:L,allSelected:I}=la(e,{allItems:A,currentPage:A}),{isExpanded:$,toggleExpand:W}=ia(e),te=ve(()=>y(A.value));sa({page:f,itemsPerPage:R,sortBy:i,groupBy:l,search:ge(e,"search")}),Nt("v-data-table",{toggleSort:c,sortBy:i}),Lt({VDataTableRows:{hideNoData:ge(e,"hideNoData"),noDataText:ge(e,"noDataText"),loading:ge(e,"loading"),loadingText:ge(e,"loadingText")}});const z=ve(()=>({page:f.value,itemsPerPage:R.value,sortBy:i.value,pageCount:G.value,toggleSort:c,setItemsPerPage:Q,someSelected:L.value,allSelected:I.value,isSelected:fe,select:Se,selectAll:h,toggleSelect:M,isExpanded:$,toggleExpand:W,isGroupOpen:v,toggleGroup:O,items:te.value,groupedItems:ie.value,columns:a.value,headers:r.value}));_a(()=>{const[de]=ot.filterProps(e),[ue]=nt.filterProps(e),[pe]=lt.filterProps(e),[Re]=ut.filterProps(e);return t(ut,xe({class:["v-data-table",{"v-data-table--loading":e.loading},e.class],style:e.style},Re),{top:()=>{var De;return(De=n.top)==null?void 0:De.call(n,z.value)},default:()=>{var De,Me,be,ke;return n.default?n.default(z.value):t(N,null,[(De=n.colgroup)==null?void 0:De.call(n,z.value),t("thead",{class:"v-data-table__thead",role:"rowgroup"},[t(nt,xe(ue,{sticky:e.fixedHeader}),n)]),(Me=n.thead)==null?void 0:Me.call(n,z.value),t("tbody",{class:"v-data-table__tbody",role:"rowgroup"},[n.body?n.body(z.value):t(lt,xe(pe,{items:ie.value}),n)]),(be=n.tbody)==null?void 0:be.call(n,z.value),(ke=n.tfoot)==null?void 0:ke.call(n,z.value)])},bottom:()=>n.bottom?n.bottom(z.value):t(ot,de,{prepend:n["footer.prepend"]})})})}}),Fa=le({__name:"EditAdminLayout",props:Te({title:{default:""},layout:{}},{modelValue:{type:Boolean,required:!0}}),emits:Te(["save"],["update:modelValue"]),setup(e,{emit:E}){const u=we(e,"modelValue"),n=_(_e(e.layout)),l=_([]),i=Ee(),T=({callback:S})=>{const a=()=>{S&&S("Failed to Save Layout")},r=()=>{S&&S("Layout Saved")};i.saveAdminLayout(n.value).then(A=>{A?(r(),E("save",A)):a()}).catch(()=>{a()})},m=()=>({ID:0,LayoutPanelUUID:he(),AdminLayoutID:n.value.ID,AdminLayoutUUID:n.value.AdminLayoutUUID,Name:"",Order:n.value.Panels.length+1,Items:[],RequiredFormType:Ae.FORM_TYPE_NIL,RequiredGroupMemberships:[],RequiredRegistrationTags:[]}),f=S=>()=>({ID:0,LayoutItemUUID:he(),LayoutPanelID:S.ID,LayoutPanelUUID:S.LayoutPanelUUID,Label:"",SourceType:Le.LAYOUT_ITEM_SOURCE_FORM,SectionFieldID:void 0,SectionFieldUUID:void 0,SectionField:void 0,MetaField:void 0,UserField:void 0,Align:"",Order:S.Items.length+1,DefaultSort:!1}),R=S=>{const a=l.value.find(r=>r.value===S.SectionFieldUUID);a&&(S.SectionFieldID=a.object.ID,S.SectionField=a.object)};return i.getConventionForms(e.layout.ConventionUUID).then(S=>{S.forEach(a=>a.Sections.forEach(r=>r.Fields&&l.value.push(...r.Fields.map(A=>{var V;return{title:`${a.Name} - ${r.Name} - ${(V=A.Field)==null?void 0:V.Name}`,value:A.SectionFieldUUID,object:A}})))),l.value.sort(Yt("title"))}),(S,a)=>(s(),H(Ge,{modelValue:u.value,"onUpdate:modelValue":a[3]||(a[3]=r=>u.value=r),onSave:T,title:S.title,color:"primary"},{default:o(()=>[t(Ce,{class:"px-0 mx-0",fluid:!0},{default:o(()=>[t(ee,null,{default:o(()=>[t(F,{cols:"12",sm:"6"},{default:o(()=>[t(Ue,{modelValue:n.value.Name,"onUpdate:modelValue":a[0]||(a[0]=r=>n.value.Name=r),label:"Name",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),t(F,{cols:"12",sm:"6"},{default:o(()=>[t(oe,{modelValue:n.value.Type,"onUpdate:modelValue":a[1]||(a[1]=r=>n.value.Type=r),label:"Layout Type",items:q(ha),"item-title":"title","item-value":"value",variant:"outlined","hide-details":""},null,8,["modelValue","items"])]),_:1})]),_:1})]),_:1}),t(it,{modelValue:n.value.Panels,"onUpdate:modelValue":a[2]||(a[2]=r=>n.value.Panels=r),"new-item":m,closeable:!1,title:"Panels",label:"Name","slot-name-prefix":"panel"},Ke({_:2},[Z(n.value.Panels,(r,A)=>({name:`panel_${A}`,fn:o(()=>[t(Ce,{class:"px-0 mx-0",fluid:!0},{default:o(()=>[t(ee,null,{default:o(()=>[t(F,{cols:"12",sm:"6"},{default:o(()=>[t(Ue,{modelValue:r.Name,"onUpdate:modelValue":c=>r.Name=c,label:"Name",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),t(F,{cols:"12",sm:"6"},{default:o(()=>[t(oe,{modelValue:r.RequiredFormType,"onUpdate:modelValue":c=>r.RequiredFormType=c,items:q(jt),clearable:!0,label:"Required Form",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"])]),_:2},1024)]),_:2},1024),t(ee,null,{default:o(()=>[t(F,{cols:"12",sm:"6"},{default:o(()=>[t(ua,{label:"Required Groups",variant:"outlined",modelValue:r.RequiredGroupMemberships,"onUpdate:modelValue":c=>r.RequiredGroupMemberships=c,convention:n.value.ConventionUUID,chips:"",clearable:"",hint:"Groups that a user must be in to see this form. (Any one)"},null,8,["modelValue","onUpdate:modelValue","convention"])]),_:2},1024),t(F,{cols:"12",sm:"6"},{default:o(()=>[t(ra,{label:"Registration Tags",variant:"outlined",modelValue:r.RequiredRegistrationTags,"onUpdate:modelValue":c=>r.RequiredRegistrationTags=c,convention:n.value.ConventionUUID,chips:"",clearable:"",hint:"Tags that a registration must have to appear in results. (Any one)"},null,8,["modelValue","onUpdate:modelValue","convention"])]),_:2},1024)]),_:2},1024)]),_:2},1024),t(it,{modelValue:r.Items,"onUpdate:modelValue":c=>r.Items=c,"new-item":f(r),closeable:!1,title:"Items",label:"Label","slot-name-prefix":"item"},Ke({_:2},[Z(r.Items,(c,V)=>({name:`item_${V}`,fn:o(()=>[t(Ce,{class:"px-0 mx-0",fluid:!0},{default:o(()=>[t(ee,null,{default:o(()=>[t(F,{cols:"12",sm:"6"},{default:o(()=>[t(Ue,{modelValue:c.Label,"onUpdate:modelValue":v=>c.Label=v,label:"Name",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024),t(ee,null,{default:o(()=>[t(F,{cols:"12",sm:"6"},{default:o(()=>[t(oe,{modelValue:c.SourceType,"onUpdate:modelValue":v=>c.SourceType=v,label:"Source Type",items:q(Ma),"item-title":"title","item-value":"value",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"])]),_:2},1024),t(F,{cols:"12",sm:"6"},{default:o(()=>[c.SourceType==="LAYOUT_ITEM_SOURCE_FORM"?(s(),H(oe,{key:0,modelValue:c.SectionFieldUUID,"onUpdate:modelValue":v=>c.SectionFieldUUID=v,label:"Form Data",items:l.value,"item-title":"title","item-value":"value",variant:"outlined","hide-details":"",onBlur:v=>R(c)},null,8,["modelValue","onUpdate:modelValue","items","onBlur"])):c.SourceType==="LAYOUT_ITEM_SOURCE_META"?(s(),H(oe,{key:1,modelValue:c.MetaField,"onUpdate:modelValue":v=>c.MetaField=v,label:"Miscellaneous Data",items:q(ba),"item-title":"title","item-value":"value",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"])):c.SourceType==="LAYOUT_ITEM_SOURCE_USER"?(s(),H(oe,{key:2,modelValue:c.UserField,"onUpdate:modelValue":v=>c.UserField=v,label:"User Profile Data",items:q(Va),"item-title":"title","item-value":"value",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"])):j("",!0)]),_:2},1024)]),_:2},1024),t(ee,null,{default:o(()=>[t(F,null,{default:o(()=>[t(Ua,{modelValue:c.DefaultSort,"onUpdate:modelValue":v=>c.DefaultSort=v,label:"Default Sort","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)]),_:2},1024)])}))]),1032,["modelValue","onUpdate:modelValue","new-item"])])}))]),1032,["modelValue"])]),_:1},8,["modelValue","title"]))}}),Pa=b("br",null,null,-1),wa=b("h3",null,"Assigned Accommodation",-1),$a=b("br",null,null,-1),Ga=b("br",null,null,-1),Ba=b("h3",null,"Accommodation Preferences",-1),Ya=b("h3",null,"Selected Tickets",-1),Ha=b("br",null,null,-1),xa=le({__name:"EditAccommodationAssignmentDialog",props:Te({convention:{},registration:{},selectedAccommodation:{},title:{}},{modelValue:{type:Boolean,required:!0}}),emits:Te(["update:field"],["update:modelValue"]),setup(e,{emit:E}){const u=e,{convention:n,registration:l,title:i=""}=u,T=Ee(),m=we(e,"modelValue"),f=_({capacity:{max:h=>{var I;const M=G.value.find($=>$.room.RoomUUID===h);return!M||M.room.MaximumCapacity===0?!0:(((I=r.value)==null?void 0:I.Members.length)||0)<=M.room.MaximumCapacity||"Too many people in the group for this room"},min:h=>{var I;const M=G.value.find($=>$.room.RoomUUID===h);return!M||M.room.MinimumCapacity===0?!0:(((I=r.value)==null?void 0:I.Members.length)||0)>=M.room.MinimumCapacity||"Not enough people in the group for this room"}}}),R=_([]),S=ze(u,E,void 0,void 0,"field"),a=_(_e(S.value));ne(S,()=>{a.value=_e(S.value)});const r=_(),A=_(""),c=_(""),V=_([]),v=_({Ticket:[],AddonsChecked:[],ComponentsChecked:[]}),O=async()=>{var I;const h=await T.getConventionAvailableAccommodation(n.ConventionUUID);h&&(R.value=h);const M=await T.getRegistrationGroup(l.RegistrationUUID||"");M&&(r.value=M);const L=await T.getConventionTickets(n.ConventionUUID);L&&(V.value=L);try{v.value=JSON.parse(((I=r.value)==null?void 0:I.TicketData)||"")}catch{}};ne(A,()=>{c.value=G.value.length>0?G.value[0].value:""});const y=ve(()=>{const h=Q.value;return R.value.map(M=>{let L;return h.forEach(I=>{M.Costs.forEach($=>{$.DateStart===(I==null?void 0:I.DateStart)&&$.DateEnd===I.DateEnd&&(L===void 0||L>$.Availability)&&(L=$.Availability)})}),{label:`${M.Name}`,title:`${M.Name} (${L} Available)`,value:M.AccommodationUUID}})}),G=ve(()=>{const h=Q.value,M=R.value.find(L=>L.AccommodationUUID===A.value);return(M==null?void 0:M.Pool.map(L=>{var $,W;let I;return h.forEach(te=>{L.Costs.forEach(z=>{z.DateStart===(te==null?void 0:te.DateStart)&&z.DateEnd===te.DateEnd&&(I===void 0||I>z.Availability)&&(I=z.Availability)})}),{label:`${($=L.Venue)==null?void 0:$.Name} - ${L.Name}`,title:`${(W=L.Venue)==null?void 0:W.Name} - ${L.Name} (${I} Available)`,value:L.RoomUUID,room:L}}))||[]}),Q=ve(()=>[...v.value.Ticket,...v.value.AddonsChecked,...v.value.ComponentsChecked].map(h=>V.value.find(M=>M.TicketUUID===h)).filter(h=>h!==void 0&&h.RequiresAccommodation)),ie=h=>{var M;T.assignAccommodation(((M=r.value)==null?void 0:M.Registration.RegistrationUUID)||"",A.value,c.value,!1).then(L=>{L?(O(),h&&h("Room Assigned")):h&&h("Room not assigned")}).catch(()=>{h&&h("Room not assigned")})},fe=h=>{var M,L;(M=r.value)!=null&&M.Registration.AllocationUUID?T.deleteAllocation(((L=r.value)==null?void 0:L.Registration.AllocationUUID)||"").then(I=>{I?(O(),h&&h("Allocation Deleted")):h&&h("Allocation not deleted")}).catch(()=>{h&&h("Allocation not deleted")}):h&&h("Nothing to Delete")},Se=h=>{var L,I;const M=(L=R.value.find($=>$.AccommodationUUID===h.AccommodationUUID))==null?void 0:L.Pool;if(M){const $=M.find(W=>W.RoomUUID===h.RoomUUID);if($)return`${(I=$.Venue)==null?void 0:I.Name} - ${$.Name}`}return""};return O(),(h,M)=>{var L;return s(),H(Ge,{modelValue:m.value,"onUpdate:modelValue":M[2]||(M[2]=I=>m.value=I),title:q(i),color:"primary","show-close-action":!0,"show-delete-action":!!((L=r.value)!=null&&L.Registration.Allocation),"show-save-action":!!c.value,"save-button-label":"Assign Room",onDelete:fe,onSave:ie},{default:o(()=>[t(Ce,{class:"pa-0",fluid:!0},{default:o(()=>[t(ee,null,{default:o(()=>{var I;return[t(F,{cols:"12",md:"6"},{default:o(()=>{var $,W;return[b("h3",null,"Group Members ("+k(($=r.value)==null?void 0:$.Members.length)+")",1),(s(!0),p(N,null,Z((W=r.value)==null?void 0:W.Members,te=>(s(),p(N,{key:te.UUID},[Y(" #"+k(te.Reference)+" "+k(te.Name),1),Pa],64))),128))]}),_:1}),(I=r.value)!=null&&I.Registration.Allocation?(s(),H(F,{key:0,cols:"12",md:"6"},{default:o(()=>[wa,t(Pe,null,{default:o(()=>{var $;return[(s(!0),p(N,null,Z(($=r.value)==null?void 0:$.Registration.Allocation.Periods,W=>(s(),H(Ne,{key:W.AllocationPeriodUUID},{default:o(()=>{var te;return[Y(k((te=R.value.find(z=>z.AccommodationUUID===W.AccommodationUUID))==null?void 0:te.Name)+" ",1),$a,Y(" "+k(Se(W))+" ",1),Ga,b("small",null,"("+k(q(Fe)(W.DateStart))+" - "+k(q(Fe)(W.DateEnd))+")",1)]}),_:2},1024))),128))]}),_:1})]),_:1})):j("",!0)]}),_:1}),t(ee,null,{default:o(()=>[t(F,{cols:"12",md:"6"},{default:o(()=>[h.selectedAccommodation.length?(s(),p(N,{key:0},[Ba,t(Pe,null,{default:o(()=>[(s(!0),p(N,null,Z(h.selectedAccommodation,(I,$)=>(s(),H(Ne,{key:I.AccommodationUUID},{default:o(()=>[Y(k($+1)+". "+k(I.Name),1)]),_:2},1024))),128))]),_:1})],64)):j("",!0)]),_:1}),t(F,{cosl:"12",md:"6"},{default:o(()=>[Ya,t(Pe,null,{default:o(()=>[(s(!0),p(N,null,Z(Q.value,I=>(s(),H(Ne,{key:I==null?void 0:I.TicketUUID},{default:o(()=>[Y(k(I.Name)+" ",1),Ha,b("small",null,"("+k(q(Fe)(I.DateStart))+" - "+k(q(Fe)(I.DateEnd))+")",1)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1}),t(ee,null,{default:o(()=>[t(F,{cols:"12",md:"6"},{default:o(()=>[t(oe,{modelValue:A.value,"onUpdate:modelValue":M[0]||(M[0]=I=>A.value=I),items:y.value,"item-title":"title","item-value":"value",label:"Accommodation"},null,8,["modelValue","items"])]),_:1}),t(F,{cols:"12",md:"6"},{default:o(()=>[t(oe,{modelValue:c.value,"onUpdate:modelValue":M[1]||(M[1]=I=>c.value=I),items:G.value,"item-title":"title","item-value":"value",label:"Room Pool",rules:[f.value.capacity.min,f.value.capacity.max]},null,8,["modelValue","items","rules"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue","title","show-delete-action","show-save-action"])}}}),qa={key:0,class:"accommodationList"},ja={key:0,class:"text-orange-darken-2"},Ka=le({__name:"DataTableItemAccommodation",props:{accommodations:{default:()=>[]},convention:{},registration:{},value:{default:""},venues:{}},setup(e){const E=_(!1),u=ve(()=>{if(!e.value)return[];const n=JSON.parse(e.value),l=e.accommodations.filter(i=>n.includes(i.AccommodationUUID)).sort((i,T)=>{const m=n.findIndex(R=>R===i.AccommodationUUID),f=n.findIndex(R=>R===T.AccommodationUUID);return m>f?1:-1});return _e(l)});return(n,l)=>(s(),p(N,null,[n.value?(s(),p("ol",qa,[(s(!0),p(N,null,Z(u.value,i=>(s(),p("li",{key:i.AccommodationUUID},[n.registration&&n.registration.Allocation&&n.registration.Allocation.Periods.find(T=>T.AccommodationUUID===i.AccommodationUUID)?(s(),p("strong",ja,k(i.Name),1)):(s(),p(N,{key:1},[Y(k(i.Name),1)],64))]))),128))])):j("",!0),t(se,{onClick:l[0]||(l[0]=i=>E.value=!0),variant:"flat",color:"success"},{default:o(()=>[Y("Assign Accommodation")]),_:1}),n.convention&&E.value?(s(),H(xa,{key:1,modelValue:E.value,"onUpdate:modelValue":l[1]||(l[1]=i=>E.value=i),title:"Accommodation Allocation",convention:n.convention,registration:n.registration,"selected-accommodation":u.value},null,8,["modelValue","convention","registration","selected-accommodation"])):j("",!0)],64))}});const Qa=$e(Ka,[["__scopeId","data-v-c426aacc"]]),za={key:0,class:"addonList"},Wa={key:0},Ja={key:0},Xa=le({__name:"DataTableItemExtras",props:{extras:{default:()=>[]},value:{default:""}},setup(e){const E=ve(()=>{if(!e.value)return;const u=JSON.parse(e.value),n=Object.keys(u),l=_e(e.extras);return l.forEach(i=>{i.Options=i.Options.filter(T=>n.includes(T.OptionUUID)?(T.Choices=T.Choices.filter(m=>m.TagUUID===u[T.OptionUUID].choiceId),u[T.OptionUUID].checked):!1)}),l.filter(i=>i.Options.length>0),l});return(u,n)=>u.value?(s(),p("ul",za,[(s(!0),p(N,null,Z(E.value,l=>(s(),p(N,{key:l.ExtraUUID},[l.Options.length?(s(),p("li",Wa,[b("strong",null,k(l.Name),1),b("ul",null,[(s(!0),p(N,null,Z(l.Options,i=>(s(),p("li",{key:i.OptionUUID},[Y(k(i.Name)+" ",1),i.Choices.length==1?(s(),p("small",Ja,"("+k(i.Choices[0].Title)+")",1)):j("",!0)]))),128))])])):j("",!0)],64))),128))])):j("",!0)}});const Za=$e(Xa,[["__scopeId","data-v-55786e01"]]),eo={key:0},to=le({__name:"DataTableItemInterests",props:{interests:{default:()=>[]},value:{default:""}},setup(e){const E=ve(()=>{if(!e.value)return;const u=JSON.parse(e.value);return Object.entries(u).filter(([,n])=>n).map(([n,l])=>e.interests.find(i=>i.InterestUUID===n)).filter(n=>n!==void 0)});return(u,n)=>u.value?(s(),p("ul",eo,[(s(!0),p(N,null,Z(E.value,l=>(s(),p("li",{key:l.InterestUUID},k(l.Name),1))),128))])):j("",!0)}}),ao=b("br",null,null,-1),oo=b("small",null,"Options:",-1),no=b("br",null,null,-1),lo=b("small",null,"Addons:",-1),io=le({__name:"DataTableItemTicket",props:{tickets:{default:()=>[]},value:{default:""}},setup(e){const E=ve(()=>{if(!e.value)return;let u={Ticket:[],AddonsChecked:[],ComponentsChecked:[]};try{u=JSON.parse(e.value),"ticket"in u&&(u.Ticket=u.ticket),"addonsChecked"in u&&(u.AddonsChecked=u.addonsChecked),"componentsChecked"in u&&(u.ComponentsChecked=u.componentsChecked)}catch{}return u.Ticket.filter(n=>{const l=e.tickets.find(i=>i.TicketUUID===n);return!(!l||l.Type!==Ht.TICKET_TYPE_TICKET)}).map(n=>{const l=e.tickets.find(T=>T.TicketUUID===n),i=_e(l);return i.TicketComponents=l.TicketComponents.filter(T=>u.ComponentsChecked.includes(T.TicketUUID)),i.AddonTickets=l.AddonTickets.filter(T=>u.AddonsChecked.includes(T.TicketUUID)),i})});return(u,n)=>u.value?(s(!0),p(N,{key:0},Z(E.value,l=>(s(),p("div",{key:l.TicketUUID},[b("strong",null,k(l.Name),1),l.TicketComponents.length>0?(s(),p(N,{key:0},[ao,oo,Y("  "),(s(!0),p(N,null,Z(l.TicketComponents,i=>(s(),p(N,{key:i.TicketUUID},[b("small",null,k(i.Name),1),Y("  ")],64))),128))],64)):j("",!0),l.AddonTickets.length>0?(s(),p(N,{key:1},[no,lo,Y("  "),(s(!0),p(N,null,Z(l.AddonTickets,i=>(s(),p("small",{key:i.TicketUUID},[Y("("),b("em",null,k(i.Name),1),Y(")")]))),128))],64)):j("",!0)]))),128)):j("",!0)}}),so={key:0,class:"text-blue text-center"},uo={key:1,class:"text-red text-center"},ro={key:2,class:"text-orange text-center"},mo={key:3,class:"text-orange text-center"},co={key:4,class:"text-orange text-center"},vo={key:5,class:"text-green text-center"},_o={key:0},Ao={key:0},Uo=b("strong",null,"Total:",-1),To=le({__name:"RegListRow",props:{header:{},accommodations:{},convention:{},extras:{},item:{},interests:{},tickets:{},venues:{}},emits:["openActions","openPayments","reload"],setup(e,{emit:E}){const u=Ee(),n=_(),l=_(),i=_(),T=_(),m=_(!1),f=(a,r,A)=>{l.value=a,u.getRegistrationGroup(A.RegistrationUUID||"").then(c=>{i.value=c,n.value=r,T.value=A,m.value=!0})},R=a=>{E("openActions",a)},S=a=>{E("openPayments",a)};return(a,r)=>(s(),p(N,null,[a.header.type==="ACCOMMODATION"&&a.accommodations.length>0&&a.item.raw[a.header.key]?(s(),H(Qa,{key:0,value:a.item.raw[a.header.key].Data,accommodations:a.accommodations,convention:a.convention,venues:a.venues,registration:a.item.raw[a.header.key].Registration},null,8,["value","accommodations","convention","venues","registration"])):a.header.type==="EXTRAS"&&a.extras.length>0?(s(),H(Za,{key:1,value:a.item.raw[a.header.key],extras:a.extras},null,8,["value","extras"])):a.header.type==="INTERESTS"&&a.interests.length>0?(s(),H(to,{key:2,value:a.item.raw[a.header.key],interests:a.interests},null,8,["value","interests"])):a.header.type==="TICKET"&&a.tickets.length>0?(s(),H(io,{key:3,value:a.item.raw[a.header.key],tickets:a.tickets},null,8,["value","tickets"])):a.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_SUBMISSION_STATUS"||a.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_ACCOMMODATION_FORM"||a.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_DEALER_FORM"||a.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_BADGE_FORM"||a.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_REGISTRATION_FORM"?(s(!0),p(N,{key:4},Z(a.item.raw[a.header.key],A=>(s(),p("ul",{key:A.Heading},[b("li",null,[b("strong",null,k(A.Heading)+":",1),Y(" "+k(q(pt)(A.Submission.Status))+" ",1),t(se,{icon:"mdi:mdi-form-select",title:"Edit Submitted Data",variant:"flat",onClick:c=>f(A.Registration,A.Form,A.Submission)},null,8,["onClick"])])]))),128)):a.header.type==="LAYOUT_ITEM_SOURCE_USER.USER_DATA_SOURCE_AVATAR"?(s(),H(pa,{key:5,class:"rounded-circle",src:a.item.raw[a.header.key],height:"32",width:"32"},null,8,["src"])):a.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_PAYMENT_STATUS"?(s(),p(N,{key:6},[a.item.raw[a.header.key]=="NOT_REQUIRED"?(s(),p("div",so,"No Payment Requested")):a.item.raw[a.header.key]=="MISSING_REQUIRED"?(s(),p("div",uo,"Partner Payment Not Requested")):a.item.raw[a.header.key]=="AWAITING_PARTNER"?(s(),p("div",ro,"Awaiting Partner Payment")):a.item.raw[a.header.key]=="ALL_REQUIRED"?(s(),p("div",mo,"Awaiting Payments")):a.item.raw[a.header.key]=="REQUIRED"?(s(),p("div",co,"Awaiting Payment")):(s(),p("div",vo,"Completed"))],64)):a.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_REGISTRATION_ACTIONS"?(s(),p(N,{key:7},[t(se,{icon:"mdi:mdi-email-fast",variant:"flat",onClick:r[0]||(r[0]=A=>R(a.item.raw[a.header.key]))}),t(se,{icon:"mdi:mdi-cash-multiple",variant:"flat",onClick:r[1]||(r[1]=A=>S(a.item.raw[a.header.key]))})],64)):a.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_REGISTRATION_GROUP"?(s(),p(N,{key:8},[a.item.raw[a.header.key].length===1?(s(),p("em",_o," Not in a group ")):(s(),p(N,{key:1},[b("ul",null,[(s(!0),p(N,null,Z(a.item.raw[a.header.key],A=>(s(),p("li",{key:A.UUID,class:"ml-0"},[Y(" #"+k(A.Reference)+" : "+k(A.Name)+" ",1),A.IsLeader?(s(),p("strong",Ao,"(Leader)")):j("",!0)]))),128))]),Uo,Y(" "+k(a.item.raw[a.header.key].length),1)],64))],64)):(s(),p(N,{key:9},[Y(k(a.item.raw[a.header.key]),1)],64)),m.value&&T.value&&n.value?(s(),H(Ia,{key:10,modelValue:m.value,"onUpdate:modelValue":r[4]||(r[4]=A=>m.value=A),scrollable:!0},{default:o(()=>[t(Rt,{class:"bg-red-darken-4"},{default:o(()=>[t(Ra,null,{default:o(()=>[t(xt,{modelValue:n.value,"onUpdate:modelValue":r[2]||(r[2]=A=>n.value=A),admin:!0,convention:a.convention,data:T.value,editable:!0,"registration-group":i.value,onClose:r[3]||(r[3]=A=>{m.value=!1,E("reload")})},null,8,["modelValue","convention","data","registration-group"])]),_:1})]),_:1})]),_:1},8,["modelValue"])):j("",!0)],64))}});var Eo=["onActivate","onAddUndo","onBeforeAddUndo","onBeforeExecCommand","onBeforeGetContent","onBeforeRenderUI","onBeforeSetContent","onBeforePaste","onBlur","onChange","onClearUndos","onClick","onContextMenu","onCopy","onCut","onDblclick","onDeactivate","onDirty","onDrag","onDragDrop","onDragEnd","onDragGesture","onDragOver","onDrop","onExecCommand","onFocus","onFocusIn","onFocusOut","onGetContent","onHide","onInit","onKeyDown","onKeyPress","onKeyUp","onLoadContent","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp","onNodeChange","onObjectResizeStart","onObjectResized","onObjectSelected","onPaste","onPostProcess","onPostRender","onPreProcess","onProgressState","onRedo","onRemove","onReset","onSaveContent","onSelectionChange","onSetAttrib","onSetContent","onShow","onSubmit","onUndo","onVisualAid"],fo=function(e){return Eo.map(function(E){return E.toLowerCase()}).indexOf(e.toLowerCase())!==-1},So=function(e,E,u){Object.keys(E).filter(fo).forEach(function(n){var l=E[n];typeof l=="function"&&(n==="onInit"?l(e,u):u.on(n.substring(2),function(i){return l(i,u)}))})},po=function(e,E,u,n){var l=e.modelEvents?e.modelEvents:null,i=Array.isArray(l)?l.join(" "):l;ne(n,function(T,m){u&&typeof T=="string"&&T!==m&&T!==u.getContent({format:e.outputFormat})&&u.setContent(T)}),u.on(i||"change input undo redo",function(){E.emit("update:modelValue",u.getContent({format:e.outputFormat}))})},Ro=function(e,E,u,n,l,i){n.setContent(i()),u.attrs["onUpdate:modelValue"]&&po(E,u,n,l),So(e,u.attrs,n)},rt=0,yt=function(e){var E=Date.now(),u=Math.floor(Math.random()*1e9);return rt++,e+"_"+u+rt+String(E)},Do=function(e){return e!==null&&e.tagName.toLowerCase()==="textarea"},dt=function(e){return typeof e>"u"||e===""?[]:Array.isArray(e)?e:e.split(" ")},Io=function(e,E){return dt(e).concat(dt(E))},yo=function(e){return e==null},mt=function(){return{listeners:[],scriptId:yt("tiny-script"),scriptLoaded:!1}},go=function(){var e=mt(),E=function(l,i,T,m){var f=i.createElement("script");f.referrerPolicy="origin",f.type="application/javascript",f.id=l,f.src=T;var R=function(){f.removeEventListener("load",R),m()};f.addEventListener("load",R),i.head&&i.head.appendChild(f)},u=function(l,i,T){e.scriptLoaded?T():(e.listeners.push(T),l.getElementById(e.scriptId)||E(e.scriptId,l,i,function(){e.listeners.forEach(function(m){return m()}),e.scriptLoaded=!0}))},n=function(){e=mt()};return{load:u,reinitialize:n}},Oo=go(),Co=function(){return typeof window<"u"?window:global},Oe=function(){var e=Co();return e&&e.tinymce?e.tinymce:null},ho={apiKey:String,cloudChannel:String,id:String,init:Object,initialValue:String,inline:Boolean,modelEvents:[String,Array],plugins:[String,Array],tagName:String,toolbar:[String,Array],modelValue:String,disabled:Boolean,tinymceScriptSrc:String,outputFormat:{type:String,validator:function(e){return e==="html"||e==="text"}}},ce=globalThis&&globalThis.__assign||function(){return ce=Object.assign||function(e){for(var E,u=1,n=arguments.length;u<n;u++){E=arguments[u];for(var l in E)Object.prototype.hasOwnProperty.call(E,l)&&(e[l]=E[l])}return e},ce.apply(this,arguments)},Mo=function(e,E,u,n){return e(n||"div",{id:E,ref:u})},bo=function(e,E,u){return e("textarea",{id:E,visibility:"hidden",ref:u})},je={selector:void 0,target:void 0},Vo=le({props:ho,setup:function(e,E){var u=e.init?ce(ce({},e.init),je):ce({},je),n=kt(e),l=n.disabled,i=n.modelValue,T=n.tagName,m=_(null),f=null,R=e.id||yt("tiny-vue"),S=e.init&&e.init.inline||e.inline,a=!!E.attrs["onUpdate:modelValue"],r=!0,A=e.initialValue?e.initialValue:"",c="",V=function(y){return a?function(){return i!=null&&i.value?i.value:""}:function(){return y?A:c}},v=function(){var y=V(r),G=ce(ce({},u),{readonly:e.disabled,target:m.value,plugins:Io(u.plugins,e.plugins),toolbar:e.toolbar||u.toolbar,inline:S,setup:function(Q){f=Q,Q.on("init",function(ie){return Ro(ie,e,E,Q,i,y)}),typeof u.setup=="function"&&u.setup(Q)}});Do(m.value)&&(m.value.style.visibility=""),Oe().init(G),r=!1};ne(l,function(y){var G;f!==null&&(typeof((G=f.mode)===null||G===void 0?void 0:G.set)=="function"?f.mode.set(y?"readonly":"design"):f.setMode(y?"readonly":"design"))}),ne(T,function(y){var G;a||(c=f.getContent()),(G=Oe())===null||G===void 0||G.remove(f),tt(function(){return v()})}),Ft(function(){if(Oe()!==null)v();else if(m.value&&m.value.ownerDocument){var y=e.cloudChannel?e.cloudChannel:"6",G=e.apiKey?e.apiKey:"no-api-key",Q=yo(e.tinymceScriptSrc)?"https://cdn.tiny.cloud/1/".concat(G,"/tinymce/").concat(y,"/tinymce.min.js"):e.tinymceScriptSrc;Oo.load(m.value.ownerDocument,Q,v)}}),Pt(function(){Oe()!==null&&Oe().remove(f)}),S||(wt(function(){r||v()}),$t(function(){var y;a||(c=f.getContent()),(y=Oe())===null||y===void 0||y.remove(f)}));var O=function(y){var G;c=f.getContent(),(G=Oe())===null||G===void 0||G.remove(f),u=ce(ce(ce({},u),y),je),tt(function(){return v()})};return E.expose({rerender:O,getEditor:function(){return f}}),function(){return S?Mo(at,R,m,e.tagName):bo(at,R,m)}}});const No=["colspan"],Lo=b("strong",null,"E-Mail Content",-1),ko=["innerHTML"],gt=le({__name:"Communications",props:{hideHistory:{type:Boolean,default:!1},registration:{},showEditor:{type:Boolean}},emits:["close-editor"],setup(e,{emit:E}){const u=Ee(),n=_([]),l=_({From:"",Subject:"",HTML:""}),i=_(""),T=_(""),m=_(""),f=_(!1),R=_([]),S=_([]),a=_([{key:"CreatedAt",title:"Date"},{key:"Subject",title:"Subject"},{key:"User.DisplayName",title:"Sender"},{key:"Status",title:"Status"}]);ne(l,V=>{m.value=V.From||m.value||"",T.value=V.Subject||T.value||"",i.value=V.HTML||i.value||""});const r=()=>{u.getRegistrationEmails(e.registration.RegistrationUUID).then(V=>{V&&(V.forEach(v=>{v.CreatedAt=Ta(new Date(v.CreatedAt||"")),v.Status=Na(v.Status),v.User||(v.User={ID:0,UserUUID:"",DisplayName:"System",Handle:"",Credentials:[],Additional:{FirstName:"",LastName:"",DOB:"",Email:""},Data:"",Groups:[],Tags:[]})}),S.value=V)})};r(),(()=>{u.getRegistrationEmailTemplates(e.registration.RegistrationUUID).then(V=>{V&&(n.value=V)})})();const c=({callback:V})=>{u.sendRegistrationEmail(e.registration.RegistrationUUID,m.value,T.value,i.value).then(v=>{v?V&&(V("Email Sent"),r(),setTimeout(()=>{f.value=!1},2e3)):V&&V("Not sent")}).catch(()=>{V&&V("Not sent")})};return(V,v)=>(s(),p(N,null,[V.showEditor?(s(),p(N,{key:0},[t(ee,null,{default:o(()=>[t(F,null,{default:o(()=>[t(oe,{items:n.value,"item-title":"Subject","return-object":"",label:"Template","hide-details":"",modelValue:l.value,"onUpdate:modelValue":v[0]||(v[0]=O=>l.value=O),variant:"outlined"},null,8,["items","modelValue"])]),_:1})]),_:1}),t(ee,null,{default:o(()=>[t(F,{cols:"12"},{default:o(()=>[t(Ue,{modelValue:m.value,"onUpdate:modelValue":v[1]||(v[1]=O=>m.value=O),label:"From",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),t(F,{cols:"12"},{default:o(()=>[t(Ue,{modelValue:T.value,"onUpdate:modelValue":v[2]||(v[2]=O=>T.value=O),label:"Subject",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),t(F,{cols:"12"},{default:o(()=>[t(q(Vo),{modelValue:i.value,"onUpdate:modelValue":v[3]||(v[3]=O=>i.value=O),"api-key":"g9sce3fktcgvk0i7sp96cahgyk4cos7q27es3ubnlal3xf3z"},null,8,["modelValue"])]),_:1})]),_:1}),t(ee,null,{default:o(()=>[t(F,null,{default:o(()=>[t(Qe,{onClick:v[4]||(v[4]=O=>E("close-editor")),label:"Close E-mail Editor",color:"secondary","prepend-icon":"mdi:mdi-window-close"})]),_:1}),t(F,{class:"text-right"},{default:o(()=>[t(Qe,{onClick:c,label:"Send",color:"error"})]),_:1})]),_:1})],64)):j("",!0),S.value.length&&!V.hideHistory?(s(),H(Et,{key:1,class:"my-2"},{default:o(()=>[t(Tt,null,{default:o(()=>[t(_t,null,{default:o(()=>[Y(" Email History ")]),_:1}),t(At,null,{default:o(()=>[t(q(Ut),{items:S.value,headers:a.value,"show-expand":!0,"item-value":"EmailUUID",expanded:R.value,"onUpdate:expanded":v[5]||(v[5]=O=>R.value=O)},{"expanded-row":o(({columns:O,item:y})=>[b("tr",null,[b("td",{colspan:O.length},[Lo,b("div",{class:"communicationsViewEmailPreview",innerHTML:y.raw.HTML},null,8,ko)],8,No)])]),"footer.prepend":o(()=>[t(se,{"prepend-icon":"mdi:mdi-refresh",color:"primary",class:"mr-4",onClick:r},{default:o(()=>[Y("Refresh")]),_:1})]),_:1},8,["items","headers","expanded"])]),_:1})]),_:1})]),_:1})):j("",!0)],64))}});const Fo=e=>(ct("data-v-0de55890"),e=e(),vt(),e),Po=["colspan"],wo=Fo(()=>b("strong",null,"Details",-1)),$o=["innerHTML"],Go=le({__name:"PaymentTransactions",props:{hideHistory:{type:Boolean},updated:{},registration:{},showEditor:{type:Boolean}},emits:["close-editor","change"],setup(e,{emit:E}){const u=e;let{hideHistory:n=!1,registration:l,showEditor:i}=u;const T=Ee(),m=_([]),f=_([]),R=_([{key:"CreatedAt",title:"Date"},{key:"Type",title:"Type"},{key:"Source",title:"Source"},{key:"Description",title:"Description"},{key:"Admin",title:"Admin"},{key:"Amount",title:"Amount"}]),S=()=>({PaymentTransactionUUID:he(),Amount:0,Data:{},Description:"",ID:0,RegistrationID:l.ID,RegistrationUUID:l.RegistrationUUID,Source:Sa.PAYMENT_TRANSACTION_SOURCE_NULL,Type:ft.PAYMENT_TRANSACTION_TYPE_NULL}),a=_(S()),{convertTransactions:r,getPaymentTransactionsDisplay:A}=St();ne(u,()=>{n=u.hideHistory,l=u.registration,i=u.showEditor,A(l.RegistrationUUID).then(v=>{f.value=v})});const c=()=>{A(l.RegistrationUUID).then(v=>{f.value=v})};c();const V=()=>{T.saveRegistrationPaymentTransaction(a.value).then(v=>{v&&(r(v.PaymentTransactions),a.value=S(),E("close-editor"),E("change"))})};return(v,O)=>(s(),p(N,null,[q(i)?(s(),p(N,{key:0},[t(Da,null,{default:o(()=>[Y(" Add Transaction ")]),_:1}),t(ee,null,{default:o(()=>[t(F,{cols:"12",sm:"6"},{default:o(()=>[t(oe,{items:q(Ea),"item-title":"title","item-value":"value",label:"Transaction Type",clearable:!0,"hide-details":"",modelValue:a.value.Type,"onUpdate:modelValue":O[0]||(O[0]=y=>a.value.Type=y),variant:"outlined"},null,8,["items","modelValue"])]),_:1}),t(F,{cols:"12",sm:"6"},{default:o(()=>[t(oe,{items:q(fa),"item-title":"title","item-value":"value",label:"Source",clearable:!0,"hide-details":"",modelValue:a.value.Source,"onUpdate:modelValue":O[1]||(O[1]=y=>a.value.Source=y),variant:"outlined"},null,8,["items","modelValue"])]),_:1})]),_:1}),t(ee,null,{default:o(()=>[t(F,{cols:"12",sm:"8",md:"10"},{default:o(()=>[t(Ue,{label:"Description","hide-details":"",modelValue:a.value.Description,"onUpdate:modelValue":O[2]||(O[2]=y=>a.value.Description=y),variant:"outlined"},null,8,["modelValue"])]),_:1}),t(F,{cols:"12",sm:"4",md:"2"},{default:o(()=>[t(Ue,{label:"Amount","prepend-inner-icon":"mdi:mdi-currency-gbp","hide-details":"",modelValue:a.value.Amount,"onUpdate:modelValue":O[3]||(O[3]=y=>a.value.Amount=y),modelModifiers:{number:!0},variant:"outlined"},null,8,["modelValue"])]),_:1})]),_:1}),t(ee,null,{default:o(()=>[t(F,{cols:"12",sm:"3",md:"2",lg:"1"},{default:o(()=>[t(se,{class:"w-100",onClick:O[4]||(O[4]=y=>E("close-editor")),color:"warning"},{default:o(()=>[Y("Cancel")]),_:1})]),_:1}),t(Dt),t(F,{cols:"12",sm:"6",md:"3",lg:"2",xl:"2"},{default:o(()=>[t(se,{class:"w-100",onClick:V,color:"primary"},{default:o(()=>[Y("Submit Transaction")]),_:1})]),_:1})]),_:1})],64)):j("",!0),f.value.length&&!q(n)?(s(),H(Et,{key:1,class:"my-2"},{default:o(()=>[t(Tt,null,{default:o(()=>[t(_t,null,{default:o(()=>[Y(" Transaction History ")]),_:1}),t(At,null,{default:o(()=>[t(q(Ut),{items:f.value,headers:R.value,"show-expand":!1,"item-value":"PaymentTransactionUUID",expanded:m.value,"onUpdate:expanded":O[5]||(O[5]=y=>m.value=y)},{"expanded-row":o(({columns:y,item:G})=>[b("tr",null,[b("td",{colspan:y.length},[wo,b("div",{innerHTML:G.raw.HTML},null,8,$o)],8,Po)])]),"footer.prepend":o(()=>[t(se,{"prepend-icon":"mdi:mdi-refresh",color:"primary",class:"mr-4",onClick:c},{default:o(()=>[Y("Refresh")]),_:1})]),_:1},8,["items","headers","expanded"])]),_:1})]),_:1})]),_:1})):j("",!0)],64))}});const Bo=$e(Go,[["__scopeId","data-v-0de55890"]]),Be=e=>(ct("data-v-d8ffe9ea"),e=e(),vt(),e),Yo={class:"v-row"},Ho={key:0,class:"v-col v-col-10 py-1 v-row mx-0 pl-0"},xo={class:"v-col v-col-12 v-col-sm-4 v-col-md-3 font-weight-bold pb-0 pr-0"},qo={class:"v-col v-col-12 v-col-sm-8 v-col-md-9 font-italic pt-0 pt-sm-3 pb-sm-0 pl-sm-0"},jo={class:"v-col v-col-2 align-self-end text-right py-1 text-no-wrap"},Ko=Be(()=>b("dt",{class:"v-col v-col-9 py-1 font-weight-bold totals"}," Total Charges ",-1)),Qo={class:"v-col v-col-3 align-self-end text-right py-1 totals text-no-wrap"},zo=Be(()=>b("dt",{class:"v-col v-col-9 py-1 font-weight-bold"}," Applied Total ",-1)),Wo={class:"v-col v-col-3 align-self-end text-right py-1 text-no-wrap"},Jo=Be(()=>b("dt",{class:"v-col v-col-9 py-1 font-weight-bold"}," Currently Paid ",-1)),Xo={class:"v-col v-col-3 align-self-end text-right py-1 text-no-wrap"},Zo=Be(()=>b("dt",{class:"v-col v-col-9 py-1 font-weight-bold totals"}," Balance ",-1)),en={class:"v-col v-col-3 align-self-end text-right py-1 totals text-no-wrap"},tn=le({__name:"PaymentActions",props:Te({forms:{},registration:{},title:{}},{modelValue:{type:Boolean,required:!0}}),emits:Te(["update:registration"],["update:modelValue"]),setup(e,{emit:E}){const u=e,n=we(e,"modelValue"),{registration:l}=u,i=_(!1),T=_(!1),m=_(),f=_([]),R=_(new Date().getTime()),S=ze(u,E,void 0,void 0,"registration"),a=_(_e(S.value));ne(S,()=>{a.value=_e(S.value)});const r=Ee(),A=()=>{r.generateRegistrationCharges(l.RegistrationUUID,!1).then(v=>{v&&(f.value=v.PaymentTransactions,m.value=v.Registration,R.value=new Date().getTime())}).catch(()=>{})};A();const c=()=>{r.generateRegistrationCharges(l.RegistrationUUID,!0).then(v=>{v&&(f.value=v.PaymentTransactions,m.value=v.Registration,R.value=new Date().getTime())})},{totalCharges:V}=St();return(v,O)=>(s(),H(Ge,{modelValue:n.value,"onUpdate:modelValue":O[3]||(O[3]=y=>n.value=y),title:v.title,"show-close-action":!0,color:"primary","close-action-label":"Close",persistent:!0,"retain-focus":!1,scrollable:!0,fullscreen:""},{default:o(()=>[t(Ce,{class:"px-0 mx-0",fluid:!0},{default:o(()=>[m.value?(s(),p(N,{key:0},[b("dl",Yo,[(s(!0),p(N,null,Z(f.value,y=>(s(),p(N,{key:y.PaymentTransactionUUID},[y.Type===q(ft).PAYMENT_TRANSACTION_TYPE_CHARGE?(s(),p("dt",Ho,[b("div",xo,k(y.Description.split(":")[0])+": ",1),b("div",qo,k(y.Description.split(":")[1]),1)])):j("",!0),b("dd",jo," £"+k(y.Amount),1)],64))),128)),Ko,b("dd",Qo," £"+k(q(V)(f.value)),1),zo,b("dd",Wo," £"+k(m.value.Total),1),Jo,b("dd",Xo," £"+k(m.value.Paid),1),Zo,b("dd",en," £"+k(m.value.Total-m.value.Paid),1)]),t(ee,{class:"flex-row-reverse"},{default:o(()=>[t(F,{class:"text-right"},{default:o(()=>[t(se,{color:"primary",onClick:c},{default:o(()=>[Y("Apply Charges")]),_:1})]),_:1}),T.value?j("",!0):(s(),H(F,{key:0},{default:o(()=>[t(se,{color:"secondary",onClick:O[0]||(O[0]=y=>T.value=!0)},{default:o(()=>[Y("Transaction Entry")]),_:1})]),_:1}))]),_:1})],64)):j("",!0),t(Bo,{registration:q(l),"show-editor":T.value,onCloseEditor:O[1]||(O[1]=y=>T.value=!1),updated:R.value,onChange:A},null,8,["registration","show-editor","updated"]),t(gt,{registration:q(l),"show-editor":i.value,onCloseEditor:O[2]||(O[2]=y=>i.value=!1)},null,8,["registration","show-editor"])]),_:1})]),_:1},8,["modelValue","title"]))}});const an=$e(tn,[["__scopeId","data-v-d8ffe9ea"]]),on=le({__name:"RegistrationActions",props:Te({forms:{},registration:{},title:{}},{modelValue:{type:Boolean,required:!0}}),emits:Te(["update:registration"],["update:modelValue"]),setup(e,{emit:E}){const u=e,n=we(e,"modelValue"),l=_(!1),i=ze(u,E,void 0,void 0,"registration"),T=_(_e(i.value));ne(i,()=>{T.value=_e(i.value)});const m=Ee(),f=(R,S)=>{const a=T.value.Submissions.find(r=>r.SubmissionUUID==S);if(!a){R&&R("Submission not found");return}m.setSubmissionStatus(S,a.Status).then(r=>{r?(T.value.Submissions.forEach((A,c)=>{i.value.Submissions[c].Status=A.Status}),R&&R("Status Saved")):R&&R("Status not saved")}).catch(()=>{R&&R("Status not saved")})};return(R,S)=>(s(),H(Ge,{modelValue:n.value,"onUpdate:modelValue":S[2]||(S[2]=a=>n.value=a),title:R.title,"show-close-action":!0,color:"primary","close-action-label":"Close",persistent:!0,"retain-focus":!1,scrollable:!0},{default:o(()=>[t(Ce,{class:"px-0 mx-0",fluid:!0},{default:o(()=>[t(Pe,null,{default:o(()=>[(s(!0),p(N,null,Z(T.value.Submissions,a=>(s(),H(Ne,{key:a.SubmissionUUID,class:"pa-0"},{default:o(()=>[t(ee,{class:"py-2 align-center"},{default:o(()=>[t(F,{cols:"8"},{default:o(()=>{var r;return[t(oe,{modelValue:a.Status,"onUpdate:modelValue":A=>a.Status=A,items:q(st),"item-text":"title","item-value":"value",variant:"outlined","hide-details":"",label:((r=R.forms.find(A=>A.FormUUID==a.FormUUID))==null?void 0:r.Name)||""},{selection:o(()=>[t(Aa,{class:"mr-4"},{default:o(()=>{var A;return[Y(k((A=q(st).find(c=>c.value===a.Status))==null?void 0:A.icon),1)]}),_:2},1024),Y(" "+k(q(pt)(a.Status)),1)]),item:o(({item:A,props:{onClick:c}})=>[t(Ne,{title:A.title,"prepend-icon":A.raw.icon,onClick:c},null,8,["title","prepend-icon","onClick"])]),_:2},1032,["modelValue","onUpdate:modelValue","items","label"])]}),_:2},1024),t(F,{cols:"4"},{default:o(()=>[t(Qe,{title:"Save","prepend-icon":"mdi:mdi-content-save",color:"warning",onClick:r=>f(r.callback,a.SubmissionUUID)},null,8,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1}),t(ee,null,{default:o(()=>[t(F,{cols:"12"},{default:o(()=>[t(se,{"prepend-icon":"mdi:mdi-email",color:"primary",onClick:S[0]||(S[0]=a=>l.value=!0)},{default:o(()=>[Y("Prepare Email")]),_:1})]),_:1})]),_:1}),t(gt,{registration:R.registration,"show-editor":l.value,onCloseEditor:S[1]||(S[1]=a=>l.value=!1)},null,8,["registration","show-editor"])]),_:1})]),_:1},8,["modelValue","title"]))}});const wn=le({__name:"RegistrationsView",emits:["pageTitle"],setup(e,{emit:E}){var We;const u=ga();E("pageTitle","Registration Manager");const n=Gt(),l=Bt(),i=_(!0);let T=((We=n.params.convention)==null?void 0:We.toString())||"";const m=_({ID:0,ConventionUUID:he(),OrganisationID:0,OrganisationUUID:qe,Name:"New Convention",Description:"",DetailLink:"",Logo:"",Slug:"",Accommodation:[],Tickets:[],Extras:[],Interests:[],Visible:!1}),f=Ee(),R=_({ID:0,AdminLayoutUUID:he(),ConventionID:m.value.ID,ConventionUUID:m.value.ConventionUUID,Name:"Registration Table",Type:It.ADMIN_LAYOUT_TABLE,Panels:[]}),S=_([]),a=_([]),r=_([]),A=_([]),c=_([]),V=_(1),v=_(10),O=_([]),y=_(0),G=_(!1),Q=_(""),ie=_(""),fe=_(""),Se=_(""),h=_(""),M=_(""),L=_([]),I=_([]),$=_([]),W=_([]),te=_([]),z=_([]),de=_(0),ue=_(),pe=_(!1),Re=_(!1);ne(de,d=>{d===7&&be()}),ne(h,()=>{ie.value=Date.now().toString()}),ne(M,()=>{ie.value=Date.now().toString()});const De=()=>{S.value=[],r.value=[],c.value=[];try{f.getConventionAdminLayoutByName(m.value.ConventionUUID,"Registration Table").then(d=>{de.value+=1,d?R.value=d:(R.value.ConventionID=m.value.ID,R.value.ConventionUUID=m.value.ConventionUUID)})}catch{R.value.ConventionID=m.value.ID,R.value.ConventionUUID=m.value.ConventionUUID}try{f.getConventionForms(m.value.ConventionUUID).then(d=>{de.value+=1,d&&(S.value=d)})}catch{}try{f.getConventionAccommodation(m.value.ConventionUUID).then(d=>{de.value+=1,d&&(I.value=d)})}catch{}try{f.getConventionVenues(m.value.ConventionUUID).then(d=>{de.value+=1,d&&(z.value=d)})}catch{}try{f.getConventionExtras(m.value.ConventionUUID).then(d=>{de.value+=1,d&&($.value=d)})}catch{}try{f.getConventionInterests(m.value.ConventionUUID).then(d=>{de.value+=1,d&&(W.value=d)})}catch{}try{f.getConventionTickets(m.value.ConventionUUID).then(d=>{de.value+=1,d&&(te.value=d)})}catch{}try{f.getConventionGroups(m.value.ConventionUUID).then(d=>{d&&(a.value=d.sort((U,D)=>U.Name.localeCompare(D.Name)))})}catch{}try{f.getConventionTags(m.value.ConventionUUID).then(d=>{d&&(A.value=d.sort((U,D)=>U.Title.localeCompare(D.Title)).map(U=>(U.Title=`${U.Title} [${U.Key}]`,U)))})}catch{}},Me=({page:d,itemsPerPage:U,sortBy:D})=>{i.value=!0,V.value=d,O.value=D;const g=c.value.find(J=>J.uuid==Q.value),me=g==null?void 0:g.layout.Items;let ae="",Je="";if(D&&me&&D.length>=1){const J=me.find(Ve=>Ve.LayoutItemUUID==D[0].key);switch(Je=D[0].order,J==null?void 0:J.MetaField){case K.META_DATA_SOURCE_ACCOMMODATION_FORM:ae="submission.status";break;case K.META_DATA_SOURCE_BADGE_FORM:ae="submission.status";break;case K.META_DATA_SOURCE_DEALER_FORM:ae="submission.status";break;case K.META_DATA_SOURCE_REGISTRATION_FORM:ae="submission.status";break;case K.META_DATA_SOURCE_REGISTRATION_REFERENCE:ae="reference";break;case K.META_DATA_SOURCE_SUBMISSION_DATE:ae="created";break;case K.META_DATA_SOURCE_SUBMISSION_STATUS:ae="submission.status";break}switch(J==null?void 0:J.UserField){case X.USER_DATA_SOURCE_DISPLAY_NAME:ae="user.display_name";break;case X.USER_DATA_SOURCE_EMAIL:ae="user.email";break;case X.USER_DATA_SOURCE_FIRST_NAME:ae="user.firstname";break;case X.USER_DATA_SOURCE_HANDLE:ae="user.handle";break;case X.USER_DATA_SOURCE_LAST_NAME:ae="user.lastname";break}}try{const J={Direction:Je,Limit:U,Offset:(d-1)*U,Order:ae};g&&g.layout.RequiredRegistrationTags.length>0&&(J.PanelUUID=g==null?void 0:g.layout.LayoutPanelUUID),(g==null?void 0:g.layout.RequiredFormType)===Ae.FORM_TYPE_ACCOMMODATION&&(J.Accommodation=!0),(g==null?void 0:g.layout.RequiredFormType)===Ae.FORM_TYPE_BADGE&&(J.Badge=!0),(g==null?void 0:g.layout.RequiredFormType)===Ae.FORM_TYPE_DEALER&&(J.Dealer=!0),(g==null?void 0:g.layout.RequiredFormType)===Ae.FORM_TYPE_REGISTRATION&&(J.Registration=!0),J.GroupUUID=h.value||qe,J.TagUUID=M.value||qe,J.Email=Se.value,J.Reference=fe.value,f.searchConventionRegistrations(m.value.ConventionUUID,J).then(Ve=>{Ve&&(y.value=Ve.Total,r.value=Ve.Registrations,c.value.forEach(Ye=>{const Mt=Ye.layout;Ye.items=r.value.map(w=>{const x={};return Ye.headers.forEach(Xe=>{var Ze;const P=Mt.Items.find(Ie=>Ie.LayoutItemUUID===Xe.key);if(P){if(P.SourceType==="LAYOUT_ITEM_SOURCE_FORM"&&P.SectionField)w.Submissions.forEach(Ie=>{const re=Ie.Data.find(He=>He.SectionFieldUUID===P.SectionFieldUUID);if(re){Xe.type===qt.ACCOMMODATION?x[P.LayoutItemUUID]={Data:re.Data,Registration:w}:x[P.LayoutItemUUID]=re.Data;return}});else if(P.SourceType==="LAYOUT_ITEM_SOURCE_USER"&&P.UserField)switch(P.UserField){case X.USER_DATA_SOURCE_AVATAR:x[P.LayoutItemUUID]=u.GetProfileImageURL(w.UserUUID);break;case X.USER_DATA_SOURCE_DISPLAY_NAME:x[P.LayoutItemUUID]=w.User.DisplayName;break;case X.USER_DATA_SOURCE_EMAIL:x[P.LayoutItemUUID]=w.User.Additional.Email;break;case X.USER_DATA_SOURCE_HANDLE:x[P.LayoutItemUUID]=w.User.Handle;break;case X.USER_DATA_SOURCE_DATE_OF_BIRTH:x[P.LayoutItemUUID]=w.User.Additional.DOB;break;case X.USER_DATA_SOURCE_FIRST_NAME:x[P.LayoutItemUUID]=w.User.Additional.FirstName;break;case X.USER_DATA_SOURCE_LAST_NAME:x[P.LayoutItemUUID]=w.User.Additional.LastName;break;case X.USER_DATA_SOURCE_TELEGRAM:x[P.LayoutItemUUID]="";break}else if(P.SourceType==="LAYOUT_ITEM_SOURCE_META"&&P.MetaField){const Ie=[];let re;const He=(Ze=S.value.find(C=>C.Type===Ae.FORM_TYPE_REGISTRATION))==null?void 0:Ze.FormUUID,et=w.Submissions.find(C=>C.FormUUID===He);switch(P.MetaField){case K.META_DATA_SOURCE_REGISTRATION_ACTIONS:x[P.LayoutItemUUID]=w;break;case K.META_DATA_SOURCE_REGISTRATION_GROUP:w.Leader?re=w:re=w.Primary,Ie.push({Name:re.User.DisplayName,UUID:re.UserUUID,UserUUID:re.User.UserUUID,IsLeader:!0,Reference:re.Reference}),Ie.push(...re.Members.map(C=>({Name:C.User.DisplayName,UUID:C.UserUUID,UserUUID:C.User.UserUUID,IsLeader:!1,Reference:C.Reference}))),x[P.LayoutItemUUID]=Ie;break;case K.META_DATA_SOURCE_REGISTRATION_REFERENCE:x[P.LayoutItemUUID]=w.Reference;break;case K.META_DATA_SOURCE_SUBMISSION_DATE:if(et){const C=new Date(et.CreatedAt||"");x[P.LayoutItemUUID]=`${C.getFullYear()}-${(C.getMonth()+1).toString().padStart(2,"0")}-${C.getDate().toString().padStart(2,"0")} ${C.getHours().toString().padStart(2,"0")}:${C.getMinutes().toString().padStart(2,"0")}:${C.getSeconds().toString().padStart(2,"0")}`}else{const C=new Date(w.CreatedAt||"");x[P.LayoutItemUUID]=`${C.getFullYear()}-${(C.getMonth()+1).toString().padStart(2,"0")}-${C.getDate().toString().padStart(2,"0")} ${C.getHours().toString().padStart(2,"0")}:${C.getMinutes().toString().padStart(2,"0")}:${C.getSeconds().toString().padStart(2,"0")}`}break;case K.META_DATA_SOURCE_ACCOMMODATION_FORM:x[P.LayoutItemUUID]=w.Submissions.map(C=>{const B=S.value.find(ye=>ye.FormUUID===C.FormUUID);return{Heading:B==null?void 0:B.Heading,Form:B,Submission:C,Registration:w}}).filter(C=>{var B;return((B=C.Form)==null?void 0:B.Type)===Ae.FORM_TYPE_ACCOMMODATION});break;case K.META_DATA_SOURCE_BADGE_FORM:x[P.LayoutItemUUID]=w.Submissions.map(C=>{const B=S.value.find(ye=>ye.FormUUID===C.FormUUID);return{Heading:B==null?void 0:B.Heading,Form:B,Submission:C,Registration:w}}).filter(C=>{var B;return((B=C.Form)==null?void 0:B.Type)===Ae.FORM_TYPE_BADGE});break;case K.META_DATA_SOURCE_DEALER_FORM:x[P.LayoutItemUUID]=w.Submissions.map(C=>{const B=S.value.find(ye=>ye.FormUUID===C.FormUUID);return{Heading:B==null?void 0:B.Heading,Form:B,Submission:C,Registration:w}}).filter(C=>{var B;return((B=C.Form)==null?void 0:B.Type)===Ae.FORM_TYPE_DEALER});break;case K.META_DATA_SOURCE_PAYMENT_STATUS:if(w.Members.length>0){const C=w.Members.find(B=>B.Paid===0);if(C){w.Total===0&&C.Total===0?x[P.LayoutItemUUID]="NOT_REQUIRED":w.Total===0&&C.Total>0||w.Total>0&&C.Total===0?x[P.LayoutItemUUID]="MISSING_REQUIRED":w.Paid>=w.Total?x[P.LayoutItemUUID]="AWAITING_PARTNER":x[P.LayoutItemUUID]="ALL_REQUIRED";break}}w.Total===0?x[P.LayoutItemUUID]="NOT_REQUIRED":w.Total>w.Paid?x[P.LayoutItemUUID]="REQUIRED":x[P.LayoutItemUUID]="COMPLETE";break;case K.META_DATA_SOURCE_SUBMISSION_STATUS:ya(w.Submissions,S.value),x[P.LayoutItemUUID]=w.Submissions.map(C=>{const B=S.value.find(ye=>ye.FormUUID===C.FormUUID);return{Heading:B==null?void 0:B.Heading,Form:B,Submission:C,Registration:w}});break}}}}),x})}),i.value=!1)})}catch{}},be=()=>{R.value.Panels.forEach(d=>{d.Items.forEach(U=>{(U.SectionField==null||U.SectionField.Field==null)&&S.value.find(D=>{D.Sections.find(g=>{if(g.Fields){const me=g.Fields.find(ae=>ae.SectionFieldUUID===U.SectionFieldUUID);if(me)return U.SectionField=me,!0}})})})}),R.value.Panels.length>0&&(c.value=[],R.value.Panels.forEach(d=>{const U={uuid:he(),order:d.Order,name:d.Name,headers:[],items:[],layout:d};d.Items.sort((D,g)=>D.Order>g.Order?1:D.Order==g.Order?0:-1),U.headers=d.Items.map(D=>{var g,me;return D.DefaultSort&&L.value.push({key:D.LayoutItemUUID,order:"asc"}),{key:D.LayoutItemUUID,title:D.Label||((me=(g=D.SectionField)==null?void 0:g.Field)==null?void 0:me.Label)||"",align:D.Align==="end"?"end":"start",sortable:Ot(D),type:ke(D)}}),c.value.push(U)}),c.value=c.value.sort((d,U)=>d.order>U.order?1:d.order==U.order?0:-1)),(Q.value==null||Q.value=="")&&c.value.length>0&&(Q.value=c.value[0].uuid)};T?f.getConvention(T).then(d=>{d&&(m.value=d,De())}).catch(()=>{l.push("/")}):l.push("/");const ke=d=>{var U,D;if(d.SourceType===Le.LAYOUT_ITEM_SOURCE_META)return`${d.SourceType}.${d.MetaField}`;if(d.SourceType===Le.LAYOUT_ITEM_SOURCE_FORM)return(D=(U=d.SectionField)==null?void 0:U.Field)==null?void 0:D.Type;if(d.SourceType===Le.LAYOUT_ITEM_SOURCE_USER)return`${d.SourceType}.${d.UserField}`},Ot=d=>{const U=[K.META_DATA_SOURCE_ACCOMMODATION_FORM,K.META_DATA_SOURCE_BADGE_FORM,K.META_DATA_SOURCE_DEALER_FORM,K.META_DATA_SOURCE_REGISTRATION_FORM,K.META_DATA_SOURCE_REGISTRATION_REFERENCE,K.META_DATA_SOURCE_SUBMISSION_DATE,K.META_DATA_SOURCE_SUBMISSION_STATUS],D=[X.USER_DATA_SOURCE_DISPLAY_NAME,X.USER_DATA_SOURCE_EMAIL,X.USER_DATA_SOURCE_HANDLE,X.USER_DATA_SOURCE_DATE_OF_BIRTH,X.USER_DATA_SOURCE_FIRST_NAME,X.USER_DATA_SOURCE_LAST_NAME];return U.includes(d.MetaField)||D.includes(d.UserField)},Ct=d=>{ue.value=d,pe.value=!0},ht=d=>{ue.value=d,Re.value=!0};return ne(pe,d=>{d||(ue.value=void 0)}),ne(Re,d=>{d||(ue.value=void 0)}),(d,U)=>(s(),H(Ca,null,{default:o(()=>[t(Oa,{color:"blue-darken-4"},{default:o(()=>[t(da,{modelValue:Q.value,"onUpdate:modelValue":U[0]||(U[0]=D=>Q.value=D),"show-arrows":""},{default:o(()=>[(s(!0),p(N,null,Z(c.value,D=>(s(),H(ma,{key:D.uuid,value:D.uuid},{default:o(()=>[Y(k(D.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"]),t(Dt),t(se,{icon:"mdi:mdi-cog-outline",onClick:U[1]||(U[1]=D=>G.value=!0)})]),_:1}),t(va,{modelValue:Q.value,"onUpdate:modelValue":U[11]||(U[11]=D=>Q.value=D),disabled:!0},{default:o(()=>[(s(!0),p(N,null,Z(c.value,D=>(s(),H(ca,{key:D.uuid,value:D.uuid},{default:o(()=>[D.uuid===Q.value?(s(),H(Rt,{key:0,class:"pa-2"},{default:o(()=>[t(q(ka),{"items-per-page":v.value,"onUpdate:itemsPerPage":U[9]||(U[9]=g=>v.value=g),"sort-by":L.value,"onUpdate:sortBy":U[10]||(U[10]=g=>L.value=g),headers:D.headers,"items-length":y.value,items:D.items,"item-value":"LayoutItemUUID",loading:i.value,search:ie.value,"onUpdate:options":Me},Ke({top:o(()=>[t(Ce,null,{default:o(()=>[t(ee,null,{default:o(()=>[t(F,{cols:"12",sm:"6",lg:"3"},{default:o(()=>[t(Ue,{modelValue:fe.value,"onUpdate:modelValue":U[2]||(U[2]=g=>fe.value=g),label:"Search by Badge",clearable:!0,"hide-details":"",onInput:U[3]||(U[3]=g=>ie.value=Date.now().toString())},null,8,["modelValue"])]),_:1}),t(F,{cols:"12",sm:"6",lg:"3"},{default:o(()=>[t(Ue,{modelValue:Se.value,"onUpdate:modelValue":U[4]||(U[4]=g=>Se.value=g),label:"Search By Email",clearable:!0,"hide-details":"",onInput:U[5]||(U[5]=g=>ie.value=Date.now().toString())},null,8,["modelValue"])]),_:1}),t(F,{cols:"12",sm:"6",lg:"3"},{default:o(()=>[t(oe,{modelValue:h.value,"onUpdate:modelValue":U[6]||(U[6]=g=>h.value=g),label:"Search By Group",clearable:!0,"hide-details":"",items:a.value,"item-value":"GroupUUID","item-title":"Name"},null,8,["modelValue","items"])]),_:1}),t(F,{cols:"12",sm:"6",lg:"3"},{default:o(()=>[t(oe,{modelValue:M.value,"onUpdate:modelValue":U[7]||(U[7]=g=>M.value=g),label:"Search By Tag",clearable:!0,"hide-details":"",items:A.value,"item-value":"TagUUID","item-title":"Title"},null,8,["modelValue","items"])]),_:1})]),_:1})]),_:1})]),_:2},[Z(D.headers,g=>({name:`item.${g.key}`,fn:o(({item:me})=>[t(To,{header:g,item:me,accommodations:I.value,convention:m.value,extras:$.value,interests:W.value,tickets:te.value,venues:z.value,onOpenActions:Ct,onOpenPayments:ht,onReload:U[8]||(U[8]=ae=>Me({page:V.value,itemsPerPage:v.value,sortBy:O.value}))},null,8,["header","item","accommodations","convention","extras","interests","tickets","venues"])])}))]),1032,["items-per-page","sort-by","headers","items-length","items","loading","search"])]),_:2},1024)):j("",!0)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"]),G.value?(s(),H(Fa,{key:0,title:"Edit Layout",modelValue:G.value,"onUpdate:modelValue":U[12]||(U[12]=D=>G.value=D),layout:R.value,onSave:U[13]||(U[13]=D=>{G.value=!1,be()})},null,8,["modelValue","layout"])):j("",!0),ue.value?(s(),p(N,{key:1},[pe.value?(s(),H(on,{key:0,modelValue:pe.value,"onUpdate:modelValue":U[14]||(U[14]=D=>pe.value=D),registration:ue.value,"onUpdate:registration":U[15]||(U[15]=D=>ue.value=D),accommodations:I.value,convention:m.value,extras:$.value,forms:S.value,interests:W.value,tickets:te.value,title:"Registration Status & Communications",venues:z.value},null,8,["modelValue","registration","accommodations","convention","extras","forms","interests","tickets","venues"])):Re.value?(s(),H(an,{key:1,modelValue:Re.value,"onUpdate:modelValue":U[16]||(U[16]=D=>Re.value=D),registration:ue.value,"onUpdate:registration":U[17]||(U[17]=D=>ue.value=D),accommodations:I.value,convention:m.value,extras:$.value,forms:S.value,interests:W.value,tickets:te.value,title:"Registration Payments",venues:z.value},null,8,["modelValue","registration","accommodations","convention","extras","forms","interests","tickets","venues"])):j("",!0)],64)):j("",!0)]),_:1}))}});export{wn as default};
