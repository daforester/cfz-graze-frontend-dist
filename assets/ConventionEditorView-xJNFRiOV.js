import{s as O}from"./index-OKsbKlsK.js";import{i as M,M as x,N as L,r as C,k as G,n as f,q as y,v as l,x as g,f as e,C as T,A,c as le,B as k,F as h,y as S,Q as K,D as E,P as Y,z as se,m as Ee,w as J,W as be,X as ye,Y as he,Z as _e,O as Re,s as ue,V as Be,$ as je}from"./index-4xYgdkuk.js";import{m as Ne,a as Fe,s as Se,F as Pe,b as X,_ as xe,c as ze}from"./FormRenderer.vue_vue_type_style_index_0_lang-h4p87ohu.js";import{_ as Q,a as Oe,V as He,b as Je}from"./VTabs-Cpp2G5Ti.js";import{_ as Z}from"./SaveButton.vue_vue_type_script_setup_true_lang-BlbXD-HM.js";import{V as ne,a as ie}from"./VToolbar-gn4a3g6g.js";import{V as N}from"./VBtn-nEpVgtCI.js";import{V as H,a as j}from"./VContainer-idBlWw-g.js";import{V as ae}from"./VSpacer-P0VeEwOm.js";import{V as Ve}from"./VToolbarItems-LNVf4ihN.js";import{c as Ue,e as re}from"./VCard-urNdGsWd.js";import{V as R}from"./VTextField-ozhsr0ft.js";import{_ as Me}from"./SelectGroups.vue_vue_type_script_setup_true_lang-AP5EDQXj.js";import{V as ke,a as oe,d as ee,b as $e}from"./VList-pzsIS5D0.js";import{V as F,a as I}from"./VRow-Oxnn8QB6.js";import{V as Te}from"./VDialog-Jh5_yO6e.js";import{v as q}from"./v4-yQnnJER4.js";import{V as me,a as ve,b as ce,c as pe,d as qe}from"./VDataTable-Uq3-5FMQ.js";import{V as De}from"./VTextarea-VqsE7Zly.js";import{V as Xe,T as w,a as We}from"./VAutocomplete-az6BX3mx.js";import{V as de}from"./VSelect-YZABySN7.js";import{V as W}from"./VCheckbox-GRXoYX3Q.js";import{V as we,a as Le}from"./VChip-UjoYyCBJ.js";import{V as Qe,a as te}from"./VTable-yK9iNvEt.js";import{_ as Ke}from"./DeleteDialog.vue_vue_type_script_setup_true_lang-WfhOTd1W.js";import{u as fe}from"./useModel-Tk3M0y9M.js";import{_ as Ae}from"./ModelDialog.vue_vue_type_script_setup_true_lang-apOlX0I_.js";import{V as Ye}from"./VDivider-wLg9up-4.js";import{a as Ze,F as el}from"./form-0fJbSFPv.js";import{V as ll}from"./forwardRefs-hvhJWHEi.js";import{u as Ce}from"./nil-rxyd0N8M.js";import{V as tl,a as al}from"./VWindowItem-1LIRjTd6.js";import"./submission-40fey8Hx.js";import"./copyToClipboard-aCoRGJiH.js";import"./VAvatar-y17-wQdN.js";import"./VFileInput-kdcjGNTf.js";import"./VForm-YXi4cMlk.js";import"./VCheckboxBtn-Jb8ySQZ2.js";import"./userData-SUa2peUG.js";import"./VOverlay-Y8ej_Na_.js";import"./scopeId-A-hmXfQ-.js";import"./createSimpleFunctional-j-ujQ2df.js";import"./filter-DVZn3oYe.js";var ge=(D=>(D.PER_ROOM="PER_ROOM",D.PER_PERSON="PER_PERSON",D))(ge||{});const ol=M({__name:"EditConventionExtraOptions",props:x({convention:{}},{modelValue:{},modelModifiers:{}}),emits:x(["close"],["update:modelValue"]),setup(D,{emit:r}){const n=r,i=L(D,"modelValue"),s=C(G(i.value)),d=()=>{i.value=s.value,n("close")};return(o,a)=>(f(),y(re,null,{default:l(()=>[e(ne,{dark:"",color:"primary"},{default:l(()=>[e(N,{icon:"",dark:"",onClick:a[0]||(a[0]=t=>n("close"))},{default:l(()=>[e(H,null,{default:l(()=>[g("mdi:mdi-close")]),_:1})]),_:1}),e(ie,null,{default:l(()=>[g("Edit Option Choice")]),_:1}),e(ae),e(Ve,null,{default:l(()=>[e(N,{variant:"text",onClick:d},{default:l(()=>[g(" Apply ")]),_:1})]),_:1})]),_:1}),e(Ue,{class:"pa-0"},{default:l(()=>[e(j,null,{default:l(()=>[e(R,{label:T(O).formLabelName,type:"text",variant:"outlined",modelValue:s.value.Name,"onUpdate:modelValue":a[1]||(a[1]=t=>s.value.Name=t)},null,8,["label","modelValue"]),e(R,{label:T(O).formLabelDescription,type:"text",variant:"outlined",modelValue:s.value.Description,"onUpdate:modelValue":a[2]||(a[2]=t=>s.value.Description=t)},null,8,["label","modelValue"]),e(R,{label:T(O).formLabelPrice,type:"text",variant:"outlined","prepend-icon":T(O).currencyIcon,modelValue:s.value.Price,"onUpdate:modelValue":a[3]||(a[3]=t=>s.value.Price=t),modelModifiers:{number:!0},hint:"Adds additional charges for selecting this option"},null,8,["label","prepend-icon","modelValue"]),e(Q,{modelValue:s.value.Tags,"onUpdate:modelValue":a[4]||(a[4]=t=>s.value.Tags=t),convention:o.convention,hint:"Tags acquired by selecting this option & any choice within it."},null,8,["modelValue","convention"]),s.value.Choices?(f(),y(Q,{key:0,modelValue:s.value.Choices,"onUpdate:modelValue":a[5]||(a[5]=t=>s.value.Choices=t),convention:o.convention,hint:"Sub-options (tags) that a user may choose from."},null,8,["modelValue","convention"])):A("",!0)]),_:1})]),_:1})]),_:1}))}}),nl=E("h3",null,"Options",-1),ul=M({__name:"EditConventionExtra",props:x({convention:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(D){const r=L(D,"modelValue"),n=C(G(r.value)),i=C(!1),s=C(0),d=Y(),o=C([""]),a=C([]),t=C([]);D.convention&&(d.getConventionTags(D.convention.ConventionUUID).then(c=>{t.value=c.sort((U,_)=>U.Title.localeCompare(_.Title))}),d.getOrganisationTags(D.convention.OrganisationUUID).then(c=>{a.value=c.sort((U,_)=>U.Title.localeCompare(_.Title))}));const u=le(()=>[...a.value,...t.value]),v=({callback:c})=>{d.saveExtra(n.value).then(U=>{U?(r.value=U,c&&c("Extra Saved")):c&&c("Failed to Save Extra")}).catch(()=>{c&&c("Failed to Save Extra")})},m=c=>{var U;c.Options||(c.Options=[]),c.Options.push({ID:0,OptionUUID:q(),ExtraID:c.ID,ExtraUUID:c.ExtraUUID,Order:((U=c.Options)==null?void 0:U.length)+1,Name:"",Description:"",Price:0,Choices:[],Tags:[]})},V=(c,U)=>{c.Options&&c.Options.splice(U,1)},p=c=>{if(c.Choices&&c.Choices.length>0)return c.Choices.map(U=>{const _=u.value.find(P=>P.TagUUID===U.TagUUID);if(_)return _.Title}).join(", ")};return(c,U)=>(f(),k(h,null,[e(j,{class:"px-0"},{default:l(()=>[e(R,{label:T(O).formLabelName,type:"text",variant:"outlined",modelValue:n.value.Name,"onUpdate:modelValue":U[0]||(U[0]=_=>n.value.Name=_)},null,8,["label","modelValue"]),e(R,{label:T(O).formLabelDescription,type:"text",variant:"outlined",modelValue:n.value.Description,"onUpdate:modelValue":U[1]||(U[1]=_=>n.value.Description=_)},null,8,["label","modelValue"]),e(Q,{modelValue:n.value.AppliesTags,"onUpdate:modelValue":U[2]||(U[2]=_=>n.value.AppliesTags=_),convention:c.convention,organisation:c.convention.OrganisationUUID,hint:"Tags a user acquires by selecting any option within this addon purchase."},null,8,["modelValue","convention","organisation"]),e(Q,{label:"Required Tags",variant:"outlined",modelValue:n.value.RequiredTags,"onUpdate:modelValue":U[3]||(U[3]=_=>n.value.RequiredTags=_),convention:c.convention,organisation:c.convention.OrganisationUUID,chips:"",clearable:"",hint:"Tags that a user must have to see this form. (Any one)"},null,8,["modelValue","convention","organisation"]),e(Me,{label:"Required Groups",variant:"outlined",modelValue:n.value.RequiredGroupMemberships,"onUpdate:modelValue":U[4]||(U[4]=_=>n.value.RequiredGroupMemberships=_),convention:c.convention,organisation:c.convention.OrganisationUUID,chips:"",clearable:"",hint:"Groups that a user must be in to see this form. (Any one)"},null,8,["modelValue","convention","organisation"]),nl,e(ke,{opened:o.value,"onUpdate:opened":U[5]||(U[5]=_=>o.value=_)},{default:l(()=>[(f(!0),k(h,null,K(n.value.Options,(_,P)=>(f(),k(h,{key:_.ID},[_?(f(),y(oe,{key:0,"prepend-icon":"mdi:mdi-ticket-percent",title:`${_.Name} ${_.Price&&_.Price>0?`(${T(O).currencySymbol}${_.Price})`:""}`},{append:l(()=>[e(N,{color:"red",icon:"mdi:mdi-close",size:"x-small",class:"mr-1",onClick:$=>V(n.value,P)},null,8,["onClick"]),e(N,{color:"primary",icon:"mdi:mdi-pencil",size:"x-small",onClick:$=>{i.value=!0,s.value=P}},null,8,["onClick"])]),default:l(()=>[_.Choices&&_.Choices.length>0?(f(),y(ee,{key:0},{default:l(()=>[g(" Options: "+S(p(_)),1)]),_:2},1024)):A("",!0)]),_:2},1032,["title"])):A("",!0)],64))),128))]),_:1},8,["opened"]),e(N,{color:"primary",onClick:U[6]||(U[6]=_=>m(n.value))},{default:l(()=>[g("Add Option")]),_:1}),e(F,null,{default:l(()=>[e(I,{class:"text-right"},{default:l(()=>[e(Z,{onClick:v})]),_:1})]),_:1})]),_:1}),e(Te,{modelValue:i.value,"onUpdate:modelValue":U[9]||(U[9]=_=>i.value=_),scrollable:""},{default:l(()=>[e(ol,{modelValue:n.value.Options[s.value],"onUpdate:modelValue":U[7]||(U[7]=_=>n.value.Options[s.value]=_),convention:c.convention,onClose:U[8]||(U[8]=_=>i.value=!1)},null,8,["modelValue","convention"])]),_:1},8,["modelValue"])],64))}}),il=M({__name:"EditConventionExtras",props:x({convention:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:x(["close"],["update:modelValue"]),setup(D,{emit:r}){const n=r,i=L(D,"modelValue"),s=Y(),d=()=>{const t={ID:0,ExtraUUID:q(),ConventionID:D.convention.ID,ConventionUUID:D.convention.ConventionUUID,Order:i.value.length+1,Name:"New Extra",Description:"",AppliesTags:[],RequiredTags:[],RequiredGroupMemberships:[],Options:[],Tags:[]};s.saveExtra(t).then(u=>{u&&i.value.push(u)})},o=t=>{s.deleteExtra(i.value[t].ExtraUUID).then(u=>{u&&i.value.splice(t,1)})},a=(...t)=>{t.forEach(u=>{u>=0&&u<i.value.length&&s.saveExtra(i.value[u])})};return(t,u)=>(f(),y(re,null,{default:l(()=>[e(ne,{dark:"",color:"primary"},{default:l(()=>[e(ie,null,{default:l(()=>[g("Edit Extras")]),_:1}),e(ae),e(Ve,null,{default:l(()=>[e(N,{variant:"text",onClick:d},{default:l(()=>[g(" Add ")]),_:1}),e(N,{icon:"",dark:"",onClick:u[0]||(u[0]=v=>n("close"))},{default:l(()=>[e(H,null,{default:l(()=>[g("mdi:mdi-close")]),_:1})]),_:1})]),_:1})]),_:1}),e(Ue,{class:"pa-0"},{default:l(()=>[e(me,null,{default:l(()=>[(f(!0),k(h,null,K(i.value,(v,m)=>(f(),y(ve,{key:v.ID,class:"mt-0"},{default:l(()=>[e(ce,null,{actions:l(({expanded:V})=>[e(N,{icon:"mdi:mdi-close",size:"x-small",color:"red",class:"mr-1",onClick:p=>o(m)},null,8,["onClick"]),e(H,{class:"align-self-center text-h5",icon:V?"mdi:mdi-chevron-up":"mdi:mdi-chevron-down",variant:"flat",size:"x-small"},null,8,["icon"])]),default:l(()=>[e(N,{icon:"mdi:mdi-menu-up",size:"x-small",color:"primary",class:"mr-1",onClick:se(V=>{T(Ne)(v,i.value),a(m,m-1)},["stop"])},null,8,["onClick"]),e(N,{icon:"mdi:mdi-menu-down",size:"x-small",color:"secondary",class:"mr-4",onClick:se(V=>{T(Fe)(v,i.value),a(m,m+1)},["stop"])},null,8,["onClick"]),g(" "+S(v.Name)+" ",1)]),_:2},1024),e(pe,{class:"px-0"},{default:l(()=>[e(ul,{convention:t.convention,modelValue:i.value[m],"onUpdate:modelValue":V=>i.value[m]=V},null,8,["convention","modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1}))}}),dl=E("h3",null,"Additional Purchases",-1),sl=E("p",null,"These are global ticket addons that are not tied to any particular ticket type.",-1),rl=M({__name:"Extras",props:{modelValue:{required:!0},modelModifiers:{}},emits:["update:modelValue"],setup(D){const r=L(D,"modelValue"),n=C([]),i=Y(),s=C([""]),d=C(!1),o=t=>{if(t.Choices&&t.Choices.length>0)return t.Choices.map(u=>u.Title).join(", ")},a=()=>{d.value=!1};return i==null||i.getConventionExtras(r.value.ConventionUUID||"").then(t=>{t&&(n.value=t)}),(t,u)=>(f(),k(h,null,[e(j,{fluid:!0,class:"px-0"},{default:l(()=>[e(F,null,{default:l(()=>[e(I,null,{default:l(()=>[dl]),_:1}),e(I,{class:"text-right"},{default:l(()=>[e(N,{color:"primary",onClick:u[0]||(u[0]=v=>d.value=!0)},{default:l(()=>[g("Edit")]),_:1})]),_:1})]),_:1})]),_:1}),sl,e(ke,{opened:s.value,"onUpdate:opened":u[1]||(u[1]=v=>s.value=v)},{default:l(()=>[(f(!0),k(h,null,K(n.value,v=>(f(),y($e,{key:v.ID,value:v.ID},{activator:l(({props:m})=>[e(oe,Ee(m,{"prepend-icon":"mdi:mdi-group",title:v.Name}),null,16,["title"])]),default:l(()=>[v.Options?(f(!0),k(h,{key:0},K(v.Options,m=>(f(),y(oe,{key:m.ID,"prepend-icon":"mdi:mdi-ticket-percent",title:`${m.Name} ${m.Price&&m.Price>0?`(${T(O).currencySymbol}${m.Price})`:""}`},{default:l(()=>[m.Choices&&m.Choices.length>0?(f(),y(ee,{key:0},{default:l(()=>[g(" Options: "+S(o(m)),1)]),_:2},1024)):A("",!0)]),_:2},1032,["title"]))),128)):A("",!0)]),_:2},1032,["value"]))),128))]),_:1},8,["opened"]),e(Te,{modelValue:d.value,"onUpdate:modelValue":u[3]||(u[3]=v=>d.value=v),scrollable:!0,persistent:!0,fullscreen:!0},{default:l(()=>[e(il,{modelValue:n.value,"onUpdate:modelValue":u[2]||(u[2]=v=>n.value=v),convention:r.value,onClose:a},null,8,["modelValue","convention"])]),_:1},8,["modelValue"])],64))}}),ml=M({__name:"EditConventionInterest",props:x({convention:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(D){const r=L(D,"modelValue"),n=C(G(r.value)),i=Y(),s=({callback:d})=>{i.saveInterest(n.value).then(o=>{o?(r.value=o,d&&d("Interest Saved")):d&&d("Failed to Save Interest")}).catch(()=>{d&&d("Failed to Save Interest")})};return(d,o)=>(f(),y(j,{class:"px-0"},{default:l(()=>[e(R,{label:T(O).formLabelName,type:"text",variant:"outlined",modelValue:n.value.Name,"onUpdate:modelValue":o[0]||(o[0]=a=>n.value.Name=a)},null,8,["label","modelValue"]),e(De,{label:T(O).formLabelDescription,type:"text",variant:"outlined",modelValue:n.value.Description,"onUpdate:modelValue":o[1]||(o[1]=a=>n.value.Description=a)},null,8,["label","modelValue"]),A("",!0),e(Q,{modelValue:n.value.AppliesTags,"onUpdate:modelValue":o[3]||(o[3]=a=>n.value.AppliesTags=a),convention:d.convention,organisation:d.convention.OrganisationUUID,hint:"Tags that a user acquires by selecting this interest."},null,8,["modelValue","convention","organisation"]),e(F,null,{default:l(()=>[e(I,{class:"text-right"},{default:l(()=>[e(Z,{onClick:s})]),_:1})]),_:1})]),_:1}))}}),vl=M({__name:"EditConventionInterests",props:x({convention:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:x(["close"],["update:modelValue"]),setup(D,{emit:r}){const n=r,i=L(D,"modelValue"),s=Y(),d=()=>{const t={ID:0,InterestUUID:q(),ConventionID:D.convention.ID,ConventionUUID:D.convention.ConventionUUID,Order:i.value.length+1,Name:"New Interest",Description:"",Price:0,AppliesTags:[]};s.saveInterest(t).then(u=>{u&&i.value.push(u)})},o=t=>{s.deleteInterest(i.value[t].InterestUUID).then(u=>{u&&i.value.splice(t,1)})},a=(...t)=>{t.forEach(u=>{u>=0&&u<i.value.length&&s.saveInterest(i.value[u])})};return(t,u)=>(f(),y(re,null,{default:l(()=>[e(ne,{dark:"",color:"primary"},{default:l(()=>[e(ie,null,{default:l(()=>[g("Edit Interests")]),_:1}),e(ae),e(Ve,null,{default:l(()=>[e(N,{variant:"text",onClick:d},{default:l(()=>[g(" Add ")]),_:1}),e(N,{icon:"",dark:"",onClick:u[0]||(u[0]=v=>n("close"))},{default:l(()=>[e(H,null,{default:l(()=>[g("mdi:mdi-close")]),_:1})]),_:1})]),_:1})]),_:1}),e(Ue,{class:"pa-0"},{default:l(()=>[e(me,null,{default:l(()=>[(f(!0),k(h,null,K(i.value,(v,m)=>(f(),y(ve,{key:v.ID,class:"mt-0"},{default:l(()=>[e(ce,null,{actions:l(({expanded:V})=>[e(Z,{class:"mr-1",color:"red",icon:"mdi:mdi-close",size:"x-small",onClick:p=>o(m)},null,8,["onClick"]),e(H,{class:"align-self-center text-h5",icon:V?"mdi:mdi-chevron-up":"mdi:mdi-chevron-down",variant:"flat",size:"x-small"},null,8,["icon"])]),default:l(()=>[e(N,{icon:"mdi:mdi-menu-up",size:"x-small",color:"primary",class:"mr-1",onClick:se(V=>{T(Ne)(v,i.value),a(m,m-1)},["stop"])},null,8,["onClick"]),e(N,{icon:"mdi:mdi-menu-down",size:"x-small",color:"secondary",class:"mr-4",onClick:se(V=>{T(Fe)(v,i.value),a(m,m+1)},["stop"])},null,8,["onClick"]),g(" "+S(v.Name)+" ",1)]),_:2},1024),e(pe,{class:"px-0"},{default:l(()=>[e(ml,{convention:t.convention,modelValue:i.value[m],"onUpdate:modelValue":V=>i.value[m]=V},null,8,["convention","modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1}))}}),cl=E("h3",null,"Interests",-1),pl=E("p",null,"Attendees can tag themselves for particular things.",-1),fl=M({__name:"Interests",props:{modelValue:{required:!0},modelModifiers:{}},emits:x(["refresh"],["update:modelValue"]),setup(D){const r=L(D,"modelValue"),n=Y(),i=C([]);n.getConventionInterests(r.value.ConventionUUID).then(o=>{Se(o),i.value=o});const s=C([""]),d=C(!1);return(o,a)=>(f(),k(h,null,[e(j,{fluid:!0,class:"px-0"},{default:l(()=>[e(F,null,{default:l(()=>[e(I,null,{default:l(()=>[cl]),_:1}),e(I,{class:"text-right"},{default:l(()=>[e(N,{color:"primary",onClick:a[0]||(a[0]=t=>d.value=!0)},{default:l(()=>[g("Edit")]),_:1})]),_:1})]),_:1})]),_:1}),pl,e(ke,{opened:s.value,"onUpdate:opened":a[1]||(a[1]=t=>s.value=t)},{default:l(()=>[(f(!0),k(h,null,K(i.value,t=>(f(),y(oe,{key:t.ID,"prepend-icon":"mdi:mdi-checkbox-marked-outline",title:`${t.Name} ${t.Price&&t.Price>0?`(${T(O).currencySymbol}${t.Price})`:""}`},{default:l(()=>[t.Description?(f(),y(ee,{key:0},{default:l(()=>[g(S(t.Description),1)]),_:2},1024)):A("",!0)]),_:2},1032,["title"]))),128))]),_:1},8,["opened"]),e(Te,{modelValue:d.value,"onUpdate:modelValue":a[4]||(a[4]=t=>d.value=t),scrollable:!0,fullscreen:!0,persistent:!0},{default:l(()=>[e(vl,{onClose:a[2]||(a[2]=t=>d.value=!1),convention:r.value,modelValue:i.value,"onUpdate:modelValue":a[3]||(a[3]=t=>i.value=t)},null,8,["convention","modelValue"])]),_:1},8,["modelValue"])],64))}}),Ie=M({__name:"SelectTickets",props:x({chips:{type:Boolean,default:!1},clearable:{type:Boolean,default:!1},hint:{default:"Tickets that belong to this group."},label:{default:"Tickets"},persistentHint:{type:Boolean,default:!1},tickets:{default:()=>[]},variant:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(D){const r=L(D,"modelValue"),n=s=>s.Type===w.TICKET_TYPE_GROUP?"mdi:mdi-group":s.Type===w.TICKET_TYPE_TICKET?s.RequiresAccommodation?"mdi:mdi-home":s.ComponentsRequired>0?"mdi:mdi-ticket-confirmation":"mdi:mdi-ticket":s.Type===w.TICKET_TYPE_TICKET_COMPONENT?"mdi:mdi-cog-outline":s.Type===w.TICKET_TYPE_ADD_ON?"mdi:mdi-home-plus":"mdi:mdi-help",i=le(()=>D.tickets.map(s=>({title:s.Name,value:r.value.find(d=>d&&d.TicketUUID===s.TicketUUID)||s,props:{appendIcon:n(s)}})));return(s,d)=>(f(),k("div",null,[e(Xe,{label:s.label,variant:s.variant||"filled",items:i.value,"item-title":"title","item-value":"value","item-props":"props",modelValue:r.value,"onUpdate:modelValue":d[0]||(d[0]=o=>r.value=o),hint:s.hint,chips:s.chips,clearable:s.clearable,multiple:"","persistent-hint":s.persistentHint},null,8,["label","variant","items","modelValue","hint","chips","clearable","persistent-hint"])]))}}),Vl=E("p",{title:"Automatically calculated",class:"text-grey-lighten-1"},"Applicable Accommodation:",-1),Ul=M({__name:"EditConventionTicket",props:x({accommodation:{default:()=>[]},convention:{},tickets:{default:()=>[]}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(D){const r=L(D,"modelValue"),n=C(G(r.value)),i=Y(),s=le(()=>D.tickets.filter(u=>u.Type===w.TICKET_TYPE_TICKET)),d=le(()=>D.tickets.filter(u=>u.Type===w.TICKET_TYPE_ADD_ON)),o=le(()=>D.tickets.filter(u=>u.Type===w.TICKET_TYPE_TICKET_COMPONENT)),a=u=>D.accommodation.filter(v=>v.Costs.find(m=>m.DateStart===u.DateStart&&m.DateEnd===u.DateEnd)),t=({callback:u})=>{i.saveTicket(n.value).then(v=>{v?(n.value.ID=v.ID,n.value.TicketUUID=v.TicketUUID,r.value=n.value,u&&u("Ticket Saved")):u&&u("Failed to Save Ticket")}).catch(()=>{u&&u("Failed to Save Ticket")})};return(u,v)=>(f(),y(j,{class:"px-0",fluid:""},{default:l(()=>[e(F,null,{default:l(()=>[e(I,{cols:"12"},{default:l(()=>[e(de,{label:"Ticket Type",variant:"outlined",modelValue:n.value.Type,"onUpdate:modelValue":v[0]||(v[0]=m=>n.value.Type=m),items:T(We),"item-title":"title","item-value":"value","hide-details":""},null,8,["modelValue","items"])]),_:1}),e(I,{cols:"12"},{default:l(()=>[e(R,{label:T(O).formLabelName,type:"text",variant:"outlined",modelValue:n.value.Name,"onUpdate:modelValue":v[1]||(v[1]=m=>n.value.Name=m),"hide-details":""},null,8,["label","modelValue"])]),_:1}),e(I,{cols:"12"},{default:l(()=>[e(R,{label:T(O).formLabelDescription,type:"text",variant:"outlined",modelValue:n.value.Description,"onUpdate:modelValue":v[2]||(v[2]=m=>n.value.Description=m),"hide-details":""},null,8,["label","modelValue"])]),_:1}),n.value.Type!==T(w).TICKET_TYPE_GROUP?(f(),k(h,{key:0},[e(I,{cols:"12"},{default:l(()=>[e(W,{label:T(O).formLabelRequiresAccommodation,modelValue:n.value.RequiresAccommodation,"onUpdate:modelValue":v[3]||(v[3]=m=>n.value.RequiresAccommodation=m),"hide-details":""},null,8,["label","modelValue"])]),_:1}),e(I,{cols:"12"},{default:l(()=>[e(R,{label:T(O).formLabelDateStart,type:"date",variant:"outlined",modelValue:n.value.DateStart,"onUpdate:modelValue":v[4]||(v[4]=m=>n.value.DateStart=m),"hide-details":""},null,8,["label","modelValue"])]),_:1}),e(I,{cols:"12"},{default:l(()=>[e(R,{label:T(O).formLabelDateEnd,type:"date",variant:"outlined",modelValue:n.value.DateEnd,"onUpdate:modelValue":v[5]||(v[5]=m=>n.value.DateEnd=m),"hide-details":""},null,8,["label","modelValue"])]),_:1}),e(I,{cols:"12"},{default:l(()=>[e(R,{label:T(O).formLabelPrice,type:"text",variant:"outlined","prepend-inner-icon":T(O).currencyIcon,modelValue:n.value.Price,"onUpdate:modelValue":v[6]||(v[6]=m=>n.value.Price=m),modelModifiers:{number:!0},"persistent-hint":"",hint:"Adds additional charges for selecting this ticket"},null,8,["label","prepend-inner-icon","modelValue"])]),_:1})],64)):(f(),y(I,{key:1,cols:"12"},{default:l(()=>[e(Ie,{label:"Tickets",variant:"outlined",tickets:s.value,modelValue:n.value.Tickets,"onUpdate:modelValue":v[7]||(v[7]=m=>n.value.Tickets=m),chips:"",clearable:"",multiple:"","persistent-hint":"",hint:"Tickets that belong to this group."},null,8,["tickets","modelValue"])]),_:1})),e(I,{cols:"12"},{default:l(()=>[e(Q,{label:"Applied Tags",variant:"outlined",modelValue:n.value.AppliesTags,"onUpdate:modelValue":v[8]||(v[8]=m=>n.value.AppliesTags=m),convention:u.convention,organisation:u.convention.OrganisationUUID,chips:"",clearable:"",hint:"Tags that a user acquires by selecting this ticket."},null,8,["modelValue","convention","organisation"])]),_:1}),e(I,{cols:"12"},{default:l(()=>[e(Q,{label:"Required Tags",variant:"outlined",modelValue:n.value.RequiredTags,"onUpdate:modelValue":v[9]||(v[9]=m=>n.value.RequiredTags=m),convention:u.convention,organisation:u.convention.OrganisationUUID,chips:"",clearable:"",hint:"Tags that a user must have to see this ticket."},null,8,["modelValue","convention","organisation"])]),_:1}),n.value.Type===T(w).TICKET_TYPE_TICKET?(f(),k(h,{key:2},[e(I,{cols:"12"},{default:l(()=>[e(R,{label:"Components Required",type:"number",variant:"outlined",modelValue:n.value.ComponentsRequired,"onUpdate:modelValue":v[10]||(v[10]=m=>n.value.ComponentsRequired=m),modelModifiers:{number:!0},"persistent-hint":"",hint:"How many components must be selected."},null,8,["modelValue"])]),_:1}),e(I,{cols:"12"},{default:l(()=>[e(Ie,{label:"Components",variant:"outlined",tickets:o.value,modelValue:n.value.TicketComponents,"onUpdate:modelValue":v[11]||(v[11]=m=>n.value.TicketComponents=m),chips:"",clearable:"",multiple:"","persistent-hint":"",hint:"Components that are part of this ticket (and others)."},null,8,["tickets","modelValue"])]),_:1}),e(I,{cols:"12"},{default:l(()=>[e(Ie,{label:"Addons",variant:"outlined",tickets:d.value,modelValue:n.value.AddonTickets,"onUpdate:modelValue":v[12]||(v[12]=m=>n.value.AddonTickets=m),chips:"",clearable:"",multiple:"","persistent-hint":"",hint:"Optional ticket addons that apply for this ticket."},null,8,["tickets","modelValue"])]),_:1})],64)):A("",!0),e(I,{cols:"12"},{default:l(()=>[e(Ie,{label:"Disables Tickets",variant:"outlined",tickets:u.tickets,modelValue:n.value.DisablesTickets,"onUpdate:modelValue":v[13]||(v[13]=m=>n.value.DisablesTickets=m),chips:"",clearable:"",multiple:"","persistent-hint":"",hint:"Tickets that are mutually exclusive and can't be selected if this one is."},null,8,["tickets","modelValue"])]),_:1})]),_:1}),a(n.value).length?(f(),y(F,{key:0,class:"align-center",dense:!0},{default:l(()=>[e(I,{class:"flex-grow-0 flex-shrink-1 text-no-wrap font-italic"},{default:l(()=>[Vl]),_:1}),e(I,{class:"flex-grow-1"},{default:l(()=>[e(we,null,{default:l(()=>[(f(!0),k(h,null,K(a(n.value),m=>(f(),y(Le,{key:m.ID,title:"Automatically calculated",disabled:!0},{default:l(()=>[g(S(m.Name),1)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})):A("",!0),e(F,null,{default:l(()=>[e(I,{class:"text-right"},{default:l(()=>[e(Z,{onClick:t})]),_:1})]),_:1})]),_:1}))}}),Tl={class:"pr-2"},Dl={class:"mb-2"},Il={key:0,class:"text-grey-darken-1 font-italic"},_l={key:1,class:"text-red"},yl={key:0,class:"text-grey-darken-1 font-italic"},Cl={key:1,class:"text-red"},gl={key:0,class:"text-grey-darken-1 font-italic"},bl={key:1,class:"text-red"},kl={class:"text-grey-darken-1"},El=M({__name:"EditConventionTickets",props:x({accommodation:{default:()=>[]},convention:{}},{modelValue:{default:[]},modelModifiers:{}}),emits:x(["close"],["update:modelValue"]),setup(D,{emit:r}){const n=L(D,"modelValue"),i=r,s=Y(),d=()=>{n.value.push({ID:0,TicketUUID:q(),ConventionID:D.convention.ID,ConventionUUID:D.convention.ConventionUUID,Order:n.value.length+1,Name:"New Ticket",Type:w.TICKET_TYPE_GROUP,Description:"",DateStart:"",DateEnd:"",Price:0,Tickets:[],RequiresAccommodation:!1,AppliesTags:[],RequiredTags:[],RequiredGroupMemberships:[],TicketComponents:[],ComponentsRequired:0,AddonTickets:[],DisablesTickets:[]})},o=t=>{s.deleteTicket(n.value[t].TicketUUID).then(u=>{u&&n.value.splice(t,1)})},a=t=>t.Type===w.TICKET_TYPE_GROUP?"mdi:mdi-group":t.Type===w.TICKET_TYPE_TICKET?t.RequiresAccommodation?"mdi:mdi-home":t.ComponentsRequired>0?"mdi:mdi-ticket-confirmation":"mdi:mdi-ticket":t.Type===w.TICKET_TYPE_TICKET_COMPONENT?"mdi:mdi-cog-outline":t.Type===w.TICKET_TYPE_ADD_ON?"mdi:mdi-home-plus":"mdi:mdi-help";return(t,u)=>(f(),y(re,null,{default:l(()=>[e(ne,{dark:"",color:"primary"},{default:l(()=>[e(ie,null,{default:l(()=>[g("Edit Tickets")]),_:1}),e(ae),e(Ve,null,{default:l(()=>[e(N,{variant:"text",onClick:d},{default:l(()=>[g(" Add Ticket ")]),_:1}),e(N,{icon:"",dark:"",onClick:u[0]||(u[0]=v=>i("close"))},{default:l(()=>[e(H,null,{default:l(()=>[g("mdi:mdi-close")]),_:1})]),_:1})]),_:1})]),_:1}),e(Ue,{class:"pa-0"},{default:l(()=>[e(me,null,{default:l(()=>[(f(!0),k(h,null,K(n.value,(v,m)=>(f(),y(ve,{key:v.ID,class:"mt-0"},{default:l(()=>[e(ce,{class:"py-2"},{actions:l(({expanded:V})=>[e(Z,{class:"mr-1",color:"red",icon:"mdi:mdi-close",size:"x-small",onClick:p=>o(m)},null,8,["onClick"]),e(H,{class:"align-self-center text-h5",icon:V?"mdi:mdi-chevron-up":"mdi:mdi-chevron-down",variant:"flat",size:"x-small"},null,8,["icon"])]),default:l(()=>[e(N,{icon:"mdi:mdi-menu-up",size:"x-small",color:"primary",class:"mr-1",onClick:se(V=>T(Ne)(v,n.value),["stop"])},null,8,["onClick"]),e(N,{icon:"mdi:mdi-menu-down",size:"x-small",color:"secondary",class:"mr-4",onClick:se(V=>T(Fe)(v,n.value),["stop"])},null,8,["onClick"]),E("div",Tl,[e(H,{icon:a(v)},null,8,["icon"])]),E("div",null,[E("p",Dl,[g(S(v.Name)+" ",1),v.Type===T(w).TICKET_TYPE_TICKET?(f(),k(h,{key:0},[n.value.find(V=>V.Type===T(w).TICKET_TYPE_GROUP&&V.Tickets.find(p=>p&&p.TicketUUID===v.TicketUUID))?(f(),k("span",Il," ("+S(n.value.filter(V=>V.Type===T(w).TICKET_TYPE_GROUP&&V.Tickets.find(p=>p&&p.TicketUUID===v.TicketUUID)).map(V=>V.Name).join(", "))+") ",1)):(f(),k("span",_l," (Ticket does not belong to any categories.) "))],64)):A("",!0),v.Type===T(w).TICKET_TYPE_ADD_ON?(f(),k(h,{key:1},[n.value.find(V=>V.Type===T(w).TICKET_TYPE_TICKET&&V.AddonTickets.find(p=>p&&p.TicketUUID===v.TicketUUID))?(f(),k("span",yl," ("+S(n.value.filter(V=>V.Type===T(w).TICKET_TYPE_TICKET&&V.AddonTickets.find(p=>p&&p.TicketUUID===v.TicketUUID)).map(V=>V.Name).join(", "))+") ",1)):(f(),k("span",Cl," (Ticket addon must be associated to at least one ticket.) "))],64)):A("",!0),v.Type===T(w).TICKET_TYPE_TICKET_COMPONENT?(f(),k(h,{key:2},[n.value.find(V=>V.Type===T(w).TICKET_TYPE_TICKET&&V.TicketComponents.find(p=>p&&p.TicketUUID===v.TicketUUID))?(f(),k("span",gl," ("+S(n.value.filter(V=>V.Type===T(w).TICKET_TYPE_TICKET&&V.TicketComponents.find(p=>p&&p.TicketUUID===v.TicketUUID)).map(V=>V.Name).join(", "))+") ",1)):(f(),k("span",bl," (Component has not been assigned to any tickets.) "))],64)):A("",!0)]),E("p",kl,[v.Type===T(w).TICKET_TYPE_GROUP?(f(),k(h,{key:0},[g("Category")],64)):v.Type===T(w).TICKET_TYPE_TICKET?(f(),k(h,{key:1},[g(" Ticket "),v.ComponentsRequired>0?(f(),k(h,{key:0},[g(" ("+S(v.ComponentsRequired)+" component"+S(v.ComponentsRequired>1?"s":"")+" required) ",1)],64)):A("",!0)],64)):A("",!0),v.Type===T(w).TICKET_TYPE_TICKET_COMPONENT?(f(),k(h,{key:2},[g("Component")],64)):A("",!0),v.Type===T(w).TICKET_TYPE_ADD_ON?(f(),k(h,{key:3},[g("Addon")],64)):A("",!0)])])]),_:2},1024),e(pe,{class:"px-0"},{default:l(()=>[e(Ul,{accommodation:t.accommodation,convention:t.convention,tickets:n.value,modelValue:n.value[m],"onUpdate:modelValue":V=>n.value[m]=V},null,8,["accommodation","convention","tickets","modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1}))}}),hl=E("h3",null,"Tickets",-1),$l=E("p",null,"Ticket options, along with all sub-types and options applicable to them.",-1),Nl=M({__name:"Tickets",props:{modelValue:{required:!0},modelModifiers:{}},emits:x(["refresh"],["update:modelValue"]),setup(D){var m;const r=L(D,"modelValue"),n=Y(),i=C([]),s=C([]);n.getConventionTickets(((m=r.value)==null?void 0:m.ConventionUUID)||"").then(V=>{Se(V),i.value=V});const d=C([""]),o=C(!1),a=V=>V.AddonTickets&&V.AddonTickets.map(p=>i.value&&i.value.find(c=>c.ID===p.ID)),t=V=>V.TicketComponents&&V.TicketComponents.map(p=>i.value&&i.value.find(c=>c.ID===p.ID)),u=V=>"",v=V=>s.value.filter(p=>p.Costs.find(c=>c.DateStart===V.DateStart&&c.DateEnd===V.DateEnd)).map(p=>p.Name).join(", ");return(V,p)=>(f(),k(h,null,[e(j,{fluid:!0,class:"px-0"},{default:l(()=>[e(F,null,{default:l(()=>[e(I,null,{default:l(()=>[hl]),_:1}),e(I,{class:"text-right"},{default:l(()=>[e(N,{color:"primary",onClick:p[0]||(p[0]=c=>o.value=!0)},{default:l(()=>[g("Edit")]),_:1})]),_:1})]),_:1})]),_:1}),$l,e(ke,{opened:d.value,"onUpdate:opened":p[1]||(p[1]=c=>d.value=c)},{default:l(()=>[(f(!0),k(h,null,K(i.value.filter(c=>c.Type===T(w).TICKET_TYPE_GROUP),c=>(f(),y($e,{key:c.ID,value:c.ID},{activator:l(({props:U})=>[e(oe,Ee(U,{"prepend-icon":"mdi:mdi-group",title:c.Name}),null,16,["title"])]),default:l(()=>[(f(!0),k(h,null,K(i.value.filter(U=>c.Tickets.find(_=>_&&U&&_.TicketUUID===U.TicketUUID)),U=>(f(),k(h,{key:U.ID},[U.AddonTickets&&U.AddonTickets.length?(f(),y($e,{key:0,value:U.ID},{activator:l(({props:_})=>[e(oe,Ee(_,{"prepend-icon":U.RequiresAccommodation?"mdi:mdi-home":U.ComponentsRequired>0?"mdi:mdi-ticket-confirmation":"mdi:mdi-ticket",title:`${U.Name} ${U.Price>0?`(${T(O).currencySymbol}${U.Price})`:""}`}),{default:l(()=>[U.ComponentsRequired>0?(f(),y(ee,{key:0},{default:l(()=>[g(" Options: "+S(t(U).map(P=>P&&P.Name).join(", ")),1)]),_:2},1024)):A("",!0),U.RequiresAccommodation&&v(U)?(f(),y(ee,{key:1},{default:l(()=>[g(" Accommodation: "+S(v(U)),1)]),_:2},1024)):A("",!0)]),_:2},1040,["prepend-icon","title"])]),default:l(()=>[(f(!0),k(h,null,K(a(U),_=>(f(),k(h,{key:_},[_?(f(),y(oe,{key:0,title:`${_.Name} ${_.Price>0?`(${T(O).currencySymbol}${_.Price})`:""}`,"prepend-icon":"mdi:mdi-home-plus"},{default:l(()=>[_.RequiredTags&&_.RequiredTags.length>0?(f(),y(ee,{key:0},{default:l(()=>[g(" Required Tags: "+S(_.RequiredTags.join(", ")),1)]),_:2},1024)):A("",!0),_.RequiredGroupMemberships&&_.RequiredGroupMemberships.length>0?(f(),y(ee,{key:1},{default:l(()=>[g(" Required Groups: "+S(u(_.RequiredGroupMemberships)),1)]),_:2},1024)):A("",!0),v(_)?(f(),y(ee,{key:2},{default:l(()=>[g(" Accommodation: "+S(v(_)),1)]),_:2},1024)):A("",!0)]),_:2},1032,["title"])):A("",!0)],64))),128))]),_:2},1032,["value"])):(f(),y(oe,{key:1,"prepend-icon":U.RequiresAccommodation?"mdi:mdi-home":U.ComponentsRequired>0?"mdi:mdi-ticket-confirmation":"mdi:mdi-ticket",title:`${U.Name} ${U.Price>0?`(${T(O).currencySymbol}${U.Price})`:""}`},{default:l(()=>[U.ComponentsRequired>0?(f(),y(ee,{key:0},{default:l(()=>[g(" Options: "+S(t(U).map(_=>_&&_.Name).join(", ")),1)]),_:2},1024)):A("",!0)]),_:2},1032,["prepend-icon","title"]))],64))),128))]),_:2},1032,["value"]))),128))]),_:1},8,["opened"]),e(Te,{modelValue:o.value,"onUpdate:modelValue":p[4]||(p[4]=c=>o.value=c),scrollable:!0,fullscreen:!0,persistent:!0},{default:l(()=>[e(El,{onClose:p[2]||(p[2]=c=>o.value=!1),modelValue:i.value,"onUpdate:modelValue":p[3]||(p[3]=c=>i.value=c),accommodation:s.value,convention:r.value},null,8,["modelValue","accommodation","convention"])]),_:1},8,["modelValue"])],64))}}),Fl=M({__name:"VenueRoomCost",props:{modelValue:{required:!0},modelModifiers:{}},emits:x(["deleted"],["update:modelValue"]),setup(D,{emit:r}){const n=r,i=L(D,"modelValue"),s=[{title:"Per Room",value:"PER_ROOM"},{title:"Per Person",value:"PER_PERSON"}],d=()=>{n("deleted")};return(o,a)=>(f(),y(F,{dense:""},{default:l(()=>[e(I,{cols:"12",sm:"4",md:"2",lg:"2"},{default:l(()=>[e(R,{label:T(O).formLabelDateStart,type:"date",variant:"outlined",modelValue:i.value.DateStart,"onUpdate:modelValue":a[0]||(a[0]=t=>i.value.DateStart=t)},null,8,["label","modelValue"])]),_:1}),e(I,{cols:"12",sm:"4",md:"2",lg:"2"},{default:l(()=>[e(R,{label:T(O).formLabelDateEnd,type:"date",variant:"outlined",modelValue:i.value.DateEnd,"onUpdate:modelValue":a[1]||(a[1]=t=>i.value.DateEnd=t)},null,8,["label","modelValue"])]),_:1}),e(I,{cols:"6",sm:"4",md:"2",lg:"2"},{default:l(()=>[e(R,{label:T(O).formLabelAvailability,type:"number",variant:"outlined",modelValue:i.value.Availability,"onUpdate:modelValue":a[2]||(a[2]=t=>i.value.Availability=t),modelModifiers:{number:!0}},null,8,["label","modelValue"])]),_:1}),e(I,{cols:"6",sm:"4",md:"2",lg:"2"},{default:l(()=>[e(R,{label:T(O).formLabelPrice,type:"number","prepend-inner-icon":"mdi:mdi-currency-gbp",variant:"outlined",modelValue:i.value.Price,"onUpdate:modelValue":a[3]||(a[3]=t=>i.value.Price=t),modelModifiers:{number:!0}},null,8,["label","modelValue"])]),_:1}),e(I,{cols:"6",sm:"4",md:"3",lg:"3"},{default:l(()=>[e(de,{label:T(O).formLabelPriceType,variant:"outlined",modelValue:i.value.Type,"onUpdate:modelValue":a[4]||(a[4]=t=>i.value.Type=t),items:s,"item-value":"value","item-title":"title"},null,8,["label","modelValue"])]),_:1}),e(I,{cols:"6",sm:"4",md:"1",class:"text-right"},{default:l(()=>[e(N,{color:"red",icon:"mdi:mdi-minus",onClick:d})]),_:1})]),_:1}))}}),Al=E("strong",null,"Capacity:",-1),Rl=E("thead",null,[E("tr",null,[E("th",null,"Date"),E("th",null,"Price"),E("th",null,"Availability")])],-1),Sl={class:"d-flex flex-wrap justify-space-between",style:{gap:"1rem"}},Pl=E("h4",null," Availability & Costs (To Organisation) ",-1),xl=M({__name:"VenueRoom",props:{modelValue:{required:!0},modelModifiers:{}},emits:x(["deleted"],["update:modelValue"]),setup(D,{emit:r}){const n=Y(),i=r,s=C(O),d=L(D,"modelValue"),o=C(G(d.value)),a=C(!1),t=p=>{switch(p.Type){case ge.PER_PERSON:return s.value.enumPER_PERSON;case ge.PER_ROOM:return s.value.enumPER_ROOM}return"Unknown"},u=()=>{o.value.Costs||(o.value.Costs=[]),o.value.Costs.push({ID:0,CostUUID:q(),Availability:0,DateStart:"",DateEnd:"",Price:0,Type:"PER_ROOM"})},v=p=>{o.value.Costs.splice(p,1)},m=({callback:p})=>{const c=()=>{p&&p("Failed to Delete Room")},U=()=>{p&&p("Room Deleted")};n.deleteRoom(o.value.RoomUUID).then(_=>{_?(U(),i("deleted",o.value)):c()}).catch(()=>{c()})},V=()=>{n.saveRoom(o.value).then(()=>{d.value=o.value,a.value=!1})};return(p,c)=>(f(),k(h,null,[e(j,{fluid:"",class:"pa-1 pa-sm-2"},{default:l(()=>[E("h4",null,S(o.value.Name),1),E("p",null,S(o.value.Notes),1),E("p",null,[Al,g(" "+S(o.value.MinimumCapacity)+" ",1),o.value.MinimumCapacity!=o.value.MaximumCapacity?(f(),k(h,{key:0},[g(" - "+S(o.value.MaximumCapacity),1)],64)):A("",!0)]),e(Qe,{density:"compact"},{default:l(()=>[Rl,E("tbody",null,[(f(!0),k(h,null,K(o.value.Costs,U=>(f(),k("tr",{key:`venue-room-${o.value.ID}-cost-${U.ID}`},[E("td",null,S(U.DateStart)+" - "+S(U.DateEnd),1),E("td",null,S(s.value.currencySymbol)+S(U.Price)+" "+S(t(U)),1),E("td",null,S(U.Availability),1)]))),128))])]),_:1}),E("div",Sl,[e(N,{color:"primary","prepend-icon":"mdi:mdi-playlist-edit",onClick:c[0]||(c[0]=U=>a.value=!0)},{default:l(()=>[g("Edit Room")]),_:1}),e(Z,{color:"red-darken-3","prepend-icon":"mdi:mdi-minus",onClick:m},{default:l(()=>[g("Delete Room")]),_:1})])]),_:1}),e(Te,{scrollable:"",modelValue:a.value,"onUpdate:modelValue":c[6]||(c[6]=U=>a.value=U),width:"auto"},{default:l(()=>[e(re,null,{default:l(()=>[e(ne,{dark:"",color:"primary"},{default:l(()=>[e(N,{icon:"",dark:"",onClick:c[1]||(c[1]=U=>a.value=!1)},{default:l(()=>[e(H,null,{default:l(()=>[g("mdi:mdi-close")]),_:1})]),_:1}),e(ie,null,{default:l(()=>[g("Room Details ("+S(o.value.Name)+")",1)]),_:1}),e(ae),e(Ve,null,{default:l(()=>[e(N,{variant:"text",onClick:V},{default:l(()=>[g(" Save ")]),_:1})]),_:1})]),_:1}),e(Ue,null,{default:l(()=>[e(te,null,{default:l(()=>[e(F,null,{default:l(()=>[e(I,{cols:"12"},{default:l(()=>[e(R,{label:s.value.formLabelName,type:"text",variant:"outlined",modelValue:o.value.Name,"onUpdate:modelValue":c[2]||(c[2]=U=>o.value.Name=U)},null,8,["label","modelValue"])]),_:1})]),_:1}),e(F,null,{default:l(()=>[e(I,null,{default:l(()=>[e(De,{label:s.value.formLabelNotes,variant:"outlined",modelValue:o.value.Notes,"onUpdate:modelValue":c[3]||(c[3]=U=>o.value.Notes=U)},null,8,["label","modelValue"])]),_:1})]),_:1}),e(F,null,{default:l(()=>[e(I,{cols:"12",sm:"6"},{default:l(()=>[e(R,{type:"number",label:s.value.formLabelMinimumCapacity,variant:"outlined",modelValue:o.value.MinimumCapacity,"onUpdate:modelValue":c[4]||(c[4]=U=>o.value.MinimumCapacity=U),modelModifiers:{number:!0}},null,8,["label","modelValue"])]),_:1}),e(I,{cols:"12",sm:"6"},{default:l(()=>[e(R,{type:"number",label:s.value.formLabelMaximumCapacity,variant:"outlined",modelValue:o.value.MaximumCapacity,"onUpdate:modelValue":c[5]||(c[5]=U=>o.value.MaximumCapacity=U),modelModifiers:{number:!0}},null,8,["label","modelValue"])]),_:1})]),_:1}),e(F,null,{default:l(()=>[e(I,null,{default:l(()=>[Pl]),_:1})]),_:1}),(f(!0),k(h,null,K(o.value.Costs,(U,_)=>(f(),k(h,{key:`venue-room-${o.value.ID}-cost-${U.ID}`},[o.value.Costs&&o.value.Costs[_]?(f(),y(Fl,{key:0,modelValue:o.value.Costs[_],"onUpdate:modelValue":P=>o.value.Costs[_]=P,onDeleted:P=>v(_)},null,8,["modelValue","onUpdate:modelValue","onDeleted"])):A("",!0)],64))),128)),e(N,{color:"primary","prepend-icon":"mdi:mdi-plus",onClick:u},{default:l(()=>[g("Add Row")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}}),Ol=E("h3",null,"Rooms",-1),Ml=M({__name:"Venue",props:{modelValue:{required:!0},modelModifiers:{}},emits:x(["deleted"],["update:modelValue"]),setup(D,{emit:r}){const n=Y(),i=r,s=L(D,"modelValue"),d=C(G(s.value)),o=C([]),a=C(!1),t=C(!1);n.getVenueRooms(d.value.VenueUUID).then(p=>{o.value=p}),J(d.value,()=>{t.value=!0});const u=({callback:p})=>{a.value=!0,n.saveVenue(d.value).then(()=>{a.value=!1,t.value=!1,s.value=d.value,p&&p("Venue Saved")}).catch(()=>{a.value=!1,p&&p("Failed to Saved Venue")})},v=({callback:p})=>{a.value=!0,n.deleteVenue(d.value.VenueUUID).then(c=>{a.value=!1,c?p&&(p("Venue Deleted"),i("deleted")):p&&p("Failed to Delete Venue")}).catch(()=>{p&&(p("Failed to Delete Venue"),a.value=!1)})},m=()=>{const p={ID:0,RoomUUID:q(),VenueID:d.value.ID,VenueUUID:d.value.VenueUUID,Order:o.value.length+1,Name:"New Room",Notes:"",MaximumCapacity:1,MinimumCapacity:1,Costs:[]};n.saveRoom(p).then(c=>{c&&o.value.push(c)})},V=(p,c)=>{n.deleteRoom(o.value[c].RoomUUID).then(U=>{U&&o.value.splice(c,1)})};return(p,c)=>(f(),y(ve,null,{default:l(()=>[e(ce,null,{default:l(()=>[g(S(d.value.Name),1)]),_:1}),e(pe,null,{default:l(()=>[e(F,{"no-gutters":""},{default:l(()=>[e(I,{cols:"12"},{default:l(()=>[e(R,{label:T(O).formLabelName,name:"name",variant:"outlined",modelValue:d.value.Name,"onUpdate:modelValue":c[0]||(c[0]=U=>d.value.Name=U)},null,8,["label","modelValue"])]),_:1}),e(I,{cols:"12"},{default:l(()=>[e(De,{label:T(O).formLabelDescription,name:"description",variant:"outlined",modelValue:d.value.Description,"onUpdate:modelValue":c[1]||(c[1]=U=>d.value.Description=U)},null,8,["label","modelValue"])]),_:1}),e(I,{class:"text-right",cols:"12"},{default:l(()=>[e(Z,{class:"mr-2",color:"red-darken-3",label:"Delete",onClick:v}),e(Z,{enabled:t.value,timeout:"7",onClick:u},null,8,["enabled"])]),_:1})]),_:1}),Ol,(f(!0),k(h,null,K(o.value,(U,_)=>(f(),y(te,{variant:"elevation",elevation:"6",key:`venue-room-${U.ID}`},{default:l(()=>[o.value&&o.value[_]?(f(),y(xl,{key:0,modelValue:o.value[_],"onUpdate:modelValue":P=>o.value[_]=P,onDeleted:P=>V(P,_)},null,8,["modelValue","onUpdate:modelValue","onDeleted"])):A("",!0)]),_:2},1024))),128)),e(te,{class:"ma-2"},{default:l(()=>[e(N,{color:"primary","prepend-icon":"mdi:mdi-plus",onClick:m},{default:l(()=>[g("Add Room")]),_:1})]),_:1})]),_:1})]),_:1}))}}),ql=E("h3",null,"Venues",-1),wl=E("p",null," Venues and the rooms they supply to the organisation, this is internal data not seen by attendees. ",-1),Ll=E("p",null," Attendee options are configured via the accommodation tab. ",-1),Kl=M({__name:"VenuesEditorView",props:{modelValue:{required:!0},modelModifiers:{}},emits:x(["close","pageTitle","refresh"],["update:modelValue"]),setup(D,{emit:r}){const n=Y(),i=r,s=L(D,"modelValue");i("pageTitle","Venues");const d=C([]);n.getConventionVenues(s.value.ConventionUUID).then(t=>{d.value=t});const o=()=>{const t={ID:0,VenueUUID:q(),ConventionID:s.value.ID,ConventionUUID:s.value.ConventionUUID,Order:d.value.length+1,Name:"New Venue",Description:"",Rooms:[]};n.saveVenue(t).then(u=>{u&&d.value.push(u)})},a=t=>{d.value.splice(t,1)};return(t,u)=>(f(),k(h,null,[e(j,{fluid:"",class:"px-0"},{default:l(()=>[e(F,null,{default:l(()=>[e(I,null,{default:l(()=>[ql]),_:1})]),_:1})]),_:1}),wl,Ll,e(te,null,{default:l(()=>[e(me,{variant:"accordion"},{default:l(()=>[(f(!0),k(h,null,K(d.value,(v,m)=>(f(),y(Ml,{key:`venues-${v.ID}`,modelValue:d.value[m],"onUpdate:modelValue":V=>d.value[m]=V,onDeleted:V=>a(m)},null,8,["modelValue","onUpdate:modelValue","onDeleted"]))),128))]),_:1}),e(te,{class:"pa-2"},{default:l(()=>[e(N,{color:"primary",onClick:o},{default:l(()=>[g("Add Venue")]),_:1})]),_:1})]),_:1})],64))}}),Yl=E("p",{title:"Automatically calculated",class:"text-grey-lighten-1"},"Applicable Tickets:",-1),Gl=M({__name:"AccommodationCost",props:x({convention:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:x(["deleted"],["update:modelValue"]),setup(D,{emit:r}){const n=r,i=L(D,"modelValue"),s=C([]);Y().getConventionTickets(D.convention.ConventionUUID).then(u=>{u&&(s.value=u)});const o=[{title:"Per Room",value:"PER_ROOM"},{title:"Per Person",value:"PER_PERSON"}],a=()=>{n("deleted")},t=le(()=>s.value.filter(u=>(u.Type===w.TICKET_TYPE_TICKET||u.Type===w.TICKET_TYPE_ADD_ON)&&u.RequiresAccommodation&&u.DateStart===i.value.DateStart&&u.DateEnd===i.value.DateEnd));return(u,v)=>(f(),k(h,null,[e(F,{class:"align-center",dense:""},{default:l(()=>[e(I,{class:"flex-grow-0 flex-shrink-1 text-no-wrap font-italic"},{default:l(()=>[Yl]),_:1}),e(I,{class:"flex-grow-1"},{default:l(()=>[e(we,null,{default:l(()=>[(f(!0),k(h,null,K(t.value,m=>(f(),y(Le,{key:m.ID,title:"Automatically calculated",disabled:""},{default:l(()=>[g(S(m.Name),1)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1}),e(F,{dense:""},{default:l(()=>[e(I,{cols:"12",sm:"6",md:"3"},{default:l(()=>[e(R,{label:T(O).formLabelDateStart,type:"date",variant:"outlined",modelValue:i.value.DateStart,"onUpdate:modelValue":v[0]||(v[0]=m=>i.value.DateStart=m)},null,8,["label","modelValue"])]),_:1}),e(I,{cols:"12",sm:"6",md:"3"},{default:l(()=>[e(R,{label:T(O).formLabelDateEnd,type:"date",variant:"outlined",modelValue:i.value.DateEnd,"onUpdate:modelValue":v[1]||(v[1]=m=>i.value.DateEnd=m)},null,8,["label","modelValue"])]),_:1}),e(I,{cols:"5",sm:"6",md:"3"},{default:l(()=>[e(R,{label:T(O).formLabelPrice,type:"number","prepend-inner-icon":"mdi:mdi-currency-gbp",variant:"outlined",modelValue:i.value.Price,"onUpdate:modelValue":v[2]||(v[2]=m=>i.value.Price=m),modelModifiers:{number:!0}},null,8,["label","modelValue"])]),_:1}),e(I,{cols:"5",sm:"4",md:"2"},{default:l(()=>[e(de,{label:T(O).formLabelPriceType,variant:"outlined",modelValue:i.value.Type,"onUpdate:modelValue":v[3]||(v[3]=m=>i.value.Type=m),items:o,"item-value":"value","item-title":"title"},null,8,["label","modelValue"])]),_:1}),e(I,{cols:"2",sm:"2",md:"1",class:"text-right"},{default:l(()=>[e(N,{color:"red",icon:"mdi:mdi-minus",onClick:a})]),_:1})]),_:1})],64))}}),Bl=E("h4",null," Room Pool ",-1),jl=E("p",{class:"mb-4"}," Hotel rooms that can be used for this accommodation option. ",-1),zl=E("p",null," Pool total: ",-1),Hl=E("h4",null," Accommodation Costs ",-1),Jl=E("p",{class:"mb-4"}," How much the attendee is charged by the convention for the accommodation. ",-1),Xl=M({__name:"Accommodation",props:x({convention:{},venues:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:x(["deleted"],["update:modelValue"]),setup(D,{emit:r}){const n=Y(),i=r,s=L(D,"modelValue"),d=C(G(s.value)),o=le(()=>D.venues.map(m=>m.Rooms.map(V=>({title:` ${m.Name} - ${V.Name}`,value:V}))).flat()),a=()=>{d.value.Costs||(d.value.Costs=[]),d.value.Costs.push({ID:0,CostUUID:q(),Availability:0,DateStart:"",DateEnd:"",Price:0,Type:ge.PER_ROOM})},t=m=>{d.value.Costs.splice(m,1)},u=({callback:m})=>{n.deleteAccommodation(d.value.AccommodationUUID).then(V=>{V?m&&(m("Accommodation Deleted"),i("deleted")):m&&m("Failed to Delete Accommodation")}).catch(()=>{m&&m("Failed to Delete Accommodation")})},v=({callback:m})=>{n.saveAccommodation(d.value).then(V=>{V?(d.value.ID=V.ID,s.value=V,m&&m("Accommodation Saved")):m&&m("Failed to Save Accommodation")}).catch(()=>{m&&m("Failed to Save Accommodation")})};return(m,V)=>(f(),y(ve,null,{default:l(()=>[e(ce,null,{default:l(()=>[g(S(d.value.Name),1)]),_:1}),e(pe,null,{default:l(()=>[e(te,null,{default:l(()=>[e(F,null,{default:l(()=>[e(I,null,{default:l(()=>[e(R,{modelValue:d.value.Name,"onUpdate:modelValue":V[0]||(V[0]=p=>d.value.Name=p),label:"Name",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1})]),_:1}),e(F,null,{default:l(()=>[e(I,null,{default:l(()=>[Bl,jl,e(de,{clearable:!0,modelValue:d.value.Pool,"onUpdate:modelValue":V[1]||(V[1]=p=>d.value.Pool=p),items:o.value,label:"Select",multiple:"",hint:"Pick appropriate rooms","persistent-hint":"",variant:"outlined","item-title":"title","item-value":"value",eager:!0},null,8,["modelValue","items"]),zl,E("p",null,[e(Q,{label:"Required Tags",variant:"outlined",modelValue:d.value.RequiredTags,"onUpdate:modelValue":V[2]||(V[2]=p=>d.value.RequiredTags=p),convention:m.convention,organisation:m.convention.OrganisationUUID,chips:!0,clearable:!0,hint:"Tags that a user must have to select this accommodation."},null,8,["modelValue","convention","organisation"])]),Hl,Jl,d.value.Costs?(f(!0),k(h,{key:0},K(d.value.Costs,(p,c)=>(f(),y(Gl,{key:`venue-room-${d.value.ID}-cost-${p.ID}`,convention:m.convention,modelValue:d.value.Costs[c],"onUpdate:modelValue":U=>d.value.Costs[c]=U,onDeleted:U=>t(c)},null,8,["convention","modelValue","onUpdate:modelValue","onDeleted"]))),128)):A("",!0)]),_:1})]),_:1}),e(F,{"no-gutters":""},{default:l(()=>[e(I,{class:"text-left"},{default:l(()=>[e(N,{color:"primary","prepend-icon":"mdi:mdi-plus",onClick:a},{default:l(()=>[g("Add Row")]),_:1})]),_:1}),e(I,{class:"text-right"},{default:l(()=>[e(Z,{class:"mr-2",color:"red-darken-3",label:"Delete",onClick:u}),e(Z,{onClick:v})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}))}}),Wl=E("h3",null,"Accommodation",-1),Ql=E("p",null," Accommodation options presented to attendees, these are effectively virtual room types which are linked to the available room pools created in the venues tab. ",-1),Zl=E("p",null," Use the venues tab to configure internal data about the venues and room supply. ",-1),et=M({__name:"AccommodationEditorView",props:{modelValue:{required:!0},modelModifiers:{}},emits:["update:modelValue"],setup(D){const r=Y(),n=L(D,"modelValue"),i=C([]),s=C([]);r.getConventionAccommodation(n.value.ConventionUUID).then(a=>{a&&(i.value=a)}),r.getConventionVenues(n.value.ConventionUUID).then(a=>{a&&(s.value=a)});const d=()=>{const a={ID:0,AccommodationUUID:q(),ConventionID:n.value.ID,ConventionUUID:n.value.ConventionUUID,Order:i.value.length+1,Name:"New Accommodation Option",Pool:[],Costs:[],RequiredTags:[]};r.saveAccommodation(a).then(t=>{t&&i.value.push(t)})},o=a=>{i.value.splice(a,1)};return(a,t)=>(f(),k(h,null,[e(j,{fluid:!0,class:"px-0"},{default:l(()=>[e(F,null,{default:l(()=>[e(I,null,{default:l(()=>[Wl]),_:1})]),_:1})]),_:1}),Ql,Zl,e(te,null,{default:l(()=>[e(me,{variant:"accordion"},{default:l(()=>[(f(!0),k(h,null,K(i.value,(u,v)=>(f(),y(Xl,{key:u.AccommodationUUID,convention:n.value,venues:s.value,modelValue:i.value[v],"onUpdate:modelValue":m=>i.value[v]=m,onDeleted:m=>o(v)},null,8,["convention","venues","modelValue","onUpdate:modelValue","onDeleted"]))),128))]),_:1}),e(te,{class:"pa-2"},{default:l(()=>[e(N,{color:"primary",onClick:d},{default:l(()=>[g("Add Accommodation")]),_:1})]),_:1})]),_:1})],64))}}),lt=M({__name:"EditFieldDialogExtras",props:{modelValue:{required:!0},modelModifiers:{}},emits:["update:modelValue"],setup(D){const r=L(D,"modelValue"),n=be.getInstance(),i=C([]),s=C([]);return n==null||n.getConventionExtras(r.value.ConventionUUID).then(d=>{i.value=d;const o=r.value.Values.find(a=>a.Title==="SelectedExtras");if(o)try{s.value=JSON.parse(o.Value)}catch{}}),J(s,()=>{const d=r.value.Values.find(o=>o.Title==="SelectedExtras");if(d)d.Value=JSON.stringify(s.value);else{const o={ID:0,FieldValueUUID:q(),FieldID:r.value.ID,FieldUUID:r.value.FieldUUID,Title:"SelectedExtras",Value:JSON.stringify(s.value)};r.value.Values.push(o)}}),(d,o)=>(f(!0),k(h,null,K(i.value,a=>(f(),y(W,{key:a.ExtraUUID,modelValue:s.value,"onUpdate:modelValue":o[0]||(o[0]=t=>s.value=t),label:a.Name,value:a.ExtraUUID,name:r.value.Name,"hide-details":""},null,8,["modelValue","label","value","name"]))),128))}}),tt=M({__name:"EditFieldDialogInterests",props:{modelValue:{required:!0},modelModifiers:{}},emits:["update:modelValue"],setup(D){const r=L(D,"modelValue"),n=be.getInstance(),i=C([]),s=C([]);return n==null||n.getConventionInterests(r.value.ConventionUUID).then(d=>{i.value=d;const o=r.value.Values.find(a=>a.Title==="SelectedInterests");if(o)try{s.value=JSON.parse(o.Value)}catch{}}),J(s,()=>{const d=r.value.Values.find(o=>o.Title==="SelectedInterests");if(d)d.Value=JSON.stringify(s.value);else{const o={ID:0,FieldValueUUID:q(),FieldID:r.value.ID,FieldUUID:r.value.FieldUUID,Title:"SelectedInterests",Value:JSON.stringify(s.value)};r.value.Values.push(o)}}),(d,o)=>(f(!0),k(h,null,K(i.value,a=>(f(),y(W,{key:a.InterestUUID,modelValue:s.value,"onUpdate:modelValue":o[0]||(o[0]=t=>s.value=t),label:a.Name,value:a.InterestUUID,name:r.value.Name,"hide-details":""},null,8,["modelValue","label","value","name"]))),128))}}),at=M({__name:"EditFieldDialogTickets",props:{modelValue:{required:!0},modelModifiers:{}},emits:["update:modelValue"],setup(D){const r=L(D,"modelValue"),n=be.getInstance(),i=C([]),s=C([]);return n==null||n.getConventionTickets(r.value.ConventionUUID).then(d=>{i.value=d;const o=r.value.Values.find(a=>a.Title==="SelectedTickets");if(o)try{s.value=JSON.parse(o.Value)}catch{}}),J(s,()=>{const d=r.value.Values.find(o=>o.Title==="SelectedTickets");if(d)d.Value=JSON.stringify(s.value);else{const o={ID:0,FieldValueUUID:q(),FieldID:r.value.ID,FieldUUID:r.value.FieldUUID,Title:"SelectedTickets",Value:JSON.stringify(s.value)};r.value.Values.push(o)}}),(d,o)=>(f(!0),k(h,null,K(i.value.filter(a=>a&&a.Type===T(w).TICKET_TYPE_GROUP),a=>(f(),y(W,{key:a.TicketUUID,modelValue:s.value,"onUpdate:modelValue":o[0]||(o[0]=t=>s.value=t),label:a.Name,value:a.TicketUUID,name:r.value.Name,"hide-details":""},null,8,["modelValue","label","value","name"]))),128))}}),ot=E("h5",null,"Display Options",-1),nt=E("h5",null,"Accommodation Choices",-1),ut=M({__name:"EditFieldDialogAccommodation",props:{modelValue:{required:!0},modelModifiers:{}},emits:["update:modelValue"],setup(D){const r=L(D,"modelValue"),n=be.getInstance(),i=C([]),s=C(r.value.Values.map(a=>a.Value)),d=C({sharing:!1});try{const a=JSON.parse(r.value.Data);a&&(d.value=a)}catch{}const o=()=>{r.value.Data=JSON.stringify(d.value),r.value.Values=s.value.map(a=>{var t,u,v;return{ID:0,FieldValueUUID:q(),FieldID:((t=r.value)==null?void 0:t.ID)||0,FieldUUID:((u=r.value)==null?void 0:u.FieldUUID)||"",Title:((v=i.value.find(m=>m.AccommodationUUID==a))==null?void 0:v.Name)||"",Value:a}})};return n==null||n.getConventionAccommodation(r.value.ConventionUUID).then(a=>{a&&(i.value=a)}),(a,t)=>(f(),k(h,null,[ot,e(W,{label:"Show Sharing Options",modelValue:d.value.sharing,"onUpdate:modelValue":t[0]||(t[0]=u=>d.value.sharing=u),"hide-details":"",onChange:o},null,8,["modelValue"]),nt,(f(!0),k(h,null,K(i.value,u=>(f(),y(W,{key:u.ID,modelValue:s.value,"onUpdate:modelValue":t[1]||(t[1]=v=>s.value=v),label:u.Name,value:u.AccommodationUUID,"hide-details":"",onChange:o},null,8,["modelValue","label","value"]))),128))],64))}}),it=M({__name:"EditFieldDialogAge",props:x({convention:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(D){var v,m,V;const r=L(D,"modelValue"),n=new Date,i=n.getFullYear(),s=(n.getMonth()+1).toLocaleString(navigator.language,{minimumIntegerDigits:2}),d=n.getDate().toLocaleString(navigator.language,{minimumIntegerDigits:2}),o=C(parseInt(((v=r.value.Values.find(p=>p.Title==="MIN_AGE"))==null?void 0:v.Value)||"18")),a=C(((m=r.value.Values.find(p=>p.Title==="BEFORE_DATE"))==null?void 0:m.Value)||`${i}-${s}-${d}`),t=C(((V=r.value.Values.find(p=>p.Title==="UNDER_AGE_APPLY_TAG"))==null?void 0:V.Value)||""),u=()=>{var p,c,U,_,P,$;r.value.Values=[{ID:0,FieldValueUUID:q(),FieldID:((p=r.value)==null?void 0:p.ID)||0,FieldUUID:((c=r.value)==null?void 0:c.FieldUUID)||"",Title:"MIN_AGE",Value:o.value.toString()},{ID:0,FieldValueUUID:q(),FieldID:((U=r.value)==null?void 0:U.ID)||0,FieldUUID:((_=r.value)==null?void 0:_.FieldUUID)||"",Title:"BEFORE_DATE",Value:a.value},{ID:0,FieldValueUUID:q(),FieldID:((P=r.value)==null?void 0:P.ID)||0,FieldUUID:(($=r.value)==null?void 0:$.FieldUUID)||"",Title:"UNDER_AGE_APPLY_TAG",Value:t.value}]};return u(),(p,c)=>(f(),y(j,{class:"pl-0 pr-0",fluid:!0},{default:l(()=>[e(F,null,{default:l(()=>[e(I,{cols:"12",sm:"6"},{default:l(()=>[e(R,{modelValue:o.value,"onUpdate:modelValue":c[0]||(c[0]=U=>o.value=U),modelModifiers:{number:!0},type:"number",label:"Minimum Age",variant:"outlined",onChange:u},null,8,["modelValue"])]),_:1}),e(I,{cols:"12",sm:"6"},{default:l(()=>[e(R,{modelValue:a.value,"onUpdate:modelValue":c[1]||(c[1]=U=>a.value=U),type:"date",label:"Date to attain minimum age by",variant:"outlined",onChange:u},null,8,["modelValue"])]),_:1})]),_:1}),e(F,null,{default:l(()=>[e(I,null,{default:l(()=>[e(Q,{modelValue:t.value,"onUpdate:modelValue":c[2]||(c[2]=U=>t.value=U),convention:p.convention,chips:!0,clearable:!0,variant:"outlined",label:`Tags applied to users under ${o.value} at time of data entry`,onChange:u},null,8,["modelValue","convention","label"])]),_:1})]),_:1})]),_:1}))}}),dt=E("h4",null,"Values",-1),st=E("h4",null,"Accommodation",-1),rt=E("h4",null,"Age",-1),mt=E("h4",null,"Additional Purchases",-1),vt=E("h4",null,"Available Interests",-1),ct=E("h4",null,"Tickets",-1),pt=E("h4",{class:"mb-3"},"Field Preview",-1),ft=M({__name:"EditFieldDialog",props:x({convention:{},field:{},title:{}},{modelValue:{type:Boolean,required:!0},modelModifiers:{}}),emits:x(["update:field"],["update:modelValue"]),setup(D,{emit:r}){const n=D,{convention:i,title:s=""}=n,d=r,o=L(D,"modelValue"),a=fe(n,d,void 0,void 0,"field"),t=C(G(a.value)),u=C(""),v=C(t.value.Type);J(a,()=>{t.value=G(a.value)});const m=()=>{o.value=!1},V=()=>{t.value=G(a.value)},p=()=>{a.value=t.value},c=()=>{t.value.Values.push({ID:0,FieldValueUUID:q(),FieldID:t.value.ID,FieldUUID:t.value.FieldUUID,Title:"",Value:""})},U=P=>{t.value.Values.splice(P,1)},_=()=>{u.value="",t.value.Values=[]};return J(v,(P,$)=>{P!==$&&(t.value.Type=P,_())}),(P,$)=>(f(),y(Ae,{modelValue:o.value,"onUpdate:modelValue":$[13]||($[13]=b=>o.value=b),onReset:V,onSave:p,title:T(s),color:"primary",persistent:!0,fullscreen:!0},{default:l(()=>[e(j,{class:"pa-0",fluid:!0},{default:l(()=>[e(F,null,{default:l(()=>[e(I,{cols:"12"},{default:l(()=>[e(j,{class:"pa-0",fluid:!0},{default:l(()=>[e(F,null,{default:l(()=>[e(I,{cols:"12",sm:"6",md:"4"},{default:l(()=>[e(R,{modelValue:t.value.Name,"onUpdate:modelValue":$[0]||($[0]=b=>t.value.Name=b),label:"Internal name",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),e(I,{cols:"12",sm:"6",md:"4"},{default:l(()=>[e(R,{modelValue:t.value.Label,"onUpdate:modelValue":$[1]||($[1]=b=>t.value.Label=b),label:"Label",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),e(I,{cols:"12",sm:"6",md:"4"},{default:l(()=>[e(R,{modelValue:t.value.Hint,"onUpdate:modelValue":$[2]||($[2]=b=>t.value.Hint=b),label:"Hint",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),e(I,{cols:"12",sm:"6",md:"4"},{default:l(()=>[e(R,{modelValue:t.value.Placeholder,"onUpdate:modelValue":$[3]||($[3]=b=>t.value.Placeholder=b),label:"Placeholder",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),e(I,{cols:"12",sm:"6",md:"4"},{default:l(()=>[e(de,{modelValue:v.value,"onUpdate:modelValue":$[4]||($[4]=b=>v.value=b),label:"Type",variant:"outlined",items:T(Pe),"hide-details":""},null,8,["modelValue","items"])]),_:1}),t.value.Type===T(X).SELECT||t.value.Type===T(X).CHECKBOX?(f(),y(I,{key:0,cols:"12",sm:"6",md:"4",class:"py-0"},{default:l(()=>[e(W,{modelValue:t.value.Multiple,"onUpdate:modelValue":$[5]||($[5]=b=>t.value.Multiple=b),label:"Multiple Items",hint:"Can select multiple items from list","hide-details":"",density:"compact"},null,8,["modelValue"]),t.value.Type===T(X).SELECT?(f(),y(W,{key:0,modelValue:t.value.Autofill,"onUpdate:modelValue":$[6]||($[6]=b=>t.value.Autofill=b),label:"Searchable List","hide-details":"",density:"compact"},null,8,["modelValue"])):A("",!0)]),_:1})):A("",!0)]),_:1}),t.value.Type===T(X).SELECT||t.value.Type===T(X).CHECKBOX&&t.value.Multiple||t.value.Type===T(X).RADIO?(f(),y(F,{key:0},{default:l(()=>[e(I,null,{default:l(()=>[dt,e(j,{fluid:!0,class:"px-0"},{default:l(()=>[(f(!0),k(h,null,K(t.value.Values,(b,z)=>(f(),y(F,{key:b.ID},{default:l(()=>[e(I,{cols:"12",sm:"5",md:"6"},{default:l(()=>[e(R,{modelValue:b.Title,"onUpdate:modelValue":B=>b.Title=B,label:"Display",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(I,{cols:"9",sm:"5",md:"5"},{default:l(()=>[e(R,{modelValue:b.Value,"onUpdate:modelValue":B=>b.Value=B,label:"Internal Value",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(I,{cols:"3",sm:"2",md:"1",class:"d-flex align-center"},{default:l(()=>[e(N,{icon:"mdi:mdi-window-close",size:"small",color:"red",onClick:B=>U(z)},null,8,["onClick"])]),_:2},1024)]),_:2},1024))),128)),e(F,null,{default:l(()=>[e(I,null,{default:l(()=>[e(N,{"prepend-icon":"mdi:mdi-plus",color:"primary",onClick:c},{default:l(()=>[g("Add Item")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})):t.value.Type===T(X).ACCOMMODATION?(f(),y(F,{key:1},{default:l(()=>[e(I,null,{default:l(()=>[st,e(ut,{modelValue:t.value,"onUpdate:modelValue":$[7]||($[7]=b=>t.value=b)},null,8,["modelValue"])]),_:1})]),_:1})):t.value.Type===T(X).AGE?(f(),y(F,{key:2},{default:l(()=>[e(I,null,{default:l(()=>[rt,e(it,{modelValue:t.value,"onUpdate:modelValue":$[8]||($[8]=b=>t.value=b),convention:T(i)},null,8,["modelValue","convention"])]),_:1})]),_:1})):t.value.Type===T(X).EXTRAS?(f(),y(F,{key:3},{default:l(()=>[e(I,null,{default:l(()=>[mt,e(lt,{modelValue:t.value,"onUpdate:modelValue":$[9]||($[9]=b=>t.value=b)},null,8,["modelValue"])]),_:1})]),_:1})):t.value.Type===T(X).INTERESTS?(f(),y(F,{key:4},{default:l(()=>[e(I,null,{default:l(()=>[vt,e(tt,{modelValue:t.value,"onUpdate:modelValue":$[10]||($[10]=b=>t.value=b)},null,8,["modelValue"])]),_:1})]),_:1})):t.value.Type===T(X).TICKET?(f(),y(F,{key:5},{default:l(()=>[e(I,null,{default:l(()=>[ct,e(at,{modelValue:t.value,"onUpdate:modelValue":$[11]||($[11]=b=>t.value=b)},null,8,["modelValue"])]),_:1})]),_:1})):A("",!0)]),_:1})]),_:1}),e(I,{cols:"12"},{default:l(()=>[e(te,{elevation:"5",class:"pa-2",color:"text-center"},{default:l(()=>[pt,e(xe,{admin:!0,field:t.value,convention:T(i),modelValue:u.value,"onUpdate:modelValue":$[12]||($[12]=b=>u.value=b)},null,8,["field","convention","modelValue"])]),_:1})]),_:1})]),_:1})]),_:1})]),actions:l(()=>[e(N,{color:"blue-darken-1",variant:"text",onClick:m},{default:l(()=>[g(" Cancel ")]),_:1}),e(N,{color:"blue-darken-1",variant:"text",onClick:V},{default:l(()=>[g(" Reset ")]),_:1}),e(ae),e(N,{color:"blue-darken-1",variant:"text",onClick:p},{default:l(()=>[g(" Save ")]),_:1})]),_:1},8,["modelValue","title"]))}}),Vt=M({__name:"FieldEditor",props:{modelValue:{required:!0},modelModifiers:{}},emits:x(["refresh"],["update:modelValue"]),setup(D){const r=L(D,"modelValue"),n=Y(),i=C(!1),s=C(!1),d=C([{key:"Label",title:"Label",align:"start",sortable:!0},{key:"Name",title:"Internal Name",align:"start",sortable:!0},{key:"Type",title:"Type",align:"start",sortable:!0},{key:"actions",title:"Actions",sortable:!1}]),o=C([]);n.getConventionFields(r.value.ConventionUUID).then(b=>{b&&(o.value=b)});const a=C(-1),t=C({ID:0,FieldUUID:q(),ConventionID:r.value.ID,ConventionUUID:r.value.ConventionUUID,Autofill:!1,Hint:"",Label:"",Multiple:!1,Name:"",Placeholder:"",Type:"TEXT",Values:[],Data:""}),u=le(()=>a.value===-1?"New Field":"Edit Field"),v=()=>({ID:0,FieldUUID:q(),ConventionID:r.value.ID,ConventionUUID:r.value.ConventionUUID,Autofill:!1,Hint:"",Label:"",Multiple:!1,Name:"",Placeholder:"",Type:"TEXT",Values:[],Data:""}),m=C(v()),V=()=>{m.value.FieldUUID=q(),t.value=Object.assign({},v()),a.value=-1,i.value=!0},p=b=>{a.value=o.value.indexOf(b),t.value=Object.assign({},b),i.value=!0},c=b=>{a.value=o.value.indexOf(b),t.value=Object.assign({},b),s.value=!0},U=()=>{n.deleteField(t.value.FieldUUID).then(b=>{b&&(o.value.splice(a.value,1),P())})},_=()=>{i.value=!1,ye(()=>{t.value=Object.assign({},m.value),a.value=-1})},P=()=>{s.value=!1,ye(()=>{t.value=Object.assign({},m.value),a.value=-1})},$=()=>{n.saveField(t.value).then(b=>{b&&(a.value>-1?Object.assign(o.value[a.value],b):o.value.push(b),_())})};return(b,z)=>(f(),y(qe,{headers:d.value,items:o.value,"sort-by":[{key:"calories",order:"asc"}],class:"elevation-1"},{top:l(()=>[e(ne,{color:"primary"},{default:l(()=>[e(ie,null,{default:l(()=>[g("Field Editor")]),_:1}),e(Ye,{class:"mx-4",inset:!0,vertical:!0}),e(ae),e(N,{dark:"",class:"mb-2","prepend-icon":"mdi:mdi-pencil",onClick:V},{default:l(()=>[g(" New Item ")]),_:1}),e(Ke,{modelValue:s.value,"onUpdate:modelValue":z[0]||(z[0]=B=>s.value=B),onDelete:U},null,8,["modelValue"])]),_:1}),i.value?(f(),y(ft,{key:0,modelValue:i.value,"onUpdate:modelValue":z[1]||(z[1]=B=>i.value=B),field:t.value,"onUpdate:field":[z[2]||(z[2]=B=>t.value=B),$],title:u.value,convention:r.value},null,8,["modelValue","field","title","convention"])):A("",!0)]),"item.actions":l(({item:B})=>[e(H,{size:"small",class:"me-2",onClick:Ge=>p(B)},{default:l(()=>[g(" mdi:mdi-pencil ")]),_:2},1032,["onClick"]),e(H,{size:"small",onClick:Ge=>c(B)},{default:l(()=>[g(" mdi:mdi-delete ")]),_:2},1032,["onClick"])]),_:1},8,["headers","items"]))}}),Ut=(D,r)=>{const n=fe(D,r),i=fe(D,r,void 0,void 0,"item"),s=C(G(i.value));return J(i,()=>{s.value=G(i.value)}),{state:n,model:i,close:()=>{n.value=!1},reset:()=>{i.value=G(s.value)},save:()=>{r("save")}}},Tt=M({__name:"EditItemDialog",props:{item:{},modelValue:{type:Boolean},title:{},cardClass:{}},emits:["update:modelValue","update:item","save"],setup(D,{emit:r}){const n=D,i=r,{state:s,model:d,close:o,reset:a,save:t}=Ut(n,i);return(u,v)=>(f(),y(Ae,{modelValue:T(s),"onUpdate:modelValue":v[0]||(v[0]=m=>_e(s)?s.value=m:null),onReset:T(a),onSave:T(t),title:u.title,color:"primary","card-class":u.cardClass,fullscreen:!0,persistent:!0},{toolbarButtons:l(()=>[he(u.$slots,"toolbarButtons")]),actions:l(()=>[e(N,{color:"blue-darken-1",variant:"text",onClick:T(o)},{default:l(()=>[g(" Cancel ")]),_:1},8,["onClick"]),e(N,{color:"blue-darken-1",variant:"text",onClick:T(a)},{default:l(()=>[g(" Reset ")]),_:1},8,["onClick"]),e(ae),e(N,{color:"blue-darken-1",variant:"text",onClick:T(t)},{default:l(()=>[g(" Save ")]),_:1},8,["onClick"])]),default:l(()=>[he(u.$slots,"default")]),_:3},8,["modelValue","onReset","onSave","title","card-class"]))}}),Dt={class:"pa-0 border-0 ma-0"},It=E("legend",{class:"mb-2"},"Field Settings",-1),_t={class:"pa-0 border-0 ma-0"},yt=E("legend",{class:"text-blue-accent-2 mb-2"},"Field Preview",-1),Ct=M({__name:"EditFormField",props:x({convention:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(D){const r=L(D,"modelValue"),n=Y(),i=C([]),s=C([]),d=C(""),o=a=>{var t;r.value.Field=(t=s.value.find(u=>u.value===a))==null?void 0:t.field};return n.getConventionFields(D.convention.ConventionUUID).then(a=>{a&&(i.value=a,s.value=a.map(t=>({title:`${t.Label} (${(Pe.find(u=>u.value===t.Type)||{title:""}).title})`,value:t.FieldUUID,field:t})),o(r.value.FieldUUID))}),(a,t)=>(f(),y(F,null,{default:l(()=>[e(I,{cols:"12",md:"6"},{default:l(()=>[E("fieldset",Dt,[It,e(F,null,{default:l(()=>[e(I,{cols:"12"},{default:l(()=>[e(de,{modelValue:r.value.FieldUUID,"onUpdate:modelValue":[t[0]||(t[0]=u=>r.value.FieldUUID=u),o],items:s.value,"item-title":"title","item-value":"value",label:"Field",variant:"outlined","hide-details":""},null,8,["modelValue","items"])]),_:1}),e(I,{cols:"6",sm:"4"},{default:l(()=>[e(R,{modelValue:r.value.MinLength,"onUpdate:modelValue":t[1]||(t[1]=u=>r.value.MinLength=u),modelModifiers:{number:!0},label:"Min Length",type:"number",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),e(I,{cols:"6",sm:"4"},{default:l(()=>[e(R,{modelValue:r.value.MaxLength,"onUpdate:modelValue":t[2]||(t[2]=u=>r.value.MaxLength=u),modelModifiers:{number:!0},label:"Max Length",type:"number",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),e(I,{cols:"12",sm:"4"},{default:l(()=>[e(W,{modelValue:r.value.Required,"onUpdate:modelValue":t[3]||(t[3]=u=>r.value.Required=u),modelModifiers:{boolean:!0},label:"Required","hide-details":""},null,8,["modelValue"])]),_:1})]),_:1})])]),_:1}),r.value.FieldUUID&&r.value.Field?(f(),y(I,{key:0,cols:"12",md:"6"},{default:l(()=>[E("fieldset",_t,[yt,r.value.Field?(f(),y(xe,{key:0,admin:!0,field:r.value.Field,"persistent-hint":!0,required:r.value.Required,convention:a.convention,modelValue:d.value,"onUpdate:modelValue":t[4]||(t[4]=u=>d.value=u)},null,8,["field","required","convention","modelValue"])):A("",!0)])]),_:1})):A("",!0)]),_:1}))}}),gt={class:"d-none d-sm-block"},bt=M({__name:"EditFormSectionFields",props:x({convention:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(D){const r=L(D,"modelValue"),n=()=>{var i;return{ID:0,SectionFieldUUID:q(),SectionID:r.value.ID,SectionUUID:r.value.SectionUUID,FieldID:0,FieldUUID:"",Order:(((i=r.value.Fields)==null?void 0:i.length)||0)+1,MinLength:0,MaxLength:0,Required:!1,Value:""}};return(i,s)=>r.value.Fields!==void 0?(f(),y(Oe,{key:0,modelValue:r.value.Fields,"onUpdate:modelValue":s[0]||(s[0]=d=>r.value.Fields=d),closeable:!1,title:"Fields","new-item":n,class:"mt-4",label:"name","label-parent":"Field","slot-name-prefix":"field"},Re({_:2},[K(r.value.Fields,(d,o)=>({name:`field_${o}_title`,fn:l(()=>[d.Field?(f(),k(h,{key:0},[g(S(d.Field.Label)+" ("+S(d.Field.Name)+") ",1),E("template",gt,[g(" ["+S(d.Field.Type)+"] ",1)])],64)):(f(),k(h,{key:1},[g("New Field")],64))])})),K(r.value.Fields,(d,o)=>({name:`field_${o}`,fn:l(()=>[e(Ct,{modelValue:r.value.Fields[o],"onUpdate:modelValue":a=>r.value.Fields[o]=a,convention:i.convention,style:{margin:"0 -24px"}},null,8,["modelValue","onUpdate:modelValue","convention"])])}))]),1032,["modelValue"])):A("",!0)}}),kt=M({__name:"EditFormSections",props:x({convention:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(D){const r=L(D,"modelValue"),n=()=>{const i={ID:0,SectionUUID:q(),FormID:r.value.ID,FormUUID:r.value.FormUUID,Order:0,Name:"New Section",Heading:"",Description:"",Fields:[],DefaultValue:"",State:{ID:0,SectionStateUUID:q(),SectionID:0,SectionUUID:"",Edit:!0}};return i.State.SectionID=i.ID,i.State.SectionUUID=i.SectionUUID,i};return(i,s)=>(f(),y(Oe,{modelValue:r.value.Sections,"onUpdate:modelValue":s[0]||(s[0]=d=>r.value.Sections=d),"new-item":n,closeable:!1,title:"Sections","slot-name-prefix":"section"},Re({_:2},[K(r.value.Sections,(d,o)=>({name:`section_${o}`,fn:l(()=>[e(F,null,{default:l(()=>[e(I,{cols:"12",sm:"6"},{default:l(()=>[e(R,{modelValue:d.Name,"onUpdate:modelValue":a=>d.Name=a,label:"Internal Name",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(I,{cols:"12",sm:"6"},{default:l(()=>[e(R,{modelValue:d.Heading,"onUpdate:modelValue":a=>d.Heading=a,label:"Section Heading",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024),e(F,null,{default:l(()=>[e(I,{cols:"12"},{default:l(()=>[e(De,{modelValue:d.Description,"onUpdate:modelValue":a=>d.Description=a,label:"Section Text",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024),d.Fields?(f(),y(bt,{key:0,modelValue:r.value.Sections[o],"onUpdate:modelValue":a=>r.value.Sections[o]=a,convention:i.convention},null,8,["modelValue","onUpdate:modelValue","convention"])):A("",!0)])}))]),1032,["modelValue"]))}}),Et=M({__name:"FormRendererPopup",props:x({admin:{type:Boolean},convention:{},form:{},title:{},cardClass:{},preview:{type:Boolean}},{modelValue:{type:Boolean,required:!0},modelModifiers:{}}),emits:x(["update:form"],["update:modelValue"]),setup(D,{emit:r}){const n=D,{admin:i=!1,convention:s,title:d="",cardClass:o=""}=n,a=r,t=L(D,"modelValue"),u=fe(n,a,void 0,void 0,"form"),v=C(G(u.value));J(u,()=>{v.value=G(u.value)});const m=()=>{t.value=!1};return(V,p)=>(f(),y(Ae,{modelValue:t.value,"onUpdate:modelValue":p[1]||(p[1]=c=>t.value=c),title:T(d),color:"primary","card-class":T(o)},{toolbarButtons:l(()=>[he(V.$slots,"toolbarButtons")]),actions:l(()=>[e(N,{color:"blue-darken-1",variant:"text",onClick:m},{default:l(()=>[g(" Close ")]),_:1})]),default:l(()=>[e(ze,{modelValue:v.value,"onUpdate:modelValue":p[0]||(p[0]=c=>v.value=c),admin:T(i),convention:T(s),preview:V.preview},null,8,["modelValue","admin","convention","preview"])]),_:3},8,["modelValue","title","card-class"]))}}),ht=E("template",{class:"d-none d-sm-inline"},[g("Preview")],-1),$t=M({__name:"EditFormDialog",props:x({convention:{},form:{}},{modelValue:{type:Boolean,required:!0},modelModifiers:{}}),emits:x(["update:form"],["update:modelValue"]),setup(D,{emit:r}){const n=D,{convention:i}=n,s=L(D,"modelValue"),d=r,o=Y(),a=fe(n,d,void 0,void 0,"form"),t=C(!1),u=C(G(a.value));J(a,()=>{u.value=G(a.value)});const v=()=>{o.saveForm(u.value).then(V=>{V&&(a.value=V,s.value=!1)})},m=()=>{t.value=!0};return(V,p)=>(f(),y(Tt,{modelValue:s.value,"onUpdate:modelValue":p[13]||(p[13]=c=>s.value=c),item:u.value,"onUpdate:item":p[14]||(p[14]=c=>u.value=c),onSave:v,"card-class":"pa-0"},{toolbarButtons:l(()=>[e(ll,null,{default:l(()=>[e(N,{"prepend-icon":"mdi:mdi-developer-board",onClick:m},{default:l(()=>[ht]),_:1})]),_:1})]),default:l(()=>[e(me,null,{default:l(()=>[e(ve,{class:"mt-0"},{default:l(()=>[e(ce,null,{default:l(()=>[g("General Settings")]),_:1}),e(pe,null,{default:l(()=>[e(F,null,{default:l(()=>[e(I,{cols:"12"},{default:l(()=>[e(j,{class:"pa-0",fluid:!0},{default:l(()=>[e(F,null,{default:l(()=>[e(I,{cols:"12",sm:"6"},{default:l(()=>[e(R,{modelValue:u.value.Name,"onUpdate:modelValue":p[0]||(p[0]=c=>u.value.Name=c),label:"Internal name",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),e(I,{cols:"12",sm:"6"},{default:l(()=>[e(R,{modelValue:u.value.Heading,"onUpdate:modelValue":p[1]||(p[1]=c=>u.value.Heading=c),label:"Form Heading",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),e(I,{cols:"12"},{default:l(()=>[e(De,{modelValue:u.value.Description,"onUpdate:modelValue":p[2]||(p[2]=c=>u.value.Description=c),label:"Pre-form Text",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),e(I,{cols:"12",sm:"6"},{default:l(()=>[e(de,{modelValue:u.value.Type,"onUpdate:modelValue":p[3]||(p[3]=c=>u.value.Type=c),label:"Type",variant:"outlined",items:T(Ze),"hide-details":""},null,8,["modelValue","items"])]),_:1}),e(I,{cols:"12",sm:"6"},{default:l(()=>[e(R,{modelValue:u.value.NotificationEmail,"onUpdate:modelValue":p[4]||(p[4]=c=>u.value.NotificationEmail=c),label:"Notification Email",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),e(I,{cols:"12",sm:"6",class:"d-none"},{default:l(()=>[e(R,{modelValue:u.value.State.Stage,"onUpdate:modelValue":p[5]||(p[5]=c=>u.value.State.Stage=c),modelModifiers:{number:!0},label:"Stage",variant:"outlined","hide-details":"",type:"number"},null,8,["modelValue"])]),_:1}),e(I,{cols:"6"},{default:l(()=>[e(W,{modelValue:u.value.State.New,"onUpdate:modelValue":p[6]||(p[6]=c=>u.value.State.New=c),label:"Allow New Entries"},null,8,["modelValue"])]),_:1}),e(I,{cols:"6"},{default:l(()=>[e(W,{modelValue:u.value.State.Edit,"onUpdate:modelValue":p[7]||(p[7]=c=>u.value.State.Edit=c),label:"Allow Editing Submissions"},null,8,["modelValue"])]),_:1})]),_:1}),e(F,null,{default:l(()=>[e(I,{cols:"12"},{default:l(()=>[e(Q,{label:"Required Tags",variant:"outlined",modelValue:u.value.RequiredTags,"onUpdate:modelValue":p[8]||(p[8]=c=>u.value.RequiredTags=c),convention:T(i),organisation:T(i).OrganisationUUID,chips:"",clearable:"",hint:"Tags that a user must have to see this form. (Any one)"},null,8,["modelValue","convention","organisation"])]),_:1})]),_:1}),e(F,null,{default:l(()=>[e(I,{cols:"12"},{default:l(()=>[e(Me,{label:"Required Groups",variant:"outlined",modelValue:u.value.RequiredGroupMemberships,"onUpdate:modelValue":p[9]||(p[9]=c=>u.value.RequiredGroupMemberships=c),convention:T(i),organisation:T(i).OrganisationUUID,chips:"",clearable:"",hint:"Groups that a user must be in to see this form. (Any one)"},null,8,["modelValue","convention","organisation"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),u.value?(f(),y(kt,{key:0,modelValue:u.value,"onUpdate:modelValue":p[10]||(p[10]=c=>u.value=c),convention:T(i),style:{"border-radius":"0"}},null,8,["modelValue","convention"])):A("",!0),t.value?(f(),y(Et,{key:1,modelValue:t.value,"onUpdate:modelValue":p[11]||(p[11]=c=>t.value=c),form:u.value,"onUpdate:form":p[12]||(p[12]=c=>u.value=c),admin:!0,convention:T(i),title:"Form Preview",preview:!0,"card-class":"pa-0"},null,8,["modelValue","form","convention"])):A("",!0)]),_:1},8,["modelValue","item"]))}}),Nt=(D,r)=>{const n=C(!1),i=C(!1),s=C(D),d=C(-1),o=C(r),a=C(r),t=le(()=>d.value===-1?"New Form":"Edit Form"),u=()=>{s.value=D},v=_=>{d.value=s.value.indexOf(_),o.value=Object.assign({},_),n.value=!0},m=_=>{d.value=s.value.indexOf(_),o.value=Object.assign({},_),i.value=!0},V=()=>{i.value=!1,ye(()=>{o.value=Object.assign({},a.value),d.value=-1}).then()},p=()=>{s.value.splice(d.value,1),V()},c=()=>{n.value=!1,ye(()=>{o.value=Object.assign({},a.value),d.value=-1}).then()},U=()=>{d.value>-1?Object.assign(s.value[d.value],o.value):s.value.push(o.value),c()};return J(n,_=>{_||c()}),J(i,_=>{_||V()}),{collection:s,defaultItem:a,dialog:n,dialogDelete:i,editedItem:o,formTitle:t,reset:u,editItem:v,deleteItem:m,deleteItemConfirm:p,close:c,save:U}},Ft=M({__name:"FormEditor",props:{modelValue:{required:!0},modelModifiers:{}},emits:x(["refresh"],["update:modelValue"]),setup(D){const r=L(D,"modelValue"),n=Y(),i=C([{key:"Name",title:"Form Name",align:"start",sortable:!0},{key:"Type",title:"Type",align:"start",sortable:!0},{key:"actions",title:"Actions",sortable:!1}]),s=C([]),d=C([]);n.getConventionFields(r.value.ConventionUUID).then(P=>{s.value=P}),n.getConventionForms(r.value.ConventionUUID).then(P=>{d.value=P});const o={ID:0,FormUUID:q(),ConventionID:r.value.ID,ConventionUUID:r.value.ConventionUUID,ParentID:0,ParentUUID:Ce,Name:"",Heading:"",Description:"",Type:el.FORM_TYPE_ADDITIONAL,Sections:[],State:{ID:0,FormStateUUID:q(),FormID:0,FormUUID:Ce,New:!1,Edit:!1,Stage:0},RequiredGroupMemberships:[],RequiredTags:[],NotificationEmail:""};o.State.FormUUID=o.FormUUID;const{collection:a,defaultItem:t,dialog:u,dialogDelete:v,editedItem:m,editItem:V,deleteItem:p,deleteItemConfirm:c,save:U}=Nt(d,o);a.value.forEach(P=>{P.Sections.forEach($=>{var b;(b=$.Fields)==null||b.forEach(z=>{z.Field=s.value.find(B=>B.ID===z.FieldID)})})});const _=P=>{n.deleteForm(P.FormUUID).then($=>{$&&p(P)})};return(P,$)=>(f(),y(qe,{headers:i.value,items:T(a),"sort-by":[{key:"calories",order:"asc"}],class:"elevation-1"},{top:l(()=>[e(ne,{color:"primary"},{default:l(()=>[e(ie,null,{default:l(()=>[g("Form Editor")]),_:1}),e(Ye,{class:"mx-4",inset:!0,vertical:!0}),e(ae),e(N,{dark:"",class:"mb-2","prepend-icon":"mdi:mdi-pencil",onClick:$[0]||($[0]=b=>{m.value=Object.assign({},T(t)),u.value=!0})},{default:l(()=>[g(" New Item ")]),_:1}),e(Ke,{modelValue:T(v),"onUpdate:modelValue":$[1]||($[1]=b=>_e(v)?v.value=b:null),onDelete:T(c)},null,8,["modelValue","onDelete"])]),_:1}),T(u)?(f(),y($t,{key:0,modelValue:T(u),"onUpdate:modelValue":$[2]||($[2]=b=>_e(u)?u.value=b:null),form:T(m),"onUpdate:form":[$[3]||($[3]=b=>_e(m)?m.value=b:null),T(U)],convention:r.value},null,8,["modelValue","form","onUpdate:form","convention"])):A("",!0)]),"item.actions":l(({item:b})=>[e(H,{size:"small",class:"me-2",onClick:z=>T(V)(b)},{default:l(()=>[g(" mdi:mdi-pencil ")]),_:2},1032,["onClick"]),e(H,{size:"small",onClick:z=>_(b)},{default:l(()=>[g(" mdi:mdi-delete ")]),_:2},1032,["onClick"])]),_:1},8,["headers","items"]))}}),_a=M({__name:"ConventionEditorView",emits:["pageTitle","refresh"],setup(D,{emit:r}){const n=r,i=Be(),s=Y(),o=C({ID:0,ConventionUUID:Ce,Accommodation:[],Description:"",DetailLink:"",Extras:[],Interests:[],Logo:"",Name:"",OrganisationID:0,OrganisationUUID:"",Slug:"",Tickets:[],Visible:!1}),a=C();J(a,()=>{u.value.find(m=>m.id===a.value&&m.title==="General")&&t()});const t=()=>{s.getConvention(i.params.convention.toString()).then(v=>{v?(o.value=v,n("pageTitle",`Convention Editor - ${o.value.Name}`)):n("pageTitle","Convention Editor - New Convention")})},u=C([{id:q(),title:"Accommodation",component:ue(et),model:o},{id:q(),title:"Additional Purchases",component:ue(rl),model:o},{id:q(),title:"Fields",component:ue(Vt),model:o},{id:q(),title:"Forms",component:ue(Ft),model:o},{id:q(),title:"Interests",component:ue(fl),model:o},{id:q(),title:"Tickets",component:ue(Nl),model:o},{id:q(),title:"Venues",component:ue(Kl),model:o}]);return n("pageTitle","Convention Editor"),t(),(v,m)=>(f(),k("div",null,[o.value&&o.value.ConventionUUID!==T(Ce)?(f(),k(h,{key:0},[e(ne,{color:"blue-darken-4"},{default:l(()=>[e(He,{modelValue:a.value,"onUpdate:modelValue":m[0]||(m[0]=V=>a.value=V),"show-arrows":""},{default:l(()=>[(f(!0),k(h,null,K(u.value,V=>(f(),y(Je,{key:V.id,value:V.id},{default:l(()=>[g(S(V.title),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(tl,{modelValue:a.value,"onUpdate:modelValue":m[1]||(m[1]=V=>a.value=V),disabled:!0},{default:l(()=>[(f(!0),k(h,null,K(u.value,V=>(f(),y(al,{key:V.id,value:V.id},{default:l(()=>[V.id===a.value?(f(),y(re,{key:0,class:"pa-2"},{default:l(()=>[(f(),y(je(V.component),{modelValue:V.model,"onUpdate:modelValue":p=>V.model=p},null,8,["modelValue","onUpdate:modelValue"]))]),_:2},1024)):A("",!0)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])],64)):A("",!0)]))}});export{_a as default};
