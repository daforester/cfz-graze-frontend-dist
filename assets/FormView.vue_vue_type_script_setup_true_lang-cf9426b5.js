import{c as d}from"./FormRenderer.vue_vue_type_script_setup_true_lang-65ca80de.js";import{I as R,a4 as h,a0 as G,r as v,K as T,L as _,Q as x,$ as E,Y as F}from"./index-09b2497b.js";import{G as V}from"./userData-aae7b7ff.js";import{p as b}from"./performLoginCheck-fb96a29b.js";const B=R({__name:"FormView",props:{formType:{default:"REGISTRATION"}},emits:["pageTitle"],setup(c,{emit:p}){const C=h(),I=G(),a=E(),l=F.getInstance(),i=v(),r=v(),U=v(),u=v(),m=v(!1),s=V();b(I);const g=e=>new Promise((t,n)=>{a.getConventionRegistrationGroup(e).then(o=>{o?(u.value=o,t(o)):n()}).catch(()=>{n()})});return(()=>{a.getConvention(C.params.convention.toString()).then(e=>{e&&(i.value=e,g(e.ConventionUUID),a.getConventionExtras(e.ConventionUUID||"").then(t=>(i.value||{Extras:[]}).Extras=t),a.getAvailableConventionForms(e.ConventionUUID||"",!0).then(t=>{var n;r.value=t.find(o=>o.Type===c.formType.toUpperCase()),r.value&&(s!=null&&s.UserUUID&&e.ConventionUUID&&a.getUserConventionSubmissions((s==null?void 0:s.UserUUID)||"",e.ConventionUUID||"").then(o=>{o&&(U.value=o.find(D=>{var f;return D.FormUUID===((f=r.value)==null?void 0:f.FormUUID)})),m.value=!0}).catch(()=>{m.value=!0}),p("pageTitle",`Convention Registration - ${((n=i.value)==null?void 0:n.Name)||"New Convention"}`))}))})})(),p("pageTitle","Convention Registration"),l.on("registration.group.leave",()=>{var e;a.leaveRegistrationGroup(((e=u.value)==null?void 0:e.Registration.RegistrationUUID)||"").then(t=>{var n;t&&g(((n=u.value)==null?void 0:n.Registration.ConventionUUID)||"").then(o=>{l.emit("registration.group.left",o)})})}),l.on("registration.group.join",()=>{var e;g(((e=i.value)==null?void 0:e.ConventionUUID)||"")}),(e,t)=>m.value&&r.value&&i.value&&u.value?(T(),_(d,{key:0,modelValue:r.value,"onUpdate:modelValue":t[0]||(t[0]=n=>r.value=n),convention:i.value,data:U.value,editable:!0,"registration-group":u.value},null,8,["modelValue","convention","data","registration-group"])):x("",!0)}});export{B as _};
