import{p as w,r as p,s as T,c as f,a as re,w as N,o as ie,b as ue,d as B,u as ce,e as de,t as E,f as t,m as G,h as ve,i as z,j as me,k as H,l as M,n as V,q as _,v as r,x as q,y as J,z as ge,A as L,E as K,_ as Q,B as fe,C as A,D as W,F as pe,G as he,H as Ve,I as X,J as Z,K as ye,L as _e,T as ke}from"./index--uBZ-PRa.js";import{G as be,R as O,a as Ce}from"./userData-xcg_xL9F.js";import{u as Se}from"./useAvatar-mu1TzStO.js";import{C as Ie}from"./canEditOrganisation-xPxG9FKs.js";import{G as x}from"./group-7fhbY6WJ.js";import{C as D}from"./canDo-vlFhXolt.js";import{C as Te}from"./canViewOperations-F5zc4sSl.js";import{m as Pe,V as Y,a as we}from"./VToolbar-FPpgOHBe.js";import{V as Re}from"./scopeId-ro4-E3q8.js";import{V as Le}from"./VTextField-pLsilzQY.js";import{u as U,m as Be,V as ee,a as F,b as Ue,c as $,d as Ne,e as Ee,f as Ae,g as xe,h as De,i as Oe,j as Me,k as Ge,l as ze}from"./VContainer-K-VW8aPz.js";import{m as ae,u as te,a as oe,c as le,V as Fe,b as se}from"./VNavigationDrawer-ygwg-JZ0.js";import{u as He,V as j,a as C,b as Ye}from"./VList-qdVTAffM.js";import{V as ne,a as $e}from"./forwardRefs-mnMz_x12.js";import{V as je}from"./VDivider-v3nmUxC5.js";import{s as qe}from"./index-2XRRB2DS.js";import"./useStoreAPI-_csycoG0.js";import"./createSimpleFunctional-avXfckV0.js";import"./form-C3pmuXuL.js";const Je=(e,n=void 0)=>e===void 0?!1:n===void 0?D(e,x.GROUP_TYPE_CONVENTION).ManageUsers:D(e,x.GROUP_TYPE_CONVENTION,n.ConventionUUID,n).ManageUsers,Ke=(e,n=void 0)=>{let o;return e===void 0?!1:(n===void 0?o=D(e,x.GROUP_TYPE_CONVENTION):o=D(e,x.GROUP_TYPE_CONVENTION,n.ConventionUUID,n),o.EditConvention||o.ManageViews||o.ViewRegistration||o.EditRegistration)},Qe=w({scrollTarget:{type:String},scrollThreshold:{type:[String,Number],default:300}},"scroll");function We(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{canScroll:o}=n;let i=0;const l=p(null),a=T(0),s=T(0),v=T(0),m=T(!1),c=T(!1),d=f(()=>Number(e.scrollThreshold)),k=f(()=>re((d.value-a.value)/d.value||0)),y=()=>{const g=l.value;!g||o&&!o.value||(i=a.value,a.value="window"in g?g.pageYOffset:g.scrollTop,c.value=a.value<i,v.value=Math.abs(a.value-d.value))};return N(c,()=>{s.value=s.value||a.value}),N(m,()=>{s.value=0}),ie(()=>{N(()=>e.scrollTarget,g=>{var I;const S=g?document.querySelector(g):window;S&&S!==l.value&&((I=l.value)==null||I.removeEventListener("scroll",y),l.value=S,l.value.addEventListener("scroll",y,{passive:!0}))},{immediate:!0})}),ue(()=>{var g;(g=l.value)==null||g.removeEventListener("scroll",y)}),o&&N(o,y,{immediate:!0}),{scrollThreshold:d,currentScroll:a,currentThreshold:v,isScrollActive:m,scrollRatio:k,isScrollingUp:c,savedScroll:s}}const Xe=w({scrollBehavior:String,modelValue:{type:Boolean,default:!0},location:{type:String,default:"top",validator:e=>["top","bottom"].includes(e)},...Pe(),...ae(),...Qe(),height:{type:[Number,String],default:64}},"VAppBar"),Ze=B()({name:"VAppBar",props:Xe(),emits:{"update:modelValue":e=>!0},setup(e,n){let{slots:o}=n;const i=p(),l=ce(e,"modelValue"),a=f(()=>{var h;const u=new Set(((h=e.scrollBehavior)==null?void 0:h.split(" "))??[]);return{hide:u.has("hide"),inverted:u.has("inverted"),collapse:u.has("collapse"),elevate:u.has("elevate"),fadeImage:u.has("fade-image")}}),s=f(()=>{const u=a.value;return u.hide||u.inverted||u.collapse||u.elevate||u.fadeImage||!l.value}),{currentScroll:v,scrollThreshold:m,isScrollingUp:c,scrollRatio:d}=We(e,{canScroll:s}),k=f(()=>e.collapse||a.value.collapse&&(a.value.inverted?d.value>0:d.value===0)),y=f(()=>e.flat||a.value.elevate&&(a.value.inverted?v.value>0:v.value===0)),g=f(()=>a.value.fadeImage?a.value.inverted?1-d.value:d.value:void 0),S=f(()=>{var R,b;if(a.value.hide&&a.value.inverted)return 0;const u=((R=i.value)==null?void 0:R.contentHeight)??0,h=((b=i.value)==null?void 0:b.extensionHeight)??0;return u+h});de(f(()=>!!e.scrollBehavior),()=>{ve(()=>{a.value.hide?a.value.inverted?l.value=v.value>m.value:l.value=c.value||v.value<m.value:l.value=!0})});const{ssrBootStyles:I}=He(),{layoutItemStyles:P}=te({id:e.name,order:f(()=>parseInt(e.order,10)),position:E(e,"location"),layoutSize:S,elementSize:T(void 0),active:l,absolute:E(e,"absolute")});return U(()=>{const u=Y.filterProps(e);return t(Y,G({ref:i,class:["v-app-bar",{"v-app-bar--bottom":e.location==="bottom"},e.class],style:[{...P.value,"--v-toolbar-image-opacity":g.value,height:void 0,...I.value},e.style]},u,{collapse:k.value,flat:y.value}),o)}),{}}}),ea=w({...Be({icon:"$menu",variant:"text"})},"VAppBarNavIcon"),aa=B()({name:"VAppBarNavIcon",props:ea(),setup(e,n){let{slots:o}=n;return U(()=>t(ee,G(e,{class:["v-app-bar-nav-icon"]}),o)),{}}}),ta=w({...F(),...oe()},"VLayout"),oa=B()({name:"VLayout",props:ta(),setup(e,n){let{slots:o}=n;const{layoutClasses:i,layoutStyles:l,getLayoutItem:a,items:s,layoutRef:v}=le(e);return U(()=>{var m;return t("div",{ref:v,class:[i.value,e.class],style:[l.value,e.style]},[(m=o.default)==null?void 0:m.call(o)])}),{getLayoutItem:a,items:s}}}),la=z({__name:"DashboardLayout",props:{user:{}},setup(e){const n=Se(),o=me(),i=p(!1),l=p("Default Title"),a=p(""),s=p(H(e.user)),v=p(n(s.value.UserUUID));K.getInstance().on("user.profile.saved",P=>{s.value=H(P)});const c=p(localStorage.getItem("theme")||"light");o.global.name.value=c.value;const d=()=>{c.value=="light"?c.value="dark":c.value="light",o.global.name.value=c.value,localStorage.setItem("theme",c.value)},k=P=>{l.value=P},y=p(Ke(e.user)),g=p(Te(e.user)),S=p(Ie(e.user)),I=p(Je(e.user));return(P,u)=>{const h=M("RouterLink"),R=M("RouterView");return V(),_(oa,{class:"h-100"},{default:r(()=>[t(Ze,{color:"blue-darken-3"},{default:r(()=>[t(we,null,{default:r(()=>[q(J(l.value),1)]),_:1}),t(Re),t(Le,{modelValue:a.value,"onUpdate:modelValue":u[0]||(u[0]=b=>a.value=b),"prepend-inner-icon":"mdi:mdi-magnify",label:"Search",variant:"underlined","hide-details":"",clearable:!0,class:"d-none"},null,8,["modelValue"]),t(aa,{variant:"text",onClick:u[1]||(u[1]=ge(b=>i.value=!i.value,["stop"]))})]),_:1}),t(Fe,{modelValue:i.value,"onUpdate:modelValue":u[2]||(u[2]=b=>i.value=b),location:"right",temporary:!0},{default:r(()=>[t(j,null,{default:r(()=>[t(h,{to:{name:"Profile"}},{default:r(()=>[t(C,{title:s.value.DisplayName},{prepend:r(()=>[v.value?(V(),_(ne,{key:0,src:v.value,class:"rounded-circle mr-2",height:"32",width:"32"},null,8,["src"])):(V(),_(Ue,{key:1,icon:"mdi:mdi-account-circle",size:"x-large"}))]),_:1},8,["title"])]),_:1})]),_:1}),t(je),t(R,{name:"navigation"},{default:r(()=>[t(j,null,{default:r(()=>[t(h,{to:"/"},{default:r(()=>[t(C,{"prepend-icon":"mdi:mdi-view-dashboard-outline",title:"Home",value:"home"})]),_:1}),y.value||S.value||I.value?(V(),_(Ye,{key:0,value:"Admin"},{activator:r(({props:b})=>[t(C,G(b,{"prepend-icon":"mdi:mdi-security",title:"Admin"}),null,16)]),default:r(()=>[y.value||g.value?(V(),_(h,{key:0,to:"/admin/conventions"},{default:r(()=>[t(C,{"prepend-icon":"mdi:mdi-domain",title:"Conventions",value:"Conventions"})]),_:1})):L("",!0),S.value?(V(),_(h,{key:1,to:"/admin/organisations"},{default:r(()=>[t(C,{"prepend-icon":"mdi:mdi-store",title:"Organisations",value:"Organisations"})]),_:1})):L("",!0),I.value?(V(),_(h,{key:2,to:"/admin/groups"},{default:r(()=>[t(C,{"prepend-icon":"mdi:mdi-key-chain-variant",title:"Permissions",value:"Permissions"})]),_:1})):L("",!0)]),_:1})):L("",!0),t(h,{to:{name:"Profile"}},{default:r(()=>[t(C,{"prepend-icon":"mdi:mdi-account-circle",title:"Manage Account"})]),_:1}),t(C,{"prepend-icon":"mdi:mdi-theme-light-dark",onClick:d,title:`${c.value=="light"?"Dark":"Light"} Mode`},null,8,["title"]),t(h,{to:"/logout"},{default:r(()=>[t(C,{"prepend-icon":"mdi:mdi-logout",title:"Logout",value:"Logout"})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(se,null,{default:r(()=>[t(R,{onPageTitle:k,"logged-in":!0})]),_:1})]),_:1})}}}),sa=Q(la,[["__scopeId","data-v-c85b2aa2"]]),na="/assets/scotiacon-logo-7K00JbC4.svg",ra=e=>(he("data-v-5faec46d"),e=e(),Ve(),e),ia=ra(()=>W("h1",null,"Scotiacon Registration System",-1)),ua=z({__name:"LoginLayout",setup(e){return(n,o)=>{const i=M("RouterView");return V(),fe(pe,null,[t($,{class:"logo-container text-center"},{default:r(()=>[t(ne,{src:A(na),class:"scotiacon-logo ma-auto"},null,8,["src"]),ia]),_:1}),t($,{class:"login-container text-center mb-0 rounded rounded-lg mb-md-10"},{default:r(()=>[t($e,null,{default:r(()=>[t(ee,{class:"ma-2",color:"indigo",icon:"mdi:mdi-lock-outline"})]),_:1}),W("h2",null,J(A(qe).headingSignIn),1),t(i,{"logged-in":!1})]),_:1})],64)}}}),ca=Q(ua,[["__scopeId","data-v-5faec46d"]]),da=w({...F(),...oe({fullHeight:!0}),...X()},"VApp"),va=B()({name:"VApp",props:da(),setup(e,n){let{slots:o}=n;const i=Z(e),{layoutClasses:l,getLayoutItem:a,items:s,layoutRef:v}=le(e),{rtlClasses:m}=ye();return U(()=>{var c;return t("div",{ref:v,class:["v-application",i.themeClasses.value,l.value,m.value,e.class],style:[e.style]},[t("div",{class:"v-application__wrap"},[(c=o.default)==null?void 0:c.call(o)])])}),{getLayoutItem:a,items:s,theme:i}}}),ma=w({app:Boolean,color:String,height:{type:[Number,String],default:"auto"},...Ne(),...F(),...Ee(),...ae(),...Ae(),...xe({tag:"footer"}),...X()},"VFooter"),ga=B()({name:"VFooter",props:ma(),setup(e,n){let{slots:o}=n;const{themeClasses:i}=Z(e),{backgroundColorClasses:l,backgroundColorStyles:a}=De(E(e,"color")),{borderClasses:s}=Oe(e),{elevationClasses:v}=Me(e),{roundedClasses:m}=Ge(e),c=T(32),{resizeRef:d}=ze(g=>{g.length&&(c.value=g[0].target.clientHeight)}),k=f(()=>e.height==="auto"?c.value:parseInt(e.height,10)),{layoutItemStyles:y}=te({id:e.name,order:f(()=>parseInt(e.order,10)),position:f(()=>"bottom"),layoutSize:k,elementSize:f(()=>e.height==="auto"?void 0:k.value),active:f(()=>e.app),absolute:E(e,"absolute")});return U(()=>t(e.tag,{ref:d,class:["v-footer",i.value,l.value,s.value,v.value,m.value,e.class],style:[a.value,e.app?y.value:{height:_e(e.height)},e.style]},o)),{}}}),Ea=z({__name:"Default",emits:["pageTitle"],setup(e,{emit:n}){let o=be();const i=ke.getInstance(),l=i.getTokenByService("GrazeAPI"),a=p(!1),s=p(!1),v=n,m=K.getInstance();m.on("login",d=>{o=d,a.value=!0}),m.on("logout",()=>{o=void 0,a.value=!1}),m.on("tokenManager.tokenUpdated",()=>{a.value=!0,s.value=!0}),m.on("tokenManager.sessionExpired",()=>{a.value=!1,s.value=!1,O(),location.reload()}),l?o?l.AccessExpires<=Date.now()&&l.RefreshExpires>Date.now()?i.refreshToken(l):l.AccessExpires>Date.now()?(O(),a.value=!1,s.value=!0):(a.value=!0,s.value=!0):Ce().then(d=>{o=d,a.value=!0,s.value=!0}).catch(()=>{a.value=!1,s.value=!0}):(O(),a.value=!1,s.value=!0);const c=d=>{v("pageTitle",d)};return(d,k)=>(V(),_(va,{class:"bg-image"},{default:r(()=>[s.value?(V(),_(se,{key:0},{default:r(()=>[a.value&&A(o)?(V(),_(sa,{key:0,user:A(o),onPageTitle:c},null,8,["user"])):(V(),_(ca,{key:1}))]),_:1})):L("",!0),t(ga,null,{default:r(()=>[q(" Powered by Graze ")]),_:1})]),_:1}))}});export{Ea as default};
