import{p as ma,d as ca,c as ae,t as ye,a0 as Ja,a1 as Ot,f as t,F as k,m as he,i as Q,M as Z,N as re,r as _,k as Te,w as me,n as s,q as E,v as a,C as p,D as B,y as S,B as T,Q as X,x as C,A as L,P as _e,G as Lt,H as Pt,_ as it,a2 as st,a3 as Za,X as Je,o as el,b as tl,a4 as al,a5 as ll,a6 as Xt,O as Ze,z as ht,Z as nt,a7 as nl,a8 as ct,I as ol,u as il,a9 as sl,K as ul,J as rl,aa as dl,s as ml,ab as vt,ac as Wt,V as cl,U as vl,E as fl}from"./index-84c2ef81.js";import{T as Ul,V as va,e as Al,d as gl,c as Tl}from"./FormRenderer.vue_vue_type_style_index_0_lang-48e23376.js";import{F as Ae,a as _l}from"./form-3a7bf7fd.js";import{u as ut,V as fa}from"./VCheckbox-b1daef67.js";import{_ as et}from"./ModelDialog.vue_vue_type_script_setup_true_lang-89e5d5a5.js";import{h as Se,b as Ua,a as yl,c as pl,d as Jt,P as bt,u as Aa}from"./useDisplayTransactions-1c2f6cb0.js";import{V as W,a as N}from"./VRow-7c415058.js";import{V as xe,a as Ne,c as Mt}from"./VList-5df7b4ad.js";import{V as fe}from"./copyToClipboard-cbb91065.js";import{u as ga,a as ge,V as be,b as El,m as Dl,j as Il,c as Sl,d as Rl,k as Cl,e as Vl,l as Ol}from"./VContainer-a254cef0.js";import{G as rt}from"./userData-13de6ea4.js";import{C as Ta}from"./canEditRegistrations-68b5b4be.js";import{V as z,a as hl,u as bl}from"./VBtn-ac9dfa3a.js";import{b as _a,c as Ft,S as ya,d as Zt}from"./submission-6136b51d.js";import{G as wt}from"./group-d2a77946.js";import{C as $t}from"./canDo-99eb87c2.js";import{a as Ut,V as He}from"./scopeId-bc10c6b1.js";import{V as qe,b as tt,c as je,d as Bt,e as Le}from"./VCard-3058d975.js";import{V as Gt}from"./VAvatar-ac48aa50.js";import{v as pe}from"./v4-a960c1f4.js";import{_ as ot,V as pa}from"./SaveButton.vue_vue_type_script_setup_true_lang-7e6d7662.js";import{V as ne}from"./VTextField-e8373638.js";import{m as Ml,k as kl,l as Nl,n as Ll,o as Pl,p as Fl,q as wl,u as $l,r as Bl,s as Gl,t as Yl,v as xl,w as Hl,x as ql,y as jl,z as ea,A as ta,B as aa,c as At,d as gt,e as Yt,b as Tt,V as _t,a as Ea,g as Da,h as Ia,_ as Sa,j as Ra,i as Ye,f as kt}from"./VWindowItem-eebb73d3.js";import{_ as Ca}from"./DeleteDialog.vue_vue_type_script_setup_true_lang-80c31e45.js";import{a as Va,V as Nt}from"./VToolbar-c4a0f7cd.js";import{V as zl}from"./VDivider-8d9ff3a4.js";import{V as Ql}from"./VTextarea-de0a0f47.js";import{V as Oa,a as ha}from"./VChip-3f4dc78d.js";import{V as ft}from"./VDialog-1ab82e4e.js";import{V as Kl}from"./VForm-dc4b61db.js";import{V as Xl,b as Wl}from"./VNavigationDrawer-0a5a5239.js";import{s as Jl}from"./sortSubmissions-4bc1d48e.js";import{V as Zl,a as en}from"./VAlert-b811c597.js";import{S as tn}from"./setupLogin-7f6e0803.js";import{V as an}from"./forwardRefs-e807de29.js";import{u as Ct}from"./nil-d01db1aa.js";import{V as la,a as ln}from"./VTable-ca38f382.js";import"./index-26b71cef.js";import"./VFileInput-7f14411b.js";import"./createSimpleFunctional-fba3b52a.js";import"./VToolbarItems-b6d78807.js";var Oe=(e=>(e.ADMIN_LAYOUT_PANELS="ADMIN_LAYOUT_PANELS",e.ADMIN_LAYOUT_TABLE="ADMIN_LAYOUT_TABLE",e))(Oe||{});const nn=[{title:"Panel Layout",value:"ADMIN_LAYOUT_PANELS"},{title:"Table Layout",value:"ADMIN_LAYOUT_TABLE"}];var Me=(e=>(e.LAYOUT_ITEM_SOURCE_FORM="LAYOUT_ITEM_SOURCE_FORM",e.LAYOUT_ITEM_SOURCE_META="LAYOUT_ITEM_SOURCE_META",e.LAYOUT_ITEM_SOURCE_USER="LAYOUT_ITEM_SOURCE_USER",e))(Me||{});const on=[{title:"Form Field Submission Data",value:"LAYOUT_ITEM_SOURCE_FORM"},{title:"Miscellaneous Data",value:"LAYOUT_ITEM_SOURCE_META"},{title:"User Profile Data",value:"LAYOUT_ITEM_SOURCE_USER"}];var H=(e=>(e.META_DATA_SOURCE_NULL="",e.META_DATA_SOURCE_ACCOMMODATION_ALLOCATION="META_DATA_SOURCE_ACCOMMODATION_ALLOCATION",e.META_DATA_SOURCE_ACCOMMODATION_FORM="META_DATA_SOURCE_ACCOMMODATION_FORM",e.META_DATA_SOURCE_ADMIN_FORM="META_DATA_SOURCE_ADMIN_FORM",e.META_DATA_SOURCE_BADGE_DISPLAY="META_DATA_SOURCE_BADGE_DISPLAY",e.META_DATA_SOURCE_BADGE_FORM="META_DATA_SOURCE_BADGE_FORM",e.META_DATA_SOURCE_DATA_LAYOUT="META_DATA_SOURCE_DATA_LAYOUT",e.META_DATA_SOURCE_DEALER_FORM="META_DATA_SOURCE_DEALER_FORM",e.META_DATA_SOURCE_EMAILS="META_DATA_SOURCE_EMAILS",e.META_DATA_SOURCE_NOTES="META_DATA_SOURCE_NOTES",e.META_DATA_SOURCE_PAYMENT_STATUS="META_DATA_SOURCE_PAYMENT_STATUS",e.META_DATA_SOURCE_PAYMENTS="META_DATA_SOURCE_PAYMENTS",e.META_DATA_SOURCE_REGISTRATION_ACTIONS="META_DATA_SOURCE_REGISTRATION_ACTIONS",e.META_DATA_SOURCE_REGISTRATION_FORM="META_DATA_SOURCE_REGISTRATION_FORM",e.META_DATA_SOURCE_REGISTRATION_GROUP="META_DATA_SOURCE_REGISTRATION_GROUP",e.META_DATA_SOURCE_REGISTRATION_REFERENCE="META_DATA_SOURCE_REGISTRATION_REFERENCE",e.META_DATA_SOURCE_SUBMISSION_DATE="META_DATA_SOURCE_SUBMISSION_DATE",e.META_DATA_SOURCE_SUBMISSION_STATUS="META_DATA_SOURCE_SUBMISSION_STATUS",e.META_DATA_SOURCE_TAGS="META_DATA_SOURCE_TAGS",e))(H||{});const sn=[{title:"Accommodation Allocation",value:"META_DATA_SOURCE_ACCOMMODATION_ALLOCATION"},{title:"Accommodation Form",value:"META_DATA_SOURCE_ACCOMMODATION_FORM"},{title:"Actions",value:"META_DATA_SOURCE_REGISTRATION_ACTIONS"},{title:"Badge Display",value:"META_DATA_SOURCE_BADGE_DISPLAY"},{title:"Badge Form",value:"META_DATA_SOURCE_BADGE_FORM"},{title:"Data Display",value:"META_DATA_SOURCE_DATA_LAYOUT"},{title:"Dealer Form",value:"META_DATA_SOURCE_DEALER_FORM"},{title:"Emails",value:"META_DATA_SOURCE_EMAILS"},{title:"Notes",value:"META_DATA_SOURCE_NOTES"},{title:"Payment Status",value:"META_DATA_SOURCE_PAYMENT_STATUS"},{title:"Payments",value:"META_DATA_SOURCE_PAYMENTS"},{title:"Registration Group",value:"META_DATA_SOURCE_REGISTRATION_GROUP"},{title:"Registration Reference",value:"META_DATA_SOURCE_REGISTRATION_REFERENCE"},{title:"Registration Form",value:"META_DATA_SOURCE_REGISTRATION_FORM"},{title:"Submission Date",value:"META_DATA_SOURCE_SUBMISSION_DATE"},{title:"Submission Status",value:"META_DATA_SOURCE_SUBMISSION_STATUS"},{title:"Tags",value:"META_DATA_SOURCE_TAGS"}];var ke=(e=>(e.PANEL_STYLE_FLEX="PANEL_STYLE_FLEX",e.PANEL_STYLE_NAV_BOTTOM="PANEL_STYLE_NAV_BOTTOM",e.PANEL_STYLE_NAV_LEFT="PANEL_STYLE_NAV_LEFT",e.PANEL_STYLE_NAV_RIGHT="PANEL_STYLE_NAV_RIGHT",e.PANEL_STYLE_NAV_TOP="PANEL_STYLE_NAV_TOP",e))(ke||{});const un=[{title:"Body Flexible",value:"PANEL_STYLE_FLEX"},{title:"Fixed Bottom",value:"PANEL_STYLE_NAV_BOTTOM"},{title:"Fixed Left",value:"PANEL_STYLE_NAV_LEFT"},{title:"Fixed Right",value:"PANEL_STYLE_NAV_RIGHT"},{title:"Fixed Top",value:"PANEL_STYLE_NAV_TOP"}];var le=(e=>(e.USER_DATA_SOURCE_NULL="",e.USER_DATA_SOURCE_DISPLAY_NAME="USER_DATA_SOURCE_DISPLAY_NAME",e.USER_DATA_SOURCE_HANDLE="USER_DATA_SOURCE_HANDLE",e.USER_DATA_SOURCE_AVATAR="USER_DATA_SOURCE_AVATAR",e.USER_DATA_SOURCE_FIRST_NAME="USER_DATA_SOURCE_FIRST_NAME",e.USER_DATA_SOURCE_LAST_NAME="USER_DATA_SOURCE_LAST_NAME",e.USER_DATA_SOURCE_DATE_OF_BIRTH="USER_DATA_SOURCE_DATE_OF_BIRTH",e.USER_DATA_SOURCE_EMAIL="USER_DATA_SOURCE_EMAIL",e.USER_DATA_SOURCE_TELEGRAM="USER_DATA_SOURCE_TELEGRAM",e))(le||{});const rn=[{title:"Display Name",value:"USER_DATA_SOURCE_DISPLAY_NAME"},{title:"Handle",value:"USER_DATA_SOURCE_HANDLE"},{title:"Avatar",value:"USER_DATA_SOURCE_AVATAR"},{title:"First Name",value:"USER_DATA_SOURCE_FIRST_NAME"},{title:"Last Name",value:"USER_DATA_SOURCE_LAST_NAME"},{title:"Date of Birth",value:"USER_DATA_SOURCE_DATE_OF_BIRTH"},{title:"Email Address",value:"USER_DATA_SOURCE_EMAIL"},{title:"Telegram Username",value:"USER_DATA_SOURCE_TELEGRAM"}],dn=e=>{switch(e){case"EMAIL_STATUS_QUEUED":return"Queued";case"EMAIL_STATUS_QUEUE_ERROR":return"Processing";case"EMAIL_STATUS_QUEUE_FAILURE":return"Internal Error";case"EMAIL_STATUS_SENDING":return"Sending";case"EMAIL_STATUS_SENT":return"Sent";case"EMAIL_STATUS_SEND_ERROR":return"Failed to Send"}return"Unknown"},mn=e=>e===void 0?!1:$t(e,wt.GROUP_TYPE_SYSTEM).ManageUsers,cn=ma({itemsLength:{type:[Number,String],required:!0},...Ml(),...kl(),...Nl()},"VDataTableServer"),vn=ca()({name:"VDataTableServer",props:cn(),emits:{"update:modelValue":e=>!0,"update:page":e=>!0,"update:itemsPerPage":e=>!0,"update:sortBy":e=>!0,"update:options":e=>!0,"update:expanded":e=>!0,"update:groupBy":e=>!0,"click:row":(e,v)=>!0},setup(e,v){let{emit:n,slots:u}=v;const{groupBy:d}=Ll(e),{sortBy:i,multiSort:o,mustSort:l}=Pl(e),{page:r,itemsPerPage:c}=Fl(e),f=ae(()=>parseInt(e.itemsLength,10)),{columns:y,headers:m}=wl(e,{groupBy:d,showSelect:ye(e,"showSelect"),showExpand:ye(e,"showExpand")}),{items:g}=$l(e,y),{toggleSort:A}=Bl({sortBy:i,multiSort:o,mustSort:l,page:r}),{opened:w,isGroupOpen:V,toggleGroup:P,extractRows:U}=Gl({groupBy:d,sortBy:i}),{pageCount:F,setItemsPerPage:Y}=Yl({page:r,itemsPerPage:c,itemsLength:f}),{flatItems:x}=xl(g,d,w),{isSelected:ie,select:ee,selectAll:O,toggleSelect:b,someSelected:h,allSelected:R}=Hl(e,{allItems:g,currentPage:g}),{isExpanded:G,toggleExpand:oe}=ql(e),Ue=ae(()=>U(g.value));jl({page:r,itemsPerPage:c,sortBy:i,groupBy:d,search:ye(e,"search")}),Ja("v-data-table",{toggleSort:A,sortBy:i}),Ot({VDataTableRows:{hideNoData:ye(e,"hideNoData"),noDataText:ye(e,"noDataText"),loading:ye(e,"loading"),loadingText:ye(e,"loadingText")}});const ce=ae(()=>({page:r.value,itemsPerPage:c.value,sortBy:i.value,pageCount:F.value,toggleSort:A,setItemsPerPage:Y,someSelected:h.value,allSelected:R.value,isSelected:ie,select:ee,selectAll:O,toggleSelect:b,isExpanded:G,toggleExpand:oe,isGroupOpen:V,toggleGroup:P,items:Ue.value,groupedItems:x.value,columns:y.value,headers:m.value}));ga(()=>{const[ze]=ea.filterProps(e),[Qe]=ta.filterProps(e),[at]=aa.filterProps(e),[Ke]=la.filterProps(e);return t(la,he({class:["v-data-table",{"v-data-table--loading":e.loading},e.class],style:e.style},Ke),{top:()=>{var De;return(De=u.top)==null?void 0:De.call(u,ce.value)},default:()=>{var De,Pe,Fe,we;return u.default?u.default(ce.value):t(k,null,[(De=u.colgroup)==null?void 0:De.call(u,ce.value),t("thead",{class:"v-data-table__thead",role:"rowgroup"},[t(ta,he(Qe,{sticky:e.fixedHeader}),u)]),(Pe=u.thead)==null?void 0:Pe.call(u,ce.value),t("tbody",{class:"v-data-table__tbody",role:"rowgroup"},[u.body?u.body(ce.value):t(aa,he(at,{items:x.value}),u)]),(Fe=u.tbody)==null?void 0:Fe.call(u,ce.value),(we=u.tfoot)==null?void 0:we.call(u,ce.value)])},bottom:()=>u.bottom?u.bottom(ce.value):t(ea,ze,{prepend:u["footer.prepend"]})})})}}),fn=B("br",null,null,-1),Un=B("h3",null,"Assigned Accommodation",-1),An=B("br",null,null,-1),gn=B("br",null,null,-1),Tn=B("h3",null,"Accommodation Preferences",-1),_n=B("h3",null,"Selected Tickets",-1),yn=B("br",null,null,-1),pn=Q({__name:"EditAccommodationAssignmentDialog",props:Z({convention:{},registration:{},selectedAccommodation:{},title:{}},{modelValue:{type:Boolean,required:!0}}),emits:Z(["update:field"],["update:modelValue"]),setup(e,{emit:v}){const n=e,{convention:u,registration:d,title:i=""}=n,o=_e(),l=re(e,"modelValue"),r=_({capacity:{max:O=>{var R;const b=F.value.find(G=>G.room.RoomUUID===O);return!b||b.room.MaximumCapacity===0?!0:(((R=m.value)==null?void 0:R.Members.length)||0)<=b.room.MaximumCapacity||"Too many people in the group for this room"},min:O=>{var R;const b=F.value.find(G=>G.room.RoomUUID===O);return!b||b.room.MinimumCapacity===0?!0:(((R=m.value)==null?void 0:R.Members.length)||0)>=b.room.MinimumCapacity||"Not enough people in the group for this room"}}}),c=_([]),f=ut(n,v,void 0,void 0,"field"),y=_(Te(f.value));me(f,()=>{y.value=Te(f.value)});const m=_(),g=_(""),A=_(""),w=_([]),V=_({Ticket:[],AddonsChecked:[],ComponentsChecked:[]}),P=async()=>{var R;const O=await o.getConventionAvailableAccommodation(u.ConventionUUID);O&&(c.value=O);const b=await o.getRegistrationGroup(d.RegistrationUUID||"");b&&(m.value=b);const h=await o.getConventionTickets(u.ConventionUUID);h&&(w.value=h);try{V.value=JSON.parse(((R=m.value)==null?void 0:R.TicketData)||"")}catch{}};me(g,()=>{A.value=F.value.length>0?F.value[0].value:""});const U=ae(()=>{const O=Y.value;return c.value.map(b=>{let h;return O.forEach(R=>{b.Costs.forEach(G=>{G.DateStart===(R==null?void 0:R.DateStart)&&G.DateEnd===R.DateEnd&&(h===void 0||h>G.Availability)&&(h=G.Availability)})}),{label:`${b.Name}`,title:`${b.Name} (${h} Available)`,value:b.AccommodationUUID}})}),F=ae(()=>{const O=Y.value,b=c.value.find(h=>h.AccommodationUUID===g.value);return(b==null?void 0:b.Pool.map(h=>{var G,oe;let R;return O.forEach(Ue=>{h.Costs.forEach(ce=>{ce.DateStart===(Ue==null?void 0:Ue.DateStart)&&ce.DateEnd===Ue.DateEnd&&(R===void 0||R>ce.Availability)&&(R=ce.Availability)})}),{label:`${(G=h.Venue)==null?void 0:G.Name} - ${h.Name}`,title:`${(oe=h.Venue)==null?void 0:oe.Name} - ${h.Name} (${R} Available)`,value:h.RoomUUID,room:h}}))||[]}),Y=ae(()=>[...V.value.Ticket,...V.value.AddonsChecked,...V.value.ComponentsChecked].map(O=>w.value.find(b=>b.TicketUUID===O)).filter(O=>O!==void 0&&O.RequiresAccommodation)),x=O=>{var b;o.assignAccommodation(((b=m.value)==null?void 0:b.Registration.RegistrationUUID)||"",g.value,A.value,!1).then(h=>{h?(P(),O&&O("Room Assigned")):O&&O("Room not assigned")}).catch(()=>{O&&O("Room not assigned")})},ie=O=>{var b,h;(b=m.value)!=null&&b.Registration.AllocationUUID?o.deleteAllocation(((h=m.value)==null?void 0:h.Registration.AllocationUUID)||"").then(R=>{R?(P(),O&&O("Allocation Deleted")):O&&O("Allocation not deleted")}).catch(()=>{O&&O("Allocation not deleted")}):O&&O("Nothing to Delete")},ee=O=>{var h,R;const b=(h=c.value.find(G=>G.AccommodationUUID===O.AccommodationUUID))==null?void 0:h.Pool;if(b){const G=b.find(oe=>oe.RoomUUID===O.RoomUUID);if(G)return`${(R=G.Venue)==null?void 0:R.Name} - ${G.Name}`}return""};return P(),(O,b)=>{var h;return s(),E(et,{modelValue:l.value,"onUpdate:modelValue":b[2]||(b[2]=R=>l.value=R),title:p(i),color:"primary","show-close-action":!0,"show-delete-action":!!((h=m.value)!=null&&h.Registration.Allocation),"show-save-action":!!A.value,"save-button-label":"Assign Room",onDelete:ie,onSave:x,fullscreen:!0,persistent:!0},{default:a(()=>[t(ge,{class:"pa-0",fluid:!0},{default:a(()=>[t(W,null,{default:a(()=>{var R;return[t(N,{cols:"12",md:"6"},{default:a(()=>{var G,oe;return[B("h3",null,"Group Members ("+S((G=m.value)==null?void 0:G.Members.length)+")",1),(s(!0),T(k,null,X((oe=m.value)==null?void 0:oe.Members,Ue=>(s(),T(k,{key:Ue.UUID},[C(" #"+S(Ue.Reference)+" "+S(Ue.Name),1),fn],64))),128))]}),_:1}),(R=m.value)!=null&&R.Registration.Allocation?(s(),E(N,{key:0,cols:"12",md:"6"},{default:a(()=>[Un,t(xe,null,{default:a(()=>{var G;return[(s(!0),T(k,null,X((G=m.value)==null?void 0:G.Registration.Allocation.Periods,oe=>(s(),E(Ne,{key:oe.AllocationPeriodUUID},{default:a(()=>{var Ue;return[C(S((Ue=c.value.find(ce=>ce.AccommodationUUID===oe.AccommodationUUID))==null?void 0:Ue.Name)+" ",1),An,C(" "+S(ee(oe))+" ",1),gn,B("small",null,"("+S(p(Se)(oe.DateStart))+" - "+S(p(Se)(oe.DateEnd))+")",1)]}),_:2},1024))),128))]}),_:1})]),_:1})):L("",!0)]}),_:1}),t(W,null,{default:a(()=>[t(N,{cols:"12",md:"6"},{default:a(()=>[O.selectedAccommodation.length?(s(),T(k,{key:0},[Tn,t(xe,null,{default:a(()=>[(s(!0),T(k,null,X(O.selectedAccommodation,(R,G)=>(s(),E(Ne,{key:R.AccommodationUUID},{default:a(()=>[C(S(G+1)+". "+S(R.Name),1)]),_:2},1024))),128))]),_:1})],64)):L("",!0)]),_:1}),t(N,{cosl:"12",md:"6"},{default:a(()=>[_n,t(xe,null,{default:a(()=>[(s(!0),T(k,null,X(Y.value,R=>(s(),E(Ne,{key:R==null?void 0:R.TicketUUID},{default:a(()=>[C(S(R.Name)+" ",1),yn,B("small",null,"("+S(p(Se)(R.DateStart))+" - "+S(p(Se)(R.DateEnd))+")",1)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1}),t(W,null,{default:a(()=>[t(N,{cols:"12",md:"6"},{default:a(()=>[t(fe,{modelValue:g.value,"onUpdate:modelValue":b[0]||(b[0]=R=>g.value=R),items:U.value,"item-title":"title","item-value":"value",label:"Accommodation"},null,8,["modelValue","items"])]),_:1}),t(N,{cols:"12",md:"6"},{default:a(()=>[t(fe,{modelValue:A.value,"onUpdate:modelValue":b[1]||(b[1]=R=>A.value=R),items:F.value,"item-title":"title","item-value":"value",label:"Room Pool",rules:[r.value.capacity.min,r.value.capacity.max]},null,8,["modelValue","items","rules"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue","title","show-delete-action","show-save-action"])}}}),En=e=>(Lt("data-v-33548a38"),e=e(),Pt(),e),Dn={key:0,class:"accommodationList"},In={key:0,class:"text-orange-darken-2"},Sn={key:1,class:"accommodationList"},Rn=En(()=>B("br",null,null,-1)),Cn=Q({__name:"DataTableItemAccommodation",props:{accommodations:{default:()=>[]},convention:{},forms:{},registration:{},tickets:{default:()=>[]},value:{default:""},venues:{}},setup(e){const v=rt(),n=Ta(v,e.convention),u=_(!1),d=ae(()=>e.registration.Allocation.Periods.map(l=>{var r;return{DateStart:l.DateStart,DateEnd:l.DateEnd,Accommodation:l.Accommodation||((r=e.accommodations)==null?void 0:r.find(c=>c.AccommodationUUID==l.AccommodationUUID))}}).sort((l,r)=>l.DateStart>r.DateStart?1:l.DateStart==r.DateStart?0:-1));e.registration&&e.registration.Allocation&&e.registration.Allocation.Periods&&e.registration.Allocation.Periods.forEach(l=>{var c;if(l.Accommodation)return;const r=(c=e.accommodations)==null?void 0:c.find(f=>f.AccommodationUUID==l.AccommodationUUID);r&&(l.Accommodation=r)});const i=ae(()=>{if(!e.value)return[];const l=JSON.parse(e.value),r=e.accommodations.filter(c=>l.includes(c.AccommodationUUID)).sort((c,f)=>{const y=l.findIndex(g=>g===c.AccommodationUUID),m=l.findIndex(g=>g===f.AccommodationUUID);return y>m?1:-1});return Te(r)}),o=ae(()=>{let l;const r=e.forms.find(c=>!!c.Sections.find(f=>{var y;return f.Fields?!!((y=f.Fields)!=null&&y.find(m=>{var g;return((g=m.Field)==null?void 0:g.Type)==="TICKET"?(l=m,!0):!1})):!1}));return l?!!e.registration.Submissions.find(c=>{if(c.FormUUID==(r==null?void 0:r.FormUUID))return!!c.Data.find(f=>{if(f.SectionFieldUUID==(l==null?void 0:l.SectionFieldUUID)){const y=JSON.parse(f.Data);return e.tickets.filter(m=>m.RequiresAccommodation).find(m=>y.Ticket.includes(m.TicketUUID)||y.AddonsChecked.includes(m.TicketUUID)||y.ComponentsChecked.includes(m.TicketUUID))}})}):!1});return(l,r)=>o.value?(s(),T(k,{key:0},[l.value?(s(),T("ol",Dn,[(s(!0),T(k,null,X(i.value,c=>(s(),T("li",{key:c.AccommodationUUID},[l.registration&&l.registration.Allocation&&l.registration.Allocation.Periods.find(f=>f.AccommodationUUID===c.AccommodationUUID)?(s(),T("strong",In,S(c.Name),1)):(s(),T(k,{key:1},[C(S(c.Name),1)],64))]))),128))])):(s(),T("ul",Sn,[(s(!0),T(k,null,X(d.value,c=>{var f;return s(),T("li",{key:c.DateStart},[C(S((f=c.Accommodation)==null?void 0:f.Name)+" ("+S(p(Se)(c.DateStart))+" - "+S(p(Se)(c.DateEnd))+")",1),Rn])}),128))])),p(n)?(s(),E(z,{key:2,onClick:r[0]||(r[0]=c=>u.value=!0),variant:"flat",color:"success"},{default:a(()=>[C("Assign Accommodation")]),_:1})):L("",!0),l.convention&&u.value?(s(),E(pn,{key:3,modelValue:u.value,"onUpdate:modelValue":r[1]||(r[1]=c=>u.value=c),title:"Accommodation Allocation",convention:l.convention,registration:l.registration,tickets:l.tickets,"selected-accommodation":i.value},null,8,["modelValue","convention","registration","tickets","selected-accommodation"])):L("",!0)],64)):L("",!0)}});const ba=it(Cn,[["__scopeId","data-v-33548a38"]]),Vn={key:0,class:"addonList"},On={key:0},hn={key:0},bn=Q({__name:"DataTableItemExtras",props:{extras:{default:()=>[]},value:{default:""}},setup(e){const v=ae(()=>{if(!e.value)return;const n=JSON.parse(e.value),u=Object.keys(n),d=Te(e.extras);return d.forEach(i=>{i.Options=i.Options.filter(o=>u.includes(o.OptionUUID)?(o.Choices=o.Choices.filter(l=>l.TagUUID===n[o.OptionUUID].choiceId),n[o.OptionUUID].checked):!1)}),d.filter(i=>i.Options.length>0),d});return(n,u)=>n.value?(s(),T("ul",Vn,[(s(!0),T(k,null,X(v.value,d=>(s(),T(k,{key:d.ExtraUUID},[d.Options.length?(s(),T("li",On,[B("strong",null,S(d.Name),1),B("ul",null,[(s(!0),T(k,null,X(d.Options,i=>(s(),T("li",{key:i.OptionUUID},[C(S(i.Name)+" ",1),i.Choices.length==1?(s(),T("small",hn,"("+S(i.Choices[0].Title)+")",1)):L("",!0)]))),128))])])):L("",!0)],64))),128))])):L("",!0)}});const Ma=it(bn,[["__scopeId","data-v-55786e01"]]),Mn={key:0},ka=Q({__name:"DataTableItemInterests",props:{interests:{default:()=>[]},value:{default:""}},setup(e){const v=ae(()=>{if(!e.value)return;const n=JSON.parse(e.value);return Object.entries(n).filter(([,u])=>u).map(([u,d])=>e.interests.find(i=>i.InterestUUID===u)).filter(u=>u!==void 0)});return(n,u)=>n.value?(s(),T("ul",Mn,[(s(!0),T(k,null,X(v.value,d=>(s(),T("li",{key:d.InterestUUID},S(d.Name),1))),128))])):L("",!0)}}),kn=B("br",null,null,-1),Nn=B("small",null,"Options:",-1),Ln=B("br",null,null,-1),Pn=B("small",null,"Addons:",-1),Na=Q({__name:"DataTableItemTicket",props:{tickets:{default:()=>[]},value:{default:""}},setup(e){const v=ae(()=>{if(!e.value)return;let n={Ticket:[],AddonsChecked:[],ComponentsChecked:[]};try{n=JSON.parse(e.value),"ticket"in n&&(n.Ticket=n.ticket),"addonsChecked"in n&&(n.AddonsChecked=n.addonsChecked),"componentsChecked"in n&&(n.ComponentsChecked=n.componentsChecked)}catch{}return n.Ticket.filter(u=>{const d=e.tickets.find(i=>i.TicketUUID===u);return!(!d||d.Type!==Ul.TICKET_TYPE_TICKET)}).map(u=>{const d=e.tickets.find(o=>o.TicketUUID===u),i=Te(d);return i.TicketComponents=d.TicketComponents.filter(o=>n.ComponentsChecked.includes(o.TicketUUID)),i.AddonTickets=d.AddonTickets.filter(o=>n.AddonsChecked.includes(o.TicketUUID)),i})});return(n,u)=>n.value?(s(!0),T(k,{key:0},X(v.value,d=>(s(),T("div",{key:d.TicketUUID},[B("strong",null,S(d.Name),1),d.TicketComponents.length>0?(s(),T(k,{key:0},[kn,Nn,C("  "),(s(!0),T(k,null,X(d.TicketComponents,i=>(s(),T(k,{key:i.TicketUUID},[B("small",null,S(i.Name),1),C("  ")],64))),128))],64)):L("",!0),d.AddonTickets.length>0?(s(),T(k,{key:1},[Ln,Pn,C("  "),(s(!0),T(k,null,X(d.AddonTickets,i=>(s(),T("small",{key:i.TicketUUID},[C("("),B("em",null,S(i.Name),1),C(")")]))),128))],64)):L("",!0)]))),128)):L("",!0)}}),La=Q({__name:"DataPanelAccommodation",props:Z({accommodations:{},convention:{},data:{},forms:{},tickets:{},venues:{},registration:{}},{modelValue:{required:!0}}),emits:["update:modelValue"],setup(e){return re(e,"modelValue"),(v,n)=>(s(),T("div",null,[t(ba,{value:v.data,accommodations:v.accommodations,convention:v.convention,forms:v.forms,registration:v.registration,tickets:v.tickets,venues:v.venues},null,8,["value","accommodations","convention","forms","registration","tickets","venues"])]))}}),Fn={key:0,class:"text-red-darken-4 font-weight-bold"},wn={key:1,class:"text-orange-darken-2 font-weight-bold"},$n=Q({__name:"DataPanelAge",props:Z({data:{},forms:{},registration:{}},{modelValue:{required:!0}}),emits:["update:modelValue"],setup(e){const v=re(e,"modelValue"),n=new Date,u=n.getFullYear(),d=(n.getMonth()+1).toLocaleString("en-US",{minimumIntegerDigits:2}),i=n.getDate().toLocaleString("en-US",{minimumIntegerDigits:2}),o=_(!1),l=_(`${u}-${d}-${i}`),r=_(18);e.forms.find(m=>m.Sections.find(g=>g.Fields?g.Fields.find(A=>{var w;return A.SectionFieldUUID===v.value.SectionFieldUUID?(v.value.SectionField=A,(w=A.Field)==null||w.Values.forEach(V=>{switch(V.Title){case"UNDER_AGE_APPLY_TAG":V.Value.length>0&&(o.value=!0);break;case"BEFORE_DATE":l.value=V.Value;break;case"MIN_AGE":r.value=parseInt(V.Value);break}}),!0):!1}):!1));const c=m=>({registration:f(m,e.registration.CreatedAt||"",r.value),convention:f(m,l.value,r.value)}),f=(m,g,A)=>{if(m>=g)return!1;const w=y(m),P=y(g).getTime()-w.getTime(),U=1e3*60*60*24*365.25;return P/U>=A},y=m=>{const[g,A,w]=m.split("-");return new Date(parseInt(g),parseInt(A)-1,parseInt(w))};return(m,g)=>(s(),T("div",null,[B("p",null,[C(S(p(Se)(m.data,{withDay:!1,withYear:!0}))+" ",1),o.value&&c(m.data).convention&&c(m.data).registration?(s(),E(be,{key:0,icon:"mdi:mdi-check",color:"success"})):o.value&&!c(m.data).convention?(s(),E(be,{key:1,icon:"mdi:mdi-alert",color:"error"})):o.value&&c(m.data).convention&&!c(m.data).registration?(s(),E(be,{key:2,icon:"mdi:mdi-alert",color:"warning"})):L("",!0)]),o.value?(s(),T(k,{key:0},[c(m.data).convention?c(m.data).registration?L("",!0):(s(),T("p",wn," Attendee was under "+S(r.value)+" at time of registration ",1)):(s(),T("p",Fn," Attendee is under "+S(r.value),1))],64)):L("",!0)]))}}),xt=Q({__name:"Badges",props:{cardClass:{default:""},convention:{},registration:{},showTitle:{type:Boolean,default:!0}},setup(e){const v=_e(),n=Ut(),u=_([]),d=o=>{var r;const l=document.createElement("a");l.download=`${((r=e.convention)==null?void 0:r.Name)||""} Badge Image - ${e.registration.Reference} - ${e.registration.User.DisplayName}.jpg`,l.href=o,document.body.appendChild(l),l.click(),document.body.removeChild(l)},i=async o=>n.GetConBadgeImageURL(e.registration.RegistrationUUID,o);return v.getConBadgeList(e.registration.RegistrationUUID).then(o=>{o.forEach(l=>{i(l).then(r=>{u.value.push({template:l,url:r})})})}).catch(()=>{}),(o,l)=>(s(!0),T(k,null,X(u.value,r=>(s(),E(Le,{key:r.template,class:st(o.cardClass)},{default:a(()=>[t(tt,null,{default:a(()=>[o.showTitle?(s(),E(qe,{key:0},{default:a(()=>[t(W,{class:"flex-row-reverse"},{default:a(()=>[t(N,{class:"text-wrap flex-grow-1"},{default:a(()=>[C(" Badges (#"+S(o.registration.Reference)+" "+S(o.registration.User.DisplayName)+") ",1)]),_:1})]),_:1})]),_:1})):L("",!0)]),_:1}),t(je,null,{default:a(()=>[t(Gt,{src:r.url,height:"280",width:"280"},null,8,["src"])]),_:2},1024),t(Bt,null,{default:a(()=>[t(z,{color:"primary","prepend-icon":"mdi:mdi-download",variant:"flat",onClick:c=>d(r.url)},{default:a(()=>[C("Download")]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1032,["class"]))),128))}}),Bn={key:4},Gn={key:7},Yn=Q({__name:"FormDataItem",props:Z({accommodations:{},convention:{},extras:{},forms:{},interests:{},itemClass:{},tickets:{},venues:{},registration:{}},{modelValue:{required:!0}}),emits:["update:modelValue"],setup(e){const v=re(e,"modelValue"),n=ae(()=>{var f,y,m,g;const r=v.value,c=()=>{var A;for(let w=0;w<e.forms.length;w+=1)for(let V=0;V<e.forms[w].Sections.length;V+=1)if(e.forms[w].Sections[V].Fields){const P=(A=e.forms[w].Sections[V].Fields)==null?void 0:A.find(U=>U.SectionFieldUUID===r.SectionFieldUUID);if(P)return P}};return((y=(f=r.SectionField)==null?void 0:f.Field)==null?void 0:y.Type)||((g=(m=c())==null?void 0:m.Field)==null?void 0:g.Type)}),u=ae(()=>{for(let r=0;r<e.registration.Submissions.length;r+=1){const f=e.registration.Submissions[r].Data.find(y=>y.SectionFieldUUID===v.value.SectionFieldUUID);if(f)return f.Data}return""}),d=_e(),i=Ut(),o=_(""),l=_("");if(n.value==="BADGE_IMAGE")try{const r=JSON.parse(u.value||"{}");r.fileUUID&&(l.value=i.GetBadgeImageURL(r.fileUUID)),e.registration&&d.getConBadgeDisplayName(e.registration.RegistrationUUID).then(c=>{c&&(o.value=c)}).catch(()=>{})}catch{}return(r,c)=>n.value==="ACCOMMODATION"?(s(),E(La,{key:0,convention:r.convention,tickets:r.tickets,accommodations:r.accommodations,venues:r.venues,registration:r.registration,forms:r.forms,modelValue:v.value,"onUpdate:modelValue":c[0]||(c[0]=f=>v.value=f),data:u.value},null,8,["convention","tickets","accommodations","venues","registration","forms","modelValue","data"])):n.value==="EXTRAS"?(s(),E(Ma,{key:1,value:u.value,extras:r.extras},null,8,["value","extras"])):n.value==="TICKET"?(s(),E(Na,{key:2,value:u.value,tickets:r.tickets},null,8,["value","tickets"])):n.value==="INTERESTS"?(s(),E(ka,{key:3,value:u.value,interests:r.interests},null,8,["value","interests"])):n.value==="CHECKBOX"?(s(),T("div",Bn,[u.value?(s(),E(be,{key:0,icon:"mdi:mdi-check",color:"success"})):(s(),E(be,{key:1,icon:"mdi:mdi-close",color:"error"}))])):n.value==="AGE"?(s(),E($n,{key:5,data:u.value,forms:r.forms,registration:r.registration,modelValue:v.value,"onUpdate:modelValue":c[1]||(c[1]=f=>v.value=f)},null,8,["data","forms","registration","modelValue"])):n.value==="BADGE_IMAGE"?(s(),E(xt,{key:6,convention:r.convention,registration:r.registration,"show-title":!1,"card-class":r.itemClass},null,8,["convention","registration","card-class"])):(s(),T("div",Gn,S(u.value),1))}}),xn={key:0},Hn={key:0},qn=B("strong",null,"Total:",-1),jn=Q({__name:"DataPanelRegistrationGroup",props:{registration:{}},setup(e){const v=ae(()=>{const n=[];let u;return e.registration.Leader?u=e.registration:u=e.registration.Primary,n.push({Name:u.User.DisplayName,UUID:u.UserUUID,UserUUID:u.User.UserUUID,IsLeader:!0,Reference:u.Reference,Paid:u.Paid,Total:u.Total}),n.push(...u.Members.map(d=>({Name:d.User.DisplayName,UUID:d.UserUUID,UserUUID:d.User.UserUUID,IsLeader:!1,Reference:d.Reference,Paid:d.Paid,Total:d.Total}))),n});return(n,u)=>n.registration.Members.length===0&&!n.registration.Primary?(s(),T("em",xn," Not in a group ")):(s(),T(k,{key:1},[B("ul",null,[(s(!0),T(k,null,X(v.value,d=>(s(),T("li",{key:d.UUID,class:"ml-0"},[C(" #"+S(d.Reference)+" : "+S(d.Name)+" ",1),d.IsLeader?(s(),T("strong",Hn,"(Leader)")):L("",!0)]))),128))]),qn,C(" "+S(v.value.length),1)],64))}}),zn=Q({__name:"DataPanelSubmissionDate",props:{registration:{}},setup(e){const v=ae(()=>{const n=e.registration.Submissions.find(u=>{var d;return((d=u.Form)==null?void 0:d.Type)===Ae.FORM_TYPE_REGISTRATION});return n?n.CreatedAt||"":e.registration.CreatedAt||""});return(n,u)=>(s(),T("div",null,S(p(Se)(v.value,{withDay:!1,withYear:!0})),1))}}),Qn={class:"text-grey-lighten-1"},Kn=Q({__name:"DataPanelSubmissionStatus",props:{convention:{},forms:{},registration:{}},emits:["showForm"],setup(e,{emit:v}){const n=rt(),u=Ta(n,e.convention),d=ae(()=>e.registration.Submissions.map(l=>{const r=e.forms.find(c=>c.FormUUID===l.FormUUID);if(r)return{Heading:r.Heading,Form:r,Submission:l,Registration:e.registration}}).filter(l=>!!l)),i=(l,r,c)=>{v("showForm",l,r,c)},o=l=>({ID:0,SubmissionUUID:pe(),FormID:l.ID,FormUUID:l.FormUUID,Form:l,UserID:e.registration.UserID,UserUUID:e.registration.UserUUID,RegistrationID:e.registration.ID,RegistrationUUID:e.registration.RegistrationUUID,Registration:e.registration,Data:[],Status:ya.SUBMISSION_STATUS_NULL});return(l,r)=>(s(),T(k,null,[B("ul",null,[(s(!0),T(k,null,X(l.forms.filter(c=>c.Type===p(Ae).FORM_TYPE_ADMIN&&d.value.findIndex(f=>f.Form.ID===c.ID)<0),c=>(s(),T("li",{key:c.Heading},[B("strong",Qn,S(c.Heading),1),p(u)?(s(),E(z,{key:0,class:"text-grey-lighten-1",icon:"mdi:mdi-form-select",title:"Edit Submitted Data",variant:"flat",onClick:f=>i(l.registration,c,o(c))},null,8,["onClick"])):L("",!0)]))),128))]),B("ul",null,[(s(!0),T(k,null,X(d.value,c=>(s(),T("li",{key:c.Heading},[B("strong",null,[C(S(c.Heading),1),c.Form.Type!==p(Ae).FORM_TYPE_ADMIN?(s(),T(k,{key:0},[C(": ")],64)):L("",!0)]),c.Form.Type!==p(Ae).FORM_TYPE_ADMIN?(s(),T("span",{key:0,class:st(p(_a)(c.Submission.Status))},S(p(Ft)(c.Submission.Status)),3)):L("",!0),p(u)?(s(),E(z,{key:1,icon:"mdi:mdi-form-select",title:"Edit Submitted Data",variant:"flat",onClick:f=>i(c.Registration,c.Form,c.Submission)},null,8,["onClick"])):L("",!0)]))),128))])],64))}}),Xn={key:0,class:"text-blue"},Wn={key:1,class:"text-red"},Jn={key:2,class:"text-orange"},Zn={key:3,class:"text-orange"},eo={key:4,class:"text-orange"},to={key:5,class:"text-orange"},ao={key:6,class:"text-green"},lo=Q({__name:"DataPanelPaymentStatus",props:{registration:{}},setup(e){const v=ae(()=>{if(e.registration.Paid===0&&e.registration.Total)return"REQUIRED";if(e.registration.Total>e.registration.Paid)return"ADDITIONAL_REQUIRED";const n=e.registration.Members.find(u=>u.Paid===0&&(u.Total||0)>0);return n?e.registration.Total===0&&n.Total===0?"NOT_REQUIRED":e.registration.Total===0&&n.Total||e.registration.Total>0&&n.Total===0?"MISSING_REQUIRED":e.registration.Paid>=e.registration.Total?"AWAITING_PARTNER":"ALL_REQUIRED":e.registration.Total===0?"NOT_REQUIRED":"COMPLETE"});return(n,u)=>v.value=="NOT_REQUIRED"?(s(),T("div",Xn,"No Payment Requested")):v.value=="MISSING_REQUIRED"?(s(),T("div",Wn,"Partner Payment Not Requested")):v.value=="AWAITING_PARTNER"?(s(),T("div",Jn,"Awaiting Partner Payment")):v.value=="ALL_REQUIRED"?(s(),T("div",Zn,"Awaiting Payments")):v.value=="REQUIRED"?(s(),T("div",eo,"Awaiting Payment")):v.value=="ADDITIONAL_REQUIRED"?(s(),T("div",to,"Awaiting Additional Payments")):(s(),T("div",ao,"Completed"))}});var no=["onActivate","onAddUndo","onBeforeAddUndo","onBeforeExecCommand","onBeforeGetContent","onBeforeRenderUI","onBeforeSetContent","onBeforePaste","onBlur","onChange","onClearUndos","onClick","onContextMenu","onCopy","onCut","onDblclick","onDeactivate","onDirty","onDrag","onDragDrop","onDragEnd","onDragGesture","onDragOver","onDrop","onExecCommand","onFocus","onFocusIn","onFocusOut","onGetContent","onHide","onInit","onKeyDown","onKeyPress","onKeyUp","onLoadContent","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp","onNodeChange","onObjectResizeStart","onObjectResized","onObjectSelected","onPaste","onPostProcess","onPostRender","onPreProcess","onProgressState","onRedo","onRemove","onReset","onSaveContent","onSelectionChange","onSetAttrib","onSetContent","onShow","onSubmit","onUndo","onVisualAid"],oo=function(e){return no.map(function(v){return v.toLowerCase()}).indexOf(e.toLowerCase())!==-1},io=function(e,v,n){Object.keys(v).filter(oo).forEach(function(u){var d=v[u];typeof d=="function"&&(u==="onInit"?d(e,n):n.on(u.substring(2),function(i){return d(i,n)}))})},so=function(e,v,n,u){var d=e.modelEvents?e.modelEvents:null,i=Array.isArray(d)?d.join(" "):d;me(u,function(o,l){n&&typeof o=="string"&&o!==l&&o!==n.getContent({format:e.outputFormat})&&n.setContent(o)}),n.on(i||"change input undo redo",function(){v.emit("update:modelValue",n.getContent({format:e.outputFormat}))})},uo=function(e,v,n,u,d,i){u.setContent(i()),n.attrs["onUpdate:modelValue"]&&so(v,n,u,d),io(e,n.attrs,u)},na=0,Pa=function(e){var v=Date.now(),n=Math.floor(Math.random()*1e9);return na++,e+"_"+n+na+String(v)},ro=function(e){return e!==null&&e.tagName.toLowerCase()==="textarea"},oa=function(e){return typeof e>"u"||e===""?[]:Array.isArray(e)?e:e.split(" ")},mo=function(e,v){return oa(e).concat(oa(v))},co=function(e){return e==null},ia=function(){return{listeners:[],scriptId:Pa("tiny-script"),scriptLoaded:!1}},vo=function(){var e=ia(),v=function(d,i,o,l){var r=i.createElement("script");r.referrerPolicy="origin",r.type="application/javascript",r.id=d,r.src=o;var c=function(){r.removeEventListener("load",c),l()};r.addEventListener("load",c),i.head&&i.head.appendChild(r)},n=function(d,i,o){e.scriptLoaded?o():(e.listeners.push(o),d.getElementById(e.scriptId)||v(e.scriptId,d,i,function(){e.listeners.forEach(function(l){return l()}),e.scriptLoaded=!0}))},u=function(){e=ia()};return{load:n,reinitialize:u}},fo=vo(),Uo=function(){return typeof window<"u"?window:global},Ge=function(){var e=Uo();return e&&e.tinymce?e.tinymce:null},Ao={apiKey:String,cloudChannel:String,id:String,init:Object,initialValue:String,inline:Boolean,modelEvents:[String,Array],plugins:[String,Array],tagName:String,toolbar:[String,Array],modelValue:String,disabled:Boolean,tinymceScriptSrc:String,outputFormat:{type:String,validator:function(e){return e==="html"||e==="text"}}},Ie=globalThis&&globalThis.__assign||function(){return Ie=Object.assign||function(e){for(var v,n=1,u=arguments.length;n<u;n++){v=arguments[n];for(var d in v)Object.prototype.hasOwnProperty.call(v,d)&&(e[d]=v[d])}return e},Ie.apply(this,arguments)},go=function(e,v,n,u){return e(u||"div",{id:v,ref:n})},To=function(e,v,n){return e("textarea",{id:v,visibility:"hidden",ref:n})},Vt={selector:void 0,target:void 0},_o=Q({props:Ao,setup:function(e,v){var n=e.init?Ie(Ie({},e.init),Vt):Ie({},Vt),u=Za(e),d=u.disabled,i=u.modelValue,o=u.tagName,l=_(null),r=null,c=e.id||Pa("tiny-vue"),f=e.init&&e.init.inline||e.inline,y=!!v.attrs["onUpdate:modelValue"],m=!0,g=e.initialValue?e.initialValue:"",A="",w=function(U){return y?function(){return i!=null&&i.value?i.value:""}:function(){return U?g:A}},V=function(){var U=w(m),F=Ie(Ie({},n),{readonly:e.disabled,target:l.value,plugins:mo(n.plugins,e.plugins),toolbar:e.toolbar||n.toolbar,inline:f,setup:function(Y){r=Y,Y.on("init",function(x){return uo(x,e,v,Y,i,U)}),typeof n.setup=="function"&&n.setup(Y)}});ro(l.value)&&(l.value.style.visibility=""),Ge().init(F),m=!1};me(d,function(U){var F;r!==null&&(typeof((F=r.mode)===null||F===void 0?void 0:F.set)=="function"?r.mode.set(U?"readonly":"design"):r.setMode(U?"readonly":"design"))}),me(o,function(U){var F;y||(A=r.getContent()),(F=Ge())===null||F===void 0||F.remove(r),Je(function(){return V()})}),el(function(){if(Ge()!==null)V();else if(l.value&&l.value.ownerDocument){var U=e.cloudChannel?e.cloudChannel:"6",F=e.apiKey?e.apiKey:"no-api-key",Y=co(e.tinymceScriptSrc)?"https://cdn.tiny.cloud/1/".concat(F,"/tinymce/").concat(U,"/tinymce.min.js"):e.tinymceScriptSrc;fo.load(l.value.ownerDocument,Y,V)}}),tl(function(){Ge()!==null&&Ge().remove(r)}),f||(al(function(){m||V()}),ll(function(){var U;y||(A=r.getContent()),(U=Ge())===null||U===void 0||U.remove(r)}));var P=function(U){var F;A=r.getContent(),(F=Ge())===null||F===void 0||F.remove(r),n=Ie(Ie(Ie({},n),U),Vt),Je(function(){return V()})};return v.expose({rerender:P,getEditor:function(){return r}}),function(){return f?go(Xt,c,l,e.tagName):To(Xt,c,l)}}});const yo=["colspan"],po=B("strong",null,"E-Mail Content",-1),Eo=["innerHTML"],Do=Q({__name:"Communications",props:{expanded:{type:Boolean,default:!0},hideHistory:{type:Boolean,default:!1},registration:{},showEditor:{type:Boolean}},emits:["close-editor"],setup(e,{emit:v}){const n=_e(),u=_([]),d=_({From:"",Subject:"",HTML:""}),i=_(""),o=_(""),l=_(""),r=_(!1),c=_(e.expanded?["1"]:[]),f=_([]),y=_([]),m=_([{key:"CreatedAt",title:"Date"},{key:"Subject",title:"Subject"},{key:"User.DisplayName",title:"Sender"},{key:"Status",title:"Status"}]),g=_([{key:"CreatedAt",order:"asc"}]);me(d,P=>{l.value=P.From||l.value||"",o.value=P.Subject||o.value||"",i.value=P.HTML||i.value||""});const A=()=>{n.getRegistrationEmails(e.registration.RegistrationUUID).then(P=>{P&&(P.forEach(U=>{U.CreatedAt=Ua(new Date(U.CreatedAt||"")),U.Status=dn(U.Status),U.User||(U.User={ID:0,UserUUID:"",DisplayName:"System",Handle:"",Credentials:[],Additional:{FirstName:"",LastName:"",DOB:"",Email:""},Data:"",Groups:[],Tags:[]})}),y.value=P)})};A(),(()=>{n.getRegistrationEmailTemplates(e.registration.RegistrationUUID).then(P=>{P&&(u.value=P)})})();const V=({callback:P})=>{n.sendRegistrationEmail(e.registration.RegistrationUUID,l.value,o.value,i.value).then(U=>{U?P&&(P("Email Sent"),A(),setTimeout(()=>{r.value=!1},2e3)):P&&P("Not sent")}).catch(()=>{P&&P("Not sent")})};return(P,U)=>(s(),T(k,null,[P.showEditor?(s(),T(k,{key:0},[t(W,null,{default:a(()=>[t(N,null,{default:a(()=>[t(va,{items:u.value,"item-title":"Subject","return-object":"",label:"Template","hide-details":"",modelValue:d.value,"onUpdate:modelValue":U[0]||(U[0]=F=>d.value=F),variant:"outlined"},null,8,["items","modelValue"])]),_:1})]),_:1}),t(W,null,{default:a(()=>[t(N,{cols:"12"},{default:a(()=>[t(ne,{modelValue:l.value,"onUpdate:modelValue":U[1]||(U[1]=F=>l.value=F),label:"From",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),t(N,{cols:"12"},{default:a(()=>[t(ne,{modelValue:o.value,"onUpdate:modelValue":U[2]||(U[2]=F=>o.value=F),label:"Subject",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),t(N,{cols:"12"},{default:a(()=>[t(p(_o),{modelValue:i.value,"onUpdate:modelValue":U[3]||(U[3]=F=>i.value=F),"api-key":"g9sce3fktcgvk0i7sp96cahgyk4cos7q27es3ubnlal3xf3z"},null,8,["modelValue"])]),_:1})]),_:1}),t(W,null,{default:a(()=>[t(N,null,{default:a(()=>[t(ot,{onClick:U[4]||(U[4]=F=>v("close-editor")),label:"Close E-mail Editor",color:"secondary","prepend-icon":"mdi:mdi-window-close"})]),_:1}),t(N,{class:"text-right"},{default:a(()=>[t(ot,{onClick:V,label:"Send",color:"error"})]),_:1})]),_:1})],64)):L("",!0),y.value.length&&!P.hideHistory?(s(),E(_t,{key:1,class:"my-2",multiple:!0,modelValue:c.value,"onUpdate:modelValue":U[7]||(U[7]=F=>c.value=F)},{default:a(()=>[t(Tt,{value:"1"},{default:a(()=>[t(At,null,{default:a(()=>[C(" Email History ")]),_:1}),t(gt,null,{default:a(()=>[t(p(Yt),{items:y.value,headers:m.value,"show-expand":!0,"item-value":"EmailUUID",expanded:f.value,"onUpdate:expanded":U[5]||(U[5]=F=>f.value=F),"sort-by":g.value,"onUpdate:sortBy":U[6]||(U[6]=F=>g.value=F)},{"expanded-row":a(({columns:F,item:Y})=>[B("tr",null,[B("td",{colspan:F.length},[po,B("div",{class:"communicationsViewEmailPreview",innerHTML:Y.raw.HTML},null,8,Eo)],8,yo)])]),"footer.prepend":a(()=>[t(z,{"prepend-icon":"mdi:mdi-refresh",color:"primary",class:"mr-4",onClick:A},{default:a(()=>[C("Refresh")]),_:1})]),_:1},8,["items","headers","expanded","sort-by"])]),_:1})]),_:1})]),_:1},8,["modelValue"])):L("",!0)],64))}});const Fa=Q({__name:"Emails",props:{allowSending:{type:Boolean,default:!0},expanded:{type:Boolean,default:!0},hideHistory:{type:Boolean,default:!1},showTitle:{type:Boolean,default:!0},registration:{},textClass:{default:""}},setup(e){const v=_(!1);return(n,u)=>(s(),E(Le,null,{default:a(()=>[n.showTitle?(s(),E(tt,{key:0},{default:a(()=>[t(qe,null,{default:a(()=>[C(" E-Mails (#"+S(n.registration.Reference)+" "+S(n.registration.User.DisplayName)+") ",1)]),_:1})]),_:1})):L("",!0),t(je,{class:st(n.textClass)},{default:a(()=>[n.allowSending?(s(),E(W,{key:0},{default:a(()=>[t(N,{cols:"12"},{default:a(()=>[t(z,{"prepend-icon":"mdi:mdi-email",color:"primary",onClick:u[0]||(u[0]=d=>v.value=!0)},{default:a(()=>[C(" Prepare Email ")]),_:1})]),_:1})]),_:1})):L("",!0),t(Do,{registration:n.registration,expanded:n.expanded,"hide-history":n.hideHistory,"show-editor":v.value,onCloseEditor:u[1]||(u[1]=d=>v.value=!1)},null,8,["registration","expanded","hide-history","show-editor"])]),_:1},8,["class"])]),_:1}))}}),Io=Q({__name:"EditNoteCategoryDialog",props:Z({convention:{},noteCategory:{},title:{}},{modelValue:{type:Boolean,required:!0}}),emits:Z(["update:noteCategory"],["update:modelValue"]),setup(e,{emit:v}){const n=e,{title:u=""}=n,d=re(e,"modelValue"),i=ut(n,v,void 0,void 0,"noteCategory"),o=_(Te(i.value));me(i,()=>{o.value=Te(i.value)});const l=()=>{d.value=!1},r=()=>{o.value=Te(i.value)},c=()=>{i.value=o.value};return(f,y)=>(s(),E(et,{modelValue:d.value,"onUpdate:modelValue":y[2]||(y[2]=m=>d.value=m),onReset:r,onSave:c,title:p(u),color:"primary",persistent:!0,fullscreen:!1,"hide-extension":!0},{default:a(()=>[t(ge,{class:"pa-0",fluid:!0},{default:a(()=>[t(W,null,{default:a(()=>[t(N,{cols:"12",sm:"6",md:"4"},{default:a(()=>[t(ne,{modelValue:o.value.Name,"onUpdate:modelValue":y[0]||(y[0]=m=>o.value.Name=m),label:"Internal name",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),t(N,{cols:"12",sm:"6",md:"4"},{default:a(()=>[t(Ea,{modelValue:o.value.Groups,"onUpdate:modelValue":y[1]||(y[1]=m=>o.value.Groups=m),convention:f.convention,label:"Groups",variant:"outlined","hide-details":""},null,8,["modelValue","convention"])]),_:1})]),_:1})]),_:1})]),actions:a(()=>[t(z,{color:"blue-darken-1",variant:"text",onClick:l},{default:a(()=>[C(" Cancel ")]),_:1}),t(z,{color:"blue-darken-1",variant:"text",onClick:r},{default:a(()=>[C(" Reset ")]),_:1}),t(He),t(z,{color:"blue-darken-1",variant:"text",onClick:c},{default:a(()=>[C(" Save ")]),_:1})]),_:1},8,["modelValue","title"]))}}),So=()=>{const e=_(""),v=()=>{const n={x:window.innerWidth,y:window.innerHeight};n.x<600?e.value="xs":n.x>=600&&n.x<960?e.value="sm":n.x>=960&&n.x<1280?e.value="md":n.x>=1280&&n.x<1920?e.value="lg":n.x>=1920&&n.x<2560?e.value="xl":n.x>=2560&&(e.value="xxl")};return window.addEventListener("resize",v),v(),e},Ro={style:{"list-style":"none"}},Co=Q({__name:"NoteCategories",props:{hideHistory:{type:Boolean},convention:{},showEditor:{type:Boolean}},emits:["close"],setup(e,{emit:v}){const n=_e(),u=_(!1),d=_(!1),i=_(""),o=_([]),l=_([{key:"Name",title:"Name"},{key:"Groups",title:"Groups"},{key:"actions",title:"",sortable:!1}]),r=So();_([{key:"CreatedAt",order:"asc"}]);const c=()=>({ID:0,NoteCategoryUUID:pe(),ConventionID:e.convention.ID,ConventionUUID:e.convention.ConventionUUID,Name:"",Groups:[],Notes:[]}),f=_(-1),y=_(c()),m=_(c()),g=()=>{m.value.NoteCategoryUUID=pe(),y.value=Object.assign({},c()),f.value=-1,u.value=!0},A=x=>{f.value=o.value.indexOf(x),y.value=Object.assign({},x),u.value=!0},w=x=>{f.value=o.value.indexOf(x),y.value=Object.assign({},x),d.value=!0},V=()=>{n.deleteNoteCategory(y.value.NoteCategoryUUID).then(x=>{x&&(o.value.splice(f.value,1),U())})},P=()=>{u.value=!1,Je(()=>{y.value=Object.assign({},m.value),f.value=-1})},U=()=>{d.value=!1,Je(()=>{y.value=Object.assign({},m.value),f.value=-1})},F=()=>{n.saveNoteCategory(y.value).then(x=>{x&&(f.value>-1?Object.assign(o.value[f.value],x):o.value.push(x),P())})};return(()=>{n.getNoteCategories(e.convention.ConventionUUID).then(x=>{x&&(o.value=x)})})(),(x,ie)=>(s(),E(p(Yt),{headers:l.value,items:o.value,"sort-by":[{key:"calories",order:"asc"}],class:"elevation-1"},{top:a(()=>[t(Nt,{color:"primary"},Ze({default:a(()=>[t(Va,null,{default:a(()=>[C("Note Categories")]),_:1}),t(zl,{class:"mx-4 d-none d-sm-inline-flex",inset:!0,vertical:!0}),t(He,{class:"d-none d-sm-inline-flex"}),p(r)!="xs"?(s(),E(z,{key:0,dark:"",class:"mb-2","prepend-icon":"mdi:mdi-pencil",onClick:g},{default:a(()=>[C(" New Item ")]),_:1})):L("",!0),t(z,{dark:"",class:"mb-2",icon:"mdi:mdi-window-close",onClick:ie[0]||(ie[0]=ee=>v("close"))}),t(Ca,{modelValue:d.value,"onUpdate:modelValue":ie[1]||(ie[1]=ee=>d.value=ee),onDelete:V},null,8,["modelValue"])]),_:2},[p(r)=="xs"?{name:"extension",fn:a(()=>[t(He),t(z,{dark:"",class:"mb-2","prepend-icon":"mdi:mdi-pencil",onClick:g},{default:a(()=>[C(" New Item ")]),_:1})]),key:"0"}:void 0]),1024),u.value?(s(),E(Io,{key:0,modelValue:u.value,"onUpdate:modelValue":ie[2]||(ie[2]=ee=>u.value=ee),"note-category":y.value,"onUpdate:noteCategory":[ie[3]||(ie[3]=ee=>y.value=ee),F],title:i.value,convention:x.convention},null,8,["modelValue","note-category","title","convention"])):L("",!0)]),"item.Groups":a(({item:ee})=>[B("ul",Ro,[(s(!0),T(k,null,X(ee.selectable.Groups,O=>(s(),T("li",{key:O.GroupUUID,class:"py-1"},S(O.Name),1))),128))])]),"item.actions":a(({item:ee})=>[t(be,{size:"small",class:"me-2",onClick:O=>A(ee.raw)},{default:a(()=>[C(" mdi:mdi-pencil ")]),_:2},1032,["onClick"]),t(be,{size:"small",onClick:O=>w(ee.raw)},{default:a(()=>[C(" mdi:mdi-delete ")]),_:2},1032,["onClick"])]),_:1},8,["headers","items"]))}}),Vo=Q({__name:"SelectNoteCategories",props:Z({convention:{},chips:{type:Boolean,default:!1},clearable:{type:Boolean,default:!1},hint:{default:""},label:{},variant:{}},{modelValue:{required:!0}}),emits:Z(["change"],["update:modelValue"]),setup(e,{emit:v}){const n=re(e,"modelValue"),u=_([]),d=_e(),i=_([]),o=_(""),l=_(0),r=ae(()=>[...i.value].map(y=>({title:y.Name,value:u.value.find(m=>m.NoteCategoryUUID===y.NoteCategoryUUID)||y})));return typeof e.convention=="object"?o.value=e.convention.ConventionUUID:o.value=e.convention||"",(async()=>{const f=[];o.value&&f.push(d.getNoteCategories(o.value));const y=await Promise.all(f);if(o.value&&y.length==1&&(i.value=y[0].sort((m,g)=>m.Name.localeCompare(g.Name))),Array.isArray(n.value))l.value=2,r.value.forEach(m=>{Array.isArray(n.value)&&n.value.find(A=>A.NoteCategoryUUID===m.value.NoteCategoryUUID)&&u.value.push(m.value)});else if(typeof n.value=="string"){l.value=1;try{const m=JSON.parse(n.value);r.value.forEach(g=>{m.find(w=>w.NoteCategoryUUID===g.value.NoteCategoryUUID)&&u.value.push(g.value)})}catch{}}})(),me(u,()=>{switch(l.value){default:case 2:{n.value=u.value,v("change");break}case 1:{n.value=JSON.stringify(u.value),v("change");break}}}),(f,y)=>(s(),E(va,{modelValue:u.value,"onUpdate:modelValue":y[0]||(y[0]=m=>u.value=m),chips:f.chips,multiple:"",label:f.label||"Tags",variant:f.variant||"solo",hint:f.hint,"persistent-hint":!0,clearable:f.clearable,items:r.value,"item-title":"title","item-value":"value"},null,8,["modelValue","chips","label","variant","hint","clearable","items"]))}}),Oo=Q({__name:"EditNoteDialog",props:Z({convention:{},note:{},title:{}},{modelValue:{type:Boolean,required:!0}}),emits:Z(["update:note","saved"],["update:modelValue"]),setup(e,{emit:v}){const n=e,{title:u=""}=n,d=_e(),i=re(e,"modelValue"),o=ut(n,v,void 0,void 0,"note"),l=_(Te(o.value));me(o,()=>{l.value=Te(o.value)});const r=()=>{l.value=Te(o.value)},c=f=>{l.value.NoteCategories===null&&(l.value.NoteCategories=[]),l.value.CreatedAt=void 0,l.value.DeletedAt=void 0,l.value.UpdatedAt=void 0,l.value.Admin=void 0,l.value.AdminID=void 0,l.value.AdminUUID=void 0,d.saveNote(l.value).then(y=>{y?(l.value=Te(y),f&&f("Note Saved"),o.value=l.value,v("saved",o.value)):f&&f("Internal Error Saving Note")}).catch(y=>{f&&f("Error Saving Note:"+y.ErrorMessage)})};return(f,y)=>l.value?(s(),E(et,{key:0,"card-class":"pa-4",modelValue:i.value,"onUpdate:modelValue":y[3]||(y[3]=m=>i.value=m),onReset:r,onSave:c,title:p(u),color:"primary",persistent:!0,fullscreen:!1,"hide-extension":!0,"show-close-action":!0,"show-reset-action":!0,"show-save-action":!0},{default:a(()=>[t(ge,{class:"pa-0",fluid:!0},{default:a(()=>[t(W,null,{default:a(()=>[t(N,{cols:"12"},{default:a(()=>[t(Vo,{modelValue:l.value.NoteCategories,"onUpdate:modelValue":y[0]||(y[0]=m=>l.value.NoteCategories=m),convention:f.convention,label:"Categories",variant:"outlined","hide-details":"",chips:!0},null,8,["modelValue","convention"])]),_:1})]),_:1}),t(W,null,{default:a(()=>[t(N,{cols:"12"},{default:a(()=>[t(ne,{modelValue:l.value.Subject,"onUpdate:modelValue":y[1]||(y[1]=m=>l.value.Subject=m),label:"Subject",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),t(N,{cols:"12"},{default:a(()=>[t(Ql,{modelValue:l.value.Description,"onUpdate:modelValue":y[2]||(y[2]=m=>l.value.Description=m),label:"Note",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue","title"])):L("",!0)}}),wa=Q({__name:"Notes",props:{allowAdding:{type:Boolean,default:!0},convention:{},expanded:{type:Boolean,default:!0},hideHistory:{type:Boolean},registration:{},showControlPanel:{type:Boolean,default:!0},showEditor:{type:Boolean},showTitle:{type:Boolean,default:!0},textClass:{default:""}},setup(e){const v=_e(),n=()=>({ID:0,NoteUUID:pe(),Description:"",NoteCategories:[],Registration:e.registration,RegistrationID:e.registration.ID,RegistrationUUID:e.registration.RegistrationUUID,Subject:""}),u=_(!1),d=_(!1),i=_([]),o=_([]),l=_(n()),r=()=>{l.value=n(),u.value=!0},c=m=>{l.value=m,u.value=!0},f=()=>{v.getRegistrationNotes(e.registration.RegistrationUUID).then(m=>{m&&(m.forEach(g=>{g.CreatedAt=Ua(new Date(g.CreatedAt||"")),g.Admin||(g.Admin={ID:0,UserUUID:"",DisplayName:"System",Handle:"",Credentials:[],Additional:{FirstName:"",LastName:"",DOB:"",Email:""},Data:"",Groups:[],Tags:[]})}),i.value=m,e.expanded&&(o.value=m.map(g=>g.NoteUUID)))})},y=()=>{f(),setTimeout(()=>{u.value=!1},2e3)};return f(),(m,g)=>(s(),T(k,null,[t(Le,null,{default:a(()=>[t(tt,null,{default:a(()=>[t(qe,null,{default:a(()=>[t(W,{class:"flex-row-reverse"},{default:a(()=>[m.showControlPanel?(s(),E(N,{key:0,class:"text-right flex-shrink-1 flex-grow-0",style:{"flex-grow":"0 !important"}},{default:a(()=>[t(z,{class:"d-sm-none",size:"xs",icon:"mdi:mdi-cog",variant:"text",color:"warning",onClick:g[0]||(g[0]=A=>d.value=!0)}),t(z,{class:"d-none d-sm-inline-flex","prepend-icon":"mdi:mdi-cog",variant:"text",color:"warning",onClick:g[1]||(g[1]=A=>d.value=!0)},{default:a(()=>[C("Categories")]),_:1})]),_:1})):L("",!0),m.showTitle?(s(),E(N,{key:1,class:"text-wrap flex-grow-1"},{default:a(()=>[C(" Notes (#"+S(m.registration.Reference)+" "+S(m.registration.User.DisplayName)+") ",1)]),_:1})):L("",!0)]),_:1})]),_:1})]),_:1}),t(je,{class:st(m.textClass)},{default:a(()=>[i.value.length===0?(s(),T(k,{key:0},[C(" No Notes Recorded ")],64)):(s(),E(_t,{key:1,multiple:!0,variant:"accordion",modelValue:o.value,"onUpdate:modelValue":g[2]||(g[2]=A=>o.value=A)},{default:a(()=>[(s(!0),T(k,null,X(i.value,A=>(s(),E(Tt,{key:`${A.NoteUUID}.${A.UpdatedAt}`,value:A.NoteUUID},{default:a(()=>[t(At,{class:"py-0"},{default:a(()=>[C(S(A.Subject)+" ",1),t(Oa,{class:"ml-4"},{default:a(()=>[(s(!0),T(k,null,X(A.NoteCategories,w=>(s(),E(ha,{key:w.NoteCategoryUUID},{default:a(()=>[C(S(w.Name),1)]),_:2},1024))),128))]),_:2},1024)]),_:2},1024),t(gt,null,{default:a(()=>[t(W,null,{default:a(()=>[t(N,null,{default:a(()=>[C(S(A.Description),1)]),_:2},1024)]),_:2},1024),t(W,null,{default:a(()=>[t(N,null,{default:a(()=>[C(S(p(Se)(A.UpdatedAt||""))+" ",1),A&&A.Admin&&A.Admin.DisplayName?(s(),T(k,{key:0},[C(" - "+S(A.Admin.DisplayName),1)],64)):L("",!0)]),_:2},1024),t(N,{class:"text-right"},{default:a(()=>[t(z,{color:"primary","prepend-icon":"mdi:mdi-pencil",onClick:w=>c(A)},{default:a(()=>[C("Edit")]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"]))]),_:1},8,["class"]),m.allowAdding?(s(),E(Bt,{key:0},{default:a(()=>[t(z,{color:"primary",variant:"flat",onClick:r},{default:a(()=>[C("Add Note")]),_:1})]),_:1})):L("",!0)]),_:1}),t(ft,{modelValue:u.value,"onUpdate:modelValue":g[5]||(g[5]=A=>u.value=A),title:"Create Note"},{default:a(()=>[t(Oo,{modelValue:u.value,"onUpdate:modelValue":g[3]||(g[3]=A=>u.value=A),note:l.value,"onUpdate:note":g[4]||(g[4]=A=>l.value=A),convention:m.convention,title:"Create Note",onSaved:y},null,8,["modelValue","note","convention"])]),_:1},8,["modelValue"]),t(ft,{modelValue:d.value,"onUpdate:modelValue":g[7]||(g[7]=A=>d.value=A),title:"Note Configuration"},{default:a(()=>[t(Co,{convention:m.convention,onClose:g[6]||(g[6]=A=>d.value=!1)},null,8,["convention"])]),_:1},8,["modelValue"])],64))}}),ho=Q({__name:"StripeRefundPayment",props:Z({paymentTransaction:{}},{modelValue:{type:Boolean,required:!0}}),emits:Z(["refunded"],["update:modelValue"]),setup(e,{emit:v}){const n=re(e,"modelValue"),u=_e(),d=_(!1),i=_("");let o=0;if(e.paymentTransaction.Data&&e.paymentTransaction.Data.PaymentIntent&&typeof e.paymentTransaction.Data.PaymentIntent=="object"){const m=e.paymentTransaction.Data.PaymentIntent;m&&(o=m.amount)}const l=_({Amount:o/100,Description:"",Reason:""}),r=_([{title:"Duplicate",value:"duplicate"},{title:"Fraudulent",value:"fraudulent"},{title:"Requested By Customer",value:"requested_by_customer"}]),c=_(!1);async function f(m){m.preventDefault(),c.value=!0,u.refundStripePayment(e.paymentTransaction.PaymentTransactionUUID,l.value).then(g=>{g?v("refunded",g):y("An unexpected error occurred.")}).catch(g=>{y("An error occurred processing the refund: "+g.toString())}),c.value=!1}const y=m=>{i.value=m,d.value=!0};return(m,g)=>(s(),E(et,{modelValue:n.value,"onUpdate:modelValue":g[7]||(g[7]=A=>n.value=A),title:"Refund a Stripe Payment",color:"blue-darken-4",persistent:""},{default:a(()=>[t(ge,{class:"pa-0"},{default:a(()=>[t(Kl,{ref:"refundForm",id:"refund-form",onSubmit:g[4]||(g[4]=ht(A=>f(A),["prevent"]))},{default:a(()=>[t(W,null,{default:a(()=>[t(N,{cols:"12",sm:"6",md:"4",lg:"3",xl:"2"},{default:a(()=>[t(ne,{modelValue:l.value.Amount,"onUpdate:modelValue":g[0]||(g[0]=A=>l.value.Amount=A),modelModifiers:{number:!0},label:"Amount",prefix:"£",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),t(N,{cols:"12",sm:"6",md:"8",lg:"9",xl:"10"},{default:a(()=>[t(fe,{modelValue:l.value.Reason,"onUpdate:modelValue":g[1]||(g[1]=A=>l.value.Reason=A),modelModifiers:{number:!0},items:r.value,"item-title":"title","item-value":"value",label:"Stripe Refund Reason",variant:"outlined","hide-details":""},null,8,["modelValue","items"])]),_:1}),t(N,{cols:"12"},{default:a(()=>[t(ne,{modelValue:l.value.Description,"onUpdate:modelValue":g[2]||(g[2]=A=>l.value.Description=A),modelModifiers:{number:!0},label:"Refund Description",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1})]),_:1}),t(W,null,{default:a(()=>[t(N,{class:"text-right",cols:"12",sm:"3",md:"2",lg:"2",xl:"1"},{default:a(()=>[t(z,{color:"error",class:"w-100",onClick:g[3]||(g[3]=A=>n.value=!1)},{default:a(()=>[C("Cancel")]),_:1})]),_:1}),t(He),t(N,{class:"text-left",cols:"12",sm:"3",md:"2",lg:"2",xl:"1"},{default:a(()=>[t(z,{type:"submit",color:"success",class:"w-100"},Ze({default:a(()=>[C(" Issue Refund ")]),_:2},[c.value?{name:"prepend",fn:a(()=>[t(hl,{size:"20",indeterminate:""})]),key:"0"}:void 0]),1024)]),_:1})]),_:1})]),_:1},512)]),_:1}),t(pa,{modelValue:d.value,"onUpdate:modelValue":g[6]||(g[6]=A=>d.value=A)},{actions:a(()=>[t(z,{variant:"text",onClick:g[5]||(g[5]=A=>d.value=!1)},{default:a(()=>[C(" Close ")]),_:1})]),default:a(()=>[C(S(i.value)+" ",1)]),_:1},8,["modelValue"])]),_:1},8,["modelValue"]))}}),bo=["colspan"],Mo=B("strong",null,"Details",-1),ko=["innerHTML"],$a=Q({__name:"PaymentTransactions",props:{canEdit:{type:Boolean},expanded:{type:Boolean},hideHistory:{type:Boolean},updated:{},registration:{},showEditor:{type:Boolean}},emits:["close-editor","change"],setup(e,{emit:v}){const n=e;let{expanded:u=!0,hideHistory:d=!1,registration:i,showEditor:o}=n;const l=_e(),r=_([]),c=_(u?["1"]:[]),f=_([]),y=_([{key:"CreatedAt",title:"Date"},{key:"Type",title:"Type"},{key:"Source",title:"Source"},{key:"Description",title:"Description"},{key:"Admin",title:"Admin"},{key:"Amount",title:"Amount"},{key:"Controls",title:""}]),m=_(!1),g=_(),A=_(!1),w=_(""),V=_([{key:"CreatedAt",order:"asc"}]),P=()=>({PaymentTransactionUUID:pe(),Amount:0,Data:{},Description:"",ID:0,RegistrationID:i.ID,RegistrationUUID:i.RegistrationUUID,Source:Jt.PAYMENT_TRANSACTION_SOURCE_NULL,Type:bt.PAYMENT_TRANSACTION_TYPE_NULL}),U=_(P()),{convertTransactions:F,getPaymentTransactionsDisplay:Y}=Aa();me(n,()=>{d=n.hideHistory,i=n.registration,o=n.showEditor,Y(i.RegistrationUUID).then(b=>{f.value=b})});const x=()=>{Y(i.RegistrationUUID).then(b=>{f.value=b})};x();const ie=()=>{l.saveRegistrationPaymentTransaction(U.value).then(b=>{b&&(F(b.PaymentTransactions),U.value=P(),v("close-editor"),v("change"))})},ee=b=>{const h=f.value.find(R=>R.PaymentTransactionUUID===b);h&&(g.value=h.PaymentTransaction,m.value=!0)},O=b=>{if(b)try{f.value=F(b.PaymentTransactions),g.value=void 0,m.value=!1,w.value="Refund Processed",A.value=!0,v("change")}catch(h){console.error(h)}};return(b,h)=>(s(),T(k,null,[p(o)?(s(),T(k,{key:0},[t(qe,null,{default:a(()=>[C(" Add Transaction ")]),_:1}),t(W,null,{default:a(()=>[t(N,{cols:"12",sm:"6"},{default:a(()=>[t(fe,{items:p(yl),"item-title":"title","item-value":"value",label:"Transaction Type",clearable:!0,"hide-details":"",modelValue:U.value.Type,"onUpdate:modelValue":h[0]||(h[0]=R=>U.value.Type=R),variant:"outlined"},null,8,["items","modelValue"])]),_:1}),t(N,{cols:"12",sm:"6"},{default:a(()=>[t(fe,{items:p(pl),"item-title":"title","item-value":"value",label:"Source",clearable:!0,"hide-details":"",modelValue:U.value.Source,"onUpdate:modelValue":h[1]||(h[1]=R=>U.value.Source=R),variant:"outlined"},null,8,["items","modelValue"])]),_:1})]),_:1}),t(W,null,{default:a(()=>[t(N,{cols:"12",sm:"8",md:"10"},{default:a(()=>[t(ne,{label:"Description","hide-details":"",modelValue:U.value.Description,"onUpdate:modelValue":h[2]||(h[2]=R=>U.value.Description=R),variant:"outlined"},null,8,["modelValue"])]),_:1}),t(N,{cols:"12",sm:"4",md:"2"},{default:a(()=>[t(ne,{label:"Amount","prepend-inner-icon":"mdi:mdi-currency-gbp","hide-details":"",modelValue:U.value.Amount,"onUpdate:modelValue":h[3]||(h[3]=R=>U.value.Amount=R),modelModifiers:{number:!0},variant:"outlined"},null,8,["modelValue"])]),_:1})]),_:1}),t(W,null,{default:a(()=>[t(N,{cols:"12",sm:"3",md:"2",lg:"1"},{default:a(()=>[t(z,{class:"w-100",onClick:h[4]||(h[4]=R=>v("close-editor")),color:"warning"},{default:a(()=>[C("Cancel")]),_:1})]),_:1}),t(He),t(N,{cols:"12",sm:"6",md:"3",lg:"2",xl:"2"},{default:a(()=>[t(z,{class:"w-100",onClick:ie,color:"primary"},{default:a(()=>[C("Submit Transaction")]),_:1})]),_:1})]),_:1})],64)):L("",!0),f.value.length&&!p(d)?(s(),E(_t,{key:1,class:"my-2",modelValue:c.value,"onUpdate:modelValue":h[10]||(h[10]=R=>c.value=R)},{default:a(()=>[t(Tt,{value:"1"},{default:a(()=>[t(At,null,{default:a(()=>[C(" Transaction History ")]),_:1}),t(gt,null,{default:a(()=>[t(p(Yt),{items:f.value,headers:y.value,"show-expand":!1,"item-value":"PaymentTransactionUUID",expanded:r.value,"onUpdate:expanded":h[5]||(h[5]=R=>r.value=R),"sort-by":V.value,"onUpdate:sortBy":h[6]||(h[6]=R=>V.value=R),class:"transactionTable"},{"item.Controls":a(({item:R})=>[b.canEdit&&R.raw.PaymentTransaction.Source===p(Jt).PAYMENT_TRANSACTION_SOURCE_STRIPE&&R.raw.PaymentTransaction.Type===p(bt).PAYMENT_TRANSACTION_TYPE_PAYMENT?(s(),E(z,{key:0,icon:"mdi:mdi-credit-card-refund",variant:"text",size:"xs",onClick:G=>ee(R.key)},null,8,["onClick"])):L("",!0)]),"expanded-row":a(({columns:R,item:G})=>[B("tr",null,[B("td",{colspan:R.length},[Mo,B("div",{innerHTML:G.raw.HTML},null,8,ko)],8,bo)])]),"footer.prepend":a(()=>[t(z,{"prepend-icon":"mdi:mdi-refresh",color:"primary",class:"mr-4",onClick:x},{default:a(()=>[C("Refresh")]),_:1})]),_:1},8,["items","headers","expanded","sort-by"]),m.value&&g.value?(s(),E(ho,{key:0,modelValue:m.value,"onUpdate:modelValue":h[7]||(h[7]=R=>m.value=R),"payment-transaction":g.value,onRefunded:O},null,8,["modelValue","payment-transaction"])):L("",!0),t(pa,{modelValue:A.value,"onUpdate:modelValue":h[9]||(h[9]=R=>A.value=R)},{actions:a(()=>[t(z,{variant:"text",onClick:h[8]||(h[8]=R=>A.value=!1)},{default:a(()=>[C(" Close ")]),_:1})]),default:a(()=>[C(S(w.value)+" ",1)]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])):L("",!0)],64))}});const No=Q({__name:"DataPanelRegistrationTags",props:Z({registration:{}},{modelValue:{required:!0}}),emits:["update:modelValue"],setup(e){const v=re(e,"modelValue"),n=ae(()=>!v.value.Meta.Tags||!Array.isArray(v.value.Meta.Tags)||v.value.Meta.Tags.length===0?e.registration.Tags:e.registration.Tags.filter(u=>v.value.Meta.Tags.includes(u.TagUUID)));return(u,d)=>(s(),E(Oa,null,{default:a(()=>[(s(!0),T(k,null,X(n.value,i=>(s(),E(ha,{key:i.TagUUID},{default:a(()=>[C(S(i.Title),1)]),_:2},1024))),128))]),_:1}))}});const Lo=it(No,[["__scopeId","data-v-8cc2c172"]]),Po=Q({__name:"MetaDataItem",props:Z({accommodations:{},convention:{},forms:{},interests:{},itemClass:{},registration:{},tickets:{},venues:{}},{modelValue:{required:!0}}),emits:Z(["openActions","showForm"],["update:modelValue"]),setup(e,{emit:v}){const n=re(e,"modelValue"),u=i=>{v("openActions",i)},d=(i,o,l)=>{v("showForm",i,o,l)};return(i,o)=>n.value.MetaField===p(H).META_DATA_SOURCE_ACCOMMODATION_ALLOCATION?(s(),E(La,{key:0,convention:i.convention,tickets:i.tickets,accommodations:i.accommodations,venues:i.venues,registration:i.registration,forms:i.forms,modelValue:n.value,"onUpdate:modelValue":o[0]||(o[0]=l=>n.value=l),data:""},null,8,["convention","tickets","accommodations","venues","registration","forms","modelValue"])):n.value.MetaField===p(H).META_DATA_SOURCE_BADGE_DISPLAY?(s(),E(xt,{key:1,registration:i.registration,"show-title":!1,"card-class":i.itemClass},null,8,["registration","card-class"])):n.value.MetaField===p(H).META_DATA_SOURCE_EMAILS?(s(),E(Fa,{key:2,"allow-sending":!1,expanded:!1,"show-title":!1,registration:i.registration,"text-class":"pa-0 ma-0"},null,8,["registration"])):n.value.MetaField===p(H).META_DATA_SOURCE_NOTES?(s(),E(wa,{key:3,"allow-adding":!0,convention:i.convention,expanded:!1,registration:i.registration,"show-control-panel":!1,"show-title":!1,"text-class":"pa-0 ma-0"},null,8,["convention","registration"])):n.value.MetaField===p(H).META_DATA_SOURCE_PAYMENT_STATUS?(s(),E(lo,{key:4,registration:i.registration},null,8,["registration"])):n.value.MetaField===p(H).META_DATA_SOURCE_PAYMENTS?(s(),E($a,{key:5,registration:i.registration,expanded:!1},null,8,["registration"])):n.value.MetaField===p(H).META_DATA_SOURCE_REGISTRATION_ACTIONS?(s(),E(z,{key:6,icon:"mdi:mdi-briefcase",variant:"flat",onClick:o[1]||(o[1]=l=>u(i.registration))})):n.value.MetaField===p(H).META_DATA_SOURCE_SUBMISSION_STATUS||n.value.MetaField===p(H).META_DATA_SOURCE_ACCOMMODATION_FORM||n.value.MetaField===p(H).META_DATA_SOURCE_ADMIN_FORM||n.value.MetaField===p(H).META_DATA_SOURCE_DEALER_FORM||n.value.MetaField===p(H).META_DATA_SOURCE_BADGE_FORM||n.value.MetaField===p(H).META_DATA_SOURCE_REGISTRATION_FORM?(s(),E(Kn,{key:7,convention:i.convention,forms:i.forms,registration:i.registration,onShowForm:d},null,8,["convention","forms","registration"])):n.value.MetaField===p(H).META_DATA_SOURCE_REGISTRATION_GROUP?(s(),E(jn,{key:8,registration:i.registration},null,8,["registration"])):n.value.MetaField===p(H).META_DATA_SOURCE_REGISTRATION_REFERENCE?(s(),T(k,{key:9},[C(S(i.registration.Reference),1)],64)):n.value.MetaField===p(H).META_DATA_SOURCE_SUBMISSION_DATE?(s(),E(zn,{key:10,registration:i.registration},null,8,["registration"])):n.value.MetaField===p(H).META_DATA_SOURCE_TAGS?(s(),E(Lo,{key:11,registration:i.registration,modelValue:n.value,"onUpdate:modelValue":o[2]||(o[2]=l=>n.value=l)},null,8,["registration","modelValue"])):(s(),T(k,{key:12},[C(" Unhandled Meta Item "+S(n.value),1)],64))}}),Fo=Q({__name:"UserDataItem",props:Z({accommodations:{},convention:{},forms:{},interests:{},itemClass:{},tickets:{},venues:{},registration:{}},{modelValue:{required:!0}}),emits:["update:modelValue"],setup(e){const v=re(e,"modelValue"),n=Ut(),u=ae(()=>n.GetProfileImageURL(e.registration.UserUUID));return(d,i)=>v.value.UserField===p(le).USER_DATA_SOURCE_TELEGRAM&&d.registration.User.Handle?(s(),T(k,{key:0},[C(" @"+S(d.registration.User.Handle),1)],64)):v.value.UserField===p(le).USER_DATA_SOURCE_AVATAR?(s(),E(Gt,{key:1,class:"rounded-circle",src:u.value,height:"32",width:"32"},null,8,["src"])):v.value.UserField===p(le).USER_DATA_SOURCE_DATE_OF_BIRTH?(s(),T(k,{key:2},[C(S(p(Se)(d.registration.User.Additional.DOB,{withYear:!0,withDay:!1})),1)],64)):v.value.UserField===p(le).USER_DATA_SOURCE_EMAIL?(s(),T(k,{key:3},[C(S(d.registration.User.Additional.Email),1)],64)):v.value.UserField===p(le).USER_DATA_SOURCE_FIRST_NAME?(s(),T(k,{key:4},[C(S(d.registration.User.Additional.FirstName),1)],64)):v.value.UserField===p(le).USER_DATA_SOURCE_LAST_NAME?(s(),T(k,{key:5},[C(S(d.registration.User.Additional.LastName),1)],64)):(s(),T(k,{key:6},[C(" Unhandled User Field "+S(v.value),1)],64))}}),sa=Q({__name:"PanelItem",props:Z({accommodations:{},convention:{},extras:{},forms:{},interests:{},itemClass:{},tickets:{},venues:{},registration:{}},{modelValue:{required:!0}}),emits:Z(["openActions","showForm"],["update:modelValue"]),setup(e,{emit:v}){const n=re(e,"modelValue"),u=i=>{v("openActions",i)},d=(i,o,l)=>{v("showForm",i,o,l)};return(i,o)=>n.value.SourceType===p(Me).LAYOUT_ITEM_SOURCE_FORM?(s(),E(Yn,{key:0,accommodations:i.accommodations,convention:i.convention,extras:i.extras,forms:i.forms,interests:i.interests,"item-class":i.itemClass,registration:i.registration,tickets:i.tickets,venues:i.venues,modelValue:n.value,"onUpdate:modelValue":o[0]||(o[0]=l=>n.value=l)},null,8,["accommodations","convention","extras","forms","interests","item-class","registration","tickets","venues","modelValue"])):n.value.SourceType===p(Me).LAYOUT_ITEM_SOURCE_META?(s(),E(Po,{key:1,accommodations:i.accommodations,convention:i.convention,forms:i.forms,interests:i.interests,"item-class":i.itemClass,registration:i.registration,tickets:i.tickets,venues:i.venues,modelValue:n.value,"onUpdate:modelValue":o[1]||(o[1]=l=>n.value=l),onOpenActions:u,onShowForm:d},null,8,["accommodations","convention","forms","interests","item-class","registration","tickets","venues","modelValue"])):n.value.SourceType===p(Me).LAYOUT_ITEM_SOURCE_USER?(s(),E(Fo,{key:2,accommodations:i.accommodations,convention:i.convention,forms:i.forms,interests:i.interests,"item-class":i.itemClass,registration:i.registration,tickets:i.tickets,venues:i.venues,modelValue:n.value,"onUpdate:modelValue":o[2]||(o[2]=l=>n.value=l)},null,8,["accommodations","convention","forms","interests","item-class","registration","tickets","venues","modelValue"])):L("",!0)}}),wo={class:"bg-secondary pa-3"},$o=Q({__name:"PanelLayout",props:{accommodations:{},convention:{},extras:{},forms:{},interests:{},tickets:{},venues:{},layout:{},registration:{}},emits:["openActions","showForm"],setup(e,{emit:v}){const n=i=>{v("openActions",i)},u=(i,o,l)=>{v("showForm",i,o,l)},d=i=>{switch(i){case ke.PANEL_STYLE_NAV_BOTTOM:return"bottom";case ke.PANEL_STYLE_NAV_LEFT:return"left";case ke.PANEL_STYLE_NAV_RIGHT:return"right";case ke.PANEL_STYLE_NAV_TOP:return"top"}};return(i,o)=>(s(),T(k,null,[(s(!0),T(k,null,X(i.layout.Panels,l=>(s(),T(k,{key:l.LayoutPanelUUID},[d(l.PanelStyle)!==void 0?(s(),E(Xl,{key:0,permanent:!0,location:d(l.PanelStyle),temporary:!1},{default:a(()=>[B("h3",wo,S(l.Name),1),t(xe,{class:"bg-panel"},{default:a(()=>[(s(!0),T(k,null,X(l.Items,(r,c)=>(s(),E(Ne,{key:r.LayoutItemUUID},{default:a(()=>[l.Items.length>1?(s(),E(Mt,{key:0,class:"font-weight-bold"},{default:a(()=>[C(S(r.Label),1)]),_:2},1024)):L("",!0),t(sa,{accommodations:i.accommodations,convention:i.convention,extras:i.extras,forms:i.forms,interests:i.interests,"item-class":"bg-panel border-0",tickets:i.tickets,venues:i.venues,modelValue:l.Items[c],"onUpdate:modelValue":f=>l.Items[c]=f,registration:i.registration,onOpenActions:n,onShowForm:u},null,8,["accommodations","convention","extras","forms","interests","tickets","venues","modelValue","onUpdate:modelValue","registration"])]),_:2},1024))),128))]),_:2},1024)]),_:2},1032,["location"])):L("",!0)],64))),128)),t(Wl,{class:"py-0"},{default:a(()=>[t(W,{class:"ma-md-1"},{default:a(()=>[(s(!0),T(k,null,X(i.layout.Panels,l=>{var r,c,f,y,m,g;return s(),T(k,{key:l.LayoutPanelUUID},[l.PanelStyle===p(ke).PANEL_STYLE_FLEX?(s(),E(N,{key:0,cols:((r=l.Meta.cols)==null?void 0:r.toString())||!1,xs:((c=l.Meta.cols_xs)==null?void 0:c.toString())||!1,sm:((f=l.Meta.cols_sm)==null?void 0:f.toString())||!1,md:((y=l.Meta.cols_md)==null?void 0:y.toString())||!1,lg:((m=l.Meta.cols_lg)==null?void 0:m.toString())||!1,xl:((g=l.Meta.cols_xl)==null?void 0:g.toString())||!1},{default:a(()=>[t(ge,{class:"border bg-panel",style:{"border-radius":"15px"}},{default:a(()=>[B("h3",null,S(l.Name),1),t(xe,{class:"bg-panel"},{default:a(()=>[(s(!0),T(k,null,X(l.Items,(A,w)=>(s(),E(Ne,{key:A.LayoutItemUUID,class:"px-0"},{default:a(()=>[l.Items.length>1?(s(),E(Mt,{key:0,class:"font-weight-bold"},{default:a(()=>[C(S(A.Label),1)]),_:2},1024)):L("",!0),t(sa,{accommodations:i.accommodations,convention:i.convention,extras:i.extras,forms:i.forms,interests:i.interests,"item-class":"bg-panel border-0",tickets:i.tickets,venues:i.venues,modelValue:l.Items[w],"onUpdate:modelValue":V=>l.Items[w]=V,registration:i.registration,onOpenActions:n,onShowForm:u},null,8,["accommodations","convention","extras","forms","interests","tickets","venues","modelValue","onUpdate:modelValue","registration"])]),_:2},1024))),128))]),_:2},1024)]),_:2},1024)]),_:2},1032,["cols","xs","sm","md","lg","xl"])):L("",!0)],64)}),128))]),_:1})]),_:1})],64))}}),Bo=Q({__name:"DataTableItemPanel",props:{accommodations:{},cardClass:{},convention:{},extras:{},forms:{},interests:{},tickets:{},venues:{},layouts:{},registration:{}},emits:["openActions","showForm"],setup(e,{emit:v}){const n=_(),u=_(!1),d=l=>{n.value=l,u.value=!0},i=l=>{v("openActions",l)},o=(l,r,c)=>{v("showForm",l,r,c)};return(l,r)=>(s(),T("div",null,[l.layouts?(s(),E(xe,{key:0},{default:a(()=>[(s(!0),T(k,null,X(l.layouts,c=>(s(),E(Ne,{key:c.AdminLayoutUUID,class:"d-block pa-0 ma-0"},{default:a(()=>[t(Mt,{style:{"text-overflow":"inherit"},class:"overflow-visible text-wrap"},{default:a(()=>[t(z,{"prepend-icon":"mdi:mdi-page-layout-body",variant:"flat",onClick:f=>d(c)},{default:a(()=>[C(S(c.Name),1)]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024))),128))]),_:1})):L("",!0),u.value&&n.value?(s(),E(et,{key:1,modelValue:u.value,"onUpdate:modelValue":r[0]||(r[0]=c=>u.value=c),"hide-extension":!0,fullscreen:!0,title:`#${l.registration.Reference} ${l.registration.User.DisplayName} - ${n.value.Name} `,"card-class":"pa-0"},{default:a(()=>[t($o,{accommodations:l.accommodations,convention:l.convention,extras:l.extras,forms:l.forms,interests:l.interests,tickets:l.tickets,venues:l.venues,layout:n.value,registration:l.registration,onOpenActions:i,onShowForm:o},null,8,["accommodations","convention","extras","forms","interests","tickets","venues","layout","registration"])]),_:1},8,["modelValue","title"])):L("",!0)]))}}),Go={class:"text-grey-lighten-1"},Yo={key:0,class:"text-blue text-center"},xo={key:1,class:"text-red text-center"},Ho={key:2,class:"text-orange text-center"},qo={key:3,class:"text-orange text-center"},jo={key:4,class:"text-orange text-center"},zo={key:5,class:"text-orange text-center"},Qo={key:6,class:"text-green text-center"},Ko={key:0},Xo={key:0},Wo=B("strong",null,"Total:",-1),Jo=Q({__name:"RegListRow",props:{header:{},accommodations:{},convention:{},extras:{},forms:{},item:{},interests:{},tickets:{},user:{},venues:{}},emits:["openActions","openPayments","openTags","reload","showForm","switchUser"],setup(e,{emit:v}){const n=(o,l,r)=>{v("showForm",{registration:o,form:l,submission:r})},u=o=>{v("openActions",o)},d=o=>{v("switchUser",o)},i=o=>{const l=e.item.raw.registration;return{ID:0,SubmissionUUID:pe(),FormID:o.ID,FormUUID:o.FormUUID,Form:o,UserID:l.UserID,UserUUID:l.UserUUID,RegistrationID:l.ID,RegistrationUUID:l.RegistrationUUID,Registration:l,Data:[],Status:ya.SUBMISSION_STATUS_NULL}};return(o,l)=>o.header.type==="ACCOMMODATION"&&o.accommodations.length>0&&o.item.raw[o.header.key]?(s(),E(ba,{key:0,value:o.item.raw[o.header.key].Data,accommodations:o.accommodations,convention:o.convention,forms:o.forms,tickets:o.tickets,venues:o.venues,registration:o.item.raw[o.header.key].Registration},null,8,["value","accommodations","convention","forms","tickets","venues","registration"])):o.header.type==="EXTRAS"&&o.extras.length>0?(s(),E(Ma,{key:1,value:o.item.raw[o.header.key],extras:o.extras},null,8,["value","extras"])):o.header.type==="INTERESTS"&&o.interests.length>0?(s(),E(ka,{key:2,value:o.item.raw[o.header.key],interests:o.interests},null,8,["value","interests"])):o.header.type==="TICKET"&&o.tickets.length>0?(s(),E(Na,{key:3,value:o.item.raw[o.header.key],tickets:o.tickets},null,8,["value","tickets"])):o.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_SUBMISSION_STATUS"||o.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_ACCOMMODATION_FORM"||o.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_ADMIN_FORM"||o.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_DEALER_FORM"||o.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_BADGE_FORM"||o.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_REGISTRATION_FORM"?(s(),T(k,{key:4},[B("ul",null,[(s(!0),T(k,null,X(o.forms.filter(r=>r.Type===p(Ae).FORM_TYPE_ADMIN&&o.item.raw[o.header.key].findIndex(c=>c.Form.ID===r.ID)<0),r=>(s(),T("li",{key:r.Heading},[B("strong",Go,S(r.Heading),1),t(z,{class:"text-grey-lighten-1",icon:"mdi:mdi-form-select",title:"Edit Submitted Data",variant:"flat",onClick:c=>n(o.item.raw.registration,r,i(r))},null,8,["onClick"])]))),128))]),B("ul",null,[(s(!0),T(k,null,X(o.item.raw[o.header.key],r=>(s(),T("li",{key:r.Heading},[B("strong",null,[C(S(r.Heading),1),r.Form.Type!==p(Ae).FORM_TYPE_ADMIN?(s(),T(k,{key:0},[C(": ")],64)):L("",!0)]),r.Form.Type!==p(Ae).FORM_TYPE_ADMIN?(s(),T("span",{key:0,class:st(p(_a)(r.Submission.Status))},S(p(Ft)(r.Submission.Status)),3)):L("",!0),t(z,{icon:"mdi:mdi-form-select",title:"Edit Submitted Data",variant:"flat",onClick:c=>n(r.Registration,r.Form,r.Submission)},null,8,["onClick"])]))),128))])],64)):o.header.type==="LAYOUT_ITEM_SOURCE_USER.USER_DATA_SOURCE_AVATAR"?(s(),E(Gt,{key:5,class:"rounded-circle",src:o.item.raw[o.header.key],height:"32",width:"32"},null,8,["src"])):o.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_PAYMENT_STATUS"?(s(),T(k,{key:6},[o.item.raw[o.header.key]=="NOT_REQUIRED"?(s(),T("div",Yo,"No Payment Requested")):o.item.raw[o.header.key]=="MISSING_REQUIRED"?(s(),T("div",xo,"Partner Payment Not Requested")):o.item.raw[o.header.key]=="AWAITING_PARTNER"?(s(),T("div",Ho,"Awaiting Partner Payment")):o.item.raw[o.header.key]=="ALL_REQUIRED"?(s(),T("div",qo,"Awaiting Payments")):o.item.raw[o.header.key]=="REQUIRED"?(s(),T("div",jo,"Awaiting Payment")):o.item.raw[o.header.key]=="ADDITIONAL_REQUIRED"?(s(),T("div",zo,"Awaiting Additional Payments")):(s(),T("div",Qo,"Completed"))],64)):o.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_REGISTRATION_ACTIONS"?(s(),T(k,{key:7},[t(z,{icon:"mdi:mdi-briefcase",variant:"flat",onClick:l[0]||(l[0]=r=>u(o.item.raw[o.header.key]))}),p(mn)(o.user)?(s(),E(z,{key:0,icon:"mdi:mdi-account-switch-outline",variant:"flat",onClick:l[1]||(l[1]=r=>d(o.item.raw[o.header.key]))})):L("",!0)],64)):o.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_REGISTRATION_GROUP"?(s(),T(k,{key:8},[o.item.raw[o.header.key].length===1?(s(),T("em",Ko," Not in a group ")):(s(),T(k,{key:1},[B("ul",null,[(s(!0),T(k,null,X(o.item.raw[o.header.key],r=>(s(),T("li",{key:r.UUID,class:"ml-0"},[C(" #"+S(r.Reference)+" : "+S(r.Name)+" ",1),r.IsLeader?(s(),T("strong",Xo,"(Leader)")):L("",!0)]))),128))]),Wo,C(" "+S(o.item.raw[o.header.key].length),1)],64))],64)):o.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_DATA_LAYOUT"?(s(),E(Bo,{key:9,accommodations:o.accommodations,convention:o.convention,extras:o.extras,forms:o.forms,interests:o.interests,tickets:o.tickets,venues:o.venues,layouts:o.item.raw[o.header.key].Layouts,registration:o.item.raw[o.header.key].Registration,onOpenActions:u,onShowForm:n},null,8,["accommodations","convention","extras","forms","interests","tickets","venues","layouts","registration"])):(s(),T(k,{key:10},[C(S(o.item.raw[o.header.key]),1)],64))}}),ua=Q({__name:"RegistrationActionTabs",props:Z({alignTabs:{},class:{},fixedTabs:{type:Boolean},showArrows:{type:[String,Boolean]},tabs:{}},{modelValue:{required:!0}}),emits:["update:modelValue"],setup(e){const v=e,n=re(e,"modelValue");return(u,d)=>(s(),E(Da,he({modelValue:n.value,"onUpdate:modelValue":d[0]||(d[0]=i=>n.value=i)},v),{default:a(()=>[(s(!0),T(k,null,X(u.tabs,i=>(s(),E(Ia,{value:i.value,key:i.value},{default:a(()=>[C(S(i.label),1)]),_:2},1032,["value"]))),128))]),_:1},16,["modelValue"]))}}),Zo=(e=void 0,v)=>e===void 0?!1:$t(e,wt.GROUP_TYPE_CONVENTION,v.ConventionUUID,v).EditPaymentTransactions,yt=e=>(Lt("data-v-861debd5"),e=e(),Pt(),e),ei={class:"mb-4"},ti={class:"v-row"},ai={key:0,class:"v-col v-col-10 py-1 v-row mx-0 pl-0"},li={class:"v-col v-col-12 v-col-sm-4 v-col-md-3 font-weight-bold pb-0 pr-0"},ni={class:"v-col v-col-12 v-col-sm-8 v-col-md-9 font-italic pt-0 pt-sm-3 pb-sm-0 pl-sm-0"},oi={class:"v-col v-col-2 align-self-end text-right py-1 text-no-wrap"},ii=yt(()=>B("dt",{class:"v-col v-col-9 py-1 font-weight-bold totals"}," Total Charges ",-1)),si={class:"v-col v-col-3 align-self-end text-right py-1 totals text-no-wrap"},ui=yt(()=>B("dt",{class:"v-col v-col-9 py-1 font-weight-bold"}," Applied Total ",-1)),ri={class:"v-col v-col-3 align-self-end text-right py-1 text-no-wrap"},di=yt(()=>B("dt",{class:"v-col v-col-9 py-1 font-weight-bold"}," Currently Paid ",-1)),mi={class:"v-col v-col-3 align-self-end text-right py-1 text-no-wrap"},ci=yt(()=>B("dt",{class:"v-col v-col-9 py-1 font-weight-bold totals"}," Balance ",-1)),vi={class:"v-col v-col-3 align-self-end text-right py-1 totals text-no-wrap"},fi=Q({__name:"PaymentActions",props:Z({forms:{},title:{}},{modelValue:{required:!0}}),emits:["update:modelValue"],setup(e){const v=_(!1),n=_(),u=_([]),d=_(new Date().getTime()),i=_(!1),o=re(e,"modelValue"),l=_(Te(o.value));me(o,()=>{l.value=Te(o.value)});const r=_e();r.getConvention(o.value.ConventionUUID).then(m=>{m&&(i.value=Zo(rt(),m))});const c=()=>{r.generateRegistrationCharges(o.value.RegistrationUUID,!1).then(m=>{m&&(u.value=m.PaymentTransactions,n.value=m.Registration,d.value=new Date().getTime())}).catch(()=>{})};c();const f=()=>{r.generateRegistrationCharges(o.value.RegistrationUUID,!0).then(m=>{m&&(u.value=m.PaymentTransactions,n.value=m.Registration,d.value=new Date().getTime())})},{totalCharges:y}=Aa();return(m,g)=>(s(),E(Le,null,{default:a(()=>[t(tt,null,{default:a(()=>[t(qe,null,{default:a(()=>[C(" Payments (#"+S(o.value.Reference)+" "+S(o.value.User.DisplayName)+") ",1)]),_:1})]),_:1}),t(je,null,{default:a(()=>[n.value?(s(),T(k,{key:0},[B("h3",ei,"#"+S(n.value.Reference)+" "+S(n.value.User.DisplayName),1),B("dl",ti,[(s(!0),T(k,null,X(u.value,A=>(s(),T(k,{key:A.PaymentTransactionUUID},[A.Type===p(bt).PAYMENT_TRANSACTION_TYPE_CHARGE?(s(),T("dt",ai,[B("div",li,S(A.Description.split(":")[0])+": ",1),B("div",ni,S(A.Description.split(":")[1]),1)])):L("",!0),B("dd",oi," £"+S(A.Amount),1)],64))),128)),ii,B("dd",si," £"+S(p(y)(u.value)),1),ui,B("dd",ri," £"+S(n.value.Total),1),di,B("dd",mi," £"+S(n.value.Paid),1),ci,B("dd",vi," £"+S(n.value.Total-n.value.Paid),1)]),t(W,{class:"flex-row-reverse"},{default:a(()=>[t(N,{class:"text-right"},{default:a(()=>[t(z,{color:"primary",onClick:f},{default:a(()=>[C("Apply Charges")]),_:1})]),_:1}),!v.value&&i.value?(s(),E(N,{key:0},{default:a(()=>[t(z,{color:"secondary",onClick:g[0]||(g[0]=A=>v.value=!0)},{default:a(()=>[C("Transaction Entry")]),_:1})]),_:1})):L("",!0)]),_:1})],64)):L("",!0),t($a,{"can-edit":i.value,registration:o.value,"show-editor":v.value,onCloseEditor:g[1]||(g[1]=A=>v.value=!1),updated:d.value,onChange:c},null,8,["can-edit","registration","show-editor","updated"])]),_:1})]),_:1}))}});const Ui=it(fi,[["__scopeId","data-v-861debd5"]]),Ai=Q({__name:"RegistrationFormStatus",props:Z({forms:{}},{modelValue:{required:!0}}),emits:["update:modelValue"],setup(e){const v=_e(),n=re(e,"modelValue"),u=(d,i)=>{const o=n.value.Submissions.find(l=>l.SubmissionUUID==i);if(!o){d&&d("Submission not found");return}v.setSubmissionStatus(i,o.Status).then(l=>{l?(n.value.Submissions.forEach((r,c)=>{n.value.Submissions[c].Status=r.Status}),d&&d("Status Saved")):d&&d("Status not saved")}).catch(()=>{d&&d("Status not saved")})};return(d,i)=>(s(),E(Le,null,{default:a(()=>[t(tt,null,{default:a(()=>[t(qe,null,{default:a(()=>[C("Status (#"+S(n.value.Reference)+" "+S(n.value.User.DisplayName)+")",1)]),_:1})]),_:1}),t(je,null,{default:a(()=>[t(xe,null,{default:a(()=>[(s(!0),T(k,null,X(n.value.Submissions,o=>(s(),E(Ne,{key:o.SubmissionUUID,class:"pa-0"},{default:a(()=>[t(W,{class:"py-2 align-center"},{default:a(()=>[t(N,{cols:"9",sm:"10",md:"10",lg:"9"},{default:a(()=>{var l;return[t(fe,{modelValue:o.Status,"onUpdate:modelValue":r=>o.Status=r,items:p(Zt),"item-text":"title","item-value":"value",variant:"outlined","hide-details":"",label:((l=d.forms.find(r=>r.FormUUID==o.FormUUID))==null?void 0:l.Name)||""},{selection:a(()=>[t(be,{class:"mr-4 d-none d-sm-inline"},{default:a(()=>{var r;return[C(S((r=p(Zt).find(c=>c.value===o.Status))==null?void 0:r.icon),1)]}),_:2},1024),C(" "+S(p(Ft)(o.Status)),1)]),item:a(({item:r,props:{onClick:c}})=>[t(Ne,{title:r.title,"prepend-icon":r.raw.icon,onClick:c},null,8,["title","prepend-icon","onClick"])]),_:2},1032,["modelValue","onUpdate:modelValue","items","label"])]}),_:2},1024),t(N,{cols:"3",sm:"2",md:"2",lg:"1"},{default:a(()=>[t(ot,{class:"d-none d-sm-inline-flex",title:"Save","prepend-icon":"mdi:mdi-content-save",color:"warning",onClick:l=>u(l.callback,o.SubmissionUUID)},null,8,["onClick"]),t(ot,{class:"d-sm-none",size:"35",icon:"mdi:mdi-content-save",color:"warning",onClick:l=>u(l.callback,o.SubmissionUUID)},null,8,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1}))}}),gi=e=>(Lt("data-v-a4024c39"),e=e(),Pt(),e),Ti=gi(()=>B("p",null,"Any tags controlled through registration form fields will be reset when the applicable form is saved. If you don't know what you're doing here, don't touch!",-1)),_i={class:"mb-4"},yi=Q({__name:"RegistrationTags",props:Z({title:{}},{modelValue:{required:!0}}),emits:["update:modelValue"],setup(e){const v=_e(),n=re(e,"modelValue"),u=_(Te(n.value)),d=_(!1),i=_(u.value.Tags);me(n,()=>{u.value=Te(n.value)});const o=({callback:l})=>{const r=[],c=[];u.value.Tags.forEach(f=>{i.value.find(m=>m.TagUUID===f.TagUUID)||r.push(f.TagUUID)}),i.value.forEach(f=>{u.value.Tags.find(m=>f.TagUUID===m.TagUUID)||c.push(f.TagUUID)}),v.updateRegistrationTags(r,c,u.value.RegistrationUUID).then(f=>{f?l&&(l("Tags Saved"),n.value.Tags=f.Tags):l&&l("Error Saving Tags")}).catch(()=>{l&&l("Error Saving Tags")})};return(l,r)=>(s(),E(Le,null,{default:a(()=>[t(tt,null,{default:a(()=>[t(qe,null,{default:a(()=>[C("Tags (#"+S(u.value.Reference)+" "+S(u.value.User.DisplayName)+")",1)]),_:1})]),_:1}),t(je,null,{default:a(()=>[t(Zl,{class:"my-4"},{default:a(()=>[t(en,null,{default:a(()=>[C("Caution")]),_:1}),Ti]),_:1}),B("h3",_i,"#"+S(u.value.Reference)+" "+S(u.value.User.DisplayName),1),t(Sa,{modelValue:u.value.Tags,"onUpdate:modelValue":r[0]||(r[0]=c=>u.value.Tags=c),convention:u.value.ConventionUUID,"show-key":!0,chips:!0,"show-uuid":d.value},null,8,["modelValue","convention","show-uuid"])]),_:1}),t(Bt,{class:"px-4 align-start"},{default:a(()=>[t(fa,{label:"Show UUID",modelValue:d.value,"onUpdate:modelValue":r[1]||(r[1]=c=>d.value=c)},null,8,["modelValue"]),t(ot,{onClick:o,variant:"flat"})]),_:1})]),_:1}))}});const pi=it(yi,[["__scopeId","data-v-a4024c39"]]),ra=Q({__name:"RegistrationActionWindows",props:Z({accommodations:{},convention:{},extras:{},forms:{},interests:{},registration:{},tickets:{},venues:{}},{modelValue:{required:!0}}),emits:Z(["update:registration"],["update:modelValue"]),setup(e,{emit:v}){const n=e,u=re(e,"modelValue"),d=ut(n,v,void 0,void 0,"registration");return(i,o)=>(s(),E(Ra,{modelValue:u.value,"onUpdate:modelValue":o[3]||(o[3]=l=>u.value=l)},{default:a(()=>[t(Ye,{value:"badges"},{default:a(()=>[u.value=="badges"?(s(),E(ge,{key:0,class:"pa-0 mx-0",fluid:!0},{default:a(()=>[t(xt,{convention:i.convention,registration:p(d)},null,8,["convention","registration"])]),_:1})):L("",!0)]),_:1}),t(Ye,{value:"emails"},{default:a(()=>[u.value=="emails"?(s(),E(ge,{key:0,class:"pa-0 mx-0",fluid:!0},{default:a(()=>[t(Fa,{registration:p(d)},null,8,["registration"])]),_:1})):L("",!0)]),_:1}),t(Ye,{value:"notes"},{default:a(()=>[u.value=="notes"?(s(),E(ge,{key:0,class:"pa-0 mx-0",fluid:!0},{default:a(()=>[t(wa,{convention:i.convention,registration:p(d)},null,8,["convention","registration"])]),_:1})):L("",!0)]),_:1}),t(Ye,{value:"payments"},{default:a(()=>[u.value=="payments"?(s(),E(ge,{key:0,class:"pa-0 mx-0",fluid:!0},{default:a(()=>[t(Ui,{modelValue:p(d),"onUpdate:modelValue":o[0]||(o[0]=l=>nt(d)?d.value=l:null),forms:i.forms,title:"Registration Payments"},null,8,["modelValue","forms"])]),_:1})):L("",!0)]),_:1}),t(Ye,{value:"status"},{default:a(()=>[u.value=="status"?(s(),E(ge,{key:0,class:"pa-0 mx-0",fluid:!0},{default:a(()=>[t(Ai,{modelValue:p(d),"onUpdate:modelValue":o[1]||(o[1]=l=>nt(d)?d.value=l:null),forms:i.forms},null,8,["modelValue","forms"])]),_:1})):L("",!0)]),_:1}),t(Ye,{value:"tags"},{default:a(()=>[u.value=="tags"?(s(),E(ge,{key:0,class:"pa-0 mx-0",fluid:!0},{default:a(()=>[t(pi,{modelValue:p(d),"onUpdate:modelValue":o[2]||(o[2]=l=>nt(d)?d.value=l:null),title:"Registration Tags"},null,8,["modelValue"])]),_:1})):L("",!0)]),_:1})]),_:1},8,["modelValue"]))}}),Ei=(e,v)=>e===void 0?!1:$t(e,wt.GROUP_TYPE_CONVENTION,v.ConventionUUID,v).ViewPaymentTransactions,da=Q({__name:"RegistrationActions",props:Z({accommodations:{},convention:{},extras:{},forms:{},interests:{},registration:{},tickets:{},title:{},useDialog:{type:Boolean},venues:{}},{modelValue:{type:Boolean,required:!0}}),emits:Z(["update:registration"],["update:modelValue"]),setup(e,{emit:v}){const n=e,u=re(e,"modelValue"),d=ut(n,v,void 0,void 0,"registration"),i=_("notes"),o=rt(),l=[{label:"Badge",value:"badges"},{label:"Emails",value:"emails"},{label:"Notes",value:"notes"},{label:"Status",value:"status"},{label:"Tags",value:"tags"}];return Ei(o,n.convention)&&l.splice(2,0,{label:"Payments",value:"payments"}),(r,c)=>r.useDialog?(s(),E(et,{key:0,modelValue:u.value,"onUpdate:modelValue":c[3]||(c[3]=f=>u.value=f),title:r.title,"show-close-action":!0,color:"primary","close-action-label":"Close",persistent:!0,"retain-focus":!1,scrollable:!0,fullscreen:"","card-class":"ma-0 pa-0"},{extension:a(()=>[t(ua,{modelValue:i.value,"onUpdate:modelValue":c[0]||(c[0]=f=>i.value=f),tabs:l,"show-arrows":!0},null,8,["modelValue"])]),default:a(()=>[t(ra,{modelValue:i.value,"onUpdate:modelValue":c[1]||(c[1]=f=>i.value=f),registration:p(d),"onUpdate:registration":c[2]||(c[2]=f=>nt(d)?d.value=f:null),accommodations:r.accommodations,convention:r.convention,extras:r.extras,forms:r.forms,interests:r.interests,tabs:l,tickets:r.tickets,venues:r.venues},null,8,["modelValue","registration","accommodations","convention","extras","forms","interests","tickets","venues"])]),_:1},8,["modelValue","title"])):(s(),T(k,{key:1},[t(ua,{modelValue:i.value,"onUpdate:modelValue":c[4]||(c[4]=f=>i.value=f),tabs:l,"show-arrows":!0},null,8,["modelValue"]),t(ra,{modelValue:i.value,"onUpdate:modelValue":c[5]||(c[5]=f=>i.value=f),registration:p(d),"onUpdate:registration":c[6]||(c[6]=f=>nt(d)?d.value=f:null),accommodations:r.accommodations,convention:r.convention,extras:r.extras,forms:r.forms,interests:r.interests,tabs:l,tickets:r.tickets,venues:r.venues},null,8,["modelValue","registration","accommodations","convention","extras","forms","interests","tickets","venues"])],64))}});const Di=(e,v=500,n=!1)=>{let u;return(...d)=>{const o=function(){u=void 0,n||e.apply(void 0,d)},l=n&&!u;clearTimeout(u),u=setTimeout(o,v),l&&e.apply(void 0,d)}},Ii=B("h4",null,"Grid Size (Max 12)",-1),Si={key:0,class:"text-warning text-right pl-1"},Ri=Q({__name:"EditAdminLayout",props:Z({convention:{},layouts:{}},{modelValue:{required:!0}}),emits:Z(["change","delete"],["update:modelValue"]),setup(e,{emit:v}){const n=re(e,"modelValue"),u=_([]),d=_e(),i=_(Object.assign({},...e.layouts.map(A=>A.Panels.map(w=>w.Items.map(V=>{if(!V.Meta)return{};const P={};return Object.entries(V.Meta).forEach(U=>{Array.isArray(U[1])?(P[`${V.LayoutItemUUID}.${U[0]}`]=[],U[1].forEach(F=>{P[`${V.LayoutItemUUID}.${U[0]}`].push(F.toString())})):U[1]!==void 0&&U[1]!==null&&(P[`${V.LayoutItemUUID}.${U[0]}`]=[U[1].toString()])}),P}))).flat(2))),o=_(`
Are you sure you wish to delete this layout? All panels relating to it will be
removed and can not be recovered. This action can not be undone once saved.
You will have to create a new layout.
`),l=_(!1),r=_([]);d.getConventionTags(e.convention.ConventionUUID).then(A=>{A&&(r.value=A)}).catch(()=>{});const c=()=>({ID:0,LayoutPanelUUID:pe(),AdminLayoutID:n.value.ID,AdminLayoutUUID:n.value.AdminLayoutUUID,Name:"",Order:n.value.Panels.length+1,Items:[],PanelStyle:ke.PANEL_STYLE_FLEX,RequiredFormType:Ae.FORM_TYPE_NIL,RequiredGroupMemberships:[],RequiredRegistrationTags:[],Meta:{}}),f=A=>()=>({ID:0,LayoutItemUUID:pe(),LayoutPanelID:A.ID,LayoutPanelUUID:A.LayoutPanelUUID,Label:"",SourceType:Me.LAYOUT_ITEM_SOURCE_FORM,SectionFieldID:void 0,SectionFieldUUID:void 0,SectionField:void 0,MetaField:void 0,UserField:void 0,Align:"",Order:A.Items.length+1,DefaultSort:!1,Meta:{}}),y=(A,w)=>{A.Meta[w]=i.value[`${A.LayoutItemUUID}.${w}`]},m=A=>{const w=u.value.find(V=>V.value===A.SectionFieldUUID);w&&(A.SectionFieldID=w.object.ID,A.SectionField=w.object)};d.getConventionForms(n.value.ConventionUUID).then(A=>{A.forEach(w=>w.Sections.forEach(V=>V.Fields&&u.value.push(...V.Fields.map(P=>{var F;return{title:`${w.Name} - ${V.Name} - ${(F=P.Field)==null?void 0:F.Name}`,value:P.SectionFieldUUID,object:P}})))),u.value.sort(Al("title"))});const g=ae(()=>{switch(n.value.Type){case Oe.ADMIN_LAYOUT_PANELS:return"Panels";case Oe.ADMIN_LAYOUT_TABLE:return"Tabs"}return"Unknown"});return me(n,()=>{v("change")},{deep:!0}),(A,w)=>(s(),E(ge,{class:"px-0 mx-0",fluid:!0},{default:a(()=>[t(W,null,{default:a(()=>[t(N,{cols:"12",sm:"6"},{default:a(()=>[t(ne,{modelValue:n.value.Name,"onUpdate:modelValue":w[0]||(w[0]=V=>n.value.Name=V),label:"Name",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),t(N,{cols:"12",sm:"6"},{default:a(()=>[t(fe,{modelValue:n.value.Type,"onUpdate:modelValue":w[1]||(w[1]=V=>n.value.Type=V),label:"Layout Type",items:p(nn),"item-title":"title","item-value":"value",variant:"outlined","hide-details":""},null,8,["modelValue","items"])]),_:1})]),_:1}),t(W,null,{default:a(()=>[t(N,null,{default:a(()=>[t(kt,{modelValue:n.value.Panels,"onUpdate:modelValue":w[2]||(w[2]=V=>n.value.Panels=V),"new-item":c,closeable:!1,title:g.value,label:"Name","slot-name-prefix":"panel"},Ze({_:2},[X(n.value.Panels,(V,P)=>({name:`panel_${P}`,fn:a(()=>[t(ge,{class:"px-0 mx-0",fluid:!0},{default:a(()=>[t(W,null,{default:a(()=>[t(N,{cols:"12",sm:"6"},{default:a(()=>[t(ne,{modelValue:V.Name,"onUpdate:modelValue":U=>V.Name=U,label:"Name",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),n.value.Type===p(Oe).ADMIN_LAYOUT_PANELS?(s(),E(N,{key:0,cols:"12",sm:"6"},{default:a(()=>[t(fe,{modelValue:V.PanelStyle,"onUpdate:modelValue":U=>V.PanelStyle=U,items:p(un),clearable:!0,label:"Panel Style",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"])]),_:2},1024)):L("",!0),t(N,{cols:"12",sm:"6"},{default:a(()=>[t(fe,{modelValue:V.RequiredFormType,"onUpdate:modelValue":U=>V.RequiredFormType=U,items:p(_l),clearable:!0,label:"Required Form",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"])]),_:2},1024),t(N,{cols:"12",sm:"6"},{default:a(()=>[t(Ea,{label:"Required Groups",variant:"outlined",modelValue:V.RequiredGroupMemberships,"onUpdate:modelValue":U=>V.RequiredGroupMemberships=U,convention:n.value.ConventionUUID,chips:"",clearable:"",hint:"Groups that a user must be in to see this panel. (Any one)"},null,8,["modelValue","onUpdate:modelValue","convention"])]),_:2},1024),t(N,{cols:"12",sm:"6"},{default:a(()=>[t(Sa,{label:"Registration Tags",variant:"outlined",modelValue:V.RequiredRegistrationTags,"onUpdate:modelValue":U=>V.RequiredRegistrationTags=U,convention:n.value.ConventionUUID,chips:"",clearable:"",hint:"Tags that a registration must have to appear in results. (Any one)"},null,8,["modelValue","onUpdate:modelValue","convention"])]),_:2},1024)]),_:2},1024),n.value.Type===p(Oe).ADMIN_LAYOUT_PANELS&&V.PanelStyle===p(ke).PANEL_STYLE_FLEX?(s(),E(W,{key:0},{default:a(()=>[t(N,{cols:"12",class:"py-0 my-0"},{default:a(()=>[Ii]),_:1}),t(N,{cols:"6",sm:"4",lg:"2"},{default:a(()=>[t(ne,{modelValue:V.Meta.cols,"onUpdate:modelValue":U=>V.Meta.cols=U,modelModifiers:{number:!0},clearable:!0,"hide-details":"",label:"Default",type:"number",min:"1",max:"12"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),t(N,{cols:"6",sm:"4",lg:"2"},{default:a(()=>[t(ne,{modelValue:V.Meta.cols_xs,"onUpdate:modelValue":U=>V.Meta.cols_xs=U,modelModifiers:{number:!0},clearable:!0,"hide-details":"",label:"XS",type:"number",min:"1",max:"12"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),t(N,{cols:"6",sm:"4",lg:"2"},{default:a(()=>[t(ne,{modelValue:V.Meta.cols_sm,"onUpdate:modelValue":U=>V.Meta.cols_sm=U,modelModifiers:{number:!0},clearable:!0,"hide-details":"",label:"SM",type:"number",min:"1",max:"12"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),t(N,{cols:"6",sm:"4",lg:"2"},{default:a(()=>[t(ne,{modelValue:V.Meta.cols_md,"onUpdate:modelValue":U=>V.Meta.cols_md=U,modelModifiers:{number:!0},clearable:!0,"hide-details":"",label:"MD",type:"number",min:"1",max:"12"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),t(N,{cols:"6",sm:"4",lg:"2"},{default:a(()=>[t(ne,{modelValue:V.Meta.cols_lg,"onUpdate:modelValue":U=>V.Meta.cols_lg=U,modelModifiers:{number:!0},clearable:!0,"hide-details":"",label:"LG",type:"number",min:"1",max:"12"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),t(N,{cols:"6",sm:"4",lg:"2"},{default:a(()=>[t(ne,{modelValue:V.Meta.cols_xl,"onUpdate:modelValue":U=>V.Meta.cols_xl=U,modelModifiers:{number:!0},clearable:!0,"hide-details":"",label:"XL",type:"number",min:"1",max:"12"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)):L("",!0)]),_:2},1024),t(kt,{modelValue:V.Items,"onUpdate:modelValue":U=>V.Items=U,"new-item":f(V),closeable:!1,title:"Items",label:"Label","slot-name-prefix":"item"},Ze({_:2},[X(V.Items,(U,F)=>({name:`item_${F}`,fn:a(()=>[t(ge,{class:"px-0 mx-0",fluid:!0},{default:a(()=>[t(W,null,{default:a(()=>[t(N,{cols:"12",sm:"6"},{default:a(()=>[t(ne,{modelValue:U.Label,"onUpdate:modelValue":Y=>U.Label=Y,label:"Name",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024),t(W,null,{default:a(()=>[t(N,{cols:"12",sm:"6"},{default:a(()=>[t(fe,{modelValue:U.SourceType,"onUpdate:modelValue":Y=>U.SourceType=Y,label:"Source Type",items:p(on),"item-title":"title","item-value":"value",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"])]),_:2},1024),t(N,{cols:"12",sm:"6"},{default:a(()=>[U.SourceType==="LAYOUT_ITEM_SOURCE_FORM"?(s(),E(fe,{key:0,modelValue:U.SectionFieldUUID,"onUpdate:modelValue":Y=>U.SectionFieldUUID=Y,label:"Form Data",items:u.value,"item-title":"title","item-value":"value",variant:"outlined","hide-details":"",onBlur:Y=>m(U)},null,8,["modelValue","onUpdate:modelValue","items","onBlur"])):U.SourceType==="LAYOUT_ITEM_SOURCE_META"?(s(),E(fe,{key:1,modelValue:U.MetaField,"onUpdate:modelValue":Y=>U.MetaField=Y,label:"Miscellaneous Data",items:p(sn),"item-title":"title","item-value":"value",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"])):U.SourceType==="LAYOUT_ITEM_SOURCE_USER"?(s(),E(fe,{key:2,modelValue:U.UserField,"onUpdate:modelValue":Y=>U.UserField=Y,label:"User Profile Data",items:p(rn),"item-title":"title","item-value":"value",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"])):L("",!0)]),_:2},1024)]),_:2},1024),A.layouts&&U.SourceType==="LAYOUT_ITEM_SOURCE_META"&&U.MetaField===p(H).META_DATA_SOURCE_DATA_LAYOUT?(s(),E(W,{key:0},{default:a(()=>[t(N,{cols:"6",sm:"4",lg:"2"},{default:a(()=>[t(fe,{modelValue:i.value[`${U.LayoutItemUUID}.LayoutUUID`],"onUpdate:modelValue":[Y=>i.value[`${U.LayoutItemUUID}.LayoutUUID`]=Y,Y=>y(U,"LayoutUUID")],clearable:!0,items:A.layouts.filter(Y=>Y.Type===p(Oe).ADMIN_LAYOUT_PANELS)||[],multiple:!0,label:"Data Display","item-title":"Name","item-value":"AdminLayoutUUID",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"])]),_:2},1024)]),_:2},1024)):L("",!0),A.layouts&&U.SourceType==="LAYOUT_ITEM_SOURCE_META"&&U.MetaField===p(H).META_DATA_SOURCE_TAGS?(s(),E(W,{key:1},{default:a(()=>[t(N,{cols:"6",sm:"4",lg:"2"},{default:a(()=>[t(fe,{modelValue:i.value[`${U.LayoutItemUUID}.Tags`],"onUpdate:modelValue":[Y=>i.value[`${U.LayoutItemUUID}.Tags`]=Y,Y=>y(U,"Tags")],clearable:!0,items:r.value||[],multiple:!0,label:"Tags to Display","item-title":"Title","item-value":"TagUUID",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"]),!i.value[U.LayoutItemUUID]||i.value[U.LayoutItemUUID].length===0?(s(),T("small",Si," Will show all tags ")):L("",!0)]),_:2},1024)]),_:2},1024)):L("",!0),n.value.Type===p(Oe).ADMIN_LAYOUT_TABLE&&(U.SourceType!==p(Me).LAYOUT_ITEM_SOURCE_META||U.MetaField!==p(H).META_DATA_SOURCE_DATA_LAYOUT)?(s(),E(W,{key:2},{default:a(()=>[t(N,null,{default:a(()=>[t(fa,{modelValue:U.DefaultSort,"onUpdate:modelValue":Y=>U.DefaultSort=Y,label:"Default Sort","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)):L("",!0)]),_:2},1024)])}))]),1032,["modelValue","onUpdate:modelValue","new-item"])])}))]),1032,["modelValue","title"])]),_:1})]),_:1}),t(W,null,{default:a(()=>[t(N,null,{default:a(()=>[t(z,{onClick:w[3]||(w[3]=V=>l.value=!0),"prepend-icon":"mdi:mdi-delete",color:"red-darken-4"},{default:a(()=>[C("Delete Layout")]),_:1})]),_:1})]),_:1}),l.value?(s(),E(Ca,{key:0,modelValue:l.value,"onUpdate:modelValue":w[4]||(w[4]=V=>l.value=V),message:o.value,title:"Delete Layout",subtitle:"Removes this layout and all it's panels",onDelete:w[5]||(w[5]=V=>v("delete"))},null,8,["modelValue","message"])):L("",!0)]),_:1}))}}),Ci=Q({__name:"EditAdminLayouts",props:Z({title:{},convention:{}},{modelValue:{type:Boolean,required:!0}}),emits:Z(["save"],["update:modelValue"]),setup(e,{emit:v}){const n=re(e,"modelValue"),u=_([]),d=_([]),i=_([]),o=_e(),l=()=>({ID:0,AdminLayoutUUID:pe(),ConventionID:e.convention.ID,ConventionUUID:e.convention.ConventionUUID,Name:"New Layout",Type:Oe.ADMIN_LAYOUT_PANELS,Panels:[]}),r=()=>{let f=!1;[...new Set(i.value)].forEach(m=>{const g=u.value.findIndex(A=>A.AdminLayoutUUID===m);g<0||g>=u.value.length||(o.saveAdminLayout(u.value[g]).then(A=>{A&&u.value.splice(g,1,A)}).catch(()=>{}),f=!0)}),d.value.forEach(m=>{o.deleteAdminLayout(m).catch(()=>{})}),d.value=[],i.value=[],f&&v("save")},c=f=>{const y=u.value.findIndex(m=>m.AdminLayoutUUID===f.AdminLayoutUUID);y<0||y>=u.value.length||(u.value[y].ID>0&&d.value.push(f.AdminLayoutUUID),u.value.splice(y,1))};return o.getConventionAdminLayouts(e.convention.ConventionUUID).then(f=>{f&&(u.value=f)}).catch(()=>[]),(f,y)=>(s(),E(ft,{modelValue:n.value,"onUpdate:modelValue":y[2]||(y[2]=m=>n.value=m),scrollable:!0,"retain-focus":!0,persistent:!0,fullscreen:!0},{default:a(()=>[t(kt,{modelValue:u.value,"onUpdate:modelValue":y[0]||(y[0]=m=>u.value=m),"new-item":l,closeable:!0,"show-delete":!1,"show-save":!0,"has-order":!1,title:f.title,label:"Name","slot-name-prefix":"panel",onClose:y[1]||(y[1]=m=>n.value=!1),onSave:r},Ze({_:2},[X(u.value,(m,g)=>({name:`panel_${g}`,fn:a(()=>[t(ge,{class:"px-0 mx-0",fluid:!0},{default:a(()=>[t(W,null,{default:a(()=>[t(N,{cols:"12"},{default:a(()=>[t(Ri,{modelValue:u.value[g],"onUpdate:modelValue":A=>u.value[g]=A,convention:f.convention,layouts:u.value,onChange:A=>i.value.push(m.AdminLayoutUUID),onDelete:A=>c(m)},null,8,["modelValue","onUpdate:modelValue","convention","layouts","onChange","onDelete"])]),_:2},1024)]),_:2},1024)]),_:2},1024)])}))]),1032,["modelValue","title"])]),_:1},8,["modelValue"]))}});function Vi(){const e=_([]);nl(()=>e.value=[]);function v(n,u){e.value[u]=n}return{refs:e,updateRef:v}}const Oi=ma({activeColor:String,start:{type:[Number,String],default:1},modelValue:{type:Number,default:e=>e.start},disabled:Boolean,length:{type:[Number,String],default:1,validator:e=>e%1===0},totalVisible:[Number,String],firstIcon:{type:ct,default:"$first"},prevIcon:{type:ct,default:"$prev"},nextIcon:{type:ct,default:"$next"},lastIcon:{type:ct,default:"$last"},ariaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.root"},pageAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.page"},currentPageAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.currentPage"},firstAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.first"},previousAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.previous"},nextAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.next"},lastAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.last"},ellipsis:{type:String,default:"..."},showFirstLastPage:Boolean,...El(),...Dl(),...Il(),...Sl(),...Rl(),...Cl(),...Vl({tag:"nav"}),...ol(),...Ol({variant:"text"})},"VPagination"),hi=ca()({name:"VPagination",props:Oi(),emits:{"update:modelValue":e=>!0,first:e=>!0,prev:e=>!0,next:e=>!0,last:e=>!0},setup(e,v){let{slots:n,emit:u}=v;const d=il(e,"modelValue"),{t:i,n:o}=sl(),{isRtl:l}=ul(),{themeClasses:r}=rl(e),{width:c}=dl(),f=ml(-1);Ot(void 0,{scoped:!0});const{resizeRef:y}=bl(O=>{if(!O.length)return;const{target:b,contentRect:h}=O[0],R=b.querySelector(".v-pagination__list > *");if(!R)return;const G=h.width,oe=R.offsetWidth+parseFloat(getComputedStyle(R).marginRight)*2;f.value=w(G,oe)}),m=ae(()=>parseInt(e.length,10)),g=ae(()=>parseInt(e.start,10)),A=ae(()=>e.totalVisible?parseInt(e.totalVisible,10):f.value>=0?f.value:w(c.value,58));function w(O,b){const h=e.showFirstLastPage?5:3;return Math.max(0,Math.floor(+((O-b*h)/b).toFixed(2)))}const V=ae(()=>{if(m.value<=0||isNaN(m.value)||m.value>Number.MAX_SAFE_INTEGER)return[];if(A.value<=1)return[d.value];if(m.value<=A.value)return vt(m.value,g.value);const O=A.value%2===0,b=O?A.value/2:Math.floor(A.value/2),h=O?b:b+1,R=m.value-b;if(h-d.value>=0)return[...vt(Math.max(1,A.value-1),g.value),e.ellipsis,m.value];if(d.value-R>=(O?1:0)){const G=A.value-1,oe=m.value-G+g.value;return[g.value,e.ellipsis,...vt(G,oe)]}else{const G=Math.max(1,A.value-3),oe=G===1?d.value:d.value-Math.ceil(G/2)+g.value;return[g.value,e.ellipsis,...vt(G,oe),e.ellipsis,m.value]}});function P(O,b,h){O.preventDefault(),d.value=b,h&&u(h,b)}const{refs:U,updateRef:F}=Vi();Ot({VPaginationBtn:{color:ye(e,"color"),border:ye(e,"border"),density:ye(e,"density"),size:ye(e,"size"),variant:ye(e,"variant"),rounded:ye(e,"rounded"),elevation:ye(e,"elevation")}});const Y=ae(()=>V.value.map((O,b)=>{const h=R=>F(R,b);if(typeof O=="string")return{isActive:!1,key:`ellipsis-${b}`,page:O,props:{ref:h,ellipsis:!0,icon:!0,disabled:!0}};{const R=O===d.value;return{isActive:R,key:O,page:o(O),props:{ref:h,ellipsis:!1,icon:!0,disabled:!!e.disabled||+e.length<2,color:R?e.activeColor:e.color,ariaCurrent:R,ariaLabel:i(R?e.currentPageAriaLabel:e.pageAriaLabel,O),onClick:G=>P(G,O)}}}})),x=ae(()=>{const O=!!e.disabled||d.value<=g.value,b=!!e.disabled||d.value>=g.value+m.value-1;return{first:e.showFirstLastPage?{icon:l.value?e.lastIcon:e.firstIcon,onClick:h=>P(h,g.value,"first"),disabled:O,ariaLabel:i(e.firstAriaLabel),ariaDisabled:O}:void 0,prev:{icon:l.value?e.nextIcon:e.prevIcon,onClick:h=>P(h,d.value-1,"prev"),disabled:O,ariaLabel:i(e.previousAriaLabel),ariaDisabled:O},next:{icon:l.value?e.prevIcon:e.nextIcon,onClick:h=>P(h,d.value+1,"next"),disabled:b,ariaLabel:i(e.nextAriaLabel),ariaDisabled:b},last:e.showFirstLastPage?{icon:l.value?e.firstIcon:e.lastIcon,onClick:h=>P(h,g.value+m.value-1,"last"),disabled:b,ariaLabel:i(e.lastAriaLabel),ariaDisabled:b}:void 0}});function ie(){var b;const O=d.value-g.value;(b=U.value[O])==null||b.$el.focus()}function ee(O){O.key===Wt.left&&!e.disabled&&d.value>+e.start?(d.value=d.value-1,Je(ie)):O.key===Wt.right&&!e.disabled&&d.value<g.value+m.value-1&&(d.value=d.value+1,Je(ie))}return ga(()=>t(e.tag,{ref:y,class:["v-pagination",r.value,e.class],style:e.style,role:"navigation","aria-label":i(e.ariaLabel),onKeydown:ee,"data-test":"v-pagination-root"},{default:()=>[t("ul",{class:"v-pagination__list"},[e.showFirstLastPage&&t("li",{key:"first",class:"v-pagination__first","data-test":"v-pagination-first"},[n.first?n.first(x.value.first):t(z,he({_as:"VPaginationBtn"},x.value.first),null)]),t("li",{key:"prev",class:"v-pagination__prev","data-test":"v-pagination-prev"},[n.prev?n.prev(x.value.prev):t(z,he({_as:"VPaginationBtn"},x.value.prev),null)]),Y.value.map((O,b)=>t("li",{key:O.key,class:["v-pagination__item",{"v-pagination__item--is-active":O.isActive}],"data-test":"v-pagination-item"},[n.item?n.item(O):t(z,he({_as:"VPaginationBtn"},O.props),{default:()=>[O.page]})])),t("li",{key:"next",class:"v-pagination__next","data-test":"v-pagination-next"},[n.next?n.next(x.value.next):t(z,he({_as:"VPaginationBtn"},x.value.next),null)]),e.showFirstLastPage&&t("li",{key:"last",class:"v-pagination__last","data-test":"v-pagination-last"},[n.last?n.last(x.value.last):t(z,he({_as:"VPaginationBtn"},x.value.last),null)])])]})),{}}}),bi=["colspan"],Mi={style:{opacity:"var(--v-medium-emphasis-opacity)"}},ys=Q({__name:"RegistrationsView",emits:["pageTitle"],setup(e,{emit:v}){var zt;const n=Ut();v("pageTitle","Registration Manager");const u=cl(),d=vl(),i=_(!0);let o=((zt=u.params.convention)==null?void 0:zt.toString())||"";const l=_({ID:0,ConventionUUID:pe(),OrganisationID:0,OrganisationUUID:Ct,Name:"New Convention",Description:"",DetailLink:"",Logo:"",Slug:"",Accommodation:[],Tickets:[],Extras:[],Interests:[],Visible:!1}),r=_e(),c=fl.getInstance(),f=_([]),y=_({ID:0,AdminLayoutUUID:pe(),ConventionID:l.value.ID,ConventionUUID:l.value.ConventionUUID,Name:"Registration Table",Type:Oe.ADMIN_LAYOUT_TABLE,Panels:[]}),m=_([]),g=_([]),A=_([]),w=_([]),V=_([]),P=_([]),U=_(1),F=_(10),Y=_([]),x=_(0),ie=_(!1),ee=_(""),O=_(""),b=_(""),h=_(""),R=_({FieldUUID:"591c9bca-c78c-4e97-8aef-bc596ef472fb",Value:""}),G=_({FieldUUID:"50189b21-6c55-4c99-a38f-7740a01ec4a4",Value:""}),oe=_({FieldUUID:"1523ef15-f2c3-46b9-a687-dcd7bc2c0a50",Value:""}),Ue=_({FieldUUID:"926d43c6-a743-4ab7-bef2-060d762d37a9",Value:""}),ce=_(new Map([["591c9bca-c78c-4e97-8aef-bc596ef472fb",R.value],["50189b21-6c55-4c99-a38f-7740a01ec4a4",G.value],["1523ef15-f2c3-46b9-a687-dcd7bc2c0a50",oe.value],["926d43c6-a743-4ab7-bef2-060d762d37a9",Ue.value]])),ze=_(""),Qe=_(""),at=_([]),Ke=_([]),De=_([]),Pe=_([]),Fe=_([]),we=_([]),Re=_(0),Ee=_(),$e=_(!1),Ht=_(!1),Ba=_(!1),dt=_(),qt=_(),pt=_(),Xe=_(!1),Ga=rt(),ve=Di(()=>{O.value=Date.now().toString()});me(ee,I=>{const D=P.value.find($=>$.uuid===I);if(D){const $=D.headers.find(M=>M.defaultSort===!0);$&&(Y.value=[{key:$.key,order:"asc"}],at.value=[{key:$.key,order:"asc"}])}}),me(Re,I=>{I===8&&jt()}),me(ze,()=>{ve()}),me(Qe,()=>{ve()});const Ya=()=>{m.value=[],A.value=[],w.value=[],P.value=[];try{r.getConventionAdminLayoutByName(l.value.ConventionUUID,"Registration Table").then(I=>{Re.value+=1,I?y.value=I:(y.value.ConventionID=l.value.ID,y.value.ConventionUUID=l.value.ConventionUUID)})}catch{y.value.ConventionID=l.value.ID,y.value.ConventionUUID=l.value.ConventionUUID}try{r.getConventionAdminLayouts(l.value.ConventionUUID).then(I=>{Re.value+=1,I&&(A.value=I)})}catch{}try{r.getConventionForms(l.value.ConventionUUID).then(I=>{Re.value+=1,I&&(m.value=I)})}catch{}try{r.getConventionAccommodation(l.value.ConventionUUID).then(I=>{Re.value+=1,I&&(Ke.value=I)})}catch{}try{r.getConventionVenues(l.value.ConventionUUID).then(I=>{Re.value+=1,I&&(we.value=I)})}catch{}try{r.getConventionExtras(l.value.ConventionUUID).then(I=>{Re.value+=1,I&&(De.value=I)})}catch{}try{r.getConventionInterests(l.value.ConventionUUID).then(I=>{Re.value+=1,I&&(Pe.value=I)})}catch{}try{r.getConventionTickets(l.value.ConventionUUID).then(I=>{Re.value+=1,I&&(Fe.value=I)})}catch{}try{r.getConventionGroups(l.value.ConventionUUID).then(I=>{I&&(g.value=I.sort((D,$)=>D.Name.localeCompare($.Name)))})}catch{}try{r.getConventionTags(l.value.ConventionUUID).then(I=>{I&&(V.value=I.sort((D,$)=>D.Title.localeCompare($.Title)).map(D=>(D.Title=`${D.Title} [${D.Key}]`,D)))})}catch{}},Et=({page:I,itemsPerPage:D,sortBy:$})=>{i.value=!0,U.value=I,Y.value=$;const M=P.value.find(ue=>ue.uuid==ee.value),de=M==null?void 0:M.layout.Items;let se="",Qt="";if($&&de&&$.length>=1){const ue=de.find(It=>It.LayoutItemUUID==$[0].key);switch(Qt=$[0].order||"asc",ue==null?void 0:ue.MetaField){case H.META_DATA_SOURCE_ACCOMMODATION_FORM:se="submission.status";break;case H.META_DATA_SOURCE_BADGE_FORM:se="submission.status";break;case H.META_DATA_SOURCE_DEALER_FORM:se="submission.status";break;case H.META_DATA_SOURCE_REGISTRATION_FORM:se="submission.status";break;case H.META_DATA_SOURCE_REGISTRATION_REFERENCE:se="reference";break;case H.META_DATA_SOURCE_SUBMISSION_DATE:se="created";break;case H.META_DATA_SOURCE_SUBMISSION_STATUS:se="submission.status";break}switch(ue==null?void 0:ue.UserField){case le.USER_DATA_SOURCE_DISPLAY_NAME:se="user.display_name";break;case le.USER_DATA_SOURCE_EMAIL:se="user.email";break;case le.USER_DATA_SOURCE_FIRST_NAME:se="user.firstname";break;case le.USER_DATA_SOURCE_HANDLE:se="user.handle";break;case le.USER_DATA_SOURCE_LAST_NAME:se="user.lastname";break}}try{const ue={Direction:Qt,Limit:D,Offset:(I-1)*D,Order:se};M&&M.layout.RequiredRegistrationTags.length>0&&(ue.PanelUUID=M==null?void 0:M.layout.LayoutPanelUUID),(M==null?void 0:M.layout.RequiredFormType)===Ae.FORM_TYPE_ACCOMMODATION&&(ue.Accommodation=!0),(M==null?void 0:M.layout.RequiredFormType)===Ae.FORM_TYPE_BADGE&&(ue.Badge=!0),(M==null?void 0:M.layout.RequiredFormType)===Ae.FORM_TYPE_DEALER&&(ue.Dealer=!0),(M==null?void 0:M.layout.RequiredFormType)===Ae.FORM_TYPE_REGISTRATION&&(ue.Registration=!0),ue.GroupUUID=ze.value||Ct,ue.TagUUID=Qe.value||Ct,ue.Email=h.value,ue.Reference=b.value,ue.FieldValues=Array.from(ce.value.values());const It=O.value;r.searchConventionRegistrations(l.value.ConventionUUID,ue).then(St=>{St&&It===O.value&&(x.value=St.Total,w.value=St.Registrations,P.value.forEach(Rt=>{const Wa=Rt.layout;Rt.items=w.value.map(K=>{const mt=[];let Ce;K.Leader?Ce=K:Ce=K.Primary,mt.push({Name:Ce.User.DisplayName,UUID:Ce.UserUUID,UserUUID:Ce.User.UserUUID,IsLeader:!0,Reference:Ce.Reference,Paid:Ce.Paid,Total:Ce.Total}),mt.push(...Ce.Members.map(Ve=>({Name:Ve.User.DisplayName,UUID:Ve.UserUUID,UserUUID:Ve.User.UserUUID,IsLeader:!1,Reference:Ve.Reference,Paid:Ve.Paid,Total:Ve.Total})));const te={};return Rt.headers.forEach(Ve=>{var Kt;const j=Wa.Items.find(lt=>lt.LayoutItemUUID===Ve.key);if(j){if(j.SourceType==="LAYOUT_ITEM_SOURCE_FORM"&&j.SectionField)K.Submissions.forEach(lt=>{const We=lt.Data.find(q=>q.SectionFieldUUID===j.SectionFieldUUID);if(We){Ve.type===Tl.ACCOMMODATION?te[j.LayoutItemUUID]={Data:We.Data,Registration:K}:te[j.LayoutItemUUID]=We.Data;return}});else if(j.SourceType==="LAYOUT_ITEM_SOURCE_USER"&&j.UserField)switch(j.UserField){case le.USER_DATA_SOURCE_AVATAR:te[j.LayoutItemUUID]=n.GetProfileImageURL(K.UserUUID);break;case le.USER_DATA_SOURCE_DISPLAY_NAME:te[j.LayoutItemUUID]=K.User.DisplayName;break;case le.USER_DATA_SOURCE_EMAIL:te[j.LayoutItemUUID]=K.User.Additional.Email;break;case le.USER_DATA_SOURCE_HANDLE:te[j.LayoutItemUUID]=K.User.Handle;break;case le.USER_DATA_SOURCE_DATE_OF_BIRTH:te[j.LayoutItemUUID]=K.User.Additional.DOB;break;case le.USER_DATA_SOURCE_FIRST_NAME:te[j.LayoutItemUUID]=K.User.Additional.FirstName;break;case le.USER_DATA_SOURCE_LAST_NAME:te[j.LayoutItemUUID]=K.User.Additional.LastName;break;case le.USER_DATA_SOURCE_TELEGRAM:te[j.LayoutItemUUID]="";break}else if(j.SourceType==="LAYOUT_ITEM_SOURCE_META"&&j.MetaField){const lt=(Kt=m.value.find(q=>q.Type===Ae.FORM_TYPE_REGISTRATION))==null?void 0:Kt.FormUUID,We=K.Submissions.find(q=>q.FormUUID===lt);switch(j.MetaField){case H.META_DATA_SOURCE_REGISTRATION_ACTIONS:te[j.LayoutItemUUID]=K;break;case H.META_DATA_SOURCE_REGISTRATION_GROUP:te[j.LayoutItemUUID]=mt;break;case H.META_DATA_SOURCE_REGISTRATION_REFERENCE:te[j.LayoutItemUUID]=K.Reference;break;case H.META_DATA_SOURCE_SUBMISSION_DATE:if(We){const q=new Date(We.CreatedAt||"");te[j.LayoutItemUUID]=`${q.getFullYear()}-${(q.getMonth()+1).toString().padStart(2,"0")}-${q.getDate().toString().padStart(2,"0")} ${q.getHours().toString().padStart(2,"0")}:${q.getMinutes().toString().padStart(2,"0")}:${q.getSeconds().toString().padStart(2,"0")}`}else{const q=new Date(K.CreatedAt||"");te[j.LayoutItemUUID]=`${q.getFullYear()}-${(q.getMonth()+1).toString().padStart(2,"0")}-${q.getDate().toString().padStart(2,"0")} ${q.getHours().toString().padStart(2,"0")}:${q.getMinutes().toString().padStart(2,"0")}:${q.getSeconds().toString().padStart(2,"0")}`}break;case H.META_DATA_SOURCE_ACCOMMODATION_FORM:te[j.LayoutItemUUID]=K.Submissions.map(q=>{const J=m.value.find(Be=>Be.FormUUID===q.FormUUID);return{Heading:J==null?void 0:J.Heading,Form:J,Submission:q,Registration:K}}).filter(q=>{var J;return((J=q.Form)==null?void 0:J.Type)===Ae.FORM_TYPE_ACCOMMODATION});break;case H.META_DATA_SOURCE_BADGE_FORM:te[j.LayoutItemUUID]=K.Submissions.map(q=>{const J=m.value.find(Be=>Be.FormUUID===q.FormUUID);return{Heading:J==null?void 0:J.Heading,Form:J,Submission:q,Registration:K}}).filter(q=>{var J;return((J=q.Form)==null?void 0:J.Type)===Ae.FORM_TYPE_BADGE});break;case H.META_DATA_SOURCE_DEALER_FORM:te[j.LayoutItemUUID]=K.Submissions.map(q=>{const J=m.value.find(Be=>Be.FormUUID===q.FormUUID);return{Heading:J==null?void 0:J.Heading,Form:J,Submission:q,Registration:K}}).filter(q=>{var J;return((J=q.Form)==null?void 0:J.Type)===Ae.FORM_TYPE_DEALER});break;case H.META_DATA_SOURCE_PAYMENT_STATUS:if(K.Paid===0&&K.Total)te[j.LayoutItemUUID]="REQUIRED";else if(K.Total>K.Paid)te[j.LayoutItemUUID]="ADDITIONAL_REQUIRED";else{const q=mt.find(J=>J.Paid===0&&(J.Total||0)>0);if(q){K.Total===0&&q.Total===0?te[j.LayoutItemUUID]="NOT_REQUIRED":K.Total===0&&q.Total||K.Total>0&&q.Total===0?te[j.LayoutItemUUID]="MISSING_REQUIRED":K.Paid>=K.Total?te[j.LayoutItemUUID]="AWAITING_PARTNER":te[j.LayoutItemUUID]="ALL_REQUIRED";break}else K.Total===0?te[j.LayoutItemUUID]="NOT_REQUIRED":te[j.LayoutItemUUID]="COMPLETE"}break;case H.META_DATA_SOURCE_SUBMISSION_STATUS:Jl(K.Submissions,m.value),te[j.LayoutItemUUID]=K.Submissions.map(q=>{const J=m.value.find(Be=>Be.FormUUID===q.FormUUID);return{Heading:J==null?void 0:J.Heading,Form:J,Submission:q,Registration:K}});break;case H.META_DATA_SOURCE_DATA_LAYOUT:te[j.LayoutItemUUID]={Registration:K,Layouts:A.value.filter(q=>{if(j.Meta&&j.Meta.LayoutUUID&&Array.isArray(j.Meta.LayoutUUID))return j.Meta.LayoutUUID.includes(q.AdminLayoutUUID)})};break}}}}),{key:K.RegistrationUUID,registration:K,...te}})}),i.value=!1)})}catch{}},xa=I=>{ie.value=!1,I&&(y.value=I,jt())},jt=()=>{y.value.Panels.forEach(I=>{I.Items.forEach(D=>{(D.SectionField==null||D.SectionField.Field==null)&&m.value.find($=>{$.Sections.find(M=>{if(M.Fields){const de=M.Fields.find(se=>se.SectionFieldUUID===D.SectionFieldUUID);if(de)return D.SectionField=de,!0}})})})}),y.value.Panels.length>0&&(P.value=[],y.value.Panels.forEach(I=>{const D={uuid:pe(),order:I.Order,name:I.Name,headers:[],items:[],layout:I};I.Items.sort(($,M)=>$.Order>M.Order?1:$.Order==M.Order?0:-1),D.headers=I.Items.map($=>{var M,de;return{key:$.LayoutItemUUID,title:$.Label||((de=(M=$.SectionField)==null?void 0:M.Field)==null?void 0:de.Label)||"",align:$.Align==="end"?"end":"start",sortable:qa($),type:Ha($),defaultSort:$.DefaultSort,meta:$.Meta}}),P.value.push(D)}),P.value=P.value.sort((I,D)=>I.order>D.order?1:I.order==D.order?0:-1)),(ee.value==null||ee.value=="")&&P.value.length>0&&(ee.value=P.value[0].uuid)};o?r.getConvention(o).then(I=>{I&&(l.value=I,y.value.ConventionID=l.value.ID,y.value.ConventionUUID=l.value.ConventionUUID,Ya())}).catch(()=>{d.push("/")}):d.push("/");const Ha=I=>{var D,$;if(I.SourceType===Me.LAYOUT_ITEM_SOURCE_META)return`${I.SourceType}.${I.MetaField}`;if(I.SourceType===Me.LAYOUT_ITEM_SOURCE_FORM)return($=(D=I.SectionField)==null?void 0:D.Field)==null?void 0:$.Type;if(I.SourceType===Me.LAYOUT_ITEM_SOURCE_USER)return`${I.SourceType}.${I.UserField}`},qa=I=>{const D=[H.META_DATA_SOURCE_ACCOMMODATION_FORM,H.META_DATA_SOURCE_BADGE_FORM,H.META_DATA_SOURCE_DEALER_FORM,H.META_DATA_SOURCE_REGISTRATION_FORM,H.META_DATA_SOURCE_REGISTRATION_REFERENCE,H.META_DATA_SOURCE_SUBMISSION_DATE,H.META_DATA_SOURCE_SUBMISSION_STATUS],$=[le.USER_DATA_SOURCE_DISPLAY_NAME,le.USER_DATA_SOURCE_EMAIL,le.USER_DATA_SOURCE_HANDLE,le.USER_DATA_SOURCE_DATE_OF_BIRTH,le.USER_DATA_SOURCE_FIRST_NAME,le.USER_DATA_SOURCE_LAST_NAME];return D.includes(I.MetaField)||$.includes(I.UserField)},ja=I=>{Ee.value=I,$e.value=!0},za=I=>{Ee.value=I,Ht.value=!0},Qa=I=>{Ee.value=I,Ba.value=!0};me($e,I=>{I||(Ee.value=void 0)}),me(Ht,I=>{I||(Ee.value=void 0)});const Dt=async(I="")=>{qt.value=await r.getRegistrationGroup(I)},Ka=({registration:I,form:D,submission:$})=>{Ee.value=I,Dt(I.RegistrationUUID).then(()=>{dt.value=D,pt.value=$,Xe.value=!0})},Xa=I=>{r.switchUser(I.UserUUID).then(D=>{D&&tn(D.tokens,D.user,d,!1)}).catch(D=>{console.error(D)})};return c.on("registration.group.leave",I=>{r.leaveRegistrationGroup(I).then(D=>{D&&Dt(I).then(()=>{c.emit("registration.group.left",D)})})}),c.on("registration.group.remove.member",I=>{r.leaveRegistrationGroup(I).then(D=>{D&&Dt(I).then(()=>{c.emit("registration.group.left",D)})})}),(I,D)=>(s(),E(ln,null,{default:a(()=>[t(Nt,{color:"blue-darken-4"},{default:a(()=>[t(Da,{modelValue:ee.value,"onUpdate:modelValue":D[0]||(D[0]=$=>ee.value=$),"show-arrows":""},{default:a(()=>[(s(!0),T(k,null,X(P.value,$=>(s(),E(Ia,{key:$.uuid,value:$.uuid},{default:a(()=>[C(S($.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"]),t(He),t(z,{icon:"mdi:mdi-cog-outline",onClick:D[1]||(D[1]=$=>ie.value=!0)})]),_:1}),t(Ra,{modelValue:ee.value,"onUpdate:modelValue":D[23]||(D[23]=$=>ee.value=$),disabled:!0,touch:!1},{default:a(()=>[(s(!0),T(k,null,X(P.value,$=>(s(),E(Ye,{key:$.uuid,value:$.uuid},{default:a(()=>[$.uuid===ee.value?(s(),E(Le,{key:0,class:"pa-2"},{default:a(()=>[t(p(vn),{expanded:f.value,"onUpdate:expanded":D[19]||(D[19]=M=>f.value=M),page:U.value,"onUpdate:page":D[20]||(D[20]=M=>U.value=M),"items-per-page":F.value,"onUpdate:itemsPerPage":D[21]||(D[21]=M=>F.value=M),"sort-by":at.value,"onUpdate:sortBy":D[22]||(D[22]=M=>at.value=M),headers:$.headers,"items-length":x.value,items:$.items,"item-value":"key",loading:i.value,search:O.value,"onUpdate:options":Et,"show-expand":""},Ze({top:a(()=>[t(_t,{class:"mb-3"},{default:a(()=>[t(Tt,null,{default:a(()=>[t(At,{color:"secondary",class:"font-weight-bold pb-0 pt-0"},{default:a(()=>[t(N,{class:"pa-0"},{default:a(()=>[C(" Search Criteria "),t(be,{class:"pl-5",icon:"mdi:mdi-credit-card-search-outline"})]),_:1}),t(N,{class:"d-none d-sm-block pa-0",cols:"0"},{default:a(()=>[t(ne,{modelValue:b.value,"onUpdate:modelValue":D[2]||(D[2]=M=>b.value=M),label:"Badge No.",clearable:!0,"hide-details":"",variant:"plain",onClick:D[3]||(D[3]=ht(()=>{},["stop"])),"onClick:clear":p(ve),onInput:p(ve)},null,8,["modelValue","onClick:clear","onInput"])]),_:1}),t(N,{class:"d-none d-md-block pa-0"},{default:a(()=>[t(ne,{modelValue:R.value.Value,"onUpdate:modelValue":D[4]||(D[4]=M=>R.value.Value=M),label:"Furry Name",clearable:!0,"hide-details":"",variant:"plain",onClick:D[5]||(D[5]=ht(()=>{},["stop"])),"onClick:clear":p(ve),onInput:p(ve)},null,8,["modelValue","onClick:clear","onInput"])]),_:1})]),_:1}),t(gt,{class:"pt-2"},{default:a(()=>[t(W,null,{default:a(()=>[t(N,{cols:"12",sm:"6",md:"3",lg:"2",xl:"1"},{default:a(()=>[t(ne,{modelValue:b.value,"onUpdate:modelValue":D[6]||(D[6]=M=>b.value=M),label:"Badge No.",clearable:!0,"hide-details":"",variant:"outlined","onClick:clear":p(ve),onInput:p(ve)},null,8,["modelValue","onClick:clear","onInput"])]),_:1}),t(N,{cols:"12",sm:"6",md:"4",lg:"5",xl:"2"},{default:a(()=>[t(ne,{modelValue:R.value.Value,"onUpdate:modelValue":D[7]||(D[7]=M=>R.value.Value=M),label:"Furry Name",clearable:!0,"hide-details":"",variant:"outlined","onClick:clear":p(ve),onInput:p(ve)},null,8,["modelValue","onClick:clear","onInput"])]),_:1}),t(N,{cols:"12",sm:"12",md:"5",lg:"5",xl:"3"},{default:a(()=>[t(ne,{modelValue:h.value,"onUpdate:modelValue":D[8]||(D[8]=M=>h.value=M),label:"E-mail",clearable:!0,"hide-details":"",variant:"outlined","onClick:clear":p(ve),onInput:p(ve)},null,8,["modelValue","onClick:clear","onInput"])]),_:1}),t(N,{cols:"12",sm:"6",md:"4",lg:"4",xl:"2"},{default:a(()=>[t(ne,{modelValue:G.value.Value,"onUpdate:modelValue":D[9]||(D[9]=M=>G.value.Value=M),label:"Legal Forename",clearable:!0,"hide-details":"",variant:"outlined","onClick:clear":p(ve),onInput:p(ve)},null,8,["modelValue","onClick:clear","onInput"])]),_:1}),t(N,{cols:"12",sm:"6",md:"4",lg:"4",xl:"2"},{default:a(()=>[t(ne,{modelValue:oe.value.Value,"onUpdate:modelValue":D[10]||(D[10]=M=>oe.value.Value=M),label:"Legal Surname",clearable:!0,"hide-details":"",variant:"outlined","onClick:clear":p(ve),onInput:p(ve)},null,8,["modelValue","onClick:clear","onInput"])]),_:1}),t(N,{cols:"12",sm:"12",md:"4",lg:"4",xl:"2"},{default:a(()=>[t(ne,{modelValue:Ue.value.Value,"onUpdate:modelValue":D[11]||(D[11]=M=>Ue.value.Value=M),type:"date",label:"Date of Birth",clearable:!0,"hide-details":"",variant:"outlined","onClick:clear":p(ve),onInput:p(ve)},null,8,["modelValue","onClick:clear","onInput"])]),_:1}),t(N,{cols:"12",sm:"6",md:"6",lg:"6",xl:"6"},{default:a(()=>[t(fe,{modelValue:ze.value,"onUpdate:modelValue":D[12]||(D[12]=M=>ze.value=M),label:"Permission Groups",clearable:!0,"hide-details":"",variant:"outlined",items:g.value,"item-value":"GroupUUID","item-title":"Name"},null,8,["modelValue","items"])]),_:1}),t(N,{cols:"12",sm:"6",md:"6",lg:"6",xl:"6"},{default:a(()=>[t(fe,{modelValue:Qe.value,"onUpdate:modelValue":D[13]||(D[13]=M=>Qe.value=M),label:"Tags",clearable:!0,"hide-details":"",variant:"outlined",items:V.value,"item-value":"TagUUID","item-title":"Title"},null,8,["modelValue","items"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),"expanded-row":a(({columns:M,item:de})=>[B("tr",null,[B("td",{colspan:M.length},[t(da,{modelValue:$e.value,"onUpdate:modelValue":D[15]||(D[15]=se=>$e.value=se),registration:de.selectable.registration,"onUpdate:registration":se=>de.selectable.registration=se,accommodations:Ke.value,convention:l.value,extras:De.value,forms:m.value,interests:Pe.value,tickets:Fe.value,title:`Registration Controls (#${de.selectable.registration.Reference} ${de.selectable.registration.User.DisplayName})`,"use-dialog":!1,venues:we.value},null,8,["modelValue","registration","onUpdate:registration","accommodations","convention","extras","forms","interests","tickets","title","venues"])],8,bi)])]),"item.data-table-expand":a(({item:M})=>[f.value.findIndex(de=>de===M.key)>=0?(s(),E(z,{key:0,"append-icon":"mdi:mdi-chevron-up",size:"xs",variant:"flat",onClick:de=>f.value.splice(f.value.findIndex(se=>se===M.key),1)},{default:a(()=>[M.selectable.registration.Notes&&M.selectable.registration.Notes.length>0?(s(),T(k,{key:0},[C(S(M.selectable.registration.Notes.length),1)],64)):L("",!0)]),_:2},1032,["onClick"])):(s(),E(z,{key:1,"append-icon":"mdi:mdi-chevron-down",size:"xs",variant:"flat",onClick:de=>f.value.push(M.key)},{default:a(()=>[M.selectable.registration.Notes&&M.selectable.registration.Notes.length>0?(s(),T(k,{key:0},[C(S(M.selectable.registration.Notes.length),1)],64)):L("",!0)]),_:2},1032,["onClick"]))]),bottom:a(()=>[t(ge,{fluid:!0},{default:a(()=>[t(W,{class:"align-center"},{default:a(()=>[t(N,{cols:"12",lg:"7","order-lg":"3",xl:"8"},{default:a(()=>[t(hi,{modelValue:U.value,"onUpdate:modelValue":D[16]||(D[16]=M=>U.value=M),length:Math.ceil(x.value/F.value)},null,8,["modelValue","length"])]),_:1}),t(N,{cols:"6",sm:"4",md:"2",lg:"2",xl:"1","order-lg":"1"},{default:a(()=>[t(fe,{"model-value":F.value,density:"compact","hide-details":"","item-title":"title","item-value":"value",label:"Items per page",min:"-1",max:"100",type:"number",variant:"outlined",items:[{title:"10",value:10},{title:"25",value:25},{title:"50",value:50},{title:"100",value:100},{title:"All",value:-1}],"onUpdate:modelValue":D[17]||(D[17]=M=>F.value=parseInt(M,10))},null,8,["model-value"])]),_:1}),t(N,{cols:"6",sm:"3",md:"2",lg:"1",xl:"1","order-lg":"2"},{default:a(()=>[t(ne,{modelValue:U.value,"onUpdate:modelValue":D[18]||(D[18]=M=>U.value=M),modelModifiers:{number:!0},density:"compact","hide-details":"",label:"Page",min:"1",max:Math.ceil(x.value/F.value),type:"number",variant:"outlined"},null,8,["modelValue","max"])]),_:1}),t(N,{class:"text-right",cols:"12",sm:"5",md:"8",lg:"2",xl:"2","order-lg":"4"},{default:a(()=>[B("span",Mi,[F.value===-1?(s(),T(k,{key:0},[C(" 1-"+S(x.value)+" of "+S(x.value),1)],64)):(s(),T(k,{key:1},[C(S((U.value-1)*F.value+1)+"-"+S(U.value*F.value>=x.value?x.value:U.value*F.value)+" of "+S(x.value),1)],64))])]),_:1})]),_:1})]),_:1})]),_:2},[X($.headers,M=>({name:`item.${M.key}`,fn:a(({item:de})=>[t(Jo,{header:M,item:de,accommodations:Ke.value,convention:l.value,extras:De.value,forms:m.value,interests:Pe.value,tickets:Fe.value,user:p(Ga),venues:we.value,onOpenActions:ja,onOpenPayments:za,onOpenTags:Qa,onReload:D[14]||(D[14]=se=>Et({page:U.value,itemsPerPage:F.value,sortBy:Y.value})),onSwitchUser:Xa,onShowForm:Ka},null,8,["header","item","accommodations","convention","extras","forms","interests","tickets","user","venues"])])}))]),1032,["expanded","page","items-per-page","sort-by","headers","items-length","items","loading","search"])]),_:2},1024)):L("",!0)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"]),ie.value?(s(),E(Ci,{key:0,title:"Edit Layouts",modelValue:ie.value,"onUpdate:modelValue":D[24]||(D[24]=$=>ie.value=$),convention:l.value,onSave:xa},null,8,["modelValue","convention"])):L("",!0),Ee.value?(s(),T(k,{key:1},[$e.value?(s(),E(da,{key:0,modelValue:$e.value,"onUpdate:modelValue":D[25]||(D[25]=$=>$e.value=$),registration:Ee.value,"onUpdate:registration":D[26]||(D[26]=$=>Ee.value=$),accommodations:Ke.value,convention:l.value,extras:De.value,forms:m.value,interests:Pe.value,tickets:Fe.value,title:`Registration Controls (#${Ee.value.Reference} ${Ee.value.User.DisplayName})`,"use-dialog":!0,venues:we.value},null,8,["modelValue","registration","accommodations","convention","extras","forms","interests","tickets","title","venues"])):L("",!0)],64)):L("",!0),Xe.value&&pt.value&&dt.value?(s(),E(ft,{key:2,modelValue:Xe.value,"onUpdate:modelValue":D[30]||(D[30]=$=>Xe.value=$),scrollable:!0,fullscreen:!0,persistent:!0},{default:a(()=>[t(Le,{class:"bg-red-darken-4"},{default:a(()=>[t(Nt,{color:"error"},{default:a(()=>[t(Va,null,{default:a(()=>[C("Submission Editor - Admin Mode")]),_:1}),t(He),t(an,null,{default:a(()=>[t(z,{icon:"mdi:mdi-window-close",onClick:D[27]||(D[27]=$=>Xe.value=!1)})]),_:1})]),_:1}),t(je,null,{default:a(()=>[t(gl,{modelValue:dt.value,"onUpdate:modelValue":D[28]||(D[28]=$=>dt.value=$),admin:!0,convention:l.value,data:pt.value,editable:!0,"registration-group":qt.value,onClose:D[29]||(D[29]=$=>{Xe.value=!1,Et({page:U.value,itemsPerPage:F.value,sortBy:Y.value})})},null,8,["modelValue","convention","data","registration-group"])]),_:1})]),_:1})]),_:1},8,["modelValue"])):L("",!0)]),_:1}))}});export{ys as default};
