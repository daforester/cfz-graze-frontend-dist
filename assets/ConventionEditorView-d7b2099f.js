import{s as R}from"./index-71069b21.js";import{I as O,r as y,K as c,L as g,M as l,v as e,N as C,S as I,$ as B,a0 as x,a1 as M,e as W,w as J,R as E,H as $,a2 as j,Q as A,Z as K,O as P,U as h,P as re,x as he,a4 as be,E as ge,a5 as $e,a6 as ye,a7 as xe,a3 as je,s as ie,a8 as Ge}from"./index-b4ed8091.js";import{m as Ne,a as Se,s as Re,T as L,b as ze}from"./filter-7b5281ea.js";import{v as q}from"./v4-a960c1f4.js";import{u as me,a as ue,V as oe}from"./VToolbar-206b9795.js";import{V as F,l as z,n as G}from"./VContainer-d055e06d.js";import{V as ee}from"./VSpacer-619f4456.js";import{V as ve}from"./VToolbarItems-4cfc09a2.js";import{a as N,V as _}from"./VRow-184203f4.js";import{V as S,a as He}from"./VTextField-27a029d5.js";import{c as ce,e as de}from"./VCard-6ef3246a.js";import{V as Oe,a as Ie,F as we,b as X,_ as qe,c as Je}from"./FormRenderer.vue_vue_type_script_setup_true_lang-1c0d99be.js";import{V as pe}from"./VDialog-8eb3692d.js";import{a as te,b as Ae,V as ke,d as le,c as Fe}from"./VList-38ac82e4.js";import{_ as Q,V as Me,a as Le}from"./VChip-c1be6573.js";import{V as fe,a as Ve,b as Ue,c as Te,d as ae,e as Ke,_ as Ye,f as Xe,g as We,h as Qe,i as Ze}from"./VWindowItem-9abe1eda.js";import{V as se}from"./VSelect-53e88be5.js";import{V as Z,u as De}from"./VCheckbox-f168e1fd.js";import{V as el}from"./VTable-d37d93fa.js";import{_ as Be}from"./DeleteDialog.vue_vue_type_script_setup_true_lang-99c6c052.js";import{_ as Pe}from"./ModelDialog.vue_vue_type_script_setup_true_lang-c10f6af4.js";import{a as ll,F as tl}from"./form-aee596e2.js";import"./VAvatar-f16d5161.js";import"./index-7fb159ee.js";import"./VCheckboxBtn-c749bbe6.js";import"./userData-6708daee.js";import"./VForm-739155d1.js";import"./scopeId-ed5a3d54.js";var Ce=(f=>(f.PER_ROOM="PER_ROOM",f.PER_PERSON="PER_PERSON",f))(Ce||{});const al=O({__name:"AddTag",props:{convention:{},organisation:{}},emits:["save","close"],setup(f,{emit:r}){const a=y(""),d=y("");typeof f.convention=="object"?(a.value=f.convention.ConventionUUID,d.value=f.convention.OrganisationUUID):a.value=f.convention||"",typeof f.organisation=="object"?d.value=f.organisation.OrganisationUUID:d.value.length===0&&(d.value=f.organisation||"");const i=y({ID:0,TagUUID:q(),ConventionID:0,ConventionUUID:a.value||me,OrganisationID:0,OrganisationUUID:d.value||me,Title:"",Key:""}),u=B(),n=()=>{u.saveTag(i.value).then(t=>{t&&(i.value=t,r("save",t),r("close"))})};return(t,o)=>(c(),g(de,null,{default:l(()=>[e(oe,{dark:"",color:"primary"},{default:l(()=>[e(F,{icon:"",dark:"",onClick:o[0]||(o[0]=v=>r("close"))},{default:l(()=>[e(z,null,{default:l(()=>[C("mdi:mdi-close")]),_:1})]),_:1}),e(ue,null,{default:l(()=>[C("Add Tag")]),_:1}),e(ee),e(ve,null,{default:l(()=>[e(F,{variant:"text",onClick:n},{default:l(()=>[C(" Save ")]),_:1})]),_:1})]),_:1}),e(ce,null,{default:l(()=>[e(G,{fluid:!0},{default:l(()=>[e(N,null,{default:l(()=>[e(_,{cols:"12"},{default:l(()=>[e(S,{label:I(R).formLabelDisplayName,type:"text",variant:"outlined",modelValue:i.value.Title,"onUpdate:modelValue":o[1]||(o[1]=v=>i.value.Title=v)},null,8,["label","modelValue"])]),_:1}),e(_,{cols:"12"},{default:l(()=>[e(S,{label:I(R).formLabelTagKey,type:"text",variant:"outlined",modelValue:i.value.Key,"onUpdate:modelValue":o[2]||(o[2]=v=>i.value.Key=v)},null,8,["label","modelValue"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}))}}),ne=O({__name:"SelectTags",props:x({convention:{},organisation:{},chips:{type:Boolean,default:!1},clearable:{type:Boolean,default:!1},hint:{default:""},label:{},variant:{}},{modelValue:{required:!0}}),emits:x(["change"],["update:modelValue"]),setup(f,{emit:r}){const a=M(f,"modelValue"),d=y([]),i=B(),u=y([]),n=y([]),t=y(""),o=y(""),v=y(0),m=W(()=>[...u.value,...n.value].map(D=>({title:D.Title,value:d.value.find(b=>b.TagUUID===D.TagUUID)||D})));typeof f.convention=="object"?(t.value=f.convention.ConventionUUID,o.value=f.convention.OrganisationUUID):t.value=f.convention||"",typeof f.organisation=="object"?o.value=f.organisation.OrganisationUUID:o.value.length===0&&(o.value=f.organisation||""),(async()=>{const T=[];t.value&&T.push(i.getConventionTags(t.value)),o.value&&T.push(i.getOrganisationTags(o.value));const D=await Promise.all(T);if(t.value&&o.value?(n.value=D[0].sort((b,k)=>b.Title.localeCompare(k.Title)),u.value=D[1].sort((b,k)=>b.Title.localeCompare(k.Title))):t.value&&D.length==1?n.value=D[0].sort((b,k)=>b.Title.localeCompare(k.Title)):o.value&&D.length==1&&(u.value=D[0].sort((b,k)=>b.Title.localeCompare(k.Title))),Array.isArray(a.value))v.value=2,m.value.forEach(b=>{Array.isArray(a.value)&&a.value.find(w=>w.TagUUID===b.value.TagUUID)&&d.value.push(b.value)});else if(typeof a.value=="string"){v.value=1;try{const b=JSON.parse(a.value);m.value.forEach(k=>{b.find(Y=>Y.TagUUID===k.value.TagUUID)&&d.value.push(k.value)})}catch{}}})();const s=y(!1),p=()=>{s.value=!0},V=T=>{T.ConventionUUID.length>0?n.value.push(T):T.OrganisationUUID.length>0&&u.value.push(T),d.value.push(T),U()},U=()=>{switch(v.value){default:case 2:{a.value=d.value,r("change");break}case 1:{a.value=JSON.stringify(d.value),r("change");break}}};return J(d,U),(T,D)=>(c(),E($,null,[e(Oe,{modelValue:d.value,"onUpdate:modelValue":D[1]||(D[1]=b=>d.value=b),chips:T.chips,multiple:"",label:T.label||"Tags",variant:T.variant||"solo",hint:T.hint,"persistent-hint":!0,clearable:T.clearable,items:m.value,"item-title":"title","item-value":"value"},{"prepend-item":l(()=>[e(te,{title:"New Tag",onClick:D[0]||(D[0]=b=>p())},{prepend:l(()=>[e(z,{icon:"mdi:mdi-plus"})]),_:1}),e(Ae,{class:"mt-2"})]),_:1},8,["modelValue","chips","label","variant","hint","clearable","items"]),e(pe,{modelValue:s.value,"onUpdate:modelValue":D[3]||(D[3]=b=>s.value=b),scrollable:!0},{default:l(()=>[e(al,{convention:T.convention,organisation:T.organisation,onClose:D[2]||(D[2]=b=>s.value=!1),onSave:V},null,8,["convention","organisation"])]),_:1},8,["modelValue"])],64))}}),ol=O({__name:"EditConventionExtraOptions",props:x({convention:{}},{modelValue:{}}),emits:x(["close"],["update:modelValue"]),setup(f,{emit:r}){const a=M(f,"modelValue"),d=y(j(a.value)),i=()=>{a.value=d.value,r("close")};return(u,n)=>(c(),g(de,null,{default:l(()=>[e(oe,{dark:"",color:"primary"},{default:l(()=>[e(F,{icon:"",dark:"",onClick:n[0]||(n[0]=t=>r("close"))},{default:l(()=>[e(z,null,{default:l(()=>[C("mdi:mdi-close")]),_:1})]),_:1}),e(ue,null,{default:l(()=>[C("Edit Option Choice")]),_:1}),e(ee),e(ve,null,{default:l(()=>[e(F,{variant:"text",onClick:i},{default:l(()=>[C(" Apply ")]),_:1})]),_:1})]),_:1}),e(ce,{class:"pa-0"},{default:l(()=>[e(G,null,{default:l(()=>[e(S,{label:I(R).formLabelName,type:"text",variant:"outlined",modelValue:d.value.Name,"onUpdate:modelValue":n[1]||(n[1]=t=>d.value.Name=t)},null,8,["label","modelValue"]),e(S,{label:I(R).formLabelDescription,type:"text",variant:"outlined",modelValue:d.value.Description,"onUpdate:modelValue":n[2]||(n[2]=t=>d.value.Description=t)},null,8,["label","modelValue"]),e(S,{label:I(R).formLabelPrice,type:"text",variant:"outlined","prepend-icon":I(R).currencyIcon,modelValue:d.value.Price,"onUpdate:modelValue":n[3]||(n[3]=t=>d.value.Price=t),modelModifiers:{number:!0},hint:"Adds additional charges for selecting this option"},null,8,["label","prepend-icon","modelValue"]),d.value.Choices?(c(),g(ne,{key:0,modelValue:d.value.Choices,"onUpdate:modelValue":n[4]||(n[4]=t=>d.value.Choices=t),convention:u.convention,hint:"Sub-options (tags) that a user may choose from."},null,8,["modelValue","convention"])):A("",!0)]),_:1})]),_:1})]),_:1}))}}),nl=h("h3",null,"Options",-1),ul=O({__name:"EditConventionExtra",props:x({convention:{}},{modelValue:{required:!0}}),emits:["update:modelValue"],setup(f){const r=M(f,"modelValue"),a=y(j(r.value)),d=y(!1),i=y(0),u=B(),n=y([""]),t=y([]),o=y([]);f.convention&&(u.getConventionTags(f.convention.ConventionUUID).then(U=>{o.value=U.sort((T,D)=>T.Title.localeCompare(D.Title))}),u.getOrganisationTags(f.convention.OrganisationUUID).then(U=>{t.value=U.sort((T,D)=>T.Title.localeCompare(D.Title))}));const v=W(()=>[...t.value,...o.value]),m=({callback:U})=>{u.saveExtra(a.value).then(T=>{T?(r.value=T,U&&U("Extra Saved")):U&&U("Failed to Save Extra")}).catch(()=>{U&&U("Failed to Save Extra")})},s=U=>{var T;U.Options||(U.Options=[]),U.Options.push({ID:0,OptionUUID:q(),ExtraID:U.ID,ExtraUUID:U.ExtraUUID,Order:((T=U.Options)==null?void 0:T.length)+1,Name:"",Description:"",Price:0,Choices:[]})},p=(U,T)=>{U.Options&&U.Options.splice(T,1)},V=U=>{if(U.Choices&&U.Choices.length>0)return U.Choices.map(T=>{const D=v.value.find(b=>b.TagUUID===T.TagUUID);if(D)return D.Title}).join(", ")};return(U,T)=>(c(),E($,null,[e(G,{class:"px-0"},{default:l(()=>[e(S,{label:I(R).formLabelName,type:"text",variant:"outlined",modelValue:a.value.Name,"onUpdate:modelValue":T[0]||(T[0]=D=>a.value.Name=D)},null,8,["label","modelValue"]),e(S,{label:I(R).formLabelDescription,type:"text",variant:"outlined",modelValue:a.value.Description,"onUpdate:modelValue":T[1]||(T[1]=D=>a.value.Description=D)},null,8,["label","modelValue"]),e(ne,{modelValue:a.value.AppliesTags,"onUpdate:modelValue":T[2]||(T[2]=D=>a.value.AppliesTags=D),convention:U.convention,organisation:U.convention.OrganisationUUID,hint:"Tags a user acquires by selecting any option within this addon purchase."},null,8,["modelValue","convention","organisation"]),nl,e(ke,{opened:n.value,"onUpdate:opened":T[3]||(T[3]=D=>n.value=D)},{default:l(()=>[(c(!0),E($,null,K(a.value.Options,(D,b)=>(c(),E($,{key:D.ID},[D?(c(),g(te,{key:0,"prepend-icon":"mdi:mdi-ticket-percent",title:`${D.Name} ${D.Price&&D.Price>0?`(${I(R).currencySymbol}${D.Price})`:""}`},{append:l(()=>[e(F,{color:"red",icon:"mdi:mdi-close",size:"x-small",class:"mr-1",onClick:k=>p(a.value,b)},null,8,["onClick"]),e(F,{color:"primary",icon:"mdi:mdi-pencil",size:"x-small",onClick:k=>{d.value=!0,i.value=b}},null,8,["onClick"])]),default:l(()=>[D.Choices&&D.Choices.length>0?(c(),g(le,{key:0},{default:l(()=>[C(" Options: "+P(V(D)),1)]),_:2},1024)):A("",!0)]),_:2},1032,["title"])):A("",!0)],64))),128))]),_:1},8,["opened"]),e(F,{color:"primary",onClick:T[4]||(T[4]=D=>s(a.value))},{default:l(()=>[C("Add Option")]),_:1}),e(N,null,{default:l(()=>[e(_,{class:"text-right"},{default:l(()=>[e(Q,{onClick:m})]),_:1})]),_:1})]),_:1}),e(pe,{modelValue:d.value,"onUpdate:modelValue":T[7]||(T[7]=D=>d.value=D),scrollable:""},{default:l(()=>[e(ol,{modelValue:a.value.Options[i.value],"onUpdate:modelValue":T[5]||(T[5]=D=>a.value.Options[i.value]=D),convention:U.convention,onClose:T[6]||(T[6]=D=>d.value=!1)},null,8,["modelValue","convention"])]),_:1},8,["modelValue"])],64))}}),il=O({__name:"EditConventionExtras",props:x({convention:{}},{modelValue:{required:!0}}),emits:x(["close"],["update:modelValue"]),setup(f,{emit:r}){const a=M(f,"modelValue"),d=B(),i=()=>{const t={ID:0,ExtraUUID:q(),ConventionID:f.convention.ID,ConventionUUID:f.convention.ConventionUUID,Order:a.value.length+1,Name:"New Extra",Description:"",AppliesTags:[],Options:[]};d.saveExtra(t).then(o=>{o&&a.value.push(o)})},u=t=>{d.deleteExtra(a.value[t].ExtraUUID).then(o=>{o&&a.value.splice(t,1)})},n=(...t)=>{t.forEach(o=>{o>=0&&o<a.value.length&&d.saveExtra(a.value[o])})};return(t,o)=>(c(),g(de,null,{default:l(()=>[e(oe,{dark:"",color:"primary"},{default:l(()=>[e(F,{icon:"",dark:"",onClick:o[0]||(o[0]=v=>r("close"))},{default:l(()=>[e(z,null,{default:l(()=>[C("mdi:mdi-close")]),_:1})]),_:1}),e(ue,null,{default:l(()=>[C("Edit Extras")]),_:1}),e(ee),e(ve,null,{default:l(()=>[e(F,{variant:"text",onClick:i},{default:l(()=>[C(" Add ")]),_:1})]),_:1})]),_:1}),e(ce,{class:"pa-0"},{default:l(()=>[e(fe,null,{default:l(()=>[(c(!0),E($,null,K(a.value,(v,m)=>(c(),g(Ve,{key:v.ID,class:"mt-0"},{default:l(()=>[e(Ue,null,{actions:l(({expanded:s})=>[e(F,{icon:"mdi:mdi-close",size:"x-small",color:"red",class:"mr-1",onClick:p=>u(m)},null,8,["onClick"]),e(z,{class:"align-self-center text-h5",icon:s?"mdi:mdi-chevron-up":"mdi:mdi-chevron-down",variant:"flat",size:"x-small"},null,8,["icon"])]),default:l(()=>[e(F,{icon:"mdi:mdi-menu-up",size:"x-small",color:"primary",class:"mr-1",onClick:re(s=>{I(Ne)(v,a.value),n(m,m-1)},["stop"])},null,8,["onClick"]),e(F,{icon:"mdi:mdi-menu-down",size:"x-small",color:"secondary",class:"mr-4",onClick:re(s=>{I(Se)(v,a.value),n(m,m+1)},["stop"])},null,8,["onClick"]),C(" "+P(v.Name)+" ",1)]),_:2},1024),e(Te,{class:"px-0"},{default:l(()=>[e(ul,{convention:t.convention,modelValue:a.value[m],"onUpdate:modelValue":s=>a.value[m]=s},null,8,["convention","modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1}))}}),dl=h("h3",null,"Additional Purchases",-1),sl=h("p",null,"These are global ticket addons that are not tied to any particular ticket type.",-1),rl=O({__name:"Extras",props:{modelValue:{required:!0}},emits:["update:modelValue"],setup(f){const r=M(f,"modelValue"),a=y([]),d=B(),i=y([""]),u=y(!1),n=o=>{if(o.Choices&&o.Choices.length>0)return o.Choices.map(v=>v.Title).join(", ")},t=()=>{u.value=!1};return d==null||d.getConventionExtras(r.value.ConventionUUID||"").then(o=>{o&&(a.value=o)}),(o,v)=>(c(),E($,null,[e(G,{fluid:!0,class:"px-0"},{default:l(()=>[e(N,null,{default:l(()=>[e(_,null,{default:l(()=>[dl]),_:1}),e(_,{class:"text-right"},{default:l(()=>[e(F,{color:"primary",onClick:v[0]||(v[0]=m=>u.value=!0)},{default:l(()=>[C("Edit")]),_:1})]),_:1})]),_:1})]),_:1}),sl,e(ke,{opened:i.value,"onUpdate:opened":v[1]||(v[1]=m=>i.value=m)},{default:l(()=>[(c(!0),E($,null,K(a.value,m=>(c(),g(Fe,{key:m.ID,value:m.ID},{activator:l(({props:s})=>[e(te,he(s,{"prepend-icon":"mdi:mdi-group",title:m.Name}),null,16,["title"])]),default:l(()=>[m.Options?(c(!0),E($,{key:0},K(m.Options,s=>(c(),g(te,{key:s.ID,"prepend-icon":"mdi:mdi-ticket-percent",title:`${s.Name} ${s.Price&&s.Price>0?`(${I(R).currencySymbol}${s.Price})`:""}`},{default:l(()=>[s.Choices&&s.Choices.length>0?(c(),g(le,{key:0},{default:l(()=>[C(" Options: "+P(n(s)),1)]),_:2},1024)):A("",!0)]),_:2},1032,["title"]))),128)):A("",!0)]),_:2},1032,["value"]))),128))]),_:1},8,["opened"]),e(pe,{modelValue:u.value,"onUpdate:modelValue":v[3]||(v[3]=m=>u.value=m),scrollable:!0},{default:l(()=>[e(il,{modelValue:a.value,"onUpdate:modelValue":v[2]||(v[2]=m=>a.value=m),convention:r.value,onClose:t},null,8,["modelValue","convention"])]),_:1},8,["modelValue"])],64))}}),ml=O({__name:"EditConventionInterest",props:x({convention:{}},{modelValue:{required:!0}}),emits:["update:modelValue"],setup(f){const r=M(f,"modelValue"),a=y(j(r.value)),d=B(),i=({callback:u})=>{d.saveInterest(a.value).then(n=>{n?(r.value=n,u&&u("Interest Saved")):u&&u("Failed to Save Interest")}).catch(()=>{u&&u("Failed to Save Interest")})};return(u,n)=>(c(),g(G,{class:"px-0"},{default:l(()=>[e(S,{label:I(R).formLabelName,type:"text",variant:"outlined",modelValue:a.value.Name,"onUpdate:modelValue":n[0]||(n[0]=t=>a.value.Name=t)},null,8,["label","modelValue"]),e(Ie,{label:I(R).formLabelDescription,type:"text",variant:"outlined",modelValue:a.value.Description,"onUpdate:modelValue":n[1]||(n[1]=t=>a.value.Description=t)},null,8,["label","modelValue"]),A("",!0),e(ne,{modelValue:a.value.AppliesTags,"onUpdate:modelValue":n[3]||(n[3]=t=>a.value.AppliesTags=t),convention:u.convention,organisation:u.convention.OrganisationUUID,hint:"Tags that a user acquires by selecting this interest."},null,8,["modelValue","convention","organisation"]),e(N,null,{default:l(()=>[e(_,{class:"text-right"},{default:l(()=>[e(Q,{onClick:i})]),_:1})]),_:1})]),_:1}))}}),vl=O({__name:"EditConventionInterests",props:x({convention:{}},{modelValue:{required:!0}}),emits:x(["close"],["update:modelValue"]),setup(f,{emit:r}){const a=M(f,"modelValue"),d=B(),i=()=>{const t={ID:0,InterestUUID:q(),ConventionID:f.convention.ID,ConventionUUID:f.convention.ConventionUUID,Order:a.value.length+1,Name:"New Interest",Description:"",Price:0,AppliesTags:[]};d.saveInterest(t).then(o=>{o&&a.value.push(o)})},u=t=>{d.deleteInterest(a.value[t].InterestUUID).then(o=>{o&&a.value.splice(t,1)})},n=(...t)=>{t.forEach(o=>{o>=0&&o<a.value.length&&d.saveInterest(a.value[o])})};return(t,o)=>(c(),g(de,null,{default:l(()=>[e(oe,{dark:"",color:"primary"},{default:l(()=>[e(F,{icon:"",dark:"",onClick:o[0]||(o[0]=v=>r("close"))},{default:l(()=>[e(z,null,{default:l(()=>[C("mdi:mdi-close")]),_:1})]),_:1}),e(ue,null,{default:l(()=>[C("Edit Interests")]),_:1}),e(ee),e(ve,null,{default:l(()=>[e(F,{variant:"text",onClick:i},{default:l(()=>[C(" Add ")]),_:1})]),_:1})]),_:1}),e(ce,{class:"pa-0"},{default:l(()=>[e(fe,null,{default:l(()=>[(c(!0),E($,null,K(a.value,(v,m)=>(c(),g(Ve,{key:v.ID,class:"mt-0"},{default:l(()=>[e(Ue,null,{actions:l(({expanded:s})=>[e(Q,{class:"mr-1",color:"red",icon:"mdi:mdi-close",size:"x-small",onClick:p=>u(m)},null,8,["onClick"]),e(z,{class:"align-self-center text-h5",icon:s?"mdi:mdi-chevron-up":"mdi:mdi-chevron-down",variant:"flat",size:"x-small"},null,8,["icon"])]),default:l(()=>[e(F,{icon:"mdi:mdi-menu-up",size:"x-small",color:"primary",class:"mr-1",onClick:re(s=>{I(Ne)(v,a.value),n(m,m-1)},["stop"])},null,8,["onClick"]),e(F,{icon:"mdi:mdi-menu-down",size:"x-small",color:"secondary",class:"mr-4",onClick:re(s=>{I(Se)(v,a.value),n(m,m+1)},["stop"])},null,8,["onClick"]),C(" "+P(v.Name)+" ",1)]),_:2},1024),e(Te,{class:"px-0"},{default:l(()=>[e(ml,{convention:t.convention,modelValue:a.value[m],"onUpdate:modelValue":s=>a.value[m]=s},null,8,["convention","modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1}))}}),cl=h("h3",null,"Interests",-1),pl=h("p",null,"Attendees can tag themselves for particular things.",-1),fl=O({__name:"Interests",props:{modelValue:{required:!0}},emits:x(["refresh"],["update:modelValue"]),setup(f){const r=M(f,"modelValue"),a=B(),d=y([]);a.getConventionInterests(r.value.ConventionUUID).then(n=>{Re(n),d.value=n});const i=y([""]),u=y(!1);return(n,t)=>(c(),E($,null,[e(G,{fluid:!0,class:"px-0"},{default:l(()=>[e(N,null,{default:l(()=>[e(_,null,{default:l(()=>[cl]),_:1}),e(_,{class:"text-right"},{default:l(()=>[e(F,{color:"primary",onClick:t[0]||(t[0]=o=>u.value=!0)},{default:l(()=>[C("Edit")]),_:1})]),_:1})]),_:1})]),_:1}),pl,e(ke,{opened:i.value,"onUpdate:opened":t[1]||(t[1]=o=>i.value=o)},{default:l(()=>[(c(!0),E($,null,K(d.value,o=>(c(),g(te,{key:o.ID,"prepend-icon":"mdi:mdi-checkbox-marked-outline",title:`${o.Name} ${o.Price&&o.Price>0?`(${I(R).currencySymbol}${o.Price})`:""}`},{default:l(()=>[o.Description?(c(),g(le,{key:0},{default:l(()=>[C(P(o.Description),1)]),_:2},1024)):A("",!0)]),_:2},1032,["title"]))),128))]),_:1},8,["opened"]),e(pe,{modelValue:u.value,"onUpdate:modelValue":t[4]||(t[4]=o=>u.value=o),scrollable:!0},{default:l(()=>[e(vl,{onClose:t[2]||(t[2]=o=>u.value=!1),convention:r.value,modelValue:d.value,"onUpdate:modelValue":t[3]||(t[3]=o=>d.value=o)},null,8,["convention","modelValue"])]),_:1},8,["modelValue"])],64))}}),_e=O({__name:"SelectTickets",props:x({chips:{type:Boolean,default:!1},clearable:{type:Boolean,default:!1},hint:{default:"Tickets that belong to this group."},label:{default:"Tickets"},persistentHint:{type:Boolean,default:!1},tickets:{default:()=>[]},variant:{}},{modelValue:{required:!0}}),emits:["update:modelValue"],setup(f){const r=M(f,"modelValue"),a=i=>i.Type===L.TICKET_TYPE_GROUP?"mdi:mdi-group":i.Type===L.TICKET_TYPE_TICKET?i.RequiresAccommodation?"mdi:mdi-home":i.ComponentsRequired>0?"mdi:mdi-ticket-confirmation":"mdi:mdi-ticket":i.Type===L.TICKET_TYPE_TICKET_COMPONENT?"mdi:mdi-cog-outline":i.Type===L.TICKET_TYPE_ADD_ON?"mdi:mdi-home-plus":"mdi:mdi-help",d=W(()=>f.tickets.map(i=>({title:i.Name,value:r.value.find(u=>u&&u.TicketUUID===i.TicketUUID)||i,props:{appendIcon:a(i)}})));return(i,u)=>(c(),E("div",null,[e(Oe,{label:i.label,variant:i.variant||"filled",items:d.value,"item-title":"title","item-value":"value","item-props":"props",modelValue:r.value,"onUpdate:modelValue":u[0]||(u[0]=n=>r.value=n),hint:i.hint,chips:i.chips,clearable:i.clearable,multiple:"","persistent-hint":i.persistentHint},null,8,["label","variant","items","modelValue","hint","chips","clearable","persistent-hint"])]))}}),Vl=h("p",{title:"Automatically calculated",class:"text-grey-lighten-1"},"Applicable Accommodation:",-1),Ul=O({__name:"EditConventionTicket",props:x({accommodation:{default:()=>[]},convention:{},tickets:{default:()=>[]}},{modelValue:{required:!0}}),emits:["update:modelValue"],setup(f){const r=M(f,"modelValue"),a=y(j(r.value)),d=B(),i=W(()=>f.tickets.filter(v=>v.Type===L.TICKET_TYPE_TICKET)),u=W(()=>f.tickets.filter(v=>v.Type===L.TICKET_TYPE_ADD_ON)),n=W(()=>f.tickets.filter(v=>v.Type===L.TICKET_TYPE_TICKET_COMPONENT)),t=v=>f.accommodation.filter(m=>m.Costs.find(s=>s.DateStart===v.DateStart&&s.DateEnd===v.DateEnd)),o=({callback:v})=>{d.saveTicket(a.value).then(m=>{m?(a.value.ID=m.ID,a.value.TicketUUID=m.TicketUUID,r.value=a.value,v&&v("Ticket Saved")):v&&v("Failed to Save Ticket")}).catch(()=>{v&&v("Failed to Save Ticket")})};return(v,m)=>(c(),g(G,{class:"px-0",fluid:""},{default:l(()=>[e(N,null,{default:l(()=>[e(_,{cols:"12"},{default:l(()=>[e(se,{label:"Ticket Type",variant:"outlined",modelValue:a.value.Type,"onUpdate:modelValue":m[0]||(m[0]=s=>a.value.Type=s),items:I(ze),"item-title":"title","item-value":"value","hide-details":""},null,8,["modelValue","items"])]),_:1}),e(_,{cols:"12"},{default:l(()=>[e(S,{label:I(R).formLabelName,type:"text",variant:"outlined",modelValue:a.value.Name,"onUpdate:modelValue":m[1]||(m[1]=s=>a.value.Name=s),"hide-details":""},null,8,["label","modelValue"])]),_:1}),e(_,{cols:"12"},{default:l(()=>[e(S,{label:I(R).formLabelDescription,type:"text",variant:"outlined",modelValue:a.value.Description,"onUpdate:modelValue":m[2]||(m[2]=s=>a.value.Description=s),"hide-details":""},null,8,["label","modelValue"])]),_:1}),a.value.Type!==I(L).TICKET_TYPE_GROUP?(c(),E($,{key:0},[e(_,{cols:"12"},{default:l(()=>[e(Z,{label:I(R).formLabelRequiresAccommodation,modelValue:a.value.RequiresAccommodation,"onUpdate:modelValue":m[3]||(m[3]=s=>a.value.RequiresAccommodation=s),"hide-details":""},null,8,["label","modelValue"])]),_:1}),e(_,{cols:"12"},{default:l(()=>[e(S,{label:I(R).formLabelDateStart,type:"date",variant:"outlined",modelValue:a.value.DateStart,"onUpdate:modelValue":m[4]||(m[4]=s=>a.value.DateStart=s),"hide-details":""},null,8,["label","modelValue"])]),_:1}),e(_,{cols:"12"},{default:l(()=>[e(S,{label:I(R).formLabelDateEnd,type:"date",variant:"outlined",modelValue:a.value.DateEnd,"onUpdate:modelValue":m[5]||(m[5]=s=>a.value.DateEnd=s),"hide-details":""},null,8,["label","modelValue"])]),_:1}),e(_,{cols:"12"},{default:l(()=>[e(S,{label:I(R).formLabelPrice,type:"text",variant:"outlined","prepend-inner-icon":I(R).currencyIcon,modelValue:a.value.Price,"onUpdate:modelValue":m[6]||(m[6]=s=>a.value.Price=s),"persistent-hint":"",hint:"Adds additional charges for selecting this ticket"},null,8,["label","prepend-inner-icon","modelValue"])]),_:1})],64)):(c(),g(_,{key:1,cols:"12"},{default:l(()=>[e(_e,{label:"Tickets",variant:"outlined",tickets:i.value,modelValue:a.value.Tickets,"onUpdate:modelValue":m[7]||(m[7]=s=>a.value.Tickets=s),chips:"",clearable:"",multiple:"","persistent-hint":"",hint:"Tickets that belong to this group."},null,8,["tickets","modelValue"])]),_:1})),e(_,{cols:"12"},{default:l(()=>[e(ne,{label:"Applied Tags",variant:"outlined",modelValue:a.value.AppliesTags,"onUpdate:modelValue":m[8]||(m[8]=s=>a.value.AppliesTags=s),convention:v.convention,organisation:v.convention.OrganisationUUID,chips:"",clearable:"",hint:"Tags that a user acquires by selecting this ticket."},null,8,["modelValue","convention","organisation"])]),_:1}),e(_,{cols:"12"},{default:l(()=>[e(ne,{label:"Required Tags",variant:"outlined",modelValue:a.value.RequiredTags,"onUpdate:modelValue":m[9]||(m[9]=s=>a.value.RequiredTags=s),convention:v.convention,organisation:v.convention.OrganisationUUID,chips:"",clearable:"",hint:"Tags that a user must have to see this ticket."},null,8,["modelValue","convention","organisation"])]),_:1}),a.value.Type===I(L).TICKET_TYPE_TICKET?(c(),E($,{key:2},[e(_,{cols:"12"},{default:l(()=>[e(S,{label:"Components Required",type:"number",variant:"outlined",modelValue:a.value.ComponentsRequired,"onUpdate:modelValue":m[10]||(m[10]=s=>a.value.ComponentsRequired=s),modelModifiers:{number:!0},"persistent-hint":"",hint:"How many components must be selected."},null,8,["modelValue"])]),_:1}),e(_,{cols:"12"},{default:l(()=>[e(_e,{label:"Components",variant:"outlined",tickets:n.value,modelValue:a.value.TicketComponents,"onUpdate:modelValue":m[11]||(m[11]=s=>a.value.TicketComponents=s),chips:"",clearable:"",multiple:"","persistent-hint":"",hint:"Components that are part of this ticket (and others)."},null,8,["tickets","modelValue"])]),_:1}),e(_,{cols:"12"},{default:l(()=>[e(_e,{label:"Addons",variant:"outlined",tickets:u.value,modelValue:a.value.AddonTickets,"onUpdate:modelValue":m[12]||(m[12]=s=>a.value.AddonTickets=s),chips:"",clearable:"",multiple:"","persistent-hint":"",hint:"Optional ticket addons that apply for this ticket."},null,8,["tickets","modelValue"])]),_:1})],64)):A("",!0),e(_,{cols:"12"},{default:l(()=>[e(_e,{label:"Disables Tickets",variant:"outlined",tickets:v.tickets,modelValue:a.value.DisablesTickets,"onUpdate:modelValue":m[13]||(m[13]=s=>a.value.DisablesTickets=s),chips:"",clearable:"",multiple:"","persistent-hint":"",hint:"Tickets that are mutually exclusive and can't be selected if this one is."},null,8,["tickets","modelValue"])]),_:1})]),_:1}),t(a.value).length?(c(),g(N,{key:0,class:"align-center",dense:!0},{default:l(()=>[e(_,{class:"flex-grow-0 flex-shrink-1 text-no-wrap font-italic"},{default:l(()=>[Vl]),_:1}),e(_,{class:"flex-grow-1"},{default:l(()=>[e(Me,null,{default:l(()=>[(c(!0),E($,null,K(t(a.value),s=>(c(),g(Le,{key:s.ID,title:"Automatically calculated",disabled:!0},{default:l(()=>[C(P(s.Name),1)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})):A("",!0),e(N,null,{default:l(()=>[e(_,{class:"text-right"},{default:l(()=>[e(Q,{onClick:o})]),_:1})]),_:1})]),_:1}))}}),Tl={class:"pr-2"},Dl={class:"mb-2"},Il={key:0,class:"text-grey-darken-1 font-italic"},_l={key:1,class:"text-red"},yl={key:0,class:"text-grey-darken-1 font-italic"},gl={key:1,class:"text-red"},Cl={key:0,class:"text-grey-darken-1 font-italic"},bl={key:1,class:"text-red"},kl={class:"text-grey-darken-1"},El=O({__name:"EditConventionTickets",props:x({accommodation:{default:()=>[]},convention:{}},{modelValue:{default:[]}}),emits:x(["close"],["update:modelValue"]),setup(f,{emit:r}){const a=M(f,"modelValue"),d=B(),i=()=>{a.value.push({ID:0,TicketUUID:q(),ConventionID:f.convention.ID,ConventionUUID:f.convention.ConventionUUID,Order:a.value.length+1,Name:"New Ticket",Type:L.TICKET_TYPE_GROUP,Description:"",DateStart:"",DateEnd:"",Price:0,Tickets:[],RequiresAccommodation:!1,AppliesTags:[],RequiredTags:[],RequiredGroupMemberships:[],TicketComponents:[],ComponentsRequired:0,AddonTickets:[],DisablesTickets:[]})},u=t=>{d.deleteTicket(a.value[t].TicketUUID).then(o=>{o&&a.value.splice(t,1)})},n=t=>t.Type===L.TICKET_TYPE_GROUP?"mdi:mdi-group":t.Type===L.TICKET_TYPE_TICKET?t.RequiresAccommodation?"mdi:mdi-home":t.ComponentsRequired>0?"mdi:mdi-ticket-confirmation":"mdi:mdi-ticket":t.Type===L.TICKET_TYPE_TICKET_COMPONENT?"mdi:mdi-cog-outline":t.Type===L.TICKET_TYPE_ADD_ON?"mdi:mdi-home-plus":"mdi:mdi-help";return(t,o)=>(c(),g(de,null,{default:l(()=>[e(oe,{dark:"",color:"primary"},{default:l(()=>[e(F,{icon:"",dark:"",onClick:o[0]||(o[0]=v=>r("close"))},{default:l(()=>[e(z,null,{default:l(()=>[C("mdi:mdi-close")]),_:1})]),_:1}),e(ue,null,{default:l(()=>[C("Edit Tickets")]),_:1}),e(ee),e(ve,null,{default:l(()=>[e(F,{variant:"text",onClick:i},{default:l(()=>[C(" Add Ticket ")]),_:1})]),_:1})]),_:1}),e(ce,{class:"pa-0"},{default:l(()=>[e(fe,null,{default:l(()=>[(c(!0),E($,null,K(a.value,(v,m)=>(c(),g(Ve,{key:v.ID,class:"mt-0"},{default:l(()=>[e(Ue,{class:"py-2"},{actions:l(({expanded:s})=>[e(Q,{class:"mr-1",color:"red",icon:"mdi:mdi-close",size:"x-small",onClick:p=>u(m)},null,8,["onClick"]),e(z,{class:"align-self-center text-h5",icon:s?"mdi:mdi-chevron-up":"mdi:mdi-chevron-down",variant:"flat",size:"x-small"},null,8,["icon"])]),default:l(()=>[e(F,{icon:"mdi:mdi-menu-up",size:"x-small",color:"primary",class:"mr-1",onClick:re(s=>I(Ne)(v,a.value),["stop"])},null,8,["onClick"]),e(F,{icon:"mdi:mdi-menu-down",size:"x-small",color:"secondary",class:"mr-4",onClick:re(s=>I(Se)(v,a.value),["stop"])},null,8,["onClick"]),h("div",Tl,[e(z,{icon:n(v)},null,8,["icon"])]),h("div",null,[h("p",Dl,[C(P(v.Name)+" ",1),v.Type===I(L).TICKET_TYPE_TICKET?(c(),E($,{key:0},[a.value.find(s=>s.Type===I(L).TICKET_TYPE_GROUP&&s.Tickets.find(p=>p&&p.TicketUUID===v.TicketUUID))?(c(),E("span",Il," ("+P(a.value.filter(s=>s.Type===I(L).TICKET_TYPE_GROUP&&s.Tickets.find(p=>p&&p.TicketUUID===v.TicketUUID)).map(s=>s.Name).join(", "))+") ",1)):(c(),E("span",_l," (Ticket does not belong to any categories.) "))],64)):A("",!0),v.Type===I(L).TICKET_TYPE_ADD_ON?(c(),E($,{key:1},[a.value.find(s=>s.Type===I(L).TICKET_TYPE_TICKET&&s.AddonTickets.find(p=>p&&p.TicketUUID===v.TicketUUID))?(c(),E("span",yl," ("+P(a.value.filter(s=>s.Type===I(L).TICKET_TYPE_TICKET&&s.AddonTickets.find(p=>p&&p.TicketUUID===v.TicketUUID)).map(s=>s.Name).join(", "))+") ",1)):(c(),E("span",gl," (Ticket addon must be associated to at least one ticket.) "))],64)):A("",!0),v.Type===I(L).TICKET_TYPE_TICKET_COMPONENT?(c(),E($,{key:2},[a.value.find(s=>s.Type===I(L).TICKET_TYPE_TICKET&&s.TicketComponents.find(p=>p&&p.TicketUUID===v.TicketUUID))?(c(),E("span",Cl," ("+P(a.value.filter(s=>s.Type===I(L).TICKET_TYPE_TICKET&&s.TicketComponents.find(p=>p&&p.TicketUUID===v.TicketUUID)).map(s=>s.Name).join(", "))+") ",1)):(c(),E("span",bl," (Component has not been assigned to any tickets.) "))],64)):A("",!0)]),h("p",kl,[v.Type===I(L).TICKET_TYPE_GROUP?(c(),E($,{key:0},[C("Category")],64)):v.Type===I(L).TICKET_TYPE_TICKET?(c(),E($,{key:1},[C(" Ticket "),v.ComponentsRequired>0?(c(),E($,{key:0},[C(" ("+P(v.ComponentsRequired)+" component"+P(v.ComponentsRequired>1?"s":"")+" required) ",1)],64)):A("",!0)],64)):A("",!0),v.Type===I(L).TICKET_TYPE_TICKET_COMPONENT?(c(),E($,{key:2},[C("Component")],64)):A("",!0),v.Type===I(L).TICKET_TYPE_ADD_ON?(c(),E($,{key:3},[C("Addon")],64)):A("",!0)])])]),_:2},1024),e(Te,{class:"px-0"},{default:l(()=>[e(Ul,{accommodation:t.accommodation,convention:t.convention,tickets:a.value,modelValue:a.value[m],"onUpdate:modelValue":s=>a.value[m]=s},null,8,["accommodation","convention","tickets","modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1}))}}),hl=h("h3",null,"Tickets",-1),$l=h("p",null,"Ticket options, along with all sub-types and options applicable to them.",-1),Fl=O({__name:"Tickets",props:{modelValue:{required:!0}},emits:x(["refresh"],["update:modelValue"]),setup(f){var s;const r=M(f,"modelValue"),a=B(),d=y([]),i=y([]);a.getConventionTickets(((s=r.value)==null?void 0:s.ConventionUUID)||"").then(p=>{Re(p),d.value=p});const u=y([""]),n=y(!1),t=p=>p.AddonTickets&&p.AddonTickets.map(V=>d.value&&d.value.find(U=>U.ID===V.ID)),o=p=>p.TicketComponents&&p.TicketComponents.map(V=>d.value&&d.value.find(U=>U.ID===V.ID)),v=p=>"",m=p=>i.value.filter(V=>V.Costs.find(U=>U.DateStart===p.DateStart&&U.DateEnd===p.DateEnd)).map(V=>V.Name).join(", ");return(p,V)=>(c(),E($,null,[e(G,{fluid:!0,class:"px-0"},{default:l(()=>[e(N,null,{default:l(()=>[e(_,null,{default:l(()=>[hl]),_:1}),e(_,{class:"text-right"},{default:l(()=>[e(F,{color:"primary",onClick:V[0]||(V[0]=U=>n.value=!0)},{default:l(()=>[C("Edit")]),_:1})]),_:1})]),_:1})]),_:1}),$l,e(ke,{opened:u.value,"onUpdate:opened":V[1]||(V[1]=U=>u.value=U)},{default:l(()=>[(c(!0),E($,null,K(d.value.filter(U=>U.Type===I(L).TICKET_TYPE_GROUP),U=>(c(),g(Fe,{key:U.ID,value:U.ID},{activator:l(({props:T})=>[e(te,he(T,{"prepend-icon":"mdi:mdi-group",title:U.Name}),null,16,["title"])]),default:l(()=>[(c(!0),E($,null,K(d.value.filter(T=>U.Tickets.find(D=>D&&T&&D.TicketUUID===T.TicketUUID)),T=>(c(),E($,{key:T.ID},[T.AddonTickets&&T.AddonTickets.length?(c(),g(Fe,{key:0,value:T.ID},{activator:l(({props:D})=>[e(te,he(D,{"prepend-icon":T.RequiresAccommodation?"mdi:mdi-home":T.ComponentsRequired>0?"mdi:mdi-ticket-confirmation":"mdi:mdi-ticket",title:`${T.Name} ${T.Price>0?`(${I(R).currencySymbol}${T.Price})`:""}`}),{default:l(()=>[T.ComponentsRequired>0?(c(),g(le,{key:0},{default:l(()=>[C(" Options: "+P(o(T).map(b=>b&&b.Name).join(", ")),1)]),_:2},1024)):A("",!0),T.RequiresAccommodation&&m(T)?(c(),g(le,{key:1},{default:l(()=>[C(" Accommodation: "+P(m(T)),1)]),_:2},1024)):A("",!0)]),_:2},1040,["prepend-icon","title"])]),default:l(()=>[(c(!0),E($,null,K(t(T),D=>(c(),E($,{key:D},[D?(c(),g(te,{key:0,title:`${D.Name} ${D.Price>0?`(${I(R).currencySymbol}${D.Price})`:""}`,"prepend-icon":"mdi:mdi-home-plus"},{default:l(()=>[D.RequiredTags&&D.RequiredTags.length>0?(c(),g(le,{key:0},{default:l(()=>[C(" Required Tags: "+P(D.RequiredTags.join(", ")),1)]),_:2},1024)):A("",!0),D.RequiredGroupMemberships&&D.RequiredGroupMemberships.length>0?(c(),g(le,{key:1},{default:l(()=>[C(" Required Groups: "+P(v(D.RequiredGroupMemberships)),1)]),_:2},1024)):A("",!0),m(D)?(c(),g(le,{key:2},{default:l(()=>[C(" Accommodation: "+P(m(D)),1)]),_:2},1024)):A("",!0)]),_:2},1032,["title"])):A("",!0)],64))),128))]),_:2},1032,["value"])):(c(),g(te,{key:1,"prepend-icon":T.RequiresAccommodation?"mdi:mdi-home":T.ComponentsRequired>0?"mdi:mdi-ticket-confirmation":"mdi:mdi-ticket",title:`${T.Name} ${T.Price>0?`(${I(R).currencySymbol}${T.Price})`:""}`},{default:l(()=>[T.ComponentsRequired>0?(c(),g(le,{key:0},{default:l(()=>[C(" Options: "+P(o(T).map(D=>D&&D.Name).join(", ")),1)]),_:2},1024)):A("",!0)]),_:2},1032,["prepend-icon","title"]))],64))),128))]),_:2},1032,["value"]))),128))]),_:1},8,["opened"]),e(pe,{modelValue:n.value,"onUpdate:modelValue":V[4]||(V[4]=U=>n.value=U),scrollable:!0},{default:l(()=>[e(El,{onClose:V[2]||(V[2]=U=>n.value=!1),modelValue:d.value,"onUpdate:modelValue":V[3]||(V[3]=U=>d.value=U),accommodation:i.value,convention:r.value},null,8,["modelValue","accommodation","convention"])]),_:1},8,["modelValue"])],64))}}),Nl=O({__name:"VenueRoomCost",props:{modelValue:{required:!0}},emits:x(["deleted"],["update:modelValue"]),setup(f,{emit:r}){const a=M(f,"modelValue"),d=[{title:"Per Room",value:"PER_ROOM"},{title:"Per Person",value:"PER_PERSON"}],i=()=>{r("deleted")};return(u,n)=>(c(),g(N,{dense:""},{default:l(()=>[e(_,{cols:"12",sm:"4",md:"2",lg:"2"},{default:l(()=>[e(S,{label:I(R).formLabelDateStart,type:"date",variant:"outlined",modelValue:a.value.DateStart,"onUpdate:modelValue":n[0]||(n[0]=t=>a.value.DateStart=t)},null,8,["label","modelValue"])]),_:1}),e(_,{cols:"12",sm:"4",md:"2",lg:"2"},{default:l(()=>[e(S,{label:I(R).formLabelDateEnd,type:"date",variant:"outlined",modelValue:a.value.DateEnd,"onUpdate:modelValue":n[1]||(n[1]=t=>a.value.DateEnd=t)},null,8,["label","modelValue"])]),_:1}),e(_,{cols:"6",sm:"4",md:"2",lg:"2"},{default:l(()=>[e(S,{label:I(R).formLabelAvailability,type:"number",variant:"outlined",modelValue:a.value.Availability,"onUpdate:modelValue":n[2]||(n[2]=t=>a.value.Availability=t),modelModifiers:{number:!0}},null,8,["label","modelValue"])]),_:1}),e(_,{cols:"6",sm:"4",md:"2",lg:"2"},{default:l(()=>[e(S,{label:I(R).formLabelPrice,type:"number","prepend-inner-icon":"mdi:mdi-currency-gbp",variant:"outlined",modelValue:a.value.Price,"onUpdate:modelValue":n[3]||(n[3]=t=>a.value.Price=t),modelModifiers:{number:!0}},null,8,["label","modelValue"])]),_:1}),e(_,{cols:"6",sm:"4",md:"3",lg:"3"},{default:l(()=>[e(se,{label:I(R).formLabelPriceType,variant:"outlined",modelValue:a.value.Type,"onUpdate:modelValue":n[4]||(n[4]=t=>a.value.Type=t),items:d,"item-value":"value","item-title":"title"},null,8,["label","modelValue"])]),_:1}),e(_,{cols:"6",sm:"4",md:"1",class:"text-right"},{default:l(()=>[e(F,{color:"red",icon:"mdi:mdi-minus",onClick:i})]),_:1})]),_:1}))}}),Sl=h("strong",null,"Capacity:",-1),Al=h("thead",null,[h("tr",null,[h("th",null,"Date"),h("th",null,"Price"),h("th",null,"Availability")])],-1),Pl={class:"d-flex flex-wrap justify-space-between",style:{gap:"1rem"}},xl=h("h4",null," Availability & Costs (To Organisation) ",-1),Rl=O({__name:"VenueRoom",props:{modelValue:{required:!0}},emits:x(["deleted"],["update:modelValue"]),setup(f,{emit:r}){const a=B(),d=y(R),i=M(f,"modelValue"),u=y(j(i.value)),n=y(!1),t=p=>{switch(p.Type){case Ce.PER_PERSON:return d.value.enumPER_PERSON;case Ce.PER_ROOM:return d.value.enumPER_ROOM}return"Unknown"},o=()=>{u.value.Costs||(u.value.Costs=[]),u.value.Costs.push({ID:0,CostUUID:q(),Availability:0,DateStart:"",DateEnd:"",Price:0,Type:"PER_ROOM"})},v=p=>{u.value.Costs.splice(p,1)},m=({callback:p})=>{const V=()=>{p&&p("Failed to Delete Room")},U=()=>{p&&p("Room Deleted")};a.deleteRoom(u.value.RoomUUID).then(T=>{T?(U(),r("deleted",u.value)):V()}).catch(()=>{V()})},s=()=>{a.saveRoom(u.value).then(()=>{i.value=u.value,n.value=!1})};return(p,V)=>(c(),E($,null,[e(G,{fluid:"",class:"pa-1 pa-sm-2"},{default:l(()=>[h("h4",null,P(u.value.Name),1),h("p",null,P(u.value.Notes),1),h("p",null,[Sl,C(" "+P(u.value.MinimumCapacity)+" ",1),u.value.MinimumCapacity!=u.value.MaximumCapacity?(c(),E($,{key:0},[C(" - "+P(u.value.MaximumCapacity),1)],64)):A("",!0)]),e(el,{density:"compact"},{default:l(()=>[Al,h("tbody",null,[(c(!0),E($,null,K(u.value.Costs,U=>(c(),E("tr",{key:`venue-room-${u.value.ID}-cost-${U.ID}`},[h("td",null,P(U.DateStart)+" - "+P(U.DateEnd),1),h("td",null,P(d.value.currencySymbol)+P(U.Price)+" "+P(t(U)),1),h("td",null,P(U.Availability),1)]))),128))])]),_:1}),h("div",Pl,[e(F,{color:"primary","prepend-icon":"mdi:mdi-playlist-edit",onClick:V[0]||(V[0]=U=>n.value=!0)},{default:l(()=>[C("Edit Room")]),_:1}),e(Q,{color:"red-darken-3","prepend-icon":"mdi:mdi-minus",onClick:m},{default:l(()=>[C("Delete Room")]),_:1})])]),_:1}),e(pe,{scrollable:"",modelValue:n.value,"onUpdate:modelValue":V[6]||(V[6]=U=>n.value=U),width:"auto"},{default:l(()=>[e(de,null,{default:l(()=>[e(oe,{dark:"",color:"primary"},{default:l(()=>[e(F,{icon:"",dark:"",onClick:V[1]||(V[1]=U=>n.value=!1)},{default:l(()=>[e(z,null,{default:l(()=>[C("mdi:mdi-close")]),_:1})]),_:1}),e(ue,null,{default:l(()=>[C("Room Details ("+P(u.value.Name)+")",1)]),_:1}),e(ee),e(ve,null,{default:l(()=>[e(F,{variant:"text",onClick:s},{default:l(()=>[C(" Save ")]),_:1})]),_:1})]),_:1}),e(ce,null,{default:l(()=>[e(ae,null,{default:l(()=>[e(N,null,{default:l(()=>[e(_,{cols:"12"},{default:l(()=>[e(S,{label:d.value.formLabelName,type:"text",variant:"outlined",modelValue:u.value.Name,"onUpdate:modelValue":V[2]||(V[2]=U=>u.value.Name=U)},null,8,["label","modelValue"])]),_:1})]),_:1}),e(N,null,{default:l(()=>[e(_,null,{default:l(()=>[e(Ie,{label:d.value.formLabelNotes,variant:"outlined",modelValue:u.value.Notes,"onUpdate:modelValue":V[3]||(V[3]=U=>u.value.Notes=U)},null,8,["label","modelValue"])]),_:1})]),_:1}),e(N,null,{default:l(()=>[e(_,{cols:"12",sm:"6"},{default:l(()=>[e(S,{type:"number",label:d.value.formLabelMinimumCapacity,variant:"outlined",modelValue:u.value.MinimumCapacity,"onUpdate:modelValue":V[4]||(V[4]=U=>u.value.MinimumCapacity=U),modelModifiers:{number:!0}},null,8,["label","modelValue"])]),_:1}),e(_,{cols:"12",sm:"6"},{default:l(()=>[e(S,{type:"number",label:d.value.formLabelMaximumCapacity,variant:"outlined",modelValue:u.value.MaximumCapacity,"onUpdate:modelValue":V[5]||(V[5]=U=>u.value.MaximumCapacity=U),modelModifiers:{number:!0}},null,8,["label","modelValue"])]),_:1})]),_:1}),e(N,null,{default:l(()=>[e(_,null,{default:l(()=>[xl]),_:1})]),_:1}),(c(!0),E($,null,K(u.value.Costs,(U,T)=>(c(),E($,{key:`venue-room-${u.value.ID}-cost-${U.ID}`},[u.value.Costs&&u.value.Costs[T]?(c(),g(Nl,{key:0,modelValue:u.value.Costs[T],"onUpdate:modelValue":D=>u.value.Costs[T]=D,onDeleted:D=>v(T)},null,8,["modelValue","onUpdate:modelValue","onDeleted"])):A("",!0)],64))),128)),e(F,{color:"primary","prepend-icon":"mdi:mdi-plus",onClick:o},{default:l(()=>[C("Add Row")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}}),Ol=h("h3",null,"Rooms",-1),wl=O({__name:"Venue",props:{modelValue:{required:!0}},emits:x(["deleted"],["update:modelValue"]),setup(f,{emit:r}){const a=B(),d=M(f,"modelValue"),i=y(j(d.value)),u=y([]),n=y(!1),t=y(!1);a.getVenueRooms(i.value.VenueUUID).then(p=>{u.value=p}),J(i.value,()=>{t.value=!0});const o=({callback:p})=>{n.value=!0,a.saveVenue(i.value).then(()=>{n.value=!1,t.value=!1,d.value=i.value,p&&p("Venue Saved")}).catch(()=>{n.value=!1,p&&p("Failed to Saved Venue")})},v=({callback:p})=>{n.value=!0,a.deleteVenue(i.value.VenueUUID).then(V=>{n.value=!1,V?p&&(p("Venue Deleted"),r("deleted")):p&&p("Failed to Delete Venue")}).catch(()=>{p&&(p("Failed to Delete Venue"),n.value=!1)})},m=()=>{const p={ID:0,RoomUUID:q(),VenueID:i.value.ID,VenueUUID:i.value.VenueUUID,Order:u.value.length+1,Name:"New Room",Notes:"",MaximumCapacity:1,MinimumCapacity:1,Costs:[]};a.saveRoom(p).then(V=>{V&&u.value.push(V)})},s=(p,V)=>{a.deleteRoom(u.value[V].RoomUUID).then(U=>{U&&u.value.splice(V,1)})};return(p,V)=>(c(),g(Ve,null,{default:l(()=>[e(Ue,null,{default:l(()=>[C(P(i.value.Name),1)]),_:1}),e(Te,null,{default:l(()=>[e(N,{"no-gutters":""},{default:l(()=>[e(_,{cols:"12"},{default:l(()=>[e(S,{label:I(R).formLabelName,name:"name",variant:"outlined",modelValue:i.value.Name,"onUpdate:modelValue":V[0]||(V[0]=U=>i.value.Name=U)},null,8,["label","modelValue"])]),_:1}),e(_,{cols:"12"},{default:l(()=>[e(Ie,{label:I(R).formLabelDescription,name:"description",variant:"outlined",modelValue:i.value.Description,"onUpdate:modelValue":V[1]||(V[1]=U=>i.value.Description=U)},null,8,["label","modelValue"])]),_:1}),e(_,{class:"text-right",cols:"12"},{default:l(()=>[e(Q,{class:"mr-2",color:"red-darken-3",label:"Delete",onClick:v}),e(Q,{enabled:t.value,timeout:"7",onClick:o},null,8,["enabled"])]),_:1})]),_:1}),Ol,(c(!0),E($,null,K(u.value,(U,T)=>(c(),g(ae,{variant:"elevation",elevation:"6",key:`venue-room-${U.ID}`},{default:l(()=>[u.value&&u.value[T]?(c(),g(Rl,{key:0,modelValue:u.value[T],"onUpdate:modelValue":D=>u.value[T]=D,onDeleted:D=>s(D,T)},null,8,["modelValue","onUpdate:modelValue","onDeleted"])):A("",!0)]),_:2},1024))),128)),e(ae,{class:"ma-2"},{default:l(()=>[e(F,{color:"primary","prepend-icon":"mdi:mdi-plus",onClick:m},{default:l(()=>[C("Add Room")]),_:1})]),_:1})]),_:1})]),_:1}))}}),ql=h("h3",null,"Venues",-1),Ml=h("p",null," Venues and the rooms they supply to the organisation, this is internal data not seen by attendees. ",-1),Ll=h("p",null," Attendee options are configured via the accommodation tab. ",-1),Kl=O({__name:"VenuesEditorView",props:{modelValue:{required:!0}},emits:x(["close","pageTitle","refresh"],["update:modelValue"]),setup(f,{emit:r}){const a=B(),d=M(f,"modelValue");r("pageTitle","Venues");const i=y([]);a.getConventionVenues(d.value.ConventionUUID).then(t=>{i.value=t});const u=()=>{const t={ID:0,VenueUUID:q(),ConventionID:d.value.ID,ConventionUUID:d.value.ConventionUUID,Order:i.value.length+1,Name:"New Venue",Description:"",Rooms:[]};a.saveVenue(t).then(o=>{o&&i.value.push(o)})},n=t=>{i.value.splice(t,1)};return(t,o)=>(c(),E($,null,[e(G,{fluid:"",class:"px-0"},{default:l(()=>[e(N,null,{default:l(()=>[e(_,null,{default:l(()=>[ql]),_:1})]),_:1})]),_:1}),Ml,Ll,e(ae,null,{default:l(()=>[e(fe,{variant:"accordion"},{default:l(()=>[(c(!0),E($,null,K(i.value,(v,m)=>(c(),g(wl,{key:`venues-${v.ID}`,modelValue:i.value[m],"onUpdate:modelValue":s=>i.value[m]=s,onDeleted:s=>n(m)},null,8,["modelValue","onUpdate:modelValue","onDeleted"]))),128))]),_:1}),e(ae,{class:"pa-2"},{default:l(()=>[e(F,{color:"primary",onClick:u},{default:l(()=>[C("Add Venue")]),_:1})]),_:1})]),_:1})],64))}}),Yl=h("p",{title:"Automatically calculated",class:"text-grey-lighten-1"},"Applicable Tickets:",-1),Bl=O({__name:"AccommodationCost",props:x({convention:{}},{modelValue:{required:!0}}),emits:x(["deleted"],["update:modelValue"]),setup(f,{emit:r}){const a=M(f,"modelValue"),d=y([]);B().getConventionTickets(f.convention.ConventionUUID).then(o=>{o&&(d.value=o)});const u=[{title:"Per Room",value:"PER_ROOM"},{title:"Per Person",value:"PER_PERSON"}],n=()=>{r("deleted")},t=W(()=>d.value.filter(o=>(o.Type===L.TICKET_TYPE_TICKET||o.Type===L.TICKET_TYPE_ADD_ON)&&o.RequiresAccommodation&&o.DateStart===a.value.DateStart&&o.DateEnd===a.value.DateEnd));return(o,v)=>(c(),E($,null,[e(N,{class:"align-center",dense:""},{default:l(()=>[e(_,{class:"flex-grow-0 flex-shrink-1 text-no-wrap font-italic"},{default:l(()=>[Yl]),_:1}),e(_,{class:"flex-grow-1"},{default:l(()=>[e(Me,null,{default:l(()=>[(c(!0),E($,null,K(t.value,m=>(c(),g(Le,{key:m.ID,title:"Automatically calculated",disabled:""},{default:l(()=>[C(P(m.Name),1)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1}),e(N,{dense:""},{default:l(()=>[e(_,{cols:"12",sm:"6",md:"3"},{default:l(()=>[e(S,{label:I(R).formLabelDateStart,type:"date",variant:"outlined",modelValue:a.value.DateStart,"onUpdate:modelValue":v[0]||(v[0]=m=>a.value.DateStart=m)},null,8,["label","modelValue"])]),_:1}),e(_,{cols:"12",sm:"6",md:"3"},{default:l(()=>[e(S,{label:I(R).formLabelDateEnd,type:"date",variant:"outlined",modelValue:a.value.DateEnd,"onUpdate:modelValue":v[1]||(v[1]=m=>a.value.DateEnd=m)},null,8,["label","modelValue"])]),_:1}),e(_,{cols:"5",sm:"6",md:"3"},{default:l(()=>[e(S,{label:I(R).formLabelPrice,type:"number","prepend-inner-icon":"mdi:mdi-currency-gbp",variant:"outlined",modelValue:a.value.Price,"onUpdate:modelValue":v[2]||(v[2]=m=>a.value.Price=m),modelModifiers:{number:!0}},null,8,["label","modelValue"])]),_:1}),e(_,{cols:"5",sm:"4",md:"2"},{default:l(()=>[e(se,{label:I(R).formLabelPriceType,variant:"outlined",modelValue:a.value.Type,"onUpdate:modelValue":v[3]||(v[3]=m=>a.value.Type=m),items:u,"item-value":"value","item-title":"title"},null,8,["label","modelValue"])]),_:1}),e(_,{cols:"2",sm:"2",md:"1",class:"text-right"},{default:l(()=>[e(F,{color:"red",icon:"mdi:mdi-minus",onClick:n})]),_:1})]),_:1})],64))}}),jl=h("h4",null," Room Pool ",-1),Gl=h("p",{class:"mb-4"}," Hotel rooms that can be used for this accommodation option. ",-1),zl=h("p",null," Pool total: ",-1),Hl=h("h4",null," Accommodation Costs ",-1),Jl=h("p",{class:"mb-4"}," How much the attendee is charged by the convention for the accommodation. ",-1),Xl=O({__name:"Accommodation",props:x({convention:{},venues:{}},{modelValue:{required:!0}}),emits:x(["deleted"],["update:modelValue"]),setup(f,{emit:r}){const a=B(),d=M(f,"modelValue"),i=y(j(d.value)),u=W(()=>f.venues.map(m=>m.Rooms.map(s=>({title:` ${m.Name} - ${s.Name}`,value:s}))).flat()),n=()=>{i.value.Costs||(i.value.Costs=[]),i.value.Costs.push({ID:0,CostUUID:q(),Availability:0,DateStart:"",DateEnd:"",Price:0,Type:Ce.PER_ROOM})},t=m=>{i.value.Costs.splice(m,1)},o=({callback:m})=>{a.deleteAccommodation(i.value.AccommodationUUID).then(s=>{s?m&&(m("Accommodation Deleted"),r("deleted")):m&&m("Failed to Delete Accommodation")}).catch(()=>{m&&m("Failed to Delete Accommodation")})},v=({callback:m})=>{a.saveAccommodation(i.value).then(s=>{s?(i.value.ID=s.ID,d.value=s,m&&m("Accommodation Saved")):m&&m("Failed to Save Accommodation")}).catch(()=>{m&&m("Failed to Save Accommodation")})};return(m,s)=>(c(),g(Ve,null,{default:l(()=>[e(Ue,null,{default:l(()=>[C(P(i.value.Name),1)]),_:1}),e(Te,null,{default:l(()=>[e(ae,null,{default:l(()=>[e(N,null,{default:l(()=>[e(_,null,{default:l(()=>[e(S,{modelValue:i.value.Name,"onUpdate:modelValue":s[0]||(s[0]=p=>i.value.Name=p),label:"Name",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1})]),_:1}),e(N,null,{default:l(()=>[e(_,null,{default:l(()=>[jl,Gl,e(se,{clearable:!0,modelValue:i.value.Pool,"onUpdate:modelValue":s[1]||(s[1]=p=>i.value.Pool=p),items:u.value,label:"Select",multiple:"",hint:"Pick appropriate rooms","persistent-hint":"",variant:"outlined","item-title":"title","item-value":"value",eager:!0},null,8,["modelValue","items"]),zl,h("p",null,[e(ne,{label:"Required Tags",variant:"outlined",modelValue:i.value.RequiredTags,"onUpdate:modelValue":s[2]||(s[2]=p=>i.value.RequiredTags=p),convention:m.convention,organisation:m.convention.OrganisationUUID,chips:!0,clearable:!0,hint:"Tags that a user must have to select this accommodation."},null,8,["modelValue","convention","organisation"])]),Hl,Jl,i.value.Costs?(c(!0),E($,{key:0},K(i.value.Costs,(p,V)=>(c(),g(Bl,{key:`venue-room-${i.value.ID}-cost-${p.ID}`,convention:m.convention,modelValue:i.value.Costs[V],"onUpdate:modelValue":U=>i.value.Costs[V]=U,onDeleted:U=>t(V)},null,8,["convention","modelValue","onUpdate:modelValue","onDeleted"]))),128)):A("",!0)]),_:1})]),_:1}),e(N,{"no-gutters":""},{default:l(()=>[e(_,{class:"text-left"},{default:l(()=>[e(F,{color:"primary","prepend-icon":"mdi:mdi-plus",onClick:n},{default:l(()=>[C("Add Row")]),_:1})]),_:1}),e(_,{class:"text-right"},{default:l(()=>[e(Q,{class:"mr-2",color:"red-darken-3",label:"Delete",onClick:o}),e(Q,{onClick:v})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}))}}),Wl=h("h3",null,"Accommodation",-1),Ql=h("p",null," Accommodation options presented to attendees, these are effectively virtual room types which are linked to the available room pools created in the venues tab. ",-1),Zl=h("p",null," Use the venues tab to configure internal data about the venues and room supply. ",-1),et=O({__name:"AccommodationEditorView",props:{modelValue:{required:!0}},emits:["update:modelValue"],setup(f){const r=B(),a=M(f,"modelValue"),d=y([]),i=y([]);r.getConventionAccommodation(a.value.ConventionUUID).then(t=>{t&&(d.value=t)}),r.getConventionVenues(a.value.ConventionUUID).then(t=>{t&&(i.value=t)});const u=()=>{const t={ID:0,AccommodationUUID:q(),ConventionID:a.value.ID,ConventionUUID:a.value.ConventionUUID,Order:d.value.length+1,Name:"New Accommodation Option",Pool:[],Costs:[],RequiredTags:[]};r.saveAccommodation(t).then(o=>{o&&d.value.push(o)})},n=t=>{d.value.splice(t,1)};return(t,o)=>(c(),E($,null,[e(G,{fluid:!0,class:"px-0"},{default:l(()=>[e(N,null,{default:l(()=>[e(_,null,{default:l(()=>[Wl]),_:1})]),_:1})]),_:1}),Ql,Zl,e(ae,null,{default:l(()=>[e(fe,{variant:"accordion"},{default:l(()=>[(c(!0),E($,null,K(d.value,(v,m)=>(c(),g(Xl,{key:v.AccommodationUUID,convention:a.value,venues:i.value,modelValue:d.value[m],"onUpdate:modelValue":s=>d.value[m]=s,onDeleted:s=>n(m)},null,8,["convention","venues","modelValue","onUpdate:modelValue","onDeleted"]))),128))]),_:1}),e(ae,{class:"pa-2"},{default:l(()=>[e(F,{color:"primary",onClick:u},{default:l(()=>[C("Add Accommodation")]),_:1})]),_:1})]),_:1})],64))}}),lt=O({__name:"EditFieldDialogExtras",props:{modelValue:{required:!0}},emits:["update:modelValue"],setup(f){const r=M(f,"modelValue"),a=be.getInstance(),d=y([]),i=y([]);return a==null||a.getConventionExtras(r.value.ConventionUUID).then(u=>{d.value=u;const n=r.value.Values.find(t=>t.Title==="SelectedExtras");if(n)try{i.value=JSON.parse(n.Value)}catch{}}),J(i,()=>{const u=r.value.Values.find(n=>n.Title==="SelectedExtras");if(u)u.Value=JSON.stringify(i.value);else{const n={ID:0,FieldValueUUID:q(),FieldID:r.value.ID,FieldUUID:r.value.FieldUUID,Title:"SelectedExtras",Value:JSON.stringify(i.value)};r.value.Values.push(n)}}),(u,n)=>(c(!0),E($,null,K(d.value,t=>(c(),g(Z,{key:t.ExtraUUID,modelValue:i.value,"onUpdate:modelValue":n[0]||(n[0]=o=>i.value=o),label:t.Name,value:t.ExtraUUID,name:r.value.Name,"hide-details":""},null,8,["modelValue","label","value","name"]))),128))}}),tt=O({__name:"EditFieldDialogInterests",props:{modelValue:{required:!0}},emits:["update:modelValue"],setup(f){const r=M(f,"modelValue"),a=be.getInstance(),d=y([]),i=y([]);return a==null||a.getConventionInterests(r.value.ConventionUUID).then(u=>{d.value=u;const n=r.value.Values.find(t=>t.Title==="SelectedInterests");if(n)try{i.value=JSON.parse(n.Value)}catch{}}),J(i,()=>{const u=r.value.Values.find(n=>n.Title==="SelectedInterests");if(u)u.Value=JSON.stringify(i.value);else{const n={ID:0,FieldValueUUID:q(),FieldID:r.value.ID,FieldUUID:r.value.FieldUUID,Title:"SelectedInterests",Value:JSON.stringify(i.value)};r.value.Values.push(n)}}),(u,n)=>(c(!0),E($,null,K(d.value,t=>(c(),g(Z,{key:t.InterestUUID,modelValue:i.value,"onUpdate:modelValue":n[0]||(n[0]=o=>i.value=o),label:t.Name,value:t.InterestUUID,name:r.value.Name,"hide-details":""},null,8,["modelValue","label","value","name"]))),128))}}),at=O({__name:"EditFieldDialogTickets",props:{modelValue:{required:!0}},emits:["update:modelValue"],setup(f){const r=M(f,"modelValue"),a=be.getInstance(),d=y([]),i=y([]);return a==null||a.getConventionTickets(r.value.ConventionUUID).then(u=>{d.value=u;const n=r.value.Values.find(t=>t.Title==="SelectedTickets");if(n)try{i.value=JSON.parse(n.Value)}catch{}}),J(i,()=>{const u=r.value.Values.find(n=>n.Title==="SelectedTickets");if(u)u.Value=JSON.stringify(i.value);else{const n={ID:0,FieldValueUUID:q(),FieldID:r.value.ID,FieldUUID:r.value.FieldUUID,Title:"SelectedTickets",Value:JSON.stringify(i.value)};r.value.Values.push(n)}}),(u,n)=>(c(!0),E($,null,K(d.value.filter(t=>t&&t.Type===I(L).TICKET_TYPE_GROUP),t=>(c(),g(Z,{key:t.TicketUUID,modelValue:i.value,"onUpdate:modelValue":n[0]||(n[0]=o=>i.value=o),label:t.Name,value:t.TicketUUID,name:r.value.Name,"hide-details":""},null,8,["modelValue","label","value","name"]))),128))}}),ot=O({__name:"EditFieldDialogAccommodation",props:{modelValue:{required:!0}},emits:["update:modelValue"],setup(f){const r=M(f,"modelValue"),a=be.getInstance(),d=y([]),i=y(r.value.Values.map(n=>n.Value)),u=()=>{r.value.Values=i.value.map(n=>{var t,o,v;return{ID:0,FieldValueUUID:q(),FieldID:((t=r.value)==null?void 0:t.ID)||0,FieldUUID:((o=r.value)==null?void 0:o.FieldUUID)||"",Title:((v=d.value.find(m=>m.AccommodationUUID==n))==null?void 0:v.Name)||"",Value:n}})};return a==null||a.getConventionAccommodation(r.value.ConventionUUID).then(n=>{n&&(d.value=n)}),(n,t)=>(c(!0),E($,null,K(d.value,o=>(c(),g(Z,{key:o.ID,modelValue:i.value,"onUpdate:modelValue":t[0]||(t[0]=v=>i.value=v),label:o.Name,value:o.AccommodationUUID,"hide-details":"",onChange:u},null,8,["modelValue","label","value"]))),128))}}),nt=O({__name:"EditFieldDialogAge",props:x({convention:{}},{modelValue:{required:!0}}),emits:["update:modelValue"],setup(f){var m,s,p;const r=M(f,"modelValue"),a=new Date,d=a.getFullYear(),i=(a.getMonth()+1).toLocaleString(navigator.language,{minimumIntegerDigits:2}),u=a.getDate().toLocaleString(navigator.language,{minimumIntegerDigits:2}),n=y(parseInt(((m=r.value.Values.find(V=>V.Title==="MIN_AGE"))==null?void 0:m.Value)||"18")),t=y(((s=r.value.Values.find(V=>V.Title==="BEFORE_DATE"))==null?void 0:s.Value)||`${d}-${i}-${u}`),o=y(((p=r.value.Values.find(V=>V.Title==="UNDER_AGE_APPLY_TAG"))==null?void 0:p.Value)||""),v=()=>{var V,U,T,D,b,k;r.value.Values=[{ID:0,FieldValueUUID:q(),FieldID:((V=r.value)==null?void 0:V.ID)||0,FieldUUID:((U=r.value)==null?void 0:U.FieldUUID)||"",Title:"MIN_AGE",Value:n.value.toString()},{ID:0,FieldValueUUID:q(),FieldID:((T=r.value)==null?void 0:T.ID)||0,FieldUUID:((D=r.value)==null?void 0:D.FieldUUID)||"",Title:"BEFORE_DATE",Value:t.value},{ID:0,FieldValueUUID:q(),FieldID:((b=r.value)==null?void 0:b.ID)||0,FieldUUID:((k=r.value)==null?void 0:k.FieldUUID)||"",Title:"UNDER_AGE_APPLY_TAG",Value:o.value}]};return v(),(V,U)=>(c(),g(G,{class:"pl-0 pr-0",fluid:!0},{default:l(()=>[e(N,null,{default:l(()=>[e(_,{cols:"12",sm:"6"},{default:l(()=>[e(S,{modelValue:n.value,"onUpdate:modelValue":U[0]||(U[0]=T=>n.value=T),modelModifiers:{number:!0},type:"number",label:"Minimum Age",variant:"outlined",onChange:v},null,8,["modelValue"])]),_:1}),e(_,{cols:"12",sm:"6"},{default:l(()=>[e(S,{modelValue:t.value,"onUpdate:modelValue":U[1]||(U[1]=T=>t.value=T),type:"date",label:"Date to attain minimum age by",variant:"outlined",onChange:v},null,8,["modelValue"])]),_:1})]),_:1}),e(N,null,{default:l(()=>[e(_,null,{default:l(()=>[e(ne,{modelValue:o.value,"onUpdate:modelValue":U[2]||(U[2]=T=>o.value=T),convention:V.convention,chips:!0,clearable:!0,variant:"outlined",label:`Tags applied to users under ${n.value} at time of data entry`,onChange:v},null,8,["modelValue","convention","label"])]),_:1})]),_:1})]),_:1}))}}),ut=h("h4",null,"Values",-1),it=h("h4",null,"Accommodation",-1),dt=h("h4",null,"Age",-1),st=h("h4",null,"Additional Purchases",-1),rt=h("h4",null,"Available Interests",-1),mt=h("h4",null,"Tickets",-1),vt=h("h4",{class:"mb-3"},"Field Preview",-1),ct=O({__name:"EditFieldDialog",props:x({convention:{},field:{},title:{}},{modelValue:{type:Boolean,required:!0}}),emits:x(["update:field"],["update:modelValue"]),setup(f,{emit:r}){const a=f,{convention:d,title:i=""}=a,u=M(f,"modelValue"),n=De(a,r,void 0,void 0,"field"),t=y(j(n.value)),o=y(""),v=y(t.value.Type);J(n,()=>{t.value=j(n.value)});const m=()=>{u.value=!1},s=()=>{t.value=j(n.value)},p=()=>{n.value=t.value},V=()=>{t.value.Values.push({ID:0,FieldValueUUID:q(),FieldID:t.value.ID,FieldUUID:t.value.FieldUUID,Title:"",Value:""})},U=D=>{t.value.Values.splice(D,1)},T=()=>{o.value="",t.value.Values=[]};return J(v,(D,b)=>{D!==b&&(t.value.Type=D,T())}),(D,b)=>(c(),g(Pe,{modelValue:u.value,"onUpdate:modelValue":b[13]||(b[13]=k=>u.value=k),onReset:s,onSave:p,title:I(i),color:"primary"},{default:l(()=>[e(G,{class:"pa-0",fluid:!0},{default:l(()=>[e(N,null,{default:l(()=>[e(_,{cols:"12"},{default:l(()=>[e(G,{class:"pa-0",fluid:!0},{default:l(()=>[e(N,null,{default:l(()=>[e(_,{cols:"12",sm:"6",md:"4"},{default:l(()=>[e(S,{modelValue:t.value.Name,"onUpdate:modelValue":b[0]||(b[0]=k=>t.value.Name=k),label:"Internal name",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),e(_,{cols:"12",sm:"6",md:"4"},{default:l(()=>[e(S,{modelValue:t.value.Label,"onUpdate:modelValue":b[1]||(b[1]=k=>t.value.Label=k),label:"Label",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),e(_,{cols:"12",sm:"6",md:"4"},{default:l(()=>[e(S,{modelValue:t.value.Hint,"onUpdate:modelValue":b[2]||(b[2]=k=>t.value.Hint=k),label:"Hint",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),e(_,{cols:"12",sm:"6",md:"4"},{default:l(()=>[e(S,{modelValue:t.value.Placeholder,"onUpdate:modelValue":b[3]||(b[3]=k=>t.value.Placeholder=k),label:"Placeholder",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),e(_,{cols:"12",sm:"6",md:"4"},{default:l(()=>[e(se,{modelValue:v.value,"onUpdate:modelValue":b[4]||(b[4]=k=>v.value=k),label:"Type",variant:"outlined",items:I(we),"hide-details":""},null,8,["modelValue","items"])]),_:1}),t.value.Type===I(X).SELECT||t.value.Type===I(X).CHECKBOX?(c(),g(_,{key:0,cols:"12",sm:"6",md:"4",class:"py-0"},{default:l(()=>[e(Z,{modelValue:t.value.Multiple,"onUpdate:modelValue":b[5]||(b[5]=k=>t.value.Multiple=k),label:"Multiple Items",hint:"Can select multiple items from list","hide-details":"",density:"compact"},null,8,["modelValue"]),t.value.Type===I(X).SELECT?(c(),g(Z,{key:0,modelValue:t.value.Autofill,"onUpdate:modelValue":b[6]||(b[6]=k=>t.value.Autofill=k),label:"Searchable List","hide-details":"",density:"compact"},null,8,["modelValue"])):A("",!0)]),_:1})):A("",!0)]),_:1}),t.value.Type===I(X).SELECT||t.value.Type===I(X).CHECKBOX&&t.value.Multiple||t.value.Type===I(X).RADIO?(c(),g(N,{key:0},{default:l(()=>[e(_,null,{default:l(()=>[ut,e(G,{fluid:!0,class:"px-0"},{default:l(()=>[(c(!0),E($,null,K(t.value.Values,(k,w)=>(c(),g(N,{key:k.ID},{default:l(()=>[e(_,{cols:"12",sm:"5",md:"6"},{default:l(()=>[e(S,{modelValue:k.Title,"onUpdate:modelValue":Y=>k.Title=Y,label:"Display",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(_,{cols:"9",sm:"5",md:"5"},{default:l(()=>[e(S,{modelValue:k.Value,"onUpdate:modelValue":Y=>k.Value=Y,label:"Internal Value",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(_,{cols:"3",sm:"2",md:"1",class:"d-flex align-center"},{default:l(()=>[e(F,{icon:"mdi:mdi-window-close",size:"small",color:"red",onClick:Y=>U(w)},null,8,["onClick"])]),_:2},1024)]),_:2},1024))),128)),e(N,null,{default:l(()=>[e(_,null,{default:l(()=>[e(F,{"prepend-icon":"mdi:mdi-plus",color:"primary",onClick:V},{default:l(()=>[C("Add Item")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})):t.value.Type===I(X).ACCOMMODATION?(c(),g(N,{key:1},{default:l(()=>[e(_,null,{default:l(()=>[it,e(ot,{modelValue:t.value,"onUpdate:modelValue":b[7]||(b[7]=k=>t.value=k)},null,8,["modelValue"])]),_:1})]),_:1})):t.value.Type===I(X).AGE?(c(),g(N,{key:2},{default:l(()=>[e(_,null,{default:l(()=>[dt,e(nt,{modelValue:t.value,"onUpdate:modelValue":b[8]||(b[8]=k=>t.value=k),convention:I(d)},null,8,["modelValue","convention"])]),_:1})]),_:1})):t.value.Type===I(X).EXTRAS?(c(),g(N,{key:3},{default:l(()=>[e(_,null,{default:l(()=>[st,e(lt,{modelValue:t.value,"onUpdate:modelValue":b[9]||(b[9]=k=>t.value=k)},null,8,["modelValue"])]),_:1})]),_:1})):t.value.Type===I(X).INTERESTS?(c(),g(N,{key:4},{default:l(()=>[e(_,null,{default:l(()=>[rt,e(tt,{modelValue:t.value,"onUpdate:modelValue":b[10]||(b[10]=k=>t.value=k)},null,8,["modelValue"])]),_:1})]),_:1})):t.value.Type===I(X).TICKET?(c(),g(N,{key:5},{default:l(()=>[e(_,null,{default:l(()=>[mt,e(at,{modelValue:t.value,"onUpdate:modelValue":b[11]||(b[11]=k=>t.value=k)},null,8,["modelValue"])]),_:1})]),_:1})):A("",!0)]),_:1})]),_:1}),e(_,{cols:"12"},{default:l(()=>[e(ae,{elevation:"5",class:"pa-2",color:"text-center"},{default:l(()=>[vt,e(qe,{admin:!0,field:t.value,convention:I(d),modelValue:o.value,"onUpdate:modelValue":b[12]||(b[12]=k=>o.value=k)},null,8,["field","convention","modelValue"])]),_:1})]),_:1})]),_:1})]),_:1})]),actions:l(()=>[e(F,{color:"blue-darken-1",variant:"text",onClick:m},{default:l(()=>[C(" Cancel ")]),_:1}),e(F,{color:"blue-darken-1",variant:"text",onClick:s},{default:l(()=>[C(" Reset ")]),_:1}),e(ee),e(F,{color:"blue-darken-1",variant:"text",onClick:p},{default:l(()=>[C(" Save ")]),_:1})]),_:1},8,["modelValue","title"]))}}),pt=O({__name:"FieldEditor",props:{modelValue:{required:!0}},emits:x(["refresh"],["update:modelValue"]),setup(f){const r=M(f,"modelValue"),a=B(),d=y(!1),i=y(!1),u=y([{key:"Label",title:"Label",align:"start",sortable:!0},{key:"Name",title:"Internal Name",align:"start",sortable:!0},{key:"Type",title:"Type",align:"start",sortable:!0},{key:"actions",title:"Actions",sortable:!1}]),n=y([]);a.getConventionFields(r.value.ConventionUUID).then(w=>{w&&(n.value=w)});const t=y(-1),o=y({ID:0,FieldUUID:q(),ConventionID:r.value.ID,ConventionUUID:r.value.ConventionUUID,Autofill:!1,Hint:"",Label:"",Multiple:!1,Name:"",Placeholder:"",Type:"TEXT",Values:[]}),v=W(()=>t.value===-1?"New Field":"Edit Field"),m=()=>({ID:0,FieldUUID:q(),ConventionID:r.value.ID,ConventionUUID:r.value.ConventionUUID,Autofill:!1,Hint:"",Label:"",Multiple:!1,Name:"",Placeholder:"",Type:"TEXT",Values:[]}),s=y(m()),p=()=>{s.value.FieldUUID=q(),o.value=Object.assign({},m()),t.value=-1,d.value=!0},V=w=>{t.value=n.value.indexOf(w),o.value=Object.assign({},w),d.value=!0},U=w=>{t.value=n.value.indexOf(w),o.value=Object.assign({},w),i.value=!0},T=()=>{a.deleteField(o.value.FieldUUID).then(w=>{w&&(n.value.splice(t.value,1),b())})},D=()=>{d.value=!1,ge(()=>{o.value=Object.assign({},s.value),t.value=-1})},b=()=>{i.value=!1,ge(()=>{o.value=Object.assign({},s.value),t.value=-1})},k=()=>{a.saveField(o.value).then(w=>{w&&(t.value>-1?Object.assign(n.value[t.value],w):n.value.push(w),D())})};return(w,Y)=>(c(),g(I(Ke),{headers:u.value,items:n.value,"sort-by":[{key:"calories",order:"asc"}],class:"elevation-1"},{top:l(()=>[e(oe,{color:"primary"},{default:l(()=>[e(ue,null,{default:l(()=>[C("Field Editor")]),_:1}),e(Ae,{class:"mx-4",inset:!0,vertical:!0}),e(ee),e(F,{dark:"",class:"mb-2","prepend-icon":"mdi:mdi-pencil",onClick:p},{default:l(()=>[C(" New Item ")]),_:1}),e(Be,{modelValue:i.value,"onUpdate:modelValue":Y[0]||(Y[0]=H=>i.value=H),onDelete:T},null,8,["modelValue"])]),_:1}),d.value?(c(),g(ct,{key:0,modelValue:d.value,"onUpdate:modelValue":Y[1]||(Y[1]=H=>d.value=H),field:o.value,"onUpdate:field":[Y[2]||(Y[2]=H=>o.value=H),k],title:v.value,convention:r.value},null,8,["modelValue","field","title","convention"])):A("",!0)]),"item.actions":l(({item:H})=>[e(z,{size:"small",class:"me-2",onClick:Ee=>V(H.raw)},{default:l(()=>[C(" mdi:mdi-pencil ")]),_:2},1032,["onClick"]),e(z,{size:"small",onClick:Ee=>U(H.raw)},{default:l(()=>[C(" mdi:mdi-delete ")]),_:2},1032,["onClick"])]),_:1},8,["headers","items"]))}}),ft=(f,r)=>{const a=De(f,r),d=De(f,r,void 0,void 0,"item"),i=y(j(d.value));return J(d,()=>{i.value=j(d.value)}),{state:a,model:d,close:()=>{a.value=!1},reset:()=>{d.value=j(i.value)},save:()=>{r("save")}}},Vt=O({__name:"EditItemDialog",props:{item:{},modelValue:{type:Boolean},title:{},cardClass:{}},emits:["update:modelValue","update:item","save"],setup(f,{emit:r}){const a=f,{state:d,model:i,close:u,reset:n,save:t}=ft(a,r);return(o,v)=>(c(),g(Pe,{modelValue:I(d),"onUpdate:modelValue":v[0]||(v[0]=m=>ye(d)?d.value=m:null),onReset:I(n),onSave:I(t),title:o.title,color:"primary","card-class":o.cardClass},{toolbarButtons:l(()=>[$e(o.$slots,"toolbarButtons")]),actions:l(()=>[e(F,{color:"blue-darken-1",variant:"text",onClick:I(u)},{default:l(()=>[C(" Cancel ")]),_:1},8,["onClick"]),e(F,{color:"blue-darken-1",variant:"text",onClick:I(n)},{default:l(()=>[C(" Reset ")]),_:1},8,["onClick"]),e(ee),e(F,{color:"blue-darken-1",variant:"text",onClick:I(t)},{default:l(()=>[C(" Save ")]),_:1},8,["onClick"])]),default:l(()=>[$e(o.$slots,"default")]),_:3},8,["modelValue","onReset","onSave","title","card-class"]))}}),Ut={class:"pa-0 border-0 ma-0"},Tt=h("legend",{class:"mb-2"},"Field Settings",-1),Dt={class:"pa-0 border-0 ma-0"},It=h("legend",{class:"text-blue-accent-2 mb-2"},"Field Preview",-1),_t=O({__name:"EditFormField",props:x({convention:{}},{modelValue:{required:!0}}),emits:["update:modelValue"],setup(f){const r=M(f,"modelValue"),a=B(),d=y([]),i=y([]),u=y(""),n=t=>{var o;r.value.Field=(o=i.value.find(v=>v.value===t))==null?void 0:o.field};return a.getConventionFields(f.convention.ConventionUUID).then(t=>{t&&(d.value=t,i.value=t.map(o=>({title:`${o.Label} (${(we.find(v=>v.value===o.Type)||{title:""}).title})`,value:o.FieldUUID,field:o})),n(r.value.FieldUUID))}),(t,o)=>(c(),g(N,null,{default:l(()=>[e(_,{cols:"12",md:"6"},{default:l(()=>[h("fieldset",Ut,[Tt,e(N,null,{default:l(()=>[e(_,{cols:"12"},{default:l(()=>[e(se,{modelValue:r.value.FieldUUID,"onUpdate:modelValue":[o[0]||(o[0]=v=>r.value.FieldUUID=v),n],items:i.value,"item-title":"title","item-value":"value",label:"Field",variant:"outlined","hide-details":""},null,8,["modelValue","items"])]),_:1}),e(_,{cols:"6",sm:"4"},{default:l(()=>[e(S,{modelValue:r.value.MinLength,"onUpdate:modelValue":o[1]||(o[1]=v=>r.value.MinLength=v),modelModifiers:{number:!0},label:"Min Length",type:"number",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),e(_,{cols:"6",sm:"4"},{default:l(()=>[e(S,{modelValue:r.value.MaxLength,"onUpdate:modelValue":o[2]||(o[2]=v=>r.value.MaxLength=v),modelModifiers:{number:!0},label:"Max Length",type:"number",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),e(_,{cols:"12",sm:"4"},{default:l(()=>[e(Z,{modelValue:r.value.Required,"onUpdate:modelValue":o[3]||(o[3]=v=>r.value.Required=v),modelModifiers:{boolean:!0},label:"Required","hide-details":""},null,8,["modelValue"])]),_:1})]),_:1})])]),_:1}),r.value.FieldUUID&&r.value.Field?(c(),g(_,{key:0,cols:"12",md:"6"},{default:l(()=>[h("fieldset",Dt,[It,r.value.Field?(c(),g(qe,{key:0,admin:!0,field:r.value.Field,"persistent-hint":!0,required:r.value.Required,convention:t.convention,modelValue:u.value,"onUpdate:modelValue":o[4]||(o[4]=v=>u.value=v)},null,8,["field","required","convention","modelValue"])):A("",!0)])]),_:1})):A("",!0)]),_:1}))}}),yt={class:"d-none d-sm-block"},gt=O({__name:"EditFormSectionFields",props:x({convention:{}},{modelValue:{required:!0}}),emits:["update:modelValue"],setup(f){const r=M(f,"modelValue"),a=()=>{var d;return{ID:0,SectionFieldUUID:q(),SectionID:r.value.ID,SectionUUID:r.value.SectionUUID,FieldID:0,FieldUUID:"",Order:(((d=r.value.Fields)==null?void 0:d.length)||0)+1,MinLength:0,MaxLength:0,Required:!1,Value:""}};return(d,i)=>r.value.Fields!==void 0?(c(),g(Ye,{key:0,modelValue:r.value.Fields,"onUpdate:modelValue":i[0]||(i[0]=u=>r.value.Fields=u),closeable:!1,title:"Fields","new-item":a,class:"mt-4",label:"name","label-parent":"Field","slot-name-prefix":"field"},xe({_:2},[K(r.value.Fields,(u,n)=>({name:`field_${n}_title`,fn:l(()=>[u.Field?(c(),E($,{key:0},[C(P(u.Field.Label)+" ("+P(u.Field.Name)+") ",1),h("template",yt,[C("  ["+P(u.Field.Type)+"] ",1)])],64)):(c(),E($,{key:1},[C("New Field")],64))])})),K(r.value.Fields,(u,n)=>({name:`field_${n}`,fn:l(()=>[e(_t,{modelValue:r.value.Fields[n],"onUpdate:modelValue":t=>r.value.Fields[n]=t,convention:d.convention,style:{margin:"0 -24px"}},null,8,["modelValue","onUpdate:modelValue","convention"])])}))]),1032,["modelValue"])):A("",!0)}}),Ct=O({__name:"EditFormSections",props:x({convention:{}},{modelValue:{required:!0}}),emits:["update:modelValue"],setup(f){const r=M(f,"modelValue"),a=()=>{const d={ID:0,SectionUUID:q(),FormID:r.value.ID,FormUUID:r.value.FormUUID,Order:0,Name:"New Section",Heading:"",Description:"",Fields:[],DefaultValue:"",State:{ID:0,SectionStateUUID:q(),SectionID:0,SectionUUID:"",Edit:!0}};return d.State.SectionID=d.ID,d.State.SectionUUID=d.SectionUUID,d};return(d,i)=>(c(),g(Ye,{modelValue:r.value.Sections,"onUpdate:modelValue":i[0]||(i[0]=u=>r.value.Sections=u),"new-item":a,closeable:!1,title:"Sections","slot-name-prefix":"section"},xe({_:2},[K(r.value.Sections,(u,n)=>({name:`section_${n}`,fn:l(()=>[e(N,null,{default:l(()=>[e(_,{cols:"12",sm:"6"},{default:l(()=>[e(S,{modelValue:u.Name,"onUpdate:modelValue":t=>u.Name=t,label:"Internal Name",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(_,{cols:"12",sm:"6"},{default:l(()=>[e(S,{modelValue:u.Heading,"onUpdate:modelValue":t=>u.Heading=t,label:"Section Heading",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024),e(N,null,{default:l(()=>[e(_,{cols:"12"},{default:l(()=>[e(Ie,{modelValue:u.Description,"onUpdate:modelValue":t=>u.Description=t,label:"Section Text",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024),u.Fields?(c(),g(gt,{key:0,modelValue:r.value.Sections[n],"onUpdate:modelValue":t=>r.value.Sections[n]=t,convention:d.convention},null,8,["modelValue","onUpdate:modelValue","convention"])):A("",!0)])}))]),1032,["modelValue"]))}}),bt=O({__name:"FormRendererPopup",props:x({admin:{type:Boolean},convention:{},form:{},title:{},cardClass:{},preview:{type:Boolean}},{modelValue:{type:Boolean,required:!0}}),emits:x(["update:form"],["update:modelValue"]),setup(f,{emit:r}){const a=f,{admin:d=!1,convention:i,title:u="",cardClass:n=""}=a,t=M(f,"modelValue"),o=De(a,r,void 0,void 0,"form"),v=y(j(o.value));J(o,()=>{v.value=j(o.value)});const m=()=>{t.value=!1};return(s,p)=>(c(),g(Pe,{modelValue:t.value,"onUpdate:modelValue":p[1]||(p[1]=V=>t.value=V),title:I(u),color:"primary","card-class":I(n)},{toolbarButtons:l(()=>[$e(s.$slots,"toolbarButtons")]),actions:l(()=>[e(F,{color:"blue-darken-1",variant:"text",onClick:m},{default:l(()=>[C(" Close ")]),_:1})]),default:l(()=>[e(Je,{modelValue:v.value,"onUpdate:modelValue":p[0]||(p[0]=V=>v.value=V),admin:I(d),convention:I(i),preview:s.preview},null,8,["modelValue","admin","convention","preview"])]),_:3},8,["modelValue","title","card-class"]))}}),kt=h("template",{class:"d-none d-sm-inline"},[C("Preview")],-1),Et=O({__name:"EditFormDialog",props:x({convention:{},form:{}},{modelValue:{type:Boolean,required:!0}}),emits:x(["update:form"],["update:modelValue"]),setup(f,{emit:r}){const a=f,{convention:d}=a,i=M(f,"modelValue"),u=B(),n=De(a,r,void 0,void 0,"form"),t=y(!1),o=y(j(n.value));J(n,()=>{o.value=j(n.value)});const v=()=>{u.saveForm(o.value).then(s=>{s&&(n.value=s,i.value=!1)})},m=()=>{t.value=!0};return(s,p)=>(c(),g(Vt,{modelValue:i.value,"onUpdate:modelValue":p[11]||(p[11]=V=>i.value=V),item:o.value,"onUpdate:item":p[12]||(p[12]=V=>o.value=V),onSave:v,"card-class":"pa-0"},{toolbarButtons:l(()=>[e(He,null,{default:l(()=>[e(F,{"prepend-icon":"mdi:mdi-developer-board",onClick:m},{default:l(()=>[kt]),_:1})]),_:1})]),default:l(()=>[e(fe,null,{default:l(()=>[e(Ve,{class:"mt-0"},{default:l(()=>[e(Ue,null,{default:l(()=>[C("General Settings")]),_:1}),e(Te,null,{default:l(()=>[e(N,null,{default:l(()=>[e(_,{cols:"12"},{default:l(()=>[e(G,{class:"pa-0",fluid:!0},{default:l(()=>[e(N,null,{default:l(()=>[e(_,{cols:"12",sm:"6"},{default:l(()=>[e(S,{modelValue:o.value.Name,"onUpdate:modelValue":p[0]||(p[0]=V=>o.value.Name=V),label:"Internal name",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),e(_,{cols:"12",sm:"6"},{default:l(()=>[e(S,{modelValue:o.value.Heading,"onUpdate:modelValue":p[1]||(p[1]=V=>o.value.Heading=V),label:"Form Heading",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),e(_,{cols:"12"},{default:l(()=>[e(Ie,{modelValue:o.value.Description,"onUpdate:modelValue":p[2]||(p[2]=V=>o.value.Description=V),label:"Pre-form Text",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),e(_,{cols:"12",sm:"6"},{default:l(()=>[e(se,{modelValue:o.value.Type,"onUpdate:modelValue":p[3]||(p[3]=V=>o.value.Type=V),label:"Type",variant:"outlined",items:I(ll),"hide-details":""},null,8,["modelValue","items"])]),_:1}),e(_,{cols:"12",sm:"6"},{default:l(()=>[e(S,{modelValue:o.value.State.Stage,"onUpdate:modelValue":p[4]||(p[4]=V=>o.value.State.Stage=V),modelModifiers:{number:!0},label:"Stage",variant:"outlined","hide-details":"",type:"number"},null,8,["modelValue"])]),_:1}),e(_,{cols:"6"},{default:l(()=>[e(Z,{modelValue:o.value.State.New,"onUpdate:modelValue":p[5]||(p[5]=V=>o.value.State.New=V),label:"Allow New Entries"},null,8,["modelValue"])]),_:1}),e(_,{cols:"6"},{default:l(()=>[e(Z,{modelValue:o.value.State.Edit,"onUpdate:modelValue":p[6]||(p[6]=V=>o.value.State.Edit=V),label:"Allow Editing Submissions"},null,8,["modelValue"])]),_:1})]),_:1}),e(N,null,{default:l(()=>[e(_,{cols:"12"},{default:l(()=>[e(ne,{label:"Required Tags",variant:"outlined",modelValue:o.value.RequiredTags,"onUpdate:modelValue":p[7]||(p[7]=V=>o.value.RequiredTags=V),convention:I(d),organisation:I(d).OrganisationUUID,chips:"",clearable:"",hint:"Tags that a user must have to see this form."},null,8,["modelValue","convention","organisation"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),o.value?(c(),g(Ct,{key:0,modelValue:o.value,"onUpdate:modelValue":p[8]||(p[8]=V=>o.value=V),convention:I(d),style:{"border-radius":"0"}},null,8,["modelValue","convention"])):A("",!0),t.value?(c(),g(bt,{key:1,modelValue:t.value,"onUpdate:modelValue":p[9]||(p[9]=V=>t.value=V),form:o.value,"onUpdate:form":p[10]||(p[10]=V=>o.value=V),admin:!0,convention:I(d),title:"Form Preview",preview:!0,"card-class":"pa-0"},null,8,["modelValue","form","convention"])):A("",!0)]),_:1},8,["modelValue","item"]))}}),ht=(f,r)=>{const a=y(!1),d=y(!1),i=y(f),u=y(-1),n=y(r),t=y(r),o=W(()=>u.value===-1?"New Form":"Edit Form"),v=()=>{i.value=f},m=D=>{u.value=i.value.indexOf(D),n.value=Object.assign({},D),a.value=!0},s=D=>{u.value=i.value.indexOf(D),n.value=Object.assign({},D),d.value=!0},p=()=>{d.value=!1,ge(()=>{n.value=Object.assign({},t.value),u.value=-1}).then()},V=()=>{i.value.splice(u.value,1),p()},U=()=>{a.value=!1,ge(()=>{n.value=Object.assign({},t.value),u.value=-1}).then()},T=()=>{u.value>-1?Object.assign(i.value[u.value],n.value):i.value.push(n.value),U()};return J(a,D=>{D||U()}),J(d,D=>{D||p()}),{collection:i,defaultItem:t,dialog:a,dialogDelete:d,editedItem:n,formTitle:o,reset:v,editItem:m,deleteItem:s,deleteItemConfirm:V,close:U,save:T}},$t=O({__name:"FormEditor",props:{modelValue:{required:!0}},emits:x(["refresh"],["update:modelValue"]),setup(f){const r=M(f,"modelValue"),a=B(),d=y([{key:"Name",title:"Form Name",align:"start",sortable:!0},{key:"Type",title:"Type",align:"start",sortable:!0},{key:"actions",title:"Actions",sortable:!1}]),i=y([]),u=y([]);a.getConventionFields(r.value.ConventionUUID).then(k=>{i.value=k}),a.getConventionForms(r.value.ConventionUUID).then(k=>{u.value=k});const n={ID:0,FormUUID:q(),ConventionID:r.value.ID,ConventionUUID:r.value.ConventionUUID,ParentID:0,ParentUUID:me,Name:"",Heading:"",Description:"",Type:tl.FORM_TYPE_UNSPECIFIED,Sections:[],State:{ID:0,FormStateUUID:q(),FormID:0,FormUUID:me,New:!1,Edit:!1,Stage:0},RequiredGroupMemberships:[],RequiredTags:[]};n.State.FormUUID=n.FormUUID;const{collection:t,defaultItem:o,dialog:v,dialogDelete:m,editedItem:s,formTitle:p,editItem:V,deleteItem:U,deleteItemConfirm:T,save:D}=ht(u,n);t.value.forEach(k=>{k.Sections.forEach(w=>{var Y;(Y=w.Fields)==null||Y.forEach(H=>{H.Field=i.value.find(Ee=>Ee.ID===H.FieldID)})})});const b=k=>{a.deleteForm(k.FormUUID).then(w=>{w&&U(k)})};return(k,w)=>(c(),g(I(Ke),{headers:d.value,items:I(t),"sort-by":[{key:"calories",order:"asc"}],class:"elevation-1"},{top:l(()=>[e(oe,{color:"primary"},{default:l(()=>[e(ue,null,{default:l(()=>[C("Form Editor")]),_:1}),e(Ae,{class:"mx-4",inset:!0,vertical:!0}),e(ee),e(F,{dark:"",class:"mb-2","prepend-icon":"mdi:mdi-pencil",onClick:w[0]||(w[0]=Y=>{s.value=Object.assign({},I(o)),v.value=!0})},{default:l(()=>[C(" New Item ")]),_:1}),e(Be,{modelValue:I(m),"onUpdate:modelValue":w[1]||(w[1]=Y=>ye(m)?m.value=Y:null),onDelete:I(T)},null,8,["modelValue","onDelete"])]),_:1}),I(v)?(c(),g(Et,{key:0,modelValue:I(v),"onUpdate:modelValue":w[2]||(w[2]=Y=>ye(v)?v.value=Y:null),form:I(s),"onUpdate:form":[w[3]||(w[3]=Y=>ye(s)?s.value=Y:null),I(D)],convention:r.value},null,8,["modelValue","form","onUpdate:form","convention"])):A("",!0)]),"item.actions":l(({item:Y})=>[e(z,{size:"small",class:"me-2",onClick:H=>I(V)(Y.raw)},{default:l(()=>[C(" mdi:mdi-pencil ")]),_:2},1032,["onClick"]),e(z,{size:"small",onClick:H=>b(Y.raw)},{default:l(()=>[C(" mdi:mdi-delete ")]),_:2},1032,["onClick"])]),_:1},8,["headers","items"]))}}),oa=O({__name:"ConventionEditorView",emits:["pageTitle","refresh"],setup(f,{emit:r}){const a=je(),d=B(),u=y({ID:0,ConventionUUID:me,Accommodation:[],Description:"",DetailLink:"",Extras:[],Interests:[],Logo:"",Name:"",OrganisationID:0,OrganisationUUID:"",Slug:"",Tickets:[],Visible:!1}),n=y();J(n,()=>{o.value.find(m=>m.id===n.value&&m.title==="General")&&t()});const t=()=>{d.getConvention(a.params.convention.toString()).then(v=>{v?(u.value=v,r("pageTitle",`Convention Editor - ${u.value.Name}`)):r("pageTitle","Convention Editor - New Convention")})},o=y([{id:q(),title:"Accommodation",component:ie(et),model:u},{id:q(),title:"Additional Purchases",component:ie(rl),model:u},{id:q(),title:"Fields",component:ie(pt),model:u},{id:q(),title:"Forms",component:ie($t),model:u},{id:q(),title:"Interests",component:ie(fl),model:u},{id:q(),title:"Tickets",component:ie(Fl),model:u},{id:q(),title:"Venues",component:ie(Kl),model:u}]);return r("pageTitle","Convention Editor"),t(),(v,m)=>u.value&&u.value.ConventionUUID!==I(me)?(c(),E($,{key:0},[e(oe,{color:"blue-darken-4"},{default:l(()=>[e(Xe,{modelValue:n.value,"onUpdate:modelValue":m[0]||(m[0]=s=>n.value=s),"show-arrows":""},{default:l(()=>[(c(!0),E($,null,K(o.value,s=>(c(),g(We,{key:s.id,value:s.id},{default:l(()=>[C(P(s.title),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(Ze,{modelValue:n.value,"onUpdate:modelValue":m[1]||(m[1]=s=>n.value=s)},{default:l(()=>[(c(!0),E($,null,K(o.value,s=>(c(),g(Qe,{key:s.id,value:s.id},{default:l(()=>[s.id===n.value?(c(),g(de,{key:0,class:"pa-2"},{default:l(()=>[(c(),g(Ge(s.component),{modelValue:s.model,"onUpdate:modelValue":p=>s.model=p},null,8,["modelValue","onUpdate:modelValue"]))]),_:2},1024)):A("",!0)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])],64)):A("",!0)}});export{oa as default};
