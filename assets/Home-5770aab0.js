import{I as b,r as F,e as P,w as te,L as z,M as e,N as n,O as o,v as g,S as c,P as l,Q as v,X as f,V as i,H as y,a0 as V,W as u,Y as oe,Z as ne,a1 as X,_ as Z}from"./index-414add58.js";import{G as J}from"./userData-933a9d6d.js";import{_ as ae}from"./LoginView.vue_vue_type_script_setup_true_lang-9328d7f6.js";import{s as L}from"./index-26b71cef.js";import{F as p}from"./form-29fd1dbb.js";import{P as N,a as se,f as le,u as ie}from"./useDisplayTransactions-57359cd6.js";import{S as q,a as re}from"./submission-9dd916bb.js";import{V as ce,u as ue}from"./VSpacer-8dd4e358.js";import{c as M}from"./canEditForm-787038d8.js";import{s as de}from"./sortSubmissions-8ed80f07.js";import{V as ve}from"./VAvatar-ff247812.js";import{V as Q,a as me,b as _e,c as W,d as fe,e as pe}from"./VCard-798f1534.js";import{V as r}from"./VBtn-6a9b03ed.js";import{V as Te,a as ye}from"./VRow-b9b85710.js";import{j as K}from"./VContainer-c6a6a9a0.js";import"./emailFormVariant-e5e0aad4.js";import"./LoginButton-8e412562.js";const Y=m=>(oe("data-v-761444f9"),m=m(),ne(),m),ge=["innerHTML"],Se={key:0},ke={key:0,class:"font-weight-bold float-left pt-1 w-50"},Ie={key:1,class:"pa-1"},he={key:0,class:"font-weight-bold float-left pt-1 w-50"},Ee={key:1},Ue={class:"font-weight-bold float-left pt-1 w-50"},Ce={class:"text-red-darken-4"},Ae={key:1,class:"text-red-darken-4 mt-4"},Re=Y(()=>f("strong",null,"There are forms above that require completion, please edit and save them.",-1)),De=[Re],Fe={class:"v-row"},we={key:0,class:"v-col v-col-10 py-1 v-row mx-0 pl-0"},Oe={class:"v-col v-col-12 v-col-sm-4 v-col-md-3 font-weight-bold pb-0 pr-0"},Pe={class:"v-col v-col-12 v-col-sm-8 v-col-md-9 font-italic pt-0 pt-sm-3 pb-sm-0 pl-sm-0"},Ne={key:1,class:"v-col v-col-10 py-1 v-row mx-0 pl-0"},Me={class:"v-col v-col-12 v-col-sm-4 v-col-md-3 font-weight-bold pb-0 pr-0"},Ve={class:"v-col v-col-12 v-col-sm-8 v-col-md-9 font-italic pt-0 pt-sm-3 pb-sm-0 pl-sm-0"},be={class:"v-col v-col-2 align-self-end text-right py-1 text-no-wrap"},Ye=Y(()=>f("dt",{class:"v-col v-col-9 py-1 font-weight-bold totals"}," Total Charges ",-1)),xe={class:"v-col v-col-3 align-self-end text-right py-1 totals text-no-wrap"},Le=Y(()=>f("dt",{class:"v-col v-col-9 py-1 font-weight-bold"}," Current Payments ",-1)),ze={class:"v-col v-col-3 align-self-end text-right py-1 text-no-wrap"},Ge=Y(()=>f("dt",{class:"v-col v-col-9 py-1 font-weight-bold totals"}," Balance Due ",-1)),$e={class:"v-col v-col-3 align-self-end text-right py-1 totals text-no-wrap"},Be=b({__name:"OpenConvention",props:{convention:{},forms:{default:()=>[]}},setup(m){const h=ue(),U=X(),{getPaymentTransactions:C,totalCharges:E}=ie(),T=F(h.GetConventionLogoURL(m.convention.ConventionUUID)),s=F(),w=F([]),O=P(()=>{var t;return M(m.forms,((t=s.value)==null?void 0:t.Submissions)||[],p.FORM_TYPE_REGISTRATION)}),G=P(()=>{var t;return M(m.forms,((t=s.value)==null?void 0:t.Submissions)||[],p.FORM_TYPE_DEALER)}),$=P(()=>{var t;return M(m.forms,((t=s.value)==null?void 0:t.Submissions)||[],p.FORM_TYPE_ACCOMMODATION)}),B=P(()=>{var t;return M(m.forms,((t=s.value)==null?void 0:t.Submissions)||[],p.FORM_TYPE_ADDITIONAL)}),x=P(()=>{var t,S;return s.value&&((t=s.value)!=null&&t.Submissions)?!!((S=s.value)!=null&&S.Submissions.find(d=>{var R;return((R=d.Form)==null?void 0:R.Type)==p.FORM_TYPE_REGISTRATION&&(d.Status==q.SUBMISSION_STATUS_ACCEPTED||d.Status==q.SUBMISSION_STATUS_CONFIRMED)})):!1}),ee=(t,S)=>t.Type===N.PAYMENT_TRANSACTION_TYPE_CHARGE&&S.Type!==N.PAYMENT_TRANSACTION_TYPE_CHARGE?-1:t.Type!==N.PAYMENT_TRANSACTION_TYPE_CHARGE&&S.Type===N.PAYMENT_TRANSACTION_TYPE_CHARGE||(t.UpdatedAt||0)>(S.UpdatedAt||0)?1:t.UpdatedAt===S.UpdatedAt?0:-1;return te(()=>m.forms,()=>{U.getRegistrationByConvention(m.convention.ConventionUUID).then(t=>{var S;t&&(t.Submissions?(t.Submissions.forEach((d,R)=>{d.Form||(t.Submissions[R].Form=m.forms.find(_=>_.FormUUID===d.FormUUID))}),de(t.Submissions)):t.Submissions=[],s.value=t,x.value&&C(((S=s.value)==null?void 0:S.RegistrationUUID)||"").then(d=>{w.value=d}))})}),(t,S)=>{const d=z("router-link"),R=z("RouterLink");return e(),n(pe,{class:"elevation-5 flex-1-0 d-flex flex-column"},{default:o(()=>[g(_e,{class:"flex-1-1 align-content-start"},{default:o(()=>[T.value?(e(),n(ve,{key:0,src:T.value,title:t.convention.Name,class:"logo text-center"},null,8,["src","title"])):c("",!0),t.convention.Name?(e(),n(Q,{key:1,class:"text-center"},{default:o(()=>[l(v(t.convention.Name),1)]),_:1})):c("",!0),t.convention.Description?(e(),n(me,{key:2,class:"text-wrap subtitle"},{default:o(()=>[f("div",{innerHTML:t.convention.Description},null,8,ge)]),_:1})):c("",!0)]),_:1}),g(W,null,{default:o(()=>{var _,A;return[s.value?(e(),i("dl",Se,[s.value.Reference?(e(),i("dt",ke," Badge No: ")):c("",!0),s.value.Reference?(e(),i("dd",Ie," #"+v(s.value.Reference),1)):c("",!0),(e(!0),i(y,null,V((_=s.value)==null?void 0:_.Submissions,a=>{var k,D,H,j;return e(),i(y,{key:a.SubmissionUUID},[a.Form?(e(),i(y,{key:0},[a.Form?(e(),i("dt",he,v(a.Form.Heading),1)):c("",!0),a.Form?(e(),i("dd",Ee,[l(v(u(re)(a.Status))+" ",1),((k=a.Form)==null?void 0:k.Type)===u(p).FORM_TYPE_REGISTRATION?(e(),n(d,{key:0,to:`/register/${t.convention.Slug||t.convention.ConventionUUID}/registration`},{default:o(()=>{var I;return[(I=a.Form)!=null&&I.State.Edit&&O.value?(e(),n(r,{key:0,size:"small",variant:"text",color:"success"},{default:o(()=>[l(" Edit ")]),_:1})):(e(),n(r,{key:1,size:"small",variant:"text",color:"warning"},{default:o(()=>[l("View")]),_:1}))]}),_:2},1032,["to"])):((D=a.Form)==null?void 0:D.Type)===u(p).FORM_TYPE_ACCOMMODATION?(e(),n(d,{key:1,to:`/register/${t.convention.Slug||t.convention.ConventionUUID}/accommodation`},{default:o(()=>{var I;return[(I=a.Form)!=null&&I.State.Edit&&$.value?(e(),n(r,{key:0,size:"small",variant:"text",color:"success"},{default:o(()=>[l(" Edit ")]),_:1})):(e(),n(r,{key:1,size:"small",variant:"text",color:"warning"},{default:o(()=>[l("View")]),_:1}))]}),_:2},1032,["to"])):((H=a.Form)==null?void 0:H.Type)===u(p).FORM_TYPE_DEALER?(e(),n(d,{key:2,to:`/register/${t.convention.Slug||t.convention.ConventionUUID}/dealer`},{default:o(()=>{var I;return[(I=a.Form)!=null&&I.State.Edit&&G.value?(e(),n(r,{key:0,size:"small",variant:"text",color:"success"},{default:o(()=>[l(" Edit ")]),_:1})):(e(),n(r,{key:1,size:"small",variant:"text",color:"warning"},{default:o(()=>[l("View")]),_:1}))]}),_:2},1032,["to"])):((j=a.Form)==null?void 0:j.Type)===u(p).FORM_TYPE_ADDITIONAL?(e(),n(d,{key:3,to:`/register/${t.convention.Slug||t.convention.ConventionUUID}/additional`},{default:o(()=>{var I;return[(I=a.Form)!=null&&I.State.Edit&&B.value?(e(),n(r,{key:0,size:"small",variant:"text",color:"success"},{default:o(()=>[l(" Edit ")]),_:1})):(e(),n(r,{key:1,size:"small",variant:"text",color:"warning"},{default:o(()=>[l("View")]),_:1}))]}),_:2},1032,["to"])):c("",!0)])):c("",!0)],64)):c("",!0)],64)}),128)),((A=s.value)==null?void 0:A.Submissions.length)>=1?(e(!0),i(y,{key:2},V(t.forms,a=>{var k;return e(),i(y,{key:a.FormUUID},[(k=s.value)!=null&&k.Submissions.find(D=>D.FormUUID===a.FormUUID)?c("",!0):(e(),i(y,{key:0},[f("dt",Ue,v(a.Heading),1),f("dd",Ce,[l(" Requires Completion "),a.Type===u(p).FORM_TYPE_REGISTRATION?(e(),n(d,{key:0,to:`/register/${t.convention.Slug||t.convention.ConventionUUID}/registration`},{default:o(()=>[a.State.Edit&&O.value?(e(),n(r,{key:0,size:"small",variant:"text",color:"success"},{default:o(()=>[l(" Edit ")]),_:1})):(e(),n(r,{key:1,size:"small",variant:"text",color:"warning"},{default:o(()=>[l("View")]),_:1}))]),_:2},1032,["to"])):a.Type===u(p).FORM_TYPE_ACCOMMODATION?(e(),n(d,{key:1,to:`/register/${t.convention.Slug||t.convention.ConventionUUID}/accommodation`},{default:o(()=>[a.State.Edit&&$.value?(e(),n(r,{key:0,size:"small",variant:"text",color:"success"},{default:o(()=>[l(" Edit ")]),_:1})):(e(),n(r,{key:1,size:"small",variant:"text",color:"warning"},{default:o(()=>[l("View")]),_:1}))]),_:2},1032,["to"])):a.Type===u(p).FORM_TYPE_DEALER?(e(),n(d,{key:2,to:`/register/${t.convention.Slug||t.convention.ConventionUUID}/dealer`},{default:o(()=>[a.State.Edit&&G.value?(e(),n(r,{key:0,size:"small",variant:"text",color:"success"},{default:o(()=>[l(" Edit ")]),_:1})):(e(),n(r,{key:1,size:"small",variant:"text",color:"warning"},{default:o(()=>[l("View")]),_:1}))]),_:2},1032,["to"])):a.Type===u(p).FORM_TYPE_ADDITIONAL?(e(),n(d,{key:3,to:`/register/${t.convention.Slug||t.convention.ConventionUUID}/additional`},{default:o(()=>[a.State.Edit&&B.value?(e(),n(r,{key:0,size:"small",variant:"text",color:"success"},{default:o(()=>[l(" Edit ")]),_:1})):(e(),n(r,{key:1,size:"small",variant:"text",color:"warning"},{default:o(()=>[l("View")]),_:1}))]),_:2},1032,["to"])):c("",!0)])],64))],64)}),128)):c("",!0)])):c("",!0),s.value&&s.value.Submissions.length>=1&&t.forms.filter(a=>{var k;return!((k=s.value)!=null&&k.Submissions.find(D=>D.FormUUID==a.FormUUID))}).length?(e(),i("div",Ae,De)):c("",!0)]}),_:1}),g(Q,{class:"pb-4 text-center"},{default:o(()=>[l("Payment Information")]),_:1}),x.value&&s.value?(e(),n(W,{key:0},{default:o(()=>[f("dl",Fe,[(e(!0),i(y,null,V(w.value.sort(ee),_=>{var A;return e(),i(y,{key:_.PaymentTransactionUUID},[_.Type===u(N).PAYMENT_TRANSACTION_TYPE_CHARGE?(e(),i("dt",we,[f("div",Oe,v(_.Description.split(":")[0]),1),f("div",Pe,v(_.Description.split(":")[1]),1)])):(e(),i("dt",Ne,[f("div",Me,v((A=u(se).find(a=>a.value===_.Type))==null?void 0:A.title),1),f("div",Ve," [ "+v(u(le)(_.UpdatedAt||""))+" ] "+v(_.Description),1)])),f("dd",be," £"+v(_.Amount),1)],64)}),128)),Ye,f("dd",xe," £"+v(s.value.Total),1),Le,f("dd",ze," £"+v(s.value.Paid),1),Ge,f("dd",$e," £"+v(s.value.Total-s.value.Paid),1)])]),_:1})):c("",!0),g(fe,null,{default:o(()=>{var _,A;return[t.convention.DetailLink?(e(),n(r,{key:0,color:"orange",href:t.convention.DetailLink},{default:o(()=>[l(v(u(L).buttonDetails),1)]),_:1},8,["href"])):c("",!0),g(ce),O.value?(e(),i(y,{key:1},[(_=s.value)!=null&&_.Submissions.find(a=>{var k;return((k=a.Form)==null?void 0:k.Type)===u(p).FORM_TYPE_REGISTRATION})?(e(),n(R,{key:1,to:`/register/${t.convention.Slug||t.convention.ConventionUUID}`},{default:o(()=>[g(r,{color:"primary"},{default:o(()=>[l(v(u(L).buttonViewRegistration),1)]),_:1})]),_:1},8,["to"])):(e(),i(y,{key:0},[(A=t.forms.find(a=>a.Type===u(p).FORM_TYPE_REGISTRATION))!=null&&A.State.New?(e(),n(R,{key:0,to:`/register/${t.convention.Slug||t.convention.ConventionUUID}`},{default:o(()=>[g(r,{color:"primary"},{default:o(()=>[l(v(u(L).buttonRegister),1)]),_:1})]),_:1},8,["to"])):c("",!0)],64))],64)):(x.value,c("",!0))]}),_:1})]),_:1})}}});const He=Z(Be,[["__scopeId","data-v-761444f9"]]),je=b({__name:"Conventions",setup(m){const h=X(),U=F([]),C=F([]);return h.getOpenConventionsList().then(E=>{E&&(U.value=[...U.value,...E],h.getAvailableConventionForms(U.value.map(T=>T.ConventionUUID)).then(T=>{C.value=[...C.value,...T]}).catch(T=>{console.error(T)}))}),(E,T)=>(e(),n(K,null,{default:o(()=>[g(ye,{class:"justify-center"},{default:o(()=>[(e(!0),i(y,null,V(U.value,s=>(e(),n(Te,{key:s.ConventionUUID,cols:"12",sm:"11",md:"11",lg:"8",xl:"6",class:"d-flex flex-column"},{default:o(()=>[g(He,{convention:s,forms:C.value.filter(w=>w.ConventionUUID===s.ConventionUUID)},null,8,["convention","forms"])]),_:2},1024))),128))]),_:1})]),_:1}))}}),qe={};function Qe(m,h){return e(),i("div")}const We=Z(qe,[["render",Qe]]),Xe=b({__name:"MainView",emits:["pageTitle"],setup(m,{emit:h}){h("pageTitle","Scotiacon Registration System"),sessionStorage.getItem("reload")==="true"&&(sessionStorage.removeItem("reload"),setTimeout(()=>{location.reload()},500));const C=localStorage.getItem("gjt_token"),E=localStorage.getItem("ajt_token");C?(localStorage.removeItem("gjt_token"),location.href=C):E&&(localStorage.removeItem("ajt_token"),location.href=E);const T=F(J());return(s,w)=>{const O=z("router-link");return e(),i(y,null,[T.value&&!T.value.Additional.Email?(e(),n(K,{key:0,class:"bg-red-darken-4 text-center",fluid:!0},{default:o(()=>[l(" Please enter a Contact Email on the "),g(O,{to:"/profile",class:"text-white font-weight-bold"},{default:o(()=>[l("manage account page")]),_:1}),l(" to ensure we can contact you. ")]),_:1})):c("",!0),g(je),g(We)],64)}}}),_t=b({__name:"Home",emits:["pageTitle"],setup(m,{emit:h}){const U=J();return h("pageTitle","Telegram Login"),(C,E)=>(e(),i("div",null,[u(U)?(e(),n(Xe,{key:0,onPageTitle:E[0]||(E[0]=T=>h("pageTitle",T))})):(e(),n(ae,{key:1}))]))}});export{_t as default};
