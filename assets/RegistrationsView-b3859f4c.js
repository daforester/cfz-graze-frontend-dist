import{p as zt,n as Qt,e as re,t as pe,c as Ra,G as ct,v as t,H as w,x as Re,I as ee,a0 as se,a1 as Te,r as f,K as ve,M as d,N as M,O as a,a3 as Ae,W as $,a2 as Je,a4 as ae,S as B,w as de,X as L,Q as R,V as I,P as V,_ as ot,ac as Ca,ad as Va,E as Be,k as Oa,f as ba,d as ha,o as ka,ae as kt,R as Ma,Y as Kt,Z as Wt,aa as Qe,af as Na,ag as at,z as La,u as wa,ah as Pa,A as Fa,B as $a,D as xa,s as Ba,ai as lt,aj as Mt,a7 as Ga,a6 as Ya,U as Ha}from"./index-cd383e18.js";import{e as ja,T as qa,V as Jt,d as za,c as Qa}from"./FormRenderer.vue_vue_type_style_index_0_lang-88cff31d.js";import{a as Ka,F as Ie}from"./form-29fd1dbb.js";import{_ as Ge}from"./ModelDialog.vue_vue_type_script_setup_true_lang-8722cf12.js";import{m as Wa,k as Ja,l as Xa,n as Za,o as el,p as tl,q as al,u as ll,r as nl,s as ol,t as il,v as sl,w as ul,x as rl,y as dl,z as Nt,A as Lt,B as wt,a as Xt,_ as Zt,f as Pt,g as ea,h as ta,c as pt,d as At,e as Tt,b as yt,V as Et,j as aa,i as he}from"./VWindowItem-3ca0e5c5.js";import{V as W,a as k}from"./VRow-c0a1c3bf.js";import{V as Ue}from"./VTextField-ae7a65f9.js";import{V as ce}from"./copyToClipboard-5f33789b.js";import{u as la,j as fe,V as ft,b as ml,m as vl,k as cl,c as fl,d as Ul,l as gl,a as _l,n as pl}from"./VContainer-8685a99a.js";import{V as na,u as Ze}from"./VCheckbox-7d855848.js";import{v as Ce}from"./v4-a960c1f4.js";import{h as ze,b as oa,a as Al,c as Tl,d as Ft,P as Ut,u as ia}from"./useDisplayTransactions-b46d034a.js";import{V as nt,a as Ke}from"./VList-c7217fda.js";import{V as j,a as yl,u as El}from"./VBtn-c3667f22.js";import{b as Sl,c as sa,d as $t}from"./submission-6136b51d.js";import{G as St}from"./group-d2a77946.js";import{C as Dt}from"./canDo-c4127599.js";import{V as ua}from"./VAvatar-65db0b77.js";import{s as Dl}from"./sortSubmissions-8ed80f07.js";import{a as ra,V as ke}from"./scopeId-7b720ea7.js";import{V as Me,b as Ye,c as Ne,d as It,e as Ve}from"./VCard-d99fad77.js";import{_ as Xe,V as da}from"./SaveButton.vue_vue_type_script_setup_true_lang-2c03727f.js";import{_ as Il}from"./DeleteDialog.vue_vue_type_script_setup_true_lang-e8fc29e3.js";import{a as ma,V as gt}from"./VToolbar-99a3c2ab.js";import{V as Rl}from"./VDivider-e5677cb9.js";import{V as Cl}from"./VTextarea-8cc0aa04.js";import{V as Vl,a as Ol}from"./VChip-7a5813fd.js";import{V as _t}from"./VDialog-7a3bea0f.js";import{V as bl}from"./VForm-93cbdeaa.js";import{G as Rt}from"./userData-c2f22cc3.js";import{V as hl,a as kl}from"./VAlert-670742a8.js";import{S as Ml}from"./setupLogin-5f5638ad.js";import{V as Nl}from"./forwardRefs-a7644821.js";import{u as mt}from"./nil-d01db1aa.js";import{V as xt,a as Ll}from"./VTable-bab069db.js";import"./index-26b71cef.js";import"./VFileInput-5f30efd5.js";import"./VToolbarItems-1ad81476.js";import"./createSimpleFunctional-aa71137c.js";var va=(e=>(e.ADMIN_LAYOUT_PANELS="ADMIN_LAYOUT_PANELS",e.ADMIN_LAYOUT_TABLE="ADMIN_LAYOUT_TABLE",e))(va||{});const wl=[{title:"Panel Layout",value:"ADMIN_LAYOUT_PANELS"},{title:"Table Layout",value:"ADMIN_LAYOUT_TABLE"}];var We=(e=>(e.LAYOUT_ITEM_SOURCE_FORM="LAYOUT_ITEM_SOURCE_FORM",e.LAYOUT_ITEM_SOURCE_META="LAYOUT_ITEM_SOURCE_META",e.LAYOUT_ITEM_SOURCE_USER="LAYOUT_ITEM_SOURCE_USER",e))(We||{});const Pl=[{title:"Form Field Submission Data",value:"LAYOUT_ITEM_SOURCE_FORM"},{title:"Miscellaneous Data",value:"LAYOUT_ITEM_SOURCE_META"},{title:"User Profile Data",value:"LAYOUT_ITEM_SOURCE_USER"}];var te=(e=>(e.META_DATA_SOURCE_ACCOMMODATION_ALLOCATION="META_DATA_SOURCE_ACCOMMODATION_ALLOCATION",e.META_DATA_SOURCE_ACCOMMODATION_FORM="META_DATA_SOURCE_ACCOMMODATION_FORM",e.META_DATA_SOURCE_BADGE_FORM="META_DATA_SOURCE_BADGE_FORM",e.META_DATA_SOURCE_DEALER_FORM="META_DATA_SOURCE_DEALER_FORM",e.META_DATA_SOURCE_PAYMENT_STATUS="META_DATA_SOURCE_PAYMENT_STATUS",e.META_DATA_SOURCE_REGISTRATION_ACTIONS="META_DATA_SOURCE_REGISTRATION_ACTIONS",e.META_DATA_SOURCE_REGISTRATION_FORM="META_DATA_SOURCE_REGISTRATION_FORM",e.META_DATA_SOURCE_REGISTRATION_GROUP="META_DATA_SOURCE_REGISTRATION_GROUP",e.META_DATA_SOURCE_REGISTRATION_REFERENCE="META_DATA_SOURCE_REGISTRATION_REFERENCE",e.META_DATA_SOURCE_SUBMISSION_DATE="META_DATA_SOURCE_SUBMISSION_DATE",e.META_DATA_SOURCE_SUBMISSION_STATUS="META_DATA_SOURCE_SUBMISSION_STATUS",e))(te||{});const Fl=[{title:"Accommodation Allocation",value:"META_DATA_SOURCE_ACCOMMODATION_ALLOCATION"},{title:"Accommodation Form",value:"META_DATA_SOURCE_ACCOMMODATION_FORM"},{title:"Actions",value:"META_DATA_SOURCE_REGISTRATION_ACTIONS"},{title:"Badge Form",value:"META_DATA_SOURCE_BADGE_FORM"},{title:"Dealer Form",value:"META_DATA_SOURCE_DEALER_FORM"},{title:"Payment Status",value:"META_DATA_SOURCE_PAYMENT_STATUS"},{title:"Registration Group",value:"META_DATA_SOURCE_REGISTRATION_GROUP"},{title:"Registration Reference",value:"META_DATA_SOURCE_REGISTRATION_REFERENCE"},{title:"Registration Form",value:"META_DATA_SOURCE_REGISTRATION_FORM"},{title:"Submission Date",value:"META_DATA_SOURCE_SUBMISSION_DATE"},{title:"Submission Status",value:"META_DATA_SOURCE_SUBMISSION_STATUS"}];var ie=(e=>(e.USER_DATA_SOURCE_NULL="",e.USER_DATA_SOURCE_DISPLAY_NAME="USER_DATA_SOURCE_DISPLAY_NAME",e.USER_DATA_SOURCE_HANDLE="USER_DATA_SOURCE_HANDLE",e.USER_DATA_SOURCE_AVATAR="USER_DATA_SOURCE_AVATAR",e.USER_DATA_SOURCE_FIRST_NAME="USER_DATA_SOURCE_FIRST_NAME",e.USER_DATA_SOURCE_LAST_NAME="USER_DATA_SOURCE_LAST_NAME",e.USER_DATA_SOURCE_DATE_OF_BIRTH="USER_DATA_SOURCE_DATE_OF_BIRTH",e.USER_DATA_SOURCE_EMAIL="USER_DATA_SOURCE_EMAIL",e.USER_DATA_SOURCE_TELEGRAM="USER_DATA_SOURCE_TELEGRAM",e))(ie||{});const $l=[{title:"Display Name",value:"USER_DATA_SOURCE_DISPLAY_NAME"},{title:"Handle",value:"USER_DATA_SOURCE_HANDLE"},{title:"Avatar",value:"USER_DATA_SOURCE_AVATAR"},{title:"First Name",value:"USER_DATA_SOURCE_FIRST_NAME"},{title:"Last Name",value:"USER_DATA_SOURCE_LAST_NAME"},{title:"Date of Birth",value:"USER_DATA_SOURCE_DATE_OF_BIRTH"},{title:"Email Address",value:"USER_DATA_SOURCE_EMAIL"},{title:"Telegram Username",value:"USER_DATA_SOURCE_TELEGRAM"}],xl=e=>{switch(e){case"EMAIL_STATUS_QUEUED":return"Queued";case"EMAIL_STATUS_QUEUE_ERROR":return"Processing";case"EMAIL_STATUS_QUEUE_FAILURE":return"Internal Error";case"EMAIL_STATUS_SENDING":return"Sending";case"EMAIL_STATUS_SENT":return"Sent";case"EMAIL_STATUS_SEND_ERROR":return"Failed to Send"}return"Unknown"},Bl=e=>e===void 0?!1:Dt(e,St.GROUP_TYPE_SYSTEM).ManageUsers,Gl=zt({itemsLength:{type:[Number,String],required:!0},...Wa(),...Ja(),...Xa()},"VDataTableServer"),Yl=Qt()({name:"VDataTableServer",props:Gl(),emits:{"update:modelValue":e=>!0,"update:page":e=>!0,"update:itemsPerPage":e=>!0,"update:sortBy":e=>!0,"update:options":e=>!0,"update:expanded":e=>!0,"update:groupBy":e=>!0,"click:row":(e,U)=>!0},setup(e,U){let{emit:o,slots:i}=U;const{groupBy:n}=Za(e),{sortBy:l,multiSort:r,mustSort:s}=el(e),{page:m,itemsPerPage:E}=tl(e),c=re(()=>parseInt(e.itemsLength,10)),{columns:p,headers:u}=al(e,{groupBy:n,showSelect:pe(e,"showSelect"),showExpand:pe(e,"showExpand")}),{items:g}=ll(e,p),{toggleSort:v}=nl({sortBy:l,multiSort:r,mustSort:s,page:m}),{opened:Q,isGroupOpen:P,toggleGroup:h,extractRows:C}=ol({groupBy:n,sortBy:l}),{pageCount:N,setItemsPerPage:z}=il({page:m,itemsPerPage:E,itemsLength:c}),{flatItems:G}=sl(g,n,Q),{isSelected:J,select:K,selectAll:A,toggleSelect:T,someSelected:S,allSelected:O}=ul(e,{allItems:g,currentPage:g}),{isExpanded:F,toggleExpand:Z}=rl(e),me=re(()=>C(g.value));dl({page:m,itemsPerPage:E,sortBy:l,groupBy:n,search:pe(e,"search")}),Ra("v-data-table",{toggleSort:v,sortBy:l}),ct({VDataTableRows:{hideNoData:pe(e,"hideNoData"),noDataText:pe(e,"noDataText"),loading:pe(e,"loading"),loadingText:pe(e,"loadingText")}});const ne=re(()=>({page:m.value,itemsPerPage:E.value,sortBy:l.value,pageCount:N.value,toggleSort:v,setItemsPerPage:z,someSelected:S.value,allSelected:O.value,isSelected:J,select:K,selectAll:A,toggleSelect:T,isExpanded:F,toggleExpand:Z,isGroupOpen:P,toggleGroup:h,items:me.value,groupedItems:G.value,columns:p.value,headers:u.value}));la(()=>{const[Le]=Nt.filterProps(e),[we]=Lt.filterProps(e),[Pe]=wt.filterProps(e),[Fe]=xt.filterProps(e);return t(xt,Re({class:["v-data-table",{"v-data-table--loading":e.loading},e.class],style:e.style},Fe),{top:()=>{var ge;return(ge=i.top)==null?void 0:ge.call(i,ne.value)},default:()=>{var ge,_e,ye,He;return i.default?i.default(ne.value):t(w,null,[(ge=i.colgroup)==null?void 0:ge.call(i,ne.value),t("thead",{class:"v-data-table__thead",role:"rowgroup"},[t(Lt,Re(we,{sticky:e.fixedHeader}),i)]),(_e=i.thead)==null?void 0:_e.call(i,ne.value),t("tbody",{class:"v-data-table__tbody",role:"rowgroup"},[i.body?i.body(ne.value):t(wt,Re(Pe,{items:G.value}),i)]),(ye=i.tbody)==null?void 0:ye.call(i,ne.value),(He=i.tfoot)==null?void 0:He.call(i,ne.value)])},bottom:()=>i.bottom?i.bottom(ne.value):t(Nt,Le,{prepend:i["footer.prepend"]})})})}}),Hl=ee({__name:"EditAdminLayout",props:se({title:{default:""},layout:{}},{modelValue:{type:Boolean,required:!0}}),emits:se(["save"],["update:modelValue"]),setup(e,{emit:U}){const o=Te(e,"modelValue"),i=f(ve(e.layout)),n=f([]),l=Ae(),r=({callback:c})=>{const p=()=>{c&&c("Failed to Save Layout")},u=()=>{c&&c("Layout Saved")};l.saveAdminLayout(i.value).then(g=>{g?(u(),U("save",g)):p()}).catch(()=>{p()})},s=()=>({ID:0,LayoutPanelUUID:Ce(),AdminLayoutID:i.value.ID,AdminLayoutUUID:i.value.AdminLayoutUUID,Name:"",Order:i.value.Panels.length+1,Items:[],RequiredFormType:Ie.FORM_TYPE_NIL,RequiredGroupMemberships:[],RequiredRegistrationTags:[]}),m=c=>()=>({ID:0,LayoutItemUUID:Ce(),LayoutPanelID:c.ID,LayoutPanelUUID:c.LayoutPanelUUID,Label:"",SourceType:We.LAYOUT_ITEM_SOURCE_FORM,SectionFieldID:void 0,SectionFieldUUID:void 0,SectionField:void 0,MetaField:void 0,UserField:void 0,Align:"",Order:c.Items.length+1,DefaultSort:!1}),E=c=>{const p=n.value.find(u=>u.value===c.SectionFieldUUID);p&&(c.SectionFieldID=p.object.ID,c.SectionField=p.object)};return l.getConventionForms(e.layout.ConventionUUID).then(c=>{c.forEach(p=>p.Sections.forEach(u=>u.Fields&&n.value.push(...u.Fields.map(g=>{var Q;return{title:`${p.Name} - ${u.Name} - ${(Q=g.Field)==null?void 0:Q.Name}`,value:g.SectionFieldUUID,object:g}})))),n.value.sort(ja("title"))}),(c,p)=>(d(),M(Ge,{modelValue:o.value,"onUpdate:modelValue":p[3]||(p[3]=u=>o.value=u),onSave:r,title:c.title,color:"primary",fullscreen:!0,persistent:!0},{default:a(()=>[t(fe,{class:"px-0 mx-0",fluid:!0},{default:a(()=>[t(W,null,{default:a(()=>[t(k,{cols:"12",sm:"6"},{default:a(()=>[t(Ue,{modelValue:i.value.Name,"onUpdate:modelValue":p[0]||(p[0]=u=>i.value.Name=u),label:"Name",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),t(k,{cols:"12",sm:"6"},{default:a(()=>[t(ce,{modelValue:i.value.Type,"onUpdate:modelValue":p[1]||(p[1]=u=>i.value.Type=u),label:"Layout Type",items:$(wl),"item-title":"title","item-value":"value",variant:"outlined","hide-details":""},null,8,["modelValue","items"])]),_:1})]),_:1})]),_:1}),t(Pt,{modelValue:i.value.Panels,"onUpdate:modelValue":p[2]||(p[2]=u=>i.value.Panels=u),"new-item":s,closeable:!1,title:"Panels",label:"Name","slot-name-prefix":"panel"},Je({_:2},[ae(i.value.Panels,(u,g)=>({name:`panel_${g}`,fn:a(()=>[t(fe,{class:"px-0 mx-0",fluid:!0},{default:a(()=>[t(W,null,{default:a(()=>[t(k,{cols:"12",sm:"6"},{default:a(()=>[t(Ue,{modelValue:u.Name,"onUpdate:modelValue":v=>u.Name=v,label:"Name",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),t(k,{cols:"12",sm:"6"},{default:a(()=>[t(ce,{modelValue:u.RequiredFormType,"onUpdate:modelValue":v=>u.RequiredFormType=v,items:$(Ka),clearable:!0,label:"Required Form",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"])]),_:2},1024)]),_:2},1024),t(W,null,{default:a(()=>[t(k,{cols:"12",sm:"6"},{default:a(()=>[t(Xt,{label:"Required Groups",variant:"outlined",modelValue:u.RequiredGroupMemberships,"onUpdate:modelValue":v=>u.RequiredGroupMemberships=v,convention:i.value.ConventionUUID,chips:"",clearable:"",hint:"Groups that a user must be in to see this form. (Any one)"},null,8,["modelValue","onUpdate:modelValue","convention"])]),_:2},1024),t(k,{cols:"12",sm:"6"},{default:a(()=>[t(Zt,{label:"Registration Tags",variant:"outlined",modelValue:u.RequiredRegistrationTags,"onUpdate:modelValue":v=>u.RequiredRegistrationTags=v,convention:i.value.ConventionUUID,chips:"",clearable:"",hint:"Tags that a registration must have to appear in results. (Any one)"},null,8,["modelValue","onUpdate:modelValue","convention"])]),_:2},1024)]),_:2},1024)]),_:2},1024),t(Pt,{modelValue:u.Items,"onUpdate:modelValue":v=>u.Items=v,"new-item":m(u),closeable:!1,title:"Items",label:"Label","slot-name-prefix":"item"},Je({_:2},[ae(u.Items,(v,Q)=>({name:`item_${Q}`,fn:a(()=>[t(fe,{class:"px-0 mx-0",fluid:!0},{default:a(()=>[t(W,null,{default:a(()=>[t(k,{cols:"12",sm:"6"},{default:a(()=>[t(Ue,{modelValue:v.Label,"onUpdate:modelValue":P=>v.Label=P,label:"Name",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024),t(W,null,{default:a(()=>[t(k,{cols:"12",sm:"6"},{default:a(()=>[t(ce,{modelValue:v.SourceType,"onUpdate:modelValue":P=>v.SourceType=P,label:"Source Type",items:$(Pl),"item-title":"title","item-value":"value",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"])]),_:2},1024),t(k,{cols:"12",sm:"6"},{default:a(()=>[v.SourceType==="LAYOUT_ITEM_SOURCE_FORM"?(d(),M(ce,{key:0,modelValue:v.SectionFieldUUID,"onUpdate:modelValue":P=>v.SectionFieldUUID=P,label:"Form Data",items:n.value,"item-title":"title","item-value":"value",variant:"outlined","hide-details":"",onBlur:P=>E(v)},null,8,["modelValue","onUpdate:modelValue","items","onBlur"])):v.SourceType==="LAYOUT_ITEM_SOURCE_META"?(d(),M(ce,{key:1,modelValue:v.MetaField,"onUpdate:modelValue":P=>v.MetaField=P,label:"Miscellaneous Data",items:$(Fl),"item-title":"title","item-value":"value",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"])):v.SourceType==="LAYOUT_ITEM_SOURCE_USER"?(d(),M(ce,{key:2,modelValue:v.UserField,"onUpdate:modelValue":P=>v.UserField=P,label:"User Profile Data",items:$($l),"item-title":"title","item-value":"value",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"])):B("",!0)]),_:2},1024)]),_:2},1024),t(W,null,{default:a(()=>[t(k,null,{default:a(()=>[t(na,{modelValue:v.DefaultSort,"onUpdate:modelValue":P=>v.DefaultSort=P,label:"Default Sort","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)]),_:2},1024)])}))]),1032,["modelValue","onUpdate:modelValue","new-item"])])}))]),1032,["modelValue"])]),_:1},8,["modelValue","title"]))}}),jl=L("br",null,null,-1),ql=L("h3",null,"Assigned Accommodation",-1),zl=L("br",null,null,-1),Ql=L("br",null,null,-1),Kl=L("h3",null,"Accommodation Preferences",-1),Wl=L("h3",null,"Selected Tickets",-1),Jl=L("br",null,null,-1),Xl=ee({__name:"EditAccommodationAssignmentDialog",props:se({convention:{},registration:{},selectedAccommodation:{},title:{}},{modelValue:{type:Boolean,required:!0}}),emits:se(["update:field"],["update:modelValue"]),setup(e,{emit:U}){const o=e,{convention:i,registration:n,title:l=""}=o,r=Ae(),s=Te(e,"modelValue"),m=f({capacity:{max:A=>{var O;const T=N.value.find(F=>F.room.RoomUUID===A);return!T||T.room.MaximumCapacity===0?!0:(((O=u.value)==null?void 0:O.Members.length)||0)<=T.room.MaximumCapacity||"Too many people in the group for this room"},min:A=>{var O;const T=N.value.find(F=>F.room.RoomUUID===A);return!T||T.room.MinimumCapacity===0?!0:(((O=u.value)==null?void 0:O.Members.length)||0)>=T.room.MinimumCapacity||"Not enough people in the group for this room"}}}),E=f([]),c=Ze(o,U,void 0,void 0,"field"),p=f(ve(c.value));de(c,()=>{p.value=ve(c.value)});const u=f(),g=f(""),v=f(""),Q=f([]),P=f({Ticket:[],AddonsChecked:[],ComponentsChecked:[]}),h=async()=>{var O;const A=await r.getConventionAvailableAccommodation(i.ConventionUUID);A&&(E.value=A);const T=await r.getRegistrationGroup(n.RegistrationUUID||"");T&&(u.value=T);const S=await r.getConventionTickets(i.ConventionUUID);S&&(Q.value=S);try{P.value=JSON.parse(((O=u.value)==null?void 0:O.TicketData)||"")}catch{}};de(g,()=>{v.value=N.value.length>0?N.value[0].value:""});const C=re(()=>{const A=z.value;return E.value.map(T=>{let S;return A.forEach(O=>{T.Costs.forEach(F=>{F.DateStart===(O==null?void 0:O.DateStart)&&F.DateEnd===O.DateEnd&&(S===void 0||S>F.Availability)&&(S=F.Availability)})}),{label:`${T.Name}`,title:`${T.Name} (${S} Available)`,value:T.AccommodationUUID}})}),N=re(()=>{const A=z.value,T=E.value.find(S=>S.AccommodationUUID===g.value);return(T==null?void 0:T.Pool.map(S=>{var F,Z;let O;return A.forEach(me=>{S.Costs.forEach(ne=>{ne.DateStart===(me==null?void 0:me.DateStart)&&ne.DateEnd===me.DateEnd&&(O===void 0||O>ne.Availability)&&(O=ne.Availability)})}),{label:`${(F=S.Venue)==null?void 0:F.Name} - ${S.Name}`,title:`${(Z=S.Venue)==null?void 0:Z.Name} - ${S.Name} (${O} Available)`,value:S.RoomUUID,room:S}}))||[]}),z=re(()=>[...P.value.Ticket,...P.value.AddonsChecked,...P.value.ComponentsChecked].map(A=>Q.value.find(T=>T.TicketUUID===A)).filter(A=>A!==void 0&&A.RequiresAccommodation)),G=A=>{var T;r.assignAccommodation(((T=u.value)==null?void 0:T.Registration.RegistrationUUID)||"",g.value,v.value,!1).then(S=>{S?(h(),A&&A("Room Assigned")):A&&A("Room not assigned")}).catch(()=>{A&&A("Room not assigned")})},J=A=>{var T,S;(T=u.value)!=null&&T.Registration.AllocationUUID?r.deleteAllocation(((S=u.value)==null?void 0:S.Registration.AllocationUUID)||"").then(O=>{O?(h(),A&&A("Allocation Deleted")):A&&A("Allocation not deleted")}).catch(()=>{A&&A("Allocation not deleted")}):A&&A("Nothing to Delete")},K=A=>{var S,O;const T=(S=E.value.find(F=>F.AccommodationUUID===A.AccommodationUUID))==null?void 0:S.Pool;if(T){const F=T.find(Z=>Z.RoomUUID===A.RoomUUID);if(F)return`${(O=F.Venue)==null?void 0:O.Name} - ${F.Name}`}return""};return h(),(A,T)=>{var S;return d(),M(Ge,{modelValue:s.value,"onUpdate:modelValue":T[2]||(T[2]=O=>s.value=O),title:$(l),color:"primary","show-close-action":!0,"show-delete-action":!!((S=u.value)!=null&&S.Registration.Allocation),"show-save-action":!!v.value,"save-button-label":"Assign Room",onDelete:J,onSave:G,fullscreen:!0,persistent:!0},{default:a(()=>[t(fe,{class:"pa-0",fluid:!0},{default:a(()=>[t(W,null,{default:a(()=>{var O;return[t(k,{cols:"12",md:"6"},{default:a(()=>{var F,Z;return[L("h3",null,"Group Members ("+R((F=u.value)==null?void 0:F.Members.length)+")",1),(d(!0),I(w,null,ae((Z=u.value)==null?void 0:Z.Members,me=>(d(),I(w,{key:me.UUID},[V(" #"+R(me.Reference)+" "+R(me.Name),1),jl],64))),128))]}),_:1}),(O=u.value)!=null&&O.Registration.Allocation?(d(),M(k,{key:0,cols:"12",md:"6"},{default:a(()=>[ql,t(nt,null,{default:a(()=>{var F;return[(d(!0),I(w,null,ae((F=u.value)==null?void 0:F.Registration.Allocation.Periods,Z=>(d(),M(Ke,{key:Z.AllocationPeriodUUID},{default:a(()=>{var me;return[V(R((me=E.value.find(ne=>ne.AccommodationUUID===Z.AccommodationUUID))==null?void 0:me.Name)+" ",1),zl,V(" "+R(K(Z))+" ",1),Ql,L("small",null,"("+R($(ze)(Z.DateStart))+" - "+R($(ze)(Z.DateEnd))+")",1)]}),_:2},1024))),128))]}),_:1})]),_:1})):B("",!0)]}),_:1}),t(W,null,{default:a(()=>[t(k,{cols:"12",md:"6"},{default:a(()=>[A.selectedAccommodation.length?(d(),I(w,{key:0},[Kl,t(nt,null,{default:a(()=>[(d(!0),I(w,null,ae(A.selectedAccommodation,(O,F)=>(d(),M(Ke,{key:O.AccommodationUUID},{default:a(()=>[V(R(F+1)+". "+R(O.Name),1)]),_:2},1024))),128))]),_:1})],64)):B("",!0)]),_:1}),t(k,{cosl:"12",md:"6"},{default:a(()=>[Wl,t(nt,null,{default:a(()=>[(d(!0),I(w,null,ae(z.value,O=>(d(),M(Ke,{key:O==null?void 0:O.TicketUUID},{default:a(()=>[V(R(O.Name)+" ",1),Jl,L("small",null,"("+R($(ze)(O.DateStart))+" - "+R($(ze)(O.DateEnd))+")",1)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1}),t(W,null,{default:a(()=>[t(k,{cols:"12",md:"6"},{default:a(()=>[t(ce,{modelValue:g.value,"onUpdate:modelValue":T[0]||(T[0]=O=>g.value=O),items:C.value,"item-title":"title","item-value":"value",label:"Accommodation"},null,8,["modelValue","items"])]),_:1}),t(k,{cols:"12",md:"6"},{default:a(()=>[t(ce,{modelValue:v.value,"onUpdate:modelValue":T[1]||(T[1]=O=>v.value=O),items:N.value,"item-title":"title","item-value":"value",label:"Room Pool",rules:[m.value.capacity.min,m.value.capacity.max]},null,8,["modelValue","items","rules"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue","title","show-delete-action","show-save-action"])}}}),Zl={key:0,class:"accommodationList"},en={key:0,class:"text-orange-darken-2"},tn=ee({__name:"DataTableItemAccommodation",props:{accommodations:{default:()=>[]},convention:{},forms:{},registration:{},tickets:{default:()=>[]},value:{default:""},venues:{}},setup(e){const U=f(!1),o=re(()=>{if(!e.value)return[];const n=JSON.parse(e.value),l=e.accommodations.filter(r=>n.includes(r.AccommodationUUID)).sort((r,s)=>{const m=n.findIndex(c=>c===r.AccommodationUUID),E=n.findIndex(c=>c===s.AccommodationUUID);return m>E?1:-1});return ve(l)}),i=re(()=>{let n;const l=e.forms.find(r=>r.Sections.find(s=>{var m;return(m=s.Fields)==null?void 0:m.find(E=>{var c;if(((c=E.Field)==null?void 0:c.Type)==="TICKET")return n=E,!0})}));return n?!!e.registration.Submissions.find(r=>{if(r.FormUUID==(l==null?void 0:l.FormUUID))return r.Data.find(s=>{if(s.SectionFieldUUID==(n==null?void 0:n.SectionFieldUUID)){const m=JSON.parse(s.Data);return e.tickets.filter(E=>E.RequiresAccommodation).find(E=>m.Ticket.includes(E.TicketUUID)||m.AddonsChecked.includes(E.TicketUUID)||m.ComponentsChecked.includes(E.TicketUUID))}})}):!1});return(n,l)=>i.value?(d(),I(w,{key:0},[n.value?(d(),I("ol",Zl,[(d(!0),I(w,null,ae(o.value,r=>(d(),I("li",{key:r.AccommodationUUID},[n.registration&&n.registration.Allocation&&n.registration.Allocation.Periods.find(s=>s.AccommodationUUID===r.AccommodationUUID)?(d(),I("strong",en,R(r.Name),1)):(d(),I(w,{key:1},[V(R(r.Name),1)],64))]))),128))])):B("",!0),t(j,{onClick:l[0]||(l[0]=r=>U.value=!0),variant:"flat",color:"success"},{default:a(()=>[V("Assign Accommodation")]),_:1}),n.convention&&U.value?(d(),M(Xl,{key:1,modelValue:U.value,"onUpdate:modelValue":l[1]||(l[1]=r=>U.value=r),title:"Accommodation Allocation",convention:n.convention,registration:n.registration,"selected-accommodation":o.value},null,8,["modelValue","convention","registration","selected-accommodation"])):B("",!0)],64)):B("",!0)}});const an=ot(tn,[["__scopeId","data-v-7a102d46"]]),ln={key:0,class:"addonList"},nn={key:0},on={key:0},sn=ee({__name:"DataTableItemExtras",props:{extras:{default:()=>[]},value:{default:""}},setup(e){const U=re(()=>{if(!e.value)return;const o=JSON.parse(e.value),i=Object.keys(o),n=ve(e.extras);return n.forEach(l=>{l.Options=l.Options.filter(r=>i.includes(r.OptionUUID)?(r.Choices=r.Choices.filter(s=>s.TagUUID===o[r.OptionUUID].choiceId),o[r.OptionUUID].checked):!1)}),n.filter(l=>l.Options.length>0),n});return(o,i)=>o.value?(d(),I("ul",ln,[(d(!0),I(w,null,ae(U.value,n=>(d(),I(w,{key:n.ExtraUUID},[n.Options.length?(d(),I("li",nn,[L("strong",null,R(n.Name),1),L("ul",null,[(d(!0),I(w,null,ae(n.Options,l=>(d(),I("li",{key:l.OptionUUID},[V(R(l.Name)+" ",1),l.Choices.length==1?(d(),I("small",on,"("+R(l.Choices[0].Title)+")",1)):B("",!0)]))),128))])])):B("",!0)],64))),128))])):B("",!0)}});const un=ot(sn,[["__scopeId","data-v-55786e01"]]),rn={key:0},dn=ee({__name:"DataTableItemInterests",props:{interests:{default:()=>[]},value:{default:""}},setup(e){const U=re(()=>{if(!e.value)return;const o=JSON.parse(e.value);return Object.entries(o).filter(([,i])=>i).map(([i,n])=>e.interests.find(l=>l.InterestUUID===i)).filter(i=>i!==void 0)});return(o,i)=>o.value?(d(),I("ul",rn,[(d(!0),I(w,null,ae(U.value,n=>(d(),I("li",{key:n.InterestUUID},R(n.Name),1))),128))])):B("",!0)}}),mn=L("br",null,null,-1),vn=L("small",null,"Options:",-1),cn=L("br",null,null,-1),fn=L("small",null,"Addons:",-1),Un=ee({__name:"DataTableItemTicket",props:{tickets:{default:()=>[]},value:{default:""}},setup(e){const U=re(()=>{if(!e.value)return;let o={Ticket:[],AddonsChecked:[],ComponentsChecked:[]};try{o=JSON.parse(e.value),"ticket"in o&&(o.Ticket=o.ticket),"addonsChecked"in o&&(o.AddonsChecked=o.addonsChecked),"componentsChecked"in o&&(o.ComponentsChecked=o.componentsChecked)}catch{}return o.Ticket.filter(i=>{const n=e.tickets.find(l=>l.TicketUUID===i);return!(!n||n.Type!==qa.TICKET_TYPE_TICKET)}).map(i=>{const n=e.tickets.find(r=>r.TicketUUID===i),l=ve(n);return l.TicketComponents=n.TicketComponents.filter(r=>o.ComponentsChecked.includes(r.TicketUUID)),l.AddonTickets=n.AddonTickets.filter(r=>o.AddonsChecked.includes(r.TicketUUID)),l})});return(o,i)=>o.value?(d(!0),I(w,{key:0},ae(U.value,n=>(d(),I("div",{key:n.TicketUUID},[L("strong",null,R(n.Name),1),n.TicketComponents.length>0?(d(),I(w,{key:0},[mn,vn,V("  "),(d(!0),I(w,null,ae(n.TicketComponents,l=>(d(),I(w,{key:l.TicketUUID},[L("small",null,R(l.Name),1),V("  ")],64))),128))],64)):B("",!0),n.AddonTickets.length>0?(d(),I(w,{key:1},[cn,fn,V("  "),(d(!0),I(w,null,ae(n.AddonTickets,l=>(d(),I("small",{key:l.TicketUUID},[V("("),L("em",null,R(l.Name),1),V(")")]))),128))],64)):B("",!0)]))),128)):B("",!0)}}),gn={key:0,class:"text-blue text-center"},_n={key:1,class:"text-red text-center"},pn={key:2,class:"text-orange text-center"},An={key:3,class:"text-orange text-center"},Tn={key:4,class:"text-orange text-center"},yn={key:5,class:"text-orange text-center"},En={key:6,class:"text-green text-center"},Sn={key:0},Dn={key:0},In=L("strong",null,"Total:",-1),Rn=ee({__name:"RegListRow",props:{header:{},accommodations:{},convention:{},extras:{},forms:{},item:{},interests:{},tickets:{},user:{},venues:{}},emits:["openActions","openPayments","openTags","reload","showForm","switchUser"],setup(e,{emit:U}){const o=(l,r,s)=>{U("showForm",{registration:l,form:r,submission:s})},i=l=>{U("openActions",l)},n=l=>{U("switchUser",l)};return(l,r)=>l.header.type==="ACCOMMODATION"&&l.accommodations.length>0&&l.item.raw[l.header.key]?(d(),M(an,{key:0,value:l.item.raw[l.header.key].Data,accommodations:l.accommodations,convention:l.convention,forms:l.forms,tickets:l.tickets,venues:l.venues,registration:l.item.raw[l.header.key].Registration},null,8,["value","accommodations","convention","forms","tickets","venues","registration"])):l.header.type==="EXTRAS"&&l.extras.length>0?(d(),M(un,{key:1,value:l.item.raw[l.header.key],extras:l.extras},null,8,["value","extras"])):l.header.type==="INTERESTS"&&l.interests.length>0?(d(),M(dn,{key:2,value:l.item.raw[l.header.key],interests:l.interests},null,8,["value","interests"])):l.header.type==="TICKET"&&l.tickets.length>0?(d(),M(Un,{key:3,value:l.item.raw[l.header.key],tickets:l.tickets},null,8,["value","tickets"])):l.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_SUBMISSION_STATUS"||l.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_ACCOMMODATION_FORM"||l.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_DEALER_FORM"||l.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_BADGE_FORM"||l.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_REGISTRATION_FORM"?(d(!0),I(w,{key:4},ae(l.item.raw[l.header.key],s=>(d(),I("ul",{key:s.Heading},[L("li",null,[L("strong",null,R(s.Heading)+": ",1),L("span",{class:Ca($(Sl)(s.Submission.Status))},R($(sa)(s.Submission.Status)),3),t(j,{icon:"mdi:mdi-form-select",title:"Edit Submitted Data",variant:"flat",onClick:m=>o(s.Registration,s.Form,s.Submission)},null,8,["onClick"])])]))),128)):l.header.type==="LAYOUT_ITEM_SOURCE_USER.USER_DATA_SOURCE_AVATAR"?(d(),M(ua,{key:5,class:"rounded-circle",src:l.item.raw[l.header.key],height:"32",width:"32"},null,8,["src"])):l.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_PAYMENT_STATUS"?(d(),I(w,{key:6},[l.item.raw[l.header.key]=="NOT_REQUIRED"?(d(),I("div",gn,"No Payment Requested")):l.item.raw[l.header.key]=="MISSING_REQUIRED"?(d(),I("div",_n,"Partner Payment Not Requested")):l.item.raw[l.header.key]=="AWAITING_PARTNER"?(d(),I("div",pn,"Awaiting Partner Payment")):l.item.raw[l.header.key]=="ALL_REQUIRED"?(d(),I("div",An,"Awaiting Payments")):l.item.raw[l.header.key]=="REQUIRED"?(d(),I("div",Tn,"Awaiting Payment")):l.item.raw[l.header.key]=="ADDITIONAL_REQUIRED"?(d(),I("div",yn,"Awaiting Additional Payments")):(d(),I("div",En,"Completed"))],64)):l.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_REGISTRATION_ACTIONS"?(d(),I(w,{key:7},[t(j,{icon:"mdi:mdi-briefcase",variant:"flat",onClick:r[0]||(r[0]=s=>i(l.item.raw[l.header.key]))}),$(Bl)(l.user)?(d(),M(j,{key:0,icon:"mdi:mdi-account-switch-outline",variant:"flat",onClick:r[1]||(r[1]=s=>n(l.item.raw[l.header.key]))})):B("",!0)],64)):l.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_REGISTRATION_GROUP"?(d(),I(w,{key:8},[l.item.raw[l.header.key].length===1?(d(),I("em",Sn," Not in a group ")):(d(),I(w,{key:1},[L("ul",null,[(d(!0),I(w,null,ae(l.item.raw[l.header.key],s=>(d(),I("li",{key:s.UUID,class:"ml-0"},[V(" #"+R(s.Reference)+" : "+R(s.Name)+" ",1),s.IsLeader?(d(),I("strong",Dn,"(Leader)")):B("",!0)]))),128))]),In,V(" "+R(l.item.raw[l.header.key].length),1)],64))],64)):(d(),I(w,{key:9},[V(R(l.item.raw[l.header.key]),1)],64))}}),Bt=ee({__name:"RegistrationActionTabs",props:se({alignTabs:{},class:{},fixedTabs:{type:Boolean},showArrows:{type:[String,Boolean]},tabs:{}},{modelValue:{required:!0}}),emits:["update:modelValue"],setup(e){const U=e,o=Te(e,"modelValue");return(i,n)=>(d(),M(ea,Re({modelValue:o.value,"onUpdate:modelValue":n[0]||(n[0]=l=>o.value=l)},U),{default:a(()=>[(d(!0),I(w,null,ae(i.tabs,l=>(d(),M(ta,{value:l.value,key:l.value},{default:a(()=>[V(R(l.label),1)]),_:2},1032,["value"]))),128))]),_:1},16,["modelValue"]))}}),Cn=ee({__name:"Badges",props:{convention:{},registration:{}},setup(e){const U=ra(),o=f("");o.value=U.GetConBadgeImageURL(e.registration.RegistrationUUID);const i=()=>{const n=document.createElement("a");n.download=`Badge - ${e.registration.Reference} - ${e.registration.User.DisplayName}.webp`,n.href=o.value,document.body.appendChild(n),n.click(),document.body.removeChild(n)};return(n,l)=>(d(),M(Ve,null,{default:a(()=>[t(Ye,null,{default:a(()=>[t(Me,null,{default:a(()=>[t(W,{class:"flex-row-reverse"},{default:a(()=>[t(k,{class:"text-wrap flex-grow-1"},{default:a(()=>[V(" Badges (#"+R(n.registration.Reference)+" "+R(n.registration.User.DisplayName)+") ",1)]),_:1})]),_:1})]),_:1})]),_:1}),t(Ne,null,{default:a(()=>[t(ua,{src:o.value,height:"280",width:"280"},null,8,["src"])]),_:1}),t(It,null,{default:a(()=>[t(j,{color:"primary","prepend-icon":"mdi:mdi-download",variant:"flat",onClick:i},{default:a(()=>[V("Download")]),_:1})]),_:1})]),_:1}))}});var Vn=["onActivate","onAddUndo","onBeforeAddUndo","onBeforeExecCommand","onBeforeGetContent","onBeforeRenderUI","onBeforeSetContent","onBeforePaste","onBlur","onChange","onClearUndos","onClick","onContextMenu","onCopy","onCut","onDblclick","onDeactivate","onDirty","onDrag","onDragDrop","onDragEnd","onDragGesture","onDragOver","onDrop","onExecCommand","onFocus","onFocusIn","onFocusOut","onGetContent","onHide","onInit","onKeyDown","onKeyPress","onKeyUp","onLoadContent","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp","onNodeChange","onObjectResizeStart","onObjectResized","onObjectSelected","onPaste","onPostProcess","onPostRender","onPreProcess","onProgressState","onRedo","onRemove","onReset","onSaveContent","onSelectionChange","onSetAttrib","onSetContent","onShow","onSubmit","onUndo","onVisualAid"],On=function(e){return Vn.map(function(U){return U.toLowerCase()}).indexOf(e.toLowerCase())!==-1},bn=function(e,U,o){Object.keys(U).filter(On).forEach(function(i){var n=U[i];typeof n=="function"&&(i==="onInit"?n(e,o):o.on(i.substring(2),function(l){return n(l,o)}))})},hn=function(e,U,o,i){var n=e.modelEvents?e.modelEvents:null,l=Array.isArray(n)?n.join(" "):n;de(i,function(r,s){o&&typeof r=="string"&&r!==s&&r!==o.getContent({format:e.outputFormat})&&o.setContent(r)}),o.on(l||"change input undo redo",function(){U.emit("update:modelValue",o.getContent({format:e.outputFormat}))})},kn=function(e,U,o,i,n,l){i.setContent(l()),o.attrs["onUpdate:modelValue"]&&hn(U,o,i,n),bn(e,o.attrs,i)},Gt=0,ca=function(e){var U=Date.now(),o=Math.floor(Math.random()*1e9);return Gt++,e+"_"+o+Gt+String(U)},Mn=function(e){return e!==null&&e.tagName.toLowerCase()==="textarea"},Yt=function(e){return typeof e>"u"||e===""?[]:Array.isArray(e)?e:e.split(" ")},Nn=function(e,U){return Yt(e).concat(Yt(U))},Ln=function(e){return e==null},Ht=function(){return{listeners:[],scriptId:ca("tiny-script"),scriptLoaded:!1}},wn=function(){var e=Ht(),U=function(n,l,r,s){var m=l.createElement("script");m.referrerPolicy="origin",m.type="application/javascript",m.id=n,m.src=r;var E=function(){m.removeEventListener("load",E),s()};m.addEventListener("load",E),l.head&&l.head.appendChild(m)},o=function(n,l,r){e.scriptLoaded?r():(e.listeners.push(r),n.getElementById(e.scriptId)||U(e.scriptId,n,l,function(){e.listeners.forEach(function(s){return s()}),e.scriptLoaded=!0}))},i=function(){e=Ht()};return{load:o,reinitialize:i}},Pn=wn(),Fn=function(){return typeof window<"u"?window:global},be=function(){var e=Fn();return e&&e.tinymce?e.tinymce:null},$n={apiKey:String,cloudChannel:String,id:String,init:Object,initialValue:String,inline:Boolean,modelEvents:[String,Array],plugins:[String,Array],tagName:String,toolbar:[String,Array],modelValue:String,disabled:Boolean,tinymceScriptSrc:String,outputFormat:{type:String,validator:function(e){return e==="html"||e==="text"}}},Ee=globalThis&&globalThis.__assign||function(){return Ee=Object.assign||function(e){for(var U,o=1,i=arguments.length;o<i;o++){U=arguments[o];for(var n in U)Object.prototype.hasOwnProperty.call(U,n)&&(e[n]=U[n])}return e},Ee.apply(this,arguments)},xn=function(e,U,o,i){return e(i||"div",{id:U,ref:o})},Bn=function(e,U,o){return e("textarea",{id:U,visibility:"hidden",ref:o})},vt={selector:void 0,target:void 0},Gn=ee({props:$n,setup:function(e,U){var o=e.init?Ee(Ee({},e.init),vt):Ee({},vt),i=Va(e),n=i.disabled,l=i.modelValue,r=i.tagName,s=f(null),m=null,E=e.id||ca("tiny-vue"),c=e.init&&e.init.inline||e.inline,p=!!U.attrs["onUpdate:modelValue"],u=!0,g=e.initialValue?e.initialValue:"",v="",Q=function(C){return p?function(){return l!=null&&l.value?l.value:""}:function(){return C?g:v}},P=function(){var C=Q(u),N=Ee(Ee({},o),{readonly:e.disabled,target:s.value,plugins:Nn(o.plugins,e.plugins),toolbar:e.toolbar||o.toolbar,inline:c,setup:function(z){m=z,z.on("init",function(G){return kn(G,e,U,z,l,C)}),typeof o.setup=="function"&&o.setup(z)}});Mn(s.value)&&(s.value.style.visibility=""),be().init(N),u=!1};de(n,function(C){var N;m!==null&&(typeof((N=m.mode)===null||N===void 0?void 0:N.set)=="function"?m.mode.set(C?"readonly":"design"):m.setMode(C?"readonly":"design"))}),de(r,function(C){var N;p||(v=m.getContent()),(N=be())===null||N===void 0||N.remove(m),Be(function(){return P()})}),Oa(function(){if(be()!==null)P();else if(s.value&&s.value.ownerDocument){var C=e.cloudChannel?e.cloudChannel:"6",N=e.apiKey?e.apiKey:"no-api-key",z=Ln(e.tinymceScriptSrc)?"https://cdn.tiny.cloud/1/".concat(N,"/tinymce/").concat(C,"/tinymce.min.js"):e.tinymceScriptSrc;Pn.load(s.value.ownerDocument,z,P)}}),ba(function(){be()!==null&&be().remove(m)}),c||(ha(function(){u||P()}),ka(function(){var C;p||(v=m.getContent()),(C=be())===null||C===void 0||C.remove(m)}));var h=function(C){var N;v=m.getContent(),(N=be())===null||N===void 0||N.remove(m),o=Ee(Ee(Ee({},o),C),vt),Be(function(){return P()})};return U.expose({rerender:h,getEditor:function(){return m}}),function(){return c?xn(kt,E,s,e.tagName):Bn(kt,E,s)}}});const Yn=["colspan"],Hn=L("strong",null,"E-Mail Content",-1),jn=["innerHTML"],qn=ee({__name:"Communications",props:{hideHistory:{type:Boolean,default:!1},registration:{},showEditor:{type:Boolean}},emits:["close-editor"],setup(e,{emit:U}){const o=Ae(),i=f([]),n=f({From:"",Subject:"",HTML:""}),l=f(""),r=f(""),s=f(""),m=f(!1),E=f([]),c=f(["1"]),p=f([]),u=f([{key:"CreatedAt",title:"Date"},{key:"Subject",title:"Subject"},{key:"User.DisplayName",title:"Sender"},{key:"Status",title:"Status"}]),g=f([{key:"CreatedAt",order:"asc"}]);de(n,h=>{s.value=h.From||s.value||"",r.value=h.Subject||r.value||"",l.value=h.HTML||l.value||""});const v=()=>{o.getRegistrationEmails(e.registration.RegistrationUUID).then(h=>{h&&(h.forEach(C=>{C.CreatedAt=oa(new Date(C.CreatedAt||"")),C.Status=xl(C.Status),C.User||(C.User={ID:0,UserUUID:"",DisplayName:"System",Handle:"",Credentials:[],Additional:{FirstName:"",LastName:"",DOB:"",Email:""},Data:"",Groups:[],Tags:[]})}),p.value=h)})};v(),(()=>{o.getRegistrationEmailTemplates(e.registration.RegistrationUUID).then(h=>{h&&(i.value=h)})})();const P=({callback:h})=>{o.sendRegistrationEmail(e.registration.RegistrationUUID,s.value,r.value,l.value).then(C=>{C?h&&(h("Email Sent"),v(),setTimeout(()=>{m.value=!1},2e3)):h&&h("Not sent")}).catch(()=>{h&&h("Not sent")})};return(h,C)=>(d(),I(w,null,[h.showEditor?(d(),I(w,{key:0},[t(W,null,{default:a(()=>[t(k,null,{default:a(()=>[t(Jt,{items:i.value,"item-title":"Subject","return-object":"",label:"Template","hide-details":"",modelValue:n.value,"onUpdate:modelValue":C[0]||(C[0]=N=>n.value=N),variant:"outlined"},null,8,["items","modelValue"])]),_:1})]),_:1}),t(W,null,{default:a(()=>[t(k,{cols:"12"},{default:a(()=>[t(Ue,{modelValue:s.value,"onUpdate:modelValue":C[1]||(C[1]=N=>s.value=N),label:"From",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),t(k,{cols:"12"},{default:a(()=>[t(Ue,{modelValue:r.value,"onUpdate:modelValue":C[2]||(C[2]=N=>r.value=N),label:"Subject",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),t(k,{cols:"12"},{default:a(()=>[t($(Gn),{modelValue:l.value,"onUpdate:modelValue":C[3]||(C[3]=N=>l.value=N),"api-key":"g9sce3fktcgvk0i7sp96cahgyk4cos7q27es3ubnlal3xf3z"},null,8,["modelValue"])]),_:1})]),_:1}),t(W,null,{default:a(()=>[t(k,null,{default:a(()=>[t(Xe,{onClick:C[4]||(C[4]=N=>U("close-editor")),label:"Close E-mail Editor",color:"secondary","prepend-icon":"mdi:mdi-window-close"})]),_:1}),t(k,{class:"text-right"},{default:a(()=>[t(Xe,{onClick:P,label:"Send",color:"error"})]),_:1})]),_:1})],64)):B("",!0),p.value.length&&!h.hideHistory?(d(),M(Et,{key:1,class:"my-2",multiple:!0,modelValue:c.value,"onUpdate:modelValue":C[7]||(C[7]=N=>c.value=N)},{default:a(()=>[t(yt,{value:"1"},{default:a(()=>[t(pt,null,{default:a(()=>[V(" Email History ")]),_:1}),t(At,null,{default:a(()=>[t($(Tt),{items:p.value,headers:u.value,"show-expand":!0,"item-value":"EmailUUID",expanded:E.value,"onUpdate:expanded":C[5]||(C[5]=N=>E.value=N),"sort-by":g.value,"onUpdate:sortBy":C[6]||(C[6]=N=>g.value=N)},{"expanded-row":a(({columns:N,item:z})=>[L("tr",null,[L("td",{colspan:N.length},[Hn,L("div",{class:"communicationsViewEmailPreview",innerHTML:z.raw.HTML},null,8,jn)],8,Yn)])]),"footer.prepend":a(()=>[t(j,{"prepend-icon":"mdi:mdi-refresh",color:"primary",class:"mr-4",onClick:v},{default:a(()=>[V("Refresh")]),_:1})]),_:1},8,["items","headers","expanded","sort-by"])]),_:1})]),_:1})]),_:1},8,["modelValue"])):B("",!0)],64))}});const zn=ee({__name:"Emails",props:{registration:{}},setup(e){const U=f(!1);return(o,i)=>(d(),M(Ve,null,{default:a(()=>[t(Ye,null,{default:a(()=>[t(Me,null,{default:a(()=>[V(" E-Mails (#"+R(o.registration.Reference)+" "+R(o.registration.User.DisplayName)+") ",1)]),_:1})]),_:1}),t(Ne,null,{default:a(()=>[t(W,null,{default:a(()=>[t(k,{cols:"12"},{default:a(()=>[t(j,{"prepend-icon":"mdi:mdi-email",color:"primary",onClick:i[0]||(i[0]=n=>U.value=!0)},{default:a(()=>[V("Prepare Email")]),_:1})]),_:1})]),_:1}),t(qn,{registration:o.registration,"show-editor":U.value,onCloseEditor:i[1]||(i[1]=n=>U.value=!1)},null,8,["registration","show-editor"])]),_:1})]),_:1}))}}),Qn=ee({__name:"EditNoteCategoryDialog",props:se({convention:{},noteCategory:{},title:{}},{modelValue:{type:Boolean,required:!0}}),emits:se(["update:noteCategory"],["update:modelValue"]),setup(e,{emit:U}){const o=e,{title:i=""}=o,n=Te(e,"modelValue"),l=Ze(o,U,void 0,void 0,"noteCategory"),r=f(ve(l.value));de(l,()=>{r.value=ve(l.value)});const s=()=>{n.value=!1},m=()=>{r.value=ve(l.value)},E=()=>{l.value=r.value};return(c,p)=>(d(),M(Ge,{modelValue:n.value,"onUpdate:modelValue":p[2]||(p[2]=u=>n.value=u),onReset:m,onSave:E,title:$(i),color:"primary",persistent:!0,fullscreen:!1,"hide-extension":!0},{default:a(()=>[t(fe,{class:"pa-0",fluid:!0},{default:a(()=>[t(W,null,{default:a(()=>[t(k,{cols:"12",sm:"6",md:"4"},{default:a(()=>[t(Ue,{modelValue:r.value.Name,"onUpdate:modelValue":p[0]||(p[0]=u=>r.value.Name=u),label:"Internal name",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),t(k,{cols:"12",sm:"6",md:"4"},{default:a(()=>[t(Xt,{modelValue:r.value.Groups,"onUpdate:modelValue":p[1]||(p[1]=u=>r.value.Groups=u),convention:c.convention,label:"Groups",variant:"outlined","hide-details":""},null,8,["modelValue","convention"])]),_:1})]),_:1})]),_:1})]),actions:a(()=>[t(j,{color:"blue-darken-1",variant:"text",onClick:s},{default:a(()=>[V(" Cancel ")]),_:1}),t(j,{color:"blue-darken-1",variant:"text",onClick:m},{default:a(()=>[V(" Reset ")]),_:1}),t(ke),t(j,{color:"blue-darken-1",variant:"text",onClick:E},{default:a(()=>[V(" Save ")]),_:1})]),_:1},8,["modelValue","title"]))}}),Kn=()=>{const e=f(""),U=()=>{const o={x:window.innerWidth,y:window.innerHeight};o.x<600?e.value="xs":o.x>=600&&o.x<960?e.value="sm":o.x>=960&&o.x<1280?e.value="md":o.x>=1280&&o.x<1920?e.value="lg":o.x>=1920&&o.x<2560?e.value="xl":o.x>=2560&&(e.value="xxl")};return window.addEventListener("resize",U),U(),e},Wn={style:{"list-style":"none"}},Jn=ee({__name:"NoteCategories",props:{hideHistory:{type:Boolean},convention:{},showEditor:{type:Boolean}},emits:["close"],setup(e,{emit:U}){const o=Ae(),i=f(!1),n=f(!1),l=f(""),r=f([]),s=f([{key:"Name",title:"Name"},{key:"Groups",title:"Groups"},{key:"actions",title:"",sortable:!1}]),m=Kn();f([{key:"CreatedAt",order:"asc"}]);const E=()=>({ID:0,NoteCategoryUUID:Ce(),ConventionID:e.convention.ID,ConventionUUID:e.convention.ConventionUUID,Name:"",Groups:[],Notes:[]}),c=f(-1),p=f(E()),u=f(E()),g=()=>{u.value.NoteCategoryUUID=Ce(),p.value=Object.assign({},E()),c.value=-1,i.value=!0},v=G=>{c.value=r.value.indexOf(G),p.value=Object.assign({},G),i.value=!0},Q=G=>{c.value=r.value.indexOf(G),p.value=Object.assign({},G),n.value=!0},P=()=>{o.deleteNoteCategory(p.value.NoteCategoryUUID).then(G=>{G&&(r.value.splice(c.value,1),C())})},h=()=>{i.value=!1,Be(()=>{p.value=Object.assign({},u.value),c.value=-1})},C=()=>{n.value=!1,Be(()=>{p.value=Object.assign({},u.value),c.value=-1})},N=()=>{o.saveNoteCategory(p.value).then(G=>{G&&(c.value>-1?Object.assign(r.value[c.value],G):r.value.push(G),h())})};return(()=>{o.getNoteCategories(e.convention.ConventionUUID).then(G=>{G&&(r.value=G)})})(),(G,J)=>(d(),M($(Tt),{headers:s.value,items:r.value,"sort-by":[{key:"calories",order:"asc"}],class:"elevation-1"},{top:a(()=>[t(gt,{color:"primary"},Je({default:a(()=>[t(ma,null,{default:a(()=>[V("Note Categories")]),_:1}),t(Rl,{class:"mx-4 d-none d-sm-inline-flex",inset:!0,vertical:!0}),t(ke,{class:"d-none d-sm-inline-flex"}),$(m)!="xs"?(d(),M(j,{key:0,dark:"",class:"mb-2","prepend-icon":"mdi:mdi-pencil",onClick:g},{default:a(()=>[V(" New Item ")]),_:1})):B("",!0),t(j,{dark:"",class:"mb-2",icon:"mdi:mdi-window-close",onClick:J[0]||(J[0]=K=>U("close"))}),t(Il,{modelValue:n.value,"onUpdate:modelValue":J[1]||(J[1]=K=>n.value=K),onDelete:P},null,8,["modelValue"])]),_:2},[$(m)=="xs"?{name:"extension",fn:a(()=>[t(ke),t(j,{dark:"",class:"mb-2","prepend-icon":"mdi:mdi-pencil",onClick:g},{default:a(()=>[V(" New Item ")]),_:1})]),key:"0"}:void 0]),1024),i.value?(d(),M(Qn,{key:0,modelValue:i.value,"onUpdate:modelValue":J[2]||(J[2]=K=>i.value=K),"note-category":p.value,"onUpdate:noteCategory":[J[3]||(J[3]=K=>p.value=K),N],title:l.value,convention:G.convention},null,8,["modelValue","note-category","title","convention"])):B("",!0)]),"item.Groups":a(({item:K})=>[L("ul",Wn,[(d(!0),I(w,null,ae(K.selectable.Groups,A=>(d(),I("li",{key:A.GroupUUID,class:"py-1"},R(A.Name),1))),128))])]),"item.actions":a(({item:K})=>[t(ft,{size:"small",class:"me-2",onClick:A=>v(K.raw)},{default:a(()=>[V(" mdi:mdi-pencil ")]),_:2},1032,["onClick"]),t(ft,{size:"small",onClick:A=>Q(K.raw)},{default:a(()=>[V(" mdi:mdi-delete ")]),_:2},1032,["onClick"])]),_:1},8,["headers","items"]))}}),Xn=ee({__name:"SelectNoteCategories",props:se({convention:{},chips:{type:Boolean,default:!1},clearable:{type:Boolean,default:!1},hint:{default:""},label:{},variant:{}},{modelValue:{required:!0}}),emits:se(["change"],["update:modelValue"]),setup(e,{emit:U}){const o=Te(e,"modelValue"),i=f([]),n=Ae(),l=f([]),r=f(""),s=f(0),m=re(()=>[...l.value].map(p=>({title:p.Name,value:i.value.find(u=>u.NoteCategoryUUID===p.NoteCategoryUUID)||p})));return typeof e.convention=="object"?r.value=e.convention.ConventionUUID:r.value=e.convention||"",(async()=>{const c=[];r.value&&c.push(n.getNoteCategories(r.value));const p=await Promise.all(c);if(r.value&&p.length==1&&(l.value=p[0].sort((u,g)=>u.Name.localeCompare(g.Name))),Array.isArray(o.value))s.value=2,m.value.forEach(u=>{Array.isArray(o.value)&&o.value.find(v=>v.NoteCategoryUUID===u.value.NoteCategoryUUID)&&i.value.push(u.value)});else if(typeof o.value=="string"){s.value=1;try{const u=JSON.parse(o.value);m.value.forEach(g=>{u.find(Q=>Q.NoteCategoryUUID===g.value.NoteCategoryUUID)&&i.value.push(g.value)})}catch{}}})(),de(i,()=>{switch(s.value){default:case 2:{o.value=i.value,U("change");break}case 1:{o.value=JSON.stringify(i.value),U("change");break}}}),(c,p)=>(d(),M(Jt,{modelValue:i.value,"onUpdate:modelValue":p[0]||(p[0]=u=>i.value=u),chips:c.chips,multiple:"",label:c.label||"Tags",variant:c.variant||"solo",hint:c.hint,"persistent-hint":!0,clearable:c.clearable,items:m.value,"item-title":"title","item-value":"value"},null,8,["modelValue","chips","label","variant","hint","clearable","items"]))}}),Zn=ee({__name:"EditNoteDialog",props:se({convention:{},note:{},title:{}},{modelValue:{type:Boolean,required:!0}}),emits:se(["update:note","saved"],["update:modelValue"]),setup(e,{emit:U}){const o=e,{title:i=""}=o,n=Ae(),l=Te(e,"modelValue"),r=Ze(o,U,void 0,void 0,"note"),s=f(ve(r.value));de(r,()=>{s.value=ve(r.value)});const m=()=>{s.value=ve(r.value)},E=c=>{s.value.NoteCategories===null&&(s.value.NoteCategories=[]),s.value.CreatedAt=void 0,s.value.DeletedAt=void 0,s.value.UpdatedAt=void 0,s.value.Admin=void 0,s.value.AdminID=void 0,s.value.AdminUUID=void 0,n.saveNote(s.value).then(p=>{p?(s.value=ve(p),c&&c("Note Saved"),r.value=s.value,U("saved",r.value)):c&&c("Internal Error Saving Note")}).catch(p=>{c&&c("Error Saving Note:"+p.ErrorMessage)})};return(c,p)=>s.value?(d(),M(Ge,{key:0,"card-class":"pa-4",modelValue:l.value,"onUpdate:modelValue":p[3]||(p[3]=u=>l.value=u),onReset:m,onSave:E,title:$(i),color:"primary",persistent:!0,fullscreen:!1,"hide-extension":!0,"show-close-action":!0,"show-reset-action":!0,"show-save-action":!0},{default:a(()=>[t(fe,{class:"pa-0",fluid:!0},{default:a(()=>[t(W,null,{default:a(()=>[t(k,{cols:"12"},{default:a(()=>[t(Xn,{modelValue:s.value.NoteCategories,"onUpdate:modelValue":p[0]||(p[0]=u=>s.value.NoteCategories=u),convention:c.convention,label:"Categories",variant:"outlined","hide-details":"",chips:!0},null,8,["modelValue","convention"])]),_:1})]),_:1}),t(W,null,{default:a(()=>[t(k,{cols:"12"},{default:a(()=>[t(Ue,{modelValue:s.value.Subject,"onUpdate:modelValue":p[1]||(p[1]=u=>s.value.Subject=u),label:"Subject",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),t(k,{cols:"12"},{default:a(()=>[t(Cl,{modelValue:s.value.Description,"onUpdate:modelValue":p[2]||(p[2]=u=>s.value.Description=u),label:"Note",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue","title"])):B("",!0)}}),eo=ee({__name:"Notes",props:{convention:{},hideHistory:{type:Boolean},registration:{},showEditor:{type:Boolean}},setup(e){const U=Ae(),o=()=>({ID:0,NoteUUID:Ce(),Description:"",NoteCategories:[],Registration:e.registration,RegistrationID:e.registration.ID,RegistrationUUID:e.registration.RegistrationUUID,Subject:""}),i=f(!1),n=f(!1),l=f([]),r=f([]),s=f(o()),m=()=>{s.value=o(),i.value=!0},E=u=>{s.value=u,i.value=!0},c=()=>{U.getRegistrationNotes(e.registration.RegistrationUUID).then(u=>{u&&(u.forEach(g=>{g.CreatedAt=oa(new Date(g.CreatedAt||"")),g.Admin||(g.Admin={ID:0,UserUUID:"",DisplayName:"System",Handle:"",Credentials:[],Additional:{FirstName:"",LastName:"",DOB:"",Email:""},Data:"",Groups:[],Tags:[]})}),l.value=u,r.value=u.map(g=>g.NoteUUID))})},p=()=>{c(),setTimeout(()=>{i.value=!1},2e3)};return c(),(u,g)=>(d(),I(w,null,[t(Ve,null,{default:a(()=>[t(Ye,null,{default:a(()=>[t(Me,null,{default:a(()=>[t(W,{class:"flex-row-reverse"},{default:a(()=>[t(k,{class:"text-right flex-shrink-1 flex-grow-0",style:{"flex-grow":"0 !important"}},{default:a(()=>[t(j,{class:"d-sm-none",size:"xs",icon:"mdi:mdi-cog",variant:"text",color:"warning",onClick:g[0]||(g[0]=v=>n.value=!0)}),t(j,{class:"d-none d-sm-inline-flex","prepend-icon":"mdi:mdi-cog",variant:"text",color:"warning",onClick:g[1]||(g[1]=v=>n.value=!0)},{default:a(()=>[V("Categories")]),_:1})]),_:1}),t(k,{class:"text-wrap flex-grow-1"},{default:a(()=>[V(" Notes (#"+R(u.registration.Reference)+" "+R(u.registration.User.DisplayName)+") ",1)]),_:1})]),_:1})]),_:1})]),_:1}),t(Ne,null,{default:a(()=>[t(Et,{multiple:!0,variant:"accordion",modelValue:r.value,"onUpdate:modelValue":g[2]||(g[2]=v=>r.value=v)},{default:a(()=>[(d(!0),I(w,null,ae(l.value,v=>(d(),M(yt,{key:`${v.NoteUUID}.${v.UpdatedAt}`,value:v.NoteUUID},{default:a(()=>[t(pt,null,{default:a(()=>[V(R(v.Subject)+" ",1),t(Vl,{class:"ml-4"},{default:a(()=>[(d(!0),I(w,null,ae(v.NoteCategories,Q=>(d(),M(Ol,{key:Q.NoteCategoryUUID},{default:a(()=>[V(R(Q.Name),1)]),_:2},1024))),128))]),_:2},1024)]),_:2},1024),t(At,null,{default:a(()=>[t(W,null,{default:a(()=>[t(k,null,{default:a(()=>[V(R(v.Description),1)]),_:2},1024)]),_:2},1024),t(W,null,{default:a(()=>[t(k,null,{default:a(()=>[V(R($(ze)(v.UpdatedAt||""))+" ",1),v&&v.Admin&&v.Admin.DisplayName?(d(),I(w,{key:0},[V(" - "+R(v.Admin.DisplayName),1)],64)):B("",!0)]),_:2},1024),t(k,{class:"text-right"},{default:a(()=>[t(j,{color:"primary","prepend-icon":"mdi:mdi-pencil",onClick:Q=>E(v)},{default:a(()=>[V("Edit")]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(It,null,{default:a(()=>[t(j,{color:"primary",variant:"flat",onClick:m},{default:a(()=>[V("Add Note")]),_:1})]),_:1})]),_:1}),t(_t,{modelValue:i.value,"onUpdate:modelValue":g[5]||(g[5]=v=>i.value=v),title:"Create Note"},{default:a(()=>[t(Zn,{modelValue:i.value,"onUpdate:modelValue":g[3]||(g[3]=v=>i.value=v),note:s.value,"onUpdate:note":g[4]||(g[4]=v=>s.value=v),convention:u.convention,title:"Create Note",onSaved:p},null,8,["modelValue","note","convention"])]),_:1},8,["modelValue"]),t(_t,{modelValue:n.value,"onUpdate:modelValue":g[7]||(g[7]=v=>n.value=v),title:"Note Configuration"},{default:a(()=>[t(Jn,{convention:u.convention,onClose:g[6]||(g[6]=v=>n.value=!1)},null,8,["convention"])]),_:1},8,["modelValue"])],64))}}),to=ee({__name:"StripeRefundPayment",props:se({paymentTransaction:{}},{modelValue:{type:Boolean,required:!0}}),emits:se(["refunded"],["update:modelValue"]),setup(e,{emit:U}){const o=Te(e,"modelValue"),i=Ae(),n=f(!1),l=f("");let r=0;if(e.paymentTransaction.Data&&e.paymentTransaction.Data.PaymentIntent&&typeof e.paymentTransaction.Data.PaymentIntent=="object"){const u=e.paymentTransaction.Data.PaymentIntent;u&&(r=u.amount)}const s=f({Amount:r/100,Description:"",Reason:""}),m=f([{title:"Duplicate",value:"duplicate"},{title:"Fraudulent",value:"fraudulent"},{title:"Requested By Customer",value:"requested_by_customer"}]),E=f(!1);async function c(u){u.preventDefault(),E.value=!0,i.refundStripePayment(e.paymentTransaction.PaymentTransactionUUID,s.value).then(g=>{g?U("refunded",g):p("An unexpected error occurred.")}).catch(g=>{p("An error occurred processing the refund: "+g.toString())}),E.value=!1}const p=u=>{l.value=u,n.value=!0};return(u,g)=>(d(),M(Ge,{modelValue:o.value,"onUpdate:modelValue":g[7]||(g[7]=v=>o.value=v),title:"Refund a Stripe Payment",color:"blue-darken-4",persistent:""},{default:a(()=>[t(fe,{class:"pa-0"},{default:a(()=>[t(bl,{ref:"refundForm",id:"refund-form",onSubmit:g[4]||(g[4]=Ma(v=>c(v),["prevent"]))},{default:a(()=>[t(W,null,{default:a(()=>[t(k,{cols:"12",sm:"6",md:"4",lg:"3",xl:"2"},{default:a(()=>[t(Ue,{modelValue:s.value.Amount,"onUpdate:modelValue":g[0]||(g[0]=v=>s.value.Amount=v),modelModifiers:{number:!0},label:"Amount",prefix:"£",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),t(k,{cols:"12",sm:"6",md:"8",lg:"9",xl:"10"},{default:a(()=>[t(ce,{modelValue:s.value.Reason,"onUpdate:modelValue":g[1]||(g[1]=v=>s.value.Reason=v),modelModifiers:{number:!0},items:m.value,"item-title":"title","item-value":"value",label:"Stripe Refund Reason",variant:"outlined","hide-details":""},null,8,["modelValue","items"])]),_:1}),t(k,{cols:"12"},{default:a(()=>[t(Ue,{modelValue:s.value.Description,"onUpdate:modelValue":g[2]||(g[2]=v=>s.value.Description=v),modelModifiers:{number:!0},label:"Refund Description",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1})]),_:1}),t(W,null,{default:a(()=>[t(k,{class:"text-right",cols:"12",sm:"3",md:"2",lg:"2",xl:"1"},{default:a(()=>[t(j,{color:"error",class:"w-100",onClick:g[3]||(g[3]=v=>o.value=!1)},{default:a(()=>[V("Cancel")]),_:1})]),_:1}),t(ke),t(k,{class:"text-left",cols:"12",sm:"3",md:"2",lg:"2",xl:"1"},{default:a(()=>[t(j,{type:"submit",color:"success",class:"w-100"},Je({default:a(()=>[V(" Issue Refund ")]),_:2},[E.value?{name:"prepend",fn:a(()=>[t(yl,{size:"20",indeterminate:""})]),key:"0"}:void 0]),1024)]),_:1})]),_:1})]),_:1},512)]),_:1}),t(da,{modelValue:n.value,"onUpdate:modelValue":g[6]||(g[6]=v=>n.value=v)},{actions:a(()=>[t(j,{variant:"text",onClick:g[5]||(g[5]=v=>n.value=!1)},{default:a(()=>[V(" Close ")]),_:1})]),default:a(()=>[V(R(l.value)+" ",1)]),_:1},8,["modelValue"])]),_:1},8,["modelValue"]))}}),ao=["colspan"],lo=L("strong",null,"Details",-1),no=["innerHTML"],oo=ee({__name:"PaymentTransactions",props:{canEdit:{type:Boolean},hideHistory:{type:Boolean},updated:{},registration:{},showEditor:{type:Boolean}},emits:["close-editor","change"],setup(e,{emit:U}){const o=e;let{hideHistory:i=!1,registration:n,showEditor:l}=o;const r=Ae(),s=f([]),m=f(["1"]),E=f([]),c=f([{key:"CreatedAt",title:"Date"},{key:"Type",title:"Type"},{key:"Source",title:"Source"},{key:"Description",title:"Description"},{key:"Admin",title:"Admin"},{key:"Amount",title:"Amount"},{key:"Controls",title:""}]),p=f(!1),u=f(),g=f(!1),v=f(""),Q=f([{key:"CreatedAt",order:"asc"}]),P=()=>({PaymentTransactionUUID:Ce(),Amount:0,Data:{},Description:"",ID:0,RegistrationID:n.ID,RegistrationUUID:n.RegistrationUUID,Source:Ft.PAYMENT_TRANSACTION_SOURCE_NULL,Type:Ut.PAYMENT_TRANSACTION_TYPE_NULL}),h=f(P()),{convertTransactions:C,getPaymentTransactionsDisplay:N}=ia();de(o,()=>{i=o.hideHistory,n=o.registration,l=o.showEditor,N(n.RegistrationUUID).then(A=>{E.value=A})});const z=()=>{N(n.RegistrationUUID).then(A=>{E.value=A})};z();const G=()=>{r.saveRegistrationPaymentTransaction(h.value).then(A=>{A&&(C(A.PaymentTransactions),h.value=P(),U("close-editor"),U("change"))})},J=A=>{const T=E.value.find(S=>S.PaymentTransactionUUID===A);T&&(u.value=T.PaymentTransaction,p.value=!0)},K=A=>{if(A)try{E.value=C(A.PaymentTransactions),u.value=void 0,p.value=!1,v.value="Refund Processed",g.value=!0,U("change")}catch(T){console.error(T)}};return(A,T)=>(d(),I(w,null,[$(l)?(d(),I(w,{key:0},[t(Me,null,{default:a(()=>[V(" Add Transaction ")]),_:1}),t(W,null,{default:a(()=>[t(k,{cols:"12",sm:"6"},{default:a(()=>[t(ce,{items:$(Al),"item-title":"title","item-value":"value",label:"Transaction Type",clearable:!0,"hide-details":"",modelValue:h.value.Type,"onUpdate:modelValue":T[0]||(T[0]=S=>h.value.Type=S),variant:"outlined"},null,8,["items","modelValue"])]),_:1}),t(k,{cols:"12",sm:"6"},{default:a(()=>[t(ce,{items:$(Tl),"item-title":"title","item-value":"value",label:"Source",clearable:!0,"hide-details":"",modelValue:h.value.Source,"onUpdate:modelValue":T[1]||(T[1]=S=>h.value.Source=S),variant:"outlined"},null,8,["items","modelValue"])]),_:1})]),_:1}),t(W,null,{default:a(()=>[t(k,{cols:"12",sm:"8",md:"10"},{default:a(()=>[t(Ue,{label:"Description","hide-details":"",modelValue:h.value.Description,"onUpdate:modelValue":T[2]||(T[2]=S=>h.value.Description=S),variant:"outlined"},null,8,["modelValue"])]),_:1}),t(k,{cols:"12",sm:"4",md:"2"},{default:a(()=>[t(Ue,{label:"Amount","prepend-inner-icon":"mdi:mdi-currency-gbp","hide-details":"",modelValue:h.value.Amount,"onUpdate:modelValue":T[3]||(T[3]=S=>h.value.Amount=S),modelModifiers:{number:!0},variant:"outlined"},null,8,["modelValue"])]),_:1})]),_:1}),t(W,null,{default:a(()=>[t(k,{cols:"12",sm:"3",md:"2",lg:"1"},{default:a(()=>[t(j,{class:"w-100",onClick:T[4]||(T[4]=S=>U("close-editor")),color:"warning"},{default:a(()=>[V("Cancel")]),_:1})]),_:1}),t(ke),t(k,{cols:"12",sm:"6",md:"3",lg:"2",xl:"2"},{default:a(()=>[t(j,{class:"w-100",onClick:G,color:"primary"},{default:a(()=>[V("Submit Transaction")]),_:1})]),_:1})]),_:1})],64)):B("",!0),E.value.length&&!$(i)?(d(),M(Et,{key:1,class:"my-2",modelValue:m.value,"onUpdate:modelValue":T[10]||(T[10]=S=>m.value=S)},{default:a(()=>[t(yt,{value:"1"},{default:a(()=>[t(pt,null,{default:a(()=>[V(" Transaction History ")]),_:1}),t(At,null,{default:a(()=>[t($(Tt),{items:E.value,headers:c.value,"show-expand":!1,"item-value":"PaymentTransactionUUID",expanded:s.value,"onUpdate:expanded":T[5]||(T[5]=S=>s.value=S),"sort-by":Q.value,"onUpdate:sortBy":T[6]||(T[6]=S=>Q.value=S),class:"transactionTable"},{"item.Controls":a(({item:S})=>[A.canEdit&&S.raw.PaymentTransaction.Source===$(Ft).PAYMENT_TRANSACTION_SOURCE_STRIPE&&S.raw.PaymentTransaction.Type===$(Ut).PAYMENT_TRANSACTION_TYPE_PAYMENT?(d(),M(j,{key:0,icon:"mdi:mdi-credit-card-refund",variant:"text",size:"xs",onClick:O=>J(S.key)},null,8,["onClick"])):B("",!0)]),"expanded-row":a(({columns:S,item:O})=>[L("tr",null,[L("td",{colspan:S.length},[lo,L("div",{innerHTML:O.raw.HTML},null,8,no)],8,ao)])]),"footer.prepend":a(()=>[t(j,{"prepend-icon":"mdi:mdi-refresh",color:"primary",class:"mr-4",onClick:z},{default:a(()=>[V("Refresh")]),_:1})]),_:1},8,["items","headers","expanded","sort-by"]),p.value&&u.value?(d(),M(to,{key:0,modelValue:p.value,"onUpdate:modelValue":T[7]||(T[7]=S=>p.value=S),"payment-transaction":u.value,onRefunded:K},null,8,["modelValue","payment-transaction"])):B("",!0),t(da,{modelValue:g.value,"onUpdate:modelValue":T[9]||(T[9]=S=>g.value=S)},{actions:a(()=>[t(j,{variant:"text",onClick:T[8]||(T[8]=S=>g.value=!1)},{default:a(()=>[V(" Close ")]),_:1})]),default:a(()=>[V(R(v.value)+" ",1)]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])):B("",!0)],64))}});const io=(e=void 0,U)=>e===void 0?!1:Dt(e,St.GROUP_TYPE_CONVENTION,U.ConventionUUID,U).EditPaymentTransactions,it=e=>(Kt("data-v-861debd5"),e=e(),Wt(),e),so={class:"mb-4"},uo={class:"v-row"},ro={key:0,class:"v-col v-col-10 py-1 v-row mx-0 pl-0"},mo={class:"v-col v-col-12 v-col-sm-4 v-col-md-3 font-weight-bold pb-0 pr-0"},vo={class:"v-col v-col-12 v-col-sm-8 v-col-md-9 font-italic pt-0 pt-sm-3 pb-sm-0 pl-sm-0"},co={class:"v-col v-col-2 align-self-end text-right py-1 text-no-wrap"},fo=it(()=>L("dt",{class:"v-col v-col-9 py-1 font-weight-bold totals"}," Total Charges ",-1)),Uo={class:"v-col v-col-3 align-self-end text-right py-1 totals text-no-wrap"},go=it(()=>L("dt",{class:"v-col v-col-9 py-1 font-weight-bold"}," Applied Total ",-1)),_o={class:"v-col v-col-3 align-self-end text-right py-1 text-no-wrap"},po=it(()=>L("dt",{class:"v-col v-col-9 py-1 font-weight-bold"}," Currently Paid ",-1)),Ao={class:"v-col v-col-3 align-self-end text-right py-1 text-no-wrap"},To=it(()=>L("dt",{class:"v-col v-col-9 py-1 font-weight-bold totals"}," Balance ",-1)),yo={class:"v-col v-col-3 align-self-end text-right py-1 totals text-no-wrap"},Eo=ee({__name:"PaymentActions",props:se({forms:{},title:{}},{modelValue:{required:!0}}),emits:["update:modelValue"],setup(e){const U=f(!1),o=f(),i=f([]),n=f(new Date().getTime()),l=f(!1),r=Te(e,"modelValue"),s=f(ve(r.value));de(r,()=>{s.value=ve(r.value)});const m=Ae();m.getConvention(r.value.ConventionUUID).then(u=>{u&&(l.value=io(Rt(),u))});const E=()=>{m.generateRegistrationCharges(r.value.RegistrationUUID,!1).then(u=>{u&&(i.value=u.PaymentTransactions,o.value=u.Registration,n.value=new Date().getTime())}).catch(()=>{})};E();const c=()=>{m.generateRegistrationCharges(r.value.RegistrationUUID,!0).then(u=>{u&&(i.value=u.PaymentTransactions,o.value=u.Registration,n.value=new Date().getTime())})},{totalCharges:p}=ia();return(u,g)=>(d(),M(Ve,null,{default:a(()=>[t(Ye,null,{default:a(()=>[t(Me,null,{default:a(()=>[V(" Payments (#"+R(r.value.Reference)+" "+R(r.value.User.DisplayName)+") ",1)]),_:1})]),_:1}),t(Ne,null,{default:a(()=>[o.value?(d(),I(w,{key:0},[L("h3",so,"#"+R(o.value.Reference)+" "+R(o.value.User.DisplayName),1),L("dl",uo,[(d(!0),I(w,null,ae(i.value,v=>(d(),I(w,{key:v.PaymentTransactionUUID},[v.Type===$(Ut).PAYMENT_TRANSACTION_TYPE_CHARGE?(d(),I("dt",ro,[L("div",mo,R(v.Description.split(":")[0])+": ",1),L("div",vo,R(v.Description.split(":")[1]),1)])):B("",!0),L("dd",co," £"+R(v.Amount),1)],64))),128)),fo,L("dd",Uo," £"+R($(p)(i.value)),1),go,L("dd",_o," £"+R(o.value.Total),1),po,L("dd",Ao," £"+R(o.value.Paid),1),To,L("dd",yo," £"+R(o.value.Total-o.value.Paid),1)]),t(W,{class:"flex-row-reverse"},{default:a(()=>[t(k,{class:"text-right"},{default:a(()=>[t(j,{color:"primary",onClick:c},{default:a(()=>[V("Apply Charges")]),_:1})]),_:1}),!U.value&&l.value?(d(),M(k,{key:0},{default:a(()=>[t(j,{color:"secondary",onClick:g[0]||(g[0]=v=>U.value=!0)},{default:a(()=>[V("Transaction Entry")]),_:1})]),_:1})):B("",!0)]),_:1})],64)):B("",!0),t(oo,{"can-edit":l.value,registration:r.value,"show-editor":U.value,onCloseEditor:g[1]||(g[1]=v=>U.value=!1),updated:n.value,onChange:E},null,8,["can-edit","registration","show-editor","updated"])]),_:1})]),_:1}))}});const So=ot(Eo,[["__scopeId","data-v-861debd5"]]),Do=ee({__name:"RegistrationFormStatus",props:se({forms:{}},{modelValue:{required:!0}}),emits:["update:modelValue"],setup(e){const U=Ae(),o=Te(e,"modelValue"),i=(n,l)=>{const r=o.value.Submissions.find(s=>s.SubmissionUUID==l);if(!r){n&&n("Submission not found");return}U.setSubmissionStatus(l,r.Status).then(s=>{s?(o.value.Submissions.forEach((m,E)=>{o.value.Submissions[E].Status=m.Status}),n&&n("Status Saved")):n&&n("Status not saved")}).catch(()=>{n&&n("Status not saved")})};return(n,l)=>(d(),M(Ve,null,{default:a(()=>[t(Ye,null,{default:a(()=>[t(Me,null,{default:a(()=>[V("Status (#"+R(o.value.Reference)+" "+R(o.value.User.DisplayName)+")",1)]),_:1})]),_:1}),t(Ne,null,{default:a(()=>[t(nt,null,{default:a(()=>[(d(!0),I(w,null,ae(o.value.Submissions,r=>(d(),M(Ke,{key:r.SubmissionUUID,class:"pa-0"},{default:a(()=>[t(W,{class:"py-2 align-center"},{default:a(()=>[t(k,{cols:"9",sm:"10",md:"10",lg:"9"},{default:a(()=>{var s;return[t(ce,{modelValue:r.Status,"onUpdate:modelValue":m=>r.Status=m,items:$($t),"item-text":"title","item-value":"value",variant:"outlined","hide-details":"",label:((s=n.forms.find(m=>m.FormUUID==r.FormUUID))==null?void 0:s.Name)||""},{selection:a(()=>[t(ft,{class:"mr-4 d-none d-sm-inline"},{default:a(()=>{var m;return[V(R((m=$($t).find(E=>E.value===r.Status))==null?void 0:m.icon),1)]}),_:2},1024),V(" "+R($(sa)(r.Status)),1)]),item:a(({item:m,props:{onClick:E}})=>[t(Ke,{title:m.title,"prepend-icon":m.raw.icon,onClick:E},null,8,["title","prepend-icon","onClick"])]),_:2},1032,["modelValue","onUpdate:modelValue","items","label"])]}),_:2},1024),t(k,{cols:"3",sm:"2",md:"2",lg:"1"},{default:a(()=>[t(Xe,{class:"d-none d-sm-inline-flex",title:"Save","prepend-icon":"mdi:mdi-content-save",color:"warning",onClick:s=>i(s.callback,r.SubmissionUUID)},null,8,["onClick"]),t(Xe,{class:"d-sm-none",size:"35",icon:"mdi:mdi-content-save",color:"warning",onClick:s=>i(s.callback,r.SubmissionUUID)},null,8,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1}))}}),Io=e=>(Kt("data-v-a4024c39"),e=e(),Wt(),e),Ro=Io(()=>L("p",null,"Any tags controlled through registration form fields will be reset when the applicable form is saved. If you don't know what you're doing here, don't touch!",-1)),Co={class:"mb-4"},Vo=ee({__name:"RegistrationTags",props:se({title:{}},{modelValue:{required:!0}}),emits:["update:modelValue"],setup(e){const U=Ae(),o=Te(e,"modelValue"),i=f(ve(o.value)),n=f(!1),l=f(i.value.Tags);de(o,()=>{i.value=ve(o.value)});const r=({callback:s})=>{const m=[],E=[];i.value.Tags.forEach(c=>{l.value.find(u=>u.TagUUID===c.TagUUID)||m.push(c.TagUUID)}),l.value.forEach(c=>{i.value.Tags.find(u=>c.TagUUID===u.TagUUID)||E.push(c.TagUUID)}),U.updateRegistrationTags(m,E,i.value.RegistrationUUID).then(c=>{c?s&&(s("Tags Saved"),o.value.Tags=c.Tags):s&&s("Error Saving Tags")}).catch(()=>{s&&s("Error Saving Tags")})};return(s,m)=>(d(),M(Ve,null,{default:a(()=>[t(Ye,null,{default:a(()=>[t(Me,null,{default:a(()=>[V("Tags (#"+R(i.value.Reference)+" "+R(i.value.User.DisplayName)+")",1)]),_:1})]),_:1}),t(Ne,null,{default:a(()=>[t(hl,{class:"my-4"},{default:a(()=>[t(kl,null,{default:a(()=>[V("Caution")]),_:1}),Ro]),_:1}),L("h3",Co,"#"+R(i.value.Reference)+" "+R(i.value.User.DisplayName),1),t(Zt,{modelValue:i.value.Tags,"onUpdate:modelValue":m[0]||(m[0]=E=>i.value.Tags=E),convention:i.value.ConventionUUID,"show-key":!0,chips:!0,"show-uuid":n.value},null,8,["modelValue","convention","show-uuid"])]),_:1}),t(It,{class:"px-4 align-start"},{default:a(()=>[t(na,{label:"Show UUID",modelValue:n.value,"onUpdate:modelValue":m[1]||(m[1]=E=>n.value=E)},null,8,["modelValue"]),t(Xe,{onClick:r,variant:"flat"})]),_:1})]),_:1}))}});const Oo=ot(Vo,[["__scopeId","data-v-a4024c39"]]),jt=ee({__name:"RegistrationActionWindows",props:se({accommodations:{},convention:{},extras:{},forms:{},interests:{},registration:{},tickets:{},venues:{}},{modelValue:{required:!0}}),emits:se(["update:registration"],["update:modelValue"]),setup(e,{emit:U}){const o=e,i=Te(e,"modelValue"),n=Ze(o,U,void 0,void 0,"registration");return(l,r)=>(d(),M(aa,{modelValue:i.value,"onUpdate:modelValue":r[3]||(r[3]=s=>i.value=s)},{default:a(()=>[t(he,{value:"badges"},{default:a(()=>[i.value=="badges"?(d(),M(fe,{key:0,class:"pa-0 mx-0",fluid:!0},{default:a(()=>[t(Cn,{convention:l.convention,registration:$(n)},null,8,["convention","registration"])]),_:1})):B("",!0)]),_:1}),t(he,{value:"emails"},{default:a(()=>[i.value=="emails"?(d(),M(fe,{key:0,class:"pa-0 mx-0",fluid:!0},{default:a(()=>[t(zn,{registration:$(n)},null,8,["registration"])]),_:1})):B("",!0)]),_:1}),t(he,{value:"notes"},{default:a(()=>[i.value=="notes"?(d(),M(fe,{key:0,class:"pa-0 mx-0",fluid:!0},{default:a(()=>[t(eo,{convention:l.convention,registration:$(n)},null,8,["convention","registration"])]),_:1})):B("",!0)]),_:1}),t(he,{value:"payments"},{default:a(()=>[i.value=="payments"?(d(),M(fe,{key:0,class:"pa-0 mx-0",fluid:!0},{default:a(()=>[t(So,{modelValue:$(n),"onUpdate:modelValue":r[0]||(r[0]=s=>Qe(n)?n.value=s:null),forms:l.forms,title:"Registration Payments"},null,8,["modelValue","forms"])]),_:1})):B("",!0)]),_:1}),t(he,{value:"status"},{default:a(()=>[i.value=="status"?(d(),M(fe,{key:0,class:"pa-0 mx-0",fluid:!0},{default:a(()=>[t(Do,{modelValue:$(n),"onUpdate:modelValue":r[1]||(r[1]=s=>Qe(n)?n.value=s:null),forms:l.forms},null,8,["modelValue","forms"])]),_:1})):B("",!0)]),_:1}),t(he,{value:"tags"},{default:a(()=>[i.value=="tags"?(d(),M(fe,{key:0,class:"pa-0 mx-0",fluid:!0},{default:a(()=>[t(Oo,{modelValue:$(n),"onUpdate:modelValue":r[2]||(r[2]=s=>Qe(n)?n.value=s:null),title:"Registration Tags"},null,8,["modelValue"])]),_:1})):B("",!0)]),_:1})]),_:1},8,["modelValue"]))}}),bo=(e,U)=>e===void 0?!1:Dt(e,St.GROUP_TYPE_CONVENTION,U.ConventionUUID,U).ViewPaymentTransactions,qt=ee({__name:"RegistrationActions",props:se({accommodations:{},convention:{},extras:{},forms:{},interests:{},registration:{},tickets:{},title:{},useDialog:{type:Boolean},venues:{}},{modelValue:{type:Boolean,required:!0}}),emits:se(["update:registration"],["update:modelValue"]),setup(e,{emit:U}){const o=e,i=Te(e,"modelValue"),n=Ze(o,U,void 0,void 0,"registration"),l=f("notes"),r=Rt(),s=[{label:"Badge",value:"badges"},{label:"Emails",value:"emails"},{label:"Notes",value:"notes"},{label:"Status",value:"status"},{label:"Tags",value:"tags"}];return bo(r,o.convention)&&s.splice(2,0,{label:"Payments",value:"payments"}),(m,E)=>m.useDialog?(d(),M(Ge,{key:0,modelValue:i.value,"onUpdate:modelValue":E[3]||(E[3]=c=>i.value=c),title:m.title,"show-close-action":!0,color:"primary","close-action-label":"Close",persistent:!0,"retain-focus":!1,scrollable:!0,fullscreen:"","card-class":"ma-0 pa-0"},{extension:a(()=>[t(Bt,{modelValue:l.value,"onUpdate:modelValue":E[0]||(E[0]=c=>l.value=c),tabs:s,"show-arrows":!0},null,8,["modelValue"])]),default:a(()=>[t(jt,{modelValue:l.value,"onUpdate:modelValue":E[1]||(E[1]=c=>l.value=c),registration:$(n),"onUpdate:registration":E[2]||(E[2]=c=>Qe(n)?n.value=c:null),accommodations:m.accommodations,convention:m.convention,extras:m.extras,forms:m.forms,interests:m.interests,tabs:s,tickets:m.tickets,venues:m.venues},null,8,["modelValue","registration","accommodations","convention","extras","forms","interests","tickets","venues"])]),_:1},8,["modelValue","title"])):(d(),I(w,{key:1},[t(Bt,{modelValue:l.value,"onUpdate:modelValue":E[4]||(E[4]=c=>l.value=c),tabs:s,"show-arrows":!0},null,8,["modelValue"]),t(jt,{modelValue:l.value,"onUpdate:modelValue":E[5]||(E[5]=c=>l.value=c),registration:$(n),"onUpdate:registration":E[6]||(E[6]=c=>Qe(n)?n.value=c:null),accommodations:m.accommodations,convention:m.convention,extras:m.extras,forms:m.forms,interests:m.interests,tabs:s,tickets:m.tickets,venues:m.venues},null,8,["modelValue","registration","accommodations","convention","extras","forms","interests","tickets","venues"])],64))}});function ho(){const e=f([]);Na(()=>e.value=[]);function U(o,i){e.value[i]=o}return{refs:e,updateRef:U}}const ko=zt({activeColor:String,start:{type:[Number,String],default:1},modelValue:{type:Number,default:e=>e.start},disabled:Boolean,length:{type:[Number,String],default:1,validator:e=>e%1===0},totalVisible:[Number,String],firstIcon:{type:at,default:"$first"},prevIcon:{type:at,default:"$prev"},nextIcon:{type:at,default:"$next"},lastIcon:{type:at,default:"$last"},ariaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.root"},pageAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.page"},currentPageAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.currentPage"},firstAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.first"},previousAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.previous"},nextAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.next"},lastAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.last"},ellipsis:{type:String,default:"..."},showFirstLastPage:Boolean,...ml(),...vl(),...cl(),...fl(),...Ul(),...gl(),..._l({tag:"nav"}),...La(),...pl({variant:"text"})},"VPagination"),Mo=Qt()({name:"VPagination",props:ko(),emits:{"update:modelValue":e=>!0,first:e=>!0,prev:e=>!0,next:e=>!0,last:e=>!0},setup(e,U){let{slots:o,emit:i}=U;const n=wa(e,"modelValue"),{t:l,n:r}=Pa(),{isRtl:s}=Fa(),{themeClasses:m}=$a(e),{width:E}=xa(),c=Ba(-1);ct(void 0,{scoped:!0});const{resizeRef:p}=El(A=>{if(!A.length)return;const{target:T,contentRect:S}=A[0],O=T.querySelector(".v-pagination__list > *");if(!O)return;const F=S.width,Z=O.offsetWidth+parseFloat(getComputedStyle(O).marginRight)*2;c.value=Q(F,Z)}),u=re(()=>parseInt(e.length,10)),g=re(()=>parseInt(e.start,10)),v=re(()=>e.totalVisible?parseInt(e.totalVisible,10):c.value>=0?c.value:Q(E.value,58));function Q(A,T){const S=e.showFirstLastPage?5:3;return Math.max(0,Math.floor(+((A-T*S)/T).toFixed(2)))}const P=re(()=>{if(u.value<=0||isNaN(u.value)||u.value>Number.MAX_SAFE_INTEGER)return[];if(v.value<=1)return[n.value];if(u.value<=v.value)return lt(u.value,g.value);const A=v.value%2===0,T=A?v.value/2:Math.floor(v.value/2),S=A?T:T+1,O=u.value-T;if(S-n.value>=0)return[...lt(Math.max(1,v.value-1),g.value),e.ellipsis,u.value];if(n.value-O>=(A?1:0)){const F=v.value-1,Z=u.value-F+g.value;return[g.value,e.ellipsis,...lt(F,Z)]}else{const F=Math.max(1,v.value-3),Z=F===1?n.value:n.value-Math.ceil(F/2)+g.value;return[g.value,e.ellipsis,...lt(F,Z),e.ellipsis,u.value]}});function h(A,T,S){A.preventDefault(),n.value=T,S&&i(S,T)}const{refs:C,updateRef:N}=ho();ct({VPaginationBtn:{color:pe(e,"color"),border:pe(e,"border"),density:pe(e,"density"),size:pe(e,"size"),variant:pe(e,"variant"),rounded:pe(e,"rounded"),elevation:pe(e,"elevation")}});const z=re(()=>P.value.map((A,T)=>{const S=O=>N(O,T);if(typeof A=="string")return{isActive:!1,key:`ellipsis-${T}`,page:A,props:{ref:S,ellipsis:!0,icon:!0,disabled:!0}};{const O=A===n.value;return{isActive:O,key:A,page:r(A),props:{ref:S,ellipsis:!1,icon:!0,disabled:!!e.disabled||+e.length<2,color:O?e.activeColor:e.color,ariaCurrent:O,ariaLabel:l(O?e.currentPageAriaLabel:e.pageAriaLabel,A),onClick:F=>h(F,A)}}}})),G=re(()=>{const A=!!e.disabled||n.value<=g.value,T=!!e.disabled||n.value>=g.value+u.value-1;return{first:e.showFirstLastPage?{icon:s.value?e.lastIcon:e.firstIcon,onClick:S=>h(S,g.value,"first"),disabled:A,ariaLabel:l(e.firstAriaLabel),ariaDisabled:A}:void 0,prev:{icon:s.value?e.nextIcon:e.prevIcon,onClick:S=>h(S,n.value-1,"prev"),disabled:A,ariaLabel:l(e.previousAriaLabel),ariaDisabled:A},next:{icon:s.value?e.prevIcon:e.nextIcon,onClick:S=>h(S,n.value+1,"next"),disabled:T,ariaLabel:l(e.nextAriaLabel),ariaDisabled:T},last:e.showFirstLastPage?{icon:s.value?e.firstIcon:e.lastIcon,onClick:S=>h(S,g.value+u.value-1,"last"),disabled:T,ariaLabel:l(e.lastAriaLabel),ariaDisabled:T}:void 0}});function J(){var T;const A=n.value-g.value;(T=C.value[A])==null||T.$el.focus()}function K(A){A.key===Mt.left&&!e.disabled&&n.value>+e.start?(n.value=n.value-1,Be(J)):A.key===Mt.right&&!e.disabled&&n.value<g.value+u.value-1&&(n.value=n.value+1,Be(J))}return la(()=>t(e.tag,{ref:p,class:["v-pagination",m.value,e.class],style:e.style,role:"navigation","aria-label":l(e.ariaLabel),onKeydown:K,"data-test":"v-pagination-root"},{default:()=>[t("ul",{class:"v-pagination__list"},[e.showFirstLastPage&&t("li",{key:"first",class:"v-pagination__first","data-test":"v-pagination-first"},[o.first?o.first(G.value.first):t(j,Re({_as:"VPaginationBtn"},G.value.first),null)]),t("li",{key:"prev",class:"v-pagination__prev","data-test":"v-pagination-prev"},[o.prev?o.prev(G.value.prev):t(j,Re({_as:"VPaginationBtn"},G.value.prev),null)]),z.value.map((A,T)=>t("li",{key:A.key,class:["v-pagination__item",{"v-pagination__item--is-active":A.isActive}],"data-test":"v-pagination-item"},[o.item?o.item(A):t(j,Re({_as:"VPaginationBtn"},A.props),{default:()=>[A.page]})])),t("li",{key:"next",class:"v-pagination__next","data-test":"v-pagination-next"},[o.next?o.next(G.value.next):t(j,Re({_as:"VPaginationBtn"},G.value.next),null)]),e.showFirstLastPage&&t("li",{key:"last",class:"v-pagination__last","data-test":"v-pagination-last"},[o.last?o.last(G.value.last):t(j,Re({_as:"VPaginationBtn"},G.value.last),null)])])]})),{}}}),No=["colspan"],Lo={style:{opacity:"var(--v-medium-emphasis-opacity)"}},yi=ee({__name:"RegistrationsView",emits:["pageTitle"],setup(e,{emit:U}){var Ot;const o=ra();U("pageTitle","Registration Manager");const i=Ga(),n=Ya(),l=f(!0);let r=((Ot=i.params.convention)==null?void 0:Ot.toString())||"";const s=f({ID:0,ConventionUUID:Ce(),OrganisationID:0,OrganisationUUID:mt,Name:"New Convention",Description:"",DetailLink:"",Logo:"",Slug:"",Accommodation:[],Tickets:[],Extras:[],Interests:[],Visible:!1}),m=Ae(),E=Ha.getInstance(),c=f([]),p=f({ID:0,AdminLayoutUUID:Ce(),ConventionID:s.value.ID,ConventionUUID:s.value.ConventionUUID,Name:"Registration Table",Type:va.ADMIN_LAYOUT_TABLE,Panels:[]}),u=f([]),g=f([]),v=f([]),Q=f([]),P=f([]),h=f(1),C=f(10),N=f([]),z=f(0),G=f(!1),J=f(""),K=f(""),A=f(""),T=f(""),S=f({FieldUUID:"591c9bca-c78c-4e97-8aef-bc596ef472fb",Value:""}),O=f(new Map([["591c9bca-c78c-4e97-8aef-bc596ef472fb",S.value]])),F=f(""),Z=f(""),me=f([]),ne=f([]),Le=f([]),we=f([]),Pe=f([]),Fe=f([]),ge=f(0),_e=f(),ye=f(!1),He=f(!1),fa=f(!1),et=f(),Ct=f(),st=f(),$e=f(!1),Ua=Rt();de(J,y=>{const _=P.value.find(b=>b.uuid===y);if(_){const b=_.headers.find(D=>D.defaultSort===!0);b&&(N.value=[{key:b.key,order:"asc"}],me.value=[{key:b.key,order:"asc"}])}}),de(ge,y=>{y===7&&Vt()}),de(F,()=>{K.value=Date.now().toString()}),de(Z,()=>{K.value=Date.now().toString()});const ga=()=>{u.value=[],v.value=[],P.value=[];try{m.getConventionAdminLayoutByName(s.value.ConventionUUID,"Registration Table").then(y=>{ge.value+=1,y?p.value=y:(p.value.ConventionID=s.value.ID,p.value.ConventionUUID=s.value.ConventionUUID)})}catch{p.value.ConventionID=s.value.ID,p.value.ConventionUUID=s.value.ConventionUUID}try{m.getConventionForms(s.value.ConventionUUID).then(y=>{ge.value+=1,y&&(u.value=y)})}catch{}try{m.getConventionAccommodation(s.value.ConventionUUID).then(y=>{ge.value+=1,y&&(ne.value=y)})}catch{}try{m.getConventionVenues(s.value.ConventionUUID).then(y=>{ge.value+=1,y&&(Fe.value=y)})}catch{}try{m.getConventionExtras(s.value.ConventionUUID).then(y=>{ge.value+=1,y&&(Le.value=y)})}catch{}try{m.getConventionInterests(s.value.ConventionUUID).then(y=>{ge.value+=1,y&&(we.value=y)})}catch{}try{m.getConventionTickets(s.value.ConventionUUID).then(y=>{ge.value+=1,y&&(Pe.value=y)})}catch{}try{m.getConventionGroups(s.value.ConventionUUID).then(y=>{y&&(g.value=y.sort((_,b)=>_.Name.localeCompare(b.Name)))})}catch{}try{m.getConventionTags(s.value.ConventionUUID).then(y=>{y&&(Q.value=y.sort((_,b)=>_.Title.localeCompare(b.Title)).map(_=>(_.Title=`${_.Title} [${_.Key}]`,_)))})}catch{}},ut=({page:y,itemsPerPage:_,sortBy:b})=>{l.value=!0,h.value=y,N.value=b;const D=P.value.find(oe=>oe.uuid==J.value),ue=D==null?void 0:D.layout.Items;let le="",bt="";if(b&&ue&&b.length>=1){const oe=ue.find(je=>je.LayoutItemUUID==b[0].key);switch(bt=b[0].order||"asc",oe==null?void 0:oe.MetaField){case te.META_DATA_SOURCE_ACCOMMODATION_FORM:le="submission.status";break;case te.META_DATA_SOURCE_BADGE_FORM:le="submission.status";break;case te.META_DATA_SOURCE_DEALER_FORM:le="submission.status";break;case te.META_DATA_SOURCE_REGISTRATION_FORM:le="submission.status";break;case te.META_DATA_SOURCE_REGISTRATION_REFERENCE:le="reference";break;case te.META_DATA_SOURCE_SUBMISSION_DATE:le="created";break;case te.META_DATA_SOURCE_SUBMISSION_STATUS:le="submission.status";break}switch(oe==null?void 0:oe.UserField){case ie.USER_DATA_SOURCE_DISPLAY_NAME:le="user.display_name";break;case ie.USER_DATA_SOURCE_EMAIL:le="user.email";break;case ie.USER_DATA_SOURCE_FIRST_NAME:le="user.firstname";break;case ie.USER_DATA_SOURCE_HANDLE:le="user.handle";break;case ie.USER_DATA_SOURCE_LAST_NAME:le="user.lastname";break}}try{const oe={Direction:bt,Limit:_,Offset:(y-1)*_,Order:le};D&&D.layout.RequiredRegistrationTags.length>0&&(oe.PanelUUID=D==null?void 0:D.layout.LayoutPanelUUID),(D==null?void 0:D.layout.RequiredFormType)===Ie.FORM_TYPE_ACCOMMODATION&&(oe.Accommodation=!0),(D==null?void 0:D.layout.RequiredFormType)===Ie.FORM_TYPE_BADGE&&(oe.Badge=!0),(D==null?void 0:D.layout.RequiredFormType)===Ie.FORM_TYPE_DEALER&&(oe.Dealer=!0),(D==null?void 0:D.layout.RequiredFormType)===Ie.FORM_TYPE_REGISTRATION&&(oe.Registration=!0),oe.GroupUUID=F.value||mt,oe.TagUUID=Z.value||mt,oe.Email=T.value,oe.Reference=A.value,oe.FieldValues=Array.from(O.value.values()),m.searchConventionRegistrations(s.value.ConventionUUID,oe).then(je=>{je&&(z.value=je.Total,v.value=je.Registrations,P.value.forEach(dt=>{const Ia=dt.layout;dt.items=v.value.map(Y=>{const tt=[];let Se;Y.Leader?Se=Y:Se=Y.Primary,tt.push({Name:Se.User.DisplayName,UUID:Se.UserUUID,UserUUID:Se.User.UserUUID,IsLeader:!0,Reference:Se.Reference,Paid:Se.Paid,Total:Se.Total}),tt.push(...Se.Members.map(De=>({Name:De.User.DisplayName,UUID:De.UserUUID,UserUUID:De.User.UserUUID,IsLeader:!1,Reference:De.Reference,Paid:De.Paid,Total:De.Total})));const X={};return dt.headers.forEach(De=>{var ht;const H=Ia.Items.find(qe=>qe.LayoutItemUUID===De.key);if(H){if(H.SourceType==="LAYOUT_ITEM_SOURCE_FORM"&&H.SectionField)Y.Submissions.forEach(qe=>{const xe=qe.Data.find(x=>x.SectionFieldUUID===H.SectionFieldUUID);if(xe){De.type===Qa.ACCOMMODATION?X[H.LayoutItemUUID]={Data:xe.Data,Registration:Y}:X[H.LayoutItemUUID]=xe.Data;return}});else if(H.SourceType==="LAYOUT_ITEM_SOURCE_USER"&&H.UserField)switch(H.UserField){case ie.USER_DATA_SOURCE_AVATAR:X[H.LayoutItemUUID]=o.GetProfileImageURL(Y.UserUUID);break;case ie.USER_DATA_SOURCE_DISPLAY_NAME:X[H.LayoutItemUUID]=Y.User.DisplayName;break;case ie.USER_DATA_SOURCE_EMAIL:X[H.LayoutItemUUID]=Y.User.Additional.Email;break;case ie.USER_DATA_SOURCE_HANDLE:X[H.LayoutItemUUID]=Y.User.Handle;break;case ie.USER_DATA_SOURCE_DATE_OF_BIRTH:X[H.LayoutItemUUID]=Y.User.Additional.DOB;break;case ie.USER_DATA_SOURCE_FIRST_NAME:X[H.LayoutItemUUID]=Y.User.Additional.FirstName;break;case ie.USER_DATA_SOURCE_LAST_NAME:X[H.LayoutItemUUID]=Y.User.Additional.LastName;break;case ie.USER_DATA_SOURCE_TELEGRAM:X[H.LayoutItemUUID]="";break}else if(H.SourceType==="LAYOUT_ITEM_SOURCE_META"&&H.MetaField){const qe=(ht=u.value.find(x=>x.Type===Ie.FORM_TYPE_REGISTRATION))==null?void 0:ht.FormUUID,xe=Y.Submissions.find(x=>x.FormUUID===qe);switch(H.MetaField){case te.META_DATA_SOURCE_REGISTRATION_ACTIONS:X[H.LayoutItemUUID]=Y;break;case te.META_DATA_SOURCE_REGISTRATION_GROUP:X[H.LayoutItemUUID]=tt;break;case te.META_DATA_SOURCE_REGISTRATION_REFERENCE:X[H.LayoutItemUUID]=Y.Reference;break;case te.META_DATA_SOURCE_SUBMISSION_DATE:if(xe){const x=new Date(xe.CreatedAt||"");X[H.LayoutItemUUID]=`${x.getFullYear()}-${(x.getMonth()+1).toString().padStart(2,"0")}-${x.getDate().toString().padStart(2,"0")} ${x.getHours().toString().padStart(2,"0")}:${x.getMinutes().toString().padStart(2,"0")}:${x.getSeconds().toString().padStart(2,"0")}`}else{const x=new Date(Y.CreatedAt||"");X[H.LayoutItemUUID]=`${x.getFullYear()}-${(x.getMonth()+1).toString().padStart(2,"0")}-${x.getDate().toString().padStart(2,"0")} ${x.getHours().toString().padStart(2,"0")}:${x.getMinutes().toString().padStart(2,"0")}:${x.getSeconds().toString().padStart(2,"0")}`}break;case te.META_DATA_SOURCE_ACCOMMODATION_FORM:X[H.LayoutItemUUID]=Y.Submissions.map(x=>{const q=u.value.find(Oe=>Oe.FormUUID===x.FormUUID);return{Heading:q==null?void 0:q.Heading,Form:q,Submission:x,Registration:Y}}).filter(x=>{var q;return((q=x.Form)==null?void 0:q.Type)===Ie.FORM_TYPE_ACCOMMODATION});break;case te.META_DATA_SOURCE_BADGE_FORM:X[H.LayoutItemUUID]=Y.Submissions.map(x=>{const q=u.value.find(Oe=>Oe.FormUUID===x.FormUUID);return{Heading:q==null?void 0:q.Heading,Form:q,Submission:x,Registration:Y}}).filter(x=>{var q;return((q=x.Form)==null?void 0:q.Type)===Ie.FORM_TYPE_BADGE});break;case te.META_DATA_SOURCE_DEALER_FORM:X[H.LayoutItemUUID]=Y.Submissions.map(x=>{const q=u.value.find(Oe=>Oe.FormUUID===x.FormUUID);return{Heading:q==null?void 0:q.Heading,Form:q,Submission:x,Registration:Y}}).filter(x=>{var q;return((q=x.Form)==null?void 0:q.Type)===Ie.FORM_TYPE_DEALER});break;case te.META_DATA_SOURCE_PAYMENT_STATUS:if(Y.Paid===0&&Y.Total)X[H.LayoutItemUUID]="REQUIRED";else if(Y.Total>Y.Paid)X[H.LayoutItemUUID]="ADDITIONAL_REQUIRED";else{const x=tt.find(q=>q.Paid===0&&(q.Total||0)>0);if(x){Y.Total===0&&x.Total===0?X[H.LayoutItemUUID]="NOT_REQUIRED":Y.Total===0&&x.Total||Y.Total>0&&x.Total===0?X[H.LayoutItemUUID]="MISSING_REQUIRED":Y.Paid>=Y.Total?X[H.LayoutItemUUID]="AWAITING_PARTNER":X[H.LayoutItemUUID]="ALL_REQUIRED";break}else Y.Total===0?X[H.LayoutItemUUID]="NOT_REQUIRED":X[H.LayoutItemUUID]="COMPLETE"}break;case te.META_DATA_SOURCE_SUBMISSION_STATUS:Dl(Y.Submissions,u.value),X[H.LayoutItemUUID]=Y.Submissions.map(x=>{const q=u.value.find(Oe=>Oe.FormUUID===x.FormUUID);return{Heading:q==null?void 0:q.Heading,Form:q,Submission:x,Registration:Y}});break}}}}),{key:Y.RegistrationUUID,registration:Y,...X}})}),l.value=!1)})}catch{}},_a=y=>{G.value=!1,y&&(p.value=y,Vt())},Vt=()=>{p.value.Panels.forEach(y=>{y.Items.forEach(_=>{(_.SectionField==null||_.SectionField.Field==null)&&u.value.find(b=>{b.Sections.find(D=>{if(D.Fields){const ue=D.Fields.find(le=>le.SectionFieldUUID===_.SectionFieldUUID);if(ue)return _.SectionField=ue,!0}})})})}),p.value.Panels.length>0&&(P.value=[],p.value.Panels.forEach(y=>{const _={uuid:Ce(),order:y.Order,name:y.Name,headers:[],items:[],layout:y};y.Items.sort((b,D)=>b.Order>D.Order?1:b.Order==D.Order?0:-1),_.headers=y.Items.map(b=>{var D,ue;return{key:b.LayoutItemUUID,title:b.Label||((ue=(D=b.SectionField)==null?void 0:D.Field)==null?void 0:ue.Label)||"",align:b.Align==="end"?"end":"start",sortable:Aa(b),type:pa(b),defaultSort:b.DefaultSort}}),P.value.push(_)}),P.value=P.value.sort((y,_)=>y.order>_.order?1:y.order==_.order?0:-1)),(J.value==null||J.value=="")&&P.value.length>0&&(J.value=P.value[0].uuid)};r?m.getConvention(r).then(y=>{y&&(s.value=y,p.value.ConventionID=s.value.ID,p.value.ConventionUUID=s.value.ConventionUUID,ga())}).catch(()=>{n.push("/")}):n.push("/");const pa=y=>{var _,b;if(y.SourceType===We.LAYOUT_ITEM_SOURCE_META)return`${y.SourceType}.${y.MetaField}`;if(y.SourceType===We.LAYOUT_ITEM_SOURCE_FORM)return(b=(_=y.SectionField)==null?void 0:_.Field)==null?void 0:b.Type;if(y.SourceType===We.LAYOUT_ITEM_SOURCE_USER)return`${y.SourceType}.${y.UserField}`},Aa=y=>{const _=[te.META_DATA_SOURCE_ACCOMMODATION_FORM,te.META_DATA_SOURCE_BADGE_FORM,te.META_DATA_SOURCE_DEALER_FORM,te.META_DATA_SOURCE_REGISTRATION_FORM,te.META_DATA_SOURCE_REGISTRATION_REFERENCE,te.META_DATA_SOURCE_SUBMISSION_DATE,te.META_DATA_SOURCE_SUBMISSION_STATUS],b=[ie.USER_DATA_SOURCE_DISPLAY_NAME,ie.USER_DATA_SOURCE_EMAIL,ie.USER_DATA_SOURCE_HANDLE,ie.USER_DATA_SOURCE_DATE_OF_BIRTH,ie.USER_DATA_SOURCE_FIRST_NAME,ie.USER_DATA_SOURCE_LAST_NAME];return _.includes(y.MetaField)||b.includes(y.UserField)},Ta=y=>{_e.value=y,ye.value=!0},ya=y=>{_e.value=y,He.value=!0},Ea=y=>{_e.value=y,fa.value=!0};de(ye,y=>{y||(_e.value=void 0)}),de(He,y=>{y||(_e.value=void 0)});const rt=async(y="")=>{Ct.value=await m.getRegistrationGroup(y)},Sa=({registration:y,form:_,submission:b})=>{_e.value=y,rt(y.RegistrationUUID).then(()=>{et.value=_,st.value=b,$e.value=!0})},Da=y=>{m.switchUser(y.UserUUID).then(_=>{_&&Ml(_.tokens,_.user,n,!1)}).catch(_=>{console.error(_)})};return E.on("registration.group.leave",y=>{m.leaveRegistrationGroup(y).then(_=>{_&&rt(y).then(()=>{E.emit("registration.group.left",_)})})}),E.on("registration.group.remove.member",y=>{m.leaveRegistrationGroup(y).then(_=>{_&&rt(y).then(()=>{E.emit("registration.group.left",_)})})}),(y,_)=>(d(),M(Ll,null,{default:a(()=>[t(gt,{color:"blue-darken-4"},{default:a(()=>[t(ea,{modelValue:J.value,"onUpdate:modelValue":_[0]||(_[0]=b=>J.value=b),"show-arrows":""},{default:a(()=>[(d(!0),I(w,null,ae(P.value,b=>(d(),M(ta,{key:b.uuid,value:b.uuid},{default:a(()=>[V(R(b.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"]),t(ke),t(j,{icon:"mdi:mdi-cog-outline",onClick:_[1]||(_[1]=b=>G.value=!0)})]),_:1}),t(aa,{modelValue:J.value,"onUpdate:modelValue":_[22]||(_[22]=b=>J.value=b),disabled:!0},{default:a(()=>[(d(!0),I(w,null,ae(P.value,b=>(d(),M(he,{key:b.uuid,value:b.uuid},{default:a(()=>[b.uuid===J.value?(d(),M(Ve,{key:0,class:"pa-2"},{default:a(()=>[t($(Yl),{expanded:c.value,"onUpdate:expanded":_[18]||(_[18]=D=>c.value=D),page:h.value,"onUpdate:page":_[19]||(_[19]=D=>h.value=D),"items-per-page":C.value,"onUpdate:itemsPerPage":_[20]||(_[20]=D=>C.value=D),"sort-by":me.value,"onUpdate:sortBy":_[21]||(_[21]=D=>me.value=D),headers:b.headers,"items-length":z.value,items:b.items,"item-value":"key",loading:l.value,search:K.value,"onUpdate:options":ut,"show-expand":""},Je({top:a(()=>[t(fe,null,{default:a(()=>[t(W,null,{default:a(()=>[t(k,{cols:"12",sm:"12",md:"3",lg:"2",xl:"2"},{default:a(()=>[t(Ue,{modelValue:A.value,"onUpdate:modelValue":_[2]||(_[2]=D=>A.value=D),label:"Search by Badge",clearable:!0,"hide-details":"","onClick:clear":_[3]||(_[3]=D=>K.value=Date.now().toString()),onInput:_[4]||(_[4]=D=>K.value=Date.now().toString())},null,8,["modelValue"])]),_:1}),t(k,{cols:"12",sm:"12",md:"4",lg:"5",xl:"3"},{default:a(()=>[t(Ue,{modelValue:S.value.Value,"onUpdate:modelValue":_[5]||(_[5]=D=>S.value.Value=D),label:"Search By Furry Name",clearable:!0,"hide-details":"","onClick:clear":_[6]||(_[6]=D=>K.value=Date.now().toString()),onInput:_[7]||(_[7]=D=>K.value=Date.now().toString())},null,8,["modelValue"])]),_:1}),t(k,{cols:"12",sm:"12",md:"5",lg:"5",xl:"3"},{default:a(()=>[t(Ue,{modelValue:T.value,"onUpdate:modelValue":_[8]||(_[8]=D=>T.value=D),label:"Search By Email",clearable:!0,"hide-details":"","onClick:clear":_[9]||(_[9]=D=>K.value=Date.now().toString()),onInput:_[10]||(_[10]=D=>K.value=Date.now().toString())},null,8,["modelValue"])]),_:1}),t(k,{cols:"12",sm:"6",md:"6",lg:"6",xl:"2"},{default:a(()=>[t(ce,{modelValue:F.value,"onUpdate:modelValue":_[11]||(_[11]=D=>F.value=D),label:"Search By Group",clearable:!0,"hide-details":"",items:g.value,"item-value":"GroupUUID","item-title":"Name"},null,8,["modelValue","items"])]),_:1}),t(k,{cols:"12",sm:"6",md:"6",lg:"6",xl:"2"},{default:a(()=>[t(ce,{modelValue:Z.value,"onUpdate:modelValue":_[12]||(_[12]=D=>Z.value=D),label:"Search By Tag",clearable:!0,"hide-details":"",items:Q.value,"item-value":"TagUUID","item-title":"Title"},null,8,["modelValue","items"])]),_:1})]),_:1})]),_:1})]),"expanded-row":a(({columns:D,item:ue})=>[L("tr",null,[L("td",{colspan:D.length},[t(qt,{modelValue:ye.value,"onUpdate:modelValue":_[14]||(_[14]=le=>ye.value=le),registration:ue.selectable.registration,"onUpdate:registration":le=>ue.selectable.registration=le,accommodations:ne.value,convention:s.value,extras:Le.value,forms:u.value,interests:we.value,tickets:Pe.value,title:`Registration Controls (#${ue.selectable.registration.Reference} ${ue.selectable.registration.User.DisplayName})`,"use-dialog":!1,venues:Fe.value},null,8,["modelValue","registration","onUpdate:registration","accommodations","convention","extras","forms","interests","tickets","title","venues"])],8,No)])]),"item.data-table-expand":a(({item:D})=>[c.value.findIndex(ue=>ue===D.key)>=0?(d(),M(j,{key:0,"append-icon":"mdi:mdi-chevron-up",size:"xs",variant:"flat",onClick:ue=>c.value.splice(c.value.findIndex(le=>le===D.key),1)},{default:a(()=>[D.selectable.registration.Notes&&D.selectable.registration.Notes.length>0?(d(),I(w,{key:0},[V(R(D.selectable.registration.Notes.length),1)],64)):B("",!0)]),_:2},1032,["onClick"])):(d(),M(j,{key:1,"append-icon":"mdi:mdi-chevron-down",size:"xs",variant:"flat",onClick:ue=>c.value.push(D.key)},{default:a(()=>[D.selectable.registration.Notes&&D.selectable.registration.Notes.length>0?(d(),I(w,{key:0},[V(R(D.selectable.registration.Notes.length),1)],64)):B("",!0)]),_:2},1032,["onClick"]))]),bottom:a(()=>[t(fe,{fluid:!0},{default:a(()=>[t(W,{class:"align-center"},{default:a(()=>[t(k,{cols:"12",lg:"7","order-lg":"3",xl:"8"},{default:a(()=>[t(Mo,{modelValue:h.value,"onUpdate:modelValue":_[15]||(_[15]=D=>h.value=D),length:Math.ceil(z.value/C.value)},null,8,["modelValue","length"])]),_:1}),t(k,{cols:"6",sm:"4",md:"2",lg:"2",xl:"1","order-lg":"1"},{default:a(()=>[t(ce,{"model-value":C.value,density:"compact","hide-details":"","item-title":"title","item-value":"value",label:"Items per page",min:"-1",max:"100",type:"number",variant:"outlined",items:[{title:"10",value:10},{title:"25",value:25},{title:"50",value:50},{title:"100",value:100},{title:"All",value:-1}],"onUpdate:modelValue":_[16]||(_[16]=D=>C.value=parseInt(D,10))},null,8,["model-value"])]),_:1}),t(k,{cols:"6",sm:"3",md:"2",lg:"1",xl:"1","order-lg":"2"},{default:a(()=>[t(Ue,{modelValue:h.value,"onUpdate:modelValue":_[17]||(_[17]=D=>h.value=D),modelModifiers:{number:!0},density:"compact","hide-details":"",label:"Page",min:"1",max:Math.ceil(z.value/C.value),type:"number",variant:"outlined"},null,8,["modelValue","max"])]),_:1}),t(k,{class:"text-right",cols:"12",sm:"5",md:"8",lg:"2",xl:"2","order-lg":"4"},{default:a(()=>[L("span",Lo,[C.value===-1?(d(),I(w,{key:0},[V(" 1-"+R(z.value)+" of "+R(z.value),1)],64)):(d(),I(w,{key:1},[V(R((h.value-1)*C.value+1)+"-"+R(h.value*C.value>=z.value?z.value:h.value*C.value)+" of "+R(z.value),1)],64))])]),_:1})]),_:1})]),_:1})]),_:2},[ae(b.headers,D=>({name:`item.${D.key}`,fn:a(({item:ue})=>[t(Rn,{header:D,item:ue,accommodations:ne.value,convention:s.value,extras:Le.value,forms:u.value,interests:we.value,tickets:Pe.value,user:$(Ua),venues:Fe.value,onOpenActions:Ta,onOpenPayments:ya,onOpenTags:Ea,onReload:_[13]||(_[13]=le=>ut({page:h.value,itemsPerPage:C.value,sortBy:N.value})),onSwitchUser:Da,onShowForm:Sa},null,8,["header","item","accommodations","convention","extras","forms","interests","tickets","user","venues"])])}))]),1032,["expanded","page","items-per-page","sort-by","headers","items-length","items","loading","search"])]),_:2},1024)):B("",!0)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"]),G.value?(d(),M(Hl,{key:0,title:"Edit Layout",modelValue:G.value,"onUpdate:modelValue":_[23]||(_[23]=b=>G.value=b),layout:p.value,onSave:_a},null,8,["modelValue","layout"])):B("",!0),_e.value?(d(),I(w,{key:1},[ye.value?(d(),M(qt,{key:0,modelValue:ye.value,"onUpdate:modelValue":_[24]||(_[24]=b=>ye.value=b),registration:_e.value,"onUpdate:registration":_[25]||(_[25]=b=>_e.value=b),accommodations:ne.value,convention:s.value,extras:Le.value,forms:u.value,interests:we.value,tickets:Pe.value,title:`Registration Controls (#${_e.value.Reference} ${_e.value.User.DisplayName})`,"use-dialog":!0,venues:Fe.value},null,8,["modelValue","registration","accommodations","convention","extras","forms","interests","tickets","title","venues"])):B("",!0)],64)):B("",!0),$e.value&&st.value&&et.value?(d(),M(_t,{key:2,modelValue:$e.value,"onUpdate:modelValue":_[29]||(_[29]=b=>$e.value=b),scrollable:!0,fullscreen:!0,persistent:!0},{default:a(()=>[t(Ve,{class:"bg-red-darken-4"},{default:a(()=>[t(gt,{color:"error"},{default:a(()=>[t(ma,null,{default:a(()=>[V("Submission Editor - Admin Mode")]),_:1}),t(ke),t(Nl,null,{default:a(()=>[t(j,{icon:"mdi:mdi-window-close",onClick:_[26]||(_[26]=b=>$e.value=!1)})]),_:1})]),_:1}),t(Ne,null,{default:a(()=>[t(za,{modelValue:et.value,"onUpdate:modelValue":_[27]||(_[27]=b=>et.value=b),admin:!0,convention:s.value,data:st.value,editable:!0,"registration-group":Ct.value,onClose:_[28]||(_[28]=b=>{$e.value=!1,ut({page:h.value,itemsPerPage:C.value,sortBy:N.value})})},null,8,["modelValue","convention","data","registration-group"])]),_:1})]),_:1})]),_:1},8,["modelValue"])):B("",!0)]),_:1}))}});export{yi as default};
