import{u as I,m as T,A,_ as L}from"./useTokenManager-tt8J-r30.js";import{i as D,V as N,r as n,b as S,n as R,q as g,v as c,f as y,x,A as k,P as M,U as O}from"./index-D5mmRHTR.js";import{L as P}from"./logout-EOgWWWGu.js";import{a as w,V as E}from"./VRow-XlwVPSau.js";import{V as B}from"./VBtn-rdS5lROB.js";import{a as $}from"./VContainer-9TGMTfPR.js";import{a as J}from"./VTable-mIqhc-tJ.js";import"./VCheckboxBtn-zi59nfoZ.js";import"./VTextField--cSoDXvw.js";import"./forwardRefs-17_Eu96_.js";import"./VAvatar-WSCH3toI.js";import"./ModelDialog.vue_vue_type_script_setup_true_lang-OJtZaVej.js";import"./SaveButton.vue_vue_type_script_setup_true_lang-hVOA7QIZ.js";import"./scopeId-36lxKlMl.js";import"./createSimpleFunctional-tO58eGx8.js";import"./VDialog-ch8GZfti.js";import"./VToolbar-3K2xJ1Sk.js";import"./VCard-i8T9d1aE.js";import"./useDisplayTransactions-syBDexyT.js";import"./VList-KIeAWoVE.js";import"./VDivider-owgJKfvf.js";import"./VSelect-1FQt1Od3.js";import"./VChip-81vgRRgY.js";import"./userData-QYtcK0Js.js";import"./canEditRegistrations-A1ez9bSf.js";import"./group-7fhbY6WJ.js";import"./canDo-yWCfI_4r.js";import"./nil-rxyd0N8M.js";import"./VAutocomplete-25hjliVP.js";import"./form-0fJbSFPv.js";import"./submission-40fey8Hx.js";import"./v4-yQnnJER4.js";import"./VDataTable-eV28VNCG.js";import"./DeleteDialog.vue_vue_type_script_setup_true_lang-GY94EK39.js";import"./VTextarea-SWtf3pW0.js";import"./VForm-h814H9Ke.js";import"./VNavigationDrawer-qYsexcm-.js";const q=D({__name:"RunnerSocket",emits:["data","ready","updating","updated"],setup(V,{emit:U}){const C=M(),u=N(),r=U,i=n(),p=n(),v=n(),s=n(!1),o=I({mode:"host",wsUri:C.getRunnerSocketURL()}),d=T();o.on("authenticated",()=>{s.value=!0,f()}),o.on("auth_failed",()=>{s.value=!1}),o.on("open",()=>{const t=d.getTokenByService("GrazeAPI");o.send(`AUTH ${t==null?void 0:t.AccessToken}`)}),o.on("convention_data",t=>{if(!t)return;const e=t;i.value=e.Convention,r("updated",e),r("ready")}),o.on("runner_data",t=>{if(!t)return;const e=t;if(!(!e.RunnerLayout||!e.Registration)){if(r("data",e),p.value=e.RunnerLayout,v.value=e.Registration,!i.value||e.RunnerLayout.ConventionUUID!==i.value.ConventionUUID){r("updating"),m(e.RunnerLayout.ConventionUUID);return}r("ready")}});const f=()=>{const t={Key:u.params.session||"",Mode:"runner",UserUUID:u.params.user||""},e={Command:"SET_MODE",Params:new Map,Data:JSON.stringify(t)};o.JSON(e)},m=t=>{const a={Command:"GET_CONVENTION_DATA",Params:new Map,Data:JSON.stringify({ConventionUUID:t})};o.JSON(a)};S(()=>{o.destroy()});const _=()=>{P(),O().push("/")};return(t,e)=>s.value?(R(),g($,{key:0,fluid:!0},{default:c(()=>[y(E,null,{default:c(()=>[y(w,{class:"text-center"},{default:c(()=>[y(B,{"prepend-icon":"mdi:mdi-link-variant-remove",variant:"flat",color:"error",onClick:_},{default:c(()=>[x(" Disconnect ")]),_:1})]),_:1})]),_:1})]),_:1})):k("",!0)}}),Ve=D({__name:"RunnerView",emits:["pageTitle"],setup(V,{emit:U}){U("pageTitle","Registration Runner");const u=n([]),r=n(),i=n([]),p=n([]),v=n([]),s=n({ID:0,AdminLayoutUUID:"",ConventionID:0,ConventionUUID:"",Name:"",RunnerLayoutUUID:"",Type:A.ADMIN_LAYOUT_PANELS,Panels:[]}),o=n(),d=n([]),f=n([]),m=n(!1),_=e=>{s.value=e.RunnerLayout,o.value=e.Registration},t=e=>{u.value=e.Accommodations,r.value=e.Convention,i.value=e.Extras,p.value=e.Forms,v.value=e.Interests,d.value=e.Tickets,f.value=e.Venues,s.value&&(m.value=!0)};return(e,a)=>(R(),g(J,null,{default:c(()=>[s.value&&r.value&&o.value?(R(),g(L,{key:0,convention:r.value,tickets:d.value,accommodations:u.value,extras:i.value,venues:f.value,interests:v.value,forms:p.value,layout:s.value,"onUpdate:layout":a[0]||(a[0]=l=>s.value=l),modelValue:o.value,"onUpdate:modelValue":a[1]||(a[1]=l=>o.value=l)},null,8,["convention","tickets","accommodations","extras","venues","interests","forms","layout","modelValue"])):k("",!0),y(q,{onData:_,onReady:a[2]||(a[2]=l=>m.value=!0),onUpdating:a[3]||(a[3]=l=>m.value=!1),onUpdated:t})]),_:1}))}});export{Ve as default};
