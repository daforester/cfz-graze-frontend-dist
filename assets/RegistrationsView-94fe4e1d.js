import{p as Mt,n as Vt,e as ve,t as ye,c as bt,G as Nt,v as t,H as N,x as xe,I as le,a0 as Te,a1 as $e,r as _,K as _e,M as r,N as G,O as o,a3 as Ee,W as x,a2 as Ke,a4 as Z,S as j,w as ne,X as M,Q as k,V as R,P as $,_ as Je,ab as Lt,E as at,k as kt,f as Ft,d as Pt,o as wt,ac as ot,Y as $t,Z as Bt,a6 as Gt,a5 as Yt}from"./index-26d0dbb1.js";import{e as Ht,T as xt,d as jt,c as qt}from"./FormRenderer.vue_vue_type_style_index_0_lang-212646cd.js";import{a as Kt,F as Ae}from"./form-29fd1dbb.js";import{_ as Be}from"./ModelDialog.vue_vue_type_script_setup_true_lang-eaa25677.js";import{m as zt,k as Jt,l as Wt,n as Qt,o as Xt,p as Zt,q as ea,u as ta,r as aa,s as oa,t as na,v as la,w as ia,x as sa,y as ua,z as nt,A as lt,B as it,a as ra,_ as da,f as st,c as vt,d as _t,e as At,b as Ut,V as Tt,g as ma,h as ca,i as va,j as _a}from"./VWindowItem-8db9ec82.js";import{V as ee,a as F}from"./VRow-684a14d6.js";import{V as Ue}from"./VTextField-d4a25fd1.js";import{V as oe}from"./copyToClipboard-75da7948.js";import{u as Aa,j as Ce,V as Ua}from"./VContainer-77491802.js";import{V as Ta,u as We}from"./VCheckbox-3df4986a.js";import{v as he}from"./v4-a960c1f4.js";import{h as Fe,b as Ea,a as fa,c as Sa,d as pa,P as Et,u as ft}from"./useDisplayTransactions-f9a9aa1a.js";import{V as we,a as Ne}from"./VList-09274f43.js";import{V as se}from"./VBtn-4792c39e.js";import{b as St,c as ut}from"./submission-9dd916bb.js";import{V as Da}from"./VAvatar-0bc93986.js";import{c as Ra,e as pt,V as Ia}from"./VCard-9261adb4.js";import{V as ga}from"./VDialog-d223460e.js";import{s as Pe}from"./sortSubmissions-8ed80f07.js";import{V as Dt,a as ya}from"./scopeId-28e98f55.js";import{_ as ze}from"./SaveButton.vue_vue_type_script_setup_true_lang-a14aa268.js";import{u as je}from"./nil-d01db1aa.js";import{V as Oa}from"./VToolbar-c1998423.js";import{V as rt,a as Ca}from"./VTable-bd939303.js";import"./index-26b71cef.js";import"./VTextarea-1b771877.js";import"./forwardRefs-8cc8d336.js";import"./VChip-b9360f18.js";import"./userData-a1d6dbdb.js";import"./VForm-d98253ee.js";import"./VToolbarItems-189c3bce.js";import"./VDivider-266b566b.js";import"./createSimpleFunctional-8454c229.js";var Rt=(e=>(e.ADMIN_LAYOUT_PANELS="ADMIN_LAYOUT_PANELS",e.ADMIN_LAYOUT_TABLE="ADMIN_LAYOUT_TABLE",e))(Rt||{});const ha=[{title:"Panel Layout",value:"ADMIN_LAYOUT_PANELS"},{title:"Table Layout",value:"ADMIN_LAYOUT_TABLE"}];var Le=(e=>(e.LAYOUT_ITEM_SOURCE_FORM="LAYOUT_ITEM_SOURCE_FORM",e.LAYOUT_ITEM_SOURCE_META="LAYOUT_ITEM_SOURCE_META",e.LAYOUT_ITEM_SOURCE_USER="LAYOUT_ITEM_SOURCE_USER",e))(Le||{});const Ma=[{title:"Form Field Submission Data",value:"LAYOUT_ITEM_SOURCE_FORM"},{title:"Miscellaneous Data",value:"LAYOUT_ITEM_SOURCE_META"},{title:"User Profile Data",value:"LAYOUT_ITEM_SOURCE_USER"}];var q=(e=>(e.META_DATA_SOURCE_ACCOMMODATION_ALLOCATION="META_DATA_SOURCE_ACCOMMODATION_ALLOCATION",e.META_DATA_SOURCE_ACCOMMODATION_FORM="META_DATA_SOURCE_ACCOMMODATION_FORM",e.META_DATA_SOURCE_BADGE_FORM="META_DATA_SOURCE_BADGE_FORM",e.META_DATA_SOURCE_DEALER_FORM="META_DATA_SOURCE_DEALER_FORM",e.META_DATA_SOURCE_REGISTRATION_ACTIONS="META_DATA_SOURCE_REGISTRATION_ACTIONS",e.META_DATA_SOURCE_REGISTRATION_FORM="META_DATA_SOURCE_REGISTRATION_FORM",e.META_DATA_SOURCE_REGISTRATION_GROUP="META_DATA_SOURCE_REGISTRATION_GROUP",e.META_DATA_SOURCE_REGISTRATION_REFERENCE="META_DATA_SOURCE_REGISTRATION_REFERENCE",e.META_DATA_SOURCE_SUBMISSION_DATE="META_DATA_SOURCE_SUBMISSION_DATE",e.META_DATA_SOURCE_SUBMISSION_STATUS="META_DATA_SOURCE_SUBMISSION_STATUS",e))(q||{});const Va=[{title:"Accommodation Allocation",value:"META_DATA_SOURCE_ACCOMMODATION_ALLOCATION"},{title:"Accommodation Form",value:"META_DATA_SOURCE_ACCOMMODATION_FORM"},{title:"Actions",value:"META_DATA_SOURCE_REGISTRATION_ACTIONS"},{title:"Badge Form",value:"META_DATA_SOURCE_BADGE_FORM"},{title:"Dealer Form",value:"META_DATA_SOURCE_DEALER_FORM"},{title:"Registration Group",value:"META_DATA_SOURCE_REGISTRATION_GROUP"},{title:"Registration Reference",value:"META_DATA_SOURCE_REGISTRATION_REFERENCE"},{title:"Registration Form",value:"META_DATA_SOURCE_REGISTRATION_FORM"},{title:"Submission Date",value:"META_DATA_SOURCE_SUBMISSION_DATE"},{title:"Submission Status",value:"META_DATA_SOURCE_SUBMISSION_STATUS"}];var X=(e=>(e.USER_DATA_SOURCE_NULL="",e.USER_DATA_SOURCE_DISPLAY_NAME="USER_DATA_SOURCE_DISPLAY_NAME",e.USER_DATA_SOURCE_HANDLE="USER_DATA_SOURCE_HANDLE",e.USER_DATA_SOURCE_AVATAR="USER_DATA_SOURCE_AVATAR",e.USER_DATA_SOURCE_FIRST_NAME="USER_DATA_SOURCE_FIRST_NAME",e.USER_DATA_SOURCE_LAST_NAME="USER_DATA_SOURCE_LAST_NAME",e.USER_DATA_SOURCE_DATE_OF_BIRTH="USER_DATA_SOURCE_DATE_OF_BIRTH",e.USER_DATA_SOURCE_EMAIL="USER_DATA_SOURCE_EMAIL",e.USER_DATA_SOURCE_TELEGRAM="USER_DATA_SOURCE_TELEGRAM",e))(X||{});const ba=[{title:"Display Name",value:"USER_DATA_SOURCE_DISPLAY_NAME"},{title:"Handle",value:"USER_DATA_SOURCE_HANDLE"},{title:"Avatar",value:"USER_DATA_SOURCE_AVATAR"},{title:"First Name",value:"USER_DATA_SOURCE_FIRST_NAME"},{title:"Last Name",value:"USER_DATA_SOURCE_LAST_NAME"},{title:"Date of Birth",value:"USER_DATA_SOURCE_DATE_OF_BIRTH"},{title:"Email Address",value:"USER_DATA_SOURCE_EMAIL"},{title:"Telegram Username",value:"USER_DATA_SOURCE_TELEGRAM"}],Na=e=>{switch(e){case"EMAIL_STATUS_QUEUED":return"Queued";case"EMAIL_STATUS_SENDING":return"Sending";case"EMAIL_STATUS_SENT":return"Sent";case"EMAIL_STATUS_SEND_ERROR":return"Send Error"}return"Unknown"},La=Mt({itemsLength:{type:[Number,String],required:!0},...zt(),...Jt(),...Wt()},"VDataTableServer"),ka=Vt()({name:"VDataTableServer",props:La(),emits:{"update:modelValue":e=>!0,"update:page":e=>!0,"update:itemsPerPage":e=>!0,"update:sortBy":e=>!0,"update:options":e=>!0,"update:expanded":e=>!0,"update:groupBy":e=>!0,"click:row":(e,f)=>!0},setup(e,f){let{emit:s,slots:n}=f;const{groupBy:l}=Qt(e),{sortBy:i,multiSort:E,mustSort:m}=Xt(e),{page:S,itemsPerPage:p}=Zt(e),U=ve(()=>parseInt(e.itemsLength,10)),{columns:a,headers:u}=ea(e,{groupBy:l,showSelect:ye(e,"showSelect"),showExpand:ye(e,"showExpand")}),{items:A}=ta(e,a),{toggleSort:c}=aa({sortBy:i,multiSort:E,mustSort:m,page:S}),{opened:b,isGroupOpen:v,toggleGroup:O,extractRows:g}=oa({groupBy:l,sortBy:i}),{pageCount:w,setItemsPerPage:K}=na({page:S,itemsPerPage:p,itemsLength:U}),{flatItems:ie}=la(A,l,b),{isSelected:fe,select:Se,selectAll:C,toggleSelect:h,someSelected:L,allSelected:I}=ia(e,{allItems:A,currentPage:A}),{isExpanded:P,toggleExpand:J}=sa(e),te=ve(()=>g(A.value));ua({page:S,itemsPerPage:p,sortBy:i,groupBy:l,search:ye(e,"search")}),bt("v-data-table",{toggleSort:c,sortBy:i}),Nt({VDataTableRows:{hideNoData:ye(e,"hideNoData"),noDataText:ye(e,"noDataText"),loading:ye(e,"loading"),loadingText:ye(e,"loadingText")}});const z=ve(()=>({page:S.value,itemsPerPage:p.value,sortBy:i.value,pageCount:w.value,toggleSort:c,setItemsPerPage:K,someSelected:L.value,allSelected:I.value,isSelected:fe,select:Se,selectAll:C,toggleSelect:h,isExpanded:P,toggleExpand:J,isGroupOpen:v,toggleGroup:O,items:te.value,groupedItems:ie.value,columns:a.value,headers:u.value}));Aa(()=>{const[de]=nt.filterProps(e),[ue]=lt.filterProps(e),[pe]=it.filterProps(e),[De]=rt.filterProps(e);return t(rt,xe({class:["v-data-table",{"v-data-table--loading":e.loading},e.class],style:e.style},De),{top:()=>{var Re;return(Re=n.top)==null?void 0:Re.call(n,z.value)},default:()=>{var Re,Me,Ve,ke;return n.default?n.default(z.value):t(N,null,[(Re=n.colgroup)==null?void 0:Re.call(n,z.value),t("thead",{class:"v-data-table__thead",role:"rowgroup"},[t(lt,xe(ue,{sticky:e.fixedHeader}),n)]),(Me=n.thead)==null?void 0:Me.call(n,z.value),t("tbody",{class:"v-data-table__tbody",role:"rowgroup"},[n.body?n.body(z.value):t(it,xe(pe,{items:ie.value}),n)]),(Ve=n.tbody)==null?void 0:Ve.call(n,z.value),(ke=n.tfoot)==null?void 0:ke.call(n,z.value)])},bottom:()=>n.bottom?n.bottom(z.value):t(nt,de,{prepend:n["footer.prepend"]})})})}}),Fa=le({__name:"EditAdminLayout",props:Te({title:{default:""},layout:{}},{modelValue:{type:Boolean,required:!0}}),emits:Te(["save"],["update:modelValue"]),setup(e,{emit:f}){const s=$e(e,"modelValue"),n=_(_e(e.layout)),l=_([]),i=Ee(),E=({callback:U})=>{const a=()=>{U&&U("Failed to Save Layout")},u=()=>{U&&U("Layout Saved")};i.saveAdminLayout(n.value).then(A=>{A?(u(),f("save",A)):a()}).catch(()=>{a()})},m=()=>({ID:0,LayoutPanelUUID:he(),AdminLayoutID:n.value.ID,AdminLayoutUUID:n.value.AdminLayoutUUID,Name:"",Order:n.value.Panels.length+1,Items:[],RequiredFormType:Ae.FORM_TYPE_NIL,RequiredGroupMemberships:[],RequiredRegistrationTags:[]}),S=U=>()=>({ID:0,LayoutItemUUID:he(),LayoutPanelID:U.ID,LayoutPanelUUID:U.LayoutPanelUUID,Label:"",SourceType:Le.LAYOUT_ITEM_SOURCE_FORM,SectionFieldID:void 0,SectionFieldUUID:void 0,SectionField:void 0,MetaField:void 0,UserField:void 0,Align:"",Order:U.Items.length+1,DefaultSort:!1}),p=U=>{const a=l.value.find(u=>u.value===U.SectionFieldUUID);a&&(U.SectionFieldID=a.object.ID,U.SectionField=a.object)};return i.getConventionForms(e.layout.ConventionUUID).then(U=>{U.forEach(a=>a.Sections.forEach(u=>u.Fields&&l.value.push(...u.Fields.map(A=>{var b;return{title:`${a.Name} - ${u.Name} - ${(b=A.Field)==null?void 0:b.Name}`,value:A.SectionFieldUUID,object:A}})))),l.value.sort(Ht("title"))}),(U,a)=>(r(),G(Be,{modelValue:s.value,"onUpdate:modelValue":a[3]||(a[3]=u=>s.value=u),onSave:E,title:U.title,color:"primary"},{default:o(()=>[t(Ce,{class:"px-0 mx-0",fluid:!0},{default:o(()=>[t(ee,null,{default:o(()=>[t(F,{cols:"12",sm:"6"},{default:o(()=>[t(Ue,{modelValue:n.value.Name,"onUpdate:modelValue":a[0]||(a[0]=u=>n.value.Name=u),label:"Name",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),t(F,{cols:"12",sm:"6"},{default:o(()=>[t(oe,{modelValue:n.value.Type,"onUpdate:modelValue":a[1]||(a[1]=u=>n.value.Type=u),label:"Layout Type",items:x(ha),"item-title":"title","item-value":"value",variant:"outlined","hide-details":""},null,8,["modelValue","items"])]),_:1})]),_:1})]),_:1}),t(st,{modelValue:n.value.Panels,"onUpdate:modelValue":a[2]||(a[2]=u=>n.value.Panels=u),"new-item":m,closeable:!1,title:"Panels",label:"Name","slot-name-prefix":"panel"},Ke({_:2},[Z(n.value.Panels,(u,A)=>({name:`panel_${A}`,fn:o(()=>[t(Ce,{class:"px-0 mx-0",fluid:!0},{default:o(()=>[t(ee,null,{default:o(()=>[t(F,{cols:"12",sm:"6"},{default:o(()=>[t(Ue,{modelValue:u.Name,"onUpdate:modelValue":c=>u.Name=c,label:"Name",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),t(F,{cols:"12",sm:"6"},{default:o(()=>[t(oe,{modelValue:u.RequiredFormType,"onUpdate:modelValue":c=>u.RequiredFormType=c,items:x(Kt),clearable:!0,label:"Required Form",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"])]),_:2},1024)]),_:2},1024),t(ee,null,{default:o(()=>[t(F,{cols:"12",sm:"6"},{default:o(()=>[t(ra,{label:"Required Groups",variant:"outlined",modelValue:u.RequiredGroupMemberships,"onUpdate:modelValue":c=>u.RequiredGroupMemberships=c,convention:n.value.ConventionUUID,chips:"",clearable:"",hint:"Groups that a user must be in to see this form. (Any one)"},null,8,["modelValue","onUpdate:modelValue","convention"])]),_:2},1024),t(F,{cols:"12",sm:"6"},{default:o(()=>[t(da,{label:"Registration Tags",variant:"outlined",modelValue:u.RequiredRegistrationTags,"onUpdate:modelValue":c=>u.RequiredRegistrationTags=c,convention:n.value.ConventionUUID,chips:"",clearable:"",hint:"Tags that a registration must have to appear in results. (Any one)"},null,8,["modelValue","onUpdate:modelValue","convention"])]),_:2},1024)]),_:2},1024)]),_:2},1024),t(st,{modelValue:u.Items,"onUpdate:modelValue":c=>u.Items=c,"new-item":S(u),closeable:!1,title:"Items",label:"Label","slot-name-prefix":"item"},Ke({_:2},[Z(u.Items,(c,b)=>({name:`item_${b}`,fn:o(()=>[t(Ce,{class:"px-0 mx-0",fluid:!0},{default:o(()=>[t(ee,null,{default:o(()=>[t(F,{cols:"12",sm:"6"},{default:o(()=>[t(Ue,{modelValue:c.Label,"onUpdate:modelValue":v=>c.Label=v,label:"Name",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024),t(ee,null,{default:o(()=>[t(F,{cols:"12",sm:"6"},{default:o(()=>[t(oe,{modelValue:c.SourceType,"onUpdate:modelValue":v=>c.SourceType=v,label:"Source Type",items:x(Ma),"item-title":"title","item-value":"value",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"])]),_:2},1024),t(F,{cols:"12",sm:"6"},{default:o(()=>[c.SourceType==="LAYOUT_ITEM_SOURCE_FORM"?(r(),G(oe,{key:0,modelValue:c.SectionFieldUUID,"onUpdate:modelValue":v=>c.SectionFieldUUID=v,label:"Form Data",items:l.value,"item-title":"title","item-value":"value",variant:"outlined","hide-details":"",onBlur:v=>p(c)},null,8,["modelValue","onUpdate:modelValue","items","onBlur"])):c.SourceType==="LAYOUT_ITEM_SOURCE_META"?(r(),G(oe,{key:1,modelValue:c.MetaField,"onUpdate:modelValue":v=>c.MetaField=v,label:"Miscellaneous Data",items:x(Va),"item-title":"title","item-value":"value",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"])):c.SourceType==="LAYOUT_ITEM_SOURCE_USER"?(r(),G(oe,{key:2,modelValue:c.UserField,"onUpdate:modelValue":v=>c.UserField=v,label:"User Profile Data",items:x(ba),"item-title":"title","item-value":"value",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"])):j("",!0)]),_:2},1024)]),_:2},1024),t(ee,null,{default:o(()=>[t(F,null,{default:o(()=>[t(Ta,{modelValue:c.DefaultSort,"onUpdate:modelValue":v=>c.DefaultSort=v,label:"Default Sort","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)]),_:2},1024)])}))]),1032,["modelValue","onUpdate:modelValue","new-item"])])}))]),1032,["modelValue"])]),_:1},8,["modelValue","title"]))}}),Pa=M("br",null,null,-1),wa=M("h3",null,"Assigned Accommodation",-1),$a=M("br",null,null,-1),Ba=M("br",null,null,-1),Ga=M("h3",null,"Accommodation Preferences",-1),Ya=M("h3",null,"Selected Tickets",-1),Ha=M("br",null,null,-1),xa=le({__name:"EditAccommodationAssignmentDialog",props:Te({convention:{},registration:{},selectedAccommodation:{},title:{}},{modelValue:{type:Boolean,required:!0}}),emits:Te(["update:field"],["update:modelValue"]),setup(e,{emit:f}){const s=e,{convention:n,registration:l,title:i=""}=s,E=Ee(),m=$e(e,"modelValue"),S=_({capacity:{max:C=>{var I;const h=w.value.find(P=>P.room.RoomUUID===C);return!h||h.room.MaximumCapacity===0?!0:(((I=u.value)==null?void 0:I.Members.length)||0)<=h.room.MaximumCapacity||"Too many people in the group for this room"},min:C=>{var I;const h=w.value.find(P=>P.room.RoomUUID===C);return!h||h.room.MinimumCapacity===0?!0:(((I=u.value)==null?void 0:I.Members.length)||0)>=h.room.MinimumCapacity||"Not enough people in the group for this room"}}}),p=_([]),U=We(s,f,void 0,void 0,"field"),a=_(_e(U.value));ne(U,()=>{a.value=_e(U.value)});const u=_(),A=_(""),c=_(""),b=_([]),v=_({Ticket:[],AddonsChecked:[],ComponentsChecked:[]}),O=async()=>{var I;const C=await E.getConventionAvailableAccommodation(n.ConventionUUID);C&&(p.value=C);const h=await E.getRegistrationGroup(l.RegistrationUUID||"");h&&(u.value=h);const L=await E.getConventionTickets(n.ConventionUUID);L&&(b.value=L);try{v.value=JSON.parse(((I=u.value)==null?void 0:I.TicketData)||"")}catch{}};ne(A,()=>{c.value=w.value.length>0?w.value[0].value:""});const g=ve(()=>{const C=K.value;return p.value.map(h=>{let L;return C.forEach(I=>{h.Costs.forEach(P=>{P.DateStart===(I==null?void 0:I.DateStart)&&P.DateEnd===I.DateEnd&&(L===void 0||L>P.Availability)&&(L=P.Availability)})}),{label:`${h.Name}`,title:`${h.Name} (${L} Available)`,value:h.AccommodationUUID}})}),w=ve(()=>{const C=K.value,h=p.value.find(L=>L.AccommodationUUID===A.value);return(h==null?void 0:h.Pool.map(L=>{var P,J;let I;return C.forEach(te=>{L.Costs.forEach(z=>{z.DateStart===(te==null?void 0:te.DateStart)&&z.DateEnd===te.DateEnd&&(I===void 0||I>z.Availability)&&(I=z.Availability)})}),{label:`${(P=L.Venue)==null?void 0:P.Name} - ${L.Name}`,title:`${(J=L.Venue)==null?void 0:J.Name} - ${L.Name} (${I} Available)`,value:L.RoomUUID,room:L}}))||[]}),K=ve(()=>[...v.value.Ticket,...v.value.AddonsChecked,...v.value.ComponentsChecked].map(C=>b.value.find(h=>h.TicketUUID===C)).filter(C=>C!==void 0&&C.RequiresAccommodation)),ie=C=>{var h;E.assignAccommodation(((h=u.value)==null?void 0:h.Registration.RegistrationUUID)||"",A.value,c.value,!1).then(L=>{L?(O(),C&&C("Room Assigned")):C&&C("Room not assigned")}).catch(()=>{C&&C("Room not assigned")})},fe=C=>{var h,L;(h=u.value)!=null&&h.Registration.AllocationUUID?E.deleteAllocation(((L=u.value)==null?void 0:L.Registration.AllocationUUID)||"").then(I=>{I?(O(),C&&C("Allocation Deleted")):C&&C("Allocation not deleted")}).catch(()=>{C&&C("Allocation not deleted")}):C&&C("Nothing to Delete")},Se=C=>{var L,I;const h=(L=p.value.find(P=>P.AccommodationUUID===C.AccommodationUUID))==null?void 0:L.Pool;if(h){const P=h.find(J=>J.RoomUUID===C.RoomUUID);if(P)return`${(I=P.Venue)==null?void 0:I.Name} - ${P.Name}`}return""};return O(),(C,h)=>{var L;return r(),G(Be,{modelValue:m.value,"onUpdate:modelValue":h[2]||(h[2]=I=>m.value=I),title:x(i),color:"primary","show-close-action":!0,"show-delete-action":!!((L=u.value)!=null&&L.Registration.Allocation),"show-save-action":!!c.value,"save-button-label":"Assign Room",onDelete:fe,onSave:ie},{default:o(()=>[t(Ce,{class:"pa-0",fluid:!0},{default:o(()=>[t(ee,null,{default:o(()=>{var I;return[t(F,{cols:"12",md:"6"},{default:o(()=>{var P,J;return[M("h3",null,"Group Members ("+k((P=u.value)==null?void 0:P.Members.length)+")",1),(r(!0),R(N,null,Z((J=u.value)==null?void 0:J.Members,te=>(r(),R(N,{key:te.UUID},[$(" #"+k(te.Reference)+" "+k(te.Name),1),Pa],64))),128))]}),_:1}),(I=u.value)!=null&&I.Registration.Allocation?(r(),G(F,{key:0,cols:"12",md:"6"},{default:o(()=>[wa,t(we,null,{default:o(()=>{var P;return[(r(!0),R(N,null,Z((P=u.value)==null?void 0:P.Registration.Allocation.Periods,J=>(r(),G(Ne,{key:J.AllocationPeriodUUID},{default:o(()=>{var te;return[$(k((te=p.value.find(z=>z.AccommodationUUID===J.AccommodationUUID))==null?void 0:te.Name)+" ",1),$a,$(" "+k(Se(J))+" ",1),Ba,M("small",null,"("+k(x(Fe)(J.DateStart))+" - "+k(x(Fe)(J.DateEnd))+")",1)]}),_:2},1024))),128))]}),_:1})]),_:1})):j("",!0)]}),_:1}),t(ee,null,{default:o(()=>[t(F,{cols:"12",md:"6"},{default:o(()=>[C.selectedAccommodation.length?(r(),R(N,{key:0},[Ga,t(we,null,{default:o(()=>[(r(!0),R(N,null,Z(C.selectedAccommodation,(I,P)=>(r(),G(Ne,{key:I.AccommodationUUID},{default:o(()=>[$(k(P+1)+". "+k(I.Name),1)]),_:2},1024))),128))]),_:1})],64)):j("",!0)]),_:1}),t(F,{cosl:"12",md:"6"},{default:o(()=>[Ya,t(we,null,{default:o(()=>[(r(!0),R(N,null,Z(K.value,I=>(r(),G(Ne,{key:I==null?void 0:I.TicketUUID},{default:o(()=>[$(k(I.Name)+" ",1),Ha,M("small",null,"("+k(x(Fe)(I.DateStart))+" - "+k(x(Fe)(I.DateEnd))+")",1)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1}),t(ee,null,{default:o(()=>[t(F,{cols:"12",md:"6"},{default:o(()=>[t(oe,{modelValue:A.value,"onUpdate:modelValue":h[0]||(h[0]=I=>A.value=I),items:g.value,"item-title":"title","item-value":"value",label:"Accommodation"},null,8,["modelValue","items"])]),_:1}),t(F,{cols:"12",md:"6"},{default:o(()=>[t(oe,{modelValue:c.value,"onUpdate:modelValue":h[1]||(h[1]=I=>c.value=I),items:w.value,"item-title":"title","item-value":"value",label:"Room Pool",rules:[S.value.capacity.min,S.value.capacity.max]},null,8,["modelValue","items","rules"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue","title","show-delete-action","show-save-action"])}}}),ja={key:0,class:"accommodationList"},qa={key:0,class:"text-orange-darken-2"},Ka=le({__name:"DataTableItemAccommodation",props:{accommodations:{default:()=>[]},convention:{},registration:{},value:{default:""},venues:{}},setup(e){const f=_(!1),s=ve(()=>{if(!e.value)return[];const n=JSON.parse(e.value),l=e.accommodations.filter(i=>n.includes(i.AccommodationUUID)).sort((i,E)=>{const m=n.findIndex(p=>p===i.AccommodationUUID),S=n.findIndex(p=>p===E.AccommodationUUID);return m>S?1:-1});return _e(l)});return(n,l)=>(r(),R(N,null,[n.value?(r(),R("ol",ja,[(r(!0),R(N,null,Z(s.value,i=>(r(),R("li",{key:i.AccommodationUUID},[n.registration&&n.registration.Allocation&&n.registration.Allocation.Periods.find(E=>E.AccommodationUUID===i.AccommodationUUID)?(r(),R("strong",qa,k(i.Name),1)):(r(),R(N,{key:1},[$(k(i.Name),1)],64))]))),128))])):j("",!0),t(se,{onClick:l[0]||(l[0]=i=>f.value=!0),variant:"flat",color:"success"},{default:o(()=>[$("Assign Accommodation")]),_:1}),n.convention&&f.value?(r(),G(xa,{key:1,modelValue:f.value,"onUpdate:modelValue":l[1]||(l[1]=i=>f.value=i),title:"Accommodation Allocation",convention:n.convention,registration:n.registration,"selected-accommodation":s.value},null,8,["modelValue","convention","registration","selected-accommodation"])):j("",!0)],64))}});const za=Je(Ka,[["__scopeId","data-v-c426aacc"]]),Ja={key:0,class:"addonList"},Wa={key:0},Qa={key:0},Xa=le({__name:"DataTableItemExtras",props:{extras:{default:()=>[]},value:{default:""}},setup(e){const f=ve(()=>{if(!e.value)return;const s=JSON.parse(e.value),n=Object.keys(s),l=_e(e.extras);return l.forEach(i=>{i.Options=i.Options.filter(E=>n.includes(E.OptionUUID)?(E.Choices=E.Choices.filter(m=>m.TagUUID===s[E.OptionUUID].choiceId),s[E.OptionUUID].checked):!1)}),l.filter(i=>i.Options.length>0),l});return(s,n)=>s.value?(r(),R("ul",Ja,[(r(!0),R(N,null,Z(f.value,l=>(r(),R(N,{key:l.ExtraUUID},[l.Options.length?(r(),R("li",Wa,[M("strong",null,k(l.Name),1),M("ul",null,[(r(!0),R(N,null,Z(l.Options,i=>(r(),R("li",{key:i.OptionUUID},[$(k(i.Name)+" ",1),i.Choices.length==1?(r(),R("small",Qa,"("+k(i.Choices[0].Title)+")",1)):j("",!0)]))),128))])])):j("",!0)],64))),128))])):j("",!0)}});const Za=Je(Xa,[["__scopeId","data-v-55786e01"]]),eo={key:0},to=le({__name:"DataTableItemInterests",props:{interests:{default:()=>[]},value:{default:""}},setup(e){const f=ve(()=>{if(!e.value)return;const s=JSON.parse(e.value);return Object.entries(s).filter(([,n])=>n).map(([n,l])=>e.interests.find(i=>i.InterestUUID===n)).filter(n=>n!==void 0)});return(s,n)=>s.value?(r(),R("ul",eo,[(r(!0),R(N,null,Z(f.value,l=>(r(),R("li",{key:l.InterestUUID},k(l.Name),1))),128))])):j("",!0)}}),ao=M("br",null,null,-1),oo=M("small",null,"Options:",-1),no=M("br",null,null,-1),lo=M("small",null,"Addons:",-1),io=le({__name:"DataTableItemTicket",props:{tickets:{default:()=>[]},value:{default:""}},setup(e){const f=ve(()=>{if(!e.value)return;let s={Ticket:[],AddonsChecked:[],ComponentsChecked:[]};try{s=JSON.parse(e.value),"ticket"in s&&(s.Ticket=s.ticket),"addonsChecked"in s&&(s.AddonsChecked=s.addonsChecked),"componentsChecked"in s&&(s.ComponentsChecked=s.componentsChecked)}catch{}return s.Ticket.filter(n=>{const l=e.tickets.find(i=>i.TicketUUID===n);return!(!l||l.Type!==xt.TICKET_TYPE_TICKET)}).map(n=>{const l=e.tickets.find(E=>E.TicketUUID===n),i=_e(l);return i.TicketComponents=l.TicketComponents.filter(E=>s.ComponentsChecked.includes(E.TicketUUID)),i.AddonTickets=l.AddonTickets.filter(E=>s.AddonsChecked.includes(E.TicketUUID)),i})});return(s,n)=>s.value?(r(!0),R(N,{key:0},Z(f.value,l=>(r(),R("div",{key:l.TicketUUID},[M("strong",null,k(l.Name),1),l.TicketComponents.length>0?(r(),R(N,{key:0},[ao,oo,$("  "),(r(!0),R(N,null,Z(l.TicketComponents,i=>(r(),R(N,{key:i.TicketUUID},[M("small",null,k(i.Name),1),$("  ")],64))),128))],64)):j("",!0),l.AddonTickets.length>0?(r(),R(N,{key:1},[no,lo,$("  "),(r(!0),R(N,null,Z(l.AddonTickets,i=>(r(),R("small",{key:i.TicketUUID},[$("("),M("em",null,k(i.Name),1),$(")")]))),128))],64)):j("",!0)]))),128)):j("",!0)}}),so={key:0},uo={key:0},ro=M("strong",null,"Total:",-1),mo=le({__name:"RegListRow",props:{header:{},accommodations:{},convention:{},extras:{},item:{},interests:{},tickets:{},venues:{}},emits:["openActions","openPayments","reload"],setup(e,{emit:f}){const s=Ee(),n=_(),l=_(),i=_(),E=_(),m=_(!1),S=(a,u,A)=>{l.value=a,s.getRegistrationGroup(A.RegistrationUUID||"").then(c=>{i.value=c,n.value=u,E.value=A,m.value=!0})},p=a=>{f("openActions",a)},U=a=>{f("openPayments",a)};return(a,u)=>(r(),R(N,null,[a.header.type==="ACCOMMODATION"&&a.accommodations.length>0&&a.item.raw[a.header.key]?(r(),G(za,{key:0,value:a.item.raw[a.header.key].Data,accommodations:a.accommodations,convention:a.convention,venues:a.venues,registration:a.item.raw[a.header.key].Registration},null,8,["value","accommodations","convention","venues","registration"])):a.header.type==="EXTRAS"&&a.extras.length>0?(r(),G(Za,{key:1,value:a.item.raw[a.header.key],extras:a.extras},null,8,["value","extras"])):a.header.type==="INTERESTS"&&a.interests.length>0?(r(),G(to,{key:2,value:a.item.raw[a.header.key],interests:a.interests},null,8,["value","interests"])):a.header.type==="TICKET"&&a.tickets.length>0?(r(),G(io,{key:3,value:a.item.raw[a.header.key],tickets:a.tickets},null,8,["value","tickets"])):a.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_SUBMISSION_STATUS"||a.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_ACCOMMODATION_FORM"||a.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_DEALER_FORM"||a.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_BADGE_FORM"||a.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_REGISTRATION_FORM"?(r(!0),R(N,{key:4},Z(a.item.raw[a.header.key],A=>(r(),R("ul",{key:A.Heading},[M("li",null,[M("strong",null,k(A.Heading)+":",1),$(" "+k(x(St)(A.Submission.Status))+" ",1),t(se,{icon:"mdi:mdi-form-select",title:"Edit Submitted Data",variant:"flat",onClick:c=>S(A.Registration,A.Form,A.Submission)},null,8,["onClick"])])]))),128)):a.header.type==="LAYOUT_ITEM_SOURCE_USER.USER_DATA_SOURCE_AVATAR"?(r(),G(Da,{key:5,class:"rounded-circle",src:a.item.raw[a.header.key],height:"32",width:"32"},null,8,["src"])):a.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_REGISTRATION_ACTIONS"?(r(),R(N,{key:6},[t(se,{icon:"mdi:mdi-email-fast",variant:"flat",onClick:u[0]||(u[0]=A=>p(a.item.raw[a.header.key]))}),t(se,{icon:"mdi:mdi-cash-multiple",variant:"flat",onClick:u[1]||(u[1]=A=>U(a.item.raw[a.header.key]))})],64)):a.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_REGISTRATION_GROUP"?(r(),R(N,{key:7},[a.item.raw[a.header.key].length===1?(r(),R("em",so," Not in a group ")):(r(),R(N,{key:1},[M("ul",null,[(r(!0),R(N,null,Z(a.item.raw[a.header.key],A=>(r(),R("li",{key:A.UUID,class:"ml-0"},[$(" #"+k(A.Reference)+" : "+k(A.Name)+" ",1),A.IsLeader?(r(),R("strong",uo,"(Leader)")):j("",!0)]))),128))]),ro,$(" "+k(a.item.raw[a.header.key].length),1)],64))],64)):(r(),R(N,{key:8},[$(k(a.item.raw[a.header.key]),1)],64)),m.value&&E.value&&n.value?(r(),G(ga,{key:9,modelValue:m.value,"onUpdate:modelValue":u[4]||(u[4]=A=>m.value=A),scrollable:!0},{default:o(()=>[t(pt,{class:"bg-red-darken-4"},{default:o(()=>[t(Ra,null,{default:o(()=>[t(jt,{modelValue:n.value,"onUpdate:modelValue":u[2]||(u[2]=A=>n.value=A),admin:!0,convention:a.convention,data:E.value,editable:!0,"registration-group":i.value,onClose:u[3]||(u[3]=A=>{m.value=!1,f("reload")})},null,8,["modelValue","convention","data","registration-group"])]),_:1})]),_:1})]),_:1},8,["modelValue"])):j("",!0)],64))}});var co=["onActivate","onAddUndo","onBeforeAddUndo","onBeforeExecCommand","onBeforeGetContent","onBeforeRenderUI","onBeforeSetContent","onBeforePaste","onBlur","onChange","onClearUndos","onClick","onContextMenu","onCopy","onCut","onDblclick","onDeactivate","onDirty","onDrag","onDragDrop","onDragEnd","onDragGesture","onDragOver","onDrop","onExecCommand","onFocus","onFocusIn","onFocusOut","onGetContent","onHide","onInit","onKeyDown","onKeyPress","onKeyUp","onLoadContent","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp","onNodeChange","onObjectResizeStart","onObjectResized","onObjectSelected","onPaste","onPostProcess","onPostRender","onPreProcess","onProgressState","onRedo","onRemove","onReset","onSaveContent","onSelectionChange","onSetAttrib","onSetContent","onShow","onSubmit","onUndo","onVisualAid"],vo=function(e){return co.map(function(f){return f.toLowerCase()}).indexOf(e.toLowerCase())!==-1},_o=function(e,f,s){Object.keys(f).filter(vo).forEach(function(n){var l=f[n];typeof l=="function"&&(n==="onInit"?l(e,s):s.on(n.substring(2),function(i){return l(i,s)}))})},Ao=function(e,f,s,n){var l=e.modelEvents?e.modelEvents:null,i=Array.isArray(l)?l.join(" "):l;ne(n,function(E,m){s&&typeof E=="string"&&E!==m&&E!==s.getContent({format:e.outputFormat})&&s.setContent(E)}),s.on(i||"change input undo redo",function(){f.emit("update:modelValue",s.getContent({format:e.outputFormat}))})},Uo=function(e,f,s,n,l,i){n.setContent(i()),s.attrs["onUpdate:modelValue"]&&Ao(f,s,n,l),_o(e,s.attrs,n)},dt=0,It=function(e){var f=Date.now(),s=Math.floor(Math.random()*1e9);return dt++,e+"_"+s+dt+String(f)},To=function(e){return e!==null&&e.tagName.toLowerCase()==="textarea"},mt=function(e){return typeof e>"u"||e===""?[]:Array.isArray(e)?e:e.split(" ")},Eo=function(e,f){return mt(e).concat(mt(f))},fo=function(e){return e==null},ct=function(){return{listeners:[],scriptId:It("tiny-script"),scriptLoaded:!1}},So=function(){var e=ct(),f=function(l,i,E,m){var S=i.createElement("script");S.referrerPolicy="origin",S.type="application/javascript",S.id=l,S.src=E;var p=function(){S.removeEventListener("load",p),m()};S.addEventListener("load",p),i.head&&i.head.appendChild(S)},s=function(l,i,E){e.scriptLoaded?E():(e.listeners.push(E),l.getElementById(e.scriptId)||f(e.scriptId,l,i,function(){e.listeners.forEach(function(m){return m()}),e.scriptLoaded=!0}))},n=function(){e=ct()};return{load:s,reinitialize:n}},po=So(),Do=function(){return typeof window<"u"?window:global},Oe=function(){var e=Do();return e&&e.tinymce?e.tinymce:null},Ro={apiKey:String,cloudChannel:String,id:String,init:Object,initialValue:String,inline:Boolean,modelEvents:[String,Array],plugins:[String,Array],tagName:String,toolbar:[String,Array],modelValue:String,disabled:Boolean,tinymceScriptSrc:String,outputFormat:{type:String,validator:function(e){return e==="html"||e==="text"}}},ce=globalThis&&globalThis.__assign||function(){return ce=Object.assign||function(e){for(var f,s=1,n=arguments.length;s<n;s++){f=arguments[s];for(var l in f)Object.prototype.hasOwnProperty.call(f,l)&&(e[l]=f[l])}return e},ce.apply(this,arguments)},Io=function(e,f,s,n){return e(n||"div",{id:f,ref:s})},go=function(e,f,s){return e("textarea",{id:f,visibility:"hidden",ref:s})},qe={selector:void 0,target:void 0},yo=le({props:Ro,setup:function(e,f){var s=e.init?ce(ce({},e.init),qe):ce({},qe),n=Lt(e),l=n.disabled,i=n.modelValue,E=n.tagName,m=_(null),S=null,p=e.id||It("tiny-vue"),U=e.init&&e.init.inline||e.inline,a=!!f.attrs["onUpdate:modelValue"],u=!0,A=e.initialValue?e.initialValue:"",c="",b=function(g){return a?function(){return i!=null&&i.value?i.value:""}:function(){return g?A:c}},v=function(){var g=b(u),w=ce(ce({},s),{readonly:e.disabled,target:m.value,plugins:Eo(s.plugins,e.plugins),toolbar:e.toolbar||s.toolbar,inline:U,setup:function(K){S=K,K.on("init",function(ie){return Uo(ie,e,f,K,i,g)}),typeof s.setup=="function"&&s.setup(K)}});To(m.value)&&(m.value.style.visibility=""),Oe().init(w),u=!1};ne(l,function(g){var w;S!==null&&(typeof((w=S.mode)===null||w===void 0?void 0:w.set)=="function"?S.mode.set(g?"readonly":"design"):S.setMode(g?"readonly":"design"))}),ne(E,function(g){var w;a||(c=S.getContent()),(w=Oe())===null||w===void 0||w.remove(S),at(function(){return v()})}),kt(function(){if(Oe()!==null)v();else if(m.value&&m.value.ownerDocument){var g=e.cloudChannel?e.cloudChannel:"6",w=e.apiKey?e.apiKey:"no-api-key",K=fo(e.tinymceScriptSrc)?"https://cdn.tiny.cloud/1/".concat(w,"/tinymce/").concat(g,"/tinymce.min.js"):e.tinymceScriptSrc;po.load(m.value.ownerDocument,K,v)}}),Ft(function(){Oe()!==null&&Oe().remove(S)}),U||(Pt(function(){u||v()}),wt(function(){var g;a||(c=S.getContent()),(g=Oe())===null||g===void 0||g.remove(S)}));var O=function(g){var w;c=S.getContent(),(w=Oe())===null||w===void 0||w.remove(S),s=ce(ce(ce({},s),g),qe),at(function(){return v()})};return f.expose({rerender:O,getEditor:function(){return S}}),function(){return U?Io(ot,p,m,e.tagName):go(ot,p,m)}}});const Oo=["colspan"],Co=M("strong",null,"E-Mail Content",-1),ho=["innerHTML"],gt=le({__name:"Communications",props:{hideHistory:{type:Boolean,default:!1},registration:{},showEditor:{type:Boolean}},emits:["close-editor"],setup(e,{emit:f}){const s=Ee(),n=_([]),l=_({From:"",Subject:"",HTML:""}),i=_(""),E=_(""),m=_(""),S=_(!1),p=_([]),U=_([]),a=_([{key:"CreatedAt",title:"Date"},{key:"Subject",title:"Subject"},{key:"User.DisplayName",title:"Sender"},{key:"Status",title:"Status"}]);ne(l,b=>{m.value=b.From||m.value||"",E.value=b.Subject||E.value||"",i.value=b.HTML||i.value||""});const u=()=>{s.getRegistrationEmails(e.registration.RegistrationUUID).then(b=>{b&&(b.forEach(v=>{v.CreatedAt=Ea(new Date(v.CreatedAt||"")),v.Status=Na(v.Status),v.User||(v.User={ID:0,UserUUID:"",DisplayName:"System",Handle:"",Credentials:[],Additional:{FirstName:"",LastName:"",DOB:"",Email:""},Data:"",Groups:[],Tags:[]})}),U.value=b)})};u(),(()=>{s.getRegistrationEmailTemplates(e.registration.RegistrationUUID).then(b=>{b&&(n.value=b)})})();const c=({callback:b})=>{s.sendRegistrationEmail(e.registration.RegistrationUUID,m.value,E.value,i.value).then(v=>{v?b&&(b("Email Sent"),u(),setTimeout(()=>{S.value=!1},2e3)):b&&b("Not sent")}).catch(()=>{b&&b("Not sent")})};return(b,v)=>(r(),R(N,null,[b.showEditor?(r(),R(N,{key:0},[t(ee,null,{default:o(()=>[t(F,null,{default:o(()=>[t(oe,{items:n.value,"item-title":"Subject","return-object":"",label:"Template","hide-details":"",modelValue:l.value,"onUpdate:modelValue":v[0]||(v[0]=O=>l.value=O),variant:"outlined"},null,8,["items","modelValue"])]),_:1})]),_:1}),t(ee,null,{default:o(()=>[t(F,{cols:"12"},{default:o(()=>[t(Ue,{modelValue:m.value,"onUpdate:modelValue":v[1]||(v[1]=O=>m.value=O),label:"From",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),t(F,{cols:"12"},{default:o(()=>[t(Ue,{modelValue:E.value,"onUpdate:modelValue":v[2]||(v[2]=O=>E.value=O),label:"Subject",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),t(F,{cols:"12"},{default:o(()=>[t(x(yo),{modelValue:i.value,"onUpdate:modelValue":v[3]||(v[3]=O=>i.value=O),"api-key":"g9sce3fktcgvk0i7sp96cahgyk4cos7q27es3ubnlal3xf3z"},null,8,["modelValue"])]),_:1})]),_:1}),t(ee,null,{default:o(()=>[t(F,null,{default:o(()=>[t(ze,{onClick:v[4]||(v[4]=O=>f("close-editor")),label:"Close E-mail Editor",color:"secondary","prepend-icon":"mdi:mdi-window-close"})]),_:1}),t(F,{class:"text-right"},{default:o(()=>[t(ze,{onClick:c,label:"Send",color:"error"})]),_:1})]),_:1})],64)):j("",!0),U.value.length&&!b.hideHistory?(r(),G(Tt,{key:1,class:"my-2"},{default:o(()=>[t(Ut,null,{default:o(()=>[t(vt,null,{default:o(()=>[$(" Email History ")]),_:1}),t(_t,null,{default:o(()=>[t(x(At),{items:U.value,headers:a.value,"show-expand":!0,"item-value":"EmailUUID",expanded:p.value,"onUpdate:expanded":v[5]||(v[5]=O=>p.value=O)},{"expanded-row":o(({columns:O,item:g})=>[M("tr",null,[M("td",{colspan:O.length},[Co,M("div",{innerHTML:g.raw.HTML},null,8,ho)],8,Oo)])]),"footer.prepend":o(()=>[t(se,{"prepend-icon":"mdi:mdi-refresh",color:"primary",class:"mr-4",onClick:u},{default:o(()=>[$("Refresh")]),_:1})]),_:1},8,["items","headers","expanded"])]),_:1})]),_:1})]),_:1})):j("",!0)],64))}});const Mo=["colspan"],Vo=M("strong",null,"Details",-1),bo=["innerHTML"],No=le({__name:"PaymentTransactions",props:{hideHistory:{type:Boolean},updated:{},registration:{},showEditor:{type:Boolean}},emits:["close-editor","change"],setup(e,{emit:f}){const s=e;let{hideHistory:n=!1,registration:l,showEditor:i}=s;const E=Ee(),m=_([]),S=_([]),p=_([{key:"CreatedAt",title:"Date"},{key:"Type",title:"Type"},{key:"Source",title:"Source"},{key:"Description",title:"Description"},{key:"Admin",title:"Admin"},{key:"Amount",title:"Amount"}]),U=()=>({PaymentTransactionUUID:he(),Amount:0,Data:{},Description:"",ID:0,RegistrationID:l.ID,RegistrationUUID:l.RegistrationUUID,Source:pa.PAYMENT_TRANSACTION_SOURCE_NULL,Type:Et.PAYMENT_TRANSACTION_TYPE_NULL}),a=_(U()),{convertTransactions:u,getPaymentTransactionsDisplay:A}=ft();ne(s,()=>{n=s.hideHistory,l=s.registration,i=s.showEditor,A(l.RegistrationUUID).then(v=>{S.value=v})});const c=()=>{A(l.RegistrationUUID).then(v=>{S.value=v})};c();const b=()=>{E.saveRegistrationPaymentTransaction(a.value).then(v=>{v&&(u(v.PaymentTransactions),a.value=U(),f("close-editor"),f("change"))})};return(v,O)=>(r(),R(N,null,[x(i)?(r(),R(N,{key:0},[t(Ia,null,{default:o(()=>[$(" Add Transaction ")]),_:1}),t(ee,null,{default:o(()=>[t(F,{cols:"12",sm:"6"},{default:o(()=>[t(oe,{items:x(fa),"item-title":"title","item-value":"value",label:"Transaction Type",clearable:!0,"hide-details":"",modelValue:a.value.Type,"onUpdate:modelValue":O[0]||(O[0]=g=>a.value.Type=g),variant:"outlined"},null,8,["items","modelValue"])]),_:1}),t(F,{cols:"12",sm:"6"},{default:o(()=>[t(oe,{items:x(Sa),"item-title":"title","item-value":"value",label:"Source",clearable:!0,"hide-details":"",modelValue:a.value.Source,"onUpdate:modelValue":O[1]||(O[1]=g=>a.value.Source=g),variant:"outlined"},null,8,["items","modelValue"])]),_:1})]),_:1}),t(ee,null,{default:o(()=>[t(F,{cols:"12",sm:"8",md:"10"},{default:o(()=>[t(Ue,{label:"Description","hide-details":"",modelValue:a.value.Description,"onUpdate:modelValue":O[2]||(O[2]=g=>a.value.Description=g),variant:"outlined"},null,8,["modelValue"])]),_:1}),t(F,{cols:"12",sm:"4",md:"2"},{default:o(()=>[t(Ue,{label:"Amount","prepend-inner-icon":"mdi:mdi-currency-gbp","hide-details":"",modelValue:a.value.Amount,"onUpdate:modelValue":O[3]||(O[3]=g=>a.value.Amount=g),modelModifiers:{number:!0},variant:"outlined"},null,8,["modelValue"])]),_:1})]),_:1}),t(ee,null,{default:o(()=>[t(F,{cols:"12",sm:"3",md:"2",lg:"1"},{default:o(()=>[t(se,{class:"w-100",onClick:O[4]||(O[4]=g=>f("close-editor")),color:"warning"},{default:o(()=>[$("Cancel")]),_:1})]),_:1}),t(Dt),t(F,{cols:"12",sm:"6",md:"3",lg:"2",xl:"2"},{default:o(()=>[t(se,{class:"w-100",onClick:b,color:"primary"},{default:o(()=>[$("Submit Transaction")]),_:1})]),_:1})]),_:1})],64)):j("",!0),S.value.length&&!x(n)?(r(),G(Tt,{key:1,class:"my-2"},{default:o(()=>[t(Ut,null,{default:o(()=>[t(vt,null,{default:o(()=>[$(" Transaction History ")]),_:1}),t(_t,null,{default:o(()=>[t(x(At),{items:S.value,headers:p.value,"show-expand":!1,"item-value":"PaymentTransactionUUID",expanded:m.value,"onUpdate:expanded":O[5]||(O[5]=g=>m.value=g)},{"expanded-row":o(({columns:g,item:w})=>[M("tr",null,[M("td",{colspan:g.length},[Vo,M("div",{innerHTML:w.raw.HTML},null,8,bo)],8,Mo)])]),"footer.prepend":o(()=>[t(se,{"prepend-icon":"mdi:mdi-refresh",color:"primary",class:"mr-4",onClick:c},{default:o(()=>[$("Refresh")]),_:1})]),_:1},8,["items","headers","expanded"])]),_:1})]),_:1})]),_:1})):j("",!0)],64))}});const Ge=e=>($t("data-v-76d30f00"),e=e(),Bt(),e),Lo={class:"v-row"},ko={key:0,class:"v-col v-col-10 py-1 v-row mx-0 pl-0"},Fo={class:"v-col v-col-12 v-col-sm-4 v-col-md-3 font-weight-bold pb-0 pr-0"},Po={class:"v-col v-col-12 v-col-sm-8 v-col-md-9 font-italic pt-0 pt-sm-3 pb-sm-0 pl-sm-0"},wo={class:"v-col v-col-2 align-self-end text-right py-1 text-no-wrap"},$o=Ge(()=>M("dt",{class:"v-col v-col-9 py-1 font-weight-bold totals"}," Total Charges ",-1)),Bo={class:"v-col v-col-3 align-self-end text-right py-1 totals text-no-wrap"},Go=Ge(()=>M("dt",{class:"v-col v-col-9 py-1 font-weight-bold"}," Applied Total ",-1)),Yo={class:"v-col v-col-3 align-self-end text-right py-1 text-no-wrap"},Ho=Ge(()=>M("dt",{class:"v-col v-col-9 py-1 font-weight-bold"}," Currently Paid ",-1)),xo={class:"v-col v-col-3 align-self-end text-right py-1 text-no-wrap"},jo=Ge(()=>M("dt",{class:"v-col v-col-9 py-1 font-weight-bold totals"}," Balance ",-1)),qo={class:"v-col v-col-3 align-self-end text-right py-1 totals text-no-wrap"},Ko=le({__name:"PaymentActions",props:Te({forms:{},registration:{},title:{}},{modelValue:{type:Boolean,required:!0}}),emits:Te(["update:registration"],["update:modelValue"]),setup(e,{emit:f}){const s=e,n=$e(e,"modelValue"),{registration:l}=s,i=_(!1),E=_(!1),m=_(),S=_([]),p=_(new Date().getTime()),U=We(s,f,void 0,void 0,"registration"),a=_(_e(U.value));ne(U,()=>{a.value=_e(U.value)});const u=Ee(),A=()=>{u.generateRegistrationCharges(l.RegistrationUUID,!1).then(v=>{v&&(S.value=v.PaymentTransactions,m.value=v.Registration,p.value=new Date().getTime())}).catch(()=>{})};A();const c=()=>{u.generateRegistrationCharges(l.RegistrationUUID,!0).then(v=>{v&&(S.value=v.PaymentTransactions,m.value=v.Registration,p.value=new Date().getTime())})},{totalCharges:b}=ft();return(v,O)=>(r(),G(Be,{modelValue:n.value,"onUpdate:modelValue":O[3]||(O[3]=g=>n.value=g),title:v.title,"show-close-action":!0,color:"primary","close-action-label":"Close",persistent:!0,"retain-focus":!1,scrollable:!0,fullscreen:""},{default:o(()=>[t(Ce,{class:"px-0 mx-0",fluid:!0},{default:o(()=>[m.value?(r(),R(N,{key:0},[M("dl",Lo,[(r(!0),R(N,null,Z(S.value,g=>(r(),R(N,{key:g.PaymentTransactionUUID},[g.Type===x(Et).PAYMENT_TRANSACTION_TYPE_CHARGE?(r(),R("dt",ko,[M("div",Fo,k(g.Description.split(":")[0])+": ",1),M("div",Po,k(g.Description.split(":")[1]),1)])):j("",!0),M("dd",wo," £"+k(g.Amount),1)],64))),128)),$o,M("dd",Bo," £"+k(x(b)(S.value)),1),Go,M("dd",Yo," £"+k(m.value.Total),1),Ho,M("dd",xo," £"+k(m.value.Paid),1),jo,M("dd",qo," £"+k(m.value.Total-m.value.Paid),1)]),t(ee,{class:"flex-row-reverse"},{default:o(()=>[t(F,{class:"text-right"},{default:o(()=>[t(se,{color:"primary",onClick:c},{default:o(()=>[$("Apply Charges")]),_:1})]),_:1}),E.value?j("",!0):(r(),G(F,{key:0},{default:o(()=>[t(se,{color:"secondary",onClick:O[0]||(O[0]=g=>E.value=!0)},{default:o(()=>[$("Transaction Entry")]),_:1})]),_:1}))]),_:1})],64)):j("",!0),t(No,{registration:x(l),"show-editor":E.value,onCloseEditor:O[1]||(O[1]=g=>E.value=!1),updated:p.value,onChange:A},null,8,["registration","show-editor","updated"]),t(gt,{registration:x(l),"show-editor":i.value,onCloseEditor:O[2]||(O[2]=g=>i.value=!1)},null,8,["registration","show-editor"])]),_:1})]),_:1},8,["modelValue","title"]))}});const zo=Je(Ko,[["__scopeId","data-v-76d30f00"]]),Jo=le({__name:"RegistrationActions",props:Te({forms:{},registration:{},title:{}},{modelValue:{type:Boolean,required:!0}}),emits:Te(["update:registration"],["update:modelValue"]),setup(e,{emit:f}){const s=e,n=$e(e,"modelValue"),l=_(!1),i=We(s,f,void 0,void 0,"registration"),E=_(_e(i.value));ne(i,()=>{E.value=_e(i.value)});const m=Ee(),S=(p,U)=>{const a=E.value.Submissions.find(u=>u.SubmissionUUID==U);if(!a){p&&p("Submission not found");return}m.setSubmissionStatus(U,a.Status).then(u=>{u?(E.value.Submissions.forEach((A,c)=>{i.value.Submissions[c].Status=A.Status}),p&&p("Status Saved")):p&&p("Status not saved")}).catch(()=>{p&&p("Status not saved")})};return(p,U)=>(r(),G(Be,{modelValue:n.value,"onUpdate:modelValue":U[2]||(U[2]=a=>n.value=a),title:p.title,"show-close-action":!0,color:"primary","close-action-label":"Close",persistent:!0,"retain-focus":!1,scrollable:!0},{default:o(()=>[t(Ce,{class:"px-0 mx-0",fluid:!0},{default:o(()=>[t(we,null,{default:o(()=>[(r(!0),R(N,null,Z(E.value.Submissions,a=>(r(),G(Ne,{key:a.SubmissionUUID,class:"pa-0"},{default:o(()=>[t(ee,{class:"py-2 align-center"},{default:o(()=>[t(F,{cols:"8"},{default:o(()=>{var u;return[t(oe,{modelValue:a.Status,"onUpdate:modelValue":A=>a.Status=A,items:x(ut),"item-text":"title","item-value":"value",variant:"outlined","hide-details":"",label:((u=p.forms.find(A=>A.FormUUID==a.FormUUID))==null?void 0:u.Name)||""},{selection:o(()=>[t(Ua,{class:"mr-4"},{default:o(()=>{var A;return[$(k((A=x(ut).find(c=>c.value===a.Status))==null?void 0:A.icon),1)]}),_:2},1024),$(" "+k(x(St)(a.Status)),1)]),item:o(({item:A,props:{onClick:c}})=>[t(Ne,{title:A.title,"prepend-icon":A.raw.icon,onClick:c},null,8,["title","prepend-icon","onClick"])]),_:2},1032,["modelValue","onUpdate:modelValue","items","label"])]}),_:2},1024),t(F,{cols:"4"},{default:o(()=>[t(ze,{title:"Save","prepend-icon":"mdi:mdi-content-save",color:"warning",onClick:u=>S(u.callback,a.SubmissionUUID)},null,8,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1}),t(ee,null,{default:o(()=>[t(F,{cols:"12"},{default:o(()=>[t(se,{"prepend-icon":"mdi:mdi-email",color:"primary",onClick:U[0]||(U[0]=a=>l.value=!0)},{default:o(()=>[$("Prepare Email")]),_:1})]),_:1})]),_:1}),t(gt,{registration:p.registration,"show-editor":l.value,onCloseEditor:U[1]||(U[1]=a=>l.value=!1)},null,8,["registration","show-editor"])]),_:1})]),_:1},8,["modelValue","title"]))}});const Mn=le({__name:"RegistrationsView",emits:["pageTitle"],setup(e,{emit:f}){var Qe;const s=ya();f("pageTitle","Registration Manager");const n=Gt(),l=Yt(),i=_(!0);let E=((Qe=n.params.convention)==null?void 0:Qe.toString())||"";const m=_({ID:0,ConventionUUID:he(),OrganisationID:0,OrganisationUUID:je,Name:"New Convention",Description:"",DetailLink:"",Logo:"",Slug:"",Accommodation:[],Tickets:[],Extras:[],Interests:[],Visible:!1}),S=Ee(),p=_({ID:0,AdminLayoutUUID:he(),ConventionID:m.value.ID,ConventionUUID:m.value.ConventionUUID,Name:"Registration Table",Type:Rt.ADMIN_LAYOUT_TABLE,Panels:[]}),U=_([]),a=_([]),u=_([]),A=_([]),c=_([]),b=_(1),v=_(10),O=_([]),g=_(0),w=_(!1),K=_(""),ie=_(""),fe=_(""),Se=_(""),C=_(""),h=_(""),L=_([]),I=_([]),P=_([]),J=_([]),te=_([]),z=_([]),de=_(0),ue=_(),pe=_(!1),De=_(!1);ne(de,d=>{d===7&&Ve()}),ne(C,()=>{ie.value=Date.now().toString()}),ne(h,()=>{ie.value=Date.now().toString()});const Re=()=>{U.value=[],u.value=[],c.value=[];try{S.getConventionAdminLayoutByName(m.value.ConventionUUID,"Registration Table").then(d=>{de.value+=1,d?p.value=d:(p.value.ConventionID=m.value.ID,p.value.ConventionUUID=m.value.ConventionUUID)})}catch{p.value.ConventionID=m.value.ID,p.value.ConventionUUID=m.value.ConventionUUID}try{S.getConventionForms(m.value.ConventionUUID).then(d=>{de.value+=1,d&&(U.value=d)})}catch{}try{S.getConventionAccommodation(m.value.ConventionUUID).then(d=>{de.value+=1,d&&(I.value=d)})}catch{}try{S.getConventionVenues(m.value.ConventionUUID).then(d=>{de.value+=1,d&&(z.value=d)})}catch{}try{S.getConventionExtras(m.value.ConventionUUID).then(d=>{de.value+=1,d&&(P.value=d)})}catch{}try{S.getConventionInterests(m.value.ConventionUUID).then(d=>{de.value+=1,d&&(J.value=d)})}catch{}try{S.getConventionTickets(m.value.ConventionUUID).then(d=>{de.value+=1,d&&(te.value=d)})}catch{}try{S.getConventionGroups(m.value.ConventionUUID).then(d=>{d&&(a.value=d.sort((T,D)=>T.Name.localeCompare(D.Name)))})}catch{}try{S.getConventionTags(m.value.ConventionUUID).then(d=>{d&&(A.value=d.sort((T,D)=>T.Title.localeCompare(D.Title)).map(T=>(T.Title=`${T.Title} [${T.Key}]`,T)))})}catch{}},Me=({page:d,itemsPerPage:T,sortBy:D})=>{i.value=!0,b.value=d,O.value=D;const y=c.value.find(W=>W.uuid==K.value),me=y==null?void 0:y.layout.Items;let ae="",Xe="";if(D&&me&&D.length>=1){const W=me.find(be=>be.LayoutItemUUID==D[0].key);switch(Xe=D[0].order,W==null?void 0:W.MetaField){case q.META_DATA_SOURCE_ACCOMMODATION_FORM:ae="submission.status";break;case q.META_DATA_SOURCE_BADGE_FORM:ae="submission.status";break;case q.META_DATA_SOURCE_DEALER_FORM:ae="submission.status";break;case q.META_DATA_SOURCE_REGISTRATION_FORM:ae="submission.status";break;case q.META_DATA_SOURCE_REGISTRATION_REFERENCE:ae="reference";break;case q.META_DATA_SOURCE_SUBMISSION_DATE:ae="created";break;case q.META_DATA_SOURCE_SUBMISSION_STATUS:ae="submission.status";break}switch(W==null?void 0:W.UserField){case X.USER_DATA_SOURCE_DISPLAY_NAME:ae="user.display_name";break;case X.USER_DATA_SOURCE_EMAIL:ae="user.email";break;case X.USER_DATA_SOURCE_FIRST_NAME:ae="user.firstname";break;case X.USER_DATA_SOURCE_HANDLE:ae="user.handle";break;case X.USER_DATA_SOURCE_LAST_NAME:ae="user.lastname";break}}try{const W={Direction:Xe,Limit:T,Offset:(d-1)*T,Order:ae};y&&y.layout.RequiredRegistrationTags.length>0&&(W.PanelUUID=y==null?void 0:y.layout.LayoutPanelUUID),(y==null?void 0:y.layout.RequiredFormType)===Ae.FORM_TYPE_ACCOMMODATION&&(W.Accommodation=!0),(y==null?void 0:y.layout.RequiredFormType)===Ae.FORM_TYPE_BADGE&&(W.Badge=!0),(y==null?void 0:y.layout.RequiredFormType)===Ae.FORM_TYPE_DEALER&&(W.Dealer=!0),(y==null?void 0:y.layout.RequiredFormType)===Ae.FORM_TYPE_REGISTRATION&&(W.Registration=!0),W.GroupUUID=C.value||je,W.TagUUID=h.value||je,W.Email=Se.value,W.Reference=fe.value,S.searchConventionRegistrations(m.value.ConventionUUID,W).then(be=>{be&&(g.value=be.Total,u.value=be.Registrations,c.value.forEach(Ye=>{const ht=Ye.layout;Ye.items=u.value.map(Y=>{const Q={};return Ye.headers.forEach(Ze=>{var et;const B=ht.Items.find(Ie=>Ie.LayoutItemUUID===Ze.key);if(B){if(B.SourceType==="LAYOUT_ITEM_SOURCE_FORM"&&B.SectionField)Y.Submissions.forEach(Ie=>{const re=Ie.Data.find(He=>He.SectionFieldUUID===B.SectionFieldUUID);if(re){Ze.type===qt.ACCOMMODATION?Q[B.LayoutItemUUID]={Data:re.Data,Registration:Y}:Q[B.LayoutItemUUID]=re.Data;return}});else if(B.SourceType==="LAYOUT_ITEM_SOURCE_USER"&&B.UserField)switch(B.UserField){case X.USER_DATA_SOURCE_AVATAR:Q[B.LayoutItemUUID]=s.GetProfileImageURL(Y.UserUUID);break;case X.USER_DATA_SOURCE_DISPLAY_NAME:Q[B.LayoutItemUUID]=Y.User.DisplayName;break;case X.USER_DATA_SOURCE_EMAIL:Q[B.LayoutItemUUID]=Y.User.Additional.Email;break;case X.USER_DATA_SOURCE_HANDLE:Q[B.LayoutItemUUID]=Y.User.Handle;break;case X.USER_DATA_SOURCE_DATE_OF_BIRTH:Q[B.LayoutItemUUID]=Y.User.Additional.DOB;break;case X.USER_DATA_SOURCE_FIRST_NAME:Q[B.LayoutItemUUID]=Y.User.Additional.FirstName;break;case X.USER_DATA_SOURCE_LAST_NAME:Q[B.LayoutItemUUID]=Y.User.Additional.LastName;break;case X.USER_DATA_SOURCE_TELEGRAM:Q[B.LayoutItemUUID]="";break}else if(B.SourceType==="LAYOUT_ITEM_SOURCE_META"&&B.MetaField){const Ie=[];let re;const He=(et=U.value.find(V=>V.Type===Ae.FORM_TYPE_REGISTRATION))==null?void 0:et.FormUUID,tt=Y.Submissions.find(V=>V.FormUUID===He);switch(B.MetaField){case q.META_DATA_SOURCE_REGISTRATION_ACTIONS:Q[B.LayoutItemUUID]=Y;break;case q.META_DATA_SOURCE_REGISTRATION_GROUP:Y.Leader?re=Y:re=Y.Primary,Ie.push({Name:re.User.DisplayName,UUID:re.UserUUID,UserUUID:re.User.UserUUID,IsLeader:!0,Reference:re.Reference}),Ie.push(...re.Members.map(V=>({Name:V.User.DisplayName,UUID:V.UserUUID,UserUUID:V.User.UserUUID,IsLeader:!1,Reference:V.Reference}))),Q[B.LayoutItemUUID]=Ie;break;case q.META_DATA_SOURCE_REGISTRATION_REFERENCE:Q[B.LayoutItemUUID]=Y.Reference;break;case q.META_DATA_SOURCE_SUBMISSION_DATE:if(tt){const V=new Date(tt.CreatedAt||"");Q[B.LayoutItemUUID]=`${V.getFullYear()}-${(V.getMonth()+1).toString().padStart(2,"0")}-${V.getDate().toString().padStart(2,"0")} ${V.getHours().toString().padStart(2,"0")}:${V.getMinutes().toString().padStart(2,"0")}:${V.getSeconds().toString().padStart(2,"0")}`}else{const V=new Date(Y.CreatedAt||"");Q[B.LayoutItemUUID]=`${V.getFullYear()}-${(V.getMonth()+1).toString().padStart(2,"0")}-${V.getDate().toString().padStart(2,"0")} ${V.getHours().toString().padStart(2,"0")}:${V.getMinutes().toString().padStart(2,"0")}:${V.getSeconds().toString().padStart(2,"0")}`}break;case q.META_DATA_SOURCE_ACCOMMODATION_FORM:Pe(Y.Submissions,U.value),Q[B.LayoutItemUUID]=Y.Submissions.map(V=>{const H=U.value.find(ge=>ge.FormUUID===V.FormUUID);return{Heading:H==null?void 0:H.Heading,Form:H,Submission:V,Registration:Y}}).filter(V=>{var H;return((H=V.Form)==null?void 0:H.Type)===Ae.FORM_TYPE_ACCOMMODATION});break;case q.META_DATA_SOURCE_BADGE_FORM:Pe(Y.Submissions,U.value),Q[B.LayoutItemUUID]=Y.Submissions.map(V=>{const H=U.value.find(ge=>ge.FormUUID===V.FormUUID);return{Heading:H==null?void 0:H.Heading,Form:H,Submission:V,Registration:Y}}).filter(V=>{var H;return((H=V.Form)==null?void 0:H.Type)===Ae.FORM_TYPE_BADGE});break;case q.META_DATA_SOURCE_DEALER_FORM:Pe(Y.Submissions,U.value),Q[B.LayoutItemUUID]=Y.Submissions.map(V=>{const H=U.value.find(ge=>ge.FormUUID===V.FormUUID);return{Heading:H==null?void 0:H.Heading,Form:H,Submission:V,Registration:Y}}).filter(V=>{var H;return((H=V.Form)==null?void 0:H.Type)===Ae.FORM_TYPE_DEALER});break;case q.META_DATA_SOURCE_SUBMISSION_STATUS:Pe(Y.Submissions,U.value),Q[B.LayoutItemUUID]=Y.Submissions.map(V=>{const H=U.value.find(ge=>ge.FormUUID===V.FormUUID);return{Heading:H==null?void 0:H.Heading,Form:H,Submission:V,Registration:Y}});break}}}}),Q})}),i.value=!1)})}catch{}},Ve=()=>{p.value.Panels.forEach(d=>{d.Items.forEach(T=>{(T.SectionField==null||T.SectionField.Field==null)&&U.value.find(D=>{D.Sections.find(y=>{if(y.Fields){const me=y.Fields.find(ae=>ae.SectionFieldUUID===T.SectionFieldUUID);if(me)return T.SectionField=me,!0}})})})}),p.value.Panels.length>0&&(c.value=[],p.value.Panels.forEach(d=>{const T={uuid:he(),order:d.Order,name:d.Name,headers:[],items:[],layout:d};d.Items.sort((D,y)=>D.Order>y.Order?1:D.Order==y.Order?0:-1),T.headers=d.Items.map(D=>{var y,me;return D.DefaultSort&&L.value.push({key:D.LayoutItemUUID,order:"asc"}),{key:D.LayoutItemUUID,title:D.Label||((me=(y=D.SectionField)==null?void 0:y.Field)==null?void 0:me.Label)||"",align:D.Align==="end"?"end":"start",sortable:yt(D),type:ke(D)}}),c.value.push(T)}),c.value=c.value.sort((d,T)=>d.order>T.order?1:d.order==T.order?0:-1)),(K.value==null||K.value=="")&&c.value.length>0&&(K.value=c.value[0].uuid)};E?S.getConvention(E).then(d=>{d&&(m.value=d,Re())}).catch(()=>{l.push("/")}):l.push("/");const ke=d=>{var T,D;if(d.SourceType===Le.LAYOUT_ITEM_SOURCE_META)return`${d.SourceType}.${d.MetaField}`;if(d.SourceType===Le.LAYOUT_ITEM_SOURCE_FORM)return(D=(T=d.SectionField)==null?void 0:T.Field)==null?void 0:D.Type;if(d.SourceType===Le.LAYOUT_ITEM_SOURCE_USER)return`${d.SourceType}.${d.UserField}`},yt=d=>{const T=[q.META_DATA_SOURCE_ACCOMMODATION_FORM,q.META_DATA_SOURCE_BADGE_FORM,q.META_DATA_SOURCE_DEALER_FORM,q.META_DATA_SOURCE_REGISTRATION_FORM,q.META_DATA_SOURCE_REGISTRATION_REFERENCE,q.META_DATA_SOURCE_SUBMISSION_DATE,q.META_DATA_SOURCE_SUBMISSION_STATUS],D=[X.USER_DATA_SOURCE_DISPLAY_NAME,X.USER_DATA_SOURCE_EMAIL,X.USER_DATA_SOURCE_HANDLE,X.USER_DATA_SOURCE_DATE_OF_BIRTH,X.USER_DATA_SOURCE_FIRST_NAME,X.USER_DATA_SOURCE_LAST_NAME];return T.includes(d.MetaField)||D.includes(d.UserField)},Ot=d=>{ue.value=d,pe.value=!0},Ct=d=>{ue.value=d,De.value=!0};return ne(pe,d=>{d||(ue.value=void 0)}),ne(De,d=>{d||(ue.value=void 0)}),(d,T)=>(r(),G(Ca,null,{default:o(()=>[t(Oa,{color:"blue-darken-4"},{default:o(()=>[t(ma,{modelValue:K.value,"onUpdate:modelValue":T[0]||(T[0]=D=>K.value=D),"show-arrows":""},{default:o(()=>[(r(!0),R(N,null,Z(c.value,D=>(r(),G(ca,{key:D.uuid,value:D.uuid},{default:o(()=>[$(k(D.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"]),t(Dt),t(se,{icon:"mdi:mdi-cog-outline",onClick:T[1]||(T[1]=D=>w.value=!0)})]),_:1}),t(_a,{modelValue:K.value,"onUpdate:modelValue":T[11]||(T[11]=D=>K.value=D),disabled:!0},{default:o(()=>[(r(!0),R(N,null,Z(c.value,D=>(r(),G(va,{key:D.uuid,value:D.uuid},{default:o(()=>[D.uuid===K.value?(r(),G(pt,{key:0,class:"pa-2"},{default:o(()=>[t(x(ka),{"items-per-page":v.value,"onUpdate:itemsPerPage":T[9]||(T[9]=y=>v.value=y),"sort-by":L.value,"onUpdate:sortBy":T[10]||(T[10]=y=>L.value=y),headers:D.headers,"items-length":g.value,items:D.items,"item-value":"LayoutItemUUID",loading:i.value,search:ie.value,"onUpdate:options":Me},Ke({top:o(()=>[t(Ce,null,{default:o(()=>[t(ee,null,{default:o(()=>[t(F,{cols:"12",sm:"6",lg:"3"},{default:o(()=>[t(Ue,{modelValue:fe.value,"onUpdate:modelValue":T[2]||(T[2]=y=>fe.value=y),label:"Search by Badge",clearable:!0,"hide-details":"",onInput:T[3]||(T[3]=y=>ie.value=Date.now().toString())},null,8,["modelValue"])]),_:1}),t(F,{cols:"12",sm:"6",lg:"3"},{default:o(()=>[t(Ue,{modelValue:Se.value,"onUpdate:modelValue":T[4]||(T[4]=y=>Se.value=y),label:"Search By Email",clearable:!0,"hide-details":"",onInput:T[5]||(T[5]=y=>ie.value=Date.now().toString())},null,8,["modelValue"])]),_:1}),t(F,{cols:"12",sm:"6",lg:"3"},{default:o(()=>[t(oe,{modelValue:C.value,"onUpdate:modelValue":T[6]||(T[6]=y=>C.value=y),label:"Search By Group",clearable:!0,"hide-details":"",items:a.value,"item-value":"GroupUUID","item-title":"Name"},null,8,["modelValue","items"])]),_:1}),t(F,{cols:"12",sm:"6",lg:"3"},{default:o(()=>[t(oe,{modelValue:h.value,"onUpdate:modelValue":T[7]||(T[7]=y=>h.value=y),label:"Search By Tag",clearable:!0,"hide-details":"",items:A.value,"item-value":"TagUUID","item-title":"Title"},null,8,["modelValue","items"])]),_:1})]),_:1})]),_:1})]),_:2},[Z(D.headers,y=>({name:`item.${y.key}`,fn:o(({item:me})=>[t(mo,{header:y,item:me,accommodations:I.value,convention:m.value,extras:P.value,interests:J.value,tickets:te.value,venues:z.value,onOpenActions:Ot,onOpenPayments:Ct,onReload:T[8]||(T[8]=ae=>Me({page:b.value,itemsPerPage:v.value,sortBy:O.value}))},null,8,["header","item","accommodations","convention","extras","interests","tickets","venues"])])}))]),1032,["items-per-page","sort-by","headers","items-length","items","loading","search"])]),_:2},1024)):j("",!0)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"]),w.value?(r(),G(Fa,{key:0,title:"Edit Layout",modelValue:w.value,"onUpdate:modelValue":T[12]||(T[12]=D=>w.value=D),layout:p.value,onSave:T[13]||(T[13]=D=>{w.value=!1,Ve()})},null,8,["modelValue","layout"])):j("",!0),ue.value?(r(),R(N,{key:1},[pe.value?(r(),G(Jo,{key:0,modelValue:pe.value,"onUpdate:modelValue":T[14]||(T[14]=D=>pe.value=D),registration:ue.value,"onUpdate:registration":T[15]||(T[15]=D=>ue.value=D),accommodations:I.value,convention:m.value,extras:P.value,forms:U.value,interests:J.value,tickets:te.value,title:"Registration Status & Communications",venues:z.value},null,8,["modelValue","registration","accommodations","convention","extras","forms","interests","tickets","venues"])):De.value?(r(),G(zo,{key:1,modelValue:De.value,"onUpdate:modelValue":T[16]||(T[16]=D=>De.value=D),registration:ue.value,"onUpdate:registration":T[17]||(T[17]=D=>ue.value=D),accommodations:I.value,convention:m.value,extras:P.value,forms:U.value,interests:J.value,tickets:te.value,title:"Registration Payments",venues:z.value},null,8,["modelValue","registration","accommodations","convention","extras","forms","interests","tickets","venues"])):j("",!0)],64)):j("",!0)]),_:1}))}});export{Mn as default};
