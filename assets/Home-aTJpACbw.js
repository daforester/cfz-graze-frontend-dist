import{i as K,M as Ie,N as Ue,j as Ee,r as b,w as se,n as e,q as l,v as t,x as n,f as i,z as Ae,y as T,A as y,O as be,D as m,P as ie,k as ve,B as r,F as f,Q as G,C as c,p as we,R as De,d as Ce,u as Pe,S as Re,c as M,m as ne,l as le,G as Ve,H as Oe,_ as _e}from"./index-vcohYEs5.js";import{G as re}from"./userData-7hJOOlc3.js";import{_ as Fe}from"./LoginView.vue_vue_type_script_setup_true_lang-Kcx3a4R-.js";import{s as ae}from"./index-2XRRB2DS.js";import{F as E}from"./form-0fJbSFPv.js";import{S as L,a as Me}from"./submission-40fey8Hx.js";import{u as ye}from"./useStoreAPI-wRfL6LCO.js";import{c as Q}from"./canEditForm-viF788U5.js";import{s as Ne}from"./sortSubmissions-NKScr9xj.js";import{P as X,a as $e,u as Le}from"./useDisplayTransactions-1OpSJgZE.js";import{l as xe}from"./stripe.esm-sevhGlMX.js";import{_ as Ye}from"./ModelDialog.vue_vue_type_script_setup_true_lang-EqEJL6mU.js";import{c as te,V as d,n as ze,u as Be}from"./VContainer-14yY9N_B.js";import{V as Ge}from"./VAlert-M__wRzam.js";import{V as He}from"./VForm-wjSy1K4z.js";import{V as q,a as H}from"./VRow-FbhwRbqP.js";import{V as Se,u as je}from"./scopeId-9Jp_y6nB.js";import{V as qe,m as We,a as fe}from"./SaveButton.vue_vue_type_script_setup_true_lang-kL07CwgP.js";import{f as Ke,h as pe}from"./date-RO2WHkId.js";import{V as he,a as ee,b as ge,c as oe,d as Je,e as Te}from"./VCard-FbIb3Au1.js";import{f as Qe,V as ke}from"./forwardRefs-YwbrEXq5.js";import{V as Xe,a as Ze,c as et,d as tt}from"./VList-ygejx9s6.js";import"./emailFormVariant-1EY2p0cn.js";import"./LoginButton-zVuyNVmJ.js";import"./VDialog-CALvNfxq.js";import"./VToolbar-Z3B8szPw.js";import"./createSimpleFunctional-E4FYzOZV.js";import"./form-7WgV4gCe.js";import"./VDivider-ryazHwxP.js";const at=m("p",{class:"my-4"},[n(" Payments are non-refundable, please check our "),m("a",{target:"_blank",href:"https://www.scotiacon.org.uk/policies"},"policies"),n(" for further information. ")],-1),ot=m("p",{class:"my-4"}," You must be over 18 to attend the convention and be able to produce valid ID matching the details on your registration. ",-1),nt=m("p",{class:"my-4"}," If you are unable to provide valid ID when asked at the convention you will not be issued your attendee badge. ",-1),lt=m("p",{class:"my-4"}," Payments should be made by the authorised card holder only. ",-1),st=m("p",{class:"my-4"},[n(" Please contact "),m("a",{href:"mailto:registration@scotiacon.org.uk"},"registration@scotiacon.org.uk"),n(" if you need any further assistance. ")],-1),it=m("div",{id:"link-authentication-element"},null,-1),rt=m("div",{id:"payment-element"},null,-1),ut=K({__name:"StripePayment",props:Ie({paymentTransactions:{},registration:{}},{modelValue:{type:Boolean,required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(u){const I=Ue(u,"modelValue"),w=ie(),A=re(),g=Ee(),s=b(),_=b(),S=b((A==null?void 0:A.Additional.Email)||""),k=b(!1),F=b("");let N;const Y=b(!1);se(I,U=>{U&&w.stripePublicKey().then(async h=>{h&&(_.value=await xe(h),await x(_.value))})});const z=U=>{F.value=U,k.value=!0};async function x(U){var p;if(!U)return;const h=await w.stripePaymentIntent(((p=u.registration)==null?void 0:p.RegistrationUUID)||""),C={theme:"stripe"};g.current.value.dark&&(C.theme="night"),N=U.elements({clientSecret:h,appearance:C});const B=N.create("linkAuthentication",{defaultValues:{email:S.value}});B.mount("#link-authentication-element"),B.on("change",v=>{S.value=v.value.email});const Z={layout:"tabs"};N.create("payment",Z).mount("#payment-element")}async function j(U,h){if(!h)return;U.preventDefault(),Y.value=!0;const C=new URL(location.href);C.pathname+="payment/stripe/processing";const{error:B}=await h.confirmPayment({elements:N,confirmParams:{return_url:C.toString(),receipt_email:S.value}});B.type==="card_error"||B.type==="validation_error"?z(B.message):z("An unexpected error occurred."),Y.value=!1}return(U,h)=>(e(),l(Ye,{modelValue:I.value,"onUpdate:modelValue":h[4]||(h[4]=C=>I.value=C),title:"Make a Payment",color:"blue-darken-4",fullscreen:"",persistent:""},{default:t(()=>[i(te,{class:"pa-0"},{default:t(()=>[i(Ge,{class:"mb-2",closable:!0},{title:t(()=>[n(" Payment Information ")]),text:t(()=>[at,ot,nt,lt,st]),_:1}),i(He,{ref_key:"paymentForm",ref:s,id:"payment-form",onSubmit:h[1]||(h[1]=Ae(C=>j(C,_.value),["prevent"]))},{default:t(()=>[i(q,null,{default:t(()=>[i(H,null,{default:t(()=>[it]),_:1})]),_:1}),i(q,null,{default:t(()=>[i(H,null,{default:t(()=>[rt]),_:1})]),_:1}),i(q,null,{default:t(()=>[U.registration?(e(),l(H,{key:0,class:"font-weight-bold text-right"},{default:t(()=>[n(" Payment Amount: £"+T(U.registration.Total-U.registration.Paid),1)]),_:1})):y("",!0)]),_:1}),i(q,null,{default:t(()=>[i(H,{class:"text-right",cols:"12",sm:"3",md:"2",lg:"2",xl:"1"},{default:t(()=>[i(d,{color:"error",class:"w-100",onClick:h[0]||(h[0]=C=>I.value=!1)},{default:t(()=>[n("Cancel")]),_:1})]),_:1}),i(Se),i(H,{class:"text-left",cols:"12",sm:"3",md:"2",lg:"2",xl:"1"},{default:t(()=>[i(d,{type:"submit",color:"success",class:"w-100"},be({default:t(()=>[n(" Pay Now ")]),_:2},[Y.value?{name:"prepend",fn:t(()=>[i(ze,{size:"20",indeterminate:""})]),key:"0"}:void 0]),1024)]),_:1})]),_:1})]),_:1},512)]),_:1}),i(qe,{modelValue:k.value,"onUpdate:modelValue":h[3]||(h[3]=C=>k.value=C)},{actions:t(()=>[i(d,{variant:"text",onClick:h[2]||(h[2]=C=>k.value=!1)},{default:t(()=>[n(" Close ")]),_:1})]),default:t(()=>[n(T(F.value)+" ",1)]),_:1},8,["modelValue"])]),_:1},8,["modelValue"]))}}),ct={key:0},dt={key:1,class:"v-row"},mt={key:0,class:"v-col v-col-10 py-1 v-row mx-0 pl-0"},vt={class:"v-col v-col-12 v-col-sm-4 v-col-md-3 font-weight-bold pb-0 pr-0"},ft={class:"v-col v-col-12 v-col-sm-8 v-col-md-9 font-italic pt-0 pt-sm-3 pb-sm-0 pl-sm-0"},pt={key:1,class:"v-col v-col-10 py-1 v-row mx-0 pl-0"},gt={class:"v-col v-col-12 v-col-sm-4 v-col-md-3 font-weight-bold pb-0 pr-0"},_t={class:"v-col v-col-12 v-col-sm-8 v-col-md-9 font-italic pt-0 pt-sm-3 pb-sm-0 pl-sm-0"},yt={class:"v-col v-col-2 align-self-end text-right py-1 text-no-wrap"},St=m("dt",{class:"v-col v-col-9 py-1 font-weight-bold totals"}," Total Charges ",-1),ht={class:"v-col v-col-3 align-self-end text-right py-1 totals text-no-wrap"},Tt=m("dt",{class:"v-col v-col-9 py-1 font-weight-bold"}," Current Payments ",-1),kt={class:"v-col v-col-3 align-self-end text-right py-1 text-no-wrap"},It=m("dt",{class:"v-col v-col-9 py-1 font-weight-bold totals"}," Balance Due ",-1),Ut={class:"v-col v-col-3 align-self-end text-right py-1 totals text-no-wrap"},Et=K({__name:"AttendeeTransactionList",props:{paymentTransactions:{},registration:{}},setup(u){const I=u,w=b(ve(I.paymentTransactions));se(I,()=>{w.value=ve(I.paymentTransactions)});const A=(g,s)=>g.Type===X.PAYMENT_TRANSACTION_TYPE_CHARGE&&s.Type!==X.PAYMENT_TRANSACTION_TYPE_CHARGE?-1:g.Type!==X.PAYMENT_TRANSACTION_TYPE_CHARGE&&s.Type===X.PAYMENT_TRANSACTION_TYPE_CHARGE||(g.UpdatedAt||0)>(s.UpdatedAt||0)?1:g.UpdatedAt===s.UpdatedAt?0:-1;return(g,s)=>g.paymentTransactions.length==0&&g.registration.Total==0?(e(),r("p",ct," Your registration is currently being processed, payment information will appear here when ready. ")):(e(),r("dl",dt,[(e(!0),r(f,null,G(w.value.sort(A),_=>{var S;return e(),r(f,{key:_.PaymentTransactionUUID},[_.Type===c(X).PAYMENT_TRANSACTION_TYPE_CHARGE?(e(),r("dt",mt,[m("div",vt,T(_.Description.split(":")[0]),1),m("div",ft,T(_.Description.split(":")[1]),1)])):(e(),r("dt",pt,[m("div",gt,T((S=c($e).find(k=>k.value===_.Type))==null?void 0:S.title),1),m("div",_t," [ "+T(c(Ke)(_.UpdatedAt||""))+" ] "+T(_.Description),1)])),m("dd",yt," £"+T(_.Amount),1)],64)}),128)),St,m("dd",ht," £"+T(g.registration.Total),1),Tt,m("dd",kt," £"+T(g.registration.Paid),1),It,m("dd",Ut," £"+T(g.registration.Total-g.registration.Paid),1)]))}}),At=we({id:String,text:String,...De(We({closeOnBack:!1,location:"end",locationStrategy:"connected",eager:!0,minWidth:0,offset:10,openOnClick:!1,openOnHover:!0,origin:"auto",scrim:!1,scrollStrategy:"reposition",transition:!1}),["absolute","persistent"])},"VTooltip"),bt=Ce()({name:"VTooltip",props:At(),emits:{"update:modelValue":u=>!0},setup(u,I){let{slots:w}=I;const A=Pe(u,"modelValue"),{scopeId:g}=je(),s=Re(),_=M(()=>u.id||`v-tooltip-${s}`),S=b(),k=M(()=>u.location.split(" ").length>1?u.location:u.location+" center"),F=M(()=>u.origin==="auto"||u.origin==="overlap"||u.origin.split(" ").length>1||u.location.split(" ").length>1?u.origin:u.origin+" center"),N=M(()=>u.transition?u.transition:A.value?"scale-transition":"fade-transition"),Y=M(()=>ne({"aria-describedby":_.value},u.activatorProps));return Be(()=>{const z=fe.filterProps(u);return i(fe,ne({ref:S,class:["v-tooltip",u.class],style:u.style,id:_.value},z,{modelValue:A.value,"onUpdate:modelValue":x=>A.value=x,transition:N.value,absolute:!0,location:k.value,origin:F.value,persistent:!0,role:"tooltip",activatorProps:Y.value,_disableGlobalStack:!0},g),{activator:w.activator,default:function(){var h;for(var x=arguments.length,j=new Array(x),U=0;U<x;U++)j[U]=arguments[U];return((h=w.default)==null?void 0:h.call(w,...j))??u.text}})}),Qe({},S)}}),J=u=>(Ve("data-v-ff1e31f2"),u=u(),Oe(),u),wt=["innerHTML"],Dt={key:0},Ct={key:0,class:"font-weight-bold float-left pt-1 w-50"},Pt={key:1,class:"pa-1"},Rt=J(()=>m("dt",null,[m("h3",null,"Forms Available")],-1)),Vt=J(()=>m("dd",{class:"mb-2"}," The following forms are currently available for completion. ",-1)),Ot={class:"font-weight-bold float-left pt-1 w-50 pt-3",style:{clear:"both"}},Ft={class:"pt-2"},Mt=J(()=>m("dt",{class:"mt-3"},[m("h3",null,"Received Forms")],-1)),Nt=J(()=>m("dd",{class:"mb-2"}," The following forms have been received from you. ",-1)),$t={key:0,class:"font-weight-bold float-left pt-1 w-50",style:{clear:"both"}},Lt={key:1},xt={class:"font-weight-bold float-left pt-1 w-50",style:{clear:"both"}},Yt={class:"text-red-darken-4"},zt={key:1,class:"text-red-darken-4 mt-4"},Bt=J(()=>m("strong",null,"There are forms above that require completion, please edit and save them.",-1)),Gt=[Bt],Ht=J(()=>m("br",null,null,-1)),jt=K({__name:"OpenConvention",props:{convention:{},forms:{default:()=>[]}},setup(u){const I=ye(),w=ie(),{getPaymentTransactions:A}=Le(),g=b(I.GetConventionLogoURL(u.convention.ConventionUUID)),s=b(),_=b([]),S=b([]),k=b([]),F=b(!1),N=b([]),Y=M(()=>{var a;return Q(u.forms,((a=s.value)==null?void 0:a.Submissions)||[],E.FORM_TYPE_REGISTRATION)}),z=M(()=>{var a;return Q(u.forms,((a=s.value)==null?void 0:a.Submissions)||[],E.FORM_TYPE_DEALER)}),x=M(()=>{var a;return Q(u.forms,((a=s.value)==null?void 0:a.Submissions)||[],E.FORM_TYPE_BADGE)}),j=M(()=>{var a;return Q(u.forms,((a=s.value)==null?void 0:a.Submissions)||[],E.FORM_TYPE_ACCOMMODATION)}),U=M(()=>{var a;return Q(u.forms,((a=s.value)==null?void 0:a.Submissions)||[],E.FORM_TYPE_ADDITIONAL)}),h=M(()=>s.value?u.forms.filter(a=>{var p;return a.State.Independent?(p=s.value)!=null&&p.Submissions&&"Submissions"in s.value?!s.value.Submissions.find(v=>{var V;return((V=v.Form)==null?void 0:V.FormUUID)===a.FormUUID}):!0:!1}):u.forms),C=M(()=>{var a,p;return s.value&&((a=s.value)!=null&&a.Submissions)?!!((p=s.value)!=null&&p.Submissions.find(v=>{var V;return((V=v.Form)==null?void 0:V.Type)==E.FORM_TYPE_REGISTRATION&&(v.Status==L.SUBMISSION_STATUS_ACCEPTED||v.Status==L.SUBMISSION_STATUS_COMPLETED)})):!1}),B=async()=>{s.value&&"RegistrationUUID"in s.value&&w.getRegistrationAllocationPeriods(s.value.RegistrationUUID).then(a=>{a&&(S.value=[],_.value=a,_.value.sort((p,v)=>p.DateStart>v.DateStart?1:-1).forEach(p=>{var V;const v=S.value.find(P=>{var R;return P.name===((R=p.Accommodation)==null?void 0:R.Name)});if(v){const P=v.periods.find(O=>O.start===p.DateEnd),R=v.periods.find(O=>O.end===p.DateStart);P?P.start=p.DateStart:R?R.end=p.DateEnd:v.periods.push({start:p.DateStart,end:p.DateEnd})}else S.value.push({name:((V=p.Accommodation)==null?void 0:V.Name)||"",periods:[{start:p.DateStart,end:p.DateEnd}]})}))}).catch(()=>{})},Z=()=>{w.getRegistrationByConvention(u.convention.ConventionUUID).then(a=>{var p;a&&(a.Submissions?(a.Submissions.forEach((v,V)=>{v.Form||(a.Submissions[V].Form=u.forms.find(P=>P.FormUUID===v.FormUUID))}),Ne(a.Submissions)):a.Submissions=[],s.value=a,B(),C.value&&A(((p=s.value)==null?void 0:p.RegistrationUUID)||"").then(v=>{k.value=v}))})};return se(()=>u.forms,()=>{Z()}),Z(),(a,p)=>{const v=le("router-link"),V=le("RouterLink");return e(),l(Te,{class:"elevation-5 flex-1-0 d-flex flex-column"},{default:t(()=>[i(he,{class:"flex-1-1 align-content-start"},{default:t(()=>[g.value?(e(),l(ke,{key:0,src:g.value,title:a.convention.Name,class:"logo text-center"},null,8,["src","title"])):y("",!0),a.convention.Name?(e(),l(ee,{key:1,class:"text-center"},{default:t(()=>[n(T(a.convention.Name),1)]),_:1})):y("",!0),a.convention.Description?(e(),l(ge,{key:2,class:"text-wrap subtitle"},{default:t(()=>[m("div",{innerHTML:a.convention.Description},null,8,wt)]),_:1})):y("",!0)]),_:1}),i(oe,null,{default:t(()=>{var P,R,O;return[s.value?(e(),r("dl",Dt,[s.value.Reference?(e(),r("dt",Ct," Badge No: ")):y("",!0),s.value.Reference?(e(),r("dd",Pt," #"+T(s.value.Reference),1)):y("",!0),h.value.length>0?(e(),r(f,{key:2},[Rt,Vt],64)):y("",!0),(e(!0),r(f,null,G(h.value,(o,$)=>(e(),r(f,{key:o.FormUUID},[m("dt",Ot,T(o.Heading),1),m("dd",Ft,[(o==null?void 0:o.Type)===c(E).FORM_TYPE_DEALER?(e(),l(v,{key:0,to:`/register/${a.convention.Slug||a.convention.ConventionUUID}/dealer`},{default:t(()=>[o!=null&&o.State.Edit&&z.value?(e(),l(d,{key:0,size:"small",variant:"flat",color:"success",class:"ml-2"},{default:t(()=>[n(" Open form ")]),_:1})):(e(),l(d,{key:1,size:"small",variant:"text",color:"warning"},{default:t(()=>[n("View")]),_:1}))]),_:2},1032,["to"])):(o==null?void 0:o.Type)===c(E).FORM_TYPE_BADGE?(e(),l(v,{key:1,to:`/register/${a.convention.Slug||a.convention.ConventionUUID}/badge`},{default:t(()=>[o!=null&&o.State.Edit&&x.value?(e(),l(d,{key:0,size:"small",variant:"flat",color:"success",class:"ml-2"},{default:t(()=>[n(" Open form ")]),_:1})):(e(),l(d,{key:1,size:"small",variant:"text",color:"warning"},{default:t(()=>[n("View")]),_:1}))]),_:2},1032,["to"])):(o==null?void 0:o.Type)===c(E).FORM_TYPE_ADDITIONAL?(e(),l(v,{key:2,to:`/register/${a.convention.Slug||a.convention.ConventionUUID}/additional`},{default:t(()=>[o!=null&&o.State.Edit&&U.value?(e(),l(d,{key:0,size:"small",variant:"flat",color:"success",class:"ml-2"},{default:t(()=>[n(" Open form ")]),_:1})):(e(),l(d,{key:1,size:"small",variant:"text",color:"warning"},{default:t(()=>[n("View")]),_:1}))]),_:2},1032,["to"])):y("",!0)])],64))),128)),((P=s.value)==null?void 0:P.Submissions.length)>0?(e(),r(f,{key:3},[Mt,Nt],64)):y("",!0),(e(!0),r(f,null,G((R=s.value)==null?void 0:R.Submissions,(o,$)=>{var W,ue,ce,de,me;return e(),r(f,{key:o.SubmissionUUID},[o.Form?(e(),r(f,{key:0},[o.Form?(e(),r("dt",$t,T(o.Form.Heading),1)):y("",!0),o.Form?(e(),r("dd",Lt,[i(bt,{modelValue:N.value[$],"onUpdate:modelValue":D=>N.value[$]=D},{activator:t(({props:D})=>[i(d,ne(D,{color:"blue-darken-2",icon:"mdi:mdi-information",variant:"text",size:"xs",onClick:ea=>N.value[$]=!N.value[$]}),null,16,["onClick"])]),default:t(()=>[o.Status===c(L).SUBMISSION_STATUS_NULL?(e(),r(f,{key:0},[n(" There is an error with your submission, please contact the registration team for support. ")],64)):o.Status===c(L).SUBMISSION_STATUS_INCOMPLETE?(e(),r(f,{key:1},[n(" Something is missing on your submission which requires completing to be able to process your request. Please contact the registration team for further advice. ")],64)):o.Status===c(L).SUBMISSION_STATUS_OPEN?(e(),r(f,{key:2},[n(" Your submission has been received by our system but you may still make changes before the registration team begins processing it. ")],64)):o.Status===c(L).SUBMISSION_STATUS_LOCKED?(e(),r(f,{key:3},[n(" We have locked your submission to prevent further changes whilst we process it. If you need to change something please get in touch. ")],64)):o.Status===c(L).SUBMISSION_STATUS_ACCEPTED?(e(),r(f,{key:4},[n(" We have locked your submission to prevent further changes whilst we process it. If you need to change something please get in touch. ")],64)):o.Status===c(L).SUBMISSION_STATUS_COMPLETED?(e(),r(f,{key:5},[n(" Congratulations everything is complete. If you need to make changes please get in touch. ")],64)):o.Status===c(L).SUBMISSION_STATUS_REJECTED?(e(),r(f,{key:6},[n(" Your request has been rejected. The registration team will provide an explanation. ")],64)):o.Status===c(L).SUBMISSION_STATUS_INVALID?(e(),r(f,{key:7},[n(" Your request has been identified as having errors or being incomplete. Please contact the registration team for additional support. ")],64)):o.Status===c(L).SUBMISSION_STATUS_CANCELLED?(e(),r(f,{key:8},[n(" Your submission has been cancelled. This may be at your request or another reason. The registration team will be able to provide further details. ")],64)):(e(),r(f,{key:9},[n(" Please contact the registration team for support. ")],64))]),_:2},1032,["modelValue","onUpdate:modelValue"]),n(" "+T(c(Me)(o.Status))+" ",1),((W=o.Form)==null?void 0:W.Type)===c(E).FORM_TYPE_REGISTRATION?(e(),l(v,{key:0,to:`/register/${a.convention.Slug||a.convention.ConventionUUID}/registration`},{default:t(()=>{var D;return[(D=o.Form)!=null&&D.State.Edit&&Y.value?(e(),l(d,{key:0,size:"small",variant:"text",color:"success"},{default:t(()=>[n(" Edit ")]),_:1})):(e(),l(d,{key:1,size:"small",variant:"text",color:"warning"},{default:t(()=>[n("View")]),_:1}))]}),_:2},1032,["to"])):((ue=o.Form)==null?void 0:ue.Type)===c(E).FORM_TYPE_ACCOMMODATION?(e(),l(v,{key:1,to:`/register/${a.convention.Slug||a.convention.ConventionUUID}/accommodation`},{default:t(()=>{var D;return[(D=o.Form)!=null&&D.State.Edit&&j.value?(e(),l(d,{key:0,size:"small",variant:"text",color:"success"},{default:t(()=>[n(" Edit ")]),_:1})):(e(),l(d,{key:1,size:"small",variant:"text",color:"warning"},{default:t(()=>[n("View")]),_:1}))]}),_:2},1032,["to"])):((ce=o.Form)==null?void 0:ce.Type)===c(E).FORM_TYPE_DEALER?(e(),l(v,{key:2,to:`/register/${a.convention.Slug||a.convention.ConventionUUID}/dealer`},{default:t(()=>{var D;return[(D=o.Form)!=null&&D.State.Edit&&z.value?(e(),l(d,{key:0,size:"small",variant:"text",color:"success"},{default:t(()=>[n(" Edit ")]),_:1})):(e(),l(d,{key:1,size:"small",variant:"text",color:"warning"},{default:t(()=>[n("View")]),_:1}))]}),_:2},1032,["to"])):((de=o.Form)==null?void 0:de.Type)===c(E).FORM_TYPE_BADGE?(e(),l(v,{key:3,to:`/register/${a.convention.Slug||a.convention.ConventionUUID}/badge`},{default:t(()=>{var D;return[(D=o.Form)!=null&&D.State.Edit&&x.value?(e(),l(d,{key:0,size:"small",variant:"text",color:"success"},{default:t(()=>[n(" Edit ")]),_:1})):(e(),l(d,{key:1,size:"small",variant:"text",color:"warning"},{default:t(()=>[n("View")]),_:1}))]}),_:2},1032,["to"])):((me=o.Form)==null?void 0:me.Type)===c(E).FORM_TYPE_ADDITIONAL?(e(),l(v,{key:4,to:`/register/${a.convention.Slug||a.convention.ConventionUUID}/additional`},{default:t(()=>{var D;return[(D=o.Form)!=null&&D.State.Edit&&U.value?(e(),l(d,{key:0,size:"small",variant:"text",color:"success"},{default:t(()=>[n(" Edit ")]),_:1})):(e(),l(d,{key:1,size:"small",variant:"text",color:"warning"},{default:t(()=>[n("View")]),_:1}))]}),_:2},1032,["to"])):y("",!0)])):y("",!0)],64)):y("",!0)],64)}),128)),((O=s.value)==null?void 0:O.Submissions.length)>=1?(e(!0),r(f,{key:4},G(a.forms,o=>{var $;return e(),r(f,{key:o.FormUUID},[!(($=s.value)!=null&&$.Submissions.find(W=>W.FormUUID===o.FormUUID))&&!o.State.Independent?(e(),r(f,{key:0},[m("dt",xt,T(o.Heading),1),m("dd",Yt,[n(" Requires Completion "),o.Type===c(E).FORM_TYPE_REGISTRATION?(e(),l(v,{key:0,to:`/register/${a.convention.Slug||a.convention.ConventionUUID}/registration`},{default:t(()=>[o.State.Edit&&Y.value?(e(),l(d,{key:0,size:"small",variant:"text",color:"success"},{default:t(()=>[n(" Edit ")]),_:1})):(e(),l(d,{key:1,size:"small",variant:"text",color:"warning"},{default:t(()=>[n("View")]),_:1}))]),_:2},1032,["to"])):o.Type===c(E).FORM_TYPE_ACCOMMODATION?(e(),l(v,{key:1,to:`/register/${a.convention.Slug||a.convention.ConventionUUID}/accommodation`},{default:t(()=>[o.State.Edit&&j.value?(e(),l(d,{key:0,size:"small",variant:"text",color:"success"},{default:t(()=>[n(" Edit ")]),_:1})):(e(),l(d,{key:1,size:"small",variant:"text",color:"warning"},{default:t(()=>[n("View")]),_:1}))]),_:2},1032,["to"])):o.Type===c(E).FORM_TYPE_DEALER?(e(),l(v,{key:2,to:`/register/${a.convention.Slug||a.convention.ConventionUUID}/dealer`},{default:t(()=>[o.State.Edit&&z.value?(e(),l(d,{key:0,size:"small",variant:"text",color:"success"},{default:t(()=>[n(" Edit ")]),_:1})):(e(),l(d,{key:1,size:"small",variant:"text",color:"warning"},{default:t(()=>[n("View")]),_:1}))]),_:2},1032,["to"])):o.Type===c(E).FORM_TYPE_BADGE?(e(),l(v,{key:3,to:`/register/${a.convention.Slug||a.convention.ConventionUUID}/badge`},{default:t(()=>[o.State.Edit&&x.value?(e(),l(d,{key:0,size:"small",variant:"text",color:"success"},{default:t(()=>[n(" Edit ")]),_:1})):(e(),l(d,{key:1,size:"small",variant:"text",color:"warning"},{default:t(()=>[n("View")]),_:1}))]),_:2},1032,["to"])):o.Type===c(E).FORM_TYPE_ADDITIONAL?(e(),l(v,{key:4,to:`/register/${a.convention.Slug||a.convention.ConventionUUID}/additional`},{default:t(()=>[o.State.Edit&&U.value?(e(),l(d,{key:0,size:"small",variant:"text",color:"success"},{default:t(()=>[n(" Edit ")]),_:1})):(e(),l(d,{key:1,size:"small",variant:"text",color:"warning"},{default:t(()=>[n("View")]),_:1}))]),_:2},1032,["to"])):y("",!0)])],64)):y("",!0)],64)}),128)):y("",!0)])):y("",!0),s.value&&s.value.Submissions.length>=1&&a.forms.filter(o=>{var $;return!o.State.Independent&&!(($=s.value)!=null&&$.Submissions.find(W=>W.FormUUID==o.FormUUID))}).length>0?(e(),r("div",zt,Gt)):y("",!0)]}),_:1}),S.value.length>0?(e(),r(f,{key:0},[i(ee,{class:"pb-0"},{default:t(()=>[n("Allocated Accommodation")]),_:1}),i(ge,{class:"text-wrap"},{default:t(()=>[n("The following accommodation has been allocated to your registration. In some cases this may not have been your first choice.")]),_:1}),i(oe,null,{default:t(()=>[i(Xe,{density:"compact"},{default:t(()=>[(e(!0),r(f,null,G(S.value,P=>(e(),l(Ze,{key:P.name},{default:t(()=>[i(et,null,{default:t(()=>[n(T(P.name),1)]),_:2},1024),(e(!0),r(f,null,G(P.periods,R=>(e(),l(tt,{key:R.start},{default:t(()=>[n(" ("+T(c(pe)(R.start))+" - "+T(c(pe)(R.end))+")",1),Ht]),_:2},1024))),128))]),_:2},1024))),128))]),_:1})]),_:1})],64)):y("",!0),C.value&&s.value?(e(),r(f,{key:1},[i(ee,{class:"pb-4"},{default:t(()=>[n("Payment Information")]),_:1}),i(oe,null,{default:t(()=>[i(Et,{"payment-transactions":k.value,registration:s.value},null,8,["payment-transactions","registration"])]),_:1})],64)):y("",!0),i(Je,null,{default:t(()=>{var P,R;return[a.convention.DetailLink?(e(),l(d,{key:0,color:"warning",href:a.convention.DetailLink,variant:"flat"},{default:t(()=>[n(T(c(ae).buttonDetails),1)]),_:1},8,["href"])):y("",!0),i(Se),Y.value?(e(),r(f,{key:1},[(P=s.value)!=null&&P.Submissions.find(O=>{var o;return((o=O.Form)==null?void 0:o.Type)===c(E).FORM_TYPE_REGISTRATION})?(e(),l(V,{key:1,to:`/register/${a.convention.Slug||a.convention.ConventionUUID}`},{default:t(()=>[i(d,{color:"primary",variant:"flat"},{default:t(()=>[n(T(c(ae).buttonViewRegistration),1)]),_:1})]),_:1},8,["to"])):(e(),r(f,{key:0},[(R=a.forms.find(O=>O.Type===c(E).FORM_TYPE_REGISTRATION))!=null&&R.State.New?(e(),l(V,{key:0,to:`/register/${a.convention.Slug||a.convention.ConventionUUID}`},{default:t(()=>[i(d,{color:"success",variant:"flat"},{default:t(()=>[n(T(c(ae).buttonRegister),1)]),_:1})]),_:1},8,["to"])):y("",!0)],64))],64)):C.value&&s.value&&s.value.Total>s.value.Paid?(e(),r(f,{key:2},[i(d,{color:"success",variant:"elevated",onClick:p[0]||(p[0]=O=>F.value=!0)},{default:t(()=>[n(" Make Payment ")]),_:1}),s.value?(e(),l(ut,{key:0,"payment-transactions":k.value,registration:s.value,modelValue:F.value,"onUpdate:modelValue":p[1]||(p[1]=O=>F.value=O)},null,8,["payment-transactions","registration","modelValue"])):y("",!0)],64)):y("",!0)]}),_:1})]),_:1})}}}),qt=_e(jt,[["__scopeId","data-v-ff1e31f2"]]),Wt=m("h3",{class:"font-weight-regular px-4"}," Convention Sticker Collection ",-1),Kt=K({__name:"Conventions",setup(u){const I=ie(),w=ye(),A=b([]),g=b([]),s=b([]);return I.getOpenConventionsList().then(_=>{_&&(g.value=[...g.value,..._],I.getAvailableConventionForms(g.value.map(S=>S.ConventionUUID)).then(S=>{s.value=[...s.value,...S]}).catch(S=>{console.error(S)}),I.getAttendedConventions().then(S=>{A.value=S}))}),(_,S)=>(e(),r(f,null,[i(te,null,{default:t(()=>[i(q,{class:"justify-center"},{default:t(()=>[(e(!0),r(f,null,G(g.value,k=>(e(),l(H,{key:k.ConventionUUID,cols:"12",sm:"11",md:"11",lg:"8",xl:"6",class:"d-flex flex-column"},{default:t(()=>[i(qt,{convention:k,forms:s.value.filter(F=>F.ConventionUUID===k.ConventionUUID)},null,8,["convention","forms"])]),_:2},1024))),128))]),_:1})]),_:1}),A.value.length>0?(e(),l(te,{key:0,fluid:"",class:"px-0"},{default:t(()=>[i(q,{class:"bg-blue-darken-4"},{default:t(()=>[i(H,null,{default:t(()=>[Wt]),_:1})]),_:1}),i(q,{class:"justify-center"},{default:t(()=>[(e(!0),r(f,null,G(A.value,k=>(e(),l(H,{key:k.ConventionUUID,cols:"8",sm:"6",md:"4",lg:"3",xl:"2"},{default:t(()=>[i(Te,{class:"elevation-5 flex-1-0 d-flex flex-column"},{default:t(()=>[i(he,{class:"flex-1-1 align-content-start"},{default:t(()=>[i(ke,{src:c(w).GetConventionLogoURL(k.ConventionUUID),title:k.Name,class:"logo text-center"},null,8,["src","title"]),k.Name?(e(),l(ee,{key:0,class:"text-center text-wrap"},{default:t(()=>[n(T(k.Name),1)]),_:2},1024)):y("",!0)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})):y("",!0)],64))}}),Jt={};function Qt(u,I){return e(),r("div")}const Xt=_e(Jt,[["render",Qt]]),Zt=K({__name:"MainView",emits:["pageTitle"],setup(u,{emit:I}){I("pageTitle","Scotiacon Registration System"),sessionStorage.getItem("reload")==="true"&&(sessionStorage.removeItem("reload"),setTimeout(()=>{location.reload()},500));const g=localStorage.getItem("gjt_token"),s=localStorage.getItem("ajt_token");g?(localStorage.removeItem("gjt_token"),location.href=g):s&&(localStorage.removeItem("ajt_token"),location.href=s);const _=b(re());return(S,k)=>{const F=le("router-link");return e(),r(f,null,[_.value&&(!_.value.Additional||!_.value.Additional.Email)?(e(),l(te,{key:0,class:"bg-red-darken-4 text-center",fluid:!0},{default:t(()=>[n(" Please enter a Contact Email on the "),i(F,{to:"/profile",class:"text-white font-weight-bold"},{default:t(()=>[n("manage account page")]),_:1}),n(" to ensure we can contact you. ")]),_:1})):y("",!0),i(Kt),i(Xt)],64)}}}),Ca=K({__name:"Home",props:{loggedIn:{type:Boolean}},emits:["pageTitle"],setup(u,{emit:I}){const w=re(),A=I;return A("pageTitle","Telegram Login"),(g,s)=>(e(),r("div",null,[g.loggedIn&&c(w)?(e(),l(Zt,{key:0,onPageTitle:s[0]||(s[0]=_=>A("pageTitle",_))})):(e(),l(Fe,{key:1}))]))}});export{Ca as default};
