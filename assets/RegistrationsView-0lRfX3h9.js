import{p as ll,d as nl,c as se,t as je,a0 as ol,a1 as il,f as t,F as L,m as Tt,i as Q,M as X,N as le,r as _,k as _e,w as Ue,n as o,q as S,v as a,y as I,D as F,x as O,B as T,Q as W,C as E,A as M,P as Ae,G as xt,H as qt,_ as ct,a2 as sl,a3 as Xe,O as We,a4 as ul,X as gt,o as rl,b as dl,a5 as ml,a6 as cl,a7 as aa,z as Pt,a8 as vl,a9 as la,Z as dt,aa as fl,ab as Ul,V as Al,U as Tl,E as gl}from"./index-QwOn83Jd.js";import{T as _l,V as Ta,e as El,c as ga,d as pl}from"./FormRenderer.vue_vue_type_style_index_0_lang-4evzY_xb.js";import{F as ge,a as Dl}from"./form-0fJbSFPv.js";import{b as _a,c as Kt,S as Ea,d as na}from"./submission-40fey8Hx.js";import{u as vt,V as rt}from"./VCheckbox-RRetGPbu.js";import{_ as we}from"./ModelDialog.vue_vue_type_script_setup_true_lang-PHMHAyk1.js";import{h as Oe,b as _t,a as Sl,c as yl,d as oa,P as $t,u as pa}from"./useDisplayTransactions-iym8QXnW.js";import{u as Il,a as ce,V as ke}from"./VContainer-RSBbRV8b.js";import{V as J,a as V}from"./VRow-Q3bJK5av.js";import{V as Le,a as Ve,c as Et,d as Cl}from"./VList-_xdG7aXJ.js";import{V as fe}from"./copyToClipboard-GIIY3Dsi.js";import{G as $e}from"./userData-qQKFt7_5.js";import{C as Dt}from"./canEditRegistrations-A1ez9bSf.js";import{V as K,a as Da}from"./VBtn-rkVJqdCh.js";import{G as St}from"./group-7fhbY6WJ.js";import{C as yt}from"./canDo-yWCfI_4r.js";import{a as It,V as Fe}from"./scopeId-1yRkaE7X.js";import{b as Rl,_ as mt,V as Sa}from"./SaveButton.vue_vue_type_script_setup_true_lang-TqVbvQFq.js";import{V as it,a as Ze,c as et,d as jt,e as Pe}from"./VCard-dXifqolY.js";import{V as zt}from"./VAvatar-p4FMq_AG.js";import{V as oe}from"./VTextField-pA8dAjO0.js";import{v as Ie}from"./v4-yQnnJER4.js";import{m as hl,k as Ol,l as kl,n as Vl,o as bl,p as Ml,q as Nl,u as Ll,r as wl,s as Fl,t as Pl,v as $l,w as Bl,x as Gl,y as Yl,z as ia,A as sa,B as ua,c as Ct,d as Rt,e as Qt,b as ht,V as Ot,a as ya,h as Ia,i as Ca,_ as Ra,j as Je,g as ha,f as Bt,C as Hl}from"./VWindowItem-rVyF6YPw.js";import{_ as Oa}from"./DeleteDialog.vue_vue_type_script_setup_true_lang-pBkGx_Ze.js";import{a as ka,V as Gt}from"./VToolbar-WaWn-z-F.js";import{V as xl}from"./VDivider-hpwh2OG-.js";import{V as Va}from"./VTextarea-V3XFmupd.js";import{V as pt}from"./VDialog-JUks-Lca.js";import{V as ql,a as Yt}from"./VChip-360xRHF-.js";import{V as Kl}from"./VForm-ygoAd2GR.js";import{V as jl,b as zl}from"./VNavigationDrawer-7KSHgAtS.js";import{s as Ql}from"./sortSubmissions-NKScr9xj.js";import{V as Jl,a as Xl}from"./VAlert-u4ifOz6K.js";import{S as Wl}from"./setupLogin-E3ihCDcV.js";import{V as Zl}from"./forwardRefs-6kFxDqtx.js";import{u as Lt}from"./nil-rxyd0N8M.js";import{V as ra,a as en}from"./VTable-OpZ-zk7X.js";import"./index-OKsbKlsK.js";import"./VFileInput-9Y4mbHg7.js";import"./createSimpleFunctional-geOekM0A.js";import"./VToolbarItems-neag9IZa.js";var Ne=(e=>(e.ADMIN_LAYOUT_PANELS="ADMIN_LAYOUT_PANELS",e.ADMIN_LAYOUT_TABLE="ADMIN_LAYOUT_TABLE",e))(Ne||{});const tn=[{title:"Panel Layout",value:"ADMIN_LAYOUT_PANELS"},{title:"Table Layout",value:"ADMIN_LAYOUT_TABLE"}];var Ce=(e=>(e.LAYOUT_ITEM_SOURCE_FORM="LAYOUT_ITEM_SOURCE_FORM",e.LAYOUT_ITEM_SOURCE_META="LAYOUT_ITEM_SOURCE_META",e.LAYOUT_ITEM_SOURCE_USER="LAYOUT_ITEM_SOURCE_USER",e))(Ce||{});const an=[{title:"Form Field Submission Data",value:"LAYOUT_ITEM_SOURCE_FORM"},{title:"Miscellaneous Data",value:"LAYOUT_ITEM_SOURCE_META"},{title:"User Profile Data",value:"LAYOUT_ITEM_SOURCE_USER"}];var H=(e=>(e.META_DATA_SOURCE_NULL="",e.META_DATA_SOURCE_ACCOMMODATION_ALLOCATION="META_DATA_SOURCE_ACCOMMODATION_ALLOCATION",e.META_DATA_SOURCE_ACCOMMODATION_FORM="META_DATA_SOURCE_ACCOMMODATION_FORM",e.META_DATA_SOURCE_ADMIN_FORM="META_DATA_SOURCE_ADMIN_FORM",e.META_DATA_SOURCE_BADGE_DISPLAY="META_DATA_SOURCE_BADGE_DISPLAY",e.META_DATA_SOURCE_BADGE_FORM="META_DATA_SOURCE_BADGE_FORM",e.META_DATA_SOURCE_CHECKIN_CONTROL="META_DATA_SOURCE_CHECKIN_CONTROL",e.META_DATA_SOURCE_CHECKIN_STATUS="META_DATA_SOURCE_CHECKIN_STATUS",e.META_DATA_SOURCE_DATA_LAYOUT="META_DATA_SOURCE_DATA_LAYOUT",e.META_DATA_SOURCE_DEALER_FORM="META_DATA_SOURCE_DEALER_FORM",e.META_DATA_SOURCE_EMAILS="META_DATA_SOURCE_EMAILS",e.META_DATA_SOURCE_NOTES="META_DATA_SOURCE_NOTES",e.META_DATA_SOURCE_PAYMENT_STATUS="META_DATA_SOURCE_PAYMENT_STATUS",e.META_DATA_SOURCE_PAYMENTS="META_DATA_SOURCE_PAYMENTS",e.META_DATA_SOURCE_REGISTRATION_ACTIONS="META_DATA_SOURCE_REGISTRATION_ACTIONS",e.META_DATA_SOURCE_REGISTRATION_FORM="META_DATA_SOURCE_REGISTRATION_FORM",e.META_DATA_SOURCE_REGISTRATION_GROUP="META_DATA_SOURCE_REGISTRATION_GROUP",e.META_DATA_SOURCE_REGISTRATION_REFERENCE="META_DATA_SOURCE_REGISTRATION_REFERENCE",e.META_DATA_SOURCE_REGISTRATION_TOOLS_DROP="META_DATA_SOURCE_REGISTRATION_TOOLS_DROP",e.META_DATA_SOURCE_SUBMISSION_DATE="META_DATA_SOURCE_SUBMISSION_DATE",e.META_DATA_SOURCE_SUBMISSION_STATUS="META_DATA_SOURCE_SUBMISSION_STATUS",e.META_DATA_SOURCE_TAGS="META_DATA_SOURCE_TAGS",e))(H||{});const ln=[{title:"Accommodation Allocation",value:"META_DATA_SOURCE_ACCOMMODATION_ALLOCATION"},{title:"Accommodation Form",value:"META_DATA_SOURCE_ACCOMMODATION_FORM"},{title:"Actions",value:"META_DATA_SOURCE_REGISTRATION_ACTIONS"},{title:"Actions Dropdown",value:"META_DATA_SOURCE_REGISTRATION_TOOLS_DROP"},{title:"Badge Display",value:"META_DATA_SOURCE_BADGE_DISPLAY"},{title:"Badge Form",value:"META_DATA_SOURCE_BADGE_FORM"},{title:"Check In Control",value:"META_DATA_SOURCE_CHECKIN_CONTROL"},{title:"Check In Status",value:"META_DATA_SOURCE_CHECKIN_STATUS"},{title:"Data Display",value:"META_DATA_SOURCE_DATA_LAYOUT"},{title:"Dealer Form",value:"META_DATA_SOURCE_DEALER_FORM"},{title:"Emails",value:"META_DATA_SOURCE_EMAILS"},{title:"Notes",value:"META_DATA_SOURCE_NOTES"},{title:"Payment Status",value:"META_DATA_SOURCE_PAYMENT_STATUS"},{title:"Payments",value:"META_DATA_SOURCE_PAYMENTS"},{title:"Registration Group",value:"META_DATA_SOURCE_REGISTRATION_GROUP"},{title:"Registration Reference",value:"META_DATA_SOURCE_REGISTRATION_REFERENCE"},{title:"Registration Form",value:"META_DATA_SOURCE_REGISTRATION_FORM"},{title:"Submission Date",value:"META_DATA_SOURCE_SUBMISSION_DATE"},{title:"Submission Status",value:"META_DATA_SOURCE_SUBMISSION_STATUS"},{title:"Tags",value:"META_DATA_SOURCE_TAGS"}];var ye=(e=>(e.PANEL_STYLE_FLEX="PANEL_STYLE_FLEX",e.PANEL_STYLE_NAV_BOTTOM="PANEL_STYLE_NAV_BOTTOM",e.PANEL_STYLE_NAV_LEFT="PANEL_STYLE_NAV_LEFT",e.PANEL_STYLE_NAV_RIGHT="PANEL_STYLE_NAV_RIGHT",e.PANEL_STYLE_NAV_TOP="PANEL_STYLE_NAV_TOP",e))(ye||{});const nn=[{title:"Body Flexible",value:"PANEL_STYLE_FLEX"},{title:"Fixed Bottom",value:"PANEL_STYLE_NAV_BOTTOM"},{title:"Fixed Left",value:"PANEL_STYLE_NAV_LEFT"},{title:"Fixed Right",value:"PANEL_STYLE_NAV_RIGHT"},{title:"Fixed Top",value:"PANEL_STYLE_NAV_TOP"}];var ne=(e=>(e.USER_DATA_SOURCE_NULL="",e.USER_DATA_SOURCE_AVATAR="USER_DATA_SOURCE_AVATAR",e.USER_DATA_SOURCE_CONTACTS="USER_DATA_SOURCE_CONTACTS",e.USER_DATA_SOURCE_DATE_OF_BIRTH="USER_DATA_SOURCE_DATE_OF_BIRTH",e.USER_DATA_SOURCE_DISPLAY_NAME="USER_DATA_SOURCE_DISPLAY_NAME",e.USER_DATA_SOURCE_EMAIL="USER_DATA_SOURCE_EMAIL",e.USER_DATA_SOURCE_FIRST_NAME="USER_DATA_SOURCE_FIRST_NAME",e.USER_DATA_SOURCE_HANDLE="USER_DATA_SOURCE_HANDLE",e.USER_DATA_SOURCE_LAST_NAME="USER_DATA_SOURCE_LAST_NAME",e.USER_DATA_SOURCE_TELEGRAM="USER_DATA_SOURCE_TELEGRAM",e))(ne||{});const on=[{title:"Avatar",value:"USER_DATA_SOURCE_AVATAR"},{title:"Contact Details",value:"USER_DATA_SOURCE_CONTACTS"},{title:"Date of Birth",value:"USER_DATA_SOURCE_DATE_OF_BIRTH"},{title:"Email Address",value:"USER_DATA_SOURCE_EMAIL"},{title:"Display Name",value:"USER_DATA_SOURCE_DISPLAY_NAME"},{title:"First Name",value:"USER_DATA_SOURCE_FIRST_NAME"},{title:"Handle",value:"USER_DATA_SOURCE_HANDLE"},{title:"Last Name",value:"USER_DATA_SOURCE_LAST_NAME"},{title:"Telegram Username",value:"USER_DATA_SOURCE_TELEGRAM"}];var pe=(e=>(e.CHECK_IN_STATUS_PENDING="CHECK_IN_STATUS_PENDING",e.CHECK_IN_STATUS_COMPLETED="CHECK_IN_STATUS_COMPLETED",e.CHECK_IN_STATUS_REJECTED="CHECK_IN_STATUS_REJECTED",e.CHECK_IN_STATUS_REVOKED="CHECK_IN_STATUS_REVOKED",e))(pe||{});const sn=[{title:"Pending",value:"CHECK_IN_STATUS_PENDING"},{title:"Completed",value:"CHECK_IN_STATUS_COMPLETED"},{title:"Rejected",value:"CHECK_IN_STATUS_REJECTED"},{title:"Revoked",value:"CHECK_IN_STATUS_REVOKED"}],ze=e=>{var c;return((c=sn.find(n=>n.value===e))==null?void 0:c.title)||""},un=e=>{switch(e){case"EMAIL_STATUS_QUEUED":return"Queued";case"EMAIL_STATUS_QUEUE_ERROR":return"Processing";case"EMAIL_STATUS_QUEUE_FAILURE":return"Internal Error";case"EMAIL_STATUS_SENDING":return"Sending";case"EMAIL_STATUS_SENT":return"Sent";case"EMAIL_STATUS_SEND_ERROR":return"Failed to Send"}return"Unknown"},rn=e=>e===void 0?!1:yt(e,St.GROUP_TYPE_SYSTEM).ManageUsers,wt=e=>`${e.charAt(0).toUpperCase()}${e.slice(1)}`,dn=ll({itemsLength:{type:[Number,String],required:!0},...hl(),...Ol(),...kl()},"VDataTableServer"),mn=nl()({name:"VDataTableServer",props:dn(),emits:{"update:modelValue":e=>!0,"update:page":e=>!0,"update:itemsPerPage":e=>!0,"update:sortBy":e=>!0,"update:options":e=>!0,"update:expanded":e=>!0,"update:groupBy":e=>!0},setup(e,c){let{attrs:n,slots:s}=c;const{groupBy:r}=Vl(e),{sortBy:v,multiSort:U,mustSort:l}=bl(e),{page:i,itemsPerPage:u}=Ml(e),A=se(()=>parseInt(e.itemsLength,10)),{columns:f,headers:m}=Nl(e,{groupBy:r,showSelect:je(e,"showSelect"),showExpand:je(e,"showExpand")}),{items:d}=Ll(e,f),{toggleSort:D}=wl({sortBy:v,multiSort:U,mustSort:l,page:i}),{opened:k,isGroupOpen:N,toggleGroup:C,extractRows:g}=Fl({groupBy:r,sortBy:v}),{pageCount:h,setItemsPerPage:p}=Pl({page:i,itemsPerPage:u,itemsLength:A}),{flatItems:Z}=$l(d,r,k),{isSelected:z,select:re,selectAll:$,toggleSelect:Y,someSelected:G,allSelected:B}=Bl(e,{allItems:d,currentPage:d}),{isExpanded:w,toggleExpand:ee}=Gl(e),ve=se(()=>g(d.value));Yl({page:i,itemsPerPage:u,sortBy:v,groupBy:r,search:je(e,"search")}),ol("v-data-table",{toggleSort:D,sortBy:v}),il({VDataTableRows:{hideNoData:je(e,"hideNoData"),noDataText:je(e,"noDataText"),loading:je(e,"loading"),loadingText:je(e,"loadingText")}});const ie=se(()=>({page:i.value,itemsPerPage:u.value,sortBy:v.value,pageCount:h.value,toggleSort:D,setItemsPerPage:p,someSelected:G.value,allSelected:B.value,isSelected:z,select:re,selectAll:$,toggleSelect:Y,isExpanded:w,toggleExpand:ee,isGroupOpen:N,toggleGroup:C,items:ve.value.map(De=>De.raw),internalItems:ve.value,groupedItems:Z.value,columns:f.value,headers:m.value}));Il(()=>{const De=ia.filterProps(e),tt=sa.filterProps(e),at=ua.filterProps(e),lt=ra.filterProps(e);return t(ra,Tt({class:["v-data-table",{"v-data-table--loading":e.loading},e.class],style:e.style},lt),{top:()=>{var Re;return(Re=s.top)==null?void 0:Re.call(s,ie.value)},default:()=>{var Re,Be,Ge,Ye,He,Se;return s.default?s.default(ie.value):t(L,null,[(Re=s.colgroup)==null?void 0:Re.call(s,ie.value),t("thead",{class:"v-data-table__thead",role:"rowgroup"},[t(sa,Tt(tt,{sticky:e.fixedHeader}),s)]),(Be=s.thead)==null?void 0:Be.call(s,ie.value),t("tbody",{class:"v-data-table__tbody",role:"rowgroup"},[(Ge=s["body.prepend"])==null?void 0:Ge.call(s,ie.value),s.body?s.body(ie.value):t(ua,Tt(n,at,{items:Z.value}),s),(Ye=s["body.append"])==null?void 0:Ye.call(s,ie.value)]),(He=s.tbody)==null?void 0:He.call(s,ie.value),(Se=s.tfoot)==null?void 0:Se.call(s,ie.value)])},bottom:()=>s.bottom?s.bottom(ie.value):t(ia,De,{prepend:s["footer.prepend"]})})})}}),cn=F("br",null,null,-1),vn=F("h3",null,"Assigned Accommodation",-1),fn=F("br",null,null,-1),Un=F("br",null,null,-1),An=F("h3",null,"Accommodation Preferences",-1),Tn=F("h3",null,"Selected Tickets",-1),gn=F("br",null,null,-1),_n=Q({__name:"EditAccommodationAssignmentDialog",props:X({convention:{},registration:{},selectedAccommodation:{},title:{}},{modelValue:{type:Boolean,required:!0},modelModifiers:{}}),emits:X(["update:field"],["update:modelValue"]),setup(e,{emit:c}){const n=e,{convention:s,registration:r,title:v=""}=n,U=c,l=Ae(),i=le(e,"modelValue"),u=_({capacity:{max:Y=>{var w;const G=p.value.find(ee=>ee.room.RoomUUID===Y);return!G||G.room.MaximumCapacity===0?!0:(((w=d.value)==null?void 0:w.Members.length)||0)<=G.room.MaximumCapacity||"Too many people in the group for this room"},min:Y=>{var w;const G=p.value.find(ee=>ee.room.RoomUUID===Y);return!G||G.room.MinimumCapacity===0?!0:(((w=d.value)==null?void 0:w.Members.length)||0)>=G.room.MinimumCapacity||"Not enough people in the group for this room"}}}),A=_([]),f=vt(n,U,void 0,void 0,"field"),m=_(_e(f.value));Ue(f,()=>{m.value=_e(f.value)});const d=_(),D=_(""),k=_(""),N=_([]),C=_({Ticket:[],AddonsChecked:[],ComponentsChecked:[]}),g=async()=>{var w;const Y=await l.getConventionAvailableAccommodation(s.ConventionUUID);Y&&(A.value=Y);const G=await l.getRegistrationGroup(r.RegistrationUUID||"");G&&(d.value=G);const B=await l.getConventionTickets(s.ConventionUUID);B&&(N.value=B);try{C.value=JSON.parse(((w=d.value)==null?void 0:w.TicketData)||"")}catch{}};Ue(D,()=>{k.value=p.value.length>0?p.value[0].value:""});const h=se(()=>{const Y=Z.value;return A.value.map(G=>{let B;return Y.forEach(w=>{G.Costs.forEach(ee=>{ee.DateStart===(w==null?void 0:w.DateStart)&&ee.DateEnd===w.DateEnd&&(B===void 0||B>ee.Availability)&&(B=ee.Availability)})}),{label:`${G.Name}`,title:`${G.Name} (${B} Available)`,value:G.AccommodationUUID}})}),p=se(()=>{const Y=Z.value,G=A.value.find(B=>B.AccommodationUUID===D.value);return(G==null?void 0:G.Pool.map(B=>{var ee,ve;let w;return Y.forEach(ie=>{B.Costs.forEach(De=>{De.DateStart===(ie==null?void 0:ie.DateStart)&&De.DateEnd===ie.DateEnd&&(w===void 0||w>De.Availability)&&(w=De.Availability)})}),{label:`${(ee=B.Venue)==null?void 0:ee.Name} - ${B.Name}`,title:`${(ve=B.Venue)==null?void 0:ve.Name} - ${B.Name} (${w} Available)`,value:B.RoomUUID,room:B}}))||[]}),Z=se(()=>[...C.value.Ticket,...C.value.AddonsChecked,...C.value.ComponentsChecked].map(Y=>N.value.find(G=>G.TicketUUID===Y)).filter(Y=>Y!==void 0&&Y.RequiresAccommodation)),z=Y=>{var G;l.assignAccommodation(((G=d.value)==null?void 0:G.Registration.RegistrationUUID)||"",D.value,k.value,!1).then(B=>{B?(g(),Y&&Y("Room Assigned")):Y&&Y("Room not assigned")}).catch(()=>{Y&&Y("Room not assigned")})},re=Y=>{var G,B;(G=d.value)!=null&&G.Registration.AllocationUUID?l.deleteAllocation(((B=d.value)==null?void 0:B.Registration.AllocationUUID)||"").then(w=>{w?(g(),Y&&Y("Allocation Deleted")):Y&&Y("Allocation not deleted")}).catch(()=>{Y&&Y("Allocation not deleted")}):Y&&Y("Nothing to Delete")},$=Y=>{var B,w;const G=(B=A.value.find(ee=>ee.AccommodationUUID===Y.AccommodationUUID))==null?void 0:B.Pool;if(G){const ee=G.find(ve=>ve.RoomUUID===Y.RoomUUID);if(ee)return`${(w=ee.Venue)==null?void 0:w.Name} - ${ee.Name}`}return""};return g(),(Y,G)=>{var B;return o(),S(we,{modelValue:i.value,"onUpdate:modelValue":G[2]||(G[2]=w=>i.value=w),title:E(v),color:"primary","show-close-action":!0,"show-delete-action":!!((B=d.value)!=null&&B.Registration.Allocation),"show-save-action":!!k.value,"save-button-label":"Assign Room",onDelete:re,onSave:z,fullscreen:!0,persistent:!0},{default:a(()=>[t(ce,{class:"pa-0",fluid:!0},{default:a(()=>[t(J,null,{default:a(()=>{var w;return[t(V,{cols:"12",md:"6"},{default:a(()=>{var ee,ve;return[F("h3",null,"Group Members ("+I((ee=d.value)==null?void 0:ee.Members.length)+")",1),(o(!0),T(L,null,W((ve=d.value)==null?void 0:ve.Members,ie=>(o(),T(L,{key:ie.UUID},[O(" #"+I(ie.Reference)+" "+I(ie.Name),1),cn],64))),128))]}),_:1}),(w=d.value)!=null&&w.Registration.Allocation?(o(),S(V,{key:0,cols:"12",md:"6"},{default:a(()=>[vn,t(Le,null,{default:a(()=>{var ee;return[(o(!0),T(L,null,W((ee=d.value)==null?void 0:ee.Registration.Allocation.Periods,ve=>(o(),S(Ve,{key:ve.AllocationPeriodUUID},{default:a(()=>{var ie;return[O(I((ie=A.value.find(De=>De.AccommodationUUID===ve.AccommodationUUID))==null?void 0:ie.Name)+" ",1),fn,O(" "+I($(ve))+" ",1),Un,F("small",null,"("+I(E(Oe)(ve.DateStart))+" - "+I(E(Oe)(ve.DateEnd))+")",1)]}),_:2},1024))),128))]}),_:1})]),_:1})):M("",!0)]}),_:1}),t(J,null,{default:a(()=>[t(V,{cols:"12",md:"6"},{default:a(()=>[Y.selectedAccommodation.length?(o(),T(L,{key:0},[An,t(Le,null,{default:a(()=>[(o(!0),T(L,null,W(Y.selectedAccommodation,(w,ee)=>(o(),S(Ve,{key:w.AccommodationUUID},{default:a(()=>[O(I(ee+1)+". "+I(w.Name),1)]),_:2},1024))),128))]),_:1})],64)):M("",!0)]),_:1}),t(V,{cosl:"12",md:"6"},{default:a(()=>[Tn,t(Le,null,{default:a(()=>[(o(!0),T(L,null,W(Z.value,w=>(o(),S(Ve,{key:w==null?void 0:w.TicketUUID},{default:a(()=>[O(I(w.Name)+" ",1),gn,F("small",null,"("+I(E(Oe)(w.DateStart))+" - "+I(E(Oe)(w.DateEnd))+")",1)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1}),t(J,null,{default:a(()=>[t(V,{cols:"12",md:"6"},{default:a(()=>[t(fe,{modelValue:D.value,"onUpdate:modelValue":G[0]||(G[0]=w=>D.value=w),items:h.value,"item-title":"title","item-value":"value",label:"Accommodation"},null,8,["modelValue","items"])]),_:1}),t(V,{cols:"12",md:"6"},{default:a(()=>[t(fe,{modelValue:k.value,"onUpdate:modelValue":G[1]||(G[1]=w=>k.value=w),items:p.value,"item-title":"title","item-value":"value",label:"Room Pool",rules:[u.value.capacity.min,u.value.capacity.max]},null,8,["modelValue","items","rules"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue","title","show-delete-action","show-save-action"])}}}),En=e=>(xt("data-v-33548a38"),e=e(),qt(),e),pn={key:0,class:"accommodationList"},Dn={key:0,class:"text-orange-darken-2"},Sn={key:1,class:"accommodationList"},yn=En(()=>F("br",null,null,-1)),In=Q({__name:"DataTableItemAccommodation",props:{accommodations:{default:()=>[]},convention:{},forms:{},registration:{},tickets:{default:()=>[]},value:{default:""},venues:{}},setup(e){const c=$e(),n=Dt(c,e.convention),s=_(!1),r=se(()=>e.registration.Allocation.Periods.map(l=>{var i;return{DateStart:l.DateStart,DateEnd:l.DateEnd,Accommodation:l.Accommodation||((i=e.accommodations)==null?void 0:i.find(u=>u.AccommodationUUID==l.AccommodationUUID))}}).sort((l,i)=>l.DateStart>i.DateStart?1:l.DateStart==i.DateStart?0:-1));e.registration&&e.registration.Allocation&&e.registration.Allocation.Periods&&e.registration.Allocation.Periods.forEach(l=>{var u;if(l.Accommodation)return;const i=(u=e.accommodations)==null?void 0:u.find(A=>A.AccommodationUUID==l.AccommodationUUID);i&&(l.Accommodation=i)});const v=se(()=>{if(!e.value)return[];const l=JSON.parse(e.value),i=e.accommodations.filter(u=>l.includes(u.AccommodationUUID)).sort((u,A)=>{const f=l.findIndex(d=>d===u.AccommodationUUID),m=l.findIndex(d=>d===A.AccommodationUUID);return f>m?1:-1});return _e(i)}),U=se(()=>{let l;const i=e.forms.find(u=>!!u.Sections.find(A=>{var f;return A.Fields?!!((f=A.Fields)!=null&&f.find(m=>{var d;return((d=m.Field)==null?void 0:d.Type)==="TICKET"?(l=m,!0):!1})):!1}));return l?!!e.registration.Submissions.find(u=>{if(u.FormUUID==(i==null?void 0:i.FormUUID))return!!u.Data.find(A=>{if(A.SectionFieldUUID==(l==null?void 0:l.SectionFieldUUID)){const f=JSON.parse(A.Data);return e.tickets.filter(m=>m.RequiresAccommodation).find(m=>f.Ticket.includes(m.TicketUUID)||f.AddonsChecked.includes(m.TicketUUID)||f.ComponentsChecked.includes(m.TicketUUID))}})}):!1});return(l,i)=>U.value?(o(),T(L,{key:0},[l.value?(o(),T("ol",pn,[(o(!0),T(L,null,W(v.value,u=>(o(),T("li",{key:u.AccommodationUUID},[l.registration&&l.registration.Allocation&&l.registration.Allocation.Periods.find(A=>A.AccommodationUUID===u.AccommodationUUID)?(o(),T("strong",Dn,I(u.Name),1)):(o(),T(L,{key:1},[O(I(u.Name),1)],64))]))),128))])):(o(),T("ul",Sn,[(o(!0),T(L,null,W(r.value,u=>{var A;return o(),T("li",{key:u.DateStart},[O(I((A=u.Accommodation)==null?void 0:A.Name)+" ("+I(E(Oe)(u.DateStart))+" - "+I(E(Oe)(u.DateEnd))+")",1),yn])}),128))])),E(n)?(o(),S(K,{key:2,onClick:i[0]||(i[0]=u=>s.value=!0),variant:"flat",color:"success"},{default:a(()=>[O("Assign Accommodation")]),_:1})):M("",!0),l.convention&&s.value?(o(),S(_n,{key:3,modelValue:s.value,"onUpdate:modelValue":i[1]||(i[1]=u=>s.value=u),title:"Accommodation Allocation",convention:l.convention,registration:l.registration,tickets:l.tickets,"selected-accommodation":v.value},null,8,["modelValue","convention","registration","tickets","selected-accommodation"])):M("",!0)],64)):M("",!0)}}),ba=ct(In,[["__scopeId","data-v-33548a38"]]),Cn={key:0,class:"addonList"},Rn={key:0},hn={key:0},On=Q({__name:"DataTableItemExtras",props:{extras:{default:()=>[]},value:{default:""}},setup(e){const c=se(()=>{if(!e.value)return;const n=JSON.parse(e.value),s=Object.keys(n),r=_e(e.extras);return r.forEach(v=>{v.Options=v.Options.filter(U=>s.includes(U.OptionUUID)?(U.Choices=U.Choices.filter(l=>l.TagUUID===n[U.OptionUUID].choiceId),n[U.OptionUUID].checked):!1)}),r.filter(v=>v.Options.length>0),r});return(n,s)=>n.value?(o(),T("ul",Cn,[(o(!0),T(L,null,W(c.value,r=>(o(),T(L,{key:r.ExtraUUID},[r.Options.length?(o(),T("li",Rn,[F("strong",null,I(r.Name),1),F("ul",null,[(o(!0),T(L,null,W(r.Options,v=>(o(),T("li",{key:v.OptionUUID},[O(I(v.Name)+" ",1),v.Choices.length==1?(o(),T("small",hn,"("+I(v.Choices[0].Title)+")",1)):M("",!0)]))),128))])])):M("",!0)],64))),128))])):M("",!0)}}),Ma=ct(On,[["__scopeId","data-v-55786e01"]]),kn={key:0},Na=Q({__name:"DataTableItemInterests",props:{interests:{default:()=>[]},value:{default:""}},setup(e){const c=se(()=>{if(!e.value)return;const n=JSON.parse(e.value);return Object.entries(n).filter(([,s])=>s).map(([s,r])=>e.interests.find(v=>v.InterestUUID===s)).filter(s=>s!==void 0)});return(n,s)=>n.value?(o(),T("ul",kn,[(o(!0),T(L,null,W(c.value,r=>(o(),T("li",{key:r.InterestUUID},I(r.Name),1))),128))])):M("",!0)}}),Vn=F("br",null,null,-1),bn=F("small",null,"Options:",-1),Mn=F("br",null,null,-1),Nn=F("small",null,"Addons:",-1),La=Q({__name:"DataTableItemTicket",props:{tickets:{default:()=>[]},value:{default:""}},setup(e){const c=se(()=>{if(!e.value)return;let n={Ticket:[],AddonsChecked:[],ComponentsChecked:[]};try{n=JSON.parse(e.value),"ticket"in n&&(n.Ticket=n.ticket),"addonsChecked"in n&&(n.AddonsChecked=n.addonsChecked),"componentsChecked"in n&&(n.ComponentsChecked=n.componentsChecked)}catch{}return n.Ticket.filter(s=>{const r=e.tickets.find(v=>v.TicketUUID===s);return!(!r||r.Type!==_l.TICKET_TYPE_TICKET)}).map(s=>{const r=e.tickets.find(U=>U.TicketUUID===s),v=_e(r);return v.TicketComponents=r.TicketComponents.filter(U=>n.ComponentsChecked.includes(U.TicketUUID)),v.AddonTickets=r.AddonTickets.filter(U=>n.AddonsChecked.includes(U.TicketUUID)),v})});return(n,s)=>n.value?(o(!0),T(L,{key:0},W(c.value,r=>(o(),T("div",{key:r.TicketUUID},[F("strong",null,I(r.Name),1),r.TicketComponents.length>0?(o(),T(L,{key:0},[Vn,bn,O("  "),(o(!0),T(L,null,W(r.TicketComponents,v=>(o(),T(L,{key:v.TicketUUID},[F("small",null,I(v.Name),1),O("  ")],64))),128))],64)):M("",!0),r.AddonTickets.length>0?(o(),T(L,{key:1},[Mn,Nn,O("  "),(o(!0),T(L,null,W(r.AddonTickets,v=>(o(),T("small",{key:v.TicketUUID},[O("("),F("em",null,I(v.Name),1),O(")")]))),128))],64)):M("",!0)]))),128)):M("",!0)}}),wa=Q({__name:"DataPanelAccommodation",props:X({accommodations:{},convention:{},data:{},forms:{},tickets:{},venues:{},registration:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(e){return le(e,"modelValue"),(c,n)=>(o(),T("div",null,[t(ba,{value:c.data,accommodations:c.accommodations,convention:c.convention,forms:c.forms,registration:c.registration,tickets:c.tickets,venues:c.venues},null,8,["value","accommodations","convention","forms","registration","tickets","venues"])]))}}),Ln={key:0,class:"text-red-darken-4 font-weight-bold"},wn={key:1,class:"text-orange-darken-2 font-weight-bold"},Fn=Q({__name:"DataPanelAge",props:X({data:{},forms:{},registration:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(e){const c=le(e,"modelValue"),n=new Date,s=n.getFullYear(),r=(n.getMonth()+1).toLocaleString("en-US",{minimumIntegerDigits:2}),v=n.getDate().toLocaleString("en-US",{minimumIntegerDigits:2}),U=_(!1),l=_(`${s}-${r}-${v}`),i=_(18);e.forms.find(m=>m.Sections.find(d=>d.Fields?d.Fields.find(D=>{var k;return D.SectionFieldUUID===c.value.SectionFieldUUID?(c.value.SectionField=D,(k=D.Field)==null||k.Values.forEach(N=>{switch(N.Title){case"UNDER_AGE_APPLY_TAG":N.Value.length>0&&(U.value=!0);break;case"BEFORE_DATE":l.value=N.Value;break;case"MIN_AGE":i.value=parseInt(N.Value);break}}),!0):!1}):!1));const u=m=>({registration:A(m,e.registration.CreatedAt||"",i.value),convention:A(m,l.value,i.value)}),A=(m,d,D)=>{if(m>=d)return!1;const k=f(m),C=f(d).getTime()-k.getTime(),g=1e3*60*60*24*365.25;return C/g>=D},f=m=>{const[d,D,k]=m.split("-");return new Date(parseInt(d),parseInt(D)-1,parseInt(k))};return(m,d)=>(o(),T("div",null,[F("p",null,[O(I(E(Oe)(m.data,{withDay:!1,withYear:!0}))+" ",1),U.value&&u(m.data).convention&&u(m.data).registration?(o(),S(ke,{key:0,icon:"mdi:mdi-check",color:"success"})):U.value&&!u(m.data).convention?(o(),S(ke,{key:1,icon:"mdi:mdi-alert",color:"error"})):U.value&&u(m.data).convention&&!u(m.data).registration?(o(),S(ke,{key:2,icon:"mdi:mdi-alert",color:"warning"})):M("",!0)]),U.value?(o(),T(L,{key:0},[u(m.data).convention?u(m.data).registration?M("",!0):(o(),T("p",wn," Attendee was under "+I(i.value)+" at time of registration ",1)):(o(),T("p",Ln," Attendee is under "+I(i.value),1))],64)):M("",!0)]))}}),Fa=(e,c)=>e===void 0?!1:yt(e,St.GROUP_TYPE_CONVENTION,c.ConventionUUID,c).CheckIn,Pn={key:0,class:"font-weight-bold pt-2"},Jt=Q({__name:"Badges",props:{cardClass:{default:""},convention:{},hideDownload:{type:Boolean,default:!1},hideNfc:{type:Boolean,default:!1},registration:{},showTitle:{type:Boolean,default:!0}},setup(e){const c=Ae(),n=It(),s=_([]);let r;const v=sl();v&&"$NDEFReader"in v.appContext.config.globalProperties&&(r=v.appContext.config.globalProperties.$NDEFReader);const U=_(!!r),l=_(e.registration.BadgeSerialNumber),i=_(""),u=_(!1),A=_(2),f=$e();let m=!1,d=!1;e.convention&&(m=Fa(f,e.convention),d=Dt(f,e.convention));const D=C=>{var h;const g=document.createElement("a");g.download=`${((h=e.convention)==null?void 0:h.Name)||""} Badge Image - ${e.registration.Reference} - ${e.registration.User.DisplayName}.jpg`,g.href=C,document.body.appendChild(g),g.click(),document.body.removeChild(g)},k=async C=>n.GetConBadgeImageURL(e.registration.RegistrationUUID,C),N=()=>{if(U.value)try{const C=new r;C.addEventListener("readingerror",()=>{i.value="Error Reading Card",u.value=!0}),C.addEventListener("reading",g=>{if(g.serialNumber){const h=g.serialNumber;i.value="Obtained Card Details",u.value=!0,l.value=h,c.setBadgeSerial(e.registration.RegistrationUUID,l.value).then(p=>{p?(i.value="Badge Serial Saved",u.value=!0):(i.value="Failed to Save Badge Serial",u.value=!0)})}else i.value="Serial Number not Found",u.value=!0}),C.scan&&C.scan()}catch{}};return c.getConBadgeList(e.registration.RegistrationUUID).then(C=>{C.forEach(g=>{k(g).then(h=>{s.value.push({template:g,url:h})})})}).catch(()=>{}),(C,g)=>(o(!0),T(L,null,W(s.value,h=>(o(),S(Pe,{key:h.template,class:Xe(C.cardClass)},{default:a(()=>[t(it,null,{default:a(()=>[C.showTitle?(o(),S(Ze,{key:0,class:"text-center"},{default:a(()=>[O(" Badges (#"+I(C.registration.Reference)+" "+I(C.registration.User.DisplayName)+") ",1)]),_:1})):M("",!0)]),_:1}),t(et,{class:"text-center"},{default:a(()=>[t(zt,{class:"d-block ma-auto",src:h.url,height:"280",width:"280"},null,8,["src"]),l.value?(o(),T("p",Pn,I(l.value),1)):M("",!0)]),_:2},1024),!C.hideDownload||!C.hideNfc?(o(),S(jt,{key:0,class:"justify-center"},{default:a(()=>[!C.hideNfc&&U.value&&(E(d)||E(m))?(o(),S(K,{key:0,"prepend-icon":"mdi:mdi-nfc",color:"warning",variant:"flat",onClick:N},{default:a(()=>[O("Link Card")]),_:1})):M("",!0),C.hideDownload?M("",!0):(o(),S(K,{key:1,color:"primary","prepend-icon":"mdi:mdi-download",variant:"flat",onClick:p=>D(h.url)},{default:a(()=>[O("Download")]),_:2},1032,["onClick"]))]),_:2},1024)):M("",!0),t(Rl,{modelValue:u.value,"onUpdate:modelValue":g[0]||(g[0]=p=>u.value=p),message:i.value,timeout:A.value*1e3},null,8,["modelValue","message","timeout"])]),_:2},1032,["class"]))),128))}}),$n=Q({__name:"DataPanelText",props:X({convention:{},data:{},forms:{}},{modelValue:{required:!0},modelModifiers:{},registration:{required:!0},registrationModifiers:{}}),emits:["update:modelValue","update:registration"],setup(e){const c=le(e,"modelValue"),n=le(e,"registration"),s=_(e.data),r=se(()=>i.value?"":s.value!==e.data?"mdi:mdi-content-save":""),v=$e(),U=Ae(),l=_(Dt(v,e.convention)),i=_(!1),u=()=>{i.value=!0,U.directEditFieldData(n.value.RegistrationUUID,c.value.LayoutItemUUID,s.value).then(A=>{A&&n.value.Submissions.find(f=>!!f.Data.find(m=>{if(m.SectionFieldUUID===c.value.SectionFieldUUID)return m.Data=A,!0})),i.value=!1}).catch(()=>{})};return(A,f)=>c.value.Meta.DirectEdit&&(l.value||c.value.Meta.DirectEditPermission==="View")?(o(),S(oe,{key:0,modelValue:s.value,"onUpdate:modelValue":f[0]||(f[0]=m=>s.value=m),"append-inner-icon":r.value,"onClick:appendInner":u},We({_:2},[i.value?{name:"append-inner",fn:a(()=>[t(Da,{color:"primary",indeterminate:"",size:30})]),key:"0"}:void 0]),1032,["modelValue","append-inner-icon"])):(o(),T(L,{key:1},[O(I(A.data),1)],64))}}),Bn={key:4},Gn={key:8},Yn=Q({__name:"FormDataItem",props:X({accommodations:{},convention:{},extras:{},forms:{},interests:{},itemClass:{},tickets:{},venues:{}},{modelValue:{required:!0},modelModifiers:{},registration:{required:!0},registrationModifiers:{}}),emits:["update:modelValue","update:registration"],setup(e){const c=le(e,"modelValue"),n=le(e,"registration"),s=se(()=>{var f,m,d,D;const u=c.value,A=()=>{var k;for(let N=0;N<e.forms.length;N+=1)for(let C=0;C<e.forms[N].Sections.length;C+=1)if(e.forms[N].Sections[C].Fields){const g=(k=e.forms[N].Sections[C].Fields)==null?void 0:k.find(h=>h.SectionFieldUUID===u.SectionFieldUUID);if(g)return g}};return((m=(f=u.SectionField)==null?void 0:f.Field)==null?void 0:m.Type)||((D=(d=A())==null?void 0:d.Field)==null?void 0:D.Type)}),r=se(()=>{for(let u=0;u<n.value.Submissions.length;u+=1){const f=n.value.Submissions[u].Data.find(m=>m.SectionFieldUUID===c.value.SectionFieldUUID);if(f)return f.Data}return""}),v=Ae(),U=It(),l=_(""),i=_("");if(s.value==="BADGE_IMAGE")try{const u=JSON.parse(r.value||"{}");u.fileUUID&&(i.value=U.GetBadgeImageURL(u.fileUUID)),n.value&&v.getConBadgeDisplayName(n.value.RegistrationUUID).then(A=>{A&&(l.value=A)}).catch(()=>{})}catch{}return(u,A)=>s.value==="ACCOMMODATION"?(o(),S(wa,{key:0,convention:u.convention,tickets:u.tickets,accommodations:u.accommodations,venues:u.venues,registration:n.value,forms:u.forms,modelValue:c.value,"onUpdate:modelValue":A[0]||(A[0]=f=>c.value=f),data:r.value},null,8,["convention","tickets","accommodations","venues","registration","forms","modelValue","data"])):s.value==="EXTRAS"?(o(),S(Ma,{key:1,value:r.value,extras:u.extras},null,8,["value","extras"])):s.value==="TICKET"?(o(),S(La,{key:2,value:r.value,tickets:u.tickets},null,8,["value","tickets"])):s.value==="INTERESTS"?(o(),S(Na,{key:3,value:r.value,interests:u.interests},null,8,["value","interests"])):s.value==="CHECKBOX"?(o(),T("div",Bn,[r.value?(o(),S(ke,{key:0,icon:"mdi:mdi-check",color:"success"})):(o(),S(ke,{key:1,icon:"mdi:mdi-close",color:"error"}))])):s.value==="AGE"?(o(),S(Fn,{key:5,data:r.value,forms:u.forms,registration:n.value,modelValue:c.value,"onUpdate:modelValue":A[1]||(A[1]=f=>c.value=f)},null,8,["data","forms","registration","modelValue"])):s.value==="BADGE_IMAGE"?(o(),S(Jt,{key:6,convention:u.convention,registration:n.value,"show-title":!1,"card-class":u.itemClass},null,8,["convention","registration","card-class"])):s.value==="TEXT"?(o(),S($n,{key:7,convention:u.convention,data:r.value,forms:u.forms,modelValue:c.value,"onUpdate:modelValue":A[2]||(A[2]=f=>c.value=f),registration:n.value,"onUpdate:registration":A[3]||(A[3]=f=>n.value=f)},null,8,["convention","data","forms","modelValue","registration"])):(o(),T("div",Gn,I(r.value),1))}}),Hn={key:0},xn={key:0},qn=F("strong",null,"Total:",-1),Kn=Q({__name:"DataPanelRegistrationGroup",props:{registration:{}},setup(e){const c=se(()=>{const n=[];let s;return e.registration.Leader?s=e.registration:s=e.registration.Primary,n.push({Name:s.User.DisplayName,UUID:s.UserUUID,UserUUID:s.User.UserUUID,IsLeader:!0,Reference:s.Reference,Paid:s.Paid,Total:s.Total}),n.push(...s.Members.map(r=>({Name:r.User.DisplayName,UUID:r.UserUUID,UserUUID:r.User.UserUUID,IsLeader:!1,Reference:r.Reference,Paid:r.Paid,Total:r.Total}))),n});return(n,s)=>n.registration.Members.length===0&&!n.registration.Primary?(o(),T("em",Hn," Not in a group ")):(o(),T(L,{key:1},[F("ul",null,[(o(!0),T(L,null,W(c.value,r=>(o(),T("li",{key:r.UUID,class:"ml-0"},[O(" #"+I(r.Reference)+" : "+I(r.Name)+" ",1),r.IsLeader?(o(),T("strong",xn,"(Leader)")):M("",!0)]))),128))]),qn,O(" "+I(c.value.length),1)],64))}}),jn=Q({__name:"DataPanelSubmissionDate",props:{registration:{}},setup(e){const c=se(()=>{const n=e.registration.Submissions.find(s=>{var r;return((r=s.Form)==null?void 0:r.Type)===ge.FORM_TYPE_REGISTRATION});return n?n.CreatedAt||"":e.registration.CreatedAt||""});return(n,s)=>(o(),T("div",null,I(E(Oe)(c.value,{withDay:!1,withYear:!0})),1))}}),zn={class:"text-grey-lighten-1"},Qn=Q({__name:"DataPanelSubmissionStatus",props:{convention:{},forms:{},registration:{}},emits:["showForm"],setup(e,{emit:c}){const n=c,s=$e(),r=Dt(s,e.convention),v=se(()=>e.registration.Submissions.map(i=>{const u=e.forms.find(A=>A.FormUUID===i.FormUUID);if(u)return{Heading:u.Heading,Form:u,Submission:i,Registration:e.registration}}).filter(i=>!!i)),U=(i,u,A)=>{n("showForm",i,u,A)},l=i=>({ID:0,SubmissionUUID:Ie(),FormID:i.ID,FormUUID:i.FormUUID,Form:i,UserID:e.registration.UserID,UserUUID:e.registration.UserUUID,RegistrationID:e.registration.ID,RegistrationUUID:e.registration.RegistrationUUID,Registration:e.registration,Data:[],Status:Ea.SUBMISSION_STATUS_NULL});return(i,u)=>(o(),T(L,null,[F("ul",null,[(o(!0),T(L,null,W(i.forms.filter(A=>A.Type===E(ge).FORM_TYPE_ADMIN&&v.value.findIndex(f=>f.Form.ID===A.ID)<0),A=>(o(),T("li",{key:A.Heading},[F("strong",zn,I(A.Heading),1),E(r)?(o(),S(K,{key:0,class:"text-grey-lighten-1",icon:"mdi:mdi-form-select",title:"Edit Submitted Data",variant:"flat",onClick:f=>U(i.registration,A,l(A))},null,8,["onClick"])):M("",!0)]))),128))]),F("ul",null,[(o(!0),T(L,null,W(v.value,A=>(o(),T("li",{key:A.Heading},[F("strong",null,[O(I(A.Heading),1),A.Form.Type!==E(ge).FORM_TYPE_ADMIN?(o(),T(L,{key:0},[O(": ")],64)):M("",!0)]),A.Form.Type!==E(ge).FORM_TYPE_ADMIN?(o(),T("span",{key:0,class:Xe(E(_a)(A.Submission.Status))},I(E(Kt)(A.Submission.Status)),3)):M("",!0),E(r)?(o(),S(K,{key:1,icon:"mdi:mdi-form-select",title:"Edit Submitted Data",variant:"flat",onClick:f=>U(A.Registration,A.Form,A.Submission)},null,8,["onClick"])):M("",!0)]))),128))])],64))}}),Jn={key:0,class:"text-blue"},Xn={key:1,class:"text-red"},Wn={key:2,class:"text-orange"},Zn={key:3,class:"text-orange"},eo={key:4,class:"text-orange"},to={key:5,class:"text-orange"},ao={key:6,class:"text-green"},lo=Q({__name:"DataPanelPaymentStatus",props:{registration:{}},setup(e){const c=se(()=>{if(e.registration.Paid===0&&e.registration.Total)return"REQUIRED";if(e.registration.Total>e.registration.Paid)return"ADDITIONAL_REQUIRED";const n=e.registration.Members.find(s=>s.Paid===0&&(s.Total||0)>0);return n?e.registration.Total===0&&n.Total===0?"NOT_REQUIRED":e.registration.Total===0&&n.Total||e.registration.Total>0&&n.Total===0?"MISSING_REQUIRED":e.registration.Paid>=e.registration.Total?"AWAITING_PARTNER":"ALL_REQUIRED":e.registration.Total===0?"NOT_REQUIRED":"COMPLETE"});return(n,s)=>c.value=="NOT_REQUIRED"?(o(),T("div",Jn,"No Payment Requested")):c.value=="MISSING_REQUIRED"?(o(),T("div",Xn,"Partner Payment Not Requested")):c.value=="AWAITING_PARTNER"?(o(),T("div",Wn,"Awaiting Partner Payment")):c.value=="ALL_REQUIRED"?(o(),T("div",Zn,"Awaiting Payments")):c.value=="REQUIRED"?(o(),T("div",eo,"Awaiting Payment")):c.value=="ADDITIONAL_REQUIRED"?(o(),T("div",to,"Awaiting Additional Payments")):(o(),T("div",ao,"Completed"))}});var no=["onActivate","onAddUndo","onBeforeAddUndo","onBeforeExecCommand","onBeforeGetContent","onBeforeRenderUI","onBeforeSetContent","onBeforePaste","onBlur","onChange","onClearUndos","onClick","onContextMenu","onCopy","onCut","onDblclick","onDeactivate","onDirty","onDrag","onDragDrop","onDragEnd","onDragGesture","onDragOver","onDrop","onExecCommand","onFocus","onFocusIn","onFocusOut","onGetContent","onHide","onInit","onKeyDown","onKeyPress","onKeyUp","onLoadContent","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp","onNodeChange","onObjectResizeStart","onObjectResized","onObjectSelected","onPaste","onPostProcess","onPostRender","onPreProcess","onProgressState","onRedo","onRemove","onReset","onSaveContent","onSelectionChange","onSetAttrib","onSetContent","onShow","onSubmit","onUndo","onVisualAid"],oo=function(e){return no.map(function(c){return c.toLowerCase()}).indexOf(e.toLowerCase())!==-1},io=function(e,c,n){Object.keys(c).filter(oo).forEach(function(s){var r=c[s];typeof r=="function"&&(s==="onInit"?r(e,n):n.on(s.substring(2),function(v){return r(v,n)}))})},so=function(e,c,n,s){var r=e.modelEvents?e.modelEvents:null,v=Array.isArray(r)?r.join(" "):r;Ue(s,function(U,l){n&&typeof U=="string"&&U!==l&&U!==n.getContent({format:e.outputFormat})&&n.setContent(U)}),n.on(v||"change input undo redo",function(){c.emit("update:modelValue",n.getContent({format:e.outputFormat}))})},uo=function(e,c,n,s,r,v){s.setContent(v()),n.attrs["onUpdate:modelValue"]&&so(c,n,s,r),io(e,n.attrs,s)},da=0,Pa=function(e){var c=Date.now(),n=Math.floor(Math.random()*1e9);return da++,e+"_"+n+da+String(c)},ro=function(e){return e!==null&&e.tagName.toLowerCase()==="textarea"},ma=function(e){return typeof e>"u"||e===""?[]:Array.isArray(e)?e:e.split(" ")},mo=function(e,c){return ma(e).concat(ma(c))},co=function(e){return e==null},ca=function(){return{listeners:[],scriptId:Pa("tiny-script"),scriptLoaded:!1}},vo=function(){var e=ca(),c=function(r,v,U,l){var i=v.createElement("script");i.referrerPolicy="origin",i.type="application/javascript",i.id=r,i.src=U;var u=function(){i.removeEventListener("load",u),l()};i.addEventListener("load",u),v.head&&v.head.appendChild(i)},n=function(r,v,U){e.scriptLoaded?U():(e.listeners.push(U),r.getElementById(e.scriptId)||c(e.scriptId,r,v,function(){e.listeners.forEach(function(l){return l()}),e.scriptLoaded=!0}))},s=function(){e=ca()};return{load:n,reinitialize:s}},fo=vo(),Uo=function(){return typeof window<"u"?window:global},Qe=function(){var e=Uo();return e&&e.tinymce?e.tinymce:null},Ao={apiKey:String,cloudChannel:String,id:String,init:Object,initialValue:String,inline:Boolean,modelEvents:[String,Array],plugins:[String,Array],tagName:String,toolbar:[String,Array],modelValue:String,disabled:Boolean,tinymceScriptSrc:String,outputFormat:{type:String,validator:function(e){return e==="html"||e==="text"}}},he=function(){return he=Object.assign||function(e){for(var c,n=1,s=arguments.length;n<s;n++){c=arguments[n];for(var r in c)Object.prototype.hasOwnProperty.call(c,r)&&(e[r]=c[r])}return e},he.apply(this,arguments)},To=function(e,c,n,s){return e(s||"div",{id:c,ref:n})},go=function(e,c,n){return e("textarea",{id:c,visibility:"hidden",ref:n})},Ft={selector:void 0,target:void 0},_o=Q({props:Ao,setup:function(e,c){var n=e.init?he(he({},e.init),Ft):he({},Ft),s=ul(e),r=s.disabled,v=s.modelValue,U=s.tagName,l=_(null),i=null,u=e.id||Pa("tiny-vue"),A=e.init&&e.init.inline||e.inline,f=!!c.attrs["onUpdate:modelValue"],m=!0,d=e.initialValue?e.initialValue:"",D="",k=function(g){return f?function(){return v!=null&&v.value?v.value:""}:function(){return g?d:D}},N=function(){var g=k(m),h=he(he({},n),{readonly:e.disabled,target:l.value,plugins:mo(n.plugins,e.plugins),toolbar:e.toolbar||n.toolbar,inline:A,setup:function(p){i=p,p.on("init",function(Z){return uo(Z,e,c,p,v,g)}),typeof n.setup=="function"&&n.setup(p)}});ro(l.value)&&(l.value.style.visibility=""),Qe().init(h),m=!1};Ue(r,function(g){var h;i!==null&&(typeof((h=i.mode)===null||h===void 0?void 0:h.set)=="function"?i.mode.set(g?"readonly":"design"):i.setMode(g?"readonly":"design"))}),Ue(U,function(g){var h;f||(D=i.getContent()),(h=Qe())===null||h===void 0||h.remove(i),gt(function(){return N()})}),rl(function(){if(Qe()!==null)N();else if(l.value&&l.value.ownerDocument){var g=e.cloudChannel?e.cloudChannel:"6",h=e.apiKey?e.apiKey:"no-api-key",p=co(e.tinymceScriptSrc)?"https://cdn.tiny.cloud/1/".concat(h,"/tinymce/").concat(g,"/tinymce.min.js"):e.tinymceScriptSrc;fo.load(l.value.ownerDocument,p,N)}}),dl(function(){Qe()!==null&&Qe().remove(i)}),A||(ml(function(){m||N()}),cl(function(){var g;f||(D=i.getContent()),(g=Qe())===null||g===void 0||g.remove(i)}));var C=function(g){var h;D=i.getContent(),(h=Qe())===null||h===void 0||h.remove(i),n=he(he(he({},n),g),Ft),gt(function(){return N()})};return c.expose({rerender:C,getEditor:function(){return i}}),function(){return A?To(aa,u,l,e.tagName):go(aa,u,l)}}});const Eo=["colspan"],po=F("strong",null,"E-Mail Content",-1),Do=["innerHTML"],So=Q({__name:"Communications",props:{expanded:{type:Boolean,default:!0},hideHistory:{type:Boolean,default:!1},registration:{},showEditor:{type:Boolean}},emits:["close-editor"],setup(e,{emit:c}){const n=Ae(),s=_([]),r=_({From:"",Subject:"",HTML:""}),v=_(""),U=_(""),l=_(""),i=_(!1),u=_(e.expanded?["1"]:[]),A=_([]),f=_([]),m=_([{key:"CreatedAt",title:"Date"},{key:"Subject",title:"Subject"},{key:"User.DisplayName",title:"Sender"},{key:"Status",title:"Status"}]),d=_([{key:"CreatedAt",order:"asc"}]);Ue(r,g=>{l.value=g.From||l.value||"",U.value=g.Subject||U.value||"",v.value=g.HTML||v.value||""});const D=c,k=()=>{n.getRegistrationEmails(e.registration.RegistrationUUID).then(g=>{g&&(g.forEach(h=>{h.CreatedAt=_t(new Date(h.CreatedAt||"")),h.Status=un(h.Status),h.User||(h.User={ID:0,UserUUID:"",DisplayName:"System",Handle:"",Credentials:[],Additional:{FirstName:"",LastName:"",DOB:"",Email:""},Data:"",Groups:[],Tags:[]})}),f.value=g)})};k(),(()=>{n.getRegistrationEmailTemplates(e.registration.RegistrationUUID).then(g=>{g&&(s.value=g)})})();const C=({callback:g})=>{n.sendRegistrationEmail(e.registration.RegistrationUUID,l.value,U.value,v.value).then(h=>{h?g&&(g("Email Sent"),k(),setTimeout(()=>{i.value=!1},2e3)):g&&g("Not sent")}).catch(()=>{g&&g("Not sent")})};return(g,h)=>(o(),T(L,null,[g.showEditor?(o(),S(ce,{key:0,class:"px-0",style:{"max-width":"calc(100vw - 64px)"}},{default:a(()=>[t(J,null,{default:a(()=>[t(V,null,{default:a(()=>[t(Ta,{items:s.value,"item-title":"Subject","return-object":"",label:"Template","hide-details":"",modelValue:r.value,"onUpdate:modelValue":h[0]||(h[0]=p=>r.value=p),variant:"outlined"},null,8,["items","modelValue"])]),_:1})]),_:1}),t(J,null,{default:a(()=>[t(V,{cols:"12"},{default:a(()=>[t(oe,{modelValue:l.value,"onUpdate:modelValue":h[1]||(h[1]=p=>l.value=p),label:"From",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),t(V,{cols:"12"},{default:a(()=>[t(oe,{modelValue:U.value,"onUpdate:modelValue":h[2]||(h[2]=p=>U.value=p),label:"Subject",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),t(V,{cols:"12"},{default:a(()=>[t(E(_o),{modelValue:v.value,"onUpdate:modelValue":h[3]||(h[3]=p=>v.value=p),"api-key":"g9sce3fktcgvk0i7sp96cahgyk4cos7q27es3ubnlal3xf3z"},null,8,["modelValue"])]),_:1})]),_:1}),t(J,null,{default:a(()=>[t(V,null,{default:a(()=>[t(mt,{onClick:h[4]||(h[4]=p=>D("close-editor")),label:"Close E-mail Editor",color:"secondary","prepend-icon":"mdi:mdi-window-close"})]),_:1}),t(V,{class:"text-right"},{default:a(()=>[t(mt,{onClick:C,label:"Send",color:"error"})]),_:1})]),_:1})]),_:1})):M("",!0),f.value.length&&!g.hideHistory?(o(),S(Ot,{key:1,class:"my-2",multiple:!0,modelValue:u.value,"onUpdate:modelValue":h[7]||(h[7]=p=>u.value=p)},{default:a(()=>[t(ht,{value:"1"},{default:a(()=>[t(Ct,null,{default:a(()=>[O(" Email History ")]),_:1}),t(Rt,null,{default:a(()=>[t(Qt,{items:f.value,headers:m.value,"show-expand":!0,"item-value":"EmailUUID",expanded:A.value,"onUpdate:expanded":h[5]||(h[5]=p=>A.value=p),"sort-by":d.value,"onUpdate:sortBy":h[6]||(h[6]=p=>d.value=p)},{"expanded-row":a(({columns:p,item:Z})=>[F("tr",null,[F("td",{colspan:p.length},[po,F("div",{class:"communicationsViewEmailPreview",innerHTML:Z.HTML},null,8,Do)],8,Eo)])]),"footer.prepend":a(()=>[t(K,{"prepend-icon":"mdi:mdi-refresh",color:"primary",class:"mr-4",onClick:k},{default:a(()=>[O("Refresh")]),_:1})]),_:1},8,["items","headers","expanded","sort-by"])]),_:1})]),_:1})]),_:1},8,["modelValue"])):M("",!0)],64))}}),$a=Q({__name:"Emails",props:{allowSending:{type:Boolean,default:!0},expanded:{type:Boolean,default:!0},hideHistory:{type:Boolean,default:!1},showTitle:{type:Boolean,default:!0},registration:{},textClass:{default:""}},setup(e){const c=_(!1);return(n,s)=>(o(),T(L,null,[t(Pe,null,{default:a(()=>[n.showTitle?(o(),S(it,{key:0},{default:a(()=>[t(Ze,null,{default:a(()=>[O(" E-Mails (#"+I(n.registration.Reference)+" "+I(n.registration.User.DisplayName)+") ",1)]),_:1})]),_:1})):M("",!0),t(et,{class:Xe(n.textClass)},{default:a(()=>[n.allowSending?(o(),S(J,{key:0},{default:a(()=>[t(V,{cols:"12"},{default:a(()=>[t(K,{"prepend-icon":"mdi:mdi-email",color:"primary",onClick:s[0]||(s[0]=r=>c.value=!0)},{default:a(()=>[O(" Prepare Email ")]),_:1})]),_:1})]),_:1})):M("",!0)]),_:1},8,["class"])]),_:1}),t(So,{registration:n.registration,expanded:n.expanded,"hide-history":n.hideHistory,"show-editor":c.value,onCloseEditor:s[1]||(s[1]=r=>c.value=!1)},null,8,["registration","expanded","hide-history","show-editor"])],64))}}),yo=Q({__name:"EditNoteCategoryDialog",props:X({convention:{},noteCategory:{},title:{}},{modelValue:{type:Boolean,required:!0},modelModifiers:{}}),emits:X(["update:noteCategory"],["update:modelValue"]),setup(e,{emit:c}){const n=e,{title:s=""}=n,r=c,v=le(e,"modelValue"),U=vt(n,r,void 0,void 0,"noteCategory"),l=_(_e(U.value));Ue(U,()=>{l.value=_e(U.value)});const i=()=>{v.value=!1},u=()=>{l.value=_e(U.value)},A=()=>{U.value=l.value};return(f,m)=>(o(),S(we,{modelValue:v.value,"onUpdate:modelValue":m[2]||(m[2]=d=>v.value=d),onReset:u,onSave:A,title:E(s),color:"primary",persistent:!0,fullscreen:!1,"hide-extension":!0},{default:a(()=>[t(ce,{class:"pa-0",fluid:!0},{default:a(()=>[t(J,null,{default:a(()=>[t(V,{cols:"12",sm:"6",md:"4"},{default:a(()=>[t(oe,{modelValue:l.value.Name,"onUpdate:modelValue":m[0]||(m[0]=d=>l.value.Name=d),label:"Internal name",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),t(V,{cols:"12",sm:"6",md:"4"},{default:a(()=>[t(ya,{modelValue:l.value.Groups,"onUpdate:modelValue":m[1]||(m[1]=d=>l.value.Groups=d),convention:f.convention,label:"Groups",variant:"outlined","hide-details":""},null,8,["modelValue","convention"])]),_:1})]),_:1})]),_:1})]),actions:a(()=>[t(K,{color:"blue-darken-1",variant:"text",onClick:i},{default:a(()=>[O(" Cancel ")]),_:1}),t(K,{color:"blue-darken-1",variant:"text",onClick:u},{default:a(()=>[O(" Reset ")]),_:1}),t(Fe),t(K,{color:"blue-darken-1",variant:"text",onClick:A},{default:a(()=>[O(" Save ")]),_:1})]),_:1},8,["modelValue","title"]))}}),Io=()=>{const e=_(""),c=()=>{const n={x:window.innerWidth,y:window.innerHeight};n.x<600?e.value="xs":n.x>=600&&n.x<960?e.value="sm":n.x>=960&&n.x<1280?e.value="md":n.x>=1280&&n.x<1920?e.value="lg":n.x>=1920&&n.x<2560?e.value="xl":n.x>=2560&&(e.value="xxl")};return window.addEventListener("resize",c),c(),e},Co={style:{"list-style":"none"}},Ro=Q({__name:"NoteCategories",props:{hideHistory:{type:Boolean},convention:{},showEditor:{type:Boolean}},emits:["close"],setup(e,{emit:c}){const n=Ae(),s=c,r=_(!1),v=_(!1),U=_(""),l=_([]),i=_([{key:"Name",title:"Name"},{key:"Groups",title:"Groups"},{key:"actions",title:"",sortable:!1}]),u=Io();_([{key:"CreatedAt",order:"asc"}]);const A=()=>({ID:0,NoteCategoryUUID:Ie(),ConventionID:e.convention.ID,ConventionUUID:e.convention.ConventionUUID,Name:"",Groups:[],Notes:[]}),f=_(-1),m=_(A()),d=_(A()),D=()=>{d.value.NoteCategoryUUID=Ie(),m.value=Object.assign({},A()),f.value=-1,r.value=!0},k=z=>{f.value=l.value.indexOf(z),m.value=Object.assign({},z),r.value=!0},N=z=>{f.value=l.value.indexOf(z),m.value=Object.assign({},z),v.value=!0},C=()=>{n.deleteNoteCategory(m.value.NoteCategoryUUID).then(z=>{z&&(l.value.splice(f.value,1),h())})},g=()=>{r.value=!1,gt(()=>{m.value=Object.assign({},d.value),f.value=-1})},h=()=>{v.value=!1,gt(()=>{m.value=Object.assign({},d.value),f.value=-1})},p=()=>{n.saveNoteCategory(m.value).then(z=>{z&&(f.value>-1?Object.assign(l.value[f.value],z):l.value.push(z),g())})};return(()=>{n.getNoteCategories(e.convention.ConventionUUID).then(z=>{z&&(l.value=z)})})(),(z,re)=>(o(),S(Qt,{headers:i.value,items:l.value,"sort-by":[{key:"calories",order:"asc"}],class:"elevation-1"},{top:a(()=>[t(Gt,{color:"primary"},We({default:a(()=>[t(ka,null,{default:a(()=>[O("Note Categories")]),_:1}),t(xl,{class:"mx-4 d-none d-sm-inline-flex",inset:!0,vertical:!0}),t(Fe,{class:"d-none d-sm-inline-flex"}),E(u)!="xs"?(o(),S(K,{key:0,dark:"",class:"mb-2","prepend-icon":"mdi:mdi-pencil",onClick:D},{default:a(()=>[O(" New Item ")]),_:1})):M("",!0),t(K,{dark:"",class:"mb-2",icon:"mdi:mdi-window-close",onClick:re[0]||(re[0]=$=>s("close"))}),t(Oa,{modelValue:v.value,"onUpdate:modelValue":re[1]||(re[1]=$=>v.value=$),onDelete:C},null,8,["modelValue"])]),_:2},[E(u)=="xs"?{name:"extension",fn:a(()=>[t(Fe),t(K,{dark:"",class:"mb-2","prepend-icon":"mdi:mdi-pencil",onClick:D},{default:a(()=>[O(" New Item ")]),_:1})]),key:"0"}:void 0]),1024),r.value?(o(),S(yo,{key:0,modelValue:r.value,"onUpdate:modelValue":re[2]||(re[2]=$=>r.value=$),"note-category":m.value,"onUpdate:noteCategory":[re[3]||(re[3]=$=>m.value=$),p],title:U.value,convention:z.convention},null,8,["modelValue","note-category","title","convention"])):M("",!0)]),"item.Groups":a(({item:$})=>[F("ul",Co,[(o(!0),T(L,null,W($.Groups,Y=>(o(),T("li",{key:Y.GroupUUID,class:"py-1"},I(Y.Name),1))),128))])]),"item.actions":a(({item:$})=>[t(ke,{size:"small",class:"me-2",onClick:Y=>k($)},{default:a(()=>[O(" mdi:mdi-pencil ")]),_:2},1032,["onClick"]),t(ke,{size:"small",onClick:Y=>N($)},{default:a(()=>[O(" mdi:mdi-delete ")]),_:2},1032,["onClick"])]),_:1},8,["headers","items"]))}}),ho=Q({__name:"SelectNoteCategories",props:X({convention:{},chips:{type:Boolean,default:!1},clearable:{type:Boolean,default:!1},hint:{default:""},label:{},variant:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:X(["change"],["update:modelValue"]),setup(e,{emit:c}){const n=le(e,"modelValue"),s=c,r=_([]),v=Ae(),U=_([]),l=_(""),i=_(0),u=se(()=>[...U.value].map(m=>({title:m.Name,value:r.value.find(d=>d.NoteCategoryUUID===m.NoteCategoryUUID)||m})));return typeof e.convention=="object"?l.value=e.convention.ConventionUUID:l.value=e.convention||"",(async()=>{const f=[];l.value&&f.push(v.getNoteCategories(l.value));const m=await Promise.all(f);if(l.value&&m.length==1&&(U.value=m[0].sort((d,D)=>d.Name.localeCompare(D.Name))),Array.isArray(n.value))i.value=2,u.value.forEach(d=>{Array.isArray(n.value)&&n.value.find(k=>k.NoteCategoryUUID===d.value.NoteCategoryUUID)&&r.value.push(d.value)});else if(typeof n.value=="string"){i.value=1;try{const d=JSON.parse(n.value);u.value.forEach(D=>{d.find(N=>N.NoteCategoryUUID===D.value.NoteCategoryUUID)&&r.value.push(D.value)})}catch{}}})(),Ue(r,()=>{switch(i.value){default:case 2:{n.value=r.value,s("change");break}case 1:{n.value=JSON.stringify(r.value),s("change");break}}}),(f,m)=>(o(),S(Ta,{modelValue:r.value,"onUpdate:modelValue":m[0]||(m[0]=d=>r.value=d),chips:f.chips,multiple:"",label:f.label||"Tags",variant:f.variant||"solo",hint:f.hint,"persistent-hint":!0,clearable:f.clearable,items:u.value,"item-title":"title","item-value":"value"},null,8,["modelValue","chips","label","variant","hint","clearable","items"]))}}),Oo=Q({__name:"EditNoteDialog",props:X({convention:{},note:{},title:{}},{modelValue:{type:Boolean,required:!0},modelModifiers:{}}),emits:X(["update:note","saved"],["update:modelValue"]),setup(e,{emit:c}){const n=e,{title:s=""}=n,r=Ae(),v=c,U=le(e,"modelValue"),l=vt(n,v,void 0,void 0,"note"),i=_(_e(l.value));Ue(l,()=>{i.value=_e(l.value)});const u=()=>{i.value=_e(l.value)},A=f=>{i.value.NoteCategories===null&&(i.value.NoteCategories=[]),i.value.CreatedAt=void 0,i.value.DeletedAt=void 0,i.value.UpdatedAt=void 0,i.value.Admin=void 0,i.value.AdminID=void 0,i.value.AdminUUID=void 0,r.saveNote(i.value).then(m=>{m?(i.value=_e(m),f&&f("Note Saved"),l.value=i.value,v("saved",l.value)):f&&f("Internal Error Saving Note")}).catch(m=>{f&&f("Error Saving Note:"+m.ErrorMessage)})};return(f,m)=>i.value?(o(),S(we,{key:0,"card-class":"pa-4",modelValue:U.value,"onUpdate:modelValue":m[3]||(m[3]=d=>U.value=d),onReset:u,onSave:A,title:E(s),color:"primary",persistent:!0,fullscreen:!1,"hide-extension":!0,"show-close-action":!0,"show-reset-action":!0,"show-save-action":!0},{default:a(()=>[t(ce,{class:"pa-0",fluid:!0},{default:a(()=>[t(J,null,{default:a(()=>[t(V,{cols:"12"},{default:a(()=>[t(ho,{modelValue:i.value.NoteCategories,"onUpdate:modelValue":m[0]||(m[0]=d=>i.value.NoteCategories=d),convention:f.convention,label:"Categories",variant:"outlined","hide-details":"",chips:!0},null,8,["modelValue","convention"])]),_:1})]),_:1}),t(J,null,{default:a(()=>[t(V,{cols:"12"},{default:a(()=>[t(oe,{modelValue:i.value.Subject,"onUpdate:modelValue":m[1]||(m[1]=d=>i.value.Subject=d),label:"Subject",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),t(V,{cols:"12"},{default:a(()=>[t(Va,{modelValue:i.value.Description,"onUpdate:modelValue":m[2]||(m[2]=d=>i.value.Description=d),label:"Note",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue","title"])):M("",!0)}}),Ba=Q({__name:"Notes",props:{allowAdding:{type:Boolean,default:!0},cardClass:{default:""},convention:{},expanded:{type:Boolean,default:!0},hideHistory:{type:Boolean},registration:{},showControlPanel:{type:Boolean,default:!0},showEditor:{type:Boolean},showTitle:{type:Boolean,default:!0},textClass:{default:""}},setup(e){const c=Ae(),n=()=>({ID:0,NoteUUID:Ie(),Description:"",NoteCategories:[],Registration:e.registration,RegistrationID:e.registration.ID,RegistrationUUID:e.registration.RegistrationUUID,Subject:""}),s=_(!1),r=_(!1),v=_([]),U=_([]),l=_(n()),i=()=>{l.value=n(),s.value=!0},u=m=>{l.value=m,s.value=!0},A=()=>{c.getRegistrationNotes(e.registration.RegistrationUUID).then(m=>{m&&(m.forEach(d=>{d.CreatedAt=_t(new Date(d.CreatedAt||"")),d.Admin||(d.Admin={ID:0,UserUUID:"",DisplayName:"System",Handle:"",Credentials:[],Additional:{FirstName:"",LastName:"",DOB:"",Email:""},Data:"",Groups:[],Tags:[]})}),v.value=m,e.expanded&&(U.value=m.map(d=>d.NoteUUID)))})},f=()=>{A(),setTimeout(()=>{s.value=!1},2e3)};return A(),(m,d)=>(o(),T(L,null,[t(Pe,{class:Xe(m.cardClass)},{default:a(()=>[t(it,null,{default:a(()=>[t(Ze,null,{default:a(()=>[t(J,{class:"flex-row-reverse"},{default:a(()=>[m.showControlPanel?(o(),S(V,{key:0,class:"text-right flex-shrink-1 flex-grow-0",style:{"flex-grow":"0 !important"}},{default:a(()=>[t(K,{class:"d-sm-none",size:"xs",icon:"mdi:mdi-cog",variant:"text",color:"warning",onClick:d[0]||(d[0]=D=>r.value=!0)}),t(K,{class:"d-none d-sm-inline-flex","prepend-icon":"mdi:mdi-cog",variant:"text",color:"warning",onClick:d[1]||(d[1]=D=>r.value=!0)},{default:a(()=>[O("Categories")]),_:1})]),_:1})):M("",!0),m.showTitle?(o(),S(V,{key:1,class:"text-wrap flex-grow-1"},{default:a(()=>[O(" Notes (#"+I(m.registration.Reference)+" "+I(m.registration.User.DisplayName)+") ",1)]),_:1})):M("",!0)]),_:1})]),_:1})]),_:1}),t(et,{class:Xe(m.textClass)},{default:a(()=>[v.value.length===0?(o(),T(L,{key:0},[O(" No Notes Recorded ")],64)):(o(),S(Ot,{key:1,multiple:!0,variant:"accordion",modelValue:U.value,"onUpdate:modelValue":d[2]||(d[2]=D=>U.value=D)},{default:a(()=>[(o(!0),T(L,null,W(v.value,D=>(o(),S(ht,{key:`${D.NoteUUID}.${D.UpdatedAt}`,value:D.NoteUUID},{default:a(()=>[t(Ct,{class:"py-0"},{default:a(()=>[O(I(D.Subject)+" ",1),t(ql,{class:"ml-4"},{default:a(()=>[D.NoteCategories.length===0?(o(),S(Yt,{key:0},{default:a(()=>[O(" Global ")]),_:1})):M("",!0),(o(!0),T(L,null,W(D.NoteCategories,k=>(o(),S(Yt,{key:k.NoteCategoryUUID},{default:a(()=>[O(I(k.Name),1)]),_:2},1024))),128))]),_:2},1024)]),_:2},1024),t(Rt,null,{default:a(()=>[t(J,null,{default:a(()=>[t(V,null,{default:a(()=>[O(I(D.Description),1)]),_:2},1024)]),_:2},1024),t(J,null,{default:a(()=>[t(V,null,{default:a(()=>[O(I(E(Oe)(D.UpdatedAt||""))+" ",1),D&&D.Admin&&D.Admin.DisplayName?(o(),T(L,{key:0},[O(" - "+I(D.Admin.DisplayName),1)],64)):M("",!0)]),_:2},1024),t(V,{class:"text-right"},{default:a(()=>[t(K,{color:"primary","prepend-icon":"mdi:mdi-pencil",onClick:k=>u(D)},{default:a(()=>[O("Edit")]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"]))]),_:1},8,["class"]),m.allowAdding?(o(),S(jt,{key:0},{default:a(()=>[t(K,{color:"primary",variant:"flat",onClick:i},{default:a(()=>[O("Add Note")]),_:1})]),_:1})):M("",!0)]),_:1},8,["class"]),t(pt,{modelValue:s.value,"onUpdate:modelValue":d[5]||(d[5]=D=>s.value=D),title:"Create Note"},{default:a(()=>[t(Oo,{modelValue:s.value,"onUpdate:modelValue":d[3]||(d[3]=D=>s.value=D),note:l.value,"onUpdate:note":d[4]||(d[4]=D=>l.value=D),convention:m.convention,title:"Create Note",onSaved:f},null,8,["modelValue","note","convention"])]),_:1},8,["modelValue"]),t(pt,{modelValue:r.value,"onUpdate:modelValue":d[7]||(d[7]=D=>r.value=D),title:"Note Configuration"},{default:a(()=>[t(Ro,{convention:m.convention,onClose:d[6]||(d[6]=D=>r.value=!1)},null,8,["convention"])]),_:1},8,["modelValue"])],64))}}),ko=Q({__name:"StripeRefundPayment",props:X({paymentTransaction:{}},{modelValue:{type:Boolean,required:!0},modelModifiers:{}}),emits:X(["refunded"],["update:modelValue"]),setup(e,{emit:c}){const n=le(e,"modelValue"),s=c,r=Ae(),v=_(!1),U=_("");let l=0;if(e.paymentTransaction.Data&&e.paymentTransaction.Data.PaymentIntent&&typeof e.paymentTransaction.Data.PaymentIntent=="object"){const d=e.paymentTransaction.Data.PaymentIntent;d&&(l=d.amount)}const i=_({Amount:l/100,Description:"",Reason:""}),u=_([{title:"Duplicate",value:"duplicate"},{title:"Fraudulent",value:"fraudulent"},{title:"Requested By Customer",value:"requested_by_customer"}]),A=_(!1);async function f(d){d.preventDefault(),A.value=!0,r.refundStripePayment(e.paymentTransaction.PaymentTransactionUUID,i.value).then(D=>{D?s("refunded",D):m("An unexpected error occurred.")}).catch(D=>{m("An error occurred processing the refund: "+D.toString())}),A.value=!1}const m=d=>{U.value=d,v.value=!0};return(d,D)=>(o(),S(we,{modelValue:n.value,"onUpdate:modelValue":D[7]||(D[7]=k=>n.value=k),title:"Refund a Stripe Payment",color:"blue-darken-4",persistent:""},{default:a(()=>[t(ce,{class:"pa-0"},{default:a(()=>[t(Kl,{ref:"refundForm",id:"refund-form",onSubmit:D[4]||(D[4]=Pt(k=>f(k),["prevent"]))},{default:a(()=>[t(J,null,{default:a(()=>[t(V,{cols:"12",sm:"6",md:"4",lg:"3",xl:"2"},{default:a(()=>[t(oe,{modelValue:i.value.Amount,"onUpdate:modelValue":D[0]||(D[0]=k=>i.value.Amount=k),modelModifiers:{number:!0},label:"Amount",prefix:"£",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),t(V,{cols:"12",sm:"6",md:"8",lg:"9",xl:"10"},{default:a(()=>[t(fe,{modelValue:i.value.Reason,"onUpdate:modelValue":D[1]||(D[1]=k=>i.value.Reason=k),modelModifiers:{number:!0},items:u.value,"item-title":"title","item-value":"value",label:"Stripe Refund Reason",variant:"outlined","hide-details":""},null,8,["modelValue","items"])]),_:1}),t(V,{cols:"12"},{default:a(()=>[t(oe,{modelValue:i.value.Description,"onUpdate:modelValue":D[2]||(D[2]=k=>i.value.Description=k),modelModifiers:{number:!0},label:"Refund Description",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1})]),_:1}),t(J,null,{default:a(()=>[t(V,{class:"text-right",cols:"12",sm:"3",md:"2",lg:"2",xl:"1"},{default:a(()=>[t(K,{color:"error",class:"w-100",onClick:D[3]||(D[3]=k=>n.value=!1)},{default:a(()=>[O("Cancel")]),_:1})]),_:1}),t(Fe),t(V,{class:"text-left",cols:"12",sm:"3",md:"2",lg:"2",xl:"1"},{default:a(()=>[t(K,{type:"submit",color:"success",class:"w-100"},We({default:a(()=>[O(" Issue Refund ")]),_:2},[A.value?{name:"prepend",fn:a(()=>[t(Da,{size:"20",indeterminate:""})]),key:"0"}:void 0]),1024)]),_:1})]),_:1})]),_:1},512)]),_:1}),t(Sa,{modelValue:v.value,"onUpdate:modelValue":D[6]||(D[6]=k=>v.value=k)},{actions:a(()=>[t(K,{variant:"text",onClick:D[5]||(D[5]=k=>v.value=!1)},{default:a(()=>[O(" Close ")]),_:1})]),default:a(()=>[O(I(U.value)+" ",1)]),_:1},8,["modelValue"])]),_:1},8,["modelValue"]))}}),Vo=["colspan"],bo=F("strong",null,"Details",-1),Mo=["innerHTML"],Ga=Q({__name:"PaymentTransactions",props:{canEdit:{type:Boolean},expanded:{type:Boolean},hideHistory:{type:Boolean},updated:{},registration:{},showEditor:{type:Boolean}},emits:["close-editor","change"],setup(e,{emit:c}){const n=e;let{expanded:s=!0,hideHistory:r=!1,registration:v,showEditor:U}=n;const l=Ae(),i=_([]),u=_(s?["1"]:[]),A=_([]),f=_([{key:"CreatedAt",title:"Date"},{key:"Type",title:"Type"},{key:"Source",title:"Source"},{key:"Description",title:"Description"},{key:"Admin",title:"Admin"},{key:"Amount",title:"Amount"},{key:"Controls",title:""}]),m=_(!1),d=_(),D=_(!1),k=_(""),N=_([{key:"CreatedAt",order:"asc"}]),C=c,g=()=>({PaymentTransactionUUID:Ie(),Amount:0,Data:{},Description:"",ID:0,RegistrationID:v.ID,RegistrationUUID:v.RegistrationUUID,Source:oa.PAYMENT_TRANSACTION_SOURCE_NULL,Type:$t.PAYMENT_TRANSACTION_TYPE_NULL}),h=_(g()),{convertTransactions:p,getPaymentTransactionsDisplay:Z}=pa();Ue(n,()=>{r=n.hideHistory,v=n.registration,U=n.showEditor,Z(v.RegistrationUUID).then(G=>{A.value=G})});const z=()=>{Z(v.RegistrationUUID).then(G=>{A.value=G})};z();const re=()=>{l.saveRegistrationPaymentTransaction(h.value).then(G=>{G&&(p(G.PaymentTransactions),h.value=g(),C("close-editor"),C("change"))})},$=G=>{const B=A.value.find(w=>w.PaymentTransactionUUID===G);B&&(d.value=B.PaymentTransaction,m.value=!0)},Y=G=>{if(G)try{A.value=p(G.PaymentTransactions),d.value=void 0,m.value=!1,k.value="Refund Processed",D.value=!0,C("change")}catch(B){console.error(B)}};return(G,B)=>(o(),T(L,null,[E(U)?(o(),T(L,{key:0},[t(Ze,null,{default:a(()=>[O(" Add Transaction ")]),_:1}),t(J,null,{default:a(()=>[t(V,{cols:"12",sm:"6"},{default:a(()=>[t(fe,{items:E(Sl),"item-title":"title","item-value":"value",label:"Transaction Type",clearable:!0,"hide-details":"",modelValue:h.value.Type,"onUpdate:modelValue":B[0]||(B[0]=w=>h.value.Type=w),variant:"outlined"},null,8,["items","modelValue"])]),_:1}),t(V,{cols:"12",sm:"6"},{default:a(()=>[t(fe,{items:E(yl),"item-title":"title","item-value":"value",label:"Source",clearable:!0,"hide-details":"",modelValue:h.value.Source,"onUpdate:modelValue":B[1]||(B[1]=w=>h.value.Source=w),variant:"outlined"},null,8,["items","modelValue"])]),_:1})]),_:1}),t(J,null,{default:a(()=>[t(V,{cols:"12",sm:"8",md:"10"},{default:a(()=>[t(oe,{label:"Description","hide-details":"",modelValue:h.value.Description,"onUpdate:modelValue":B[2]||(B[2]=w=>h.value.Description=w),variant:"outlined"},null,8,["modelValue"])]),_:1}),t(V,{cols:"12",sm:"4",md:"2"},{default:a(()=>[t(oe,{label:"Amount","prepend-inner-icon":"mdi:mdi-currency-gbp","hide-details":"",modelValue:h.value.Amount,"onUpdate:modelValue":B[3]||(B[3]=w=>h.value.Amount=w),modelModifiers:{number:!0},variant:"outlined"},null,8,["modelValue"])]),_:1})]),_:1}),t(J,null,{default:a(()=>[t(V,{cols:"12",sm:"3",md:"2",lg:"1"},{default:a(()=>[t(K,{class:"w-100",onClick:B[4]||(B[4]=w=>C("close-editor")),color:"warning"},{default:a(()=>[O("Cancel")]),_:1})]),_:1}),t(Fe),t(V,{cols:"12",sm:"6",md:"3",lg:"2",xl:"2"},{default:a(()=>[t(K,{class:"w-100",onClick:re,color:"primary"},{default:a(()=>[O("Submit Transaction")]),_:1})]),_:1})]),_:1})],64)):M("",!0),A.value.length&&!E(r)?(o(),S(Ot,{key:1,class:"my-2",modelValue:u.value,"onUpdate:modelValue":B[10]||(B[10]=w=>u.value=w)},{default:a(()=>[t(ht,{value:"1"},{default:a(()=>[t(Ct,null,{default:a(()=>[O(" Transaction History ")]),_:1}),t(Rt,null,{default:a(()=>[t(Qt,{items:A.value,headers:f.value,"show-expand":!1,"item-value":"PaymentTransactionUUID",expanded:i.value,"onUpdate:expanded":B[5]||(B[5]=w=>i.value=w),"sort-by":N.value,"onUpdate:sortBy":B[6]||(B[6]=w=>N.value=w),class:"transactionTable"},{"item.Controls":a(({item:w})=>[G.canEdit&&w.PaymentTransaction&&w.PaymentTransaction.Source===E(oa).PAYMENT_TRANSACTION_SOURCE_STRIPE&&w.PaymentTransaction.Type===E($t).PAYMENT_TRANSACTION_TYPE_PAYMENT?(o(),S(K,{key:0,icon:"mdi:mdi-credit-card-refund",variant:"text",size:"xs",onClick:ee=>$(w.PaymentTransactionUUID)},null,8,["onClick"])):M("",!0)]),"expanded-row":a(({columns:w,item:ee})=>[F("tr",null,[F("td",{colspan:w.length},[bo,F("div",{innerHTML:ee.Data},null,8,Mo)],8,Vo)])]),"footer.prepend":a(()=>[t(K,{"prepend-icon":"mdi:mdi-refresh",color:"primary",class:"mr-4",onClick:z},{default:a(()=>[O("Refresh")]),_:1})]),_:1},8,["items","headers","expanded","sort-by"]),m.value&&d.value?(o(),S(ko,{key:0,modelValue:m.value,"onUpdate:modelValue":B[7]||(B[7]=w=>m.value=w),"payment-transaction":d.value,onRefunded:Y},null,8,["modelValue","payment-transaction"])):M("",!0),t(Sa,{modelValue:D.value,"onUpdate:modelValue":B[9]||(B[9]=w=>D.value=w)},{actions:a(()=>[t(K,{variant:"text",onClick:B[8]||(B[8]=w=>D.value=!1)},{default:a(()=>[O(" Close ")]),_:1})]),default:a(()=>[O(I(k.value)+" ",1)]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])):M("",!0)],64))}}),No=Q({__name:"DataPanelRegistrationTags",props:X({registration:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(e){const c=le(e,"modelValue"),n=se(()=>{if(!c.value.Meta.Tags||!Array.isArray(c.value.Meta.Tags))return e.registration.Tags;const r=c.value.Meta.Tags;return r.length===0?e.registration.Tags:e.registration.Tags.filter(v=>r.includes(v.TagUUID))}),s=se(()=>c.value.Meta.TagColour?c.value.Meta.TagColour:"");return(r,v)=>(o(!0),T(L,null,W(n.value,U=>(o(),S(Yt,{key:U.TagUUID,color:s.value,class:"ma-1"},{default:a(()=>[O(I(U.Title),1)]),_:2},1032,["color"]))),128))}}),Lo=ct(No,[["__scopeId","data-v-644b07d0"]]),wo=F("span",{class:"font-weight-bold pr-2"},"Status:",-1),Fo={key:0,class:"text-green-darken-2"},Po={key:1,class:"text-yellow-darken-4"},$o={key:2,class:"text-red-darken-4"},Bo=F("br",null,null,-1),Go=F("span",{class:"font-weight-bold pr-2"},"Status:",-1),Yo={key:0,class:"text-green-darken-2"},Ho={key:1,class:"text-yellow-darken-4"},xo={key:2,class:"text-red-darken-4"},qo=F("span",null,"Not Checked In",-1),Ht=Q({__name:"DataPanelCheckIn",props:X({convention:{},showControls:{type:Boolean,default:!1}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(e){const c=le(e,"modelValue"),n=Ae(),s=$e(),r=Fa(s,e.convention),v=_([]),U=_(!1),l=_(!1),i=_(pe.CHECK_IN_STATUS_PENDING),u=_(""),A=k=>{U.value=!0,i.value=k},f=()=>{m()},m=()=>{n.getCheckInHistory(c.value.RegistrationUUID).then(k=>{k&&(v.value=k,l.value=!0,k.length&&(c.value.CheckIn=k[0]))}).catch(()=>{})},d=k=>{n.saveCheckIn(c.value.RegistrationUUID,i.value,u.value).then(N=>{N?(c.value.CheckIn=N,k&&(k("Check In Saved"),setTimeout(()=>{U.value=!1},500))):k&&k("Check In Failed")}).catch(()=>{k&&k("Check In Failed")})},D=se(()=>{switch(i.value){case pe.CHECK_IN_STATUS_REVOKED:return"yellow-darken-4";case pe.CHECK_IN_STATUS_REJECTED:return"red-darken-4";case pe.CHECK_IN_STATUS_COMPLETED:return"green-darken-2"}return""});return(k,N)=>(o(),T(L,null,[k.showControls&&E(r)?(o(),S(ce,{key:0,class:"px-0"},{default:a(()=>[t(J,null,{default:a(()=>[t(V,null,{default:a(()=>[t(K,{color:"error",class:"w-100","prepend-icon":"mdi:mdi-window-close",onClick:N[0]||(N[0]=C=>A(E(pe).CHECK_IN_STATUS_REJECTED))},{default:a(()=>[O(" Reject ")]),_:1})]),_:1}),t(V,null,{default:a(()=>[t(K,{color:"warning",class:"w-100","prepend-icon":"mdi:mdi-window-close",onClick:N[1]||(N[1]=C=>A(E(pe).CHECK_IN_STATUS_REVOKED))},{default:a(()=>[O(" Revoke ")]),_:1})]),_:1}),t(V,null,{default:a(()=>[t(K,{color:"success",class:"w-100","prepend-icon":"mdi:mdi-check",onClick:N[2]||(N[2]=C=>A(E(pe).CHECK_IN_STATUS_COMPLETED))},{default:a(()=>[O(" Approve ")]),_:1})]),_:1})]),_:1}),t(we,{modelValue:U.value,"onUpdate:modelValue":N[4]||(N[4]=C=>U.value=C),color:D.value,fullscreen:!1,"hide-extension":!0,persistent:!1,scrollable:!1,"show-close-action":!0,"show-save-action":!0,"save-button-label":"Confirm",title:`${E(ze)(i.value)} Check-In`,onSave:d},{default:a(()=>[t(Va,{modelValue:u.value,"onUpdate:modelValue":N[3]||(N[3]=C=>u.value=C),label:"Notes",variant:"outlined"},null,8,["modelValue"])]),_:1},8,["modelValue","color","title"])]),_:1})):M("",!0),c.value.CheckIn?(o(),S(ce,{key:1,class:"px-0"},{default:a(()=>[t(J,null,{default:a(()=>[t(V,null,{default:a(()=>[wo,c.value.CheckIn.Status===E(pe).CHECK_IN_STATUS_COMPLETED?(o(),T("span",Fo,I(E(ze)(c.value.CheckIn.Status)),1)):c.value.CheckIn.Status===E(pe).CHECK_IN_STATUS_REVOKED?(o(),T("span",Po,I(E(ze)(c.value.CheckIn.Status)),1)):c.value.CheckIn.Status===E(pe).CHECK_IN_STATUS_REJECTED?(o(),T("span",$o,I(E(ze)(c.value.CheckIn.Status)),1)):M("",!0),Bo,t(K,{style:{"font-size":"0.75rem","text-transform":"none"},"append-icon":"mdi:mdi-chevron-down",size:"xs",variant:"text",onClick:f},{default:a(()=>[O("History")]),_:1})]),_:1}),t(V,{class:"text-right"},{default:a(()=>{var C;return[F("small",null,I((C=c.value.CheckIn.Admin)==null?void 0:C.DisplayName)+" "+I(E(_t)(c.value.CheckIn.CreatedAt||"")),1)]}),_:1})]),_:1}),t(we,{modelValue:l.value,"onUpdate:modelValue":N[5]||(N[5]=C=>l.value=C),fullscreen:!1,"hide-extension":!0,persistent:!1,scrollable:!0,"show-close-action":!0,"show-save-action":!1,title:"Check-In History"},{default:a(()=>[t(Le,null,{default:a(()=>[(o(!0),T(L,null,W(v.value,C=>(o(),S(Ve,{key:C.CheckInUUID},{default:a(()=>[t(Et,null,{default:a(()=>[t(J,null,{default:a(()=>[t(V,null,{default:a(()=>[Go,C.Status===E(pe).CHECK_IN_STATUS_COMPLETED?(o(),T("span",Yo,I(E(ze)(C.Status)),1)):C.Status===E(pe).CHECK_IN_STATUS_REVOKED?(o(),T("span",Ho,I(E(ze)(C.Status)),1)):C.Status===E(pe).CHECK_IN_STATUS_REJECTED?(o(),T("span",xo,I(E(ze)(C.Status)),1)):M("",!0)]),_:2},1024),t(V,{class:"text-right"},{default:a(()=>{var g;return[F("small",null,I((g=C.Admin)==null?void 0:g.DisplayName)+" "+I(E(_t)(C.CreatedAt||"")),1)]}),_:2},1024)]),_:2},1024)]),_:2},1024),C.Details?(o(),S(Cl,{key:0},{default:a(()=>[O(I(C.Details),1)]),_:2},1024)):M("",!0)]),_:2},1024))),128))]),_:1})]),_:1},8,["modelValue"])]),_:1})):(o(),S(ce,{key:2,class:"px-0"},{default:a(()=>[qo]),_:1}))],64))}}),Ko=Q({__name:"MetaDataItem",props:X({accommodations:{},convention:{},forms:{},interests:{},itemClass:{},tickets:{},venues:{}},{modelValue:{required:!0},modelModifiers:{},registration:{required:!0},registrationModifiers:{}}),emits:X(["openActions","showForm"],["update:modelValue","update:registration"]),setup(e,{emit:c}){const n=le(e,"modelValue"),s=le(e,"registration"),r=c,v=l=>{r("openActions",l)},U=(l,i,u)=>{r("showForm",l,i,u)};return(l,i)=>n.value.MetaField===E(H).META_DATA_SOURCE_ACCOMMODATION_ALLOCATION?(o(),S(wa,{key:0,convention:l.convention,tickets:l.tickets,accommodations:l.accommodations,venues:l.venues,registration:s.value,forms:l.forms,modelValue:n.value,"onUpdate:modelValue":i[0]||(i[0]=u=>n.value=u),data:""},null,8,["convention","tickets","accommodations","venues","registration","forms","modelValue"])):n.value.MetaField===E(H).META_DATA_SOURCE_BADGE_DISPLAY?(o(),S(Jt,{key:1,"card-class":l.itemClass,convention:l.convention,registration:s.value,"show-title":!1,"hide-download":n.value.Meta.HideDownloadButton,"hide-nfc":n.value.Meta.HideNFCButton},null,8,["card-class","convention","registration","hide-download","hide-nfc"])):n.value.MetaField===E(H).META_DATA_SOURCE_EMAILS?(o(),S($a,{key:2,"allow-sending":!1,expanded:!1,"show-title":!1,registration:s.value,"text-class":"pa-0 ma-0"},null,8,["registration"])):n.value.MetaField===E(H).META_DATA_SOURCE_NOTES?(o(),S(Ba,{key:3,"allow-adding":!0,"card-class":l.itemClass,convention:l.convention,expanded:!1,registration:s.value,"show-control-panel":!1,"show-title":!1,"text-class":"pa-0 ma-0"},null,8,["card-class","convention","registration"])):n.value.MetaField===E(H).META_DATA_SOURCE_PAYMENT_STATUS?(o(),S(lo,{key:4,registration:s.value},null,8,["registration"])):n.value.MetaField===E(H).META_DATA_SOURCE_PAYMENTS?(o(),S(Ga,{key:5,registration:s.value,expanded:!1},null,8,["registration"])):n.value.MetaField===E(H).META_DATA_SOURCE_REGISTRATION_ACTIONS?(o(),S(K,{key:6,icon:"mdi:mdi-briefcase",variant:"flat",onClick:i[1]||(i[1]=u=>v(s.value))})):n.value.MetaField===E(H).META_DATA_SOURCE_SUBMISSION_STATUS||n.value.MetaField===E(H).META_DATA_SOURCE_ACCOMMODATION_FORM||n.value.MetaField===E(H).META_DATA_SOURCE_ADMIN_FORM||n.value.MetaField===E(H).META_DATA_SOURCE_DEALER_FORM||n.value.MetaField===E(H).META_DATA_SOURCE_BADGE_FORM||n.value.MetaField===E(H).META_DATA_SOURCE_REGISTRATION_FORM?(o(),S(Qn,{key:7,convention:l.convention,forms:l.forms,registration:s.value,onShowForm:U},null,8,["convention","forms","registration"])):n.value.MetaField===E(H).META_DATA_SOURCE_REGISTRATION_GROUP?(o(),S(Kn,{key:8,registration:s.value},null,8,["registration"])):n.value.MetaField===E(H).META_DATA_SOURCE_REGISTRATION_REFERENCE?(o(),T(L,{key:9},[O(I(s.value.Reference),1)],64)):n.value.MetaField===E(H).META_DATA_SOURCE_SUBMISSION_DATE?(o(),S(jn,{key:10,registration:s.value},null,8,["registration"])):n.value.MetaField===E(H).META_DATA_SOURCE_TAGS?(o(),S(Lo,{key:11,registration:s.value,modelValue:n.value,"onUpdate:modelValue":i[2]||(i[2]=u=>n.value=u)},null,8,["registration","modelValue"])):n.value.MetaField===E(H).META_DATA_SOURCE_CHECKIN_CONTROL?(o(),S(Ht,{key:12,convention:l.convention,"show-controls":!0,modelValue:s.value,"onUpdate:modelValue":i[3]||(i[3]=u=>s.value=u)},null,8,["convention","modelValue"])):n.value.MetaField===E(H).META_DATA_SOURCE_CHECKIN_STATUS?(o(),S(Ht,{key:13,convention:l.convention,"show-controls":!1,modelValue:s.value,"onUpdate:modelValue":i[4]||(i[4]=u=>s.value=u)},null,8,["convention","modelValue"])):(o(),T(L,{key:14},[O(" Unhandled Meta Item "+I(n.value),1)],64))}}),jo=Q({__name:"UserDataItem",props:X({accommodations:{},convention:{},forms:{},interests:{},itemClass:{},tickets:{},venues:{}},{modelValue:{required:!0},modelModifiers:{},registration:{required:!0},registrationModifiers:{}}),emits:["update:modelValue","update:registration"],setup(e){const c=le(e,"modelValue"),n=le(e,"registration"),s=It(),r=se(()=>s.GetProfileImageURL(n.value.UserUUID));return(v,U)=>c.value.UserField===E(ne).USER_DATA_SOURCE_TELEGRAM&&n.value.User.Handle?(o(),T(L,{key:0},[O(" @"+I(n.value.User.Handle),1)],64)):c.value.UserField===E(ne).USER_DATA_SOURCE_AVATAR?(o(),S(zt,{key:1,class:"rounded-circle",src:r.value,height:"32",width:"32"},null,8,["src"])):c.value.UserField===E(ne).USER_DATA_SOURCE_DATE_OF_BIRTH?(o(),T(L,{key:2},[O(I(E(Oe)(n.value.User.Additional.DOB,{withYear:!0,withDay:!1})),1)],64)):c.value.UserField===E(ne).USER_DATA_SOURCE_EMAIL?(o(),T(L,{key:3},[O(I(n.value.User.Additional.Email),1)],64)):c.value.UserField===E(ne).USER_DATA_SOURCE_FIRST_NAME?(o(),T(L,{key:4},[O(I(n.value.User.Additional.FirstName),1)],64)):c.value.UserField===E(ne).USER_DATA_SOURCE_LAST_NAME?(o(),T(L,{key:5},[O(I(n.value.User.Additional.LastName),1)],64)):(o(),T(L,{key:6},[O(" Unhandled User Field "+I(c.value),1)],64))}}),va=Q({__name:"PanelItem",props:X({accommodations:{},convention:{},extras:{},forms:{},interests:{},itemClass:{},tickets:{},venues:{}},{modelValue:{required:!0},modelModifiers:{},registration:{required:!0},registrationModifiers:{}}),emits:X(["openActions","showForm"],["update:modelValue","update:registration"]),setup(e,{emit:c}){const n=le(e,"modelValue"),s=le(e,"registration"),r=c,v=l=>{r("openActions",l)},U=(l,i,u)=>{r("showForm",l,i,u)};return(l,i)=>n.value.SourceType===E(Ce).LAYOUT_ITEM_SOURCE_FORM?(o(),S(Yn,{key:0,accommodations:l.accommodations,convention:l.convention,extras:l.extras,forms:l.forms,interests:l.interests,"item-class":l.itemClass,tickets:l.tickets,venues:l.venues,modelValue:n.value,"onUpdate:modelValue":i[0]||(i[0]=u=>n.value=u),registration:s.value,"onUpdate:registration":i[1]||(i[1]=u=>s.value=u)},null,8,["accommodations","convention","extras","forms","interests","item-class","tickets","venues","modelValue","registration"])):n.value.SourceType===E(Ce).LAYOUT_ITEM_SOURCE_META?(o(),S(Ko,{key:1,accommodations:l.accommodations,convention:l.convention,forms:l.forms,interests:l.interests,"item-class":l.itemClass,tickets:l.tickets,venues:l.venues,modelValue:n.value,"onUpdate:modelValue":i[2]||(i[2]=u=>n.value=u),registration:s.value,"onUpdate:registration":i[3]||(i[3]=u=>s.value=u),onOpenActions:v,onShowForm:U},null,8,["accommodations","convention","forms","interests","item-class","tickets","venues","modelValue","registration"])):n.value.SourceType===E(Ce).LAYOUT_ITEM_SOURCE_USER?(o(),S(jo,{key:2,accommodations:l.accommodations,convention:l.convention,forms:l.forms,interests:l.interests,"item-class":l.itemClass,tickets:l.tickets,venues:l.venues,modelValue:n.value,"onUpdate:modelValue":i[4]||(i[4]=u=>n.value=u),registration:s.value,"onUpdate:registration":i[5]||(i[5]=u=>s.value=u)},null,8,["accommodations","convention","forms","interests","item-class","tickets","venues","modelValue","registration"])):M("",!0)}}),zo=["onClick"],Qo=["onClick"],Jo=Q({__name:"PanelLayout",props:X({accommodations:{},convention:{},extras:{},forms:{},interests:{},tickets:{},venues:{}},{layout:{required:!0},layoutModifiers:{},modelValue:{required:!0},modelModifiers:{}}),emits:X(["openActions","showForm"],["update:layout","update:modelValue"]),setup(e,{emit:c}){const n=vl(),s=c,r=le(e,"layout"),v=le(e,"modelValue"),U=_({});r.value.Panels.forEach(f=>{U.value[f.LayoutPanelUUID]=!1});const l=f=>{s("openActions",f)},i=(f,m,d)=>{s("showForm",f,m,d)},u=f=>{switch(f.PanelStyle){case ye.PANEL_STYLE_NAV_BOTTOM:return"bottom";case ye.PANEL_STYLE_NAV_LEFT:return"left";case ye.PANEL_STYLE_NAV_RIGHT:return"right";case ye.PANEL_STYLE_NAV_TOP:return"top"}},A=(f,m=!1)=>{switch(f.PanelStyle){case ye.PANEL_STYLE_NAV_BOTTOM:return m?"mdi:mdi-chevron-double-down":"mdi:mdi-chevron-double-up";case ye.PANEL_STYLE_NAV_LEFT:return m?"mdi:mdi-chevron-double-left":"mdi:mdi-chevron-double-right";case ye.PANEL_STYLE_NAV_RIGHT:return m?"mdi:mdi-chevron-double-right":"mdi:mdi-chevron-double-left";case ye.PANEL_STYLE_NAV_TOP:return m?"mdi:mdi-chevron-double-up":"mdi:mdi-chevron-double-down"}};return(f,m)=>(o(),T(L,null,[(o(!0),T(L,null,W(r.value.Panels,d=>(o(),T(L,{key:d.LayoutPanelUUID},[u(d)!==void 0?(o(),S(jl,{key:0,permanent:!0,location:u(d),border:E(n).smAndDown.value?1:0,rail:E(n).smAndDown.value&&!U.value[d.LayoutPanelUUID],"rail-width":"30",width:E(n).smAndDown.value?"100%":256,app:""},{default:a(()=>[E(n).smAndDown.value&&!U.value[d.LayoutPanelUUID]?(o(),T("h3",{key:0,class:Xe(`bg-secondary fill-height ${u(d)==="top"||u(d)==="bottom"?"px-3 text-right":"py-3 text-left"}`),style:{cursor:"pointer"},onClick:D=>U.value[d.LayoutPanelUUID]=!0},[t(ke,{icon:A(d,!1)},null,8,["icon"])],10,zo)):(o(),T(L,{key:1},[F("h3",{class:"bg-secondary pa-3 d-flex",style:la(E(n).smAndDown.value?"cursor: pointer;":""),onClick:D=>U.value[d.LayoutPanelUUID]=!1},[O(I(d.Name)+" ",1),E(n).smAndDown.value?(o(),T(L,{key:0},[t(Fe),t(K,{icon:A(d,!0),variant:"plain",size:"sm"},null,8,["icon"])],64)):M("",!0)],12,Qo),t(Le,{class:"bg-panel overflow-y-auto",style:{height:"calc(100vh - 116px)"}},{default:a(()=>[(o(!0),T(L,null,W(d.Items,(D,k)=>(o(),S(Ve,{key:D.LayoutItemUUID},{default:a(()=>[d.Items.length>1?(o(),S(Et,{key:0,class:"font-weight-bold"},{default:a(()=>[O(I(D.Label),1)]),_:2},1024)):M("",!0),t(va,{accommodations:f.accommodations,convention:f.convention,extras:f.extras,forms:f.forms,interests:f.interests,"item-class":"bg-panel border-0",tickets:f.tickets,venues:f.venues,modelValue:d.Items[k],"onUpdate:modelValue":N=>d.Items[k]=N,registration:v.value,onOpenActions:l,onShowForm:i},null,8,["accommodations","convention","extras","forms","interests","tickets","venues","modelValue","onUpdate:modelValue","registration"])]),_:2},1024))),128))]),_:2},1024)],64))]),_:2},1032,["location","border","rail","width"])):M("",!0)],64))),128)),t(zl,{class:"py-0"},{default:a(()=>[t(ce,null,{default:a(()=>[t(J,null,{default:a(()=>[(o(!0),T(L,null,W(r.value.Panels,d=>{var D,k,N,C,g,h;return o(),T(L,{key:d.LayoutPanelUUID},[d.PanelStyle===E(ye).PANEL_STYLE_FLEX?(o(),S(V,{key:0,cols:((D=d.Meta.cols)==null?void 0:D.toString())||!1,xs:((k=d.Meta.cols_xs)==null?void 0:k.toString())||!1,sm:((N=d.Meta.cols_sm)==null?void 0:N.toString())||!1,md:((C=d.Meta.cols_md)==null?void 0:C.toString())||!1,lg:((g=d.Meta.cols_lg)==null?void 0:g.toString())||!1,xl:((h=d.Meta.cols_xl)==null?void 0:h.toString())||!1,class:"pa-0 pa-sm-2"},{default:a(()=>[t(ce,{class:"bg-panel",style:la(E(n).smAndUp.value?"border-radius: 15px;":"")},{default:a(()=>[F("h3",null,I(d.Name),1),t(Le,{class:"bg-panel"},{default:a(()=>[(o(!0),T(L,null,W(d.Items,(p,Z)=>(o(),S(Ve,{key:p.LayoutItemUUID,class:"px-0"},{default:a(()=>[d.Items.length>1?(o(),S(Et,{key:0,class:"font-weight-bold"},{default:a(()=>[O(I(p.Label),1)]),_:2},1024)):M("",!0),t(va,{accommodations:f.accommodations,convention:f.convention,extras:f.extras,forms:f.forms,interests:f.interests,"item-class":"bg-panel border-0",tickets:f.tickets,venues:f.venues,modelValue:d.Items[Z],"onUpdate:modelValue":z=>d.Items[Z]=z,registration:v.value,"onUpdate:registration":m[0]||(m[0]=z=>v.value=z),onOpenActions:l,onShowForm:i},null,8,["accommodations","convention","extras","forms","interests","tickets","venues","modelValue","onUpdate:modelValue","registration"])]),_:2},1024))),128))]),_:2},1024)]),_:2},1032,["style"])]),_:2},1032,["cols","xs","sm","md","lg","xl"])):M("",!0)],64)}),128))]),_:1})]),_:1})]),_:1})],64))}}),Xo=Q({__name:"DataTableItemPanel",props:X({accommodations:{},cardClass:{},convention:{},extras:{},forms:{},interests:{},tickets:{},venues:{},layouts:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:X(["openActions","showForm"],["update:modelValue"]),setup(e,{emit:c}){const n=c,s=le(e,"modelValue"),r=_(),v=Ae(),U=_(),l=_(!1),i=f=>{const m={AdminLayoutUUID:f.AdminLayoutUUID,Limit:1,RegistrationUUID:s.value.RegistrationUUID};v.searchConventionRegistrations(s.value.ConventionUUID,m).then(d=>{d&&d.Total>0&&(r.value=d.Registrations[0],U.value=f,l.value=!0)})},u=f=>{n("openActions",f)},A=(f,m,d)=>{n("showForm",f,m,d)};return(f,m)=>(o(),T("div",null,[f.layouts?(o(),S(Le,{key:0},{default:a(()=>[(o(!0),T(L,null,W(f.layouts,d=>(o(),S(Ve,{key:d.AdminLayoutUUID,class:"d-block pa-0 ma-0"},{default:a(()=>[t(Et,{style:{"text-overflow":"inherit"},class:"overflow-visible text-wrap"},{default:a(()=>[t(K,{"prepend-icon":"mdi:mdi-page-layout-body",variant:"flat",onClick:D=>i(d)},{default:a(()=>[O(I(d.Name),1)]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024))),128))]),_:1})):M("",!0),l.value&&U.value&&r.value?(o(),S(we,{key:1,modelValue:l.value,"onUpdate:modelValue":m[2]||(m[2]=d=>l.value=d),"hide-extension":!0,fullscreen:!0,title:`#${r.value.Reference} ${r.value.User.DisplayName} - ${U.value.Name} `,scrollable:!0,"card-class":"pa-0","card-style":"margin-bottom: -52px"},{default:a(()=>[t(Jo,{accommodations:f.accommodations,convention:f.convention,extras:f.extras,forms:f.forms,interests:f.interests,tickets:f.tickets,venues:f.venues,layout:U.value,"onUpdate:layout":m[0]||(m[0]=d=>U.value=d),modelValue:r.value,"onUpdate:modelValue":m[1]||(m[1]=d=>r.value=d),onOpenActions:u,onShowForm:A},null,8,["accommodations","convention","extras","forms","interests","tickets","venues","layout","modelValue"])]),_:1},8,["modelValue","title"])):M("",!0)]))}}),Wo={class:"text-grey-lighten-1"},Zo={key:0,class:"mb-2"},ei=F("strong",null,"Email",-1),ti=F("br",null,null,-1),ai={key:1,class:"mb-2"},li=F("strong",null,"Telegram",-1),ni=F("br",null,null,-1),oi={key:0,class:"text-blue text-center"},ii={key:1,class:"text-red text-center"},si={key:2,class:"text-orange text-center"},ui={key:3,class:"text-orange text-center"},ri={key:4,class:"text-orange text-center"},di={key:5,class:"text-orange text-center"},mi={key:6,class:"text-green text-center"},ci={key:0},vi={key:0},fi=F("strong",null,"Total:",-1),Ui=Q({__name:"RegListRow",props:X({header:{},accommodations:{},convention:{},extras:{},forms:{},interests:{},item:{},tickets:{},user:{},venues:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:X(["openActions","openPayments","openTags","reload","showForm","switchUser"],["update:modelValue"]),setup(e,{emit:c}){const n=c,s=le(e,"modelValue"),r=(l,i)=>{n("showForm",{registration:l,form:i})},v=l=>{n("openActions",l)},U=l=>{n("switchUser",l)};return(l,i)=>l.header.type==="ACCOMMODATION"&&l.accommodations.length>0&&l.item.raw[l.header.key]?(o(),S(ba,{key:0,value:l.item.raw[l.header.key].Data,accommodations:l.accommodations,convention:l.convention,forms:l.forms,tickets:l.tickets,venues:l.venues,registration:l.item.raw[l.header.key].Registration},null,8,["value","accommodations","convention","forms","tickets","venues","registration"])):l.header.type==="EXTRAS"&&l.extras.length>0?(o(),S(Ma,{key:1,value:l.item.raw[l.header.key],extras:l.extras},null,8,["value","extras"])):l.header.type==="INTERESTS"&&l.interests.length>0?(o(),S(Na,{key:2,value:l.item.raw[l.header.key],interests:l.interests},null,8,["value","interests"])):l.header.type==="TICKET"&&l.tickets.length>0?(o(),S(La,{key:3,value:l.item.raw[l.header.key],tickets:l.tickets},null,8,["value","tickets"])):l.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_CHECKIN_STATUS"?(o(),S(Ht,{key:4,convention:l.convention,"show-controls":!1,modelValue:l.item.raw.registration,"onUpdate:modelValue":i[0]||(i[0]=u=>l.item.raw.registration=u)},null,8,["convention","modelValue"])):l.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_SUBMISSION_STATUS"||l.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_ACCOMMODATION_FORM"||l.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_ADMIN_FORM"||l.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_DEALER_FORM"||l.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_BADGE_FORM"||l.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_REGISTRATION_FORM"?(o(),T(L,{key:5},[F("ul",null,[(o(!0),T(L,null,W(l.forms.filter(u=>u.Type===E(ge).FORM_TYPE_ADMIN&&l.item.raw[l.header.key].findIndex(A=>A.Form.ID===u.ID)<0),u=>(o(),T("li",{key:u.Heading},[F("strong",Wo,I(u.Heading),1),t(K,{class:"text-grey-lighten-1",icon:"mdi:mdi-form-select",title:"Edit Submitted Data",variant:"flat",onClick:A=>r(l.item.raw.registration,u)},null,8,["onClick"])]))),128))]),F("ul",null,[(o(!0),T(L,null,W(l.item.raw[l.header.key],u=>(o(),T("li",{key:u.Heading},[F("strong",null,[O(I(u.Heading),1),u.Form.Type!==E(ge).FORM_TYPE_ADMIN?(o(),T(L,{key:0},[O(": ")],64)):M("",!0)]),u.Form.Type!==E(ge).FORM_TYPE_ADMIN?(o(),T("span",{key:0,class:Xe(E(_a)(u.Submission.Status))},I(E(Kt)(u.Submission.Status)),3)):M("",!0),t(K,{icon:"mdi:mdi-form-select",title:"Edit Submitted Data",variant:"flat",onClick:A=>r(u.Registration,u.Form)},null,8,["onClick"])]))),128))])],64)):l.header.type==="LAYOUT_ITEM_SOURCE_USER.USER_DATA_SOURCE_AVATAR"?(o(),S(zt,{key:6,class:"rounded-circle",src:l.item.raw[l.header.key],height:"32",width:"32"},null,8,["src"])):l.header.type==="LAYOUT_ITEM_SOURCE_USER.USER_DATA_SOURCE_CONTACTS"?(o(),T(L,{key:7},[l.item.raw[l.header.key].email?(o(),T("p",Zo,[ei,ti,O(I(l.item.raw[l.header.key].email),1)])):M("",!0),l.item.raw[l.header.key].telegram?(o(),T("p",ai,[li,ni,O(I(l.item.raw[l.header.key].telegram),1)])):M("",!0)],64)):l.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_PAYMENT_STATUS"?(o(),T(L,{key:8},[l.item.raw[l.header.key]=="NOT_REQUIRED"?(o(),T("div",oi,"No Payment Requested")):l.item.raw[l.header.key]=="MISSING_REQUIRED"?(o(),T("div",ii,"Partner Payment Not Requested")):l.item.raw[l.header.key]=="AWAITING_PARTNER"?(o(),T("div",si,"Awaiting Partner Payment")):l.item.raw[l.header.key]=="ALL_REQUIRED"?(o(),T("div",ui,"Awaiting Payments")):l.item.raw[l.header.key]=="REQUIRED"?(o(),T("div",ri,"Awaiting Payment")):l.item.raw[l.header.key]=="ADDITIONAL_REQUIRED"?(o(),T("div",di,"Awaiting Additional Payments")):(o(),T("div",mi,"Completed"))],64)):l.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_REGISTRATION_ACTIONS"?(o(),T(L,{key:9},[t(K,{icon:"mdi:mdi-briefcase",variant:"flat",onClick:i[1]||(i[1]=u=>v(l.item.raw[l.header.key]))}),E(rn)(l.user)?(o(),S(K,{key:0,icon:"mdi:mdi-account-switch-outline",variant:"flat",onClick:i[2]||(i[2]=u=>U(l.item.raw[l.header.key]))})):M("",!0)],64)):l.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_REGISTRATION_GROUP"?(o(),T(L,{key:10},[l.item.raw[l.header.key].length===1?(o(),T("em",ci," Not in a group ")):(o(),T(L,{key:1},[F("ul",null,[(o(!0),T(L,null,W(l.item.raw[l.header.key],u=>(o(),T("li",{key:u.UUID,class:"ml-0"},[O(" #"+I(u.Reference)+" : "+I(u.Name)+" ",1),u.IsLeader?(o(),T("strong",vi,"(Leader)")):M("",!0)]))),128))]),fi,O(" "+I(l.item.raw[l.header.key].length),1)],64))],64)):l.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_DATA_LAYOUT"?(o(),T(L,{key:11},[s.value.registration?(o(),S(Xo,{key:0,accommodations:l.accommodations,convention:l.convention,extras:l.extras,forms:l.forms,interests:l.interests,tickets:l.tickets,venues:l.venues,layouts:l.item.raw[l.header.key].Layouts,modelValue:s.value.registration,"onUpdate:modelValue":i[3]||(i[3]=u=>s.value.registration=u),onOpenActions:v,onShowForm:r},null,8,["accommodations","convention","extras","forms","interests","tickets","venues","layouts","modelValue"])):M("",!0)],64)):(o(),T(L,{key:12},[O(I(l.item.raw[l.header.key]),1)],64))}}),fa=Q({__name:"RegistrationActionTabs",props:X({alignTabs:{},class:{},fixedTabs:{type:Boolean},showArrows:{type:[String,Boolean]},tabs:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(e){const c=e,n=le(e,"modelValue");return(s,r)=>(o(),S(Ia,Tt({modelValue:n.value,"onUpdate:modelValue":r[0]||(r[0]=v=>n.value=v)},c),{default:a(()=>[(o(!0),T(L,null,W(s.tabs,v=>(o(),S(Ca,{value:v.value,key:v.value},{default:a(()=>[O(I(v.label),1)]),_:2},1032,["value"]))),128))]),_:1},16,["modelValue"]))}}),Ai=(e=void 0,c)=>e===void 0?!1:yt(e,St.GROUP_TYPE_CONVENTION,c.ConventionUUID,c).EditPaymentTransactions,kt=e=>(xt("data-v-8af8174d"),e=e(),qt(),e),Ti={class:"mb-4"},gi={class:"v-row"},_i={key:0,class:"v-col v-col-10 py-1 v-row mx-0 pl-0"},Ei={class:"v-col v-col-12 v-col-sm-4 v-col-md-3 font-weight-bold pb-0 pr-0"},pi={class:"v-col v-col-12 v-col-sm-8 v-col-md-9 font-italic pt-0 pt-sm-3 pb-sm-0 pl-sm-0"},Di={class:"v-col v-col-2 align-self-end text-right py-1 text-no-wrap"},Si=kt(()=>F("dt",{class:"v-col v-col-9 py-1 font-weight-bold totals"}," Total Charges ",-1)),yi={class:"v-col v-col-3 align-self-end text-right py-1 totals text-no-wrap"},Ii=kt(()=>F("dt",{class:"v-col v-col-9 py-1 font-weight-bold"}," Applied Total ",-1)),Ci={class:"v-col v-col-3 align-self-end text-right py-1 text-no-wrap"},Ri=kt(()=>F("dt",{class:"v-col v-col-9 py-1 font-weight-bold"}," Currently Paid ",-1)),hi={class:"v-col v-col-3 align-self-end text-right py-1 text-no-wrap"},Oi=kt(()=>F("dt",{class:"v-col v-col-9 py-1 font-weight-bold totals"}," Balance ",-1)),ki={class:"v-col v-col-3 align-self-end text-right py-1 totals text-no-wrap"},Vi=Q({__name:"PaymentActions",props:X({forms:{},title:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(e){const c=_(!1),n=_(),s=_([]),r=_(new Date().getTime()),v=_(!1),U=le(e,"modelValue"),l=_(_e(U.value));Ue(U,()=>{l.value=_e(U.value)});const i=Ae();i.getConvention(U.value.ConventionUUID).then(m=>{m&&(v.value=Ai($e(),m))});const u=()=>{i.generateRegistrationCharges(U.value.RegistrationUUID,!1).then(m=>{m&&(s.value=m.PaymentTransactions,n.value=m.Registration,r.value=new Date().getTime())}).catch(()=>{})};u();const A=()=>{i.generateRegistrationCharges(U.value.RegistrationUUID,!0).then(m=>{m&&(s.value=m.PaymentTransactions,n.value=m.Registration,r.value=new Date().getTime())})},{totalCharges:f}=pa();return(m,d)=>(o(),S(Pe,null,{default:a(()=>[t(it,null,{default:a(()=>[t(Ze,null,{default:a(()=>[O(" Payments (#"+I(U.value.Reference)+" "+I(U.value.User.DisplayName)+") ",1)]),_:1})]),_:1}),t(et,null,{default:a(()=>[n.value?(o(),T(L,{key:0},[F("h3",Ti,"#"+I(n.value.Reference)+" "+I(n.value.User.DisplayName),1),F("dl",gi,[(o(!0),T(L,null,W(s.value,D=>(o(),T(L,{key:D.PaymentTransactionUUID},[D.Type===E($t).PAYMENT_TRANSACTION_TYPE_CHARGE?(o(),T("dt",_i,[F("div",Ei,I(D.Description.split(":")[0])+": ",1),F("div",pi,I(D.Description.split(":")[1]),1)])):M("",!0),F("dd",Di," £"+I(D.Amount),1)],64))),128)),Si,F("dd",yi," £"+I(E(f)(s.value)),1),Ii,F("dd",Ci," £"+I(n.value.Total),1),Ri,F("dd",hi," £"+I(n.value.Paid),1),Oi,F("dd",ki," £"+I(n.value.Total-n.value.Paid),1)]),t(J,{class:"flex-row-reverse"},{default:a(()=>[t(V,{class:"text-right"},{default:a(()=>[t(K,{color:"primary",onClick:A},{default:a(()=>[O("Apply Charges")]),_:1})]),_:1}),!c.value&&v.value?(o(),S(V,{key:0},{default:a(()=>[t(K,{color:"secondary",onClick:d[0]||(d[0]=D=>c.value=!0)},{default:a(()=>[O("Transaction Entry")]),_:1})]),_:1})):M("",!0)]),_:1})],64)):M("",!0),t(Ga,{"can-edit":v.value,registration:U.value,"show-editor":c.value,onCloseEditor:d[1]||(d[1]=D=>c.value=!1),updated:r.value,onChange:u},null,8,["can-edit","registration","show-editor","updated"])]),_:1})]),_:1}))}}),bi=ct(Vi,[["__scopeId","data-v-8af8174d"]]),Mi=Q({__name:"RegistrationFormStatus",props:X({forms:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(e){const c=Ae(),n=le(e,"modelValue"),s=(r,v)=>{const U=n.value.Submissions.find(l=>l.SubmissionUUID==v);if(!U){r&&r("Submission not found");return}c.setSubmissionStatus(v,U.Status).then(l=>{l?(n.value.Submissions.forEach((i,u)=>{n.value.Submissions[u].Status=i.Status}),r&&r("Status Saved")):r&&r("Status not saved")}).catch(()=>{r&&r("Status not saved")})};return(r,v)=>(o(),S(Pe,null,{default:a(()=>[t(it,null,{default:a(()=>[t(Ze,null,{default:a(()=>[O("Status (#"+I(n.value.Reference)+" "+I(n.value.User.DisplayName)+")",1)]),_:1})]),_:1}),t(et,null,{default:a(()=>[t(Le,null,{default:a(()=>[(o(!0),T(L,null,W(n.value.Submissions,U=>(o(),S(Ve,{key:U.SubmissionUUID,class:"pa-0"},{default:a(()=>[t(J,{class:"py-2 align-center"},{default:a(()=>[t(V,{cols:"9",sm:"10",md:"10",lg:"9"},{default:a(()=>{var l;return[t(fe,{modelValue:U.Status,"onUpdate:modelValue":i=>U.Status=i,items:E(na),"item-text":"title","item-value":"value",variant:"outlined","hide-details":"",label:((l=r.forms.find(i=>i.FormUUID==U.FormUUID))==null?void 0:l.Name)||""},{selection:a(()=>[t(ke,{class:"mr-4 d-none d-sm-inline"},{default:a(()=>{var i;return[O(I((i=E(na).find(u=>u.value===U.Status))==null?void 0:i.icon),1)]}),_:2},1024),O(" "+I(E(Kt)(U.Status)),1)]),item:a(({item:i,props:{onClick:u}})=>[t(Ve,{title:i.title,"prepend-icon":i.raw.icon,onClick:u},null,8,["title","prepend-icon","onClick"])]),_:2},1032,["modelValue","onUpdate:modelValue","items","label"])]}),_:2},1024),t(V,{cols:"3",sm:"2",md:"2",lg:"1"},{default:a(()=>[t(mt,{class:"d-none d-sm-inline-flex",title:"Save","prepend-icon":"mdi:mdi-content-save",color:"warning",onClick:l=>s(l.callback,U.SubmissionUUID)},null,8,["onClick"]),t(mt,{class:"d-sm-none",size:"35",icon:"mdi:mdi-content-save",color:"warning",onClick:l=>s(l.callback,U.SubmissionUUID)},null,8,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1}))}}),Ni=e=>(xt("data-v-7d39acf0"),e=e(),qt(),e),Li=Ni(()=>F("p",null,"Any tags controlled through registration form fields will be reset when the applicable form is saved. If you don't know what you're doing here, don't touch!",-1)),wi={class:"mb-4"},Fi=Q({__name:"RegistrationTags",props:X({title:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(e){const c=Ae(),n=le(e,"modelValue"),s=_(_e(n.value)),r=_(!1),v=_(s.value.Tags);Ue(n,()=>{s.value=_e(n.value)});const U=({callback:l})=>{const i=[],u=[];s.value.Tags.forEach(A=>{v.value.find(m=>m.TagUUID===A.TagUUID)||i.push(A.TagUUID)}),v.value.forEach(A=>{s.value.Tags.find(m=>A.TagUUID===m.TagUUID)||u.push(A.TagUUID)}),c.updateRegistrationTags(i,u,s.value.RegistrationUUID).then(A=>{A?l&&(l("Tags Saved"),n.value.Tags=A.Tags):l&&l("Error Saving Tags")}).catch(()=>{l&&l("Error Saving Tags")})};return(l,i)=>(o(),S(Pe,null,{default:a(()=>[t(it,null,{default:a(()=>[t(Ze,null,{default:a(()=>[O("Tags (#"+I(s.value.Reference)+" "+I(s.value.User.DisplayName)+")",1)]),_:1})]),_:1}),t(et,null,{default:a(()=>[t(Jl,{class:"my-4"},{default:a(()=>[t(Xl,null,{default:a(()=>[O("Caution")]),_:1}),Li]),_:1}),F("h3",wi,"#"+I(s.value.Reference)+" "+I(s.value.User.DisplayName),1),t(Ra,{modelValue:s.value.Tags,"onUpdate:modelValue":i[0]||(i[0]=u=>s.value.Tags=u),convention:s.value.ConventionUUID,"show-key":!0,chips:!0,"show-uuid":r.value},null,8,["modelValue","convention","show-uuid"])]),_:1}),t(jt,{class:"px-4 align-start"},{default:a(()=>[t(rt,{label:"Show UUID",modelValue:r.value,"onUpdate:modelValue":i[1]||(i[1]=u=>r.value=u)},null,8,["modelValue"]),t(mt,{onClick:U,variant:"flat"})]),_:1})]),_:1}))}}),Pi=ct(Fi,[["__scopeId","data-v-7d39acf0"]]),Ua=Q({__name:"RegistrationActionWindows",props:X({accommodations:{},convention:{},extras:{},forms:{},interests:{},registration:{},tickets:{},venues:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:X(["update:registration"],["update:modelValue"]),setup(e,{emit:c}){const n=e,s=le(e,"modelValue"),v=vt(n,c,void 0,void 0,"registration");return(U,l)=>(o(),S(ha,{modelValue:s.value,"onUpdate:modelValue":l[3]||(l[3]=i=>s.value=i),disabled:!0,touch:!1},{default:a(()=>[t(Je,{value:"badges"},{default:a(()=>[s.value=="badges"?(o(),S(ce,{key:0,class:"pa-0 mx-0",fluid:!0},{default:a(()=>[t(Jt,{convention:U.convention,registration:E(v)},null,8,["convention","registration"])]),_:1})):M("",!0)]),_:1}),t(Je,{value:"emails"},{default:a(()=>[s.value=="emails"?(o(),S(ce,{key:0,class:"pa-0 mx-0",fluid:!0},{default:a(()=>[t($a,{registration:E(v)},null,8,["registration"])]),_:1})):M("",!0)]),_:1}),t(Je,{value:"notes"},{default:a(()=>[s.value=="notes"?(o(),S(ce,{key:0,class:"pa-0 mx-0",fluid:!0},{default:a(()=>[t(Ba,{convention:U.convention,expanded:!1,registration:E(v)},null,8,["convention","registration"])]),_:1})):M("",!0)]),_:1}),t(Je,{value:"payments"},{default:a(()=>[s.value=="payments"?(o(),S(ce,{key:0,class:"pa-0 mx-0",fluid:!0},{default:a(()=>[t(bi,{modelValue:E(v),"onUpdate:modelValue":l[0]||(l[0]=i=>dt(v)?v.value=i:null),forms:U.forms,title:"Registration Payments"},null,8,["modelValue","forms"])]),_:1})):M("",!0)]),_:1}),t(Je,{value:"status"},{default:a(()=>[s.value=="status"?(o(),S(ce,{key:0,class:"pa-0 mx-0",fluid:!0},{default:a(()=>[t(Mi,{modelValue:E(v),"onUpdate:modelValue":l[1]||(l[1]=i=>dt(v)?v.value=i:null),forms:U.forms},null,8,["modelValue","forms"])]),_:1})):M("",!0)]),_:1}),t(Je,{value:"tags"},{default:a(()=>[s.value=="tags"?(o(),S(ce,{key:0,class:"pa-0 mx-0",fluid:!0},{default:a(()=>[t(Pi,{modelValue:E(v),"onUpdate:modelValue":l[2]||(l[2]=i=>dt(v)?v.value=i:null),title:"Registration Tags"},null,8,["modelValue"])]),_:1})):M("",!0)]),_:1})]),_:1},8,["modelValue"]))}}),$i=(e,c)=>e===void 0?!1:yt(e,St.GROUP_TYPE_CONVENTION,c.ConventionUUID,c).ViewPaymentTransactions,Bi={key:0},Gi={key:1},Aa=Q({__name:"RegistrationActions",props:X({accommodations:{},convention:{},extras:{},forms:{},interests:{},registration:{},tickets:{},title:{},useDialog:{type:Boolean},venues:{}},{modelValue:{type:Boolean,required:!0},modelModifiers:{}}),emits:X(["update:registration"],["update:modelValue"]),setup(e,{emit:c}){const n=e,s=le(e,"modelValue"),v=vt(n,c,void 0,void 0,"registration"),U=_("notes"),l=$e(),i=[{label:"Badge",value:"badges"},{label:"Emails",value:"emails"},{label:"Notes",value:"notes"},{label:"Status",value:"status"},{label:"Tags",value:"tags"}];return $i(l,n.convention)&&i.splice(2,0,{label:"Payments",value:"payments"}),(u,A)=>u.useDialog?(o(),T("div",Bi,[t(we,{modelValue:s.value,"onUpdate:modelValue":A[3]||(A[3]=f=>s.value=f),title:u.title,"show-close-action":!0,color:"primary","close-action-label":"Close",persistent:!0,"retain-focus":!1,scrollable:!0,fullscreen:"","card-class":"ma-0 pa-0"},{extension:a(()=>[t(fa,{modelValue:U.value,"onUpdate:modelValue":A[0]||(A[0]=f=>U.value=f),tabs:i,"show-arrows":!0},null,8,["modelValue"])]),default:a(()=>[t(Ua,{modelValue:U.value,"onUpdate:modelValue":A[1]||(A[1]=f=>U.value=f),registration:E(v),"onUpdate:registration":A[2]||(A[2]=f=>dt(v)?v.value=f:null),accommodations:u.accommodations,convention:u.convention,extras:u.extras,forms:u.forms,interests:u.interests,tabs:i,tickets:u.tickets,venues:u.venues},null,8,["modelValue","registration","accommodations","convention","extras","forms","interests","tickets","venues"])]),_:1},8,["modelValue","title"])])):(o(),T("div",Gi,[t(fa,{modelValue:U.value,"onUpdate:modelValue":A[4]||(A[4]=f=>U.value=f),tabs:i,"show-arrows":!0},null,8,["modelValue"]),t(Ua,{modelValue:U.value,"onUpdate:modelValue":A[5]||(A[5]=f=>U.value=f),registration:E(v),"onUpdate:registration":A[6]||(A[6]=f=>dt(v)?v.value=f:null),accommodations:u.accommodations,convention:u.convention,extras:u.extras,forms:u.forms,interests:u.interests,tabs:i,tickets:u.tickets,venues:u.venues},null,8,["modelValue","registration","accommodations","convention","extras","forms","interests","tickets","venues"])]))}}),Yi=(e,c=500,n=!1)=>{let s;return(...r)=>{const U=function(){s=void 0,n||e.apply(void 0,r)},l=n&&!s;clearTimeout(s),s=setTimeout(U,c),l&&e.apply(void 0,r)}},Ya=(e,c)=>{e.forEach(n=>{n.Items.forEach(s=>{(s.SectionField==null||s.SectionField.Field==null)&&c.find(r=>{r.Sections.find(v=>{if(v.Fields){const U=v.Fields.find(l=>l.SectionFieldUUID===s.SectionFieldUUID);if(U)return s.SectionField=U,!0}})})})})},Hi={base:"#f44336",lighten5:"#ffebee",lighten4:"#ffcdd2",lighten3:"#ef9a9a",lighten2:"#e57373",lighten1:"#ef5350",darken1:"#e53935",darken2:"#d32f2f",darken3:"#c62828",darken4:"#b71c1c",accent1:"#ff8a80",accent2:"#ff5252",accent3:"#ff1744",accent4:"#d50000"},xi={base:"#e91e63",lighten5:"#fce4ec",lighten4:"#f8bbd0",lighten3:"#f48fb1",lighten2:"#f06292",lighten1:"#ec407a",darken1:"#d81b60",darken2:"#c2185b",darken3:"#ad1457",darken4:"#880e4f",accent1:"#ff80ab",accent2:"#ff4081",accent3:"#f50057",accent4:"#c51162"},qi={base:"#9c27b0",lighten5:"#f3e5f5",lighten4:"#e1bee7",lighten3:"#ce93d8",lighten2:"#ba68c8",lighten1:"#ab47bc",darken1:"#8e24aa",darken2:"#7b1fa2",darken3:"#6a1b9a",darken4:"#4a148c",accent1:"#ea80fc",accent2:"#e040fb",accent3:"#d500f9",accent4:"#aa00ff"},Ki={base:"#673ab7",lighten5:"#ede7f6",lighten4:"#d1c4e9",lighten3:"#b39ddb",lighten2:"#9575cd",lighten1:"#7e57c2",darken1:"#5e35b1",darken2:"#512da8",darken3:"#4527a0",darken4:"#311b92",accent1:"#b388ff",accent2:"#7c4dff",accent3:"#651fff",accent4:"#6200ea"},ji={base:"#3f51b5",lighten5:"#e8eaf6",lighten4:"#c5cae9",lighten3:"#9fa8da",lighten2:"#7986cb",lighten1:"#5c6bc0",darken1:"#3949ab",darken2:"#303f9f",darken3:"#283593",darken4:"#1a237e",accent1:"#8c9eff",accent2:"#536dfe",accent3:"#3d5afe",accent4:"#304ffe"},zi={base:"#2196f3",lighten5:"#e3f2fd",lighten4:"#bbdefb",lighten3:"#90caf9",lighten2:"#64b5f6",lighten1:"#42a5f5",darken1:"#1e88e5",darken2:"#1976d2",darken3:"#1565c0",darken4:"#0d47a1",accent1:"#82b1ff",accent2:"#448aff",accent3:"#2979ff",accent4:"#2962ff"},Qi={base:"#03a9f4",lighten5:"#e1f5fe",lighten4:"#b3e5fc",lighten3:"#81d4fa",lighten2:"#4fc3f7",lighten1:"#29b6f6",darken1:"#039be5",darken2:"#0288d1",darken3:"#0277bd",darken4:"#01579b",accent1:"#80d8ff",accent2:"#40c4ff",accent3:"#00b0ff",accent4:"#0091ea"},Ji={base:"#00bcd4",lighten5:"#e0f7fa",lighten4:"#b2ebf2",lighten3:"#80deea",lighten2:"#4dd0e1",lighten1:"#26c6da",darken1:"#00acc1",darken2:"#0097a7",darken3:"#00838f",darken4:"#006064",accent1:"#84ffff",accent2:"#18ffff",accent3:"#00e5ff",accent4:"#00b8d4"},Xi={base:"#009688",lighten5:"#e0f2f1",lighten4:"#b2dfdb",lighten3:"#80cbc4",lighten2:"#4db6ac",lighten1:"#26a69a",darken1:"#00897b",darken2:"#00796b",darken3:"#00695c",darken4:"#004d40",accent1:"#a7ffeb",accent2:"#64ffda",accent3:"#1de9b6",accent4:"#00bfa5"},Wi={base:"#4caf50",lighten5:"#e8f5e9",lighten4:"#c8e6c9",lighten3:"#a5d6a7",lighten2:"#81c784",lighten1:"#66bb6a",darken1:"#43a047",darken2:"#388e3c",darken3:"#2e7d32",darken4:"#1b5e20",accent1:"#b9f6ca",accent2:"#69f0ae",accent3:"#00e676",accent4:"#00c853"},Zi={base:"#8bc34a",lighten5:"#f1f8e9",lighten4:"#dcedc8",lighten3:"#c5e1a5",lighten2:"#aed581",lighten1:"#9ccc65",darken1:"#7cb342",darken2:"#689f38",darken3:"#558b2f",darken4:"#33691e",accent1:"#ccff90",accent2:"#b2ff59",accent3:"#76ff03",accent4:"#64dd17"},es={base:"#cddc39",lighten5:"#f9fbe7",lighten4:"#f0f4c3",lighten3:"#e6ee9c",lighten2:"#dce775",lighten1:"#d4e157",darken1:"#c0ca33",darken2:"#afb42b",darken3:"#9e9d24",darken4:"#827717",accent1:"#f4ff81",accent2:"#eeff41",accent3:"#c6ff00",accent4:"#aeea00"},ts={base:"#ffeb3b",lighten5:"#fffde7",lighten4:"#fff9c4",lighten3:"#fff59d",lighten2:"#fff176",lighten1:"#ffee58",darken1:"#fdd835",darken2:"#fbc02d",darken3:"#f9a825",darken4:"#f57f17",accent1:"#ffff8d",accent2:"#ffff00",accent3:"#ffea00",accent4:"#ffd600"},as={base:"#ffc107",lighten5:"#fff8e1",lighten4:"#ffecb3",lighten3:"#ffe082",lighten2:"#ffd54f",lighten1:"#ffca28",darken1:"#ffb300",darken2:"#ffa000",darken3:"#ff8f00",darken4:"#ff6f00",accent1:"#ffe57f",accent2:"#ffd740",accent3:"#ffc400",accent4:"#ffab00"},ls={base:"#ff9800",lighten5:"#fff3e0",lighten4:"#ffe0b2",lighten3:"#ffcc80",lighten2:"#ffb74d",lighten1:"#ffa726",darken1:"#fb8c00",darken2:"#f57c00",darken3:"#ef6c00",darken4:"#e65100",accent1:"#ffd180",accent2:"#ffab40",accent3:"#ff9100",accent4:"#ff6d00"},ns={base:"#ff5722",lighten5:"#fbe9e7",lighten4:"#ffccbc",lighten3:"#ffab91",lighten2:"#ff8a65",lighten1:"#ff7043",darken1:"#f4511e",darken2:"#e64a19",darken3:"#d84315",darken4:"#bf360c",accent1:"#ff9e80",accent2:"#ff6e40",accent3:"#ff3d00",accent4:"#dd2c00"},os={base:"#795548",lighten5:"#efebe9",lighten4:"#d7ccc8",lighten3:"#bcaaa4",lighten2:"#a1887f",lighten1:"#8d6e63",darken1:"#6d4c41",darken2:"#5d4037",darken3:"#4e342e",darken4:"#3e2723"},is={base:"#607d8b",lighten5:"#eceff1",lighten4:"#cfd8dc",lighten3:"#b0bec5",lighten2:"#90a4ae",lighten1:"#78909c",darken1:"#546e7a",darken2:"#455a64",darken3:"#37474f",darken4:"#263238"},ss={base:"#9e9e9e",lighten5:"#fafafa",lighten4:"#f5f5f5",lighten3:"#eeeeee",lighten2:"#e0e0e0",lighten1:"#bdbdbd",darken1:"#757575",darken2:"#616161",darken3:"#424242",darken4:"#212121"},us={black:"#000000",white:"#ffffff",transparent:"#ffffff00"},rs={red:Hi,pink:xi,purple:qi,deepPurple:Ki,indigo:ji,blue:zi,lightBlue:Qi,cyan:Ji,teal:Xi,green:Wi,lightGreen:Zi,lime:es,yellow:ts,amber:as,orange:ls,deepOrange:ns,brown:os,blueGrey:is,grey:ss,shades:us},ds=F("h4",null,"Grid Size (Max 12)",-1),ms={key:0,class:"text-warning text-right pl-1"},cs=Q({__name:"EditAdminLayout",props:X({convention:{},layouts:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:X(["change","delete"],["update:modelValue"]),setup(e,{emit:c}){const n=le(e,"modelValue"),s=_([]),r=Ae(),v=c,U=_(Object.assign({},...e.layouts.map(N=>N.Panels.map(C=>C.Items.map(g=>{if(!g.Meta)return{};const h={};return Object.entries(g.Meta).forEach(p=>{Array.isArray(p[1])?(h[`${g.LayoutItemUUID}.${p[0]}`]=[],p[1].forEach(Z=>{h[`${g.LayoutItemUUID}.${p[0]}`].push(Z.toString())})):p[1]!==void 0&&p[1]!==null&&(h[`${g.LayoutItemUUID}.${p[0]}`]=[p[1].toString()])}),h}))).flat(2))),l=_(`
Are you sure you wish to delete this layout? All panels relating to it will be
removed and can not be recovered. This action can not be undone once saved.
You will have to create a new layout.
`),i=_(!1),u=_([]);r.getConventionTags(e.convention.ConventionUUID).then(N=>{N&&(u.value=N)}).catch(()=>{});const A=()=>({ID:0,LayoutPanelUUID:Ie(),AdminLayoutID:n.value.ID,AdminLayoutUUID:n.value.AdminLayoutUUID,Name:"",Order:n.value.Panels.length+1,Items:[],PanelStyle:ye.PANEL_STYLE_FLEX,RequiredFormType:ge.FORM_TYPE_NIL,RequiredGroupMemberships:[],RequiredRegistrationTags:[],Meta:{}}),f=N=>()=>({ID:0,LayoutItemUUID:Ie(),LayoutPanelID:N.ID,LayoutPanelUUID:N.LayoutPanelUUID,Label:"",SourceType:Ce.LAYOUT_ITEM_SOURCE_FORM,SectionFieldID:void 0,SectionFieldUUID:void 0,SectionField:void 0,MetaField:void 0,UserField:void 0,Align:"",Order:N.Items.length+1,DefaultSort:!1,Meta:{}}),m=(N,C)=>{N.Meta[C]=U.value[`${N.LayoutItemUUID}.${C}`]},d=N=>{const C=s.value.find(g=>g.value===N.SectionFieldUUID);C&&(N.SectionFieldID=C.object.ID,N.SectionField=C.object)};r.getConventionForms(n.value.ConventionUUID).then(N=>{N&&(N.forEach(C=>C.Sections.forEach(g=>g.Fields&&s.value.push(...g.Fields.map(h=>{var Z;return{title:`${C.Name} - ${g.Name} - ${(Z=h.Field)==null?void 0:Z.Name}`,value:h.SectionFieldUUID,object:h}})))),s.value.sort(El("title")),Ya(n.value.Panels,N))});const D=se(()=>{switch(n.value.Type){case Ne.ADMIN_LAYOUT_PANELS:return"Panels";case Ne.ADMIN_LAYOUT_TABLE:return"Tabs"}return"Unknown"});Ue(n,()=>{v("change")},{deep:!0});const k=se(()=>{const N=/([a-zA-Z]+)(\d+)/;return Object.entries(rs).map(([C,g])=>Object.entries(g).map(([h,p])=>{const Z=N.exec(h);return!Z||Z.length<3?void 0:{Title:`${wt(C).split(/(?=[A-Z])/).join(" ")} ${wt(Z[1])} ${wt(Z[2])}`,CSSName:`${C}-${Z[1]}-${Z[2]}`,Value:p}})).flat().filter(C=>!!C).sort((C,g)=>C.Title>g.Title?1:C.Title==g.Title?0:-1)});return console.log(k),(N,C)=>(o(),S(ce,{class:"px-0 mx-0",fluid:!0},{default:a(()=>[t(J,null,{default:a(()=>[t(V,{cols:"12",sm:"6"},{default:a(()=>[t(oe,{modelValue:n.value.Name,"onUpdate:modelValue":C[0]||(C[0]=g=>n.value.Name=g),label:"Name",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),t(V,{cols:"12",sm:"6"},{default:a(()=>[t(fe,{modelValue:n.value.Type,"onUpdate:modelValue":C[1]||(C[1]=g=>n.value.Type=g),label:"Layout Type",items:E(tn),"item-title":"title","item-value":"value",variant:"outlined","hide-details":""},null,8,["modelValue","items"])]),_:1})]),_:1}),t(J,null,{default:a(()=>[t(V,null,{default:a(()=>[t(Bt,{modelValue:n.value.Panels,"onUpdate:modelValue":C[2]||(C[2]=g=>n.value.Panels=g),"new-item":A,closeable:!1,title:D.value,label:"Name","slot-name-prefix":"panel"},We({_:2},[W(n.value.Panels,(g,h)=>({name:`panel_${h}`,fn:a(()=>[t(ce,{class:"px-0 mx-0",fluid:!0},{default:a(()=>[t(J,null,{default:a(()=>[t(V,{cols:"12",sm:"6"},{default:a(()=>[t(oe,{modelValue:g.Name,"onUpdate:modelValue":p=>g.Name=p,label:"Name",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),n.value.Type===E(Ne).ADMIN_LAYOUT_PANELS?(o(),S(V,{key:0,cols:"12",sm:"6"},{default:a(()=>[t(fe,{modelValue:g.PanelStyle,"onUpdate:modelValue":p=>g.PanelStyle=p,items:E(nn),clearable:!0,label:"Panel Style",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"])]),_:2},1024)):M("",!0),t(V,{cols:"12",sm:"6"},{default:a(()=>[t(fe,{modelValue:g.RequiredFormType,"onUpdate:modelValue":p=>g.RequiredFormType=p,items:E(Dl),clearable:!0,label:"Required Form",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"])]),_:2},1024),t(V,{cols:"12",sm:"6"},{default:a(()=>[t(ya,{label:"Required Groups",variant:"outlined",modelValue:g.RequiredGroupMemberships,"onUpdate:modelValue":p=>g.RequiredGroupMemberships=p,convention:n.value.ConventionUUID,chips:"",clearable:"",hint:"Groups that a user must be in to see this panel. (Any one)"},null,8,["modelValue","onUpdate:modelValue","convention"])]),_:2},1024),t(V,{cols:"12",sm:"6"},{default:a(()=>[t(Ra,{label:"Registration Tags",variant:"outlined",modelValue:g.RequiredRegistrationTags,"onUpdate:modelValue":p=>g.RequiredRegistrationTags=p,convention:n.value.ConventionUUID,chips:"",clearable:"",hint:"Tags that a registration must have to appear in results. (Any one)"},null,8,["modelValue","onUpdate:modelValue","convention"])]),_:2},1024)]),_:2},1024),n.value.Type===E(Ne).ADMIN_LAYOUT_PANELS&&g.PanelStyle===E(ye).PANEL_STYLE_FLEX?(o(),S(J,{key:0},{default:a(()=>[t(V,{cols:"12",class:"py-0 my-0"},{default:a(()=>[ds]),_:1}),t(V,{cols:"6",sm:"4",lg:"2"},{default:a(()=>[t(oe,{modelValue:g.Meta.cols,"onUpdate:modelValue":p=>g.Meta.cols=p,modelModifiers:{number:!0},clearable:!0,"hide-details":"",label:"Default",type:"number",min:"1",max:"12"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),t(V,{cols:"6",sm:"4",lg:"2"},{default:a(()=>[t(oe,{modelValue:g.Meta.cols_xs,"onUpdate:modelValue":p=>g.Meta.cols_xs=p,modelModifiers:{number:!0},clearable:!0,"hide-details":"",label:"XS",type:"number",min:"1",max:"12"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),t(V,{cols:"6",sm:"4",lg:"2"},{default:a(()=>[t(oe,{modelValue:g.Meta.cols_sm,"onUpdate:modelValue":p=>g.Meta.cols_sm=p,modelModifiers:{number:!0},clearable:!0,"hide-details":"",label:"SM",type:"number",min:"1",max:"12"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),t(V,{cols:"6",sm:"4",lg:"2"},{default:a(()=>[t(oe,{modelValue:g.Meta.cols_md,"onUpdate:modelValue":p=>g.Meta.cols_md=p,modelModifiers:{number:!0},clearable:!0,"hide-details":"",label:"MD",type:"number",min:"1",max:"12"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),t(V,{cols:"6",sm:"4",lg:"2"},{default:a(()=>[t(oe,{modelValue:g.Meta.cols_lg,"onUpdate:modelValue":p=>g.Meta.cols_lg=p,modelModifiers:{number:!0},clearable:!0,"hide-details":"",label:"LG",type:"number",min:"1",max:"12"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),t(V,{cols:"6",sm:"4",lg:"2"},{default:a(()=>[t(oe,{modelValue:g.Meta.cols_xl,"onUpdate:modelValue":p=>g.Meta.cols_xl=p,modelModifiers:{number:!0},clearable:!0,"hide-details":"",label:"XL",type:"number",min:"1",max:"12"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)):M("",!0)]),_:2},1024),t(Bt,{modelValue:g.Items,"onUpdate:modelValue":p=>g.Items=p,"new-item":f(g),closeable:!1,title:"Items",label:"Label","slot-name-prefix":"item"},We({_:2},[W(g.Items,(p,Z)=>({name:`item_${Z}`,fn:a(()=>[t(ce,{class:"px-0 mx-0",fluid:!0},{default:a(()=>{var z,re;return[t(J,null,{default:a(()=>[t(V,{cols:"12",sm:"6"},{default:a(()=>[t(oe,{modelValue:p.Label,"onUpdate:modelValue":$=>p.Label=$,label:"Name",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024),t(J,null,{default:a(()=>[t(V,{cols:"12",sm:"6"},{default:a(()=>[t(fe,{modelValue:p.SourceType,"onUpdate:modelValue":$=>p.SourceType=$,label:"Source Type",items:E(an),"item-title":"title","item-value":"value",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"])]),_:2},1024),t(V,{cols:"12",sm:"6"},{default:a(()=>[p.SourceType==="LAYOUT_ITEM_SOURCE_FORM"?(o(),S(fe,{key:0,modelValue:p.SectionFieldUUID,"onUpdate:modelValue":$=>p.SectionFieldUUID=$,label:"Form Data",items:s.value,"item-title":"title","item-value":"value",variant:"outlined","hide-details":"",onBlur:$=>d(p)},null,8,["modelValue","onUpdate:modelValue","items","onBlur"])):p.SourceType==="LAYOUT_ITEM_SOURCE_META"?(o(),S(fe,{key:1,modelValue:p.MetaField,"onUpdate:modelValue":$=>p.MetaField=$,label:"Miscellaneous Data",items:E(ln),"item-title":"title","item-value":"value",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"])):p.SourceType==="LAYOUT_ITEM_SOURCE_USER"?(o(),S(fe,{key:2,modelValue:p.UserField,"onUpdate:modelValue":$=>p.UserField=$,label:"User Profile Data",items:E(on),"item-title":"title","item-value":"value",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"])):M("",!0)]),_:2},1024)]),_:2},1024),N.layouts&&p.SourceType==="LAYOUT_ITEM_SOURCE_FORM"&&((re=(z=p.SectionField)==null?void 0:z.Field)==null?void 0:re.Type)===E(ga).TEXT?(o(),S(J,{key:0},{default:a(()=>[t(V,{cols:"12",xs:"6",sm:"6",lg:"3"},{default:a(()=>[t(rt,{modelValue:p.Meta.DirectEdit,"onUpdate:modelValue":$=>p.Meta.DirectEdit=$,label:"Direct Edit","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),t(V,{cols:"12",xs:"6",sm:"6",lg:"3"},{default:a(()=>[t(fe,{modelValue:p.Meta.DirectEditPermission,"onUpdate:modelValue":$=>p.Meta.DirectEditPermission=$,label:"Minimum Permission Required",items:["View","Edit"],"hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)):M("",!0),N.layouts&&p.SourceType==="LAYOUT_ITEM_SOURCE_META"&&p.MetaField===E(H).META_DATA_SOURCE_BADGE_DISPLAY?(o(),S(J,{key:1},{default:a(()=>[t(V,{cols:"6",sm:"4",lg:"2"},{default:a(()=>[t(rt,{modelValue:p.Meta.HideDownloadButton,"onUpdate:modelValue":$=>p.Meta.HideDownloadButton=$,label:"Hide Download Button"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),t(V,{cols:"6",sm:"4",lg:"2"},{default:a(()=>[t(rt,{modelValue:p.Meta.HideNFCButton,"onUpdate:modelValue":$=>p.Meta.HideNFCButton=$,label:"Hide NFC Button"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)):M("",!0),N.layouts&&p.SourceType==="LAYOUT_ITEM_SOURCE_META"&&p.MetaField===E(H).META_DATA_SOURCE_DATA_LAYOUT?(o(),S(J,{key:2},{default:a(()=>[t(V,{cols:"6",sm:"4",lg:"2"},{default:a(()=>[t(fe,{modelValue:U.value[`${p.LayoutItemUUID}.LayoutUUID`],"onUpdate:modelValue":[$=>U.value[`${p.LayoutItemUUID}.LayoutUUID`]=$,$=>m(p,"LayoutUUID")],clearable:!0,items:N.layouts.filter($=>$.Type===E(Ne).ADMIN_LAYOUT_PANELS)||[],multiple:!0,label:"Data Display","item-title":"Name","item-value":"AdminLayoutUUID",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"])]),_:2},1024)]),_:2},1024)):M("",!0),N.layouts&&p.SourceType==="LAYOUT_ITEM_SOURCE_META"&&p.MetaField===E(H).META_DATA_SOURCE_TAGS?(o(),S(J,{key:3},{default:a(()=>[t(V,{cols:"6",sm:"6",md:"6",lg:"6"},{default:a(()=>[t(fe,{modelValue:U.value[`${p.LayoutItemUUID}.Tags`],"onUpdate:modelValue":[$=>U.value[`${p.LayoutItemUUID}.Tags`]=$,$=>m(p,"Tags")],clearable:!0,items:u.value||[],multiple:!0,chips:!0,label:"Tags to Display","item-title":"Title","item-value":"TagUUID",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"]),!U.value[p.LayoutItemUUID]||U.value[p.LayoutItemUUID].length===0?(o(),T("small",ms," Will show all tags ")):M("",!0)]),_:2},1024),t(V,{cols:"6"},{default:a(()=>[t(fe,{modelValue:p.Meta.TagColour,"onUpdate:modelValue":$=>p.Meta.TagColour=$,items:k.value,label:"Colour","item-title":"Title","item-value":"Value",variant:"outlined","hide-details":""},{selection:a(({item:$})=>[t(K,{size:"x-small",color:$.raw.Value,class:"mr-2"},null,8,["color"]),O(" "+I($.title),1)]),item:a(({props:$,item:Y})=>[t(Ve,Ul(fl($)),{prepend:a(()=>[t(K,{size:"x-small",color:Y.raw.Value,class:"mr-2"},null,8,["color"])]),_:2},1040)]),_:2},1032,["modelValue","onUpdate:modelValue","items"])]),_:2},1024)]),_:2},1024)):M("",!0),n.value.Type===E(Ne).ADMIN_LAYOUT_TABLE&&(p.SourceType!==E(Ce).LAYOUT_ITEM_SOURCE_META||p.MetaField!==E(H).META_DATA_SOURCE_DATA_LAYOUT)?(o(),S(J,{key:4},{default:a(()=>[t(V,null,{default:a(()=>[t(rt,{modelValue:p.DefaultSort,"onUpdate:modelValue":$=>p.DefaultSort=$,label:"Default Sort","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)):M("",!0)]}),_:2},1024)])}))]),1032,["modelValue","onUpdate:modelValue","new-item"])])}))]),1032,["modelValue","title"])]),_:1})]),_:1}),t(J,null,{default:a(()=>[t(V,null,{default:a(()=>[t(K,{onClick:C[3]||(C[3]=g=>i.value=!0),"prepend-icon":"mdi:mdi-delete",color:"red-darken-4"},{default:a(()=>[O("Delete Layout")]),_:1})]),_:1})]),_:1}),i.value?(o(),S(Oa,{key:0,modelValue:i.value,"onUpdate:modelValue":C[4]||(C[4]=g=>i.value=g),message:l.value,title:"Delete Layout",subtitle:"Removes this layout and all it's panels",onDelete:C[5]||(C[5]=g=>v("delete"))},null,8,["modelValue","message"])):M("",!0)]),_:1}))}}),vs=Q({__name:"EditAdminLayouts",props:X({title:{},convention:{}},{modelValue:{type:Boolean,required:!0},modelModifiers:{}}),emits:X(["save"],["update:modelValue"]),setup(e,{emit:c}){const n=le(e,"modelValue"),s=c,r=_([]),v=_([]),U=_([]),l=Ae(),i=()=>({ID:0,AdminLayoutUUID:Ie(),ConventionID:e.convention.ID,ConventionUUID:e.convention.ConventionUUID,Name:"New Layout",Type:Ne.ADMIN_LAYOUT_PANELS,Panels:[]}),u=()=>{let f=!1;[...new Set(U.value)].forEach(d=>{const D=r.value.findIndex(k=>k.AdminLayoutUUID===d);D<0||D>=r.value.length||(l.saveAdminLayout(r.value[D]).then(k=>{k&&r.value.splice(D,1,k)}).catch(()=>{}),f=!0)}),v.value.forEach(d=>{l.deleteAdminLayout(d).catch(()=>{})}),v.value=[],U.value=[],f&&s("save")},A=f=>{const m=r.value.findIndex(d=>d.AdminLayoutUUID===f.AdminLayoutUUID);m<0||m>=r.value.length||(r.value[m].ID>0&&v.value.push(f.AdminLayoutUUID),r.value.splice(m,1))};return l.getConventionAdminLayouts(e.convention.ConventionUUID).then(f=>{f&&(r.value=f)}).catch(()=>[]),(f,m)=>(o(),S(pt,{modelValue:n.value,"onUpdate:modelValue":m[2]||(m[2]=d=>n.value=d),scrollable:!0,"retain-focus":!0,persistent:!0,fullscreen:!0},{default:a(()=>[t(Bt,{modelValue:r.value,"onUpdate:modelValue":m[0]||(m[0]=d=>r.value=d),"new-item":i,closeable:!0,"show-delete":!1,"show-save":!0,"has-order":!1,title:f.title,label:"Name","slot-name-prefix":"panel",onClose:m[1]||(m[1]=d=>n.value=!1),onSave:u},We({_:2},[W(r.value,(d,D)=>({name:`panel_${D}`,fn:a(()=>[t(ce,{class:"px-0 mx-0",fluid:!0},{default:a(()=>[t(J,null,{default:a(()=>[t(V,{cols:"12"},{default:a(()=>[t(cs,{modelValue:r.value[D],"onUpdate:modelValue":k=>r.value[D]=k,convention:f.convention,layouts:r.value,onChange:k=>U.value.push(d.AdminLayoutUUID),onDelete:k=>A(d)},null,8,["modelValue","onUpdate:modelValue","convention","layouts","onChange","onDelete"])]),_:2},1024)]),_:2},1024)]),_:2},1024)])}))]),1032,["modelValue","title"])]),_:1},8,["modelValue"]))}}),fs=["colspan"],Us={style:{opacity:"var(--v-medium-emphasis-opacity)"}},lu=Q({__name:"RegistrationsView",emits:["pageTitle"],setup(e,{emit:c}){var ea;const n=It();c("pageTitle","Registration Manager");const r=Al(),v=Tl(),U=_(!0);let l=((ea=r.params.convention)==null?void 0:ea.toString())||"";const i=_({ID:0,ConventionUUID:Ie(),OrganisationID:0,OrganisationUUID:Lt,Name:"New Convention",Description:"",DetailLink:"",Logo:"",Slug:"",Accommodation:[],Tickets:[],Extras:[],Interests:[],Visible:!1}),u=Ae(),A=gl.getInstance(),f=_([]),m=_({ID:0,AdminLayoutUUID:Ie(),ConventionID:i.value.ID,ConventionUUID:i.value.ConventionUUID,Name:"Registration Table",Type:Ne.ADMIN_LAYOUT_TABLE,Panels:[]}),d=_([]),D=_([]),k=_([]),N=_([]),C=_([]),g=_([]),h=_(1),p=_(10),Z=_([]),z=_(0),re=_(!1),$=_(""),Y=_(""),G=_(""),B=_(""),w=_({FieldUUID:"591c9bca-c78c-4e97-8aef-bc596ef472fb",Value:""}),ee=_({FieldUUID:"50189b21-6c55-4c99-a38f-7740a01ec4a4",Value:""}),ve=_({FieldUUID:"1523ef15-f2c3-46b9-a687-dcd7bc2c0a50",Value:""}),ie=_({FieldUUID:"926d43c6-a743-4ab7-bef2-060d762d37a9",Value:""}),De=_(new Map([["591c9bca-c78c-4e97-8aef-bc596ef472fb",w.value],["50189b21-6c55-4c99-a38f-7740a01ec4a4",ee.value],["1523ef15-f2c3-46b9-a687-dcd7bc2c0a50",ve.value],["926d43c6-a743-4ab7-bef2-060d762d37a9",ie.value]])),tt=_(""),at=_(""),lt=_([]),Re=_([]),Be=_([]),Ge=_([]),Ye=_([]),He=_([]),Se=_(0),Ee=_(),xe=_(!1),Xt=_(!1),Ha=_(!1),ft=_(),Wt=_(),st=_(),nt=_(!1),xa=$e(),Te=Yi(()=>{Y.value=Date.now().toString()});Ue($,R=>{const y=g.value.find(P=>P.uuid===R);if(y){const P=y.headers.find(b=>b.defaultSort===!0);P&&(Z.value=[{key:P.key,order:"asc"}],lt.value=[{key:P.key,order:"asc"}])}Ut({page:1,itemsPerPage:p.value,sortBy:lt.value})}),Ue(Se,R=>{R===8&&Zt()}),Ue(tt,()=>{Te()}),Ue(at,()=>{Te()});const qa=()=>{d.value=[],k.value=[],N.value=[],g.value=[];try{u.getConventionAdminLayoutByName(i.value.ConventionUUID,"Registration Table").then(R=>{Se.value+=1,R?m.value=R:(m.value.ConventionID=i.value.ID,m.value.ConventionUUID=i.value.ConventionUUID)})}catch{m.value.ConventionID=i.value.ID,m.value.ConventionUUID=i.value.ConventionUUID}try{u.getConventionAdminLayouts(i.value.ConventionUUID).then(R=>{Se.value+=1,R&&(R.forEach(y=>{y.Panels.sort((P,b)=>P.Order>b.Order?1:P.Order===b.Order?0:-1),y.Panels.forEach(P=>{P.Items.sort((b,de)=>b.Order>de.Order?1:b.Order===de.Order?0:-1)})}),k.value=R)})}catch{}try{u.getConventionForms(i.value.ConventionUUID).then(R=>{Se.value+=1,R&&(d.value=R)})}catch{}try{u.getConventionAccommodation(i.value.ConventionUUID).then(R=>{Se.value+=1,R&&(Re.value=R)})}catch{}try{u.getConventionVenues(i.value.ConventionUUID).then(R=>{Se.value+=1,R&&(He.value=R)})}catch{}try{u.getConventionExtras(i.value.ConventionUUID).then(R=>{Se.value+=1,R&&(Be.value=R)})}catch{}try{u.getConventionInterests(i.value.ConventionUUID).then(R=>{Se.value+=1,R&&(Ge.value=R)})}catch{}try{u.getConventionTickets(i.value.ConventionUUID).then(R=>{Se.value+=1,R&&(Ye.value=R)})}catch{}try{u.getConventionGroups(i.value.ConventionUUID).then(R=>{R&&(D.value=R.sort((y,P)=>y.Name.localeCompare(P.Name)))})}catch{}try{u.getConventionTags(i.value.ConventionUUID).then(R=>{R&&(C.value=R.sort((y,P)=>y.Title.localeCompare(P.Title)).map(y=>(y.Title=`${y.Title} [${y.Key}]`,y)))})}catch{}},Ut=({page:R,itemsPerPage:y,sortBy:P})=>{U.value=!0,h.value=R,Z.value=P;const b=g.value.find(me=>me.uuid==$.value),de=b==null?void 0:b.layout.Items;let ue="",qe="";if(P&&de&&P.length>=1){const me=de.find(bt=>bt.LayoutItemUUID==P[0].key);switch(qe=P[0].order||"asc",me==null?void 0:me.MetaField){case H.META_DATA_SOURCE_ACCOMMODATION_FORM:ue="submission.status";break;case H.META_DATA_SOURCE_BADGE_FORM:ue="submission.status";break;case H.META_DATA_SOURCE_DEALER_FORM:ue="submission.status";break;case H.META_DATA_SOURCE_REGISTRATION_FORM:ue="submission.status";break;case H.META_DATA_SOURCE_REGISTRATION_REFERENCE:ue="reference";break;case H.META_DATA_SOURCE_SUBMISSION_DATE:ue="created";break;case H.META_DATA_SOURCE_SUBMISSION_STATUS:ue="submission.status";break}switch(me==null?void 0:me.UserField){case ne.USER_DATA_SOURCE_DISPLAY_NAME:ue="user.display_name";break;case ne.USER_DATA_SOURCE_EMAIL:ue="user.email";break;case ne.USER_DATA_SOURCE_FIRST_NAME:ue="user.firstname";break;case ne.USER_DATA_SOURCE_HANDLE:ue="user.handle";break;case ne.USER_DATA_SOURCE_LAST_NAME:ue="user.lastname";break}}try{const me={Direction:qe,Limit:y,Offset:(R-1)*y,Order:ue};b&&(me.PanelUUID=b==null?void 0:b.layout.LayoutPanelUUID),(b==null?void 0:b.layout.RequiredFormType)===ge.FORM_TYPE_ACCOMMODATION&&(me.Accommodation=!0),(b==null?void 0:b.layout.RequiredFormType)===ge.FORM_TYPE_BADGE&&(me.Badge=!0),(b==null?void 0:b.layout.RequiredFormType)===ge.FORM_TYPE_DEALER&&(me.Dealer=!0),(b==null?void 0:b.layout.RequiredFormType)===ge.FORM_TYPE_REGISTRATION&&(me.Registration=!0),me.GroupUUID=tt.value||Lt,me.TagUUID=at.value||Lt,me.Email=B.value,me.Reference=G.value,me.FieldValues=Array.from(De.value.values());const bt=Y.value;u.searchConventionRegistrations(i.value.ConventionUUID,me).then(Mt=>{Mt&&bt===Y.value&&(z.value=Mt.Total,N.value=Mt.Registrations,g.value.forEach(Nt=>{const al=Nt.layout;Nt.items=N.value.map(q=>{const At=[];let be;q.Leader?be=q:be=q.Primary,At.push({Name:be.User.DisplayName,UUID:be.UserUUID,UserUUID:be.User.UserUUID,IsLeader:!0,Reference:be.Reference,Paid:be.Paid,Total:be.Total}),At.push(...be.Members.map(Me=>({Name:Me.User.DisplayName,UUID:Me.UserUUID,UserUUID:Me.User.UserUUID,IsLeader:!1,Reference:Me.Reference,Paid:Me.Paid,Total:Me.Total})));const te={};return Nt.headers.forEach(Me=>{var ta;const x=al.Items.find(ut=>ut.LayoutItemUUID===Me.key);if(x){if(x.SourceType==="LAYOUT_ITEM_SOURCE_FORM"&&x.SectionField)q.Submissions.forEach(ut=>{const ot=ut.Data.find(j=>j.SectionFieldUUID===x.SectionFieldUUID);if(ot){Me.type===ga.ACCOMMODATION?te[x.LayoutItemUUID]={Data:ot.Data,Registration:q}:te[x.LayoutItemUUID]=ot.Data;return}});else if(x.SourceType==="LAYOUT_ITEM_SOURCE_USER"&&x.UserField)switch(x.UserField){case ne.USER_DATA_SOURCE_AVATAR:te[x.LayoutItemUUID]=n.GetProfileImageURL(q.UserUUID);break;case ne.USER_DATA_SOURCE_CONTACTS:te[x.LayoutItemUUID]={},q.User.Generated&&q.User.Generated.telegram_handle&&(te[x.LayoutItemUUID].telegram=`@${q.User.Generated.telegram_handle}`),te[x.LayoutItemUUID].email=q.User.Additional.Email;break;case ne.USER_DATA_SOURCE_DISPLAY_NAME:te[x.LayoutItemUUID]=q.User.DisplayName;break;case ne.USER_DATA_SOURCE_EMAIL:te[x.LayoutItemUUID]=q.User.Additional.Email;break;case ne.USER_DATA_SOURCE_HANDLE:te[x.LayoutItemUUID]=q.User.Handle;break;case ne.USER_DATA_SOURCE_DATE_OF_BIRTH:te[x.LayoutItemUUID]=q.User.Additional.DOB;break;case ne.USER_DATA_SOURCE_FIRST_NAME:te[x.LayoutItemUUID]=q.User.Additional.FirstName;break;case ne.USER_DATA_SOURCE_LAST_NAME:te[x.LayoutItemUUID]=q.User.Additional.LastName;break;case ne.USER_DATA_SOURCE_TELEGRAM:q.User.Generated&&q.User.Generated.telegram_handle?te[x.LayoutItemUUID]=`@${q.User.Generated.telegram_handle}`:te[x.LayoutItemUUID]="";break}else if(x.SourceType==="LAYOUT_ITEM_SOURCE_META"&&x.MetaField){const ut=(ta=d.value.find(j=>j.Type===ge.FORM_TYPE_REGISTRATION))==null?void 0:ta.FormUUID,ot=q.Submissions.find(j=>j.FormUUID===ut);switch(x.MetaField){case H.META_DATA_SOURCE_REGISTRATION_ACTIONS:te[x.LayoutItemUUID]=q;break;case H.META_DATA_SOURCE_REGISTRATION_GROUP:te[x.LayoutItemUUID]=At;break;case H.META_DATA_SOURCE_REGISTRATION_REFERENCE:te[x.LayoutItemUUID]=q.Reference;break;case H.META_DATA_SOURCE_SUBMISSION_DATE:if(ot){const j=new Date(ot.CreatedAt||"");te[x.LayoutItemUUID]=`${j.getFullYear()}-${(j.getMonth()+1).toString().padStart(2,"0")}-${j.getDate().toString().padStart(2,"0")} ${j.getHours().toString().padStart(2,"0")}:${j.getMinutes().toString().padStart(2,"0")}:${j.getSeconds().toString().padStart(2,"0")}`}else{const j=new Date(q.CreatedAt||"");te[x.LayoutItemUUID]=`${j.getFullYear()}-${(j.getMonth()+1).toString().padStart(2,"0")}-${j.getDate().toString().padStart(2,"0")} ${j.getHours().toString().padStart(2,"0")}:${j.getMinutes().toString().padStart(2,"0")}:${j.getSeconds().toString().padStart(2,"0")}`}break;case H.META_DATA_SOURCE_ACCOMMODATION_FORM:te[x.LayoutItemUUID]=q.Submissions.map(j=>{const ae=d.value.find(Ke=>Ke.FormUUID===j.FormUUID);return{Heading:ae==null?void 0:ae.Heading,Form:ae,Submission:j,Registration:q}}).filter(j=>{var ae;return((ae=j.Form)==null?void 0:ae.Type)===ge.FORM_TYPE_ACCOMMODATION});break;case H.META_DATA_SOURCE_BADGE_FORM:te[x.LayoutItemUUID]=q.Submissions.map(j=>{const ae=d.value.find(Ke=>Ke.FormUUID===j.FormUUID);return{Heading:ae==null?void 0:ae.Heading,Form:ae,Submission:j,Registration:q}}).filter(j=>{var ae;return((ae=j.Form)==null?void 0:ae.Type)===ge.FORM_TYPE_BADGE});break;case H.META_DATA_SOURCE_DEALER_FORM:te[x.LayoutItemUUID]=q.Submissions.map(j=>{const ae=d.value.find(Ke=>Ke.FormUUID===j.FormUUID);return{Heading:ae==null?void 0:ae.Heading,Form:ae,Submission:j,Registration:q}}).filter(j=>{var ae;return((ae=j.Form)==null?void 0:ae.Type)===ge.FORM_TYPE_DEALER});break;case H.META_DATA_SOURCE_PAYMENT_STATUS:if(q.Paid===0&&q.Total)te[x.LayoutItemUUID]="REQUIRED";else if(q.Total>q.Paid)te[x.LayoutItemUUID]="ADDITIONAL_REQUIRED";else{const j=At.find(ae=>ae.Paid===0&&(ae.Total||0)>0);if(j){q.Total===0&&j.Total===0?te[x.LayoutItemUUID]="NOT_REQUIRED":q.Total===0&&j.Total||q.Total>0&&j.Total===0?te[x.LayoutItemUUID]="MISSING_REQUIRED":q.Paid>=q.Total?te[x.LayoutItemUUID]="AWAITING_PARTNER":te[x.LayoutItemUUID]="ALL_REQUIRED";break}else q.Total===0?te[x.LayoutItemUUID]="NOT_REQUIRED":te[x.LayoutItemUUID]="COMPLETE"}break;case H.META_DATA_SOURCE_SUBMISSION_STATUS:Ql(q.Submissions,d.value),te[x.LayoutItemUUID]=q.Submissions.map(j=>{const ae=d.value.find(Ke=>Ke.FormUUID===j.FormUUID);return{Heading:ae==null?void 0:ae.Heading,Form:ae,Submission:j,Registration:q}});break;case H.META_DATA_SOURCE_DATA_LAYOUT:te[x.LayoutItemUUID]={Registration:q,Layouts:k.value.filter(j=>{if(x.Meta&&x.Meta.LayoutUUID&&Array.isArray(x.Meta.LayoutUUID))return x.Meta.LayoutUUID.includes(j.AdminLayoutUUID)})};break}}}}),{key:q.RegistrationUUID,registration:q,...te}})}),U.value=!1)})}catch{}},Ka=R=>{re.value=!1,R&&(m.value=R,Zt())},Zt=()=>{Ya(m.value.Panels,d.value),m.value.Panels.length>0&&(g.value=[],m.value.Panels.forEach(R=>{const y={uuid:Ie(),order:R.Order,name:R.Name,headers:[],items:[],layout:R};R.Items.sort((P,b)=>P.Order>b.Order?1:P.Order==b.Order?0:-1),y.headers=R.Items.filter(P=>P.SourceType!=Ce.LAYOUT_ITEM_SOURCE_META&&P.MetaField!=H.META_DATA_SOURCE_REGISTRATION_TOOLS_DROP).map(P=>{var b,de;return{key:P.LayoutItemUUID,title:P.Label||((de=(b=P.SectionField)==null?void 0:b.Field)==null?void 0:de.Label)||"",align:P.Align==="end"?"end":"start",sortable:Qa(P),type:ja(P),defaultSort:P.DefaultSort,meta:P.Meta}}),g.value.push(y)}),g.value=g.value.sort((R,y)=>R.order>y.order?1:R.order==y.order?0:-1)),($.value==null||$.value=="")&&g.value.length>0&&($.value=g.value[0].uuid)};l?u.getConvention(l).then(R=>{R&&(i.value=R,m.value.ConventionID=i.value.ID,m.value.ConventionUUID=i.value.ConventionUUID,qa())}).catch(()=>{v.push("/")}):v.push("/");const ja=R=>{var y,P;if(R.SourceType===Ce.LAYOUT_ITEM_SOURCE_META)return`${R.SourceType}.${R.MetaField}`;if(R.SourceType===Ce.LAYOUT_ITEM_SOURCE_FORM)return(P=(y=R.SectionField)==null?void 0:y.Field)==null?void 0:P.Type;if(R.SourceType===Ce.LAYOUT_ITEM_SOURCE_USER)return`${R.SourceType}.${R.UserField}`},za=()=>{const R=g.value.find(y=>y.uuid===$.value);return R?!!R.layout.Items.find(y=>y.SourceType==Ce.LAYOUT_ITEM_SOURCE_META&&y.MetaField==H.META_DATA_SOURCE_REGISTRATION_TOOLS_DROP):!1},Qa=R=>{const y=[H.META_DATA_SOURCE_ACCOMMODATION_FORM,H.META_DATA_SOURCE_BADGE_FORM,H.META_DATA_SOURCE_DEALER_FORM,H.META_DATA_SOURCE_REGISTRATION_FORM,H.META_DATA_SOURCE_REGISTRATION_REFERENCE,H.META_DATA_SOURCE_SUBMISSION_DATE,H.META_DATA_SOURCE_SUBMISSION_STATUS],P=[ne.USER_DATA_SOURCE_DISPLAY_NAME,ne.USER_DATA_SOURCE_EMAIL,ne.USER_DATA_SOURCE_HANDLE,ne.USER_DATA_SOURCE_DATE_OF_BIRTH,ne.USER_DATA_SOURCE_FIRST_NAME,ne.USER_DATA_SOURCE_LAST_NAME];return y.includes(R.MetaField)||P.includes(R.UserField)},Ja=R=>{Ee.value=R,xe.value=!0},Xa=R=>{Ee.value=R,Xt.value=!0},Wa=R=>{Ee.value=R,Ha.value=!0};Ue(xe,R=>{R||(Ee.value=void 0)}),Ue(Xt,R=>{R||(Ee.value=void 0)});const Vt=async(R="")=>{Wt.value=await u.getRegistrationGroup(R)},Za=({registration:R,form:y})=>{const P={FormUUID:y.FormUUID,Limit:1,RegistrationUUID:R.RegistrationUUID};u.searchConventionRegistrations(R.ConventionUUID,P).then(b=>{if(b&&b.Total>0){if(Ee.value=b.Registrations[0],!Ee.value)return;Vt(R.RegistrationUUID).then(()=>{var de,ue;Ee.value&&((de=Ee.value)!=null&&de.Submissions)&&(st.value=(ue=Ee.value)==null?void 0:ue.Submissions.find(qe=>qe.FormUUID===y.FormUUID)),st.value||(st.value=el(y,R)),ft.value=y,nt.value=!0})}})},el=(R,y)=>({ID:0,SubmissionUUID:Ie(),FormID:R.ID,FormUUID:R.FormUUID,Form:R,UserID:y.UserID,UserUUID:y.UserUUID,RegistrationID:y.ID,RegistrationUUID:y.RegistrationUUID,Registration:y,Data:[],Status:Ea.SUBMISSION_STATUS_NULL}),tl=R=>{u.switchUser(R.UserUUID).then(y=>{y&&Wl(y.tokens,y.user,v,!1)}).catch(y=>{console.error(y)})};return A.on("registration.group.leave",R=>{u.leaveRegistrationGroup(R).then(y=>{y&&Vt(R).then(()=>{A.emit("registration.group.left",y)})})}),A.on("registration.group.remove.member",R=>{u.leaveRegistrationGroup(R).then(y=>{y&&Vt(R).then(()=>{A.emit("registration.group.left",y)})})}),(R,y)=>(o(),S(en,null,{default:a(()=>[t(Gt,{color:"blue-darken-4"},{default:a(()=>[t(Ia,{modelValue:$.value,"onUpdate:modelValue":y[0]||(y[0]=P=>$.value=P),"show-arrows":""},{default:a(()=>[(o(!0),T(L,null,W(g.value,P=>(o(),S(Ca,{key:P.uuid,value:P.uuid},{default:a(()=>[O(I(P.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"]),t(Fe),t(K,{icon:"mdi:mdi-cog-outline",onClick:y[1]||(y[1]=P=>re.value=!0)})]),_:1}),t(ha,{modelValue:$.value,"onUpdate:modelValue":y[23]||(y[23]=P=>$.value=P),disabled:!0,touch:!1},{default:a(()=>[(o(!0),T(L,null,W(g.value,P=>(o(),S(Je,{key:P.uuid,value:P.uuid},{default:a(()=>[P.uuid===$.value?(o(),S(Pe,{key:0,class:"pa-2"},{default:a(()=>[t(mn,{expanded:f.value,"onUpdate:expanded":y[19]||(y[19]=b=>f.value=b),page:h.value,"onUpdate:page":y[20]||(y[20]=b=>h.value=b),"items-per-page":p.value,"onUpdate:itemsPerPage":y[21]||(y[21]=b=>p.value=b),"sort-by":lt.value,"onUpdate:sortBy":y[22]||(y[22]=b=>lt.value=b),headers:P.headers,"items-length":z.value,items:P.items,"item-value":"key",loading:U.value,search:Y.value,"onUpdate:options":Ut,"show-expand":za()},We({top:a(()=>[t(Ot,{class:"mb-3"},{default:a(()=>[t(ht,null,{default:a(()=>[t(Ct,{color:"secondary",class:"font-weight-bold pb-0 pt-0"},{default:a(()=>[t(V,{class:"pa-0"},{default:a(()=>[O(" Search Criteria "),t(ke,{class:"pl-5",icon:"mdi:mdi-credit-card-search-outline"})]),_:1}),t(V,{class:"d-none d-sm-block pa-0",cols:"0"},{default:a(()=>[t(oe,{modelValue:G.value,"onUpdate:modelValue":y[2]||(y[2]=b=>G.value=b),label:"Badge No.",clearable:!0,"hide-details":"",variant:"plain",onClick:y[3]||(y[3]=Pt(()=>{},["stop"])),"onClick:clear":E(Te),onInput:E(Te)},null,8,["modelValue","onClick:clear","onInput"])]),_:1}),t(V,{class:"d-none d-md-block pa-0"},{default:a(()=>[t(oe,{modelValue:w.value.Value,"onUpdate:modelValue":y[4]||(y[4]=b=>w.value.Value=b),label:"Furry Name",clearable:!0,"hide-details":"",variant:"plain",onClick:y[5]||(y[5]=Pt(()=>{},["stop"])),"onClick:clear":E(Te),onInput:E(Te)},null,8,["modelValue","onClick:clear","onInput"])]),_:1})]),_:1}),t(Rt,{class:"pt-2"},{default:a(()=>[t(J,null,{default:a(()=>[t(V,{cols:"12",sm:"6",md:"3",lg:"2",xl:"1"},{default:a(()=>[t(oe,{modelValue:G.value,"onUpdate:modelValue":y[6]||(y[6]=b=>G.value=b),label:"Badge No.",clearable:!0,"hide-details":"",variant:"outlined","onClick:clear":E(Te),onInput:E(Te)},null,8,["modelValue","onClick:clear","onInput"])]),_:1}),t(V,{cols:"12",sm:"6",md:"4",lg:"5",xl:"2"},{default:a(()=>[t(oe,{modelValue:w.value.Value,"onUpdate:modelValue":y[7]||(y[7]=b=>w.value.Value=b),label:"Furry Name",clearable:!0,"hide-details":"",variant:"outlined","onClick:clear":E(Te),onInput:E(Te)},null,8,["modelValue","onClick:clear","onInput"])]),_:1}),t(V,{cols:"12",sm:"12",md:"5",lg:"5",xl:"3"},{default:a(()=>[t(oe,{modelValue:B.value,"onUpdate:modelValue":y[8]||(y[8]=b=>B.value=b),label:"E-mail",clearable:!0,"hide-details":"",variant:"outlined","onClick:clear":E(Te),onInput:E(Te)},null,8,["modelValue","onClick:clear","onInput"])]),_:1}),t(V,{cols:"12",sm:"6",md:"4",lg:"4",xl:"2"},{default:a(()=>[t(oe,{modelValue:ee.value.Value,"onUpdate:modelValue":y[9]||(y[9]=b=>ee.value.Value=b),label:"Legal Forename",clearable:!0,"hide-details":"",variant:"outlined","onClick:clear":E(Te),onInput:E(Te)},null,8,["modelValue","onClick:clear","onInput"])]),_:1}),t(V,{cols:"12",sm:"6",md:"4",lg:"4",xl:"2"},{default:a(()=>[t(oe,{modelValue:ve.value.Value,"onUpdate:modelValue":y[10]||(y[10]=b=>ve.value.Value=b),label:"Legal Surname",clearable:!0,"hide-details":"",variant:"outlined","onClick:clear":E(Te),onInput:E(Te)},null,8,["modelValue","onClick:clear","onInput"])]),_:1}),t(V,{cols:"12",sm:"12",md:"4",lg:"4",xl:"2"},{default:a(()=>[t(oe,{modelValue:ie.value.Value,"onUpdate:modelValue":y[11]||(y[11]=b=>ie.value.Value=b),type:"date",label:"Date of Birth",clearable:!0,"hide-details":"",variant:"outlined","onClick:clear":E(Te),onInput:E(Te)},null,8,["modelValue","onClick:clear","onInput"])]),_:1}),t(V,{cols:"12",sm:"6",md:"6",lg:"6",xl:"6"},{default:a(()=>[t(fe,{modelValue:tt.value,"onUpdate:modelValue":y[12]||(y[12]=b=>tt.value=b),label:"Permission Groups",clearable:!0,"hide-details":"",variant:"outlined",items:D.value,"item-value":"GroupUUID","item-title":"Name"},null,8,["modelValue","items"])]),_:1}),t(V,{cols:"12",sm:"6",md:"6",lg:"6",xl:"6"},{default:a(()=>[t(fe,{modelValue:at.value,"onUpdate:modelValue":y[13]||(y[13]=b=>at.value=b),label:"Tags",clearable:!0,"hide-details":"",variant:"outlined",items:C.value,"item-value":"TagUUID","item-title":"Title"},null,8,["modelValue","items"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),"expanded-row":a(({columns:b,internalItem:de})=>[F("tr",null,[F("td",{colspan:b.length},[t(Aa,{modelValue:xe.value,"onUpdate:modelValue":y[15]||(y[15]=ue=>xe.value=ue),registration:de.raw.registration,"onUpdate:registration":ue=>de.raw.registration=ue,accommodations:Re.value,convention:i.value,extras:Be.value,forms:d.value,interests:Ge.value,tickets:Ye.value,title:`Registration Controls (#${de.raw.registration.Reference} ${de.raw.registration.User.DisplayName})`,"use-dialog":!1,venues:He.value,style:{"max-width":"calc(100vw - 48px)"},class:"ml-auto mr-0"},null,8,["modelValue","registration","onUpdate:registration","accommodations","convention","extras","forms","interests","tickets","title","venues"])],8,fs)])]),"item.data-table-expand":a(({internalItem:b})=>[f.value.findIndex(de=>de===b.key)>=0?(o(),S(K,{key:0,"append-icon":"mdi:mdi-chevron-up",size:"xs",variant:"flat",onClick:de=>f.value.splice(f.value.findIndex(ue=>ue===b.key),1)},{default:a(()=>[b.raw.registration.Notes&&b.raw.registration.Notes.length>0?(o(),T(L,{key:0},[O(I(b.raw.registration.Notes.length),1)],64)):M("",!0)]),_:2},1032,["onClick"])):(o(),S(K,{key:1,"append-icon":"mdi:mdi-chevron-down",size:"xs",variant:"flat",onClick:de=>f.value.push(b.key)},{default:a(()=>[b.raw.registration.Notes&&b.raw.registration.Notes.length>0?(o(),T(L,{key:0},[O(I(b.raw.registration.Notes.length),1)],64)):M("",!0)]),_:2},1032,["onClick"]))]),bottom:a(()=>[t(ce,{fluid:!0},{default:a(()=>[t(J,{class:"align-center"},{default:a(()=>[t(V,{cols:"12",lg:"7","order-lg":"3",xl:"8"},{default:a(()=>[t(Hl,{modelValue:h.value,"onUpdate:modelValue":y[16]||(y[16]=b=>h.value=b),modelModifiers:{number:!0},length:Math.ceil(z.value/p.value)},null,8,["modelValue","length"])]),_:1}),t(V,{cols:"6",sm:"4",md:"2",lg:"2",xl:"1","order-lg":"1"},{default:a(()=>[t(fe,{modelValue:p.value,"onUpdate:modelValue":y[17]||(y[17]=b=>p.value=b),density:"compact","hide-details":"","item-title":"title","item-value":"value",label:"Items per page",min:"-1",max:"100",type:"number",variant:"outlined",items:[{title:"10",value:10},{title:"25",value:25},{title:"50",value:50},{title:"100",value:100},{title:"All",value:-1}]},null,8,["modelValue"])]),_:1}),t(V,{cols:"6",sm:"3",md:"2",lg:"1",xl:"1","order-lg":"2"},{default:a(()=>[t(oe,{modelValue:h.value,"onUpdate:modelValue":y[18]||(y[18]=b=>h.value=b),modelModifiers:{number:!0},density:"compact","hide-details":"",label:"Page",min:"1",max:Math.ceil(z.value/p.value),type:"number",variant:"outlined"},null,8,["modelValue","max"])]),_:1}),t(V,{class:"text-right",cols:"12",sm:"5",md:"8",lg:"2",xl:"2","order-lg":"4"},{default:a(()=>[F("span",Us,[p.value===-1?(o(),T(L,{key:0},[O(" 1-"+I(z.value)+" of "+I(z.value),1)],64)):(o(),T(L,{key:1},[O(I((h.value-1)*p.value+1)+" - "+I(h.value*p.value>=z.value?z.value:h.value*p.value)+" of "+I(z.value),1)],64))])]),_:1})]),_:1})]),_:1})]),_:2},[W(P.headers,b=>({name:`item.${b.key}`,fn:a(({internalItem:de,index:ue})=>[t(Ui,{header:b,item:de,accommodations:Re.value,convention:i.value,extras:Be.value,forms:d.value,interests:Ge.value,tickets:Ye.value,user:E(xa),venues:He.value,modelValue:P.items[ue],"onUpdate:modelValue":qe=>P.items[ue]=qe,onOpenActions:Ja,onOpenPayments:Xa,onOpenTags:Wa,onReload:y[14]||(y[14]=qe=>Ut({page:h.value,itemsPerPage:p.value,sortBy:Z.value})),onSwitchUser:tl,onShowForm:Za},null,8,["header","item","accommodations","convention","extras","forms","interests","tickets","user","venues","modelValue","onUpdate:modelValue"])])}))]),1032,["expanded","page","items-per-page","sort-by","headers","items-length","items","loading","search","show-expand"])]),_:2},1024)):M("",!0)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"]),re.value?(o(),S(vs,{key:0,title:"Edit Layouts",modelValue:re.value,"onUpdate:modelValue":y[24]||(y[24]=P=>re.value=P),convention:i.value,onSave:Ka},null,8,["modelValue","convention"])):M("",!0),Ee.value?(o(),T(L,{key:1},[xe.value?(o(),S(Aa,{key:0,modelValue:xe.value,"onUpdate:modelValue":y[25]||(y[25]=P=>xe.value=P),registration:Ee.value,"onUpdate:registration":y[26]||(y[26]=P=>Ee.value=P),accommodations:Re.value,convention:i.value,extras:Be.value,forms:d.value,interests:Ge.value,tickets:Ye.value,title:`Registration Controls (#${Ee.value.Reference} ${Ee.value.User.DisplayName})`,"use-dialog":!0,venues:He.value},null,8,["modelValue","registration","accommodations","convention","extras","forms","interests","tickets","title","venues"])):M("",!0)],64)):M("",!0),nt.value&&st.value&&ft.value?(o(),S(pt,{key:2,modelValue:nt.value,"onUpdate:modelValue":y[30]||(y[30]=P=>nt.value=P),scrollable:!0,fullscreen:!0,persistent:!0},{default:a(()=>[t(Pe,{class:"bg-red-darken-4"},{default:a(()=>[t(Gt,{color:"error"},{default:a(()=>[t(ka,null,{default:a(()=>[O("Submission Editor - Admin Mode")]),_:1}),t(Fe),t(Zl,null,{default:a(()=>[t(K,{icon:"mdi:mdi-window-close",onClick:y[27]||(y[27]=P=>nt.value=!1)})]),_:1})]),_:1}),t(et,null,{default:a(()=>[t(pl,{modelValue:ft.value,"onUpdate:modelValue":y[28]||(y[28]=P=>ft.value=P),admin:!0,convention:i.value,data:st.value,editable:!0,"registration-group":Wt.value,onClose:y[29]||(y[29]=P=>{nt.value=!1,Ut({page:h.value,itemsPerPage:p.value,sortBy:Z.value})})},null,8,["modelValue","convention","data","registration-group"])]),_:1})]),_:1})]),_:1},8,["modelValue"])):M("",!0)]),_:1}))}});export{lu as default};
