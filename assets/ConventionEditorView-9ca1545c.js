import{s as x}from"./index-71069b21.js";import{I as P,r as y,K as c,L as C,M as l,v as e,N as b,S as I,$ as G,a1 as O,a2 as M,e as X,w as H,R as k,H as $,a3 as j,Q as F,Z as K,O as R,U as E,P as re,x as ke,a5 as be,E as _e,a6 as Ee,a7 as ye,a8 as Re,a4 as Be,s as ie,a9 as ze}from"./index-0763f85f.js";import{V as Ne,m as Ae,a as Se,s as Pe,T as L,b as He,F as xe,c as J,_ as we,d as Je}from"./FormRenderer.vue_vue_type_style_index_0_lang-40d6b226.js";import{v as q}from"./v4-a960c1f4.js";import{u as me,a as ue,V as ne}from"./VToolbar-2098b57a.js";import{V as N}from"./VBtn-6482839e.js";import{V as z,j as B}from"./VContainer-8dba7b61.js";import{V as ee}from"./VSpacer-1491010a.js";import{V as ve}from"./VToolbarItems-ce6b0751.js";import{a as A,V as g}from"./VRow-615fcf64.js";import{V as S,a as Xe}from"./VTextField-34d35d71.js";import{c as ce,e as de}from"./VCard-dae25dea.js";import{V as pe}from"./VDialog-c6a4433b.js";import{a as te,V as he,c as le,b as $e}from"./VList-87ac8eea.js";import{V as Fe}from"./VDivider-2ee7dc1b.js";import{_ as Z,V as qe,a as Me}from"./VChip-a24b5795.js";import{V as fe,a as Ve,b as Ue,c as Te,d as ae,e as Le,_ as Ke,f as We,g as Qe,h as Ze,i as el}from"./VWindowItem-d5184ada.js";import{V as Ie}from"./VTextarea-f99d2661.js";import{V as se}from"./copyToClipboard-b7517336.js";import{V as W,u as De}from"./VCheckbox-71d9be25.js";import{V as ll}from"./VTable-549cf978.js";import{_ as Ge}from"./DeleteDialog.vue_vue_type_script_setup_true_lang-26a61335.js";import{_ as Oe}from"./ModelDialog.vue_vue_type_script_setup_true_lang-b4808fd1.js";import{a as tl,F as al}from"./form-e2a93b7c.js";import"./submission-56c4c4f1.js";import"./VAvatar-900f64d1.js";import"./userData-7015bd9c.js";import"./VForm-75a23f32.js";import"./scopeId-1820581b.js";var Ce=(T=>(T.PER_ROOM="PER_ROOM",T.PER_PERSON="PER_PERSON",T))(Ce||{});const ol=P({__name:"AddTag",props:{convention:{},organisation:{}},emits:["save","close"],setup(T,{emit:s}){const a=y(""),i=y("");typeof T.convention=="object"?(a.value=T.convention.ConventionUUID,i.value=T.convention.OrganisationUUID):a.value=T.convention||"",typeof T.organisation=="object"?i.value=T.organisation.OrganisationUUID:i.value.length===0&&(i.value=T.organisation||"");const d=y({ID:0,TagUUID:q(),ConventionID:0,ConventionUUID:a.value||me,OrganisationID:0,OrganisationUUID:i.value||me,Title:"",Key:""}),n=G(),u=()=>{n.saveTag(d.value).then(t=>{t&&(d.value=t,s("save",t),s("close"))})};return(t,o)=>(c(),C(de,null,{default:l(()=>[e(ne,{dark:"",color:"primary"},{default:l(()=>[e(N,{icon:"",dark:"",onClick:o[0]||(o[0]=v=>s("close"))},{default:l(()=>[e(z,null,{default:l(()=>[b("mdi:mdi-close")]),_:1})]),_:1}),e(ue,null,{default:l(()=>[b("Add Tag")]),_:1}),e(ee),e(ve,null,{default:l(()=>[e(N,{variant:"text",onClick:u},{default:l(()=>[b(" Save ")]),_:1})]),_:1})]),_:1}),e(ce,null,{default:l(()=>[e(B,{fluid:!0},{default:l(()=>[e(A,null,{default:l(()=>[e(g,{cols:"12"},{default:l(()=>[e(S,{label:I(x).formLabelDisplayName,type:"text",variant:"outlined",modelValue:d.value.Title,"onUpdate:modelValue":o[1]||(o[1]=v=>d.value.Title=v)},null,8,["label","modelValue"])]),_:1}),e(g,{cols:"12"},{default:l(()=>[e(S,{label:I(x).formLabelTagKey,type:"text",variant:"outlined",modelValue:d.value.Key,"onUpdate:modelValue":o[2]||(o[2]=v=>d.value.Key=v)},null,8,["label","modelValue"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}))}}),oe=P({__name:"SelectTags",props:O({convention:{},organisation:{},chips:{type:Boolean,default:!1},clearable:{type:Boolean,default:!1},hint:{default:""},label:{},variant:{}},{modelValue:{required:!0}}),emits:O(["change"],["update:modelValue"]),setup(T,{emit:s}){const a=M(T,"modelValue"),i=y([]),d=G(),n=y([]),u=y([]),t=y(""),o=y(""),v=y(0),m=X(()=>[...n.value,...u.value].map(D=>({title:D.Title,value:i.value.find(_=>_.TagUUID===D.TagUUID)||D})));typeof T.convention=="object"?(t.value=T.convention.ConventionUUID,o.value=T.convention.OrganisationUUID):t.value=T.convention||"",typeof T.organisation=="object"?o.value=T.organisation.OrganisationUUID:o.value.length===0&&(o.value=T.organisation||""),(async()=>{const U=[];t.value&&U.push(d.getConventionTags(t.value)),o.value&&U.push(d.getOrganisationTags(o.value));const D=await Promise.all(U);if(t.value&&o.value?(u.value=D[0].sort((_,h)=>_.Title.localeCompare(h.Title)),n.value=D[1].sort((_,h)=>_.Title.localeCompare(h.Title))):t.value&&D.length==1?u.value=D[0].sort((_,h)=>_.Title.localeCompare(h.Title)):o.value&&D.length==1&&(n.value=D[0].sort((_,h)=>_.Title.localeCompare(h.Title))),Array.isArray(a.value))v.value=2,m.value.forEach(_=>{Array.isArray(a.value)&&a.value.find(w=>w.TagUUID===_.value.TagUUID)&&i.value.push(_.value)});else if(typeof a.value=="string"){v.value=1;try{const _=JSON.parse(a.value);m.value.forEach(h=>{_.find(Y=>Y.TagUUID===h.value.TagUUID)&&i.value.push(h.value)})}catch{}}})();const r=y(!1),p=()=>{r.value=!0},V=U=>{U.ConventionUUID.length>0?u.value.push(U):U.OrganisationUUID.length>0&&n.value.push(U),i.value.push(U),f()},f=()=>{switch(v.value){default:case 2:{a.value=i.value,s("change");break}case 1:{a.value=JSON.stringify(i.value),s("change");break}}};return H(i,f),(U,D)=>(c(),k($,null,[e(Ne,{modelValue:i.value,"onUpdate:modelValue":D[1]||(D[1]=_=>i.value=_),chips:U.chips,multiple:"",label:U.label||"Tags",variant:U.variant||"solo",hint:U.hint,"persistent-hint":!0,clearable:U.clearable,items:m.value,"item-title":"title","item-value":"value"},{"prepend-item":l(()=>[e(te,{title:"New Tag",onClick:D[0]||(D[0]=_=>p())},{prepend:l(()=>[e(z,{icon:"mdi:mdi-plus"})]),_:1}),e(Fe,{class:"mt-2"})]),_:1},8,["modelValue","chips","label","variant","hint","clearable","items"]),e(pe,{modelValue:r.value,"onUpdate:modelValue":D[3]||(D[3]=_=>r.value=_),scrollable:!0},{default:l(()=>[e(ol,{convention:U.convention,organisation:U.organisation,onClose:D[2]||(D[2]=_=>r.value=!1),onSave:V},null,8,["convention","organisation"])]),_:1},8,["modelValue"])],64))}}),nl=P({__name:"EditConventionExtraOptions",props:O({convention:{}},{modelValue:{}}),emits:O(["close"],["update:modelValue"]),setup(T,{emit:s}){const a=M(T,"modelValue"),i=y(j(a.value)),d=()=>{a.value=i.value,s("close")};return(n,u)=>(c(),C(de,null,{default:l(()=>[e(ne,{dark:"",color:"primary"},{default:l(()=>[e(N,{icon:"",dark:"",onClick:u[0]||(u[0]=t=>s("close"))},{default:l(()=>[e(z,null,{default:l(()=>[b("mdi:mdi-close")]),_:1})]),_:1}),e(ue,null,{default:l(()=>[b("Edit Option Choice")]),_:1}),e(ee),e(ve,null,{default:l(()=>[e(N,{variant:"text",onClick:d},{default:l(()=>[b(" Apply ")]),_:1})]),_:1})]),_:1}),e(ce,{class:"pa-0"},{default:l(()=>[e(B,null,{default:l(()=>[e(S,{label:I(x).formLabelName,type:"text",variant:"outlined",modelValue:i.value.Name,"onUpdate:modelValue":u[1]||(u[1]=t=>i.value.Name=t)},null,8,["label","modelValue"]),e(S,{label:I(x).formLabelDescription,type:"text",variant:"outlined",modelValue:i.value.Description,"onUpdate:modelValue":u[2]||(u[2]=t=>i.value.Description=t)},null,8,["label","modelValue"]),e(S,{label:I(x).formLabelPrice,type:"text",variant:"outlined","prepend-icon":I(x).currencyIcon,modelValue:i.value.Price,"onUpdate:modelValue":u[3]||(u[3]=t=>i.value.Price=t),modelModifiers:{number:!0},hint:"Adds additional charges for selecting this option"},null,8,["label","prepend-icon","modelValue"]),i.value.Choices?(c(),C(oe,{key:0,modelValue:i.value.Choices,"onUpdate:modelValue":u[4]||(u[4]=t=>i.value.Choices=t),convention:n.convention,hint:"Sub-options (tags) that a user may choose from."},null,8,["modelValue","convention"])):F("",!0)]),_:1})]),_:1})]),_:1}))}}),Ye=P({__name:"SelectGroups",props:O({convention:{},organisation:{},chips:{type:Boolean,default:!1},clearable:{type:Boolean,default:!1},hint:{default:""},label:{},variant:{}},{modelValue:{required:!0}}),emits:O(["change"],["update:modelValue"]),setup(T,{emit:s}){const a=M(T,"modelValue"),i=y([]),d=G(),n=y([]),u=y([]),t=y(""),o=y(""),v=y(0),m=X(()=>[...n.value,...u.value].map(V=>({title:V.Name,value:i.value.find(f=>f.GroupUUID===V.GroupUUID)||V})));return typeof T.convention=="object"?(t.value=T.convention.ConventionUUID,o.value=T.convention.OrganisationUUID):t.value=T.convention||"",typeof T.organisation=="object"?o.value=T.organisation.OrganisationUUID:o.value.length===0&&(o.value=T.organisation||""),(async()=>{const p=[];t.value&&p.push(d.getConventionGroups(t.value)),o.value&&p.push(d.getOrganisationGroups(o.value));const V=await Promise.all(p);if(t.value&&o.value?(u.value=V[0].sort((f,U)=>f.Name.localeCompare(U.Name)),n.value=V[1].sort((f,U)=>f.Name.localeCompare(U.Name))):t.value&&V.length==1?u.value=V[0].sort((f,U)=>f.Name.localeCompare(U.Name)):o.value&&V.length==1&&(n.value=V[0].sort((f,U)=>f.Name.localeCompare(U.Name))),Array.isArray(a.value))v.value=2,m.value.forEach(f=>{Array.isArray(a.value)&&a.value.find(D=>D.GroupUUID===f.value.GroupUUID)&&i.value.push(f.value)});else if(typeof a.value=="string"){v.value=1;try{const f=JSON.parse(a.value);m.value.forEach(U=>{f.find(_=>_.GroupUUID===U.value.GroupUUID)&&i.value.push(U.value)})}catch{}}})(),H(i,()=>{switch(v.value){default:case 2:{a.value=i.value,s("change");break}case 1:{a.value=JSON.stringify(i.value),s("change");break}}}),(p,V)=>(c(),C(Ne,{modelValue:i.value,"onUpdate:modelValue":V[0]||(V[0]=f=>i.value=f),chips:p.chips,multiple:"",label:p.label||"Tags",variant:p.variant||"solo",hint:p.hint,"persistent-hint":!0,clearable:p.clearable,items:m.value,"item-title":"title","item-value":"value"},null,8,["modelValue","chips","label","variant","hint","clearable","items"]))}}),ul=E("h3",null,"Options",-1),il=P({__name:"EditConventionExtra",props:O({convention:{}},{modelValue:{required:!0}}),emits:["update:modelValue"],setup(T){const s=M(T,"modelValue"),a=y(j(s.value)),i=y(!1),d=y(0),n=G(),u=y([""]),t=y([]),o=y([]);T.convention&&(n.getConventionTags(T.convention.ConventionUUID).then(f=>{o.value=f.sort((U,D)=>U.Title.localeCompare(D.Title))}),n.getOrganisationTags(T.convention.OrganisationUUID).then(f=>{t.value=f.sort((U,D)=>U.Title.localeCompare(D.Title))}));const v=X(()=>[...t.value,...o.value]),m=({callback:f})=>{n.saveExtra(a.value).then(U=>{U?(s.value=U,f&&f("Extra Saved")):f&&f("Failed to Save Extra")}).catch(()=>{f&&f("Failed to Save Extra")})},r=f=>{var U;f.Options||(f.Options=[]),f.Options.push({ID:0,OptionUUID:q(),ExtraID:f.ID,ExtraUUID:f.ExtraUUID,Order:((U=f.Options)==null?void 0:U.length)+1,Name:"",Description:"",Price:0,Choices:[]})},p=(f,U)=>{f.Options&&f.Options.splice(U,1)},V=f=>{if(f.Choices&&f.Choices.length>0)return f.Choices.map(U=>{const D=v.value.find(_=>_.TagUUID===U.TagUUID);if(D)return D.Title}).join(", ")};return(f,U)=>(c(),k($,null,[e(B,{class:"px-0"},{default:l(()=>[e(S,{label:I(x).formLabelName,type:"text",variant:"outlined",modelValue:a.value.Name,"onUpdate:modelValue":U[0]||(U[0]=D=>a.value.Name=D)},null,8,["label","modelValue"]),e(S,{label:I(x).formLabelDescription,type:"text",variant:"outlined",modelValue:a.value.Description,"onUpdate:modelValue":U[1]||(U[1]=D=>a.value.Description=D)},null,8,["label","modelValue"]),e(oe,{modelValue:a.value.AppliesTags,"onUpdate:modelValue":U[2]||(U[2]=D=>a.value.AppliesTags=D),convention:f.convention,organisation:f.convention.OrganisationUUID,hint:"Tags a user acquires by selecting any option within this addon purchase."},null,8,["modelValue","convention","organisation"]),e(oe,{label:"Required Tags",variant:"outlined",modelValue:a.value.RequiredTags,"onUpdate:modelValue":U[3]||(U[3]=D=>a.value.RequiredTags=D),convention:f.convention,organisation:f.convention.OrganisationUUID,chips:"",clearable:"",hint:"Tags that a user must have to see this form. (Any one)"},null,8,["modelValue","convention","organisation"]),e(Ye,{label:"Required Groups",variant:"outlined",modelValue:a.value.RequiredGroupMemberships,"onUpdate:modelValue":U[4]||(U[4]=D=>a.value.RequiredGroupMemberships=D),convention:f.convention,organisation:f.convention.OrganisationUUID,chips:"",clearable:"",hint:"Groups that a user must be in to see this form. (Any one)"},null,8,["modelValue","convention","organisation"]),ul,e(he,{opened:u.value,"onUpdate:opened":U[5]||(U[5]=D=>u.value=D)},{default:l(()=>[(c(!0),k($,null,K(a.value.Options,(D,_)=>(c(),k($,{key:D.ID},[D?(c(),C(te,{key:0,"prepend-icon":"mdi:mdi-ticket-percent",title:`${D.Name} ${D.Price&&D.Price>0?`(${I(x).currencySymbol}${D.Price})`:""}`},{append:l(()=>[e(N,{color:"red",icon:"mdi:mdi-close",size:"x-small",class:"mr-1",onClick:h=>p(a.value,_)},null,8,["onClick"]),e(N,{color:"primary",icon:"mdi:mdi-pencil",size:"x-small",onClick:h=>{i.value=!0,d.value=_}},null,8,["onClick"])]),default:l(()=>[D.Choices&&D.Choices.length>0?(c(),C(le,{key:0},{default:l(()=>[b(" Options: "+R(V(D)),1)]),_:2},1024)):F("",!0)]),_:2},1032,["title"])):F("",!0)],64))),128))]),_:1},8,["opened"]),e(N,{color:"primary",onClick:U[6]||(U[6]=D=>r(a.value))},{default:l(()=>[b("Add Option")]),_:1}),e(A,null,{default:l(()=>[e(g,{class:"text-right"},{default:l(()=>[e(Z,{onClick:m})]),_:1})]),_:1})]),_:1}),e(pe,{modelValue:i.value,"onUpdate:modelValue":U[9]||(U[9]=D=>i.value=D),scrollable:""},{default:l(()=>[e(nl,{modelValue:a.value.Options[d.value],"onUpdate:modelValue":U[7]||(U[7]=D=>a.value.Options[d.value]=D),convention:f.convention,onClose:U[8]||(U[8]=D=>i.value=!1)},null,8,["modelValue","convention"])]),_:1},8,["modelValue"])],64))}}),dl=P({__name:"EditConventionExtras",props:O({convention:{}},{modelValue:{required:!0}}),emits:O(["close"],["update:modelValue"]),setup(T,{emit:s}){const a=M(T,"modelValue"),i=G(),d=()=>{const t={ID:0,ExtraUUID:q(),ConventionID:T.convention.ID,ConventionUUID:T.convention.ConventionUUID,Order:a.value.length+1,Name:"New Extra",Description:"",AppliesTags:[],RequiredTags:[],RequiredGroupMemberships:[],Options:[]};i.saveExtra(t).then(o=>{o&&a.value.push(o)})},n=t=>{i.deleteExtra(a.value[t].ExtraUUID).then(o=>{o&&a.value.splice(t,1)})},u=(...t)=>{t.forEach(o=>{o>=0&&o<a.value.length&&i.saveExtra(a.value[o])})};return(t,o)=>(c(),C(de,null,{default:l(()=>[e(ne,{dark:"",color:"primary"},{default:l(()=>[e(N,{icon:"",dark:"",onClick:o[0]||(o[0]=v=>s("close"))},{default:l(()=>[e(z,null,{default:l(()=>[b("mdi:mdi-close")]),_:1})]),_:1}),e(ue,null,{default:l(()=>[b("Edit Extras")]),_:1}),e(ee),e(ve,null,{default:l(()=>[e(N,{variant:"text",onClick:d},{default:l(()=>[b(" Add ")]),_:1})]),_:1})]),_:1}),e(ce,{class:"pa-0"},{default:l(()=>[e(fe,null,{default:l(()=>[(c(!0),k($,null,K(a.value,(v,m)=>(c(),C(Ve,{key:v.ID,class:"mt-0"},{default:l(()=>[e(Ue,null,{actions:l(({expanded:r})=>[e(N,{icon:"mdi:mdi-close",size:"x-small",color:"red",class:"mr-1",onClick:p=>n(m)},null,8,["onClick"]),e(z,{class:"align-self-center text-h5",icon:r?"mdi:mdi-chevron-up":"mdi:mdi-chevron-down",variant:"flat",size:"x-small"},null,8,["icon"])]),default:l(()=>[e(N,{icon:"mdi:mdi-menu-up",size:"x-small",color:"primary",class:"mr-1",onClick:re(r=>{I(Ae)(v,a.value),u(m,m-1)},["stop"])},null,8,["onClick"]),e(N,{icon:"mdi:mdi-menu-down",size:"x-small",color:"secondary",class:"mr-4",onClick:re(r=>{I(Se)(v,a.value),u(m,m+1)},["stop"])},null,8,["onClick"]),b(" "+R(v.Name)+" ",1)]),_:2},1024),e(Te,{class:"px-0"},{default:l(()=>[e(il,{convention:t.convention,modelValue:a.value[m],"onUpdate:modelValue":r=>a.value[m]=r},null,8,["convention","modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1}))}}),sl=E("h3",null,"Additional Purchases",-1),rl=E("p",null,"These are global ticket addons that are not tied to any particular ticket type.",-1),ml=P({__name:"Extras",props:{modelValue:{required:!0}},emits:["update:modelValue"],setup(T){const s=M(T,"modelValue"),a=y([]),i=G(),d=y([""]),n=y(!1),u=o=>{if(o.Choices&&o.Choices.length>0)return o.Choices.map(v=>v.Title).join(", ")},t=()=>{n.value=!1};return i==null||i.getConventionExtras(s.value.ConventionUUID||"").then(o=>{o&&(a.value=o)}),(o,v)=>(c(),k($,null,[e(B,{fluid:!0,class:"px-0"},{default:l(()=>[e(A,null,{default:l(()=>[e(g,null,{default:l(()=>[sl]),_:1}),e(g,{class:"text-right"},{default:l(()=>[e(N,{color:"primary",onClick:v[0]||(v[0]=m=>n.value=!0)},{default:l(()=>[b("Edit")]),_:1})]),_:1})]),_:1})]),_:1}),rl,e(he,{opened:d.value,"onUpdate:opened":v[1]||(v[1]=m=>d.value=m)},{default:l(()=>[(c(!0),k($,null,K(a.value,m=>(c(),C($e,{key:m.ID,value:m.ID},{activator:l(({props:r})=>[e(te,ke(r,{"prepend-icon":"mdi:mdi-group",title:m.Name}),null,16,["title"])]),default:l(()=>[m.Options?(c(!0),k($,{key:0},K(m.Options,r=>(c(),C(te,{key:r.ID,"prepend-icon":"mdi:mdi-ticket-percent",title:`${r.Name} ${r.Price&&r.Price>0?`(${I(x).currencySymbol}${r.Price})`:""}`},{default:l(()=>[r.Choices&&r.Choices.length>0?(c(),C(le,{key:0},{default:l(()=>[b(" Options: "+R(u(r)),1)]),_:2},1024)):F("",!0)]),_:2},1032,["title"]))),128)):F("",!0)]),_:2},1032,["value"]))),128))]),_:1},8,["opened"]),e(pe,{modelValue:n.value,"onUpdate:modelValue":v[3]||(v[3]=m=>n.value=m),scrollable:!0},{default:l(()=>[e(dl,{modelValue:a.value,"onUpdate:modelValue":v[2]||(v[2]=m=>a.value=m),convention:s.value,onClose:t},null,8,["modelValue","convention"])]),_:1},8,["modelValue"])],64))}}),vl=P({__name:"EditConventionInterest",props:O({convention:{}},{modelValue:{required:!0}}),emits:["update:modelValue"],setup(T){const s=M(T,"modelValue"),a=y(j(s.value)),i=G(),d=({callback:n})=>{i.saveInterest(a.value).then(u=>{u?(s.value=u,n&&n("Interest Saved")):n&&n("Failed to Save Interest")}).catch(()=>{n&&n("Failed to Save Interest")})};return(n,u)=>(c(),C(B,{class:"px-0"},{default:l(()=>[e(S,{label:I(x).formLabelName,type:"text",variant:"outlined",modelValue:a.value.Name,"onUpdate:modelValue":u[0]||(u[0]=t=>a.value.Name=t)},null,8,["label","modelValue"]),e(Ie,{label:I(x).formLabelDescription,type:"text",variant:"outlined",modelValue:a.value.Description,"onUpdate:modelValue":u[1]||(u[1]=t=>a.value.Description=t)},null,8,["label","modelValue"]),F("",!0),e(oe,{modelValue:a.value.AppliesTags,"onUpdate:modelValue":u[3]||(u[3]=t=>a.value.AppliesTags=t),convention:n.convention,organisation:n.convention.OrganisationUUID,hint:"Tags that a user acquires by selecting this interest."},null,8,["modelValue","convention","organisation"]),e(A,null,{default:l(()=>[e(g,{class:"text-right"},{default:l(()=>[e(Z,{onClick:d})]),_:1})]),_:1})]),_:1}))}}),cl=P({__name:"EditConventionInterests",props:O({convention:{}},{modelValue:{required:!0}}),emits:O(["close"],["update:modelValue"]),setup(T,{emit:s}){const a=M(T,"modelValue"),i=G(),d=()=>{const t={ID:0,InterestUUID:q(),ConventionID:T.convention.ID,ConventionUUID:T.convention.ConventionUUID,Order:a.value.length+1,Name:"New Interest",Description:"",Price:0,AppliesTags:[]};i.saveInterest(t).then(o=>{o&&a.value.push(o)})},n=t=>{i.deleteInterest(a.value[t].InterestUUID).then(o=>{o&&a.value.splice(t,1)})},u=(...t)=>{t.forEach(o=>{o>=0&&o<a.value.length&&i.saveInterest(a.value[o])})};return(t,o)=>(c(),C(de,null,{default:l(()=>[e(ne,{dark:"",color:"primary"},{default:l(()=>[e(N,{icon:"",dark:"",onClick:o[0]||(o[0]=v=>s("close"))},{default:l(()=>[e(z,null,{default:l(()=>[b("mdi:mdi-close")]),_:1})]),_:1}),e(ue,null,{default:l(()=>[b("Edit Interests")]),_:1}),e(ee),e(ve,null,{default:l(()=>[e(N,{variant:"text",onClick:d},{default:l(()=>[b(" Add ")]),_:1})]),_:1})]),_:1}),e(ce,{class:"pa-0"},{default:l(()=>[e(fe,null,{default:l(()=>[(c(!0),k($,null,K(a.value,(v,m)=>(c(),C(Ve,{key:v.ID,class:"mt-0"},{default:l(()=>[e(Ue,null,{actions:l(({expanded:r})=>[e(Z,{class:"mr-1",color:"red",icon:"mdi:mdi-close",size:"x-small",onClick:p=>n(m)},null,8,["onClick"]),e(z,{class:"align-self-center text-h5",icon:r?"mdi:mdi-chevron-up":"mdi:mdi-chevron-down",variant:"flat",size:"x-small"},null,8,["icon"])]),default:l(()=>[e(N,{icon:"mdi:mdi-menu-up",size:"x-small",color:"primary",class:"mr-1",onClick:re(r=>{I(Ae)(v,a.value),u(m,m-1)},["stop"])},null,8,["onClick"]),e(N,{icon:"mdi:mdi-menu-down",size:"x-small",color:"secondary",class:"mr-4",onClick:re(r=>{I(Se)(v,a.value),u(m,m+1)},["stop"])},null,8,["onClick"]),b(" "+R(v.Name)+" ",1)]),_:2},1024),e(Te,{class:"px-0"},{default:l(()=>[e(vl,{convention:t.convention,modelValue:a.value[m],"onUpdate:modelValue":r=>a.value[m]=r},null,8,["convention","modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1}))}}),pl=E("h3",null,"Interests",-1),fl=E("p",null,"Attendees can tag themselves for particular things.",-1),Vl=P({__name:"Interests",props:{modelValue:{required:!0}},emits:O(["refresh"],["update:modelValue"]),setup(T){const s=M(T,"modelValue"),a=G(),i=y([]);a.getConventionInterests(s.value.ConventionUUID).then(u=>{Pe(u),i.value=u});const d=y([""]),n=y(!1);return(u,t)=>(c(),k($,null,[e(B,{fluid:!0,class:"px-0"},{default:l(()=>[e(A,null,{default:l(()=>[e(g,null,{default:l(()=>[pl]),_:1}),e(g,{class:"text-right"},{default:l(()=>[e(N,{color:"primary",onClick:t[0]||(t[0]=o=>n.value=!0)},{default:l(()=>[b("Edit")]),_:1})]),_:1})]),_:1})]),_:1}),fl,e(he,{opened:d.value,"onUpdate:opened":t[1]||(t[1]=o=>d.value=o)},{default:l(()=>[(c(!0),k($,null,K(i.value,o=>(c(),C(te,{key:o.ID,"prepend-icon":"mdi:mdi-checkbox-marked-outline",title:`${o.Name} ${o.Price&&o.Price>0?`(${I(x).currencySymbol}${o.Price})`:""}`},{default:l(()=>[o.Description?(c(),C(le,{key:0},{default:l(()=>[b(R(o.Description),1)]),_:2},1024)):F("",!0)]),_:2},1032,["title"]))),128))]),_:1},8,["opened"]),e(pe,{modelValue:n.value,"onUpdate:modelValue":t[4]||(t[4]=o=>n.value=o),scrollable:!0},{default:l(()=>[e(cl,{onClose:t[2]||(t[2]=o=>n.value=!1),convention:s.value,modelValue:i.value,"onUpdate:modelValue":t[3]||(t[3]=o=>i.value=o)},null,8,["convention","modelValue"])]),_:1},8,["modelValue"])],64))}}),ge=P({__name:"SelectTickets",props:O({chips:{type:Boolean,default:!1},clearable:{type:Boolean,default:!1},hint:{default:"Tickets that belong to this group."},label:{default:"Tickets"},persistentHint:{type:Boolean,default:!1},tickets:{default:()=>[]},variant:{}},{modelValue:{required:!0}}),emits:["update:modelValue"],setup(T){const s=M(T,"modelValue"),a=d=>d.Type===L.TICKET_TYPE_GROUP?"mdi:mdi-group":d.Type===L.TICKET_TYPE_TICKET?d.RequiresAccommodation?"mdi:mdi-home":d.ComponentsRequired>0?"mdi:mdi-ticket-confirmation":"mdi:mdi-ticket":d.Type===L.TICKET_TYPE_TICKET_COMPONENT?"mdi:mdi-cog-outline":d.Type===L.TICKET_TYPE_ADD_ON?"mdi:mdi-home-plus":"mdi:mdi-help",i=X(()=>T.tickets.map(d=>({title:d.Name,value:s.value.find(n=>n&&n.TicketUUID===d.TicketUUID)||d,props:{appendIcon:a(d)}})));return(d,n)=>(c(),k("div",null,[e(Ne,{label:d.label,variant:d.variant||"filled",items:i.value,"item-title":"title","item-value":"value","item-props":"props",modelValue:s.value,"onUpdate:modelValue":n[0]||(n[0]=u=>s.value=u),hint:d.hint,chips:d.chips,clearable:d.clearable,multiple:"","persistent-hint":d.persistentHint},null,8,["label","variant","items","modelValue","hint","chips","clearable","persistent-hint"])]))}}),Ul=E("p",{title:"Automatically calculated",class:"text-grey-lighten-1"},"Applicable Accommodation:",-1),Tl=P({__name:"EditConventionTicket",props:O({accommodation:{default:()=>[]},convention:{},tickets:{default:()=>[]}},{modelValue:{required:!0}}),emits:["update:modelValue"],setup(T){const s=M(T,"modelValue"),a=y(j(s.value)),i=G(),d=X(()=>T.tickets.filter(v=>v.Type===L.TICKET_TYPE_TICKET)),n=X(()=>T.tickets.filter(v=>v.Type===L.TICKET_TYPE_ADD_ON)),u=X(()=>T.tickets.filter(v=>v.Type===L.TICKET_TYPE_TICKET_COMPONENT)),t=v=>T.accommodation.filter(m=>m.Costs.find(r=>r.DateStart===v.DateStart&&r.DateEnd===v.DateEnd)),o=({callback:v})=>{i.saveTicket(a.value).then(m=>{m?(a.value.ID=m.ID,a.value.TicketUUID=m.TicketUUID,s.value=a.value,v&&v("Ticket Saved")):v&&v("Failed to Save Ticket")}).catch(()=>{v&&v("Failed to Save Ticket")})};return(v,m)=>(c(),C(B,{class:"px-0",fluid:""},{default:l(()=>[e(A,null,{default:l(()=>[e(g,{cols:"12"},{default:l(()=>[e(se,{label:"Ticket Type",variant:"outlined",modelValue:a.value.Type,"onUpdate:modelValue":m[0]||(m[0]=r=>a.value.Type=r),items:I(He),"item-title":"title","item-value":"value","hide-details":""},null,8,["modelValue","items"])]),_:1}),e(g,{cols:"12"},{default:l(()=>[e(S,{label:I(x).formLabelName,type:"text",variant:"outlined",modelValue:a.value.Name,"onUpdate:modelValue":m[1]||(m[1]=r=>a.value.Name=r),"hide-details":""},null,8,["label","modelValue"])]),_:1}),e(g,{cols:"12"},{default:l(()=>[e(S,{label:I(x).formLabelDescription,type:"text",variant:"outlined",modelValue:a.value.Description,"onUpdate:modelValue":m[2]||(m[2]=r=>a.value.Description=r),"hide-details":""},null,8,["label","modelValue"])]),_:1}),a.value.Type!==I(L).TICKET_TYPE_GROUP?(c(),k($,{key:0},[e(g,{cols:"12"},{default:l(()=>[e(W,{label:I(x).formLabelRequiresAccommodation,modelValue:a.value.RequiresAccommodation,"onUpdate:modelValue":m[3]||(m[3]=r=>a.value.RequiresAccommodation=r),"hide-details":""},null,8,["label","modelValue"])]),_:1}),e(g,{cols:"12"},{default:l(()=>[e(S,{label:I(x).formLabelDateStart,type:"date",variant:"outlined",modelValue:a.value.DateStart,"onUpdate:modelValue":m[4]||(m[4]=r=>a.value.DateStart=r),"hide-details":""},null,8,["label","modelValue"])]),_:1}),e(g,{cols:"12"},{default:l(()=>[e(S,{label:I(x).formLabelDateEnd,type:"date",variant:"outlined",modelValue:a.value.DateEnd,"onUpdate:modelValue":m[5]||(m[5]=r=>a.value.DateEnd=r),"hide-details":""},null,8,["label","modelValue"])]),_:1}),e(g,{cols:"12"},{default:l(()=>[e(S,{label:I(x).formLabelPrice,type:"text",variant:"outlined","prepend-inner-icon":I(x).currencyIcon,modelValue:a.value.Price,"onUpdate:modelValue":m[6]||(m[6]=r=>a.value.Price=r),modelModifiers:{number:!0},"persistent-hint":"",hint:"Adds additional charges for selecting this ticket"},null,8,["label","prepend-inner-icon","modelValue"])]),_:1})],64)):(c(),C(g,{key:1,cols:"12"},{default:l(()=>[e(ge,{label:"Tickets",variant:"outlined",tickets:d.value,modelValue:a.value.Tickets,"onUpdate:modelValue":m[7]||(m[7]=r=>a.value.Tickets=r),chips:"",clearable:"",multiple:"","persistent-hint":"",hint:"Tickets that belong to this group."},null,8,["tickets","modelValue"])]),_:1})),e(g,{cols:"12"},{default:l(()=>[e(oe,{label:"Applied Tags",variant:"outlined",modelValue:a.value.AppliesTags,"onUpdate:modelValue":m[8]||(m[8]=r=>a.value.AppliesTags=r),convention:v.convention,organisation:v.convention.OrganisationUUID,chips:"",clearable:"",hint:"Tags that a user acquires by selecting this ticket."},null,8,["modelValue","convention","organisation"])]),_:1}),e(g,{cols:"12"},{default:l(()=>[e(oe,{label:"Required Tags",variant:"outlined",modelValue:a.value.RequiredTags,"onUpdate:modelValue":m[9]||(m[9]=r=>a.value.RequiredTags=r),convention:v.convention,organisation:v.convention.OrganisationUUID,chips:"",clearable:"",hint:"Tags that a user must have to see this ticket."},null,8,["modelValue","convention","organisation"])]),_:1}),a.value.Type===I(L).TICKET_TYPE_TICKET?(c(),k($,{key:2},[e(g,{cols:"12"},{default:l(()=>[e(S,{label:"Components Required",type:"number",variant:"outlined",modelValue:a.value.ComponentsRequired,"onUpdate:modelValue":m[10]||(m[10]=r=>a.value.ComponentsRequired=r),modelModifiers:{number:!0},"persistent-hint":"",hint:"How many components must be selected."},null,8,["modelValue"])]),_:1}),e(g,{cols:"12"},{default:l(()=>[e(ge,{label:"Components",variant:"outlined",tickets:u.value,modelValue:a.value.TicketComponents,"onUpdate:modelValue":m[11]||(m[11]=r=>a.value.TicketComponents=r),chips:"",clearable:"",multiple:"","persistent-hint":"",hint:"Components that are part of this ticket (and others)."},null,8,["tickets","modelValue"])]),_:1}),e(g,{cols:"12"},{default:l(()=>[e(ge,{label:"Addons",variant:"outlined",tickets:n.value,modelValue:a.value.AddonTickets,"onUpdate:modelValue":m[12]||(m[12]=r=>a.value.AddonTickets=r),chips:"",clearable:"",multiple:"","persistent-hint":"",hint:"Optional ticket addons that apply for this ticket."},null,8,["tickets","modelValue"])]),_:1})],64)):F("",!0),e(g,{cols:"12"},{default:l(()=>[e(ge,{label:"Disables Tickets",variant:"outlined",tickets:v.tickets,modelValue:a.value.DisablesTickets,"onUpdate:modelValue":m[13]||(m[13]=r=>a.value.DisablesTickets=r),chips:"",clearable:"",multiple:"","persistent-hint":"",hint:"Tickets that are mutually exclusive and can't be selected if this one is."},null,8,["tickets","modelValue"])]),_:1})]),_:1}),t(a.value).length?(c(),C(A,{key:0,class:"align-center",dense:!0},{default:l(()=>[e(g,{class:"flex-grow-0 flex-shrink-1 text-no-wrap font-italic"},{default:l(()=>[Ul]),_:1}),e(g,{class:"flex-grow-1"},{default:l(()=>[e(qe,null,{default:l(()=>[(c(!0),k($,null,K(t(a.value),r=>(c(),C(Me,{key:r.ID,title:"Automatically calculated",disabled:!0},{default:l(()=>[b(R(r.Name),1)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})):F("",!0),e(A,null,{default:l(()=>[e(g,{class:"text-right"},{default:l(()=>[e(Z,{onClick:o})]),_:1})]),_:1})]),_:1}))}}),Dl={class:"pr-2"},Il={class:"mb-2"},gl={key:0,class:"text-grey-darken-1 font-italic"},yl={key:1,class:"text-red"},_l={key:0,class:"text-grey-darken-1 font-italic"},Cl={key:1,class:"text-red"},bl={key:0,class:"text-grey-darken-1 font-italic"},hl={key:1,class:"text-red"},kl={class:"text-grey-darken-1"},El=P({__name:"EditConventionTickets",props:O({accommodation:{default:()=>[]},convention:{}},{modelValue:{default:[]}}),emits:O(["close"],["update:modelValue"]),setup(T,{emit:s}){const a=M(T,"modelValue"),i=G(),d=()=>{a.value.push({ID:0,TicketUUID:q(),ConventionID:T.convention.ID,ConventionUUID:T.convention.ConventionUUID,Order:a.value.length+1,Name:"New Ticket",Type:L.TICKET_TYPE_GROUP,Description:"",DateStart:"",DateEnd:"",Price:0,Tickets:[],RequiresAccommodation:!1,AppliesTags:[],RequiredTags:[],RequiredGroupMemberships:[],TicketComponents:[],ComponentsRequired:0,AddonTickets:[],DisablesTickets:[]})},n=t=>{i.deleteTicket(a.value[t].TicketUUID).then(o=>{o&&a.value.splice(t,1)})},u=t=>t.Type===L.TICKET_TYPE_GROUP?"mdi:mdi-group":t.Type===L.TICKET_TYPE_TICKET?t.RequiresAccommodation?"mdi:mdi-home":t.ComponentsRequired>0?"mdi:mdi-ticket-confirmation":"mdi:mdi-ticket":t.Type===L.TICKET_TYPE_TICKET_COMPONENT?"mdi:mdi-cog-outline":t.Type===L.TICKET_TYPE_ADD_ON?"mdi:mdi-home-plus":"mdi:mdi-help";return(t,o)=>(c(),C(de,null,{default:l(()=>[e(ne,{dark:"",color:"primary"},{default:l(()=>[e(N,{icon:"",dark:"",onClick:o[0]||(o[0]=v=>s("close"))},{default:l(()=>[e(z,null,{default:l(()=>[b("mdi:mdi-close")]),_:1})]),_:1}),e(ue,null,{default:l(()=>[b("Edit Tickets")]),_:1}),e(ee),e(ve,null,{default:l(()=>[e(N,{variant:"text",onClick:d},{default:l(()=>[b(" Add Ticket ")]),_:1})]),_:1})]),_:1}),e(ce,{class:"pa-0"},{default:l(()=>[e(fe,null,{default:l(()=>[(c(!0),k($,null,K(a.value,(v,m)=>(c(),C(Ve,{key:v.ID,class:"mt-0"},{default:l(()=>[e(Ue,{class:"py-2"},{actions:l(({expanded:r})=>[e(Z,{class:"mr-1",color:"red",icon:"mdi:mdi-close",size:"x-small",onClick:p=>n(m)},null,8,["onClick"]),e(z,{class:"align-self-center text-h5",icon:r?"mdi:mdi-chevron-up":"mdi:mdi-chevron-down",variant:"flat",size:"x-small"},null,8,["icon"])]),default:l(()=>[e(N,{icon:"mdi:mdi-menu-up",size:"x-small",color:"primary",class:"mr-1",onClick:re(r=>I(Ae)(v,a.value),["stop"])},null,8,["onClick"]),e(N,{icon:"mdi:mdi-menu-down",size:"x-small",color:"secondary",class:"mr-4",onClick:re(r=>I(Se)(v,a.value),["stop"])},null,8,["onClick"]),E("div",Dl,[e(z,{icon:u(v)},null,8,["icon"])]),E("div",null,[E("p",Il,[b(R(v.Name)+" ",1),v.Type===I(L).TICKET_TYPE_TICKET?(c(),k($,{key:0},[a.value.find(r=>r.Type===I(L).TICKET_TYPE_GROUP&&r.Tickets.find(p=>p&&p.TicketUUID===v.TicketUUID))?(c(),k("span",gl," ("+R(a.value.filter(r=>r.Type===I(L).TICKET_TYPE_GROUP&&r.Tickets.find(p=>p&&p.TicketUUID===v.TicketUUID)).map(r=>r.Name).join(", "))+") ",1)):(c(),k("span",yl," (Ticket does not belong to any categories.) "))],64)):F("",!0),v.Type===I(L).TICKET_TYPE_ADD_ON?(c(),k($,{key:1},[a.value.find(r=>r.Type===I(L).TICKET_TYPE_TICKET&&r.AddonTickets.find(p=>p&&p.TicketUUID===v.TicketUUID))?(c(),k("span",_l," ("+R(a.value.filter(r=>r.Type===I(L).TICKET_TYPE_TICKET&&r.AddonTickets.find(p=>p&&p.TicketUUID===v.TicketUUID)).map(r=>r.Name).join(", "))+") ",1)):(c(),k("span",Cl," (Ticket addon must be associated to at least one ticket.) "))],64)):F("",!0),v.Type===I(L).TICKET_TYPE_TICKET_COMPONENT?(c(),k($,{key:2},[a.value.find(r=>r.Type===I(L).TICKET_TYPE_TICKET&&r.TicketComponents.find(p=>p&&p.TicketUUID===v.TicketUUID))?(c(),k("span",bl," ("+R(a.value.filter(r=>r.Type===I(L).TICKET_TYPE_TICKET&&r.TicketComponents.find(p=>p&&p.TicketUUID===v.TicketUUID)).map(r=>r.Name).join(", "))+") ",1)):(c(),k("span",hl," (Component has not been assigned to any tickets.) "))],64)):F("",!0)]),E("p",kl,[v.Type===I(L).TICKET_TYPE_GROUP?(c(),k($,{key:0},[b("Category")],64)):v.Type===I(L).TICKET_TYPE_TICKET?(c(),k($,{key:1},[b(" Ticket "),v.ComponentsRequired>0?(c(),k($,{key:0},[b(" ("+R(v.ComponentsRequired)+" component"+R(v.ComponentsRequired>1?"s":"")+" required) ",1)],64)):F("",!0)],64)):F("",!0),v.Type===I(L).TICKET_TYPE_TICKET_COMPONENT?(c(),k($,{key:2},[b("Component")],64)):F("",!0),v.Type===I(L).TICKET_TYPE_ADD_ON?(c(),k($,{key:3},[b("Addon")],64)):F("",!0)])])]),_:2},1024),e(Te,{class:"px-0"},{default:l(()=>[e(Tl,{accommodation:t.accommodation,convention:t.convention,tickets:a.value,modelValue:a.value[m],"onUpdate:modelValue":r=>a.value[m]=r},null,8,["accommodation","convention","tickets","modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1}))}}),$l=E("h3",null,"Tickets",-1),Nl=E("p",null,"Ticket options, along with all sub-types and options applicable to them.",-1),Al=P({__name:"Tickets",props:{modelValue:{required:!0}},emits:O(["refresh"],["update:modelValue"]),setup(T){var r;const s=M(T,"modelValue"),a=G(),i=y([]),d=y([]);a.getConventionTickets(((r=s.value)==null?void 0:r.ConventionUUID)||"").then(p=>{Pe(p),i.value=p});const n=y([""]),u=y(!1),t=p=>p.AddonTickets&&p.AddonTickets.map(V=>i.value&&i.value.find(f=>f.ID===V.ID)),o=p=>p.TicketComponents&&p.TicketComponents.map(V=>i.value&&i.value.find(f=>f.ID===V.ID)),v=p=>"",m=p=>d.value.filter(V=>V.Costs.find(f=>f.DateStart===p.DateStart&&f.DateEnd===p.DateEnd)).map(V=>V.Name).join(", ");return(p,V)=>(c(),k($,null,[e(B,{fluid:!0,class:"px-0"},{default:l(()=>[e(A,null,{default:l(()=>[e(g,null,{default:l(()=>[$l]),_:1}),e(g,{class:"text-right"},{default:l(()=>[e(N,{color:"primary",onClick:V[0]||(V[0]=f=>u.value=!0)},{default:l(()=>[b("Edit")]),_:1})]),_:1})]),_:1})]),_:1}),Nl,e(he,{opened:n.value,"onUpdate:opened":V[1]||(V[1]=f=>n.value=f)},{default:l(()=>[(c(!0),k($,null,K(i.value.filter(f=>f.Type===I(L).TICKET_TYPE_GROUP),f=>(c(),C($e,{key:f.ID,value:f.ID},{activator:l(({props:U})=>[e(te,ke(U,{"prepend-icon":"mdi:mdi-group",title:f.Name}),null,16,["title"])]),default:l(()=>[(c(!0),k($,null,K(i.value.filter(U=>f.Tickets.find(D=>D&&U&&D.TicketUUID===U.TicketUUID)),U=>(c(),k($,{key:U.ID},[U.AddonTickets&&U.AddonTickets.length?(c(),C($e,{key:0,value:U.ID},{activator:l(({props:D})=>[e(te,ke(D,{"prepend-icon":U.RequiresAccommodation?"mdi:mdi-home":U.ComponentsRequired>0?"mdi:mdi-ticket-confirmation":"mdi:mdi-ticket",title:`${U.Name} ${U.Price>0?`(${I(x).currencySymbol}${U.Price})`:""}`}),{default:l(()=>[U.ComponentsRequired>0?(c(),C(le,{key:0},{default:l(()=>[b(" Options: "+R(o(U).map(_=>_&&_.Name).join(", ")),1)]),_:2},1024)):F("",!0),U.RequiresAccommodation&&m(U)?(c(),C(le,{key:1},{default:l(()=>[b(" Accommodation: "+R(m(U)),1)]),_:2},1024)):F("",!0)]),_:2},1040,["prepend-icon","title"])]),default:l(()=>[(c(!0),k($,null,K(t(U),D=>(c(),k($,{key:D},[D?(c(),C(te,{key:0,title:`${D.Name} ${D.Price>0?`(${I(x).currencySymbol}${D.Price})`:""}`,"prepend-icon":"mdi:mdi-home-plus"},{default:l(()=>[D.RequiredTags&&D.RequiredTags.length>0?(c(),C(le,{key:0},{default:l(()=>[b(" Required Tags: "+R(D.RequiredTags.join(", ")),1)]),_:2},1024)):F("",!0),D.RequiredGroupMemberships&&D.RequiredGroupMemberships.length>0?(c(),C(le,{key:1},{default:l(()=>[b(" Required Groups: "+R(v(D.RequiredGroupMemberships)),1)]),_:2},1024)):F("",!0),m(D)?(c(),C(le,{key:2},{default:l(()=>[b(" Accommodation: "+R(m(D)),1)]),_:2},1024)):F("",!0)]),_:2},1032,["title"])):F("",!0)],64))),128))]),_:2},1032,["value"])):(c(),C(te,{key:1,"prepend-icon":U.RequiresAccommodation?"mdi:mdi-home":U.ComponentsRequired>0?"mdi:mdi-ticket-confirmation":"mdi:mdi-ticket",title:`${U.Name} ${U.Price>0?`(${I(x).currencySymbol}${U.Price})`:""}`},{default:l(()=>[U.ComponentsRequired>0?(c(),C(le,{key:0},{default:l(()=>[b(" Options: "+R(o(U).map(D=>D&&D.Name).join(", ")),1)]),_:2},1024)):F("",!0)]),_:2},1032,["prepend-icon","title"]))],64))),128))]),_:2},1032,["value"]))),128))]),_:1},8,["opened"]),e(pe,{modelValue:u.value,"onUpdate:modelValue":V[4]||(V[4]=f=>u.value=f),scrollable:!0},{default:l(()=>[e(El,{onClose:V[2]||(V[2]=f=>u.value=!1),modelValue:i.value,"onUpdate:modelValue":V[3]||(V[3]=f=>i.value=f),accommodation:d.value,convention:s.value},null,8,["modelValue","accommodation","convention"])]),_:1},8,["modelValue"])],64))}}),Sl=P({__name:"VenueRoomCost",props:{modelValue:{required:!0}},emits:O(["deleted"],["update:modelValue"]),setup(T,{emit:s}){const a=M(T,"modelValue"),i=[{title:"Per Room",value:"PER_ROOM"},{title:"Per Person",value:"PER_PERSON"}],d=()=>{s("deleted")};return(n,u)=>(c(),C(A,{dense:""},{default:l(()=>[e(g,{cols:"12",sm:"4",md:"2",lg:"2"},{default:l(()=>[e(S,{label:I(x).formLabelDateStart,type:"date",variant:"outlined",modelValue:a.value.DateStart,"onUpdate:modelValue":u[0]||(u[0]=t=>a.value.DateStart=t)},null,8,["label","modelValue"])]),_:1}),e(g,{cols:"12",sm:"4",md:"2",lg:"2"},{default:l(()=>[e(S,{label:I(x).formLabelDateEnd,type:"date",variant:"outlined",modelValue:a.value.DateEnd,"onUpdate:modelValue":u[1]||(u[1]=t=>a.value.DateEnd=t)},null,8,["label","modelValue"])]),_:1}),e(g,{cols:"6",sm:"4",md:"2",lg:"2"},{default:l(()=>[e(S,{label:I(x).formLabelAvailability,type:"number",variant:"outlined",modelValue:a.value.Availability,"onUpdate:modelValue":u[2]||(u[2]=t=>a.value.Availability=t),modelModifiers:{number:!0}},null,8,["label","modelValue"])]),_:1}),e(g,{cols:"6",sm:"4",md:"2",lg:"2"},{default:l(()=>[e(S,{label:I(x).formLabelPrice,type:"number","prepend-inner-icon":"mdi:mdi-currency-gbp",variant:"outlined",modelValue:a.value.Price,"onUpdate:modelValue":u[3]||(u[3]=t=>a.value.Price=t),modelModifiers:{number:!0}},null,8,["label","modelValue"])]),_:1}),e(g,{cols:"6",sm:"4",md:"3",lg:"3"},{default:l(()=>[e(se,{label:I(x).formLabelPriceType,variant:"outlined",modelValue:a.value.Type,"onUpdate:modelValue":u[4]||(u[4]=t=>a.value.Type=t),items:i,"item-value":"value","item-title":"title"},null,8,["label","modelValue"])]),_:1}),e(g,{cols:"6",sm:"4",md:"1",class:"text-right"},{default:l(()=>[e(N,{color:"red",icon:"mdi:mdi-minus",onClick:d})]),_:1})]),_:1}))}}),Fl=E("strong",null,"Capacity:",-1),Ol=E("thead",null,[E("tr",null,[E("th",null,"Date"),E("th",null,"Price"),E("th",null,"Availability")])],-1),Rl={class:"d-flex flex-wrap justify-space-between",style:{gap:"1rem"}},Pl=E("h4",null," Availability & Costs (To Organisation) ",-1),xl=P({__name:"VenueRoom",props:{modelValue:{required:!0}},emits:O(["deleted"],["update:modelValue"]),setup(T,{emit:s}){const a=G(),i=y(x),d=M(T,"modelValue"),n=y(j(d.value)),u=y(!1),t=p=>{switch(p.Type){case Ce.PER_PERSON:return i.value.enumPER_PERSON;case Ce.PER_ROOM:return i.value.enumPER_ROOM}return"Unknown"},o=()=>{n.value.Costs||(n.value.Costs=[]),n.value.Costs.push({ID:0,CostUUID:q(),Availability:0,DateStart:"",DateEnd:"",Price:0,Type:"PER_ROOM"})},v=p=>{n.value.Costs.splice(p,1)},m=({callback:p})=>{const V=()=>{p&&p("Failed to Delete Room")},f=()=>{p&&p("Room Deleted")};a.deleteRoom(n.value.RoomUUID).then(U=>{U?(f(),s("deleted",n.value)):V()}).catch(()=>{V()})},r=()=>{a.saveRoom(n.value).then(()=>{d.value=n.value,u.value=!1})};return(p,V)=>(c(),k($,null,[e(B,{fluid:"",class:"pa-1 pa-sm-2"},{default:l(()=>[E("h4",null,R(n.value.Name),1),E("p",null,R(n.value.Notes),1),E("p",null,[Fl,b(" "+R(n.value.MinimumCapacity)+" ",1),n.value.MinimumCapacity!=n.value.MaximumCapacity?(c(),k($,{key:0},[b(" - "+R(n.value.MaximumCapacity),1)],64)):F("",!0)]),e(ll,{density:"compact"},{default:l(()=>[Ol,E("tbody",null,[(c(!0),k($,null,K(n.value.Costs,f=>(c(),k("tr",{key:`venue-room-${n.value.ID}-cost-${f.ID}`},[E("td",null,R(f.DateStart)+" - "+R(f.DateEnd),1),E("td",null,R(i.value.currencySymbol)+R(f.Price)+" "+R(t(f)),1),E("td",null,R(f.Availability),1)]))),128))])]),_:1}),E("div",Rl,[e(N,{color:"primary","prepend-icon":"mdi:mdi-playlist-edit",onClick:V[0]||(V[0]=f=>u.value=!0)},{default:l(()=>[b("Edit Room")]),_:1}),e(Z,{color:"red-darken-3","prepend-icon":"mdi:mdi-minus",onClick:m},{default:l(()=>[b("Delete Room")]),_:1})])]),_:1}),e(pe,{scrollable:"",modelValue:u.value,"onUpdate:modelValue":V[6]||(V[6]=f=>u.value=f),width:"auto"},{default:l(()=>[e(de,null,{default:l(()=>[e(ne,{dark:"",color:"primary"},{default:l(()=>[e(N,{icon:"",dark:"",onClick:V[1]||(V[1]=f=>u.value=!1)},{default:l(()=>[e(z,null,{default:l(()=>[b("mdi:mdi-close")]),_:1})]),_:1}),e(ue,null,{default:l(()=>[b("Room Details ("+R(n.value.Name)+")",1)]),_:1}),e(ee),e(ve,null,{default:l(()=>[e(N,{variant:"text",onClick:r},{default:l(()=>[b(" Save ")]),_:1})]),_:1})]),_:1}),e(ce,null,{default:l(()=>[e(ae,null,{default:l(()=>[e(A,null,{default:l(()=>[e(g,{cols:"12"},{default:l(()=>[e(S,{label:i.value.formLabelName,type:"text",variant:"outlined",modelValue:n.value.Name,"onUpdate:modelValue":V[2]||(V[2]=f=>n.value.Name=f)},null,8,["label","modelValue"])]),_:1})]),_:1}),e(A,null,{default:l(()=>[e(g,null,{default:l(()=>[e(Ie,{label:i.value.formLabelNotes,variant:"outlined",modelValue:n.value.Notes,"onUpdate:modelValue":V[3]||(V[3]=f=>n.value.Notes=f)},null,8,["label","modelValue"])]),_:1})]),_:1}),e(A,null,{default:l(()=>[e(g,{cols:"12",sm:"6"},{default:l(()=>[e(S,{type:"number",label:i.value.formLabelMinimumCapacity,variant:"outlined",modelValue:n.value.MinimumCapacity,"onUpdate:modelValue":V[4]||(V[4]=f=>n.value.MinimumCapacity=f),modelModifiers:{number:!0}},null,8,["label","modelValue"])]),_:1}),e(g,{cols:"12",sm:"6"},{default:l(()=>[e(S,{type:"number",label:i.value.formLabelMaximumCapacity,variant:"outlined",modelValue:n.value.MaximumCapacity,"onUpdate:modelValue":V[5]||(V[5]=f=>n.value.MaximumCapacity=f),modelModifiers:{number:!0}},null,8,["label","modelValue"])]),_:1})]),_:1}),e(A,null,{default:l(()=>[e(g,null,{default:l(()=>[Pl]),_:1})]),_:1}),(c(!0),k($,null,K(n.value.Costs,(f,U)=>(c(),k($,{key:`venue-room-${n.value.ID}-cost-${f.ID}`},[n.value.Costs&&n.value.Costs[U]?(c(),C(Sl,{key:0,modelValue:n.value.Costs[U],"onUpdate:modelValue":D=>n.value.Costs[U]=D,onDeleted:D=>v(U)},null,8,["modelValue","onUpdate:modelValue","onDeleted"])):F("",!0)],64))),128)),e(N,{color:"primary","prepend-icon":"mdi:mdi-plus",onClick:o},{default:l(()=>[b("Add Row")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}}),wl=E("h3",null,"Rooms",-1),ql=P({__name:"Venue",props:{modelValue:{required:!0}},emits:O(["deleted"],["update:modelValue"]),setup(T,{emit:s}){const a=G(),i=M(T,"modelValue"),d=y(j(i.value)),n=y([]),u=y(!1),t=y(!1);a.getVenueRooms(d.value.VenueUUID).then(p=>{n.value=p}),H(d.value,()=>{t.value=!0});const o=({callback:p})=>{u.value=!0,a.saveVenue(d.value).then(()=>{u.value=!1,t.value=!1,i.value=d.value,p&&p("Venue Saved")}).catch(()=>{u.value=!1,p&&p("Failed to Saved Venue")})},v=({callback:p})=>{u.value=!0,a.deleteVenue(d.value.VenueUUID).then(V=>{u.value=!1,V?p&&(p("Venue Deleted"),s("deleted")):p&&p("Failed to Delete Venue")}).catch(()=>{p&&(p("Failed to Delete Venue"),u.value=!1)})},m=()=>{const p={ID:0,RoomUUID:q(),VenueID:d.value.ID,VenueUUID:d.value.VenueUUID,Order:n.value.length+1,Name:"New Room",Notes:"",MaximumCapacity:1,MinimumCapacity:1,Costs:[]};a.saveRoom(p).then(V=>{V&&n.value.push(V)})},r=(p,V)=>{a.deleteRoom(n.value[V].RoomUUID).then(f=>{f&&n.value.splice(V,1)})};return(p,V)=>(c(),C(Ve,null,{default:l(()=>[e(Ue,null,{default:l(()=>[b(R(d.value.Name),1)]),_:1}),e(Te,null,{default:l(()=>[e(A,{"no-gutters":""},{default:l(()=>[e(g,{cols:"12"},{default:l(()=>[e(S,{label:I(x).formLabelName,name:"name",variant:"outlined",modelValue:d.value.Name,"onUpdate:modelValue":V[0]||(V[0]=f=>d.value.Name=f)},null,8,["label","modelValue"])]),_:1}),e(g,{cols:"12"},{default:l(()=>[e(Ie,{label:I(x).formLabelDescription,name:"description",variant:"outlined",modelValue:d.value.Description,"onUpdate:modelValue":V[1]||(V[1]=f=>d.value.Description=f)},null,8,["label","modelValue"])]),_:1}),e(g,{class:"text-right",cols:"12"},{default:l(()=>[e(Z,{class:"mr-2",color:"red-darken-3",label:"Delete",onClick:v}),e(Z,{enabled:t.value,timeout:"7",onClick:o},null,8,["enabled"])]),_:1})]),_:1}),wl,(c(!0),k($,null,K(n.value,(f,U)=>(c(),C(ae,{variant:"elevation",elevation:"6",key:`venue-room-${f.ID}`},{default:l(()=>[n.value&&n.value[U]?(c(),C(xl,{key:0,modelValue:n.value[U],"onUpdate:modelValue":D=>n.value[U]=D,onDeleted:D=>r(D,U)},null,8,["modelValue","onUpdate:modelValue","onDeleted"])):F("",!0)]),_:2},1024))),128)),e(ae,{class:"ma-2"},{default:l(()=>[e(N,{color:"primary","prepend-icon":"mdi:mdi-plus",onClick:m},{default:l(()=>[b("Add Room")]),_:1})]),_:1})]),_:1})]),_:1}))}}),Ml=E("h3",null,"Venues",-1),Ll=E("p",null," Venues and the rooms they supply to the organisation, this is internal data not seen by attendees. ",-1),Kl=E("p",null," Attendee options are configured via the accommodation tab. ",-1),Gl=P({__name:"VenuesEditorView",props:{modelValue:{required:!0}},emits:O(["close","pageTitle","refresh"],["update:modelValue"]),setup(T,{emit:s}){const a=G(),i=M(T,"modelValue");s("pageTitle","Venues");const d=y([]);a.getConventionVenues(i.value.ConventionUUID).then(t=>{d.value=t});const n=()=>{const t={ID:0,VenueUUID:q(),ConventionID:i.value.ID,ConventionUUID:i.value.ConventionUUID,Order:d.value.length+1,Name:"New Venue",Description:"",Rooms:[]};a.saveVenue(t).then(o=>{o&&d.value.push(o)})},u=t=>{d.value.splice(t,1)};return(t,o)=>(c(),k($,null,[e(B,{fluid:"",class:"px-0"},{default:l(()=>[e(A,null,{default:l(()=>[e(g,null,{default:l(()=>[Ml]),_:1})]),_:1})]),_:1}),Ll,Kl,e(ae,null,{default:l(()=>[e(fe,{variant:"accordion"},{default:l(()=>[(c(!0),k($,null,K(d.value,(v,m)=>(c(),C(ql,{key:`venues-${v.ID}`,modelValue:d.value[m],"onUpdate:modelValue":r=>d.value[m]=r,onDeleted:r=>u(m)},null,8,["modelValue","onUpdate:modelValue","onDeleted"]))),128))]),_:1}),e(ae,{class:"pa-2"},{default:l(()=>[e(N,{color:"primary",onClick:n},{default:l(()=>[b("Add Venue")]),_:1})]),_:1})]),_:1})],64))}}),Yl=E("p",{title:"Automatically calculated",class:"text-grey-lighten-1"},"Applicable Tickets:",-1),jl=P({__name:"AccommodationCost",props:O({convention:{}},{modelValue:{required:!0}}),emits:O(["deleted"],["update:modelValue"]),setup(T,{emit:s}){const a=M(T,"modelValue"),i=y([]);G().getConventionTickets(T.convention.ConventionUUID).then(o=>{o&&(i.value=o)});const n=[{title:"Per Room",value:"PER_ROOM"},{title:"Per Person",value:"PER_PERSON"}],u=()=>{s("deleted")},t=X(()=>i.value.filter(o=>(o.Type===L.TICKET_TYPE_TICKET||o.Type===L.TICKET_TYPE_ADD_ON)&&o.RequiresAccommodation&&o.DateStart===a.value.DateStart&&o.DateEnd===a.value.DateEnd));return(o,v)=>(c(),k($,null,[e(A,{class:"align-center",dense:""},{default:l(()=>[e(g,{class:"flex-grow-0 flex-shrink-1 text-no-wrap font-italic"},{default:l(()=>[Yl]),_:1}),e(g,{class:"flex-grow-1"},{default:l(()=>[e(qe,null,{default:l(()=>[(c(!0),k($,null,K(t.value,m=>(c(),C(Me,{key:m.ID,title:"Automatically calculated",disabled:""},{default:l(()=>[b(R(m.Name),1)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1}),e(A,{dense:""},{default:l(()=>[e(g,{cols:"12",sm:"6",md:"3"},{default:l(()=>[e(S,{label:I(x).formLabelDateStart,type:"date",variant:"outlined",modelValue:a.value.DateStart,"onUpdate:modelValue":v[0]||(v[0]=m=>a.value.DateStart=m)},null,8,["label","modelValue"])]),_:1}),e(g,{cols:"12",sm:"6",md:"3"},{default:l(()=>[e(S,{label:I(x).formLabelDateEnd,type:"date",variant:"outlined",modelValue:a.value.DateEnd,"onUpdate:modelValue":v[1]||(v[1]=m=>a.value.DateEnd=m)},null,8,["label","modelValue"])]),_:1}),e(g,{cols:"5",sm:"6",md:"3"},{default:l(()=>[e(S,{label:I(x).formLabelPrice,type:"number","prepend-inner-icon":"mdi:mdi-currency-gbp",variant:"outlined",modelValue:a.value.Price,"onUpdate:modelValue":v[2]||(v[2]=m=>a.value.Price=m),modelModifiers:{number:!0}},null,8,["label","modelValue"])]),_:1}),e(g,{cols:"5",sm:"4",md:"2"},{default:l(()=>[e(se,{label:I(x).formLabelPriceType,variant:"outlined",modelValue:a.value.Type,"onUpdate:modelValue":v[3]||(v[3]=m=>a.value.Type=m),items:n,"item-value":"value","item-title":"title"},null,8,["label","modelValue"])]),_:1}),e(g,{cols:"2",sm:"2",md:"1",class:"text-right"},{default:l(()=>[e(N,{color:"red",icon:"mdi:mdi-minus",onClick:u})]),_:1})]),_:1})],64))}}),Bl=E("h4",null," Room Pool ",-1),zl=E("p",{class:"mb-4"}," Hotel rooms that can be used for this accommodation option. ",-1),Hl=E("p",null," Pool total: ",-1),Jl=E("h4",null," Accommodation Costs ",-1),Xl=E("p",{class:"mb-4"}," How much the attendee is charged by the convention for the accommodation. ",-1),Wl=P({__name:"Accommodation",props:O({convention:{},venues:{}},{modelValue:{required:!0}}),emits:O(["deleted"],["update:modelValue"]),setup(T,{emit:s}){const a=G(),i=M(T,"modelValue"),d=y(j(i.value)),n=X(()=>T.venues.map(m=>m.Rooms.map(r=>({title:` ${m.Name} - ${r.Name}`,value:r}))).flat()),u=()=>{d.value.Costs||(d.value.Costs=[]),d.value.Costs.push({ID:0,CostUUID:q(),Availability:0,DateStart:"",DateEnd:"",Price:0,Type:Ce.PER_ROOM})},t=m=>{d.value.Costs.splice(m,1)},o=({callback:m})=>{a.deleteAccommodation(d.value.AccommodationUUID).then(r=>{r?m&&(m("Accommodation Deleted"),s("deleted")):m&&m("Failed to Delete Accommodation")}).catch(()=>{m&&m("Failed to Delete Accommodation")})},v=({callback:m})=>{a.saveAccommodation(d.value).then(r=>{r?(d.value.ID=r.ID,i.value=r,m&&m("Accommodation Saved")):m&&m("Failed to Save Accommodation")}).catch(()=>{m&&m("Failed to Save Accommodation")})};return(m,r)=>(c(),C(Ve,null,{default:l(()=>[e(Ue,null,{default:l(()=>[b(R(d.value.Name),1)]),_:1}),e(Te,null,{default:l(()=>[e(ae,null,{default:l(()=>[e(A,null,{default:l(()=>[e(g,null,{default:l(()=>[e(S,{modelValue:d.value.Name,"onUpdate:modelValue":r[0]||(r[0]=p=>d.value.Name=p),label:"Name",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1})]),_:1}),e(A,null,{default:l(()=>[e(g,null,{default:l(()=>[Bl,zl,e(se,{clearable:!0,modelValue:d.value.Pool,"onUpdate:modelValue":r[1]||(r[1]=p=>d.value.Pool=p),items:n.value,label:"Select",multiple:"",hint:"Pick appropriate rooms","persistent-hint":"",variant:"outlined","item-title":"title","item-value":"value",eager:!0},null,8,["modelValue","items"]),Hl,E("p",null,[e(oe,{label:"Required Tags",variant:"outlined",modelValue:d.value.RequiredTags,"onUpdate:modelValue":r[2]||(r[2]=p=>d.value.RequiredTags=p),convention:m.convention,organisation:m.convention.OrganisationUUID,chips:!0,clearable:!0,hint:"Tags that a user must have to select this accommodation."},null,8,["modelValue","convention","organisation"])]),Jl,Xl,d.value.Costs?(c(!0),k($,{key:0},K(d.value.Costs,(p,V)=>(c(),C(jl,{key:`venue-room-${d.value.ID}-cost-${p.ID}`,convention:m.convention,modelValue:d.value.Costs[V],"onUpdate:modelValue":f=>d.value.Costs[V]=f,onDeleted:f=>t(V)},null,8,["convention","modelValue","onUpdate:modelValue","onDeleted"]))),128)):F("",!0)]),_:1})]),_:1}),e(A,{"no-gutters":""},{default:l(()=>[e(g,{class:"text-left"},{default:l(()=>[e(N,{color:"primary","prepend-icon":"mdi:mdi-plus",onClick:u},{default:l(()=>[b("Add Row")]),_:1})]),_:1}),e(g,{class:"text-right"},{default:l(()=>[e(Z,{class:"mr-2",color:"red-darken-3",label:"Delete",onClick:o}),e(Z,{onClick:v})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}))}}),Ql=E("h3",null,"Accommodation",-1),Zl=E("p",null," Accommodation options presented to attendees, these are effectively virtual room types which are linked to the available room pools created in the venues tab. ",-1),et=E("p",null," Use the venues tab to configure internal data about the venues and room supply. ",-1),lt=P({__name:"AccommodationEditorView",props:{modelValue:{required:!0}},emits:["update:modelValue"],setup(T){const s=G(),a=M(T,"modelValue"),i=y([]),d=y([]);s.getConventionAccommodation(a.value.ConventionUUID).then(t=>{t&&(i.value=t)}),s.getConventionVenues(a.value.ConventionUUID).then(t=>{t&&(d.value=t)});const n=()=>{const t={ID:0,AccommodationUUID:q(),ConventionID:a.value.ID,ConventionUUID:a.value.ConventionUUID,Order:i.value.length+1,Name:"New Accommodation Option",Pool:[],Costs:[],RequiredTags:[]};s.saveAccommodation(t).then(o=>{o&&i.value.push(o)})},u=t=>{i.value.splice(t,1)};return(t,o)=>(c(),k($,null,[e(B,{fluid:!0,class:"px-0"},{default:l(()=>[e(A,null,{default:l(()=>[e(g,null,{default:l(()=>[Ql]),_:1})]),_:1})]),_:1}),Zl,et,e(ae,null,{default:l(()=>[e(fe,{variant:"accordion"},{default:l(()=>[(c(!0),k($,null,K(i.value,(v,m)=>(c(),C(Wl,{key:v.AccommodationUUID,convention:a.value,venues:d.value,modelValue:i.value[m],"onUpdate:modelValue":r=>i.value[m]=r,onDeleted:r=>u(m)},null,8,["convention","venues","modelValue","onUpdate:modelValue","onDeleted"]))),128))]),_:1}),e(ae,{class:"pa-2"},{default:l(()=>[e(N,{color:"primary",onClick:n},{default:l(()=>[b("Add Accommodation")]),_:1})]),_:1})]),_:1})],64))}}),tt=P({__name:"EditFieldDialogExtras",props:{modelValue:{required:!0}},emits:["update:modelValue"],setup(T){const s=M(T,"modelValue"),a=be.getInstance(),i=y([]),d=y([]);return a==null||a.getConventionExtras(s.value.ConventionUUID).then(n=>{i.value=n;const u=s.value.Values.find(t=>t.Title==="SelectedExtras");if(u)try{d.value=JSON.parse(u.Value)}catch{}}),H(d,()=>{const n=s.value.Values.find(u=>u.Title==="SelectedExtras");if(n)n.Value=JSON.stringify(d.value);else{const u={ID:0,FieldValueUUID:q(),FieldID:s.value.ID,FieldUUID:s.value.FieldUUID,Title:"SelectedExtras",Value:JSON.stringify(d.value)};s.value.Values.push(u)}}),(n,u)=>(c(!0),k($,null,K(i.value,t=>(c(),C(W,{key:t.ExtraUUID,modelValue:d.value,"onUpdate:modelValue":u[0]||(u[0]=o=>d.value=o),label:t.Name,value:t.ExtraUUID,name:s.value.Name,"hide-details":""},null,8,["modelValue","label","value","name"]))),128))}}),at=P({__name:"EditFieldDialogInterests",props:{modelValue:{required:!0}},emits:["update:modelValue"],setup(T){const s=M(T,"modelValue"),a=be.getInstance(),i=y([]),d=y([]);return a==null||a.getConventionInterests(s.value.ConventionUUID).then(n=>{i.value=n;const u=s.value.Values.find(t=>t.Title==="SelectedInterests");if(u)try{d.value=JSON.parse(u.Value)}catch{}}),H(d,()=>{const n=s.value.Values.find(u=>u.Title==="SelectedInterests");if(n)n.Value=JSON.stringify(d.value);else{const u={ID:0,FieldValueUUID:q(),FieldID:s.value.ID,FieldUUID:s.value.FieldUUID,Title:"SelectedInterests",Value:JSON.stringify(d.value)};s.value.Values.push(u)}}),(n,u)=>(c(!0),k($,null,K(i.value,t=>(c(),C(W,{key:t.InterestUUID,modelValue:d.value,"onUpdate:modelValue":u[0]||(u[0]=o=>d.value=o),label:t.Name,value:t.InterestUUID,name:s.value.Name,"hide-details":""},null,8,["modelValue","label","value","name"]))),128))}}),ot=P({__name:"EditFieldDialogTickets",props:{modelValue:{required:!0}},emits:["update:modelValue"],setup(T){const s=M(T,"modelValue"),a=be.getInstance(),i=y([]),d=y([]);return a==null||a.getConventionTickets(s.value.ConventionUUID).then(n=>{i.value=n;const u=s.value.Values.find(t=>t.Title==="SelectedTickets");if(u)try{d.value=JSON.parse(u.Value)}catch{}}),H(d,()=>{const n=s.value.Values.find(u=>u.Title==="SelectedTickets");if(n)n.Value=JSON.stringify(d.value);else{const u={ID:0,FieldValueUUID:q(),FieldID:s.value.ID,FieldUUID:s.value.FieldUUID,Title:"SelectedTickets",Value:JSON.stringify(d.value)};s.value.Values.push(u)}}),(n,u)=>(c(!0),k($,null,K(i.value.filter(t=>t&&t.Type===I(L).TICKET_TYPE_GROUP),t=>(c(),C(W,{key:t.TicketUUID,modelValue:d.value,"onUpdate:modelValue":u[0]||(u[0]=o=>d.value=o),label:t.Name,value:t.TicketUUID,name:s.value.Name,"hide-details":""},null,8,["modelValue","label","value","name"]))),128))}}),nt=E("h5",null,"Display Options",-1),ut=E("h5",null,"Accommodation Choices",-1),it=P({__name:"EditFieldDialogAccommodation",props:{modelValue:{required:!0}},emits:["update:modelValue"],setup(T){const s=M(T,"modelValue"),a=be.getInstance(),i=y([]),d=y(s.value.Values.map(t=>t.Value)),n=y({sharing:!1});try{const t=JSON.parse(s.value.Data);t&&(n.value=t)}catch{}const u=()=>{s.value.Data=JSON.stringify(n.value),s.value.Values=d.value.map(t=>{var o,v,m;return{ID:0,FieldValueUUID:q(),FieldID:((o=s.value)==null?void 0:o.ID)||0,FieldUUID:((v=s.value)==null?void 0:v.FieldUUID)||"",Title:((m=i.value.find(r=>r.AccommodationUUID==t))==null?void 0:m.Name)||"",Value:t}})};return a==null||a.getConventionAccommodation(s.value.ConventionUUID).then(t=>{t&&(i.value=t)}),(t,o)=>(c(),k($,null,[nt,e(W,{label:"Show Sharing Options",modelValue:n.value.sharing,"onUpdate:modelValue":o[0]||(o[0]=v=>n.value.sharing=v),"hide-details":"",onChange:u},null,8,["modelValue"]),ut,(c(!0),k($,null,K(i.value,v=>(c(),C(W,{key:v.ID,modelValue:d.value,"onUpdate:modelValue":o[1]||(o[1]=m=>d.value=m),label:v.Name,value:v.AccommodationUUID,"hide-details":"",onChange:u},null,8,["modelValue","label","value"]))),128))],64))}}),dt=P({__name:"EditFieldDialogAge",props:O({convention:{}},{modelValue:{required:!0}}),emits:["update:modelValue"],setup(T){var m,r,p;const s=M(T,"modelValue"),a=new Date,i=a.getFullYear(),d=(a.getMonth()+1).toLocaleString(navigator.language,{minimumIntegerDigits:2}),n=a.getDate().toLocaleString(navigator.language,{minimumIntegerDigits:2}),u=y(parseInt(((m=s.value.Values.find(V=>V.Title==="MIN_AGE"))==null?void 0:m.Value)||"18")),t=y(((r=s.value.Values.find(V=>V.Title==="BEFORE_DATE"))==null?void 0:r.Value)||`${i}-${d}-${n}`),o=y(((p=s.value.Values.find(V=>V.Title==="UNDER_AGE_APPLY_TAG"))==null?void 0:p.Value)||""),v=()=>{var V,f,U,D,_,h;s.value.Values=[{ID:0,FieldValueUUID:q(),FieldID:((V=s.value)==null?void 0:V.ID)||0,FieldUUID:((f=s.value)==null?void 0:f.FieldUUID)||"",Title:"MIN_AGE",Value:u.value.toString()},{ID:0,FieldValueUUID:q(),FieldID:((U=s.value)==null?void 0:U.ID)||0,FieldUUID:((D=s.value)==null?void 0:D.FieldUUID)||"",Title:"BEFORE_DATE",Value:t.value},{ID:0,FieldValueUUID:q(),FieldID:((_=s.value)==null?void 0:_.ID)||0,FieldUUID:((h=s.value)==null?void 0:h.FieldUUID)||"",Title:"UNDER_AGE_APPLY_TAG",Value:o.value}]};return v(),(V,f)=>(c(),C(B,{class:"pl-0 pr-0",fluid:!0},{default:l(()=>[e(A,null,{default:l(()=>[e(g,{cols:"12",sm:"6"},{default:l(()=>[e(S,{modelValue:u.value,"onUpdate:modelValue":f[0]||(f[0]=U=>u.value=U),modelModifiers:{number:!0},type:"number",label:"Minimum Age",variant:"outlined",onChange:v},null,8,["modelValue"])]),_:1}),e(g,{cols:"12",sm:"6"},{default:l(()=>[e(S,{modelValue:t.value,"onUpdate:modelValue":f[1]||(f[1]=U=>t.value=U),type:"date",label:"Date to attain minimum age by",variant:"outlined",onChange:v},null,8,["modelValue"])]),_:1})]),_:1}),e(A,null,{default:l(()=>[e(g,null,{default:l(()=>[e(oe,{modelValue:o.value,"onUpdate:modelValue":f[2]||(f[2]=U=>o.value=U),convention:V.convention,chips:!0,clearable:!0,variant:"outlined",label:`Tags applied to users under ${u.value} at time of data entry`,onChange:v},null,8,["modelValue","convention","label"])]),_:1})]),_:1})]),_:1}))}}),st=E("h4",null,"Values",-1),rt=E("h4",null,"Accommodation",-1),mt=E("h4",null,"Age",-1),vt=E("h4",null,"Additional Purchases",-1),ct=E("h4",null,"Available Interests",-1),pt=E("h4",null,"Tickets",-1),ft=E("h4",{class:"mb-3"},"Field Preview",-1),Vt=P({__name:"EditFieldDialog",props:O({convention:{},field:{},title:{}},{modelValue:{type:Boolean,required:!0}}),emits:O(["update:field"],["update:modelValue"]),setup(T,{emit:s}){const a=T,{convention:i,title:d=""}=a,n=M(T,"modelValue"),u=De(a,s,void 0,void 0,"field"),t=y(j(u.value)),o=y(""),v=y(t.value.Type);H(u,()=>{t.value=j(u.value)});const m=()=>{n.value=!1},r=()=>{t.value=j(u.value)},p=()=>{u.value=t.value},V=()=>{t.value.Values.push({ID:0,FieldValueUUID:q(),FieldID:t.value.ID,FieldUUID:t.value.FieldUUID,Title:"",Value:""})},f=D=>{t.value.Values.splice(D,1)},U=()=>{o.value="",t.value.Values=[]};return H(v,(D,_)=>{D!==_&&(t.value.Type=D,U())}),(D,_)=>(c(),C(Oe,{modelValue:n.value,"onUpdate:modelValue":_[13]||(_[13]=h=>n.value=h),onReset:r,onSave:p,title:I(d),color:"primary"},{default:l(()=>[e(B,{class:"pa-0",fluid:!0},{default:l(()=>[e(A,null,{default:l(()=>[e(g,{cols:"12"},{default:l(()=>[e(B,{class:"pa-0",fluid:!0},{default:l(()=>[e(A,null,{default:l(()=>[e(g,{cols:"12",sm:"6",md:"4"},{default:l(()=>[e(S,{modelValue:t.value.Name,"onUpdate:modelValue":_[0]||(_[0]=h=>t.value.Name=h),label:"Internal name",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),e(g,{cols:"12",sm:"6",md:"4"},{default:l(()=>[e(S,{modelValue:t.value.Label,"onUpdate:modelValue":_[1]||(_[1]=h=>t.value.Label=h),label:"Label",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),e(g,{cols:"12",sm:"6",md:"4"},{default:l(()=>[e(S,{modelValue:t.value.Hint,"onUpdate:modelValue":_[2]||(_[2]=h=>t.value.Hint=h),label:"Hint",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),e(g,{cols:"12",sm:"6",md:"4"},{default:l(()=>[e(S,{modelValue:t.value.Placeholder,"onUpdate:modelValue":_[3]||(_[3]=h=>t.value.Placeholder=h),label:"Placeholder",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),e(g,{cols:"12",sm:"6",md:"4"},{default:l(()=>[e(se,{modelValue:v.value,"onUpdate:modelValue":_[4]||(_[4]=h=>v.value=h),label:"Type",variant:"outlined",items:I(xe),"hide-details":""},null,8,["modelValue","items"])]),_:1}),t.value.Type===I(J).SELECT||t.value.Type===I(J).CHECKBOX?(c(),C(g,{key:0,cols:"12",sm:"6",md:"4",class:"py-0"},{default:l(()=>[e(W,{modelValue:t.value.Multiple,"onUpdate:modelValue":_[5]||(_[5]=h=>t.value.Multiple=h),label:"Multiple Items",hint:"Can select multiple items from list","hide-details":"",density:"compact"},null,8,["modelValue"]),t.value.Type===I(J).SELECT?(c(),C(W,{key:0,modelValue:t.value.Autofill,"onUpdate:modelValue":_[6]||(_[6]=h=>t.value.Autofill=h),label:"Searchable List","hide-details":"",density:"compact"},null,8,["modelValue"])):F("",!0)]),_:1})):F("",!0)]),_:1}),t.value.Type===I(J).SELECT||t.value.Type===I(J).CHECKBOX&&t.value.Multiple||t.value.Type===I(J).RADIO?(c(),C(A,{key:0},{default:l(()=>[e(g,null,{default:l(()=>[st,e(B,{fluid:!0,class:"px-0"},{default:l(()=>[(c(!0),k($,null,K(t.value.Values,(h,w)=>(c(),C(A,{key:h.ID},{default:l(()=>[e(g,{cols:"12",sm:"5",md:"6"},{default:l(()=>[e(S,{modelValue:h.Title,"onUpdate:modelValue":Y=>h.Title=Y,label:"Display",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(g,{cols:"9",sm:"5",md:"5"},{default:l(()=>[e(S,{modelValue:h.Value,"onUpdate:modelValue":Y=>h.Value=Y,label:"Internal Value",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(g,{cols:"3",sm:"2",md:"1",class:"d-flex align-center"},{default:l(()=>[e(N,{icon:"mdi:mdi-window-close",size:"small",color:"red",onClick:Y=>f(w)},null,8,["onClick"])]),_:2},1024)]),_:2},1024))),128)),e(A,null,{default:l(()=>[e(g,null,{default:l(()=>[e(N,{"prepend-icon":"mdi:mdi-plus",color:"primary",onClick:V},{default:l(()=>[b("Add Item")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})):t.value.Type===I(J).ACCOMMODATION?(c(),C(A,{key:1},{default:l(()=>[e(g,null,{default:l(()=>[rt,e(it,{modelValue:t.value,"onUpdate:modelValue":_[7]||(_[7]=h=>t.value=h)},null,8,["modelValue"])]),_:1})]),_:1})):t.value.Type===I(J).AGE?(c(),C(A,{key:2},{default:l(()=>[e(g,null,{default:l(()=>[mt,e(dt,{modelValue:t.value,"onUpdate:modelValue":_[8]||(_[8]=h=>t.value=h),convention:I(i)},null,8,["modelValue","convention"])]),_:1})]),_:1})):t.value.Type===I(J).EXTRAS?(c(),C(A,{key:3},{default:l(()=>[e(g,null,{default:l(()=>[vt,e(tt,{modelValue:t.value,"onUpdate:modelValue":_[9]||(_[9]=h=>t.value=h)},null,8,["modelValue"])]),_:1})]),_:1})):t.value.Type===I(J).INTERESTS?(c(),C(A,{key:4},{default:l(()=>[e(g,null,{default:l(()=>[ct,e(at,{modelValue:t.value,"onUpdate:modelValue":_[10]||(_[10]=h=>t.value=h)},null,8,["modelValue"])]),_:1})]),_:1})):t.value.Type===I(J).TICKET?(c(),C(A,{key:5},{default:l(()=>[e(g,null,{default:l(()=>[pt,e(ot,{modelValue:t.value,"onUpdate:modelValue":_[11]||(_[11]=h=>t.value=h)},null,8,["modelValue"])]),_:1})]),_:1})):F("",!0)]),_:1})]),_:1}),e(g,{cols:"12"},{default:l(()=>[e(ae,{elevation:"5",class:"pa-2",color:"text-center"},{default:l(()=>[ft,e(we,{admin:!0,field:t.value,convention:I(i),modelValue:o.value,"onUpdate:modelValue":_[12]||(_[12]=h=>o.value=h)},null,8,["field","convention","modelValue"])]),_:1})]),_:1})]),_:1})]),_:1})]),actions:l(()=>[e(N,{color:"blue-darken-1",variant:"text",onClick:m},{default:l(()=>[b(" Cancel ")]),_:1}),e(N,{color:"blue-darken-1",variant:"text",onClick:r},{default:l(()=>[b(" Reset ")]),_:1}),e(ee),e(N,{color:"blue-darken-1",variant:"text",onClick:p},{default:l(()=>[b(" Save ")]),_:1})]),_:1},8,["modelValue","title"]))}}),Ut=P({__name:"FieldEditor",props:{modelValue:{required:!0}},emits:O(["refresh"],["update:modelValue"]),setup(T){const s=M(T,"modelValue"),a=G(),i=y(!1),d=y(!1),n=y([{key:"Label",title:"Label",align:"start",sortable:!0},{key:"Name",title:"Internal Name",align:"start",sortable:!0},{key:"Type",title:"Type",align:"start",sortable:!0},{key:"actions",title:"Actions",sortable:!1}]),u=y([]);a.getConventionFields(s.value.ConventionUUID).then(w=>{w&&(u.value=w)});const t=y(-1),o=y({ID:0,FieldUUID:q(),ConventionID:s.value.ID,ConventionUUID:s.value.ConventionUUID,Autofill:!1,Hint:"",Label:"",Multiple:!1,Name:"",Placeholder:"",Type:"TEXT",Values:[],Data:""}),v=X(()=>t.value===-1?"New Field":"Edit Field"),m=()=>({ID:0,FieldUUID:q(),ConventionID:s.value.ID,ConventionUUID:s.value.ConventionUUID,Autofill:!1,Hint:"",Label:"",Multiple:!1,Name:"",Placeholder:"",Type:"TEXT",Values:[],Data:""}),r=y(m()),p=()=>{r.value.FieldUUID=q(),o.value=Object.assign({},m()),t.value=-1,i.value=!0},V=w=>{t.value=u.value.indexOf(w),o.value=Object.assign({},w),i.value=!0},f=w=>{t.value=u.value.indexOf(w),o.value=Object.assign({},w),d.value=!0},U=()=>{a.deleteField(o.value.FieldUUID).then(w=>{w&&(u.value.splice(t.value,1),_())})},D=()=>{i.value=!1,_e(()=>{o.value=Object.assign({},r.value),t.value=-1})},_=()=>{d.value=!1,_e(()=>{o.value=Object.assign({},r.value),t.value=-1})},h=()=>{a.saveField(o.value).then(w=>{w&&(t.value>-1?Object.assign(u.value[t.value],w):u.value.push(w),D())})};return(w,Y)=>(c(),C(I(Le),{headers:n.value,items:u.value,"sort-by":[{key:"calories",order:"asc"}],class:"elevation-1"},{top:l(()=>[e(ne,{color:"primary"},{default:l(()=>[e(ue,null,{default:l(()=>[b("Field Editor")]),_:1}),e(Fe,{class:"mx-4",inset:!0,vertical:!0}),e(ee),e(N,{dark:"",class:"mb-2","prepend-icon":"mdi:mdi-pencil",onClick:p},{default:l(()=>[b(" New Item ")]),_:1}),e(Ge,{modelValue:d.value,"onUpdate:modelValue":Y[0]||(Y[0]=Q=>d.value=Q),onDelete:U},null,8,["modelValue"])]),_:1}),i.value?(c(),C(Vt,{key:0,modelValue:i.value,"onUpdate:modelValue":Y[1]||(Y[1]=Q=>i.value=Q),field:o.value,"onUpdate:field":[Y[2]||(Y[2]=Q=>o.value=Q),h],title:v.value,convention:s.value},null,8,["modelValue","field","title","convention"])):F("",!0)]),"item.actions":l(({item:Q})=>[e(z,{size:"small",class:"me-2",onClick:je=>V(Q.raw)},{default:l(()=>[b(" mdi:mdi-pencil ")]),_:2},1032,["onClick"]),e(z,{size:"small",onClick:je=>f(Q.raw)},{default:l(()=>[b(" mdi:mdi-delete ")]),_:2},1032,["onClick"])]),_:1},8,["headers","items"]))}}),Tt=(T,s)=>{const a=De(T,s),i=De(T,s,void 0,void 0,"item"),d=y(j(i.value));return H(i,()=>{d.value=j(i.value)}),{state:a,model:i,close:()=>{a.value=!1},reset:()=>{i.value=j(d.value)},save:()=>{s("save")}}},Dt=P({__name:"EditItemDialog",props:{item:{},modelValue:{type:Boolean},title:{},cardClass:{}},emits:["update:modelValue","update:item","save"],setup(T,{emit:s}){const a=T,{state:i,model:d,close:n,reset:u,save:t}=Tt(a,s);return(o,v)=>(c(),C(Oe,{modelValue:I(i),"onUpdate:modelValue":v[0]||(v[0]=m=>ye(i)?i.value=m:null),onReset:I(u),onSave:I(t),title:o.title,color:"primary","card-class":o.cardClass},{toolbarButtons:l(()=>[Ee(o.$slots,"toolbarButtons")]),actions:l(()=>[e(N,{color:"blue-darken-1",variant:"text",onClick:I(n)},{default:l(()=>[b(" Cancel ")]),_:1},8,["onClick"]),e(N,{color:"blue-darken-1",variant:"text",onClick:I(u)},{default:l(()=>[b(" Reset ")]),_:1},8,["onClick"]),e(ee),e(N,{color:"blue-darken-1",variant:"text",onClick:I(t)},{default:l(()=>[b(" Save ")]),_:1},8,["onClick"])]),default:l(()=>[Ee(o.$slots,"default")]),_:3},8,["modelValue","onReset","onSave","title","card-class"]))}}),It={class:"pa-0 border-0 ma-0"},gt=E("legend",{class:"mb-2"},"Field Settings",-1),yt={class:"pa-0 border-0 ma-0"},_t=E("legend",{class:"text-blue-accent-2 mb-2"},"Field Preview",-1),Ct=P({__name:"EditFormField",props:O({convention:{}},{modelValue:{required:!0}}),emits:["update:modelValue"],setup(T){const s=M(T,"modelValue"),a=G(),i=y([]),d=y([]),n=y(""),u=t=>{var o;s.value.Field=(o=d.value.find(v=>v.value===t))==null?void 0:o.field};return a.getConventionFields(T.convention.ConventionUUID).then(t=>{t&&(i.value=t,d.value=t.map(o=>({title:`${o.Label} (${(xe.find(v=>v.value===o.Type)||{title:""}).title})`,value:o.FieldUUID,field:o})),u(s.value.FieldUUID))}),(t,o)=>(c(),C(A,null,{default:l(()=>[e(g,{cols:"12",md:"6"},{default:l(()=>[E("fieldset",It,[gt,e(A,null,{default:l(()=>[e(g,{cols:"12"},{default:l(()=>[e(se,{modelValue:s.value.FieldUUID,"onUpdate:modelValue":[o[0]||(o[0]=v=>s.value.FieldUUID=v),u],items:d.value,"item-title":"title","item-value":"value",label:"Field",variant:"outlined","hide-details":""},null,8,["modelValue","items"])]),_:1}),e(g,{cols:"6",sm:"4"},{default:l(()=>[e(S,{modelValue:s.value.MinLength,"onUpdate:modelValue":o[1]||(o[1]=v=>s.value.MinLength=v),modelModifiers:{number:!0},label:"Min Length",type:"number",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),e(g,{cols:"6",sm:"4"},{default:l(()=>[e(S,{modelValue:s.value.MaxLength,"onUpdate:modelValue":o[2]||(o[2]=v=>s.value.MaxLength=v),modelModifiers:{number:!0},label:"Max Length",type:"number",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),e(g,{cols:"12",sm:"4"},{default:l(()=>[e(W,{modelValue:s.value.Required,"onUpdate:modelValue":o[3]||(o[3]=v=>s.value.Required=v),modelModifiers:{boolean:!0},label:"Required","hide-details":""},null,8,["modelValue"])]),_:1})]),_:1})])]),_:1}),s.value.FieldUUID&&s.value.Field?(c(),C(g,{key:0,cols:"12",md:"6"},{default:l(()=>[E("fieldset",yt,[_t,s.value.Field?(c(),C(we,{key:0,admin:!0,field:s.value.Field,"persistent-hint":!0,required:s.value.Required,convention:t.convention,modelValue:n.value,"onUpdate:modelValue":o[4]||(o[4]=v=>n.value=v)},null,8,["field","required","convention","modelValue"])):F("",!0)])]),_:1})):F("",!0)]),_:1}))}}),bt={class:"d-none d-sm-block"},ht=P({__name:"EditFormSectionFields",props:O({convention:{}},{modelValue:{required:!0}}),emits:["update:modelValue"],setup(T){const s=M(T,"modelValue"),a=()=>{var i;return{ID:0,SectionFieldUUID:q(),SectionID:s.value.ID,SectionUUID:s.value.SectionUUID,FieldID:0,FieldUUID:"",Order:(((i=s.value.Fields)==null?void 0:i.length)||0)+1,MinLength:0,MaxLength:0,Required:!1,Value:""}};return(i,d)=>s.value.Fields!==void 0?(c(),C(Ke,{key:0,modelValue:s.value.Fields,"onUpdate:modelValue":d[0]||(d[0]=n=>s.value.Fields=n),closeable:!1,title:"Fields","new-item":a,class:"mt-4",label:"name","label-parent":"Field","slot-name-prefix":"field"},Re({_:2},[K(s.value.Fields,(n,u)=>({name:`field_${u}_title`,fn:l(()=>[n.Field?(c(),k($,{key:0},[b(R(n.Field.Label)+" ("+R(n.Field.Name)+") ",1),E("template",bt,[b("  ["+R(n.Field.Type)+"] ",1)])],64)):(c(),k($,{key:1},[b("New Field")],64))])})),K(s.value.Fields,(n,u)=>({name:`field_${u}`,fn:l(()=>[e(Ct,{modelValue:s.value.Fields[u],"onUpdate:modelValue":t=>s.value.Fields[u]=t,convention:i.convention,style:{margin:"0 -24px"}},null,8,["modelValue","onUpdate:modelValue","convention"])])}))]),1032,["modelValue"])):F("",!0)}}),kt=P({__name:"EditFormSections",props:O({convention:{}},{modelValue:{required:!0}}),emits:["update:modelValue"],setup(T){const s=M(T,"modelValue"),a=()=>{const i={ID:0,SectionUUID:q(),FormID:s.value.ID,FormUUID:s.value.FormUUID,Order:0,Name:"New Section",Heading:"",Description:"",Fields:[],DefaultValue:"",State:{ID:0,SectionStateUUID:q(),SectionID:0,SectionUUID:"",Edit:!0}};return i.State.SectionID=i.ID,i.State.SectionUUID=i.SectionUUID,i};return(i,d)=>(c(),C(Ke,{modelValue:s.value.Sections,"onUpdate:modelValue":d[0]||(d[0]=n=>s.value.Sections=n),"new-item":a,closeable:!1,title:"Sections","slot-name-prefix":"section"},Re({_:2},[K(s.value.Sections,(n,u)=>({name:`section_${u}`,fn:l(()=>[e(A,null,{default:l(()=>[e(g,{cols:"12",sm:"6"},{default:l(()=>[e(S,{modelValue:n.Name,"onUpdate:modelValue":t=>n.Name=t,label:"Internal Name",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(g,{cols:"12",sm:"6"},{default:l(()=>[e(S,{modelValue:n.Heading,"onUpdate:modelValue":t=>n.Heading=t,label:"Section Heading",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024),e(A,null,{default:l(()=>[e(g,{cols:"12"},{default:l(()=>[e(Ie,{modelValue:n.Description,"onUpdate:modelValue":t=>n.Description=t,label:"Section Text",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024),n.Fields?(c(),C(ht,{key:0,modelValue:s.value.Sections[u],"onUpdate:modelValue":t=>s.value.Sections[u]=t,convention:i.convention},null,8,["modelValue","onUpdate:modelValue","convention"])):F("",!0)])}))]),1032,["modelValue"]))}}),Et=P({__name:"FormRendererPopup",props:O({admin:{type:Boolean},convention:{},form:{},title:{},cardClass:{},preview:{type:Boolean}},{modelValue:{type:Boolean,required:!0}}),emits:O(["update:form"],["update:modelValue"]),setup(T,{emit:s}){const a=T,{admin:i=!1,convention:d,title:n="",cardClass:u=""}=a,t=M(T,"modelValue"),o=De(a,s,void 0,void 0,"form"),v=y(j(o.value));H(o,()=>{v.value=j(o.value)});const m=()=>{t.value=!1};return(r,p)=>(c(),C(Oe,{modelValue:t.value,"onUpdate:modelValue":p[1]||(p[1]=V=>t.value=V),title:I(n),color:"primary","card-class":I(u)},{toolbarButtons:l(()=>[Ee(r.$slots,"toolbarButtons")]),actions:l(()=>[e(N,{color:"blue-darken-1",variant:"text",onClick:m},{default:l(()=>[b(" Close ")]),_:1})]),default:l(()=>[e(Je,{modelValue:v.value,"onUpdate:modelValue":p[0]||(p[0]=V=>v.value=V),admin:I(i),convention:I(d),preview:r.preview},null,8,["modelValue","admin","convention","preview"])]),_:3},8,["modelValue","title","card-class"]))}}),$t=E("template",{class:"d-none d-sm-inline"},[b("Preview")],-1),Nt=P({__name:"EditFormDialog",props:O({convention:{},form:{}},{modelValue:{type:Boolean,required:!0}}),emits:O(["update:form"],["update:modelValue"]),setup(T,{emit:s}){const a=T,{convention:i}=a,d=M(T,"modelValue"),n=G(),u=De(a,s,void 0,void 0,"form"),t=y(!1),o=y(j(u.value));H(u,()=>{o.value=j(u.value)});const v=()=>{n.saveForm(o.value).then(r=>{r&&(u.value=r,d.value=!1)})},m=()=>{t.value=!0};return(r,p)=>(c(),C(Dt,{modelValue:d.value,"onUpdate:modelValue":p[12]||(p[12]=V=>d.value=V),item:o.value,"onUpdate:item":p[13]||(p[13]=V=>o.value=V),onSave:v,"card-class":"pa-0"},{toolbarButtons:l(()=>[e(Xe,null,{default:l(()=>[e(N,{"prepend-icon":"mdi:mdi-developer-board",onClick:m},{default:l(()=>[$t]),_:1})]),_:1})]),default:l(()=>[e(fe,null,{default:l(()=>[e(Ve,{class:"mt-0"},{default:l(()=>[e(Ue,null,{default:l(()=>[b("General Settings")]),_:1}),e(Te,null,{default:l(()=>[e(A,null,{default:l(()=>[e(g,{cols:"12"},{default:l(()=>[e(B,{class:"pa-0",fluid:!0},{default:l(()=>[e(A,null,{default:l(()=>[e(g,{cols:"12",sm:"6"},{default:l(()=>[e(S,{modelValue:o.value.Name,"onUpdate:modelValue":p[0]||(p[0]=V=>o.value.Name=V),label:"Internal name",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),e(g,{cols:"12",sm:"6"},{default:l(()=>[e(S,{modelValue:o.value.Heading,"onUpdate:modelValue":p[1]||(p[1]=V=>o.value.Heading=V),label:"Form Heading",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),e(g,{cols:"12"},{default:l(()=>[e(Ie,{modelValue:o.value.Description,"onUpdate:modelValue":p[2]||(p[2]=V=>o.value.Description=V),label:"Pre-form Text",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),e(g,{cols:"12",sm:"6"},{default:l(()=>[e(se,{modelValue:o.value.Type,"onUpdate:modelValue":p[3]||(p[3]=V=>o.value.Type=V),label:"Type",variant:"outlined",items:I(tl),"hide-details":""},null,8,["modelValue","items"])]),_:1}),e(g,{cols:"12",sm:"6"},{default:l(()=>[e(S,{modelValue:o.value.State.Stage,"onUpdate:modelValue":p[4]||(p[4]=V=>o.value.State.Stage=V),modelModifiers:{number:!0},label:"Stage",variant:"outlined","hide-details":"",type:"number"},null,8,["modelValue"])]),_:1}),e(g,{cols:"6"},{default:l(()=>[e(W,{modelValue:o.value.State.New,"onUpdate:modelValue":p[5]||(p[5]=V=>o.value.State.New=V),label:"Allow New Entries"},null,8,["modelValue"])]),_:1}),e(g,{cols:"6"},{default:l(()=>[e(W,{modelValue:o.value.State.Edit,"onUpdate:modelValue":p[6]||(p[6]=V=>o.value.State.Edit=V),label:"Allow Editing Submissions"},null,8,["modelValue"])]),_:1})]),_:1}),e(A,null,{default:l(()=>[e(g,{cols:"12"},{default:l(()=>[e(oe,{label:"Required Tags",variant:"outlined",modelValue:o.value.RequiredTags,"onUpdate:modelValue":p[7]||(p[7]=V=>o.value.RequiredTags=V),convention:I(i),organisation:I(i).OrganisationUUID,chips:"",clearable:"",hint:"Tags that a user must have to see this form. (Any one)"},null,8,["modelValue","convention","organisation"])]),_:1})]),_:1}),e(A,null,{default:l(()=>[e(g,{cols:"12"},{default:l(()=>[e(Ye,{label:"Required Groups",variant:"outlined",modelValue:o.value.RequiredGroupMemberships,"onUpdate:modelValue":p[8]||(p[8]=V=>o.value.RequiredGroupMemberships=V),convention:I(i),organisation:I(i).OrganisationUUID,chips:"",clearable:"",hint:"Groups that a user must be in to see this form. (Any one)"},null,8,["modelValue","convention","organisation"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),o.value?(c(),C(kt,{key:0,modelValue:o.value,"onUpdate:modelValue":p[9]||(p[9]=V=>o.value=V),convention:I(i),style:{"border-radius":"0"}},null,8,["modelValue","convention"])):F("",!0),t.value?(c(),C(Et,{key:1,modelValue:t.value,"onUpdate:modelValue":p[10]||(p[10]=V=>t.value=V),form:o.value,"onUpdate:form":p[11]||(p[11]=V=>o.value=V),admin:!0,convention:I(i),title:"Form Preview",preview:!0,"card-class":"pa-0"},null,8,["modelValue","form","convention"])):F("",!0)]),_:1},8,["modelValue","item"]))}}),At=(T,s)=>{const a=y(!1),i=y(!1),d=y(T),n=y(-1),u=y(s),t=y(s),o=X(()=>n.value===-1?"New Form":"Edit Form"),v=()=>{d.value=T},m=D=>{n.value=d.value.indexOf(D),u.value=Object.assign({},D),a.value=!0},r=D=>{n.value=d.value.indexOf(D),u.value=Object.assign({},D),i.value=!0},p=()=>{i.value=!1,_e(()=>{u.value=Object.assign({},t.value),n.value=-1}).then()},V=()=>{d.value.splice(n.value,1),p()},f=()=>{a.value=!1,_e(()=>{u.value=Object.assign({},t.value),n.value=-1}).then()},U=()=>{n.value>-1?Object.assign(d.value[n.value],u.value):d.value.push(u.value),f()};return H(a,D=>{D||f()}),H(i,D=>{D||p()}),{collection:d,defaultItem:t,dialog:a,dialogDelete:i,editedItem:u,formTitle:o,reset:v,editItem:m,deleteItem:r,deleteItemConfirm:V,close:f,save:U}},St=P({__name:"FormEditor",props:{modelValue:{required:!0}},emits:O(["refresh"],["update:modelValue"]),setup(T){const s=M(T,"modelValue"),a=G(),i=y([{key:"Name",title:"Form Name",align:"start",sortable:!0},{key:"Type",title:"Type",align:"start",sortable:!0},{key:"actions",title:"Actions",sortable:!1}]),d=y([]),n=y([]);a.getConventionFields(s.value.ConventionUUID).then(_=>{d.value=_}),a.getConventionForms(s.value.ConventionUUID).then(_=>{n.value=_});const u={ID:0,FormUUID:q(),ConventionID:s.value.ID,ConventionUUID:s.value.ConventionUUID,ParentID:0,ParentUUID:me,Name:"",Heading:"",Description:"",Type:al.FORM_TYPE_UNSPECIFIED,Sections:[],State:{ID:0,FormStateUUID:q(),FormID:0,FormUUID:me,New:!1,Edit:!1,Stage:0},RequiredGroupMemberships:[],RequiredTags:[]};u.State.FormUUID=u.FormUUID;const{collection:t,defaultItem:o,dialog:v,dialogDelete:m,editedItem:r,editItem:p,deleteItem:V,deleteItemConfirm:f,save:U}=At(n,u);t.value.forEach(_=>{_.Sections.forEach(h=>{var w;(w=h.Fields)==null||w.forEach(Y=>{Y.Field=d.value.find(Q=>Q.ID===Y.FieldID)})})});const D=_=>{a.deleteForm(_.FormUUID).then(h=>{h&&V(_)})};return(_,h)=>(c(),C(I(Le),{headers:i.value,items:I(t),"sort-by":[{key:"calories",order:"asc"}],class:"elevation-1"},{top:l(()=>[e(ne,{color:"primary"},{default:l(()=>[e(ue,null,{default:l(()=>[b("Form Editor")]),_:1}),e(Fe,{class:"mx-4",inset:!0,vertical:!0}),e(ee),e(N,{dark:"",class:"mb-2","prepend-icon":"mdi:mdi-pencil",onClick:h[0]||(h[0]=w=>{r.value=Object.assign({},I(o)),v.value=!0})},{default:l(()=>[b(" New Item ")]),_:1}),e(Ge,{modelValue:I(m),"onUpdate:modelValue":h[1]||(h[1]=w=>ye(m)?m.value=w:null),onDelete:I(f)},null,8,["modelValue","onDelete"])]),_:1}),I(v)?(c(),C(Nt,{key:0,modelValue:I(v),"onUpdate:modelValue":h[2]||(h[2]=w=>ye(v)?v.value=w:null),form:I(r),"onUpdate:form":[h[3]||(h[3]=w=>ye(r)?r.value=w:null),I(U)],convention:s.value},null,8,["modelValue","form","onUpdate:form","convention"])):F("",!0)]),"item.actions":l(({item:w})=>[e(z,{size:"small",class:"me-2",onClick:Y=>I(p)(w.raw)},{default:l(()=>[b(" mdi:mdi-pencil ")]),_:2},1032,["onClick"]),e(z,{size:"small",onClick:Y=>D(w.raw)},{default:l(()=>[b(" mdi:mdi-delete ")]),_:2},1032,["onClick"])]),_:1},8,["headers","items"]))}}),da=P({__name:"ConventionEditorView",emits:["pageTitle","refresh"],setup(T,{emit:s}){const a=Be(),i=G(),n=y({ID:0,ConventionUUID:me,Accommodation:[],Description:"",DetailLink:"",Extras:[],Interests:[],Logo:"",Name:"",OrganisationID:0,OrganisationUUID:"",Slug:"",Tickets:[],Visible:!1}),u=y();H(u,()=>{o.value.find(m=>m.id===u.value&&m.title==="General")&&t()});const t=()=>{i.getConvention(a.params.convention.toString()).then(v=>{v?(n.value=v,s("pageTitle",`Convention Editor - ${n.value.Name}`)):s("pageTitle","Convention Editor - New Convention")})},o=y([{id:q(),title:"Accommodation",component:ie(lt),model:n},{id:q(),title:"Additional Purchases",component:ie(ml),model:n},{id:q(),title:"Fields",component:ie(Ut),model:n},{id:q(),title:"Forms",component:ie(St),model:n},{id:q(),title:"Interests",component:ie(Vl),model:n},{id:q(),title:"Tickets",component:ie(Al),model:n},{id:q(),title:"Venues",component:ie(Gl),model:n}]);return s("pageTitle","Convention Editor"),t(),(v,m)=>n.value&&n.value.ConventionUUID!==I(me)?(c(),k($,{key:0},[e(ne,{color:"blue-darken-4"},{default:l(()=>[e(We,{modelValue:u.value,"onUpdate:modelValue":m[0]||(m[0]=r=>u.value=r),"show-arrows":""},{default:l(()=>[(c(!0),k($,null,K(o.value,r=>(c(),C(Qe,{key:r.id,value:r.id},{default:l(()=>[b(R(r.title),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(el,{modelValue:u.value,"onUpdate:modelValue":m[1]||(m[1]=r=>u.value=r)},{default:l(()=>[(c(!0),k($,null,K(o.value,r=>(c(),C(Ze,{key:r.id,value:r.id},{default:l(()=>[r.id===u.value?(c(),C(de,{key:0,class:"pa-2"},{default:l(()=>[(c(),C(ze(r.component),{modelValue:r.model,"onUpdate:modelValue":p=>r.model=p},null,8,["modelValue","onUpdate:modelValue"]))]),_:2},1024)):F("",!0)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])],64)):F("",!0)}});export{da as default};
