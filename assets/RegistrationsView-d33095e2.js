import{p as bt,n as Vt,e as ce,t as ge,c as Nt,G as Lt,v as t,H as N,x as je,I as le,a0 as Ee,a1 as Be,r as _,K as ve,M as i,N as H,O as o,a3 as fe,W as q,a2 as ze,a4 as Z,S as j,w as ne,X as M,Q as F,V as p,P as Y,_ as Ye,ab as kt,E as tt,k as Ft,f as Pt,d as wt,o as $t,ac as at,Y as ct,Z as vt,a6 as Gt,a5 as Bt}from"./index-17c623b1.js";import{e as Yt,T as Ht,d as xt,c as qt}from"./FormRenderer.vue_vue_type_style_index_0_lang-a715d03d.js";import{a as jt,F as Ue}from"./form-29fd1dbb.js";import{_ as He}from"./ModelDialog.vue_vue_type_script_setup_true_lang-307f62ab.js";import{m as Qt,k as Kt,l as zt,n as Wt,o as Jt,p as Xt,q as Zt,u as ea,r as ta,s as aa,t as oa,v as na,w as la,x as ia,y as sa,z as ot,A as nt,B as lt,a as ua,_ as ra,f as it,c as _t,d as At,e as Ut,b as Tt,V as Et,g as da,h as ma,i as ca,j as va}from"./VWindowItem-c96219f3.js";import{V as ee,a as P}from"./VRow-18338534.js";import{V as Te}from"./VTextField-f0d0c6d2.js";import{V as oe}from"./copyToClipboard-9ab4d71c.js";import{u as _a,j as Ce,V as Aa}from"./VContainer-9099cb1e.js";import{V as Ua,u as Je}from"./VCheckbox-92d93ddd.js";import{v as Me}from"./v4-a960c1f4.js";import{h as $e,b as Ta,a as Ea,c as fa,d as Sa,P as ft,u as St}from"./useDisplayTransactions-cc8abc5d.js";import{V as Ge,a as ke}from"./VList-34d9ed11.js";import{V as se}from"./VBtn-06380a53.js";import{b as pt,c as st}from"./submission-9dd916bb.js";import{V as pa}from"./VAvatar-727bf0b3.js";import{c as Da,e as Dt,V as Ra}from"./VCard-fa49a40e.js";import{V as Ia}from"./VDialog-31dc11e4.js";import{s as ya}from"./sortSubmissions-8ed80f07.js";import{V as Rt,a as ga}from"./scopeId-168e594e.js";import{_ as We}from"./SaveButton.vue_vue_type_script_setup_true_lang-effb62fa.js";import{u as Qe}from"./nil-d01db1aa.js";import{V as Oa}from"./VToolbar-49d6dafe.js";import{V as ut,a as Ca}from"./VTable-4c7ddb8b.js";import"./index-26b71cef.js";import"./VTextarea-ab97c11d.js";import"./forwardRefs-b48674ba.js";import"./VChip-9e23b941.js";import"./userData-0d70a8c3.js";import"./VForm-2ef89559.js";import"./VToolbarItems-1e63d0e2.js";import"./VDivider-a5db5c30.js";import"./createSimpleFunctional-f0fd6a7d.js";var It=(e=>(e.ADMIN_LAYOUT_PANELS="ADMIN_LAYOUT_PANELS",e.ADMIN_LAYOUT_TABLE="ADMIN_LAYOUT_TABLE",e))(It||{});const ha=[{title:"Panel Layout",value:"ADMIN_LAYOUT_PANELS"},{title:"Table Layout",value:"ADMIN_LAYOUT_TABLE"}];var Fe=(e=>(e.LAYOUT_ITEM_SOURCE_FORM="LAYOUT_ITEM_SOURCE_FORM",e.LAYOUT_ITEM_SOURCE_META="LAYOUT_ITEM_SOURCE_META",e.LAYOUT_ITEM_SOURCE_USER="LAYOUT_ITEM_SOURCE_USER",e))(Fe||{});const Ma=[{title:"Form Field Submission Data",value:"LAYOUT_ITEM_SOURCE_FORM"},{title:"Miscellaneous Data",value:"LAYOUT_ITEM_SOURCE_META"},{title:"User Profile Data",value:"LAYOUT_ITEM_SOURCE_USER"}];var Q=(e=>(e.META_DATA_SOURCE_ACCOMMODATION_ALLOCATION="META_DATA_SOURCE_ACCOMMODATION_ALLOCATION",e.META_DATA_SOURCE_ACCOMMODATION_FORM="META_DATA_SOURCE_ACCOMMODATION_FORM",e.META_DATA_SOURCE_BADGE_FORM="META_DATA_SOURCE_BADGE_FORM",e.META_DATA_SOURCE_DEALER_FORM="META_DATA_SOURCE_DEALER_FORM",e.META_DATA_SOURCE_PAYMENT_STATUS="META_DATA_SOURCE_PAYMENT_STATUS",e.META_DATA_SOURCE_REGISTRATION_ACTIONS="META_DATA_SOURCE_REGISTRATION_ACTIONS",e.META_DATA_SOURCE_REGISTRATION_FORM="META_DATA_SOURCE_REGISTRATION_FORM",e.META_DATA_SOURCE_REGISTRATION_GROUP="META_DATA_SOURCE_REGISTRATION_GROUP",e.META_DATA_SOURCE_REGISTRATION_REFERENCE="META_DATA_SOURCE_REGISTRATION_REFERENCE",e.META_DATA_SOURCE_SUBMISSION_DATE="META_DATA_SOURCE_SUBMISSION_DATE",e.META_DATA_SOURCE_SUBMISSION_STATUS="META_DATA_SOURCE_SUBMISSION_STATUS",e))(Q||{});const ba=[{title:"Accommodation Allocation",value:"META_DATA_SOURCE_ACCOMMODATION_ALLOCATION"},{title:"Accommodation Form",value:"META_DATA_SOURCE_ACCOMMODATION_FORM"},{title:"Actions",value:"META_DATA_SOURCE_REGISTRATION_ACTIONS"},{title:"Badge Form",value:"META_DATA_SOURCE_BADGE_FORM"},{title:"Dealer Form",value:"META_DATA_SOURCE_DEALER_FORM"},{title:"Payment Status",value:"META_DATA_SOURCE_PAYMENT_STATUS"},{title:"Registration Group",value:"META_DATA_SOURCE_REGISTRATION_GROUP"},{title:"Registration Reference",value:"META_DATA_SOURCE_REGISTRATION_REFERENCE"},{title:"Registration Form",value:"META_DATA_SOURCE_REGISTRATION_FORM"},{title:"Submission Date",value:"META_DATA_SOURCE_SUBMISSION_DATE"},{title:"Submission Status",value:"META_DATA_SOURCE_SUBMISSION_STATUS"}];var X=(e=>(e.USER_DATA_SOURCE_NULL="",e.USER_DATA_SOURCE_DISPLAY_NAME="USER_DATA_SOURCE_DISPLAY_NAME",e.USER_DATA_SOURCE_HANDLE="USER_DATA_SOURCE_HANDLE",e.USER_DATA_SOURCE_AVATAR="USER_DATA_SOURCE_AVATAR",e.USER_DATA_SOURCE_FIRST_NAME="USER_DATA_SOURCE_FIRST_NAME",e.USER_DATA_SOURCE_LAST_NAME="USER_DATA_SOURCE_LAST_NAME",e.USER_DATA_SOURCE_DATE_OF_BIRTH="USER_DATA_SOURCE_DATE_OF_BIRTH",e.USER_DATA_SOURCE_EMAIL="USER_DATA_SOURCE_EMAIL",e.USER_DATA_SOURCE_TELEGRAM="USER_DATA_SOURCE_TELEGRAM",e))(X||{});const Va=[{title:"Display Name",value:"USER_DATA_SOURCE_DISPLAY_NAME"},{title:"Handle",value:"USER_DATA_SOURCE_HANDLE"},{title:"Avatar",value:"USER_DATA_SOURCE_AVATAR"},{title:"First Name",value:"USER_DATA_SOURCE_FIRST_NAME"},{title:"Last Name",value:"USER_DATA_SOURCE_LAST_NAME"},{title:"Date of Birth",value:"USER_DATA_SOURCE_DATE_OF_BIRTH"},{title:"Email Address",value:"USER_DATA_SOURCE_EMAIL"},{title:"Telegram Username",value:"USER_DATA_SOURCE_TELEGRAM"}],Na=e=>{switch(e){case"EMAIL_STATUS_QUEUED":return"Queued";case"EMAIL_STATUS_SENDING":return"Sending";case"EMAIL_STATUS_SENT":return"Sent";case"EMAIL_STATUS_SEND_ERROR":return"Send Error"}return"Unknown"},La=bt({itemsLength:{type:[Number,String],required:!0},...Qt(),...Kt(),...zt()},"VDataTableServer"),ka=Vt()({name:"VDataTableServer",props:La(),emits:{"update:modelValue":e=>!0,"update:page":e=>!0,"update:itemsPerPage":e=>!0,"update:sortBy":e=>!0,"update:options":e=>!0,"update:expanded":e=>!0,"update:groupBy":e=>!0,"click:row":(e,E)=>!0},setup(e,E){let{emit:u,slots:n}=E;const{groupBy:l}=Wt(e),{sortBy:s,multiSort:T,mustSort:m}=Jt(e),{page:f,itemsPerPage:D}=Xt(e),S=ce(()=>parseInt(e.itemsLength,10)),{columns:a,headers:r}=Zt(e,{groupBy:l,showSelect:ge(e,"showSelect"),showExpand:ge(e,"showExpand")}),{items:A}=ea(e,a),{toggleSort:c}=ta({sortBy:s,multiSort:T,mustSort:m,page:f}),{opened:V,isGroupOpen:v,toggleGroup:O,extractRows:y}=aa({groupBy:l,sortBy:s}),{pageCount:G,setItemsPerPage:K}=oa({page:f,itemsPerPage:D,itemsLength:S}),{flatItems:ie}=na(A,l,V),{isSelected:Se,select:pe,selectAll:C,toggleSelect:h,someSelected:L,allSelected:I}=la(e,{allItems:A,currentPage:A}),{isExpanded:$,toggleExpand:W}=ia(e),te=ce(()=>y(A.value));sa({page:f,itemsPerPage:D,sortBy:s,groupBy:l,search:ge(e,"search")}),Nt("v-data-table",{toggleSort:c,sortBy:s}),Lt({VDataTableRows:{hideNoData:ge(e,"hideNoData"),noDataText:ge(e,"noDataText"),loading:ge(e,"loading"),loadingText:ge(e,"loadingText")}});const z=ce(()=>({page:f.value,itemsPerPage:D.value,sortBy:s.value,pageCount:G.value,toggleSort:c,setItemsPerPage:K,someSelected:L.value,allSelected:I.value,isSelected:Se,select:pe,selectAll:C,toggleSelect:h,isExpanded:$,toggleExpand:W,isGroupOpen:v,toggleGroup:O,items:te.value,groupedItems:ie.value,columns:a.value,headers:r.value}));_a(()=>{const[re]=ot.filterProps(e),[ue]=nt.filterProps(e),[De]=lt.filterProps(e),[Re]=ut.filterProps(e);return t(ut,je({class:["v-data-table",{"v-data-table--loading":e.loading},e.class],style:e.style},Re),{top:()=>{var Ie;return(Ie=n.top)==null?void 0:Ie.call(n,z.value)},default:()=>{var Ie,be,Ve,Pe;return n.default?n.default(z.value):t(N,null,[(Ie=n.colgroup)==null?void 0:Ie.call(n,z.value),t("thead",{class:"v-data-table__thead",role:"rowgroup"},[t(nt,je(ue,{sticky:e.fixedHeader}),n)]),(be=n.thead)==null?void 0:be.call(n,z.value),t("tbody",{class:"v-data-table__tbody",role:"rowgroup"},[n.body?n.body(z.value):t(lt,je(De,{items:ie.value}),n)]),(Ve=n.tbody)==null?void 0:Ve.call(n,z.value),(Pe=n.tfoot)==null?void 0:Pe.call(n,z.value)])},bottom:()=>n.bottom?n.bottom(z.value):t(ot,re,{prepend:n["footer.prepend"]})})})}}),Fa=le({__name:"EditAdminLayout",props:Ee({title:{default:""},layout:{}},{modelValue:{type:Boolean,required:!0}}),emits:Ee(["save"],["update:modelValue"]),setup(e,{emit:E}){const u=Be(e,"modelValue"),n=_(ve(e.layout)),l=_([]),s=fe(),T=({callback:S})=>{const a=()=>{S&&S("Failed to Save Layout")},r=()=>{S&&S("Layout Saved")};s.saveAdminLayout(n.value).then(A=>{A?(r(),E("save",A)):a()}).catch(()=>{a()})},m=()=>({ID:0,LayoutPanelUUID:Me(),AdminLayoutID:n.value.ID,AdminLayoutUUID:n.value.AdminLayoutUUID,Name:"",Order:n.value.Panels.length+1,Items:[],RequiredFormType:Ue.FORM_TYPE_NIL,RequiredGroupMemberships:[],RequiredRegistrationTags:[]}),f=S=>()=>({ID:0,LayoutItemUUID:Me(),LayoutPanelID:S.ID,LayoutPanelUUID:S.LayoutPanelUUID,Label:"",SourceType:Fe.LAYOUT_ITEM_SOURCE_FORM,SectionFieldID:void 0,SectionFieldUUID:void 0,SectionField:void 0,MetaField:void 0,UserField:void 0,Align:"",Order:S.Items.length+1,DefaultSort:!1}),D=S=>{const a=l.value.find(r=>r.value===S.SectionFieldUUID);a&&(S.SectionFieldID=a.object.ID,S.SectionField=a.object)};return s.getConventionForms(e.layout.ConventionUUID).then(S=>{S.forEach(a=>a.Sections.forEach(r=>r.Fields&&l.value.push(...r.Fields.map(A=>{var V;return{title:`${a.Name} - ${r.Name} - ${(V=A.Field)==null?void 0:V.Name}`,value:A.SectionFieldUUID,object:A}})))),l.value.sort(Yt("title"))}),(S,a)=>(i(),H(He,{modelValue:u.value,"onUpdate:modelValue":a[3]||(a[3]=r=>u.value=r),onSave:T,title:S.title,color:"primary"},{default:o(()=>[t(Ce,{class:"px-0 mx-0",fluid:!0},{default:o(()=>[t(ee,null,{default:o(()=>[t(P,{cols:"12",sm:"6"},{default:o(()=>[t(Te,{modelValue:n.value.Name,"onUpdate:modelValue":a[0]||(a[0]=r=>n.value.Name=r),label:"Name",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),t(P,{cols:"12",sm:"6"},{default:o(()=>[t(oe,{modelValue:n.value.Type,"onUpdate:modelValue":a[1]||(a[1]=r=>n.value.Type=r),label:"Layout Type",items:q(ha),"item-title":"title","item-value":"value",variant:"outlined","hide-details":""},null,8,["modelValue","items"])]),_:1})]),_:1})]),_:1}),t(it,{modelValue:n.value.Panels,"onUpdate:modelValue":a[2]||(a[2]=r=>n.value.Panels=r),"new-item":m,closeable:!1,title:"Panels",label:"Name","slot-name-prefix":"panel"},ze({_:2},[Z(n.value.Panels,(r,A)=>({name:`panel_${A}`,fn:o(()=>[t(Ce,{class:"px-0 mx-0",fluid:!0},{default:o(()=>[t(ee,null,{default:o(()=>[t(P,{cols:"12",sm:"6"},{default:o(()=>[t(Te,{modelValue:r.Name,"onUpdate:modelValue":c=>r.Name=c,label:"Name",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),t(P,{cols:"12",sm:"6"},{default:o(()=>[t(oe,{modelValue:r.RequiredFormType,"onUpdate:modelValue":c=>r.RequiredFormType=c,items:q(jt),clearable:!0,label:"Required Form",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"])]),_:2},1024)]),_:2},1024),t(ee,null,{default:o(()=>[t(P,{cols:"12",sm:"6"},{default:o(()=>[t(ua,{label:"Required Groups",variant:"outlined",modelValue:r.RequiredGroupMemberships,"onUpdate:modelValue":c=>r.RequiredGroupMemberships=c,convention:n.value.ConventionUUID,chips:"",clearable:"",hint:"Groups that a user must be in to see this form. (Any one)"},null,8,["modelValue","onUpdate:modelValue","convention"])]),_:2},1024),t(P,{cols:"12",sm:"6"},{default:o(()=>[t(ra,{label:"Registration Tags",variant:"outlined",modelValue:r.RequiredRegistrationTags,"onUpdate:modelValue":c=>r.RequiredRegistrationTags=c,convention:n.value.ConventionUUID,chips:"",clearable:"",hint:"Tags that a registration must have to appear in results. (Any one)"},null,8,["modelValue","onUpdate:modelValue","convention"])]),_:2},1024)]),_:2},1024)]),_:2},1024),t(it,{modelValue:r.Items,"onUpdate:modelValue":c=>r.Items=c,"new-item":f(r),closeable:!1,title:"Items",label:"Label","slot-name-prefix":"item"},ze({_:2},[Z(r.Items,(c,V)=>({name:`item_${V}`,fn:o(()=>[t(Ce,{class:"px-0 mx-0",fluid:!0},{default:o(()=>[t(ee,null,{default:o(()=>[t(P,{cols:"12",sm:"6"},{default:o(()=>[t(Te,{modelValue:c.Label,"onUpdate:modelValue":v=>c.Label=v,label:"Name",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024),t(ee,null,{default:o(()=>[t(P,{cols:"12",sm:"6"},{default:o(()=>[t(oe,{modelValue:c.SourceType,"onUpdate:modelValue":v=>c.SourceType=v,label:"Source Type",items:q(Ma),"item-title":"title","item-value":"value",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"])]),_:2},1024),t(P,{cols:"12",sm:"6"},{default:o(()=>[c.SourceType==="LAYOUT_ITEM_SOURCE_FORM"?(i(),H(oe,{key:0,modelValue:c.SectionFieldUUID,"onUpdate:modelValue":v=>c.SectionFieldUUID=v,label:"Form Data",items:l.value,"item-title":"title","item-value":"value",variant:"outlined","hide-details":"",onBlur:v=>D(c)},null,8,["modelValue","onUpdate:modelValue","items","onBlur"])):c.SourceType==="LAYOUT_ITEM_SOURCE_META"?(i(),H(oe,{key:1,modelValue:c.MetaField,"onUpdate:modelValue":v=>c.MetaField=v,label:"Miscellaneous Data",items:q(ba),"item-title":"title","item-value":"value",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"])):c.SourceType==="LAYOUT_ITEM_SOURCE_USER"?(i(),H(oe,{key:2,modelValue:c.UserField,"onUpdate:modelValue":v=>c.UserField=v,label:"User Profile Data",items:q(Va),"item-title":"title","item-value":"value",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"])):j("",!0)]),_:2},1024)]),_:2},1024),t(ee,null,{default:o(()=>[t(P,null,{default:o(()=>[t(Ua,{modelValue:c.DefaultSort,"onUpdate:modelValue":v=>c.DefaultSort=v,label:"Default Sort","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)]),_:2},1024)])}))]),1032,["modelValue","onUpdate:modelValue","new-item"])])}))]),1032,["modelValue"])]),_:1},8,["modelValue","title"]))}}),Pa=M("br",null,null,-1),wa=M("h3",null,"Assigned Accommodation",-1),$a=M("br",null,null,-1),Ga=M("br",null,null,-1),Ba=M("h3",null,"Accommodation Preferences",-1),Ya=M("h3",null,"Selected Tickets",-1),Ha=M("br",null,null,-1),xa=le({__name:"EditAccommodationAssignmentDialog",props:Ee({convention:{},registration:{},selectedAccommodation:{},title:{}},{modelValue:{type:Boolean,required:!0}}),emits:Ee(["update:field"],["update:modelValue"]),setup(e,{emit:E}){const u=e,{convention:n,registration:l,title:s=""}=u,T=fe(),m=Be(e,"modelValue"),f=_({capacity:{max:C=>{var I;const h=G.value.find($=>$.room.RoomUUID===C);return!h||h.room.MaximumCapacity===0?!0:(((I=r.value)==null?void 0:I.Members.length)||0)<=h.room.MaximumCapacity||"Too many people in the group for this room"},min:C=>{var I;const h=G.value.find($=>$.room.RoomUUID===C);return!h||h.room.MinimumCapacity===0?!0:(((I=r.value)==null?void 0:I.Members.length)||0)>=h.room.MinimumCapacity||"Not enough people in the group for this room"}}}),D=_([]),S=Je(u,E,void 0,void 0,"field"),a=_(ve(S.value));ne(S,()=>{a.value=ve(S.value)});const r=_(),A=_(""),c=_(""),V=_([]),v=_({Ticket:[],AddonsChecked:[],ComponentsChecked:[]}),O=async()=>{var I;const C=await T.getConventionAvailableAccommodation(n.ConventionUUID);C&&(D.value=C);const h=await T.getRegistrationGroup(l.RegistrationUUID||"");h&&(r.value=h);const L=await T.getConventionTickets(n.ConventionUUID);L&&(V.value=L);try{v.value=JSON.parse(((I=r.value)==null?void 0:I.TicketData)||"")}catch{}};ne(A,()=>{c.value=G.value.length>0?G.value[0].value:""});const y=ce(()=>{const C=K.value;return D.value.map(h=>{let L;return C.forEach(I=>{h.Costs.forEach($=>{$.DateStart===(I==null?void 0:I.DateStart)&&$.DateEnd===I.DateEnd&&(L===void 0||L>$.Availability)&&(L=$.Availability)})}),{label:`${h.Name}`,title:`${h.Name} (${L} Available)`,value:h.AccommodationUUID}})}),G=ce(()=>{const C=K.value,h=D.value.find(L=>L.AccommodationUUID===A.value);return(h==null?void 0:h.Pool.map(L=>{var $,W;let I;return C.forEach(te=>{L.Costs.forEach(z=>{z.DateStart===(te==null?void 0:te.DateStart)&&z.DateEnd===te.DateEnd&&(I===void 0||I>z.Availability)&&(I=z.Availability)})}),{label:`${($=L.Venue)==null?void 0:$.Name} - ${L.Name}`,title:`${(W=L.Venue)==null?void 0:W.Name} - ${L.Name} (${I} Available)`,value:L.RoomUUID,room:L}}))||[]}),K=ce(()=>[...v.value.Ticket,...v.value.AddonsChecked,...v.value.ComponentsChecked].map(C=>V.value.find(h=>h.TicketUUID===C)).filter(C=>C!==void 0&&C.RequiresAccommodation)),ie=C=>{var h;T.assignAccommodation(((h=r.value)==null?void 0:h.Registration.RegistrationUUID)||"",A.value,c.value,!1).then(L=>{L?(O(),C&&C("Room Assigned")):C&&C("Room not assigned")}).catch(()=>{C&&C("Room not assigned")})},Se=C=>{var h,L;(h=r.value)!=null&&h.Registration.AllocationUUID?T.deleteAllocation(((L=r.value)==null?void 0:L.Registration.AllocationUUID)||"").then(I=>{I?(O(),C&&C("Allocation Deleted")):C&&C("Allocation not deleted")}).catch(()=>{C&&C("Allocation not deleted")}):C&&C("Nothing to Delete")},pe=C=>{var L,I;const h=(L=D.value.find($=>$.AccommodationUUID===C.AccommodationUUID))==null?void 0:L.Pool;if(h){const $=h.find(W=>W.RoomUUID===C.RoomUUID);if($)return`${(I=$.Venue)==null?void 0:I.Name} - ${$.Name}`}return""};return O(),(C,h)=>{var L;return i(),H(He,{modelValue:m.value,"onUpdate:modelValue":h[2]||(h[2]=I=>m.value=I),title:q(s),color:"primary","show-close-action":!0,"show-delete-action":!!((L=r.value)!=null&&L.Registration.Allocation),"show-save-action":!!c.value,"save-button-label":"Assign Room",onDelete:Se,onSave:ie},{default:o(()=>[t(Ce,{class:"pa-0",fluid:!0},{default:o(()=>[t(ee,null,{default:o(()=>{var I;return[t(P,{cols:"12",md:"6"},{default:o(()=>{var $,W;return[M("h3",null,"Group Members ("+F(($=r.value)==null?void 0:$.Members.length)+")",1),(i(!0),p(N,null,Z((W=r.value)==null?void 0:W.Members,te=>(i(),p(N,{key:te.UUID},[Y(" #"+F(te.Reference)+" "+F(te.Name),1),Pa],64))),128))]}),_:1}),(I=r.value)!=null&&I.Registration.Allocation?(i(),H(P,{key:0,cols:"12",md:"6"},{default:o(()=>[wa,t(Ge,null,{default:o(()=>{var $;return[(i(!0),p(N,null,Z(($=r.value)==null?void 0:$.Registration.Allocation.Periods,W=>(i(),H(ke,{key:W.AllocationPeriodUUID},{default:o(()=>{var te;return[Y(F((te=D.value.find(z=>z.AccommodationUUID===W.AccommodationUUID))==null?void 0:te.Name)+" ",1),$a,Y(" "+F(pe(W))+" ",1),Ga,M("small",null,"("+F(q($e)(W.DateStart))+" - "+F(q($e)(W.DateEnd))+")",1)]}),_:2},1024))),128))]}),_:1})]),_:1})):j("",!0)]}),_:1}),t(ee,null,{default:o(()=>[t(P,{cols:"12",md:"6"},{default:o(()=>[C.selectedAccommodation.length?(i(),p(N,{key:0},[Ba,t(Ge,null,{default:o(()=>[(i(!0),p(N,null,Z(C.selectedAccommodation,(I,$)=>(i(),H(ke,{key:I.AccommodationUUID},{default:o(()=>[Y(F($+1)+". "+F(I.Name),1)]),_:2},1024))),128))]),_:1})],64)):j("",!0)]),_:1}),t(P,{cosl:"12",md:"6"},{default:o(()=>[Ya,t(Ge,null,{default:o(()=>[(i(!0),p(N,null,Z(K.value,I=>(i(),H(ke,{key:I==null?void 0:I.TicketUUID},{default:o(()=>[Y(F(I.Name)+" ",1),Ha,M("small",null,"("+F(q($e)(I.DateStart))+" - "+F(q($e)(I.DateEnd))+")",1)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1}),t(ee,null,{default:o(()=>[t(P,{cols:"12",md:"6"},{default:o(()=>[t(oe,{modelValue:A.value,"onUpdate:modelValue":h[0]||(h[0]=I=>A.value=I),items:y.value,"item-title":"title","item-value":"value",label:"Accommodation"},null,8,["modelValue","items"])]),_:1}),t(P,{cols:"12",md:"6"},{default:o(()=>[t(oe,{modelValue:c.value,"onUpdate:modelValue":h[1]||(h[1]=I=>c.value=I),items:G.value,"item-title":"title","item-value":"value",label:"Room Pool",rules:[f.value.capacity.min,f.value.capacity.max]},null,8,["modelValue","items","rules"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue","title","show-delete-action","show-save-action"])}}}),qa={key:0,class:"accommodationList"},ja={key:0,class:"text-orange-darken-2"},Qa=le({__name:"DataTableItemAccommodation",props:{accommodations:{default:()=>[]},convention:{},registration:{},value:{default:""},venues:{}},setup(e){const E=_(!1),u=ce(()=>{if(!e.value)return[];const n=JSON.parse(e.value),l=e.accommodations.filter(s=>n.includes(s.AccommodationUUID)).sort((s,T)=>{const m=n.findIndex(D=>D===s.AccommodationUUID),f=n.findIndex(D=>D===T.AccommodationUUID);return m>f?1:-1});return ve(l)});return(n,l)=>(i(),p(N,null,[n.value?(i(),p("ol",qa,[(i(!0),p(N,null,Z(u.value,s=>(i(),p("li",{key:s.AccommodationUUID},[n.registration&&n.registration.Allocation&&n.registration.Allocation.Periods.find(T=>T.AccommodationUUID===s.AccommodationUUID)?(i(),p("strong",ja,F(s.Name),1)):(i(),p(N,{key:1},[Y(F(s.Name),1)],64))]))),128))])):j("",!0),t(se,{onClick:l[0]||(l[0]=s=>E.value=!0),variant:"flat",color:"success"},{default:o(()=>[Y("Assign Accommodation")]),_:1}),n.convention&&E.value?(i(),H(xa,{key:1,modelValue:E.value,"onUpdate:modelValue":l[1]||(l[1]=s=>E.value=s),title:"Accommodation Allocation",convention:n.convention,registration:n.registration,"selected-accommodation":u.value},null,8,["modelValue","convention","registration","selected-accommodation"])):j("",!0)],64))}});const Ka=Ye(Qa,[["__scopeId","data-v-c426aacc"]]),za={key:0,class:"addonList"},Wa={key:0},Ja={key:0},Xa=le({__name:"DataTableItemExtras",props:{extras:{default:()=>[]},value:{default:""}},setup(e){const E=ce(()=>{if(!e.value)return;const u=JSON.parse(e.value),n=Object.keys(u),l=ve(e.extras);return l.forEach(s=>{s.Options=s.Options.filter(T=>n.includes(T.OptionUUID)?(T.Choices=T.Choices.filter(m=>m.TagUUID===u[T.OptionUUID].choiceId),u[T.OptionUUID].checked):!1)}),l.filter(s=>s.Options.length>0),l});return(u,n)=>u.value?(i(),p("ul",za,[(i(!0),p(N,null,Z(E.value,l=>(i(),p(N,{key:l.ExtraUUID},[l.Options.length?(i(),p("li",Wa,[M("strong",null,F(l.Name),1),M("ul",null,[(i(!0),p(N,null,Z(l.Options,s=>(i(),p("li",{key:s.OptionUUID},[Y(F(s.Name)+" ",1),s.Choices.length==1?(i(),p("small",Ja,"("+F(s.Choices[0].Title)+")",1)):j("",!0)]))),128))])])):j("",!0)],64))),128))])):j("",!0)}});const Za=Ye(Xa,[["__scopeId","data-v-55786e01"]]),eo={key:0},to=le({__name:"DataTableItemInterests",props:{interests:{default:()=>[]},value:{default:""}},setup(e){const E=ce(()=>{if(!e.value)return;const u=JSON.parse(e.value);return Object.entries(u).filter(([,n])=>n).map(([n,l])=>e.interests.find(s=>s.InterestUUID===n)).filter(n=>n!==void 0)});return(u,n)=>u.value?(i(),p("ul",eo,[(i(!0),p(N,null,Z(E.value,l=>(i(),p("li",{key:l.InterestUUID},F(l.Name),1))),128))])):j("",!0)}}),ao=M("br",null,null,-1),oo=M("small",null,"Options:",-1),no=M("br",null,null,-1),lo=M("small",null,"Addons:",-1),io=le({__name:"DataTableItemTicket",props:{tickets:{default:()=>[]},value:{default:""}},setup(e){const E=ce(()=>{if(!e.value)return;let u={Ticket:[],AddonsChecked:[],ComponentsChecked:[]};try{u=JSON.parse(e.value),"ticket"in u&&(u.Ticket=u.ticket),"addonsChecked"in u&&(u.AddonsChecked=u.addonsChecked),"componentsChecked"in u&&(u.ComponentsChecked=u.componentsChecked)}catch{}return u.Ticket.filter(n=>{const l=e.tickets.find(s=>s.TicketUUID===n);return!(!l||l.Type!==Ht.TICKET_TYPE_TICKET)}).map(n=>{const l=e.tickets.find(T=>T.TicketUUID===n),s=ve(l);return s.TicketComponents=l.TicketComponents.filter(T=>u.ComponentsChecked.includes(T.TicketUUID)),s.AddonTickets=l.AddonTickets.filter(T=>u.AddonsChecked.includes(T.TicketUUID)),s})});return(u,n)=>u.value?(i(!0),p(N,{key:0},Z(E.value,l=>(i(),p("div",{key:l.TicketUUID},[M("strong",null,F(l.Name),1),l.TicketComponents.length>0?(i(),p(N,{key:0},[ao,oo,Y("  "),(i(!0),p(N,null,Z(l.TicketComponents,s=>(i(),p(N,{key:s.TicketUUID},[M("small",null,F(s.Name),1),Y("  ")],64))),128))],64)):j("",!0),l.AddonTickets.length>0?(i(),p(N,{key:1},[no,lo,Y("  "),(i(!0),p(N,null,Z(l.AddonTickets,s=>(i(),p("small",{key:s.TicketUUID},[Y("("),M("em",null,F(s.Name),1),Y(")")]))),128))],64)):j("",!0)]))),128)):j("",!0)}}),so={key:0,class:"text-blue text-center"},uo={key:1,class:"text-red text-center"},ro={key:2,class:"text-orange text-center"},mo={key:3,class:"text-orange text-center"},co={key:4,class:"text-orange text-center"},vo={key:5,class:"text-orange text-center"},_o={key:6,class:"text-green text-center"},Ao={key:0},Uo={key:0},To=M("strong",null,"Total:",-1),Eo=le({__name:"RegListRow",props:{header:{},accommodations:{},convention:{},extras:{},item:{},interests:{},tickets:{},venues:{}},emits:["openActions","openPayments","reload"],setup(e,{emit:E}){const u=fe(),n=_(),l=_(),s=_(),T=_(),m=_(!1),f=(a,r,A)=>{l.value=a,u.getRegistrationGroup(A.RegistrationUUID||"").then(c=>{s.value=c,n.value=r,T.value=A,m.value=!0})},D=a=>{E("openActions",a)},S=a=>{E("openPayments",a)};return(a,r)=>(i(),p(N,null,[a.header.type==="ACCOMMODATION"&&a.accommodations.length>0&&a.item.raw[a.header.key]?(i(),H(Ka,{key:0,value:a.item.raw[a.header.key].Data,accommodations:a.accommodations,convention:a.convention,venues:a.venues,registration:a.item.raw[a.header.key].Registration},null,8,["value","accommodations","convention","venues","registration"])):a.header.type==="EXTRAS"&&a.extras.length>0?(i(),H(Za,{key:1,value:a.item.raw[a.header.key],extras:a.extras},null,8,["value","extras"])):a.header.type==="INTERESTS"&&a.interests.length>0?(i(),H(to,{key:2,value:a.item.raw[a.header.key],interests:a.interests},null,8,["value","interests"])):a.header.type==="TICKET"&&a.tickets.length>0?(i(),H(io,{key:3,value:a.item.raw[a.header.key],tickets:a.tickets},null,8,["value","tickets"])):a.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_SUBMISSION_STATUS"||a.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_ACCOMMODATION_FORM"||a.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_DEALER_FORM"||a.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_BADGE_FORM"||a.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_REGISTRATION_FORM"?(i(!0),p(N,{key:4},Z(a.item.raw[a.header.key],A=>(i(),p("ul",{key:A.Heading},[M("li",null,[M("strong",null,F(A.Heading)+":",1),Y(" "+F(q(pt)(A.Submission.Status))+" ",1),t(se,{icon:"mdi:mdi-form-select",title:"Edit Submitted Data",variant:"flat",onClick:c=>f(A.Registration,A.Form,A.Submission)},null,8,["onClick"])])]))),128)):a.header.type==="LAYOUT_ITEM_SOURCE_USER.USER_DATA_SOURCE_AVATAR"?(i(),H(pa,{key:5,class:"rounded-circle",src:a.item.raw[a.header.key],height:"32",width:"32"},null,8,["src"])):a.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_PAYMENT_STATUS"?(i(),p(N,{key:6},[a.item.raw[a.header.key]=="NOT_REQUIRED"?(i(),p("div",so,"No Payment Requested")):a.item.raw[a.header.key]=="MISSING_REQUIRED"?(i(),p("div",uo,"Partner Payment Not Requested")):a.item.raw[a.header.key]=="AWAITING_PARTNER"?(i(),p("div",ro,"Awaiting Partner Payment")):a.item.raw[a.header.key]=="ALL_REQUIRED"?(i(),p("div",mo,"Awaiting Payments")):a.item.raw[a.header.key]=="REQUIRED"?(i(),p("div",co,"Awaiting Payment")):a.item.raw[a.header.key]=="ADDITIONAL_REQUIRED"?(i(),p("div",vo,"Awaiting Additional Payments")):(i(),p("div",_o,"Completed"))],64)):a.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_REGISTRATION_ACTIONS"?(i(),p(N,{key:7},[t(se,{icon:"mdi:mdi-email-fast",variant:"flat",onClick:r[0]||(r[0]=A=>D(a.item.raw[a.header.key]))}),t(se,{icon:"mdi:mdi-cash-multiple",variant:"flat",onClick:r[1]||(r[1]=A=>S(a.item.raw[a.header.key]))})],64)):a.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_REGISTRATION_GROUP"?(i(),p(N,{key:8},[a.item.raw[a.header.key].length===1?(i(),p("em",Ao," Not in a group ")):(i(),p(N,{key:1},[M("ul",null,[(i(!0),p(N,null,Z(a.item.raw[a.header.key],A=>(i(),p("li",{key:A.UUID,class:"ml-0"},[Y(" #"+F(A.Reference)+" : "+F(A.Name)+" ",1),A.IsLeader?(i(),p("strong",Uo,"(Leader)")):j("",!0)]))),128))]),To,Y(" "+F(a.item.raw[a.header.key].length),1)],64))],64)):(i(),p(N,{key:9},[Y(F(a.item.raw[a.header.key]),1)],64)),m.value&&T.value&&n.value?(i(),H(Ia,{key:10,modelValue:m.value,"onUpdate:modelValue":r[4]||(r[4]=A=>m.value=A),scrollable:!0},{default:o(()=>[t(Dt,{class:"bg-red-darken-4"},{default:o(()=>[t(Da,null,{default:o(()=>[t(xt,{modelValue:n.value,"onUpdate:modelValue":r[2]||(r[2]=A=>n.value=A),admin:!0,convention:a.convention,data:T.value,editable:!0,"registration-group":s.value,onClose:r[3]||(r[3]=A=>{m.value=!1,E("reload")})},null,8,["modelValue","convention","data","registration-group"])]),_:1})]),_:1})]),_:1},8,["modelValue"])):j("",!0)],64))}});var fo=["onActivate","onAddUndo","onBeforeAddUndo","onBeforeExecCommand","onBeforeGetContent","onBeforeRenderUI","onBeforeSetContent","onBeforePaste","onBlur","onChange","onClearUndos","onClick","onContextMenu","onCopy","onCut","onDblclick","onDeactivate","onDirty","onDrag","onDragDrop","onDragEnd","onDragGesture","onDragOver","onDrop","onExecCommand","onFocus","onFocusIn","onFocusOut","onGetContent","onHide","onInit","onKeyDown","onKeyPress","onKeyUp","onLoadContent","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp","onNodeChange","onObjectResizeStart","onObjectResized","onObjectSelected","onPaste","onPostProcess","onPostRender","onPreProcess","onProgressState","onRedo","onRemove","onReset","onSaveContent","onSelectionChange","onSetAttrib","onSetContent","onShow","onSubmit","onUndo","onVisualAid"],So=function(e){return fo.map(function(E){return E.toLowerCase()}).indexOf(e.toLowerCase())!==-1},po=function(e,E,u){Object.keys(E).filter(So).forEach(function(n){var l=E[n];typeof l=="function"&&(n==="onInit"?l(e,u):u.on(n.substring(2),function(s){return l(s,u)}))})},Do=function(e,E,u,n){var l=e.modelEvents?e.modelEvents:null,s=Array.isArray(l)?l.join(" "):l;ne(n,function(T,m){u&&typeof T=="string"&&T!==m&&T!==u.getContent({format:e.outputFormat})&&u.setContent(T)}),u.on(s||"change input undo redo",function(){E.emit("update:modelValue",u.getContent({format:e.outputFormat}))})},Ro=function(e,E,u,n,l,s){n.setContent(s()),u.attrs["onUpdate:modelValue"]&&Do(E,u,n,l),po(e,u.attrs,n)},rt=0,yt=function(e){var E=Date.now(),u=Math.floor(Math.random()*1e9);return rt++,e+"_"+u+rt+String(E)},Io=function(e){return e!==null&&e.tagName.toLowerCase()==="textarea"},dt=function(e){return typeof e>"u"||e===""?[]:Array.isArray(e)?e:e.split(" ")},yo=function(e,E){return dt(e).concat(dt(E))},go=function(e){return e==null},mt=function(){return{listeners:[],scriptId:yt("tiny-script"),scriptLoaded:!1}},Oo=function(){var e=mt(),E=function(l,s,T,m){var f=s.createElement("script");f.referrerPolicy="origin",f.type="application/javascript",f.id=l,f.src=T;var D=function(){f.removeEventListener("load",D),m()};f.addEventListener("load",D),s.head&&s.head.appendChild(f)},u=function(l,s,T){e.scriptLoaded?T():(e.listeners.push(T),l.getElementById(e.scriptId)||E(e.scriptId,l,s,function(){e.listeners.forEach(function(m){return m()}),e.scriptLoaded=!0}))},n=function(){e=mt()};return{load:u,reinitialize:n}},Co=Oo(),ho=function(){return typeof window<"u"?window:global},Oe=function(){var e=ho();return e&&e.tinymce?e.tinymce:null},Mo={apiKey:String,cloudChannel:String,id:String,init:Object,initialValue:String,inline:Boolean,modelEvents:[String,Array],plugins:[String,Array],tagName:String,toolbar:[String,Array],modelValue:String,disabled:Boolean,tinymceScriptSrc:String,outputFormat:{type:String,validator:function(e){return e==="html"||e==="text"}}},me=globalThis&&globalThis.__assign||function(){return me=Object.assign||function(e){for(var E,u=1,n=arguments.length;u<n;u++){E=arguments[u];for(var l in E)Object.prototype.hasOwnProperty.call(E,l)&&(e[l]=E[l])}return e},me.apply(this,arguments)},bo=function(e,E,u,n){return e(n||"div",{id:E,ref:u})},Vo=function(e,E,u){return e("textarea",{id:E,visibility:"hidden",ref:u})},Ke={selector:void 0,target:void 0},No=le({props:Mo,setup:function(e,E){var u=e.init?me(me({},e.init),Ke):me({},Ke),n=kt(e),l=n.disabled,s=n.modelValue,T=n.tagName,m=_(null),f=null,D=e.id||yt("tiny-vue"),S=e.init&&e.init.inline||e.inline,a=!!E.attrs["onUpdate:modelValue"],r=!0,A=e.initialValue?e.initialValue:"",c="",V=function(y){return a?function(){return s!=null&&s.value?s.value:""}:function(){return y?A:c}},v=function(){var y=V(r),G=me(me({},u),{readonly:e.disabled,target:m.value,plugins:yo(u.plugins,e.plugins),toolbar:e.toolbar||u.toolbar,inline:S,setup:function(K){f=K,K.on("init",function(ie){return Ro(ie,e,E,K,s,y)}),typeof u.setup=="function"&&u.setup(K)}});Io(m.value)&&(m.value.style.visibility=""),Oe().init(G),r=!1};ne(l,function(y){var G;f!==null&&(typeof((G=f.mode)===null||G===void 0?void 0:G.set)=="function"?f.mode.set(y?"readonly":"design"):f.setMode(y?"readonly":"design"))}),ne(T,function(y){var G;a||(c=f.getContent()),(G=Oe())===null||G===void 0||G.remove(f),tt(function(){return v()})}),Ft(function(){if(Oe()!==null)v();else if(m.value&&m.value.ownerDocument){var y=e.cloudChannel?e.cloudChannel:"6",G=e.apiKey?e.apiKey:"no-api-key",K=go(e.tinymceScriptSrc)?"https://cdn.tiny.cloud/1/".concat(G,"/tinymce/").concat(y,"/tinymce.min.js"):e.tinymceScriptSrc;Co.load(m.value.ownerDocument,K,v)}}),Pt(function(){Oe()!==null&&Oe().remove(f)}),S||(wt(function(){r||v()}),$t(function(){var y;a||(c=f.getContent()),(y=Oe())===null||y===void 0||y.remove(f)}));var O=function(y){var G;c=f.getContent(),(G=Oe())===null||G===void 0||G.remove(f),u=me(me(me({},u),y),Ke),tt(function(){return v()})};return E.expose({rerender:O,getEditor:function(){return f}}),function(){return S?bo(at,D,m,e.tagName):Vo(at,D,m)}}});const Lo=["colspan"],ko=M("strong",null,"E-Mail Content",-1),Fo=["innerHTML"],gt=le({__name:"Communications",props:{hideHistory:{type:Boolean,default:!1},registration:{},showEditor:{type:Boolean}},emits:["close-editor"],setup(e,{emit:E}){const u=fe(),n=_([]),l=_({From:"",Subject:"",HTML:""}),s=_(""),T=_(""),m=_(""),f=_(!1),D=_([]),S=_([]),a=_([{key:"CreatedAt",title:"Date"},{key:"Subject",title:"Subject"},{key:"User.DisplayName",title:"Sender"},{key:"Status",title:"Status"}]);ne(l,V=>{m.value=V.From||m.value||"",T.value=V.Subject||T.value||"",s.value=V.HTML||s.value||""});const r=()=>{u.getRegistrationEmails(e.registration.RegistrationUUID).then(V=>{V&&(V.forEach(v=>{v.CreatedAt=Ta(new Date(v.CreatedAt||"")),v.Status=Na(v.Status),v.User||(v.User={ID:0,UserUUID:"",DisplayName:"System",Handle:"",Credentials:[],Additional:{FirstName:"",LastName:"",DOB:"",Email:""},Data:"",Groups:[],Tags:[]})}),S.value=V)})};r(),(()=>{u.getRegistrationEmailTemplates(e.registration.RegistrationUUID).then(V=>{V&&(n.value=V)})})();const c=({callback:V})=>{u.sendRegistrationEmail(e.registration.RegistrationUUID,m.value,T.value,s.value).then(v=>{v?V&&(V("Email Sent"),r(),setTimeout(()=>{f.value=!1},2e3)):V&&V("Not sent")}).catch(()=>{V&&V("Not sent")})};return(V,v)=>(i(),p(N,null,[V.showEditor?(i(),p(N,{key:0},[t(ee,null,{default:o(()=>[t(P,null,{default:o(()=>[t(oe,{items:n.value,"item-title":"Subject","return-object":"",label:"Template","hide-details":"",modelValue:l.value,"onUpdate:modelValue":v[0]||(v[0]=O=>l.value=O),variant:"outlined"},null,8,["items","modelValue"])]),_:1})]),_:1}),t(ee,null,{default:o(()=>[t(P,{cols:"12"},{default:o(()=>[t(Te,{modelValue:m.value,"onUpdate:modelValue":v[1]||(v[1]=O=>m.value=O),label:"From",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),t(P,{cols:"12"},{default:o(()=>[t(Te,{modelValue:T.value,"onUpdate:modelValue":v[2]||(v[2]=O=>T.value=O),label:"Subject",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),t(P,{cols:"12"},{default:o(()=>[t(q(No),{modelValue:s.value,"onUpdate:modelValue":v[3]||(v[3]=O=>s.value=O),"api-key":"g9sce3fktcgvk0i7sp96cahgyk4cos7q27es3ubnlal3xf3z"},null,8,["modelValue"])]),_:1})]),_:1}),t(ee,null,{default:o(()=>[t(P,null,{default:o(()=>[t(We,{onClick:v[4]||(v[4]=O=>E("close-editor")),label:"Close E-mail Editor",color:"secondary","prepend-icon":"mdi:mdi-window-close"})]),_:1}),t(P,{class:"text-right"},{default:o(()=>[t(We,{onClick:c,label:"Send",color:"error"})]),_:1})]),_:1})],64)):j("",!0),S.value.length&&!V.hideHistory?(i(),H(Et,{key:1,class:"my-2"},{default:o(()=>[t(Tt,null,{default:o(()=>[t(_t,null,{default:o(()=>[Y(" Email History ")]),_:1}),t(At,null,{default:o(()=>[t(q(Ut),{items:S.value,headers:a.value,"show-expand":!0,"item-value":"EmailUUID",expanded:D.value,"onUpdate:expanded":v[5]||(v[5]=O=>D.value=O)},{"expanded-row":o(({columns:O,item:y})=>[M("tr",null,[M("td",{colspan:O.length},[ko,M("div",{class:"communicationsViewEmailPreview",innerHTML:y.raw.HTML},null,8,Fo)],8,Lo)])]),"footer.prepend":o(()=>[t(se,{"prepend-icon":"mdi:mdi-refresh",color:"primary",class:"mr-4",onClick:r},{default:o(()=>[Y("Refresh")]),_:1})]),_:1},8,["items","headers","expanded"])]),_:1})]),_:1})]),_:1})):j("",!0)],64))}});const Po=e=>(ct("data-v-7c73db26"),e=e(),vt(),e),wo=["colspan"],$o=Po(()=>M("strong",null,"Details",-1)),Go=["innerHTML"],Bo=le({__name:"PaymentTransactions",props:{hideHistory:{type:Boolean},updated:{},registration:{},showEditor:{type:Boolean}},emits:["close-editor","change"],setup(e,{emit:E}){const u=e;let{hideHistory:n=!1,registration:l,showEditor:s}=u;const T=fe(),m=_([]),f=_([]),D=_([{key:"CreatedAt",title:"Date"},{key:"Type",title:"Type"},{key:"Source",title:"Source"},{key:"Description",title:"Description"},{key:"Admin",title:"Admin"},{key:"Amount",title:"Amount"}]),S=()=>({PaymentTransactionUUID:Me(),Amount:0,Data:{},Description:"",ID:0,RegistrationID:l.ID,RegistrationUUID:l.RegistrationUUID,Source:Sa.PAYMENT_TRANSACTION_SOURCE_NULL,Type:ft.PAYMENT_TRANSACTION_TYPE_NULL}),a=_(S()),{convertTransactions:r,getPaymentTransactionsDisplay:A}=St();ne(u,()=>{n=u.hideHistory,l=u.registration,s=u.showEditor,A(l.RegistrationUUID).then(v=>{f.value=v})});const c=()=>{A(l.RegistrationUUID).then(v=>{f.value=v})};c();const V=()=>{T.saveRegistrationPaymentTransaction(a.value).then(v=>{v&&(r(v.PaymentTransactions),a.value=S(),E("close-editor"),E("change"))})};return(v,O)=>(i(),p(N,null,[q(s)?(i(),p(N,{key:0},[t(Ra,null,{default:o(()=>[Y(" Add Transaction ")]),_:1}),t(ee,null,{default:o(()=>[t(P,{cols:"12",sm:"6"},{default:o(()=>[t(oe,{items:q(Ea),"item-title":"title","item-value":"value",label:"Transaction Type",clearable:!0,"hide-details":"",modelValue:a.value.Type,"onUpdate:modelValue":O[0]||(O[0]=y=>a.value.Type=y),variant:"outlined"},null,8,["items","modelValue"])]),_:1}),t(P,{cols:"12",sm:"6"},{default:o(()=>[t(oe,{items:q(fa),"item-title":"title","item-value":"value",label:"Source",clearable:!0,"hide-details":"",modelValue:a.value.Source,"onUpdate:modelValue":O[1]||(O[1]=y=>a.value.Source=y),variant:"outlined"},null,8,["items","modelValue"])]),_:1})]),_:1}),t(ee,null,{default:o(()=>[t(P,{cols:"12",sm:"8",md:"10"},{default:o(()=>[t(Te,{label:"Description","hide-details":"",modelValue:a.value.Description,"onUpdate:modelValue":O[2]||(O[2]=y=>a.value.Description=y),variant:"outlined"},null,8,["modelValue"])]),_:1}),t(P,{cols:"12",sm:"4",md:"2"},{default:o(()=>[t(Te,{label:"Amount","prepend-inner-icon":"mdi:mdi-currency-gbp","hide-details":"",modelValue:a.value.Amount,"onUpdate:modelValue":O[3]||(O[3]=y=>a.value.Amount=y),modelModifiers:{number:!0},variant:"outlined"},null,8,["modelValue"])]),_:1})]),_:1}),t(ee,null,{default:o(()=>[t(P,{cols:"12",sm:"3",md:"2",lg:"1"},{default:o(()=>[t(se,{class:"w-100",onClick:O[4]||(O[4]=y=>E("close-editor")),color:"warning"},{default:o(()=>[Y("Cancel")]),_:1})]),_:1}),t(Rt),t(P,{cols:"12",sm:"6",md:"3",lg:"2",xl:"2"},{default:o(()=>[t(se,{class:"w-100",onClick:V,color:"primary"},{default:o(()=>[Y("Submit Transaction")]),_:1})]),_:1})]),_:1})],64)):j("",!0),f.value.length&&!q(n)?(i(),H(Et,{key:1,class:"my-2"},{default:o(()=>[t(Tt,null,{default:o(()=>[t(_t,null,{default:o(()=>[Y(" Transaction History ")]),_:1}),t(At,null,{default:o(()=>[t(q(Ut),{items:f.value,headers:D.value,"show-expand":!1,"item-value":"PaymentTransactionUUID",expanded:m.value,"onUpdate:expanded":O[5]||(O[5]=y=>m.value=y)},{"expanded-row":o(({columns:y,item:G})=>[M("tr",null,[M("td",{colspan:y.length},[$o,M("div",{innerHTML:G.raw.HTML},null,8,Go)],8,wo)])]),"footer.prepend":o(()=>[t(se,{"prepend-icon":"mdi:mdi-refresh",color:"primary",class:"mr-4",onClick:c},{default:o(()=>[Y("Refresh")]),_:1})]),_:1},8,["items","headers","expanded"])]),_:1})]),_:1})]),_:1})):j("",!0)],64))}});const Yo=Ye(Bo,[["__scopeId","data-v-7c73db26"]]),xe=e=>(ct("data-v-76d30f00"),e=e(),vt(),e),Ho={class:"v-row"},xo={key:0,class:"v-col v-col-10 py-1 v-row mx-0 pl-0"},qo={class:"v-col v-col-12 v-col-sm-4 v-col-md-3 font-weight-bold pb-0 pr-0"},jo={class:"v-col v-col-12 v-col-sm-8 v-col-md-9 font-italic pt-0 pt-sm-3 pb-sm-0 pl-sm-0"},Qo={class:"v-col v-col-2 align-self-end text-right py-1 text-no-wrap"},Ko=xe(()=>M("dt",{class:"v-col v-col-9 py-1 font-weight-bold totals"}," Total Charges ",-1)),zo={class:"v-col v-col-3 align-self-end text-right py-1 totals text-no-wrap"},Wo=xe(()=>M("dt",{class:"v-col v-col-9 py-1 font-weight-bold"}," Applied Total ",-1)),Jo={class:"v-col v-col-3 align-self-end text-right py-1 text-no-wrap"},Xo=xe(()=>M("dt",{class:"v-col v-col-9 py-1 font-weight-bold"}," Currently Paid ",-1)),Zo={class:"v-col v-col-3 align-self-end text-right py-1 text-no-wrap"},en=xe(()=>M("dt",{class:"v-col v-col-9 py-1 font-weight-bold totals"}," Balance ",-1)),tn={class:"v-col v-col-3 align-self-end text-right py-1 totals text-no-wrap"},an=le({__name:"PaymentActions",props:Ee({forms:{},registration:{},title:{}},{modelValue:{type:Boolean,required:!0}}),emits:Ee(["update:registration"],["update:modelValue"]),setup(e,{emit:E}){const u=e,n=Be(e,"modelValue"),{registration:l}=u,s=_(!1),T=_(!1),m=_(),f=_([]),D=_(new Date().getTime()),S=Je(u,E,void 0,void 0,"registration"),a=_(ve(S.value));ne(S,()=>{a.value=ve(S.value)});const r=fe(),A=()=>{r.generateRegistrationCharges(l.RegistrationUUID,!1).then(v=>{v&&(f.value=v.PaymentTransactions,m.value=v.Registration,D.value=new Date().getTime())}).catch(()=>{})};A();const c=()=>{r.generateRegistrationCharges(l.RegistrationUUID,!0).then(v=>{v&&(f.value=v.PaymentTransactions,m.value=v.Registration,D.value=new Date().getTime())})},{totalCharges:V}=St();return(v,O)=>(i(),H(He,{modelValue:n.value,"onUpdate:modelValue":O[3]||(O[3]=y=>n.value=y),title:v.title,"show-close-action":!0,color:"primary","close-action-label":"Close",persistent:!0,"retain-focus":!1,scrollable:!0,fullscreen:""},{default:o(()=>[t(Ce,{class:"px-0 mx-0",fluid:!0},{default:o(()=>[m.value?(i(),p(N,{key:0},[M("dl",Ho,[(i(!0),p(N,null,Z(f.value,y=>(i(),p(N,{key:y.PaymentTransactionUUID},[y.Type===q(ft).PAYMENT_TRANSACTION_TYPE_CHARGE?(i(),p("dt",xo,[M("div",qo,F(y.Description.split(":")[0])+": ",1),M("div",jo,F(y.Description.split(":")[1]),1)])):j("",!0),M("dd",Qo," £"+F(y.Amount),1)],64))),128)),Ko,M("dd",zo," £"+F(q(V)(f.value)),1),Wo,M("dd",Jo," £"+F(m.value.Total),1),Xo,M("dd",Zo," £"+F(m.value.Paid),1),en,M("dd",tn," £"+F(m.value.Total-m.value.Paid),1)]),t(ee,{class:"flex-row-reverse"},{default:o(()=>[t(P,{class:"text-right"},{default:o(()=>[t(se,{color:"primary",onClick:c},{default:o(()=>[Y("Apply Charges")]),_:1})]),_:1}),T.value?j("",!0):(i(),H(P,{key:0},{default:o(()=>[t(se,{color:"secondary",onClick:O[0]||(O[0]=y=>T.value=!0)},{default:o(()=>[Y("Transaction Entry")]),_:1})]),_:1}))]),_:1})],64)):j("",!0),t(Yo,{registration:q(l),"show-editor":T.value,onCloseEditor:O[1]||(O[1]=y=>T.value=!1),updated:D.value,onChange:A},null,8,["registration","show-editor","updated"]),t(gt,{registration:q(l),"show-editor":s.value,onCloseEditor:O[2]||(O[2]=y=>s.value=!1)},null,8,["registration","show-editor"])]),_:1})]),_:1},8,["modelValue","title"]))}});const on=Ye(an,[["__scopeId","data-v-76d30f00"]]),nn=le({__name:"RegistrationActions",props:Ee({forms:{},registration:{},title:{}},{modelValue:{type:Boolean,required:!0}}),emits:Ee(["update:registration"],["update:modelValue"]),setup(e,{emit:E}){const u=e,n=Be(e,"modelValue"),l=_(!1),s=Je(u,E,void 0,void 0,"registration"),T=_(ve(s.value));ne(s,()=>{T.value=ve(s.value)});const m=fe(),f=(D,S)=>{const a=T.value.Submissions.find(r=>r.SubmissionUUID==S);if(!a){D&&D("Submission not found");return}m.setSubmissionStatus(S,a.Status).then(r=>{r?(T.value.Submissions.forEach((A,c)=>{s.value.Submissions[c].Status=A.Status}),D&&D("Status Saved")):D&&D("Status not saved")}).catch(()=>{D&&D("Status not saved")})};return(D,S)=>(i(),H(He,{modelValue:n.value,"onUpdate:modelValue":S[2]||(S[2]=a=>n.value=a),title:D.title,"show-close-action":!0,color:"primary","close-action-label":"Close",persistent:!0,"retain-focus":!1,scrollable:!0},{default:o(()=>[t(Ce,{class:"px-0 mx-0",fluid:!0},{default:o(()=>[t(Ge,null,{default:o(()=>[(i(!0),p(N,null,Z(T.value.Submissions,a=>(i(),H(ke,{key:a.SubmissionUUID,class:"pa-0"},{default:o(()=>[t(ee,{class:"py-2 align-center"},{default:o(()=>[t(P,{cols:"8"},{default:o(()=>{var r;return[t(oe,{modelValue:a.Status,"onUpdate:modelValue":A=>a.Status=A,items:q(st),"item-text":"title","item-value":"value",variant:"outlined","hide-details":"",label:((r=D.forms.find(A=>A.FormUUID==a.FormUUID))==null?void 0:r.Name)||""},{selection:o(()=>[t(Aa,{class:"mr-4"},{default:o(()=>{var A;return[Y(F((A=q(st).find(c=>c.value===a.Status))==null?void 0:A.icon),1)]}),_:2},1024),Y(" "+F(q(pt)(a.Status)),1)]),item:o(({item:A,props:{onClick:c}})=>[t(ke,{title:A.title,"prepend-icon":A.raw.icon,onClick:c},null,8,["title","prepend-icon","onClick"])]),_:2},1032,["modelValue","onUpdate:modelValue","items","label"])]}),_:2},1024),t(P,{cols:"4"},{default:o(()=>[t(We,{title:"Save","prepend-icon":"mdi:mdi-content-save",color:"warning",onClick:r=>f(r.callback,a.SubmissionUUID)},null,8,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1}),t(ee,null,{default:o(()=>[t(P,{cols:"12"},{default:o(()=>[t(se,{"prepend-icon":"mdi:mdi-email",color:"primary",onClick:S[0]||(S[0]=a=>l.value=!0)},{default:o(()=>[Y("Prepare Email")]),_:1})]),_:1})]),_:1}),t(gt,{registration:D.registration,"show-editor":l.value,onCloseEditor:S[1]||(S[1]=a=>l.value=!1)},null,8,["registration","show-editor"])]),_:1})]),_:1},8,["modelValue","title"]))}});const $n=le({__name:"RegistrationsView",emits:["pageTitle"],setup(e,{emit:E}){var Xe;const u=ga();E("pageTitle","Registration Manager");const n=Gt(),l=Bt(),s=_(!0);let T=((Xe=n.params.convention)==null?void 0:Xe.toString())||"";const m=_({ID:0,ConventionUUID:Me(),OrganisationID:0,OrganisationUUID:Qe,Name:"New Convention",Description:"",DetailLink:"",Logo:"",Slug:"",Accommodation:[],Tickets:[],Extras:[],Interests:[],Visible:!1}),f=fe(),D=_({ID:0,AdminLayoutUUID:Me(),ConventionID:m.value.ID,ConventionUUID:m.value.ConventionUUID,Name:"Registration Table",Type:It.ADMIN_LAYOUT_TABLE,Panels:[]}),S=_([]),a=_([]),r=_([]),A=_([]),c=_([]),V=_(1),v=_(10),O=_([]),y=_(0),G=_(!1),K=_(""),ie=_(""),Se=_(""),pe=_(""),C=_(""),h=_(""),L=_([]),I=_([]),$=_([]),W=_([]),te=_([]),z=_([]),re=_(0),ue=_(),De=_(!1),Re=_(!1);ne(re,d=>{d===7&&Ve()}),ne(C,()=>{ie.value=Date.now().toString()}),ne(h,()=>{ie.value=Date.now().toString()});const Ie=()=>{S.value=[],r.value=[],c.value=[];try{f.getConventionAdminLayoutByName(m.value.ConventionUUID,"Registration Table").then(d=>{re.value+=1,d?D.value=d:(D.value.ConventionID=m.value.ID,D.value.ConventionUUID=m.value.ConventionUUID)})}catch{D.value.ConventionID=m.value.ID,D.value.ConventionUUID=m.value.ConventionUUID}try{f.getConventionForms(m.value.ConventionUUID).then(d=>{re.value+=1,d&&(S.value=d)})}catch{}try{f.getConventionAccommodation(m.value.ConventionUUID).then(d=>{re.value+=1,d&&(I.value=d)})}catch{}try{f.getConventionVenues(m.value.ConventionUUID).then(d=>{re.value+=1,d&&(z.value=d)})}catch{}try{f.getConventionExtras(m.value.ConventionUUID).then(d=>{re.value+=1,d&&($.value=d)})}catch{}try{f.getConventionInterests(m.value.ConventionUUID).then(d=>{re.value+=1,d&&(W.value=d)})}catch{}try{f.getConventionTickets(m.value.ConventionUUID).then(d=>{re.value+=1,d&&(te.value=d)})}catch{}try{f.getConventionGroups(m.value.ConventionUUID).then(d=>{d&&(a.value=d.sort((U,R)=>U.Name.localeCompare(R.Name)))})}catch{}try{f.getConventionTags(m.value.ConventionUUID).then(d=>{d&&(A.value=d.sort((U,R)=>U.Title.localeCompare(R.Title)).map(U=>(U.Title=`${U.Title} [${U.Key}]`,U)))})}catch{}},be=({page:d,itemsPerPage:U,sortBy:R})=>{s.value=!0,V.value=d,O.value=R;const g=c.value.find(J=>J.uuid==K.value),de=g==null?void 0:g.layout.Items;let ae="",Ze="";if(R&&de&&R.length>=1){const J=de.find(Ne=>Ne.LayoutItemUUID==R[0].key);switch(Ze=R[0].order,J==null?void 0:J.MetaField){case Q.META_DATA_SOURCE_ACCOMMODATION_FORM:ae="submission.status";break;case Q.META_DATA_SOURCE_BADGE_FORM:ae="submission.status";break;case Q.META_DATA_SOURCE_DEALER_FORM:ae="submission.status";break;case Q.META_DATA_SOURCE_REGISTRATION_FORM:ae="submission.status";break;case Q.META_DATA_SOURCE_REGISTRATION_REFERENCE:ae="reference";break;case Q.META_DATA_SOURCE_SUBMISSION_DATE:ae="created";break;case Q.META_DATA_SOURCE_SUBMISSION_STATUS:ae="submission.status";break}switch(J==null?void 0:J.UserField){case X.USER_DATA_SOURCE_DISPLAY_NAME:ae="user.display_name";break;case X.USER_DATA_SOURCE_EMAIL:ae="user.email";break;case X.USER_DATA_SOURCE_FIRST_NAME:ae="user.firstname";break;case X.USER_DATA_SOURCE_HANDLE:ae="user.handle";break;case X.USER_DATA_SOURCE_LAST_NAME:ae="user.lastname";break}}try{const J={Direction:Ze,Limit:U,Offset:(d-1)*U,Order:ae};g&&g.layout.RequiredRegistrationTags.length>0&&(J.PanelUUID=g==null?void 0:g.layout.LayoutPanelUUID),(g==null?void 0:g.layout.RequiredFormType)===Ue.FORM_TYPE_ACCOMMODATION&&(J.Accommodation=!0),(g==null?void 0:g.layout.RequiredFormType)===Ue.FORM_TYPE_BADGE&&(J.Badge=!0),(g==null?void 0:g.layout.RequiredFormType)===Ue.FORM_TYPE_DEALER&&(J.Dealer=!0),(g==null?void 0:g.layout.RequiredFormType)===Ue.FORM_TYPE_REGISTRATION&&(J.Registration=!0),J.GroupUUID=C.value||Qe,J.TagUUID=h.value||Qe,J.Email=pe.value,J.Reference=Se.value,f.searchConventionRegistrations(m.value.ConventionUUID,J).then(Ne=>{Ne&&(y.value=Ne.Total,r.value=Ne.Registrations,c.value.forEach(qe=>{const Mt=qe.layout;qe.items=r.value.map(w=>{const we=[];let _e;w.Leader?_e=w:_e=w.Primary,we.push({Name:_e.User.DisplayName,UUID:_e.UserUUID,UserUUID:_e.User.UserUUID,IsLeader:!0,Reference:_e.Reference,Paid:_e.Paid,Total:_e.Total}),we.push(..._e.Members.map(Ae=>({Name:Ae.User.DisplayName,UUID:Ae.UserUUID,UserUUID:Ae.User.UserUUID,IsLeader:!1,Reference:Ae.Reference,Paid:Ae.Paid,Total:Ae.Total})));const x={};return qe.headers.forEach(Ae=>{var et;const k=Mt.Items.find(Le=>Le.LayoutItemUUID===Ae.key);if(k){if(k.SourceType==="LAYOUT_ITEM_SOURCE_FORM"&&k.SectionField)w.Submissions.forEach(Le=>{const he=Le.Data.find(b=>b.SectionFieldUUID===k.SectionFieldUUID);if(he){Ae.type===qt.ACCOMMODATION?x[k.LayoutItemUUID]={Data:he.Data,Registration:w}:x[k.LayoutItemUUID]=he.Data;return}});else if(k.SourceType==="LAYOUT_ITEM_SOURCE_USER"&&k.UserField)switch(k.UserField){case X.USER_DATA_SOURCE_AVATAR:x[k.LayoutItemUUID]=u.GetProfileImageURL(w.UserUUID);break;case X.USER_DATA_SOURCE_DISPLAY_NAME:x[k.LayoutItemUUID]=w.User.DisplayName;break;case X.USER_DATA_SOURCE_EMAIL:x[k.LayoutItemUUID]=w.User.Additional.Email;break;case X.USER_DATA_SOURCE_HANDLE:x[k.LayoutItemUUID]=w.User.Handle;break;case X.USER_DATA_SOURCE_DATE_OF_BIRTH:x[k.LayoutItemUUID]=w.User.Additional.DOB;break;case X.USER_DATA_SOURCE_FIRST_NAME:x[k.LayoutItemUUID]=w.User.Additional.FirstName;break;case X.USER_DATA_SOURCE_LAST_NAME:x[k.LayoutItemUUID]=w.User.Additional.LastName;break;case X.USER_DATA_SOURCE_TELEGRAM:x[k.LayoutItemUUID]="";break}else if(k.SourceType==="LAYOUT_ITEM_SOURCE_META"&&k.MetaField){const Le=(et=S.value.find(b=>b.Type===Ue.FORM_TYPE_REGISTRATION))==null?void 0:et.FormUUID,he=w.Submissions.find(b=>b.FormUUID===Le);switch(k.MetaField){case Q.META_DATA_SOURCE_REGISTRATION_ACTIONS:x[k.LayoutItemUUID]=w;break;case Q.META_DATA_SOURCE_REGISTRATION_GROUP:x[k.LayoutItemUUID]=we;break;case Q.META_DATA_SOURCE_REGISTRATION_REFERENCE:x[k.LayoutItemUUID]=w.Reference;break;case Q.META_DATA_SOURCE_SUBMISSION_DATE:if(he){const b=new Date(he.CreatedAt||"");x[k.LayoutItemUUID]=`${b.getFullYear()}-${(b.getMonth()+1).toString().padStart(2,"0")}-${b.getDate().toString().padStart(2,"0")} ${b.getHours().toString().padStart(2,"0")}:${b.getMinutes().toString().padStart(2,"0")}:${b.getSeconds().toString().padStart(2,"0")}`}else{const b=new Date(w.CreatedAt||"");x[k.LayoutItemUUID]=`${b.getFullYear()}-${(b.getMonth()+1).toString().padStart(2,"0")}-${b.getDate().toString().padStart(2,"0")} ${b.getHours().toString().padStart(2,"0")}:${b.getMinutes().toString().padStart(2,"0")}:${b.getSeconds().toString().padStart(2,"0")}`}break;case Q.META_DATA_SOURCE_ACCOMMODATION_FORM:x[k.LayoutItemUUID]=w.Submissions.map(b=>{const B=S.value.find(ye=>ye.FormUUID===b.FormUUID);return{Heading:B==null?void 0:B.Heading,Form:B,Submission:b,Registration:w}}).filter(b=>{var B;return((B=b.Form)==null?void 0:B.Type)===Ue.FORM_TYPE_ACCOMMODATION});break;case Q.META_DATA_SOURCE_BADGE_FORM:x[k.LayoutItemUUID]=w.Submissions.map(b=>{const B=S.value.find(ye=>ye.FormUUID===b.FormUUID);return{Heading:B==null?void 0:B.Heading,Form:B,Submission:b,Registration:w}}).filter(b=>{var B;return((B=b.Form)==null?void 0:B.Type)===Ue.FORM_TYPE_BADGE});break;case Q.META_DATA_SOURCE_DEALER_FORM:x[k.LayoutItemUUID]=w.Submissions.map(b=>{const B=S.value.find(ye=>ye.FormUUID===b.FormUUID);return{Heading:B==null?void 0:B.Heading,Form:B,Submission:b,Registration:w}}).filter(b=>{var B;return((B=b.Form)==null?void 0:B.Type)===Ue.FORM_TYPE_DEALER});break;case Q.META_DATA_SOURCE_PAYMENT_STATUS:if(w.Paid===0&&w.Total)x[k.LayoutItemUUID]="REQUIRED";else if(w.Total>w.Paid)x[k.LayoutItemUUID]="ADDITIONAL_REQUIRED";else{const b=we.find(B=>B.Paid===0&&(B.Total||0)>0);if(b){w.Total===0&&b.Total===0?x[k.LayoutItemUUID]="NOT_REQUIRED":w.Total===0&&b.Total||w.Total>0&&b.Total===0?x[k.LayoutItemUUID]="MISSING_REQUIRED":w.Paid>=w.Total?x[k.LayoutItemUUID]="AWAITING_PARTNER":x[k.LayoutItemUUID]="ALL_REQUIRED";break}else w.Total===0?x[k.LayoutItemUUID]="NOT_REQUIRED":x[k.LayoutItemUUID]="COMPLETE"}break;case Q.META_DATA_SOURCE_SUBMISSION_STATUS:ya(w.Submissions,S.value),x[k.LayoutItemUUID]=w.Submissions.map(b=>{const B=S.value.find(ye=>ye.FormUUID===b.FormUUID);return{Heading:B==null?void 0:B.Heading,Form:B,Submission:b,Registration:w}});break}}}}),x})}),s.value=!1)})}catch{}},Ve=()=>{D.value.Panels.forEach(d=>{d.Items.forEach(U=>{(U.SectionField==null||U.SectionField.Field==null)&&S.value.find(R=>{R.Sections.find(g=>{if(g.Fields){const de=g.Fields.find(ae=>ae.SectionFieldUUID===U.SectionFieldUUID);if(de)return U.SectionField=de,!0}})})})}),D.value.Panels.length>0&&(c.value=[],D.value.Panels.forEach(d=>{const U={uuid:Me(),order:d.Order,name:d.Name,headers:[],items:[],layout:d};d.Items.sort((R,g)=>R.Order>g.Order?1:R.Order==g.Order?0:-1),U.headers=d.Items.map(R=>{var g,de;return R.DefaultSort&&L.value.push({key:R.LayoutItemUUID,order:"asc"}),{key:R.LayoutItemUUID,title:R.Label||((de=(g=R.SectionField)==null?void 0:g.Field)==null?void 0:de.Label)||"",align:R.Align==="end"?"end":"start",sortable:Ot(R),type:Pe(R)}}),c.value.push(U)}),c.value=c.value.sort((d,U)=>d.order>U.order?1:d.order==U.order?0:-1)),(K.value==null||K.value=="")&&c.value.length>0&&(K.value=c.value[0].uuid)};T?f.getConvention(T).then(d=>{d&&(m.value=d,Ie())}).catch(()=>{l.push("/")}):l.push("/");const Pe=d=>{var U,R;if(d.SourceType===Fe.LAYOUT_ITEM_SOURCE_META)return`${d.SourceType}.${d.MetaField}`;if(d.SourceType===Fe.LAYOUT_ITEM_SOURCE_FORM)return(R=(U=d.SectionField)==null?void 0:U.Field)==null?void 0:R.Type;if(d.SourceType===Fe.LAYOUT_ITEM_SOURCE_USER)return`${d.SourceType}.${d.UserField}`},Ot=d=>{const U=[Q.META_DATA_SOURCE_ACCOMMODATION_FORM,Q.META_DATA_SOURCE_BADGE_FORM,Q.META_DATA_SOURCE_DEALER_FORM,Q.META_DATA_SOURCE_REGISTRATION_FORM,Q.META_DATA_SOURCE_REGISTRATION_REFERENCE,Q.META_DATA_SOURCE_SUBMISSION_DATE,Q.META_DATA_SOURCE_SUBMISSION_STATUS],R=[X.USER_DATA_SOURCE_DISPLAY_NAME,X.USER_DATA_SOURCE_EMAIL,X.USER_DATA_SOURCE_HANDLE,X.USER_DATA_SOURCE_DATE_OF_BIRTH,X.USER_DATA_SOURCE_FIRST_NAME,X.USER_DATA_SOURCE_LAST_NAME];return U.includes(d.MetaField)||R.includes(d.UserField)},Ct=d=>{ue.value=d,De.value=!0},ht=d=>{ue.value=d,Re.value=!0};return ne(De,d=>{d||(ue.value=void 0)}),ne(Re,d=>{d||(ue.value=void 0)}),(d,U)=>(i(),H(Ca,null,{default:o(()=>[t(Oa,{color:"blue-darken-4"},{default:o(()=>[t(da,{modelValue:K.value,"onUpdate:modelValue":U[0]||(U[0]=R=>K.value=R),"show-arrows":""},{default:o(()=>[(i(!0),p(N,null,Z(c.value,R=>(i(),H(ma,{key:R.uuid,value:R.uuid},{default:o(()=>[Y(F(R.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"]),t(Rt),t(se,{icon:"mdi:mdi-cog-outline",onClick:U[1]||(U[1]=R=>G.value=!0)})]),_:1}),t(va,{modelValue:K.value,"onUpdate:modelValue":U[11]||(U[11]=R=>K.value=R),disabled:!0},{default:o(()=>[(i(!0),p(N,null,Z(c.value,R=>(i(),H(ca,{key:R.uuid,value:R.uuid},{default:o(()=>[R.uuid===K.value?(i(),H(Dt,{key:0,class:"pa-2"},{default:o(()=>[t(q(ka),{"items-per-page":v.value,"onUpdate:itemsPerPage":U[9]||(U[9]=g=>v.value=g),"sort-by":L.value,"onUpdate:sortBy":U[10]||(U[10]=g=>L.value=g),headers:R.headers,"items-length":y.value,items:R.items,"item-value":"LayoutItemUUID",loading:s.value,search:ie.value,"onUpdate:options":be},ze({top:o(()=>[t(Ce,null,{default:o(()=>[t(ee,null,{default:o(()=>[t(P,{cols:"12",sm:"6",lg:"3"},{default:o(()=>[t(Te,{modelValue:Se.value,"onUpdate:modelValue":U[2]||(U[2]=g=>Se.value=g),label:"Search by Badge",clearable:!0,"hide-details":"",onInput:U[3]||(U[3]=g=>ie.value=Date.now().toString())},null,8,["modelValue"])]),_:1}),t(P,{cols:"12",sm:"6",lg:"3"},{default:o(()=>[t(Te,{modelValue:pe.value,"onUpdate:modelValue":U[4]||(U[4]=g=>pe.value=g),label:"Search By Email",clearable:!0,"hide-details":"",onInput:U[5]||(U[5]=g=>ie.value=Date.now().toString())},null,8,["modelValue"])]),_:1}),t(P,{cols:"12",sm:"6",lg:"3"},{default:o(()=>[t(oe,{modelValue:C.value,"onUpdate:modelValue":U[6]||(U[6]=g=>C.value=g),label:"Search By Group",clearable:!0,"hide-details":"",items:a.value,"item-value":"GroupUUID","item-title":"Name"},null,8,["modelValue","items"])]),_:1}),t(P,{cols:"12",sm:"6",lg:"3"},{default:o(()=>[t(oe,{modelValue:h.value,"onUpdate:modelValue":U[7]||(U[7]=g=>h.value=g),label:"Search By Tag",clearable:!0,"hide-details":"",items:A.value,"item-value":"TagUUID","item-title":"Title"},null,8,["modelValue","items"])]),_:1})]),_:1})]),_:1})]),_:2},[Z(R.headers,g=>({name:`item.${g.key}`,fn:o(({item:de})=>[t(Eo,{header:g,item:de,accommodations:I.value,convention:m.value,extras:$.value,interests:W.value,tickets:te.value,venues:z.value,onOpenActions:Ct,onOpenPayments:ht,onReload:U[8]||(U[8]=ae=>be({page:V.value,itemsPerPage:v.value,sortBy:O.value}))},null,8,["header","item","accommodations","convention","extras","interests","tickets","venues"])])}))]),1032,["items-per-page","sort-by","headers","items-length","items","loading","search"])]),_:2},1024)):j("",!0)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"]),G.value?(i(),H(Fa,{key:0,title:"Edit Layout",modelValue:G.value,"onUpdate:modelValue":U[12]||(U[12]=R=>G.value=R),layout:D.value,onSave:U[13]||(U[13]=R=>{G.value=!1,Ve()})},null,8,["modelValue","layout"])):j("",!0),ue.value?(i(),p(N,{key:1},[De.value?(i(),H(nn,{key:0,modelValue:De.value,"onUpdate:modelValue":U[14]||(U[14]=R=>De.value=R),registration:ue.value,"onUpdate:registration":U[15]||(U[15]=R=>ue.value=R),accommodations:I.value,convention:m.value,extras:$.value,forms:S.value,interests:W.value,tickets:te.value,title:"Registration Status & Communications",venues:z.value},null,8,["modelValue","registration","accommodations","convention","extras","forms","interests","tickets","venues"])):Re.value?(i(),H(on,{key:1,modelValue:Re.value,"onUpdate:modelValue":U[16]||(U[16]=R=>Re.value=R),registration:ue.value,"onUpdate:registration":U[17]||(U[17]=R=>ue.value=R),accommodations:I.value,convention:m.value,extras:$.value,forms:S.value,interests:W.value,tickets:te.value,title:"Registration Payments",venues:z.value},null,8,["modelValue","registration","accommodations","convention","extras","forms","interests","tickets","venues"])):j("",!0)],64)):j("",!0)]),_:1}))}});export{$n as default};
