import{p as L,r as f,s as P,c as p,a as re,w as U,o as ue,b as ie,d as w,u as ce,e as de,t as N,f as t,m as M,h as ve,i as G,j as me,k as $,l as O,n as h,q as y,v as u,x as j,y as J,z as ge,A as R,E as K,_ as Q,B as pe,C as x,D as W,F as fe,G as he,H as _e,I as X,J as Z,K as ye,L as Ve,T as ke}from"./index-33cb343b.js";import{G as be,R as D,a as Se}from"./userData-a2936c04.js";import{u as Ie}from"./useAvatar-33f6afb2.js";import{C as Te}from"./canEditOrganisation-afda20f6.js";import{G as A}from"./group-d2a77946.js";import{C as E}from"./canDo-99eb87c2.js";import{m as Ce,V as H,a as Pe}from"./VToolbar-93d0a800.js";import{V as Le}from"./scopeId-975c80a4.js";import{V as Re}from"./VTextField-1f630735.js";import{m as we,V as ee,u as Be}from"./VBtn-fa63250a.js";import{u as B,m as z,V as Ue,a as Y,b as Ne,c as xe,d as Ae,e as Ee,f as De,g as Oe,h as Me,i as Ge}from"./VContainer-e59a5738.js";import{m as ae,u as te,a as oe,c as le,V as ze,b as se}from"./VNavigationDrawer-a7dcc6ab.js";import{u as Fe,V as q,a as b,b as $e}from"./VList-649db363.js";import{V as ne,a as He}from"./VAvatar-97554375.js";import{V as Ye}from"./VDivider-6ad118e6.js";import{s as qe}from"./index-26b71cef.js";import"./nil-d01db1aa.js";import"./forwardRefs-cc622295.js";import"./createSimpleFunctional-9b9833fb.js";const je=(e,r=void 0)=>e===void 0?!1:r===void 0?E(e,A.GROUP_TYPE_CONVENTION).ManageUsers:E(e,A.GROUP_TYPE_CONVENTION,r.ConventionUUID,r).ManageUsers,Je=(e,r=void 0)=>{let o;return e===void 0?!1:(r===void 0?o=E(e,A.GROUP_TYPE_CONVENTION):o=E(e,A.GROUP_TYPE_CONVENTION,r.ConventionUUID,r),o.EditConvention||o.ManageViews||o.ViewRegistration||o.EditRegistration)};const Ke=L({scrollTarget:{type:String},scrollThreshold:{type:[String,Number],default:300}},"scroll");function Qe(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{canScroll:o}=r;let i=0;const l=f(null),a=P(0),s=P(0),d=P(0),g=P(!1),n=P(!1),m=p(()=>Number(e.scrollThreshold)),S=p(()=>re((m.value-a.value)/m.value||0)),_=()=>{const v=l.value;!v||o&&!o.value||(i=a.value,a.value="window"in v?v.pageYOffset:v.scrollTop,n.value=a.value<i,d.value=Math.abs(a.value-m.value))};return U(n,()=>{s.value=s.value||a.value}),U(g,()=>{s.value=0}),ue(()=>{U(()=>e.scrollTarget,v=>{var V;const I=v?document.querySelector(v):window;I&&I!==l.value&&((V=l.value)==null||V.removeEventListener("scroll",_),l.value=I,l.value.addEventListener("scroll",_,{passive:!0}))},{immediate:!0})}),ie(()=>{var v;(v=l.value)==null||v.removeEventListener("scroll",_)}),o&&U(o,_,{immediate:!0}),{scrollThreshold:m,currentScroll:a,currentThreshold:d,isScrollActive:g,scrollRatio:S,isScrollingUp:n,savedScroll:s}}const We=L({scrollBehavior:String,modelValue:{type:Boolean,default:!0},location:{type:String,default:"top",validator:e=>["top","bottom"].includes(e)},...Ce(),...ae(),...Ke(),height:{type:[Number,String],default:64}},"VAppBar"),Xe=w()({name:"VAppBar",props:We(),emits:{"update:modelValue":e=>!0},setup(e,r){let{slots:o}=r;const i=f(),l=ce(e,"modelValue"),a=p(()=>{var C;const c=new Set(((C=e.scrollBehavior)==null?void 0:C.split(" "))??[]);return{hide:c.has("hide"),inverted:c.has("inverted"),collapse:c.has("collapse"),elevate:c.has("elevate"),fadeImage:c.has("fade-image")}}),s=p(()=>{const c=a.value;return c.hide||c.inverted||c.collapse||c.elevate||c.fadeImage||!l.value}),{currentScroll:d,scrollThreshold:g,isScrollingUp:n,scrollRatio:m}=Qe(e,{canScroll:s}),S=p(()=>e.collapse||a.value.collapse&&(a.value.inverted?m.value>0:m.value===0)),_=p(()=>e.flat||a.value.elevate&&(a.value.inverted?d.value>0:d.value===0)),v=p(()=>a.value.fadeImage?a.value.inverted?1-m.value:m.value:void 0),I=p(()=>{var k,F;if(a.value.hide&&a.value.inverted)return 0;const c=((k=i.value)==null?void 0:k.contentHeight)??0,C=((F=i.value)==null?void 0:F.extensionHeight)??0;return c+C});de(p(()=>!!e.scrollBehavior),()=>{ve(()=>{a.value.hide?a.value.inverted?l.value=d.value>g.value:l.value=n.value||d.value<g.value:l.value=!0})});const{ssrBootStyles:V}=Fe(),{layoutItemStyles:T}=te({id:e.name,order:p(()=>parseInt(e.order,10)),position:N(e,"location"),layoutSize:I,elementSize:P(void 0),active:l,absolute:N(e,"absolute")});return B(()=>{const[c]=H.filterProps(e);return t(H,M({ref:i,class:["v-app-bar",{"v-app-bar--bottom":e.location==="bottom"},e.class],style:[{...T.value,"--v-toolbar-image-opacity":v.value,height:void 0,...V.value},e.style]},c,{collapse:S.value,flat:_.value}),o)}),{}}}),Ze=L({...we({icon:"$menu",variant:"text"})},"VAppBarNavIcon"),ea=w()({name:"VAppBarNavIcon",props:Ze(),setup(e,r){let{slots:o}=r;return B(()=>t(ee,M(e,{class:["v-app-bar-nav-icon"]}),o)),{}}});const aa=L({...z(),...oe()},"VLayout"),ta=w()({name:"VLayout",props:aa(),setup(e,r){let{slots:o}=r;const{layoutClasses:i,layoutStyles:l,getLayoutItem:a,items:s,layoutRef:d}=le(e);return B(()=>{var g;return t("div",{ref:d,class:[i.value,e.class],style:[l.value,e.style]},[(g=o.default)==null?void 0:g.call(o)])}),{getLayoutItem:a,items:s}}}),oa=G({__name:"DashboardLayout",props:{user:{}},setup(e){const r=Ie(),o=me(),i=f(!1),l=f("Default Title"),a=f(""),s=f($(e.user)),d=f(r(s.value.UserUUID));K.getInstance().on("user.profile.saved",V=>{s.value=$(V)});const n=f(localStorage.getItem("theme")||"light");o.global.name.value=n.value;const m=()=>{n.value=="light"?n.value="dark":n.value="light",o.global.name.value=n.value,localStorage.setItem("theme",n.value)},S=V=>{l.value=V},_=f(Je(e.user)),v=f(Te(e.user)),I=f(je(e.user));return(V,T)=>{const c=O("RouterLink"),C=O("RouterView");return h(),y(ta,{class:"h-100"},{default:u(()=>[t(Xe,{color:"blue-darken-3"},{default:u(()=>[t(Pe,null,{default:u(()=>[j(J(l.value),1)]),_:1}),t(Le),t(Re,{modelValue:a.value,"onUpdate:modelValue":T[0]||(T[0]=k=>a.value=k),"prepend-inner-icon":"mdi:mdi-magnify",label:"Search",variant:"underlined","hide-details":"",clearable:!0,class:"d-none"},null,8,["modelValue"]),t(ea,{variant:"text",onClick:T[1]||(T[1]=ge(k=>i.value=!i.value,["stop"]))})]),_:1}),t(ze,{modelValue:i.value,"onUpdate:modelValue":T[2]||(T[2]=k=>i.value=k),location:"right",temporary:!0},{default:u(()=>[t(q,null,{default:u(()=>[t(c,{to:{name:"Profile"}},{default:u(()=>[t(b,{title:s.value.DisplayName},{prepend:u(()=>[d.value?(h(),y(ne,{key:0,src:d.value,class:"rounded-circle mr-2",height:"32",width:"32"},null,8,["src"])):(h(),y(Ue,{key:1,icon:"mdi:mdi-account-circle",size:"x-large"}))]),_:1},8,["title"])]),_:1})]),_:1}),t(Ye),t(C,{name:"navigation"},{default:u(()=>[t(q,null,{default:u(()=>[t(c,{to:"/"},{default:u(()=>[t(b,{"prepend-icon":"mdi:mdi-view-dashboard-outline",title:"Home",value:"home"})]),_:1}),_.value||v.value||I.value?(h(),y($e,{key:0,value:"Admin"},{activator:u(({props:k})=>[t(b,M(k,{"prepend-icon":"mdi:mdi-security",title:"Admin"}),null,16)]),default:u(()=>[_.value?(h(),y(c,{key:0,to:"/admin/conventions"},{default:u(()=>[t(b,{"prepend-icon":"mdi:mdi-domain",title:"Conventions",value:"Conventions"})]),_:1})):R("",!0),v.value?(h(),y(c,{key:1,to:"/admin/organisations"},{default:u(()=>[t(b,{"prepend-icon":"mdi:mdi-store",title:"Organisations",value:"Organisations"})]),_:1})):R("",!0),I.value?(h(),y(c,{key:2,to:"/admin/groups"},{default:u(()=>[t(b,{"prepend-icon":"mdi:mdi-key-chain-variant",title:"Permissions",value:"Permissions"})]),_:1})):R("",!0)]),_:1})):R("",!0),t(c,{to:{name:"Profile"}},{default:u(()=>[t(b,{"prepend-icon":"mdi:mdi-account-circle",title:"Manage Account"})]),_:1}),t(b,{"prepend-icon":"mdi:mdi-theme-light-dark",onClick:m,title:`${n.value=="light"?"Dark":"Light"} Mode`},null,8,["title"]),t(c,{to:"/logout"},{default:u(()=>[t(b,{"prepend-icon":"mdi:mdi-logout",title:"Logout",value:"Logout"})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(se,null,{default:u(()=>[t(C,{onPageTitle:S,"logged-in":!0})]),_:1})]),_:1})}}});const la=Q(oa,[["__scopeId","data-v-f313e5f1"]]),sa="/assets/scotiacon-logo-d965f8b6.svg",na=e=>(he("data-v-5faec46d"),e=e(),_e(),e),ra=na(()=>W("h1",null,"Scotiacon Registration System",-1)),ua=G({__name:"LoginLayout",setup(e){return(r,o)=>{const i=O("RouterView");return h(),pe(fe,null,[t(Y,{class:"logo-container text-center"},{default:u(()=>[t(ne,{src:x(sa),class:"scotiacon-logo ma-auto"},null,8,["src"]),ra]),_:1}),t(Y,{class:"login-container text-center mb-0 rounded rounded-lg mb-md-10"},{default:u(()=>[t(He,null,{default:u(()=>[t(ee,{class:"ma-2",color:"indigo",icon:"mdi:mdi-lock-outline"})]),_:1}),W("h2",null,J(x(qe).headingSignIn),1),t(i,{"logged-in":!1})]),_:1})],64)}}});const ia=Q(ua,[["__scopeId","data-v-5faec46d"]]);const ca=L({...z(),...oe({fullHeight:!0}),...X()},"VApp"),da=w()({name:"VApp",props:ca(),setup(e,r){let{slots:o}=r;const i=Z(e),{layoutClasses:l,layoutStyles:a,getLayoutItem:s,items:d,layoutRef:g}=le(e),{rtlClasses:n}=ye();return B(()=>{var m;return t("div",{ref:g,class:["v-application",i.themeClasses.value,l.value,n.value,e.class],style:[a.value,e.style]},[t("div",{class:"v-application__wrap"},[(m=o.default)==null?void 0:m.call(o)])])}),{getLayoutItem:s,items:d,theme:i}}});const va=L({app:Boolean,color:String,height:{type:[Number,String],default:"auto"},...Ne(),...z(),...xe(),...ae(),...Ae(),...Ee({tag:"footer"}),...X()},"VFooter"),ma=w()({name:"VFooter",props:va(),setup(e,r){let{slots:o}=r;const{themeClasses:i}=Z(e),{backgroundColorClasses:l,backgroundColorStyles:a}=De(N(e,"color")),{borderClasses:s}=Oe(e),{elevationClasses:d}=Me(e),{roundedClasses:g}=Ge(e),n=P(32),{resizeRef:m}=Be(v=>{v.length&&(n.value=v[0].target.clientHeight)}),S=p(()=>e.height==="auto"?n.value:parseInt(e.height,10)),{layoutItemStyles:_}=te({id:e.name,order:p(()=>parseInt(e.order,10)),position:p(()=>"bottom"),layoutSize:S,elementSize:p(()=>e.height==="auto"?void 0:S.value),active:p(()=>e.app),absolute:N(e,"absolute")});return B(()=>t(e.tag,{ref:m,class:["v-footer",i.value,l.value,s.value,d.value,g.value,e.class],style:[a.value,e.app?_.value:{height:Ve(e.height)},e.style]},o)),{}}}),Na=G({__name:"Default",emits:["pageTitle"],setup(e,{emit:r}){let o=be();const i=ke.getInstance(),l=i.getTokenByService("GrazeAPI"),a=f(!1),s=f(!1),d=K.getInstance();d.on("login",n=>{o=n,a.value=!0}),d.on("logout",()=>{o=void 0,a.value=!1}),d.on("tokenManager.tokenUpdated",()=>{a.value=!0,s.value=!0}),d.on("tokenManager.sessionExpired",()=>{a.value=!1,s.value=!1,D(),location.reload()}),l?o?l.AccessExpires<=Date.now()&&l.RefreshExpires>Date.now()?i.refreshToken(l):l.AccessExpires>Date.now()?(D(),a.value=!1,s.value=!0):(a.value=!0,s.value=!0):Se().then(n=>{o=n,a.value=!0,s.value=!0}).catch(()=>{a.value=!1,s.value=!0}):(D(),a.value=!1,s.value=!0);const g=n=>{r("pageTitle",n)};return(n,m)=>(h(),y(da,{class:"bg-image"},{default:u(()=>[s.value?(h(),y(se,{key:0},{default:u(()=>[a.value&&x(o)?(h(),y(la,{key:0,user:x(o),onPageTitle:g},null,8,["user"])):(h(),y(ia,{key:1}))]),_:1})):R("",!0),t(ma,null,{default:u(()=>[j(" Powered by Graze ")]),_:1})]),_:1}))}});export{Na as default};
