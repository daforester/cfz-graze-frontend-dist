import{p as ta,n as aa,e as ie,t as Ae,c as Fa,G as St,v as t,H as P,x as Ve,I as z,a0 as ee,a1 as ve,r as f,K as pe,w as de,M as u,N as O,O as a,W as k,X as F,Q as C,V as E,a4 as W,P as h,S as $,a3 as _e,_ as mt,ac as $a,ad as xa,E as Qe,k as Ba,f as Ga,d as Ya,o as Ha,ae as Bt,a2 as We,R as Rt,Y as la,Z as na,aa as at,af as qa,ag as st,z as ja,u as za,ah as Ka,A as Qa,B as Wa,D as Ja,s as Xa,ai as ut,aj as Gt,a7 as Za,a6 as el,U as tl}from"./index-6daae48f.js";import{T as al,V as oa,e as ll,d as nl,c as ol}from"./FormRenderer.vue_vue_type_style_index_0_lang-86477d98.js";import{F as Te,a as il}from"./form-3a7bf7fd.js";import{u as nt,V as ia}from"./VCheckbox-09fb161a.js";import{_ as Je}from"./ModelDialog.vue_vue_type_script_setup_true_lang-dafda1da.js";import{h as tt,b as sa,a as sl,c as ul,d as Yt,P as Ct,u as ua}from"./useDisplayTransactions-2a1d8f2b.js";import{V as j,a as b}from"./VRow-4716a137.js";import{V as Ke,a as $e,c as ra}from"./VList-0f2a282b.js";import{V as Ue}from"./copyToClipboard-1cf38782.js";import{u as da,j as ge,V as rt,b as rl,m as dl,k as ml,c as cl,d as vl,l as fl,a as Ul,n as gl}from"./VContainer-aed80aaf.js";import{V as H,a as pl,u as _l}from"./VBtn-94079d62.js";import{b as Al,c as ma,S as Tl,d as Ht}from"./submission-6136b51d.js";import{G as Ot}from"./group-d2a77946.js";import{C as ht}from"./canDo-c4127599.js";import{V as ca}from"./VAvatar-6d7dcdd9.js";import{v as Ie}from"./v4-a960c1f4.js";import{s as yl}from"./sortSubmissions-4bc1d48e.js";import{a as va,V as xe}from"./scopeId-d8b04555.js";import{m as Il,k as Dl,l as El,n as Sl,o as Rl,p as Cl,q as Vl,u as bl,r as Ol,s as hl,t as kl,v as Ml,w as Nl,x as Ll,y as wl,z as qt,A as jt,B as zt,g as fa,h as Ua,c as ct,d as vt,e as kt,b as ft,V as Ut,a as ga,_ as pa,j as _a,i as Fe,f as Vt}from"./VWindowItem-94601557.js";import{V as Be,b as Xe,c as Ge,d as Mt,e as he}from"./VCard-a30e61ce.js";import{_ as lt,V as Aa}from"./SaveButton.vue_vue_type_script_setup_true_lang-03a1dcbf.js";import{V as te}from"./VTextField-8dd28dd4.js";import{_ as Ta}from"./DeleteDialog.vue_vue_type_script_setup_true_lang-eb95a1ba.js";import{a as ya,V as bt}from"./VToolbar-5202b85e.js";import{V as Pl}from"./VDivider-4365849f.js";import{V as Fl}from"./VTextarea-ac9f589c.js";import{V as $l,a as xl}from"./VChip-1349c7a7.js";import{V as dt}from"./VDialog-e8680f37.js";import{V as Bl}from"./VForm-814be15f.js";import{G as Nt}from"./userData-9bd2772d.js";import{V as Gl,a as Yl}from"./VAlert-a38b855b.js";import{S as Hl}from"./setupLogin-f0821127.js";import{V as ql}from"./forwardRefs-4c173420.js";import{u as Dt}from"./nil-d01db1aa.js";import{V as Kt,a as jl}from"./VTable-48eaad60.js";import"./index-26b71cef.js";import"./VFileInput-69004c01.js";import"./createSimpleFunctional-089816d8.js";import"./VToolbarItems-d1ea0ce3.js";var Oe=(e=>(e.ADMIN_LAYOUT_PANELS="ADMIN_LAYOUT_PANELS",e.ADMIN_LAYOUT_TABLE="ADMIN_LAYOUT_TABLE",e))(Oe||{});const zl=[{title:"Panel Layout",value:"ADMIN_LAYOUT_PANELS"},{title:"Table Layout",value:"ADMIN_LAYOUT_TABLE"}];var be=(e=>(e.LAYOUT_ITEM_SOURCE_FORM="LAYOUT_ITEM_SOURCE_FORM",e.LAYOUT_ITEM_SOURCE_META="LAYOUT_ITEM_SOURCE_META",e.LAYOUT_ITEM_SOURCE_USER="LAYOUT_ITEM_SOURCE_USER",e))(be||{});const Kl=[{title:"Form Field Submission Data",value:"LAYOUT_ITEM_SOURCE_FORM"},{title:"Miscellaneous Data",value:"LAYOUT_ITEM_SOURCE_META"},{title:"User Profile Data",value:"LAYOUT_ITEM_SOURCE_USER"}];var Z=(e=>(e.META_DATA_SOURCE_ACCOMMODATION_ALLOCATION="META_DATA_SOURCE_ACCOMMODATION_ALLOCATION",e.META_DATA_SOURCE_ACCOMMODATION_FORM="META_DATA_SOURCE_ACCOMMODATION_FORM",e.META_DATA_SOURCE_ADMIN_FORM="META_DATA_SOURCE_ADMIN_FORM",e.META_DATA_SOURCE_BADGE_FORM="META_DATA_SOURCE_BADGE_FORM",e.META_DATA_SOURCE_DATA_LAYOUT="META_DATA_SOURCE_DATA_LAYOUT",e.META_DATA_SOURCE_DEALER_FORM="META_DATA_SOURCE_DEALER_FORM",e.META_DATA_SOURCE_PAYMENT_STATUS="META_DATA_SOURCE_PAYMENT_STATUS",e.META_DATA_SOURCE_REGISTRATION_ACTIONS="META_DATA_SOURCE_REGISTRATION_ACTIONS",e.META_DATA_SOURCE_REGISTRATION_FORM="META_DATA_SOURCE_REGISTRATION_FORM",e.META_DATA_SOURCE_REGISTRATION_GROUP="META_DATA_SOURCE_REGISTRATION_GROUP",e.META_DATA_SOURCE_REGISTRATION_REFERENCE="META_DATA_SOURCE_REGISTRATION_REFERENCE",e.META_DATA_SOURCE_SUBMISSION_DATE="META_DATA_SOURCE_SUBMISSION_DATE",e.META_DATA_SOURCE_SUBMISSION_STATUS="META_DATA_SOURCE_SUBMISSION_STATUS",e))(Z||{});const Ql=[{title:"Accommodation Allocation",value:"META_DATA_SOURCE_ACCOMMODATION_ALLOCATION"},{title:"Accommodation Form",value:"META_DATA_SOURCE_ACCOMMODATION_FORM"},{title:"Actions",value:"META_DATA_SOURCE_REGISTRATION_ACTIONS"},{title:"Badge Form",value:"META_DATA_SOURCE_BADGE_FORM"},{title:"Data Display",value:"META_DATA_SOURCE_DATA_LAYOUT"},{title:"Dealer Form",value:"META_DATA_SOURCE_DEALER_FORM"},{title:"Payment Status",value:"META_DATA_SOURCE_PAYMENT_STATUS"},{title:"Registration Group",value:"META_DATA_SOURCE_REGISTRATION_GROUP"},{title:"Registration Reference",value:"META_DATA_SOURCE_REGISTRATION_REFERENCE"},{title:"Registration Form",value:"META_DATA_SOURCE_REGISTRATION_FORM"},{title:"Submission Date",value:"META_DATA_SOURCE_SUBMISSION_DATE"},{title:"Submission Status",value:"META_DATA_SOURCE_SUBMISSION_STATUS"}];var ue=(e=>(e.USER_DATA_SOURCE_NULL="",e.USER_DATA_SOURCE_DISPLAY_NAME="USER_DATA_SOURCE_DISPLAY_NAME",e.USER_DATA_SOURCE_HANDLE="USER_DATA_SOURCE_HANDLE",e.USER_DATA_SOURCE_AVATAR="USER_DATA_SOURCE_AVATAR",e.USER_DATA_SOURCE_FIRST_NAME="USER_DATA_SOURCE_FIRST_NAME",e.USER_DATA_SOURCE_LAST_NAME="USER_DATA_SOURCE_LAST_NAME",e.USER_DATA_SOURCE_DATE_OF_BIRTH="USER_DATA_SOURCE_DATE_OF_BIRTH",e.USER_DATA_SOURCE_EMAIL="USER_DATA_SOURCE_EMAIL",e.USER_DATA_SOURCE_TELEGRAM="USER_DATA_SOURCE_TELEGRAM",e))(ue||{});const Wl=[{title:"Display Name",value:"USER_DATA_SOURCE_DISPLAY_NAME"},{title:"Handle",value:"USER_DATA_SOURCE_HANDLE"},{title:"Avatar",value:"USER_DATA_SOURCE_AVATAR"},{title:"First Name",value:"USER_DATA_SOURCE_FIRST_NAME"},{title:"Last Name",value:"USER_DATA_SOURCE_LAST_NAME"},{title:"Date of Birth",value:"USER_DATA_SOURCE_DATE_OF_BIRTH"},{title:"Email Address",value:"USER_DATA_SOURCE_EMAIL"},{title:"Telegram Username",value:"USER_DATA_SOURCE_TELEGRAM"}],Jl=e=>{switch(e){case"EMAIL_STATUS_QUEUED":return"Queued";case"EMAIL_STATUS_QUEUE_ERROR":return"Processing";case"EMAIL_STATUS_QUEUE_FAILURE":return"Internal Error";case"EMAIL_STATUS_SENDING":return"Sending";case"EMAIL_STATUS_SENT":return"Sent";case"EMAIL_STATUS_SEND_ERROR":return"Failed to Send"}return"Unknown"},Xl=e=>e===void 0?!1:ht(e,Ot.GROUP_TYPE_SYSTEM).ManageUsers,Zl=ta({itemsLength:{type:[Number,String],required:!0},...Il(),...Dl(),...El()},"VDataTableServer"),en=aa()({name:"VDataTableServer",props:Zl(),emits:{"update:modelValue":e=>!0,"update:page":e=>!0,"update:itemsPerPage":e=>!0,"update:sortBy":e=>!0,"update:options":e=>!0,"update:expanded":e=>!0,"update:groupBy":e=>!0,"click:row":(e,d)=>!0},setup(e,d){let{emit:o,slots:i}=d;const{groupBy:n}=Sl(e),{sortBy:m,multiSort:l,mustSort:s}=Rl(e),{page:r,itemsPerPage:T}=Cl(e),g=ie(()=>parseInt(e.itemsLength,10)),{columns:A,headers:c}=Vl(e,{groupBy:n,showSelect:Ae(e,"showSelect"),showExpand:Ae(e,"showExpand")}),{items:v}=bl(e,A),{toggleSort:U}=Ol({sortBy:m,multiSort:l,mustSort:s,page:r}),{opened:N,isGroupOpen:K,toggleGroup:p,extractRows:M}=hl({groupBy:n,sortBy:m}),{pageCount:V,setItemsPerPage:ae}=kl({page:r,itemsPerPage:T,itemsLength:g}),{flatItems:x}=Ml(v,n,N),{isSelected:ne,select:J,selectAll:I,toggleSelect:D,someSelected:S,allSelected:L}=Nl(e,{allItems:v,currentPage:v}),{isExpanded:B,toggleExpand:le}=Ll(e),fe=ie(()=>M(v.value));wl({page:r,itemsPerPage:T,sortBy:m,groupBy:n,search:Ae(e,"search")}),Fa("v-data-table",{toggleSort:U,sortBy:m}),St({VDataTableRows:{hideNoData:Ae(e,"hideNoData"),noDataText:Ae(e,"noDataText"),loading:Ae(e,"loading"),loadingText:Ae(e,"loadingText")}});const me=ie(()=>({page:r.value,itemsPerPage:T.value,sortBy:m.value,pageCount:V.value,toggleSort:U,setItemsPerPage:ae,someSelected:S.value,allSelected:L.value,isSelected:ne,select:J,selectAll:I,toggleSelect:D,isExpanded:B,toggleExpand:le,isGroupOpen:K,toggleGroup:p,items:fe.value,groupedItems:x.value,columns:A.value,headers:c.value}));da(()=>{const[Ye]=qt.filterProps(e),[He]=jt.filterProps(e),[Ze]=zt.filterProps(e),[qe]=Kt.filterProps(e);return t(Kt,Ve({class:["v-data-table",{"v-data-table--loading":e.loading},e.class],style:e.style},qe),{top:()=>{var De;return(De=i.top)==null?void 0:De.call(i,me.value)},default:()=>{var De,ke,Me,Ne;return i.default?i.default(me.value):t(P,null,[(De=i.colgroup)==null?void 0:De.call(i,me.value),t("thead",{class:"v-data-table__thead",role:"rowgroup"},[t(jt,Ve(He,{sticky:e.fixedHeader}),i)]),(ke=i.thead)==null?void 0:ke.call(i,me.value),t("tbody",{class:"v-data-table__tbody",role:"rowgroup"},[i.body?i.body(me.value):t(zt,Ve(Ze,{items:x.value}),i)]),(Me=i.tbody)==null?void 0:Me.call(i,me.value),(Ne=i.tfoot)==null?void 0:Ne.call(i,me.value)])},bottom:()=>i.bottom?i.bottom(me.value):t(qt,Ye,{prepend:i["footer.prepend"]})})})}}),tn=F("br",null,null,-1),an=F("h3",null,"Assigned Accommodation",-1),ln=F("br",null,null,-1),nn=F("br",null,null,-1),on=F("h3",null,"Accommodation Preferences",-1),sn=F("h3",null,"Selected Tickets",-1),un=F("br",null,null,-1),rn=z({__name:"EditAccommodationAssignmentDialog",props:ee({convention:{},registration:{},selectedAccommodation:{},title:{}},{modelValue:{type:Boolean,required:!0}}),emits:ee(["update:field"],["update:modelValue"]),setup(e,{emit:d}){const o=e,{convention:i,registration:n,title:m=""}=o,l=_e(),s=ve(e,"modelValue"),r=f({capacity:{max:I=>{var L;const D=V.value.find(B=>B.room.RoomUUID===I);return!D||D.room.MaximumCapacity===0?!0:(((L=c.value)==null?void 0:L.Members.length)||0)<=D.room.MaximumCapacity||"Too many people in the group for this room"},min:I=>{var L;const D=V.value.find(B=>B.room.RoomUUID===I);return!D||D.room.MinimumCapacity===0?!0:(((L=c.value)==null?void 0:L.Members.length)||0)>=D.room.MinimumCapacity||"Not enough people in the group for this room"}}}),T=f([]),g=nt(o,d,void 0,void 0,"field"),A=f(pe(g.value));de(g,()=>{A.value=pe(g.value)});const c=f(),v=f(""),U=f(""),N=f([]),K=f({Ticket:[],AddonsChecked:[],ComponentsChecked:[]}),p=async()=>{var L;const I=await l.getConventionAvailableAccommodation(i.ConventionUUID);I&&(T.value=I);const D=await l.getRegistrationGroup(n.RegistrationUUID||"");D&&(c.value=D);const S=await l.getConventionTickets(i.ConventionUUID);S&&(N.value=S);try{K.value=JSON.parse(((L=c.value)==null?void 0:L.TicketData)||"")}catch{}};de(v,()=>{U.value=V.value.length>0?V.value[0].value:""});const M=ie(()=>{const I=ae.value;return T.value.map(D=>{let S;return I.forEach(L=>{D.Costs.forEach(B=>{B.DateStart===(L==null?void 0:L.DateStart)&&B.DateEnd===L.DateEnd&&(S===void 0||S>B.Availability)&&(S=B.Availability)})}),{label:`${D.Name}`,title:`${D.Name} (${S} Available)`,value:D.AccommodationUUID}})}),V=ie(()=>{const I=ae.value,D=T.value.find(S=>S.AccommodationUUID===v.value);return(D==null?void 0:D.Pool.map(S=>{var B,le;let L;return I.forEach(fe=>{S.Costs.forEach(me=>{me.DateStart===(fe==null?void 0:fe.DateStart)&&me.DateEnd===fe.DateEnd&&(L===void 0||L>me.Availability)&&(L=me.Availability)})}),{label:`${(B=S.Venue)==null?void 0:B.Name} - ${S.Name}`,title:`${(le=S.Venue)==null?void 0:le.Name} - ${S.Name} (${L} Available)`,value:S.RoomUUID,room:S}}))||[]}),ae=ie(()=>[...K.value.Ticket,...K.value.AddonsChecked,...K.value.ComponentsChecked].map(I=>N.value.find(D=>D.TicketUUID===I)).filter(I=>I!==void 0&&I.RequiresAccommodation)),x=I=>{var D;l.assignAccommodation(((D=c.value)==null?void 0:D.Registration.RegistrationUUID)||"",v.value,U.value,!1).then(S=>{S?(p(),I&&I("Room Assigned")):I&&I("Room not assigned")}).catch(()=>{I&&I("Room not assigned")})},ne=I=>{var D,S;(D=c.value)!=null&&D.Registration.AllocationUUID?l.deleteAllocation(((S=c.value)==null?void 0:S.Registration.AllocationUUID)||"").then(L=>{L?(p(),I&&I("Allocation Deleted")):I&&I("Allocation not deleted")}).catch(()=>{I&&I("Allocation not deleted")}):I&&I("Nothing to Delete")},J=I=>{var S,L;const D=(S=T.value.find(B=>B.AccommodationUUID===I.AccommodationUUID))==null?void 0:S.Pool;if(D){const B=D.find(le=>le.RoomUUID===I.RoomUUID);if(B)return`${(L=B.Venue)==null?void 0:L.Name} - ${B.Name}`}return""};return p(),(I,D)=>{var S;return u(),O(Je,{modelValue:s.value,"onUpdate:modelValue":D[2]||(D[2]=L=>s.value=L),title:k(m),color:"primary","show-close-action":!0,"show-delete-action":!!((S=c.value)!=null&&S.Registration.Allocation),"show-save-action":!!U.value,"save-button-label":"Assign Room",onDelete:ne,onSave:x,fullscreen:!0,persistent:!0},{default:a(()=>[t(ge,{class:"pa-0",fluid:!0},{default:a(()=>[t(j,null,{default:a(()=>{var L;return[t(b,{cols:"12",md:"6"},{default:a(()=>{var B,le;return[F("h3",null,"Group Members ("+C((B=c.value)==null?void 0:B.Members.length)+")",1),(u(!0),E(P,null,W((le=c.value)==null?void 0:le.Members,fe=>(u(),E(P,{key:fe.UUID},[h(" #"+C(fe.Reference)+" "+C(fe.Name),1),tn],64))),128))]}),_:1}),(L=c.value)!=null&&L.Registration.Allocation?(u(),O(b,{key:0,cols:"12",md:"6"},{default:a(()=>[an,t(Ke,null,{default:a(()=>{var B;return[(u(!0),E(P,null,W((B=c.value)==null?void 0:B.Registration.Allocation.Periods,le=>(u(),O($e,{key:le.AllocationPeriodUUID},{default:a(()=>{var fe;return[h(C((fe=T.value.find(me=>me.AccommodationUUID===le.AccommodationUUID))==null?void 0:fe.Name)+" ",1),ln,h(" "+C(J(le))+" ",1),nn,F("small",null,"("+C(k(tt)(le.DateStart))+" - "+C(k(tt)(le.DateEnd))+")",1)]}),_:2},1024))),128))]}),_:1})]),_:1})):$("",!0)]}),_:1}),t(j,null,{default:a(()=>[t(b,{cols:"12",md:"6"},{default:a(()=>[I.selectedAccommodation.length?(u(),E(P,{key:0},[on,t(Ke,null,{default:a(()=>[(u(!0),E(P,null,W(I.selectedAccommodation,(L,B)=>(u(),O($e,{key:L.AccommodationUUID},{default:a(()=>[h(C(B+1)+". "+C(L.Name),1)]),_:2},1024))),128))]),_:1})],64)):$("",!0)]),_:1}),t(b,{cosl:"12",md:"6"},{default:a(()=>[sn,t(Ke,null,{default:a(()=>[(u(!0),E(P,null,W(ae.value,L=>(u(),O($e,{key:L==null?void 0:L.TicketUUID},{default:a(()=>[h(C(L.Name)+" ",1),un,F("small",null,"("+C(k(tt)(L.DateStart))+" - "+C(k(tt)(L.DateEnd))+")",1)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1}),t(j,null,{default:a(()=>[t(b,{cols:"12",md:"6"},{default:a(()=>[t(Ue,{modelValue:v.value,"onUpdate:modelValue":D[0]||(D[0]=L=>v.value=L),items:M.value,"item-title":"title","item-value":"value",label:"Accommodation"},null,8,["modelValue","items"])]),_:1}),t(b,{cols:"12",md:"6"},{default:a(()=>[t(Ue,{modelValue:U.value,"onUpdate:modelValue":D[1]||(D[1]=L=>U.value=L),items:V.value,"item-title":"title","item-value":"value",label:"Room Pool",rules:[r.value.capacity.min,r.value.capacity.max]},null,8,["modelValue","items","rules"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue","title","show-delete-action","show-save-action"])}}}),dn={key:0,class:"accommodationList"},mn={key:0,class:"text-orange-darken-2"},cn=z({__name:"DataTableItemAccommodation",props:{accommodations:{default:()=>[]},convention:{},forms:{},registration:{},tickets:{default:()=>[]},value:{default:""},venues:{}},setup(e){const d=f(!1),o=ie(()=>{if(!e.value)return[];const n=JSON.parse(e.value),m=e.accommodations.filter(l=>n.includes(l.AccommodationUUID)).sort((l,s)=>{const r=n.findIndex(g=>g===l.AccommodationUUID),T=n.findIndex(g=>g===s.AccommodationUUID);return r>T?1:-1});return pe(m)}),i=ie(()=>{let n;const m=e.forms.find(l=>l.Sections.find(s=>{var r;return(r=s.Fields)==null?void 0:r.find(T=>{var g;if(((g=T.Field)==null?void 0:g.Type)==="TICKET")return n=T,!0})}));return n?!!e.registration.Submissions.find(l=>{if(l.FormUUID==(m==null?void 0:m.FormUUID))return l.Data.find(s=>{if(s.SectionFieldUUID==(n==null?void 0:n.SectionFieldUUID)){const r=JSON.parse(s.Data);return e.tickets.filter(T=>T.RequiresAccommodation).find(T=>r.Ticket.includes(T.TicketUUID)||r.AddonsChecked.includes(T.TicketUUID)||r.ComponentsChecked.includes(T.TicketUUID))}})}):!1});return(n,m)=>i.value?(u(),E(P,{key:0},[n.value?(u(),E("ol",dn,[(u(!0),E(P,null,W(o.value,l=>(u(),E("li",{key:l.AccommodationUUID},[n.registration&&n.registration.Allocation&&n.registration.Allocation.Periods.find(s=>s.AccommodationUUID===l.AccommodationUUID)?(u(),E("strong",mn,C(l.Name),1)):(u(),E(P,{key:1},[h(C(l.Name),1)],64))]))),128))])):$("",!0),t(H,{onClick:m[0]||(m[0]=l=>d.value=!0),variant:"flat",color:"success"},{default:a(()=>[h("Assign Accommodation")]),_:1}),n.convention&&d.value?(u(),O(rn,{key:1,modelValue:d.value,"onUpdate:modelValue":m[1]||(m[1]=l=>d.value=l),title:"Accommodation Allocation",convention:n.convention,registration:n.registration,tickets:n.tickets,"selected-accommodation":o.value},null,8,["modelValue","convention","registration","tickets","selected-accommodation"])):$("",!0)],64)):$("",!0)}});const Ia=mt(cn,[["__scopeId","data-v-4c522592"]]),vn={key:0,class:"addonList"},fn={key:0},Un={key:0},gn=z({__name:"DataTableItemExtras",props:{extras:{default:()=>[]},value:{default:""}},setup(e){const d=ie(()=>{if(!e.value)return;const o=JSON.parse(e.value),i=Object.keys(o),n=pe(e.extras);return n.forEach(m=>{m.Options=m.Options.filter(l=>i.includes(l.OptionUUID)?(l.Choices=l.Choices.filter(s=>s.TagUUID===o[l.OptionUUID].choiceId),o[l.OptionUUID].checked):!1)}),n.filter(m=>m.Options.length>0),n});return(o,i)=>o.value?(u(),E("ul",vn,[(u(!0),E(P,null,W(d.value,n=>(u(),E(P,{key:n.ExtraUUID},[n.Options.length?(u(),E("li",fn,[F("strong",null,C(n.Name),1),F("ul",null,[(u(!0),E(P,null,W(n.Options,m=>(u(),E("li",{key:m.OptionUUID},[h(C(m.Name)+" ",1),m.Choices.length==1?(u(),E("small",Un,"("+C(m.Choices[0].Title)+")",1)):$("",!0)]))),128))])])):$("",!0)],64))),128))])):$("",!0)}});const Da=mt(gn,[["__scopeId","data-v-55786e01"]]),pn={key:0},_n=z({__name:"DataTableItemInterests",props:{interests:{default:()=>[]},value:{default:""}},setup(e){const d=ie(()=>{if(!e.value)return;const o=JSON.parse(e.value);return Object.entries(o).filter(([,i])=>i).map(([i,n])=>e.interests.find(m=>m.InterestUUID===i)).filter(i=>i!==void 0)});return(o,i)=>o.value?(u(),E("ul",pn,[(u(!0),E(P,null,W(d.value,n=>(u(),E("li",{key:n.InterestUUID},C(n.Name),1))),128))])):$("",!0)}}),An=F("br",null,null,-1),Tn=F("small",null,"Options:",-1),yn=F("br",null,null,-1),In=F("small",null,"Addons:",-1),Ea=z({__name:"DataTableItemTicket",props:{tickets:{default:()=>[]},value:{default:""}},setup(e){const d=ie(()=>{if(!e.value)return;let o={Ticket:[],AddonsChecked:[],ComponentsChecked:[]};try{o=JSON.parse(e.value),"ticket"in o&&(o.Ticket=o.ticket),"addonsChecked"in o&&(o.AddonsChecked=o.addonsChecked),"componentsChecked"in o&&(o.ComponentsChecked=o.componentsChecked)}catch{}return o.Ticket.filter(i=>{const n=e.tickets.find(m=>m.TicketUUID===i);return!(!n||n.Type!==al.TICKET_TYPE_TICKET)}).map(i=>{const n=e.tickets.find(l=>l.TicketUUID===i),m=pe(n);return m.TicketComponents=n.TicketComponents.filter(l=>o.ComponentsChecked.includes(l.TicketUUID)),m.AddonTickets=n.AddonTickets.filter(l=>o.AddonsChecked.includes(l.TicketUUID)),m})});return(o,i)=>o.value?(u(!0),E(P,{key:0},W(d.value,n=>(u(),E("div",{key:n.TicketUUID},[F("strong",null,C(n.Name),1),n.TicketComponents.length>0?(u(),E(P,{key:0},[An,Tn,h("  "),(u(!0),E(P,null,W(n.TicketComponents,m=>(u(),E(P,{key:m.TicketUUID},[F("small",null,C(m.Name),1),h("  ")],64))),128))],64)):$("",!0),n.AddonTickets.length>0?(u(),E(P,{key:1},[yn,In,h("  "),(u(!0),E(P,null,W(n.AddonTickets,m=>(u(),E("small",{key:m.TicketUUID},[h("("),F("em",null,C(m.Name),1),h(")")]))),128))],64)):$("",!0)]))),128)):$("",!0)}}),Dn=z({__name:"DataPanelAccommodation",props:ee({accommodations:{},convention:{},data:{},forms:{},tickets:{},venues:{},registration:{}},{modelValue:{required:!0}}),emits:["update:modelValue"],setup(e){return ve(e,"modelValue"),(d,o)=>(u(),E("div",null,[t(Ia,{value:d.data,accommodations:d.accommodations,convention:d.convention,forms:d.forms,registration:d.registration,tickets:d.tickets,venues:d.venues},null,8,["value","accommodations","convention","forms","registration","tickets","venues"])]))}}),En={key:3},Sn=z({__name:"FormDataItem",props:ee({accommodations:{},convention:{},extras:{},forms:{},tickets:{},venues:{},registration:{}},{modelValue:{required:!0}}),emits:["update:modelValue"],setup(e){const d=ve(e,"modelValue"),o=ie(()=>{var l,s,r,T;const n=d.value,m=()=>{var g;for(let A=0;A<e.forms.length;A+=1)for(let c=0;c<e.forms[A].Sections.length;c+=1)if(e.forms[A].Sections[c].Fields){const v=(g=e.forms[A].Sections[c].Fields)==null?void 0:g.find(U=>U.SectionFieldUUID===n.SectionFieldUUID);if(v)return v}};return((s=(l=n.SectionField)==null?void 0:l.Field)==null?void 0:s.Type)||((T=(r=m())==null?void 0:r.Field)==null?void 0:T.Type)}),i=ie(()=>{for(let n=0;n<e.registration.Submissions.length;n+=1){const l=e.registration.Submissions[n].Data.find(s=>s.SectionFieldUUID===d.value.SectionFieldUUID);if(l)return l.Data}return""});return(n,m)=>o.value==="ACCOMMODATION"?(u(),O(Dn,{key:0,convention:n.convention,tickets:n.tickets,accommodations:n.accommodations,venues:n.venues,registration:n.registration,forms:n.forms,modelValue:d.value,"onUpdate:modelValue":m[0]||(m[0]=l=>d.value=l),data:i.value},null,8,["convention","tickets","accommodations","venues","registration","forms","modelValue","data"])):o.value==="EXTRAS"?(u(),O(Da,{key:1,value:i.value,extras:n.extras},null,8,["value","extras"])):o.value==="TICKET"?(u(),O(Ea,{key:2,value:i.value,tickets:n.tickets},null,8,["value","tickets"])):(u(),E("div",En,C(i.value),1))}}),Rn={key:0},Cn={key:0},Vn=F("strong",null,"Total:",-1),bn=z({__name:"DataPanelRegistrationGroup",props:{registration:{}},setup(e){const d=ie(()=>{const o=[];let i;return e.registration.Leader?i=e.registration:i=e.registration.Primary,o.push({Name:i.User.DisplayName,UUID:i.UserUUID,UserUUID:i.User.UserUUID,IsLeader:!0,Reference:i.Reference,Paid:i.Paid,Total:i.Total}),o.push(...i.Members.map(n=>({Name:n.User.DisplayName,UUID:n.UserUUID,UserUUID:n.User.UserUUID,IsLeader:!1,Reference:n.Reference,Paid:n.Paid,Total:n.Total}))),o});return(o,i)=>o.registration.Members.length===0&&!o.registration.Primary?(u(),E("em",Rn," Not in a group ")):(u(),E(P,{key:1},[F("ul",null,[(u(!0),E(P,null,W(d.value,n=>(u(),E("li",{key:n.UUID,class:"ml-0"},[h(" #"+C(n.Reference)+" : "+C(n.Name)+" ",1),n.IsLeader?(u(),E("strong",Cn,"(Leader)")):$("",!0)]))),128))]),Vn,h(" "+C(d.value.length),1)],64))}}),On=z({__name:"MetaDataItem",props:ee({accommodations:{},convention:{},forms:{},registration:{},tickets:{},venues:{}},{modelValue:{required:!0}}),emits:["update:modelValue"],setup(e){const d=ve(e,"modelValue");return(o,i)=>d.value.MetaField===k(Z).META_DATA_SOURCE_REGISTRATION_REFERENCE?(u(),E(P,{key:0},[h(C(o.registration.Reference),1)],64)):d.value.MetaField===k(Z).META_DATA_SOURCE_REGISTRATION_GROUP?(u(),O(bn,{key:1,registration:o.registration},null,8,["registration"])):(u(),E(P,{key:2},[h(" Meta "+C(d.value),1)],64))}}),hn=z({__name:"UserDataItem",props:ee({accommodations:{},convention:{},forms:{},tickets:{},venues:{},registration:{}},{modelValue:{required:!0}}),emits:["update:modelValue"],setup(e){const d=ve(e,"modelValue");return(o,i)=>C(d.value)}}),kn=z({__name:"PanelItem",props:ee({accommodations:{},convention:{},extras:{},forms:{},tickets:{},venues:{},registration:{}},{modelValue:{required:!0}}),emits:["update:modelValue"],setup(e){const d=ve(e,"modelValue");return(o,i)=>d.value.SourceType===k(be).LAYOUT_ITEM_SOURCE_FORM?(u(),O(Sn,{key:0,accommodations:o.accommodations,convention:o.convention,extras:o.extras,forms:o.forms,tickets:o.tickets,venues:o.venues,modelValue:d.value,"onUpdate:modelValue":i[0]||(i[0]=n=>d.value=n),registration:o.registration},null,8,["accommodations","convention","extras","forms","tickets","venues","modelValue","registration"])):d.value.SourceType===k(be).LAYOUT_ITEM_SOURCE_META?(u(),O(On,{key:1,accommodations:o.accommodations,convention:o.convention,forms:o.forms,tickets:o.tickets,venues:o.venues,modelValue:d.value,"onUpdate:modelValue":i[1]||(i[1]=n=>d.value=n),registration:o.registration},null,8,["accommodations","convention","forms","tickets","venues","modelValue","registration"])):d.value.SourceType===k(be).LAYOUT_ITEM_SOURCE_USER?(u(),O(hn,{key:2,accommodations:o.accommodations,convention:o.convention,forms:o.forms,tickets:o.tickets,venues:o.venues,modelValue:d.value,"onUpdate:modelValue":i[2]||(i[2]=n=>d.value=n),registration:o.registration},null,8,["accommodations","convention","forms","tickets","venues","modelValue","registration"])):$("",!0)}}),Mn=z({__name:"PanelLayout",props:{accommodations:{},convention:{},extras:{},forms:{},tickets:{},venues:{},layout:{},registration:{}},setup(e){return(d,o)=>(u(),O(j,null,{default:a(()=>[(u(!0),E(P,null,W(d.layout.Panels,i=>{var n,m,l,s,r,T;return u(),O(b,{key:i.LayoutPanelUUID,cols:((n=i.Meta.cols)==null?void 0:n.toString())||!1,xs:((m=i.Meta.cols_xs)==null?void 0:m.toString())||!1,sm:((l=i.Meta.cols_sm)==null?void 0:l.toString())||!1,md:((s=i.Meta.cols_md)==null?void 0:s.toString())||!1,lg:((r=i.Meta.cols_lg)==null?void 0:r.toString())||!1,xl:((T=i.Meta.cols_xl)==null?void 0:T.toString())||!1},{default:a(()=>[t(ge,{class:"border rounded bg-white"},{default:a(()=>[F("h3",null,C(i.Name),1),t(Ke,{class:"bg-white"},{default:a(()=>[(u(!0),E(P,null,W(i.Items,(g,A)=>(u(),O($e,{key:g.LayoutItemUUID,class:"px-0"},{default:a(()=>[i.Items.length>1?(u(),O(ra,{key:0,class:"font-weight-bold"},{default:a(()=>[h(C(g.Label),1)]),_:2},1024)):$("",!0),t(kn,{accommodations:d.accommodations,convention:d.convention,extras:d.extras,forms:d.forms,tickets:d.tickets,venues:d.venues,modelValue:i.Items[A],"onUpdate:modelValue":c=>i.Items[A]=c,registration:d.registration},null,8,["accommodations","convention","extras","forms","tickets","venues","modelValue","onUpdate:modelValue","registration"])]),_:2},1024))),128))]),_:2},1024)]),_:2},1024)]),_:2},1032,["cols","xs","sm","md","lg","xl"])}),128))]),_:1}))}}),Nn=z({__name:"DataTableItemPanel",props:{accommodations:{},convention:{},extras:{},forms:{},tickets:{},venues:{},layouts:{},registration:{}},setup(e){const d=f(),o=f(!1),i=n=>{d.value=n,o.value=!0};return(n,m)=>(u(),E("div",null,[n.layouts?(u(),O(Ke,{key:0},{default:a(()=>[(u(!0),E(P,null,W(n.layouts,l=>(u(),O($e,{key:l.AdminLayoutUUID,class:"d-block pa-0 ma-0"},{default:a(()=>[t(ra,{style:{"text-overflow":"inherit"},class:"overflow-visible text-wrap"},{default:a(()=>[t(H,{"prepend-icon":"mdi:mdi-page-layout-body",variant:"flat",onClick:s=>i(l)},{default:a(()=>[h(C(l.Name),1)]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024))),128))]),_:1})):$("",!0),o.value&&d.value?(u(),O(Je,{key:1,modelValue:o.value,"onUpdate:modelValue":m[0]||(m[0]=l=>o.value=l),"hide-extension":!0,fullscreen:!0,title:`#${n.registration.Reference} ${n.registration.User.DisplayName} - ${d.value.Name} `},{default:a(()=>[t(Mn,{accommodations:n.accommodations,convention:n.convention,extras:n.extras,forms:n.forms,tickets:n.tickets,venues:n.venues,layout:d.value,registration:n.registration},null,8,["accommodations","convention","extras","forms","tickets","venues","layout","registration"])]),_:1},8,["modelValue","title"])):$("",!0)]))}}),Ln={class:"text-grey-lighten-1"},wn={key:0,class:"text-blue text-center"},Pn={key:1,class:"text-red text-center"},Fn={key:2,class:"text-orange text-center"},$n={key:3,class:"text-orange text-center"},xn={key:4,class:"text-orange text-center"},Bn={key:5,class:"text-orange text-center"},Gn={key:6,class:"text-green text-center"},Yn={key:0},Hn={key:0},qn=F("strong",null,"Total:",-1),jn=z({__name:"RegListRow",props:{header:{},accommodations:{},convention:{},extras:{},forms:{},item:{},interests:{},tickets:{},user:{},venues:{}},emits:["openActions","openPayments","openTags","reload","showForm","switchUser"],setup(e,{emit:d}){const o=(l,s,r)=>{d("showForm",{registration:l,form:s,submission:r})},i=l=>{d("openActions",l)},n=l=>{d("switchUser",l)},m=l=>{const s=e.item.raw.registration;return{ID:0,SubmissionUUID:Ie(),FormID:l.ID,FormUUID:l.FormUUID,Form:l,UserID:s.UserID,UserUUID:s.UserUUID,RegistrationID:s.ID,RegistrationUUID:s.RegistrationUUID,Registration:s,Data:[],Status:Tl.SUBMISSION_STATUS_NULL}};return(l,s)=>l.header.type==="ACCOMMODATION"&&l.accommodations.length>0&&l.item.raw[l.header.key]?(u(),O(Ia,{key:0,value:l.item.raw[l.header.key].Data,accommodations:l.accommodations,convention:l.convention,forms:l.forms,tickets:l.tickets,venues:l.venues,registration:l.item.raw[l.header.key].Registration},null,8,["value","accommodations","convention","forms","tickets","venues","registration"])):l.header.type==="EXTRAS"&&l.extras.length>0?(u(),O(Da,{key:1,value:l.item.raw[l.header.key],extras:l.extras},null,8,["value","extras"])):l.header.type==="INTERESTS"&&l.interests.length>0?(u(),O(_n,{key:2,value:l.item.raw[l.header.key],interests:l.interests},null,8,["value","interests"])):l.header.type==="TICKET"&&l.tickets.length>0?(u(),O(Ea,{key:3,value:l.item.raw[l.header.key],tickets:l.tickets},null,8,["value","tickets"])):l.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_SUBMISSION_STATUS"||l.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_ACCOMMODATION_FORM"||l.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_ADMIN_FORM"||l.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_DEALER_FORM"||l.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_BADGE_FORM"||l.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_REGISTRATION_FORM"?(u(),E(P,{key:4},[F("ul",null,[(u(!0),E(P,null,W(l.forms.filter(r=>r.Type===k(Te).FORM_TYPE_ADMIN&&l.item.raw[l.header.key].findIndex(T=>T.Form.ID===r.ID)<0),r=>(u(),E("li",{key:r.Heading},[F("strong",Ln,C(r.Heading),1),t(H,{class:"text-grey-lighten-1",icon:"mdi:mdi-form-select",title:"Edit Submitted Data",variant:"flat",onClick:T=>o(l.item.raw.registration,r,m(r))},null,8,["onClick"])]))),128))]),F("ul",null,[(u(!0),E(P,null,W(l.item.raw[l.header.key],r=>(u(),E("li",{key:r.Heading},[F("strong",null,[h(C(r.Heading),1),r.Form.Type!==k(Te).FORM_TYPE_ADMIN?(u(),E(P,{key:0},[h(": ")],64)):$("",!0)]),r.Form.Type!==k(Te).FORM_TYPE_ADMIN?(u(),E("span",{key:0,class:$a(k(Al)(r.Submission.Status))},C(k(ma)(r.Submission.Status)),3)):$("",!0),t(H,{icon:"mdi:mdi-form-select",title:"Edit Submitted Data",variant:"flat",onClick:T=>o(r.Registration,r.Form,r.Submission)},null,8,["onClick"])]))),128))])],64)):l.header.type==="LAYOUT_ITEM_SOURCE_USER.USER_DATA_SOURCE_AVATAR"?(u(),O(ca,{key:5,class:"rounded-circle",src:l.item.raw[l.header.key],height:"32",width:"32"},null,8,["src"])):l.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_PAYMENT_STATUS"?(u(),E(P,{key:6},[l.item.raw[l.header.key]=="NOT_REQUIRED"?(u(),E("div",wn,"No Payment Requested")):l.item.raw[l.header.key]=="MISSING_REQUIRED"?(u(),E("div",Pn,"Partner Payment Not Requested")):l.item.raw[l.header.key]=="AWAITING_PARTNER"?(u(),E("div",Fn,"Awaiting Partner Payment")):l.item.raw[l.header.key]=="ALL_REQUIRED"?(u(),E("div",$n,"Awaiting Payments")):l.item.raw[l.header.key]=="REQUIRED"?(u(),E("div",xn,"Awaiting Payment")):l.item.raw[l.header.key]=="ADDITIONAL_REQUIRED"?(u(),E("div",Bn,"Awaiting Additional Payments")):(u(),E("div",Gn,"Completed"))],64)):l.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_REGISTRATION_ACTIONS"?(u(),E(P,{key:7},[t(H,{icon:"mdi:mdi-briefcase",variant:"flat",onClick:s[0]||(s[0]=r=>i(l.item.raw[l.header.key]))}),k(Xl)(l.user)?(u(),O(H,{key:0,icon:"mdi:mdi-account-switch-outline",variant:"flat",onClick:s[1]||(s[1]=r=>n(l.item.raw[l.header.key]))})):$("",!0)],64)):l.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_REGISTRATION_GROUP"?(u(),E(P,{key:8},[l.item.raw[l.header.key].length===1?(u(),E("em",Yn," Not in a group ")):(u(),E(P,{key:1},[F("ul",null,[(u(!0),E(P,null,W(l.item.raw[l.header.key],r=>(u(),E("li",{key:r.UUID,class:"ml-0"},[h(" #"+C(r.Reference)+" : "+C(r.Name)+" ",1),r.IsLeader?(u(),E("strong",Hn,"(Leader)")):$("",!0)]))),128))]),qn,h(" "+C(l.item.raw[l.header.key].length),1)],64))],64)):l.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_DATA_LAYOUT"?(u(),O(Nn,{key:9,accommodations:l.accommodations,convention:l.convention,extras:l.extras,forms:l.forms,tickets:l.tickets,venues:l.venues,layouts:l.item.raw[l.header.key].Layouts,registration:l.item.raw[l.header.key].Registration},null,8,["accommodations","convention","extras","forms","tickets","venues","layouts","registration"])):(u(),E(P,{key:10},[h(C(l.item.raw[l.header.key]),1)],64))}}),Qt=z({__name:"RegistrationActionTabs",props:ee({alignTabs:{},class:{},fixedTabs:{type:Boolean},showArrows:{type:[String,Boolean]},tabs:{}},{modelValue:{required:!0}}),emits:["update:modelValue"],setup(e){const d=e,o=ve(e,"modelValue");return(i,n)=>(u(),O(fa,Ve({modelValue:o.value,"onUpdate:modelValue":n[0]||(n[0]=m=>o.value=m)},d),{default:a(()=>[(u(!0),E(P,null,W(i.tabs,m=>(u(),O(Ua,{value:m.value,key:m.value},{default:a(()=>[h(C(m.label),1)]),_:2},1032,["value"]))),128))]),_:1},16,["modelValue"]))}}),zn=z({__name:"Badges",props:{convention:{},registration:{}},setup(e){const d=_e(),o=va(),i=f([]),n=l=>{var r;const s=document.createElement("a");s.download=`${((r=e.convention)==null?void 0:r.Name)||""} Badge Image - ${e.registration.Reference} - ${e.registration.User.DisplayName}.jpg`,s.href=l,document.body.appendChild(s),s.click(),document.body.removeChild(s)},m=async l=>o.GetConBadgeImageURL(e.registration.RegistrationUUID,l);return d.getConBadgeList(e.registration.RegistrationUUID).then(l=>{l.forEach(s=>{m(s).then(r=>{i.value.push({template:s,url:r})})})}).catch(()=>{}),(l,s)=>(u(!0),E(P,null,W(i.value,r=>(u(),O(he,{key:r.template},{default:a(()=>[t(Xe,null,{default:a(()=>[t(Be,null,{default:a(()=>[t(j,{class:"flex-row-reverse"},{default:a(()=>[t(b,{class:"text-wrap flex-grow-1"},{default:a(()=>[h(" Badges (#"+C(l.registration.Reference)+" "+C(l.registration.User.DisplayName)+") ",1)]),_:1})]),_:1})]),_:1})]),_:1}),t(Ge,null,{default:a(()=>[t(ca,{src:r.url,height:"280",width:"280"},null,8,["src"])]),_:2},1024),t(Mt,null,{default:a(()=>[t(H,{color:"primary","prepend-icon":"mdi:mdi-download",variant:"flat",onClick:T=>n(r.url)},{default:a(()=>[h("Download")]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024))),128))}});var Kn=["onActivate","onAddUndo","onBeforeAddUndo","onBeforeExecCommand","onBeforeGetContent","onBeforeRenderUI","onBeforeSetContent","onBeforePaste","onBlur","onChange","onClearUndos","onClick","onContextMenu","onCopy","onCut","onDblclick","onDeactivate","onDirty","onDrag","onDragDrop","onDragEnd","onDragGesture","onDragOver","onDrop","onExecCommand","onFocus","onFocusIn","onFocusOut","onGetContent","onHide","onInit","onKeyDown","onKeyPress","onKeyUp","onLoadContent","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp","onNodeChange","onObjectResizeStart","onObjectResized","onObjectSelected","onPaste","onPostProcess","onPostRender","onPreProcess","onProgressState","onRedo","onRemove","onReset","onSaveContent","onSelectionChange","onSetAttrib","onSetContent","onShow","onSubmit","onUndo","onVisualAid"],Qn=function(e){return Kn.map(function(d){return d.toLowerCase()}).indexOf(e.toLowerCase())!==-1},Wn=function(e,d,o){Object.keys(d).filter(Qn).forEach(function(i){var n=d[i];typeof n=="function"&&(i==="onInit"?n(e,o):o.on(i.substring(2),function(m){return n(m,o)}))})},Jn=function(e,d,o,i){var n=e.modelEvents?e.modelEvents:null,m=Array.isArray(n)?n.join(" "):n;de(i,function(l,s){o&&typeof l=="string"&&l!==s&&l!==o.getContent({format:e.outputFormat})&&o.setContent(l)}),o.on(m||"change input undo redo",function(){d.emit("update:modelValue",o.getContent({format:e.outputFormat}))})},Xn=function(e,d,o,i,n,m){i.setContent(m()),o.attrs["onUpdate:modelValue"]&&Jn(d,o,i,n),Wn(e,o.attrs,i)},Wt=0,Sa=function(e){var d=Date.now(),o=Math.floor(Math.random()*1e9);return Wt++,e+"_"+o+Wt+String(d)},Zn=function(e){return e!==null&&e.tagName.toLowerCase()==="textarea"},Jt=function(e){return typeof e>"u"||e===""?[]:Array.isArray(e)?e:e.split(" ")},eo=function(e,d){return Jt(e).concat(Jt(d))},to=function(e){return e==null},Xt=function(){return{listeners:[],scriptId:Sa("tiny-script"),scriptLoaded:!1}},ao=function(){var e=Xt(),d=function(n,m,l,s){var r=m.createElement("script");r.referrerPolicy="origin",r.type="application/javascript",r.id=n,r.src=l;var T=function(){r.removeEventListener("load",T),s()};r.addEventListener("load",T),m.head&&m.head.appendChild(r)},o=function(n,m,l){e.scriptLoaded?l():(e.listeners.push(l),n.getElementById(e.scriptId)||d(e.scriptId,n,m,function(){e.listeners.forEach(function(s){return s()}),e.scriptLoaded=!0}))},i=function(){e=Xt()};return{load:o,reinitialize:i}},lo=ao(),no=function(){return typeof window<"u"?window:global},Pe=function(){var e=no();return e&&e.tinymce?e.tinymce:null},oo={apiKey:String,cloudChannel:String,id:String,init:Object,initialValue:String,inline:Boolean,modelEvents:[String,Array],plugins:[String,Array],tagName:String,toolbar:[String,Array],modelValue:String,disabled:Boolean,tinymceScriptSrc:String,outputFormat:{type:String,validator:function(e){return e==="html"||e==="text"}}},Ee=globalThis&&globalThis.__assign||function(){return Ee=Object.assign||function(e){for(var d,o=1,i=arguments.length;o<i;o++){d=arguments[o];for(var n in d)Object.prototype.hasOwnProperty.call(d,n)&&(e[n]=d[n])}return e},Ee.apply(this,arguments)},io=function(e,d,o,i){return e(i||"div",{id:d,ref:o})},so=function(e,d,o){return e("textarea",{id:d,visibility:"hidden",ref:o})},Et={selector:void 0,target:void 0},uo=z({props:oo,setup:function(e,d){var o=e.init?Ee(Ee({},e.init),Et):Ee({},Et),i=xa(e),n=i.disabled,m=i.modelValue,l=i.tagName,s=f(null),r=null,T=e.id||Sa("tiny-vue"),g=e.init&&e.init.inline||e.inline,A=!!d.attrs["onUpdate:modelValue"],c=!0,v=e.initialValue?e.initialValue:"",U="",N=function(M){return A?function(){return m!=null&&m.value?m.value:""}:function(){return M?v:U}},K=function(){var M=N(c),V=Ee(Ee({},o),{readonly:e.disabled,target:s.value,plugins:eo(o.plugins,e.plugins),toolbar:e.toolbar||o.toolbar,inline:g,setup:function(ae){r=ae,ae.on("init",function(x){return Xn(x,e,d,ae,m,M)}),typeof o.setup=="function"&&o.setup(ae)}});Zn(s.value)&&(s.value.style.visibility=""),Pe().init(V),c=!1};de(n,function(M){var V;r!==null&&(typeof((V=r.mode)===null||V===void 0?void 0:V.set)=="function"?r.mode.set(M?"readonly":"design"):r.setMode(M?"readonly":"design"))}),de(l,function(M){var V;A||(U=r.getContent()),(V=Pe())===null||V===void 0||V.remove(r),Qe(function(){return K()})}),Ba(function(){if(Pe()!==null)K();else if(s.value&&s.value.ownerDocument){var M=e.cloudChannel?e.cloudChannel:"6",V=e.apiKey?e.apiKey:"no-api-key",ae=to(e.tinymceScriptSrc)?"https://cdn.tiny.cloud/1/".concat(V,"/tinymce/").concat(M,"/tinymce.min.js"):e.tinymceScriptSrc;lo.load(s.value.ownerDocument,ae,K)}}),Ga(function(){Pe()!==null&&Pe().remove(r)}),g||(Ya(function(){c||K()}),Ha(function(){var M;A||(U=r.getContent()),(M=Pe())===null||M===void 0||M.remove(r)}));var p=function(M){var V;U=r.getContent(),(V=Pe())===null||V===void 0||V.remove(r),o=Ee(Ee(Ee({},o),M),Et),Qe(function(){return K()})};return d.expose({rerender:p,getEditor:function(){return r}}),function(){return g?io(Bt,T,s,e.tagName):so(Bt,T,s)}}});const ro=["colspan"],mo=F("strong",null,"E-Mail Content",-1),co=["innerHTML"],vo=z({__name:"Communications",props:{hideHistory:{type:Boolean,default:!1},registration:{},showEditor:{type:Boolean}},emits:["close-editor"],setup(e,{emit:d}){const o=_e(),i=f([]),n=f({From:"",Subject:"",HTML:""}),m=f(""),l=f(""),s=f(""),r=f(!1),T=f([]),g=f(["1"]),A=f([]),c=f([{key:"CreatedAt",title:"Date"},{key:"Subject",title:"Subject"},{key:"User.DisplayName",title:"Sender"},{key:"Status",title:"Status"}]),v=f([{key:"CreatedAt",order:"asc"}]);de(n,p=>{s.value=p.From||s.value||"",l.value=p.Subject||l.value||"",m.value=p.HTML||m.value||""});const U=()=>{o.getRegistrationEmails(e.registration.RegistrationUUID).then(p=>{p&&(p.forEach(M=>{M.CreatedAt=sa(new Date(M.CreatedAt||"")),M.Status=Jl(M.Status),M.User||(M.User={ID:0,UserUUID:"",DisplayName:"System",Handle:"",Credentials:[],Additional:{FirstName:"",LastName:"",DOB:"",Email:""},Data:"",Groups:[],Tags:[]})}),A.value=p)})};U(),(()=>{o.getRegistrationEmailTemplates(e.registration.RegistrationUUID).then(p=>{p&&(i.value=p)})})();const K=({callback:p})=>{o.sendRegistrationEmail(e.registration.RegistrationUUID,s.value,l.value,m.value).then(M=>{M?p&&(p("Email Sent"),U(),setTimeout(()=>{r.value=!1},2e3)):p&&p("Not sent")}).catch(()=>{p&&p("Not sent")})};return(p,M)=>(u(),E(P,null,[p.showEditor?(u(),E(P,{key:0},[t(j,null,{default:a(()=>[t(b,null,{default:a(()=>[t(oa,{items:i.value,"item-title":"Subject","return-object":"",label:"Template","hide-details":"",modelValue:n.value,"onUpdate:modelValue":M[0]||(M[0]=V=>n.value=V),variant:"outlined"},null,8,["items","modelValue"])]),_:1})]),_:1}),t(j,null,{default:a(()=>[t(b,{cols:"12"},{default:a(()=>[t(te,{modelValue:s.value,"onUpdate:modelValue":M[1]||(M[1]=V=>s.value=V),label:"From",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),t(b,{cols:"12"},{default:a(()=>[t(te,{modelValue:l.value,"onUpdate:modelValue":M[2]||(M[2]=V=>l.value=V),label:"Subject",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),t(b,{cols:"12"},{default:a(()=>[t(k(uo),{modelValue:m.value,"onUpdate:modelValue":M[3]||(M[3]=V=>m.value=V),"api-key":"g9sce3fktcgvk0i7sp96cahgyk4cos7q27es3ubnlal3xf3z"},null,8,["modelValue"])]),_:1})]),_:1}),t(j,null,{default:a(()=>[t(b,null,{default:a(()=>[t(lt,{onClick:M[4]||(M[4]=V=>d("close-editor")),label:"Close E-mail Editor",color:"secondary","prepend-icon":"mdi:mdi-window-close"})]),_:1}),t(b,{class:"text-right"},{default:a(()=>[t(lt,{onClick:K,label:"Send",color:"error"})]),_:1})]),_:1})],64)):$("",!0),A.value.length&&!p.hideHistory?(u(),O(Ut,{key:1,class:"my-2",multiple:!0,modelValue:g.value,"onUpdate:modelValue":M[7]||(M[7]=V=>g.value=V)},{default:a(()=>[t(ft,{value:"1"},{default:a(()=>[t(ct,null,{default:a(()=>[h(" Email History ")]),_:1}),t(vt,null,{default:a(()=>[t(k(kt),{items:A.value,headers:c.value,"show-expand":!0,"item-value":"EmailUUID",expanded:T.value,"onUpdate:expanded":M[5]||(M[5]=V=>T.value=V),"sort-by":v.value,"onUpdate:sortBy":M[6]||(M[6]=V=>v.value=V)},{"expanded-row":a(({columns:V,item:ae})=>[F("tr",null,[F("td",{colspan:V.length},[mo,F("div",{class:"communicationsViewEmailPreview",innerHTML:ae.raw.HTML},null,8,co)],8,ro)])]),"footer.prepend":a(()=>[t(H,{"prepend-icon":"mdi:mdi-refresh",color:"primary",class:"mr-4",onClick:U},{default:a(()=>[h("Refresh")]),_:1})]),_:1},8,["items","headers","expanded","sort-by"])]),_:1})]),_:1})]),_:1},8,["modelValue"])):$("",!0)],64))}});const fo=z({__name:"Emails",props:{registration:{}},setup(e){const d=f(!1);return(o,i)=>(u(),O(he,null,{default:a(()=>[t(Xe,null,{default:a(()=>[t(Be,null,{default:a(()=>[h(" E-Mails (#"+C(o.registration.Reference)+" "+C(o.registration.User.DisplayName)+") ",1)]),_:1})]),_:1}),t(Ge,null,{default:a(()=>[t(j,null,{default:a(()=>[t(b,{cols:"12"},{default:a(()=>[t(H,{"prepend-icon":"mdi:mdi-email",color:"primary",onClick:i[0]||(i[0]=n=>d.value=!0)},{default:a(()=>[h("Prepare Email")]),_:1})]),_:1})]),_:1}),t(vo,{registration:o.registration,"show-editor":d.value,onCloseEditor:i[1]||(i[1]=n=>d.value=!1)},null,8,["registration","show-editor"])]),_:1})]),_:1}))}}),Uo=z({__name:"EditNoteCategoryDialog",props:ee({convention:{},noteCategory:{},title:{}},{modelValue:{type:Boolean,required:!0}}),emits:ee(["update:noteCategory"],["update:modelValue"]),setup(e,{emit:d}){const o=e,{title:i=""}=o,n=ve(e,"modelValue"),m=nt(o,d,void 0,void 0,"noteCategory"),l=f(pe(m.value));de(m,()=>{l.value=pe(m.value)});const s=()=>{n.value=!1},r=()=>{l.value=pe(m.value)},T=()=>{m.value=l.value};return(g,A)=>(u(),O(Je,{modelValue:n.value,"onUpdate:modelValue":A[2]||(A[2]=c=>n.value=c),onReset:r,onSave:T,title:k(i),color:"primary",persistent:!0,fullscreen:!1,"hide-extension":!0},{default:a(()=>[t(ge,{class:"pa-0",fluid:!0},{default:a(()=>[t(j,null,{default:a(()=>[t(b,{cols:"12",sm:"6",md:"4"},{default:a(()=>[t(te,{modelValue:l.value.Name,"onUpdate:modelValue":A[0]||(A[0]=c=>l.value.Name=c),label:"Internal name",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),t(b,{cols:"12",sm:"6",md:"4"},{default:a(()=>[t(ga,{modelValue:l.value.Groups,"onUpdate:modelValue":A[1]||(A[1]=c=>l.value.Groups=c),convention:g.convention,label:"Groups",variant:"outlined","hide-details":""},null,8,["modelValue","convention"])]),_:1})]),_:1})]),_:1})]),actions:a(()=>[t(H,{color:"blue-darken-1",variant:"text",onClick:s},{default:a(()=>[h(" Cancel ")]),_:1}),t(H,{color:"blue-darken-1",variant:"text",onClick:r},{default:a(()=>[h(" Reset ")]),_:1}),t(xe),t(H,{color:"blue-darken-1",variant:"text",onClick:T},{default:a(()=>[h(" Save ")]),_:1})]),_:1},8,["modelValue","title"]))}}),go=()=>{const e=f(""),d=()=>{const o={x:window.innerWidth,y:window.innerHeight};o.x<600?e.value="xs":o.x>=600&&o.x<960?e.value="sm":o.x>=960&&o.x<1280?e.value="md":o.x>=1280&&o.x<1920?e.value="lg":o.x>=1920&&o.x<2560?e.value="xl":o.x>=2560&&(e.value="xxl")};return window.addEventListener("resize",d),d(),e},po={style:{"list-style":"none"}},_o=z({__name:"NoteCategories",props:{hideHistory:{type:Boolean},convention:{},showEditor:{type:Boolean}},emits:["close"],setup(e,{emit:d}){const o=_e(),i=f(!1),n=f(!1),m=f(""),l=f([]),s=f([{key:"Name",title:"Name"},{key:"Groups",title:"Groups"},{key:"actions",title:"",sortable:!1}]),r=go();f([{key:"CreatedAt",order:"asc"}]);const T=()=>({ID:0,NoteCategoryUUID:Ie(),ConventionID:e.convention.ID,ConventionUUID:e.convention.ConventionUUID,Name:"",Groups:[],Notes:[]}),g=f(-1),A=f(T()),c=f(T()),v=()=>{c.value.NoteCategoryUUID=Ie(),A.value=Object.assign({},T()),g.value=-1,i.value=!0},U=x=>{g.value=l.value.indexOf(x),A.value=Object.assign({},x),i.value=!0},N=x=>{g.value=l.value.indexOf(x),A.value=Object.assign({},x),n.value=!0},K=()=>{o.deleteNoteCategory(A.value.NoteCategoryUUID).then(x=>{x&&(l.value.splice(g.value,1),M())})},p=()=>{i.value=!1,Qe(()=>{A.value=Object.assign({},c.value),g.value=-1})},M=()=>{n.value=!1,Qe(()=>{A.value=Object.assign({},c.value),g.value=-1})},V=()=>{o.saveNoteCategory(A.value).then(x=>{x&&(g.value>-1?Object.assign(l.value[g.value],x):l.value.push(x),p())})};return(()=>{o.getNoteCategories(e.convention.ConventionUUID).then(x=>{x&&(l.value=x)})})(),(x,ne)=>(u(),O(k(kt),{headers:s.value,items:l.value,"sort-by":[{key:"calories",order:"asc"}],class:"elevation-1"},{top:a(()=>[t(bt,{color:"primary"},We({default:a(()=>[t(ya,null,{default:a(()=>[h("Note Categories")]),_:1}),t(Pl,{class:"mx-4 d-none d-sm-inline-flex",inset:!0,vertical:!0}),t(xe,{class:"d-none d-sm-inline-flex"}),k(r)!="xs"?(u(),O(H,{key:0,dark:"",class:"mb-2","prepend-icon":"mdi:mdi-pencil",onClick:v},{default:a(()=>[h(" New Item ")]),_:1})):$("",!0),t(H,{dark:"",class:"mb-2",icon:"mdi:mdi-window-close",onClick:ne[0]||(ne[0]=J=>d("close"))}),t(Ta,{modelValue:n.value,"onUpdate:modelValue":ne[1]||(ne[1]=J=>n.value=J),onDelete:K},null,8,["modelValue"])]),_:2},[k(r)=="xs"?{name:"extension",fn:a(()=>[t(xe),t(H,{dark:"",class:"mb-2","prepend-icon":"mdi:mdi-pencil",onClick:v},{default:a(()=>[h(" New Item ")]),_:1})]),key:"0"}:void 0]),1024),i.value?(u(),O(Uo,{key:0,modelValue:i.value,"onUpdate:modelValue":ne[2]||(ne[2]=J=>i.value=J),"note-category":A.value,"onUpdate:noteCategory":[ne[3]||(ne[3]=J=>A.value=J),V],title:m.value,convention:x.convention},null,8,["modelValue","note-category","title","convention"])):$("",!0)]),"item.Groups":a(({item:J})=>[F("ul",po,[(u(!0),E(P,null,W(J.selectable.Groups,I=>(u(),E("li",{key:I.GroupUUID,class:"py-1"},C(I.Name),1))),128))])]),"item.actions":a(({item:J})=>[t(rt,{size:"small",class:"me-2",onClick:I=>U(J.raw)},{default:a(()=>[h(" mdi:mdi-pencil ")]),_:2},1032,["onClick"]),t(rt,{size:"small",onClick:I=>N(J.raw)},{default:a(()=>[h(" mdi:mdi-delete ")]),_:2},1032,["onClick"])]),_:1},8,["headers","items"]))}}),Ao=z({__name:"SelectNoteCategories",props:ee({convention:{},chips:{type:Boolean,default:!1},clearable:{type:Boolean,default:!1},hint:{default:""},label:{},variant:{}},{modelValue:{required:!0}}),emits:ee(["change"],["update:modelValue"]),setup(e,{emit:d}){const o=ve(e,"modelValue"),i=f([]),n=_e(),m=f([]),l=f(""),s=f(0),r=ie(()=>[...m.value].map(A=>({title:A.Name,value:i.value.find(c=>c.NoteCategoryUUID===A.NoteCategoryUUID)||A})));return typeof e.convention=="object"?l.value=e.convention.ConventionUUID:l.value=e.convention||"",(async()=>{const g=[];l.value&&g.push(n.getNoteCategories(l.value));const A=await Promise.all(g);if(l.value&&A.length==1&&(m.value=A[0].sort((c,v)=>c.Name.localeCompare(v.Name))),Array.isArray(o.value))s.value=2,r.value.forEach(c=>{Array.isArray(o.value)&&o.value.find(U=>U.NoteCategoryUUID===c.value.NoteCategoryUUID)&&i.value.push(c.value)});else if(typeof o.value=="string"){s.value=1;try{const c=JSON.parse(o.value);r.value.forEach(v=>{c.find(N=>N.NoteCategoryUUID===v.value.NoteCategoryUUID)&&i.value.push(v.value)})}catch{}}})(),de(i,()=>{switch(s.value){default:case 2:{o.value=i.value,d("change");break}case 1:{o.value=JSON.stringify(i.value),d("change");break}}}),(g,A)=>(u(),O(oa,{modelValue:i.value,"onUpdate:modelValue":A[0]||(A[0]=c=>i.value=c),chips:g.chips,multiple:"",label:g.label||"Tags",variant:g.variant||"solo",hint:g.hint,"persistent-hint":!0,clearable:g.clearable,items:r.value,"item-title":"title","item-value":"value"},null,8,["modelValue","chips","label","variant","hint","clearable","items"]))}}),To=z({__name:"EditNoteDialog",props:ee({convention:{},note:{},title:{}},{modelValue:{type:Boolean,required:!0}}),emits:ee(["update:note","saved"],["update:modelValue"]),setup(e,{emit:d}){const o=e,{title:i=""}=o,n=_e(),m=ve(e,"modelValue"),l=nt(o,d,void 0,void 0,"note"),s=f(pe(l.value));de(l,()=>{s.value=pe(l.value)});const r=()=>{s.value=pe(l.value)},T=g=>{s.value.NoteCategories===null&&(s.value.NoteCategories=[]),s.value.CreatedAt=void 0,s.value.DeletedAt=void 0,s.value.UpdatedAt=void 0,s.value.Admin=void 0,s.value.AdminID=void 0,s.value.AdminUUID=void 0,n.saveNote(s.value).then(A=>{A?(s.value=pe(A),g&&g("Note Saved"),l.value=s.value,d("saved",l.value)):g&&g("Internal Error Saving Note")}).catch(A=>{g&&g("Error Saving Note:"+A.ErrorMessage)})};return(g,A)=>s.value?(u(),O(Je,{key:0,"card-class":"pa-4",modelValue:m.value,"onUpdate:modelValue":A[3]||(A[3]=c=>m.value=c),onReset:r,onSave:T,title:k(i),color:"primary",persistent:!0,fullscreen:!1,"hide-extension":!0,"show-close-action":!0,"show-reset-action":!0,"show-save-action":!0},{default:a(()=>[t(ge,{class:"pa-0",fluid:!0},{default:a(()=>[t(j,null,{default:a(()=>[t(b,{cols:"12"},{default:a(()=>[t(Ao,{modelValue:s.value.NoteCategories,"onUpdate:modelValue":A[0]||(A[0]=c=>s.value.NoteCategories=c),convention:g.convention,label:"Categories",variant:"outlined","hide-details":"",chips:!0},null,8,["modelValue","convention"])]),_:1})]),_:1}),t(j,null,{default:a(()=>[t(b,{cols:"12"},{default:a(()=>[t(te,{modelValue:s.value.Subject,"onUpdate:modelValue":A[1]||(A[1]=c=>s.value.Subject=c),label:"Subject",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),t(b,{cols:"12"},{default:a(()=>[t(Fl,{modelValue:s.value.Description,"onUpdate:modelValue":A[2]||(A[2]=c=>s.value.Description=c),label:"Note",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue","title"])):$("",!0)}}),yo=z({__name:"Notes",props:{convention:{},hideHistory:{type:Boolean},registration:{},showEditor:{type:Boolean}},setup(e){const d=_e(),o=()=>({ID:0,NoteUUID:Ie(),Description:"",NoteCategories:[],Registration:e.registration,RegistrationID:e.registration.ID,RegistrationUUID:e.registration.RegistrationUUID,Subject:""}),i=f(!1),n=f(!1),m=f([]),l=f([]),s=f(o()),r=()=>{s.value=o(),i.value=!0},T=c=>{s.value=c,i.value=!0},g=()=>{d.getRegistrationNotes(e.registration.RegistrationUUID).then(c=>{c&&(c.forEach(v=>{v.CreatedAt=sa(new Date(v.CreatedAt||"")),v.Admin||(v.Admin={ID:0,UserUUID:"",DisplayName:"System",Handle:"",Credentials:[],Additional:{FirstName:"",LastName:"",DOB:"",Email:""},Data:"",Groups:[],Tags:[]})}),m.value=c,l.value=c.map(v=>v.NoteUUID))})},A=()=>{g(),setTimeout(()=>{i.value=!1},2e3)};return g(),(c,v)=>(u(),E(P,null,[t(he,null,{default:a(()=>[t(Xe,null,{default:a(()=>[t(Be,null,{default:a(()=>[t(j,{class:"flex-row-reverse"},{default:a(()=>[t(b,{class:"text-right flex-shrink-1 flex-grow-0",style:{"flex-grow":"0 !important"}},{default:a(()=>[t(H,{class:"d-sm-none",size:"xs",icon:"mdi:mdi-cog",variant:"text",color:"warning",onClick:v[0]||(v[0]=U=>n.value=!0)}),t(H,{class:"d-none d-sm-inline-flex","prepend-icon":"mdi:mdi-cog",variant:"text",color:"warning",onClick:v[1]||(v[1]=U=>n.value=!0)},{default:a(()=>[h("Categories")]),_:1})]),_:1}),t(b,{class:"text-wrap flex-grow-1"},{default:a(()=>[h(" Notes (#"+C(c.registration.Reference)+" "+C(c.registration.User.DisplayName)+") ",1)]),_:1})]),_:1})]),_:1})]),_:1}),t(Ge,null,{default:a(()=>[t(Ut,{multiple:!0,variant:"accordion",modelValue:l.value,"onUpdate:modelValue":v[2]||(v[2]=U=>l.value=U)},{default:a(()=>[(u(!0),E(P,null,W(m.value,U=>(u(),O(ft,{key:`${U.NoteUUID}.${U.UpdatedAt}`,value:U.NoteUUID},{default:a(()=>[t(ct,null,{default:a(()=>[h(C(U.Subject)+" ",1),t($l,{class:"ml-4"},{default:a(()=>[(u(!0),E(P,null,W(U.NoteCategories,N=>(u(),O(xl,{key:N.NoteCategoryUUID},{default:a(()=>[h(C(N.Name),1)]),_:2},1024))),128))]),_:2},1024)]),_:2},1024),t(vt,null,{default:a(()=>[t(j,null,{default:a(()=>[t(b,null,{default:a(()=>[h(C(U.Description),1)]),_:2},1024)]),_:2},1024),t(j,null,{default:a(()=>[t(b,null,{default:a(()=>[h(C(k(tt)(U.UpdatedAt||""))+" ",1),U&&U.Admin&&U.Admin.DisplayName?(u(),E(P,{key:0},[h(" - "+C(U.Admin.DisplayName),1)],64)):$("",!0)]),_:2},1024),t(b,{class:"text-right"},{default:a(()=>[t(H,{color:"primary","prepend-icon":"mdi:mdi-pencil",onClick:N=>T(U)},{default:a(()=>[h("Edit")]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(Mt,null,{default:a(()=>[t(H,{color:"primary",variant:"flat",onClick:r},{default:a(()=>[h("Add Note")]),_:1})]),_:1})]),_:1}),t(dt,{modelValue:i.value,"onUpdate:modelValue":v[5]||(v[5]=U=>i.value=U),title:"Create Note"},{default:a(()=>[t(To,{modelValue:i.value,"onUpdate:modelValue":v[3]||(v[3]=U=>i.value=U),note:s.value,"onUpdate:note":v[4]||(v[4]=U=>s.value=U),convention:c.convention,title:"Create Note",onSaved:A},null,8,["modelValue","note","convention"])]),_:1},8,["modelValue"]),t(dt,{modelValue:n.value,"onUpdate:modelValue":v[7]||(v[7]=U=>n.value=U),title:"Note Configuration"},{default:a(()=>[t(_o,{convention:c.convention,onClose:v[6]||(v[6]=U=>n.value=!1)},null,8,["convention"])]),_:1},8,["modelValue"])],64))}}),Io=z({__name:"StripeRefundPayment",props:ee({paymentTransaction:{}},{modelValue:{type:Boolean,required:!0}}),emits:ee(["refunded"],["update:modelValue"]),setup(e,{emit:d}){const o=ve(e,"modelValue"),i=_e(),n=f(!1),m=f("");let l=0;if(e.paymentTransaction.Data&&e.paymentTransaction.Data.PaymentIntent&&typeof e.paymentTransaction.Data.PaymentIntent=="object"){const c=e.paymentTransaction.Data.PaymentIntent;c&&(l=c.amount)}const s=f({Amount:l/100,Description:"",Reason:""}),r=f([{title:"Duplicate",value:"duplicate"},{title:"Fraudulent",value:"fraudulent"},{title:"Requested By Customer",value:"requested_by_customer"}]),T=f(!1);async function g(c){c.preventDefault(),T.value=!0,i.refundStripePayment(e.paymentTransaction.PaymentTransactionUUID,s.value).then(v=>{v?d("refunded",v):A("An unexpected error occurred.")}).catch(v=>{A("An error occurred processing the refund: "+v.toString())}),T.value=!1}const A=c=>{m.value=c,n.value=!0};return(c,v)=>(u(),O(Je,{modelValue:o.value,"onUpdate:modelValue":v[7]||(v[7]=U=>o.value=U),title:"Refund a Stripe Payment",color:"blue-darken-4",persistent:""},{default:a(()=>[t(ge,{class:"pa-0"},{default:a(()=>[t(Bl,{ref:"refundForm",id:"refund-form",onSubmit:v[4]||(v[4]=Rt(U=>g(U),["prevent"]))},{default:a(()=>[t(j,null,{default:a(()=>[t(b,{cols:"12",sm:"6",md:"4",lg:"3",xl:"2"},{default:a(()=>[t(te,{modelValue:s.value.Amount,"onUpdate:modelValue":v[0]||(v[0]=U=>s.value.Amount=U),modelModifiers:{number:!0},label:"Amount",prefix:"£",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),t(b,{cols:"12",sm:"6",md:"8",lg:"9",xl:"10"},{default:a(()=>[t(Ue,{modelValue:s.value.Reason,"onUpdate:modelValue":v[1]||(v[1]=U=>s.value.Reason=U),modelModifiers:{number:!0},items:r.value,"item-title":"title","item-value":"value",label:"Stripe Refund Reason",variant:"outlined","hide-details":""},null,8,["modelValue","items"])]),_:1}),t(b,{cols:"12"},{default:a(()=>[t(te,{modelValue:s.value.Description,"onUpdate:modelValue":v[2]||(v[2]=U=>s.value.Description=U),modelModifiers:{number:!0},label:"Refund Description",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1})]),_:1}),t(j,null,{default:a(()=>[t(b,{class:"text-right",cols:"12",sm:"3",md:"2",lg:"2",xl:"1"},{default:a(()=>[t(H,{color:"error",class:"w-100",onClick:v[3]||(v[3]=U=>o.value=!1)},{default:a(()=>[h("Cancel")]),_:1})]),_:1}),t(xe),t(b,{class:"text-left",cols:"12",sm:"3",md:"2",lg:"2",xl:"1"},{default:a(()=>[t(H,{type:"submit",color:"success",class:"w-100"},We({default:a(()=>[h(" Issue Refund ")]),_:2},[T.value?{name:"prepend",fn:a(()=>[t(pl,{size:"20",indeterminate:""})]),key:"0"}:void 0]),1024)]),_:1})]),_:1})]),_:1},512)]),_:1}),t(Aa,{modelValue:n.value,"onUpdate:modelValue":v[6]||(v[6]=U=>n.value=U)},{actions:a(()=>[t(H,{variant:"text",onClick:v[5]||(v[5]=U=>n.value=!1)},{default:a(()=>[h(" Close ")]),_:1})]),default:a(()=>[h(C(m.value)+" ",1)]),_:1},8,["modelValue"])]),_:1},8,["modelValue"]))}}),Do=["colspan"],Eo=F("strong",null,"Details",-1),So=["innerHTML"],Ro=z({__name:"PaymentTransactions",props:{canEdit:{type:Boolean},hideHistory:{type:Boolean},updated:{},registration:{},showEditor:{type:Boolean}},emits:["close-editor","change"],setup(e,{emit:d}){const o=e;let{hideHistory:i=!1,registration:n,showEditor:m}=o;const l=_e(),s=f([]),r=f(["1"]),T=f([]),g=f([{key:"CreatedAt",title:"Date"},{key:"Type",title:"Type"},{key:"Source",title:"Source"},{key:"Description",title:"Description"},{key:"Admin",title:"Admin"},{key:"Amount",title:"Amount"},{key:"Controls",title:""}]),A=f(!1),c=f(),v=f(!1),U=f(""),N=f([{key:"CreatedAt",order:"asc"}]),K=()=>({PaymentTransactionUUID:Ie(),Amount:0,Data:{},Description:"",ID:0,RegistrationID:n.ID,RegistrationUUID:n.RegistrationUUID,Source:Yt.PAYMENT_TRANSACTION_SOURCE_NULL,Type:Ct.PAYMENT_TRANSACTION_TYPE_NULL}),p=f(K()),{convertTransactions:M,getPaymentTransactionsDisplay:V}=ua();de(o,()=>{i=o.hideHistory,n=o.registration,m=o.showEditor,V(n.RegistrationUUID).then(I=>{T.value=I})});const ae=()=>{V(n.RegistrationUUID).then(I=>{T.value=I})};ae();const x=()=>{l.saveRegistrationPaymentTransaction(p.value).then(I=>{I&&(M(I.PaymentTransactions),p.value=K(),d("close-editor"),d("change"))})},ne=I=>{const D=T.value.find(S=>S.PaymentTransactionUUID===I);D&&(c.value=D.PaymentTransaction,A.value=!0)},J=I=>{if(I)try{T.value=M(I.PaymentTransactions),c.value=void 0,A.value=!1,U.value="Refund Processed",v.value=!0,d("change")}catch(D){console.error(D)}};return(I,D)=>(u(),E(P,null,[k(m)?(u(),E(P,{key:0},[t(Be,null,{default:a(()=>[h(" Add Transaction ")]),_:1}),t(j,null,{default:a(()=>[t(b,{cols:"12",sm:"6"},{default:a(()=>[t(Ue,{items:k(sl),"item-title":"title","item-value":"value",label:"Transaction Type",clearable:!0,"hide-details":"",modelValue:p.value.Type,"onUpdate:modelValue":D[0]||(D[0]=S=>p.value.Type=S),variant:"outlined"},null,8,["items","modelValue"])]),_:1}),t(b,{cols:"12",sm:"6"},{default:a(()=>[t(Ue,{items:k(ul),"item-title":"title","item-value":"value",label:"Source",clearable:!0,"hide-details":"",modelValue:p.value.Source,"onUpdate:modelValue":D[1]||(D[1]=S=>p.value.Source=S),variant:"outlined"},null,8,["items","modelValue"])]),_:1})]),_:1}),t(j,null,{default:a(()=>[t(b,{cols:"12",sm:"8",md:"10"},{default:a(()=>[t(te,{label:"Description","hide-details":"",modelValue:p.value.Description,"onUpdate:modelValue":D[2]||(D[2]=S=>p.value.Description=S),variant:"outlined"},null,8,["modelValue"])]),_:1}),t(b,{cols:"12",sm:"4",md:"2"},{default:a(()=>[t(te,{label:"Amount","prepend-inner-icon":"mdi:mdi-currency-gbp","hide-details":"",modelValue:p.value.Amount,"onUpdate:modelValue":D[3]||(D[3]=S=>p.value.Amount=S),modelModifiers:{number:!0},variant:"outlined"},null,8,["modelValue"])]),_:1})]),_:1}),t(j,null,{default:a(()=>[t(b,{cols:"12",sm:"3",md:"2",lg:"1"},{default:a(()=>[t(H,{class:"w-100",onClick:D[4]||(D[4]=S=>d("close-editor")),color:"warning"},{default:a(()=>[h("Cancel")]),_:1})]),_:1}),t(xe),t(b,{cols:"12",sm:"6",md:"3",lg:"2",xl:"2"},{default:a(()=>[t(H,{class:"w-100",onClick:x,color:"primary"},{default:a(()=>[h("Submit Transaction")]),_:1})]),_:1})]),_:1})],64)):$("",!0),T.value.length&&!k(i)?(u(),O(Ut,{key:1,class:"my-2",modelValue:r.value,"onUpdate:modelValue":D[10]||(D[10]=S=>r.value=S)},{default:a(()=>[t(ft,{value:"1"},{default:a(()=>[t(ct,null,{default:a(()=>[h(" Transaction History ")]),_:1}),t(vt,null,{default:a(()=>[t(k(kt),{items:T.value,headers:g.value,"show-expand":!1,"item-value":"PaymentTransactionUUID",expanded:s.value,"onUpdate:expanded":D[5]||(D[5]=S=>s.value=S),"sort-by":N.value,"onUpdate:sortBy":D[6]||(D[6]=S=>N.value=S),class:"transactionTable"},{"item.Controls":a(({item:S})=>[I.canEdit&&S.raw.PaymentTransaction.Source===k(Yt).PAYMENT_TRANSACTION_SOURCE_STRIPE&&S.raw.PaymentTransaction.Type===k(Ct).PAYMENT_TRANSACTION_TYPE_PAYMENT?(u(),O(H,{key:0,icon:"mdi:mdi-credit-card-refund",variant:"text",size:"xs",onClick:L=>ne(S.key)},null,8,["onClick"])):$("",!0)]),"expanded-row":a(({columns:S,item:L})=>[F("tr",null,[F("td",{colspan:S.length},[Eo,F("div",{innerHTML:L.raw.HTML},null,8,So)],8,Do)])]),"footer.prepend":a(()=>[t(H,{"prepend-icon":"mdi:mdi-refresh",color:"primary",class:"mr-4",onClick:ae},{default:a(()=>[h("Refresh")]),_:1})]),_:1},8,["items","headers","expanded","sort-by"]),A.value&&c.value?(u(),O(Io,{key:0,modelValue:A.value,"onUpdate:modelValue":D[7]||(D[7]=S=>A.value=S),"payment-transaction":c.value,onRefunded:J},null,8,["modelValue","payment-transaction"])):$("",!0),t(Aa,{modelValue:v.value,"onUpdate:modelValue":D[9]||(D[9]=S=>v.value=S)},{actions:a(()=>[t(H,{variant:"text",onClick:D[8]||(D[8]=S=>v.value=!1)},{default:a(()=>[h(" Close ")]),_:1})]),default:a(()=>[h(C(U.value)+" ",1)]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])):$("",!0)],64))}});const Co=(e=void 0,d)=>e===void 0?!1:ht(e,Ot.GROUP_TYPE_CONVENTION,d.ConventionUUID,d).EditPaymentTransactions,gt=e=>(la("data-v-8af8174d"),e=e(),na(),e),Vo={class:"mb-4"},bo={class:"v-row"},Oo={key:0,class:"v-col v-col-10 py-1 v-row mx-0 pl-0"},ho={class:"v-col v-col-12 v-col-sm-4 v-col-md-3 font-weight-bold pb-0 pr-0"},ko={class:"v-col v-col-12 v-col-sm-8 v-col-md-9 font-italic pt-0 pt-sm-3 pb-sm-0 pl-sm-0"},Mo={class:"v-col v-col-2 align-self-end text-right py-1 text-no-wrap"},No=gt(()=>F("dt",{class:"v-col v-col-9 py-1 font-weight-bold totals"}," Total Charges ",-1)),Lo={class:"v-col v-col-3 align-self-end text-right py-1 totals text-no-wrap"},wo=gt(()=>F("dt",{class:"v-col v-col-9 py-1 font-weight-bold"}," Applied Total ",-1)),Po={class:"v-col v-col-3 align-self-end text-right py-1 text-no-wrap"},Fo=gt(()=>F("dt",{class:"v-col v-col-9 py-1 font-weight-bold"}," Currently Paid ",-1)),$o={class:"v-col v-col-3 align-self-end text-right py-1 text-no-wrap"},xo=gt(()=>F("dt",{class:"v-col v-col-9 py-1 font-weight-bold totals"}," Balance ",-1)),Bo={class:"v-col v-col-3 align-self-end text-right py-1 totals text-no-wrap"},Go=z({__name:"PaymentActions",props:ee({forms:{},title:{}},{modelValue:{required:!0}}),emits:["update:modelValue"],setup(e){const d=f(!1),o=f(),i=f([]),n=f(new Date().getTime()),m=f(!1),l=ve(e,"modelValue"),s=f(pe(l.value));de(l,()=>{s.value=pe(l.value)});const r=_e();r.getConvention(l.value.ConventionUUID).then(c=>{c&&(m.value=Co(Nt(),c))});const T=()=>{r.generateRegistrationCharges(l.value.RegistrationUUID,!1).then(c=>{c&&(i.value=c.PaymentTransactions,o.value=c.Registration,n.value=new Date().getTime())}).catch(()=>{})};T();const g=()=>{r.generateRegistrationCharges(l.value.RegistrationUUID,!0).then(c=>{c&&(i.value=c.PaymentTransactions,o.value=c.Registration,n.value=new Date().getTime())})},{totalCharges:A}=ua();return(c,v)=>(u(),O(he,null,{default:a(()=>[t(Xe,null,{default:a(()=>[t(Be,null,{default:a(()=>[h(" Payments (#"+C(l.value.Reference)+" "+C(l.value.User.DisplayName)+") ",1)]),_:1})]),_:1}),t(Ge,null,{default:a(()=>[o.value?(u(),E(P,{key:0},[F("h3",Vo,"#"+C(o.value.Reference)+" "+C(o.value.User.DisplayName),1),F("dl",bo,[(u(!0),E(P,null,W(i.value,U=>(u(),E(P,{key:U.PaymentTransactionUUID},[U.Type===k(Ct).PAYMENT_TRANSACTION_TYPE_CHARGE?(u(),E("dt",Oo,[F("div",ho,C(U.Description.split(":")[0])+": ",1),F("div",ko,C(U.Description.split(":")[1]),1)])):$("",!0),F("dd",Mo," £"+C(U.Amount),1)],64))),128)),No,F("dd",Lo," £"+C(k(A)(i.value)),1),wo,F("dd",Po," £"+C(o.value.Total),1),Fo,F("dd",$o," £"+C(o.value.Paid),1),xo,F("dd",Bo," £"+C(o.value.Total-o.value.Paid),1)]),t(j,{class:"flex-row-reverse"},{default:a(()=>[t(b,{class:"text-right"},{default:a(()=>[t(H,{color:"primary",onClick:g},{default:a(()=>[h("Apply Charges")]),_:1})]),_:1}),!d.value&&m.value?(u(),O(b,{key:0},{default:a(()=>[t(H,{color:"secondary",onClick:v[0]||(v[0]=U=>d.value=!0)},{default:a(()=>[h("Transaction Entry")]),_:1})]),_:1})):$("",!0)]),_:1})],64)):$("",!0),t(Ro,{"can-edit":m.value,registration:l.value,"show-editor":d.value,onCloseEditor:v[1]||(v[1]=U=>d.value=!1),updated:n.value,onChange:T},null,8,["can-edit","registration","show-editor","updated"])]),_:1})]),_:1}))}});const Yo=mt(Go,[["__scopeId","data-v-8af8174d"]]),Ho=z({__name:"RegistrationFormStatus",props:ee({forms:{}},{modelValue:{required:!0}}),emits:["update:modelValue"],setup(e){const d=_e(),o=ve(e,"modelValue"),i=(n,m)=>{const l=o.value.Submissions.find(s=>s.SubmissionUUID==m);if(!l){n&&n("Submission not found");return}d.setSubmissionStatus(m,l.Status).then(s=>{s?(o.value.Submissions.forEach((r,T)=>{o.value.Submissions[T].Status=r.Status}),n&&n("Status Saved")):n&&n("Status not saved")}).catch(()=>{n&&n("Status not saved")})};return(n,m)=>(u(),O(he,null,{default:a(()=>[t(Xe,null,{default:a(()=>[t(Be,null,{default:a(()=>[h("Status (#"+C(o.value.Reference)+" "+C(o.value.User.DisplayName)+")",1)]),_:1})]),_:1}),t(Ge,null,{default:a(()=>[t(Ke,null,{default:a(()=>[(u(!0),E(P,null,W(o.value.Submissions,l=>(u(),O($e,{key:l.SubmissionUUID,class:"pa-0"},{default:a(()=>[t(j,{class:"py-2 align-center"},{default:a(()=>[t(b,{cols:"9",sm:"10",md:"10",lg:"9"},{default:a(()=>{var s;return[t(Ue,{modelValue:l.Status,"onUpdate:modelValue":r=>l.Status=r,items:k(Ht),"item-text":"title","item-value":"value",variant:"outlined","hide-details":"",label:((s=n.forms.find(r=>r.FormUUID==l.FormUUID))==null?void 0:s.Name)||""},{selection:a(()=>[t(rt,{class:"mr-4 d-none d-sm-inline"},{default:a(()=>{var r;return[h(C((r=k(Ht).find(T=>T.value===l.Status))==null?void 0:r.icon),1)]}),_:2},1024),h(" "+C(k(ma)(l.Status)),1)]),item:a(({item:r,props:{onClick:T}})=>[t($e,{title:r.title,"prepend-icon":r.raw.icon,onClick:T},null,8,["title","prepend-icon","onClick"])]),_:2},1032,["modelValue","onUpdate:modelValue","items","label"])]}),_:2},1024),t(b,{cols:"3",sm:"2",md:"2",lg:"1"},{default:a(()=>[t(lt,{class:"d-none d-sm-inline-flex",title:"Save","prepend-icon":"mdi:mdi-content-save",color:"warning",onClick:s=>i(s.callback,l.SubmissionUUID)},null,8,["onClick"]),t(lt,{class:"d-sm-none",size:"35",icon:"mdi:mdi-content-save",color:"warning",onClick:s=>i(s.callback,l.SubmissionUUID)},null,8,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1}))}}),qo=e=>(la("data-v-7d39acf0"),e=e(),na(),e),jo=qo(()=>F("p",null,"Any tags controlled through registration form fields will be reset when the applicable form is saved. If you don't know what you're doing here, don't touch!",-1)),zo={class:"mb-4"},Ko=z({__name:"RegistrationTags",props:ee({title:{}},{modelValue:{required:!0}}),emits:["update:modelValue"],setup(e){const d=_e(),o=ve(e,"modelValue"),i=f(pe(o.value)),n=f(!1),m=f(i.value.Tags);de(o,()=>{i.value=pe(o.value)});const l=({callback:s})=>{const r=[],T=[];i.value.Tags.forEach(g=>{m.value.find(c=>c.TagUUID===g.TagUUID)||r.push(g.TagUUID)}),m.value.forEach(g=>{i.value.Tags.find(c=>g.TagUUID===c.TagUUID)||T.push(g.TagUUID)}),d.updateRegistrationTags(r,T,i.value.RegistrationUUID).then(g=>{g?s&&(s("Tags Saved"),o.value.Tags=g.Tags):s&&s("Error Saving Tags")}).catch(()=>{s&&s("Error Saving Tags")})};return(s,r)=>(u(),O(he,null,{default:a(()=>[t(Xe,null,{default:a(()=>[t(Be,null,{default:a(()=>[h("Tags (#"+C(i.value.Reference)+" "+C(i.value.User.DisplayName)+")",1)]),_:1})]),_:1}),t(Ge,null,{default:a(()=>[t(Gl,{class:"my-4"},{default:a(()=>[t(Yl,null,{default:a(()=>[h("Caution")]),_:1}),jo]),_:1}),F("h3",zo,"#"+C(i.value.Reference)+" "+C(i.value.User.DisplayName),1),t(pa,{modelValue:i.value.Tags,"onUpdate:modelValue":r[0]||(r[0]=T=>i.value.Tags=T),convention:i.value.ConventionUUID,"show-key":!0,chips:!0,"show-uuid":n.value},null,8,["modelValue","convention","show-uuid"])]),_:1}),t(Mt,{class:"px-4 align-start"},{default:a(()=>[t(ia,{label:"Show UUID",modelValue:n.value,"onUpdate:modelValue":r[1]||(r[1]=T=>n.value=T)},null,8,["modelValue"]),t(lt,{onClick:l,variant:"flat"})]),_:1})]),_:1}))}});const Qo=mt(Ko,[["__scopeId","data-v-7d39acf0"]]),Zt=z({__name:"RegistrationActionWindows",props:ee({accommodations:{},convention:{},extras:{},forms:{},interests:{},registration:{},tickets:{},venues:{}},{modelValue:{required:!0}}),emits:ee(["update:registration"],["update:modelValue"]),setup(e,{emit:d}){const o=e,i=ve(e,"modelValue"),n=nt(o,d,void 0,void 0,"registration");return(m,l)=>(u(),O(_a,{modelValue:i.value,"onUpdate:modelValue":l[3]||(l[3]=s=>i.value=s)},{default:a(()=>[t(Fe,{value:"badges"},{default:a(()=>[i.value=="badges"?(u(),O(ge,{key:0,class:"pa-0 mx-0",fluid:!0},{default:a(()=>[t(zn,{convention:m.convention,registration:k(n)},null,8,["convention","registration"])]),_:1})):$("",!0)]),_:1}),t(Fe,{value:"emails"},{default:a(()=>[i.value=="emails"?(u(),O(ge,{key:0,class:"pa-0 mx-0",fluid:!0},{default:a(()=>[t(fo,{registration:k(n)},null,8,["registration"])]),_:1})):$("",!0)]),_:1}),t(Fe,{value:"notes"},{default:a(()=>[i.value=="notes"?(u(),O(ge,{key:0,class:"pa-0 mx-0",fluid:!0},{default:a(()=>[t(yo,{convention:m.convention,registration:k(n)},null,8,["convention","registration"])]),_:1})):$("",!0)]),_:1}),t(Fe,{value:"payments"},{default:a(()=>[i.value=="payments"?(u(),O(ge,{key:0,class:"pa-0 mx-0",fluid:!0},{default:a(()=>[t(Yo,{modelValue:k(n),"onUpdate:modelValue":l[0]||(l[0]=s=>at(n)?n.value=s:null),forms:m.forms,title:"Registration Payments"},null,8,["modelValue","forms"])]),_:1})):$("",!0)]),_:1}),t(Fe,{value:"status"},{default:a(()=>[i.value=="status"?(u(),O(ge,{key:0,class:"pa-0 mx-0",fluid:!0},{default:a(()=>[t(Ho,{modelValue:k(n),"onUpdate:modelValue":l[1]||(l[1]=s=>at(n)?n.value=s:null),forms:m.forms},null,8,["modelValue","forms"])]),_:1})):$("",!0)]),_:1}),t(Fe,{value:"tags"},{default:a(()=>[i.value=="tags"?(u(),O(ge,{key:0,class:"pa-0 mx-0",fluid:!0},{default:a(()=>[t(Qo,{modelValue:k(n),"onUpdate:modelValue":l[2]||(l[2]=s=>at(n)?n.value=s:null),title:"Registration Tags"},null,8,["modelValue"])]),_:1})):$("",!0)]),_:1})]),_:1},8,["modelValue"]))}}),Wo=(e,d)=>e===void 0?!1:ht(e,Ot.GROUP_TYPE_CONVENTION,d.ConventionUUID,d).ViewPaymentTransactions,ea=z({__name:"RegistrationActions",props:ee({accommodations:{},convention:{},extras:{},forms:{},interests:{},registration:{},tickets:{},title:{},useDialog:{type:Boolean},venues:{}},{modelValue:{type:Boolean,required:!0}}),emits:ee(["update:registration"],["update:modelValue"]),setup(e,{emit:d}){const o=e,i=ve(e,"modelValue"),n=nt(o,d,void 0,void 0,"registration"),m=f("notes"),l=Nt(),s=[{label:"Badge",value:"badges"},{label:"Emails",value:"emails"},{label:"Notes",value:"notes"},{label:"Status",value:"status"},{label:"Tags",value:"tags"}];return Wo(l,o.convention)&&s.splice(2,0,{label:"Payments",value:"payments"}),(r,T)=>r.useDialog?(u(),O(Je,{key:0,modelValue:i.value,"onUpdate:modelValue":T[3]||(T[3]=g=>i.value=g),title:r.title,"show-close-action":!0,color:"primary","close-action-label":"Close",persistent:!0,"retain-focus":!1,scrollable:!0,fullscreen:"","card-class":"ma-0 pa-0"},{extension:a(()=>[t(Qt,{modelValue:m.value,"onUpdate:modelValue":T[0]||(T[0]=g=>m.value=g),tabs:s,"show-arrows":!0},null,8,["modelValue"])]),default:a(()=>[t(Zt,{modelValue:m.value,"onUpdate:modelValue":T[1]||(T[1]=g=>m.value=g),registration:k(n),"onUpdate:registration":T[2]||(T[2]=g=>at(n)?n.value=g:null),accommodations:r.accommodations,convention:r.convention,extras:r.extras,forms:r.forms,interests:r.interests,tabs:s,tickets:r.tickets,venues:r.venues},null,8,["modelValue","registration","accommodations","convention","extras","forms","interests","tickets","venues"])]),_:1},8,["modelValue","title"])):(u(),E(P,{key:1},[t(Qt,{modelValue:m.value,"onUpdate:modelValue":T[4]||(T[4]=g=>m.value=g),tabs:s,"show-arrows":!0},null,8,["modelValue"]),t(Zt,{modelValue:m.value,"onUpdate:modelValue":T[5]||(T[5]=g=>m.value=g),registration:k(n),"onUpdate:registration":T[6]||(T[6]=g=>at(n)?n.value=g:null),accommodations:r.accommodations,convention:r.convention,extras:r.extras,forms:r.forms,interests:r.interests,tabs:s,tickets:r.tickets,venues:r.venues},null,8,["modelValue","registration","accommodations","convention","extras","forms","interests","tickets","venues"])],64))}});const Jo=(e,d=500,o=!1)=>{let i;return(...n)=>{const l=function(){i=void 0,o||e.apply(void 0,n)},s=o&&!i;clearTimeout(i),i=setTimeout(l,d),s&&e.apply(void 0,n)}},Xo=F("h4",null,"Grid Size (Max 12)",-1),Zo=z({__name:"EditAdminLayout",props:ee({layouts:{}},{modelValue:{required:!0}}),emits:ee(["change","delete"],["update:modelValue"]),setup(e,{emit:d}){const o=ve(e,"modelValue"),i=f([]),n=_e(),m=f(Object.assign({},...e.layouts.map(v=>v.Panels.map(U=>U.Items.map(N=>{const K={};return K[N.LayoutItemUUID]=N.Meta.LayoutUUID,K}))).flat(2))),l=f(`
Are you sure you wish to delete this layout? All panels relating to it will be
removed and can not be recovered. This action can not be undone once saved.
You will have to create a new layout.
`),s=f(!1),r=()=>({ID:0,LayoutPanelUUID:Ie(),AdminLayoutID:o.value.ID,AdminLayoutUUID:o.value.AdminLayoutUUID,Name:"",Order:o.value.Panels.length+1,Items:[],RequiredFormType:Te.FORM_TYPE_NIL,RequiredGroupMemberships:[],RequiredRegistrationTags:[],Meta:{}}),T=v=>()=>({ID:0,LayoutItemUUID:Ie(),LayoutPanelID:v.ID,LayoutPanelUUID:v.LayoutPanelUUID,Label:"",SourceType:be.LAYOUT_ITEM_SOURCE_FORM,SectionFieldID:void 0,SectionFieldUUID:void 0,SectionField:void 0,MetaField:void 0,UserField:void 0,Align:"",Order:v.Items.length+1,DefaultSort:!1,Meta:{}}),g=v=>{v.Meta.LayoutUUID=m.value[v.LayoutItemUUID]},A=v=>{const U=i.value.find(N=>N.value===v.SectionFieldUUID);U&&(v.SectionFieldID=U.object.ID,v.SectionField=U.object)};n.getConventionForms(o.value.ConventionUUID).then(v=>{v.forEach(U=>U.Sections.forEach(N=>N.Fields&&i.value.push(...N.Fields.map(K=>{var M;return{title:`${U.Name} - ${N.Name} - ${(M=K.Field)==null?void 0:M.Name}`,value:K.SectionFieldUUID,object:K}})))),i.value.sort(ll("title"))});const c=ie(()=>{switch(o.value.Type){case Oe.ADMIN_LAYOUT_PANELS:return"Panels";case Oe.ADMIN_LAYOUT_TABLE:return"Tabs"}return"Unknown"});return de(o,()=>{d("change")},{deep:!0}),(v,U)=>(u(),O(ge,{class:"px-0 mx-0",fluid:!0},{default:a(()=>[t(j,null,{default:a(()=>[t(b,{cols:"12",sm:"6"},{default:a(()=>[t(te,{modelValue:o.value.Name,"onUpdate:modelValue":U[0]||(U[0]=N=>o.value.Name=N),label:"Name",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),t(b,{cols:"12",sm:"6"},{default:a(()=>[t(Ue,{modelValue:o.value.Type,"onUpdate:modelValue":U[1]||(U[1]=N=>o.value.Type=N),label:"Layout Type",items:k(zl),"item-title":"title","item-value":"value",variant:"outlined","hide-details":""},null,8,["modelValue","items"])]),_:1})]),_:1}),t(j,null,{default:a(()=>[t(b,null,{default:a(()=>[t(Vt,{modelValue:o.value.Panels,"onUpdate:modelValue":U[2]||(U[2]=N=>o.value.Panels=N),"new-item":r,closeable:!1,title:c.value,label:"Name","slot-name-prefix":"panel"},We({_:2},[W(o.value.Panels,(N,K)=>({name:`panel_${K}`,fn:a(()=>[t(ge,{class:"px-0 mx-0",fluid:!0},{default:a(()=>[t(j,null,{default:a(()=>[t(b,{cols:"12",sm:"6"},{default:a(()=>[t(te,{modelValue:N.Name,"onUpdate:modelValue":p=>N.Name=p,label:"Name",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),t(b,{cols:"12",sm:"6"},{default:a(()=>[t(Ue,{modelValue:N.RequiredFormType,"onUpdate:modelValue":p=>N.RequiredFormType=p,items:k(il),clearable:!0,label:"Required Form",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"])]),_:2},1024)]),_:2},1024),t(j,null,{default:a(()=>[t(b,{cols:"12",sm:"6"},{default:a(()=>[t(ga,{label:"Required Groups",variant:"outlined",modelValue:N.RequiredGroupMemberships,"onUpdate:modelValue":p=>N.RequiredGroupMemberships=p,convention:o.value.ConventionUUID,chips:"",clearable:"",hint:"Groups that a user must be in to see this panel. (Any one)"},null,8,["modelValue","onUpdate:modelValue","convention"])]),_:2},1024),t(b,{cols:"12",sm:"6"},{default:a(()=>[t(pa,{label:"Registration Tags",variant:"outlined",modelValue:N.RequiredRegistrationTags,"onUpdate:modelValue":p=>N.RequiredRegistrationTags=p,convention:o.value.ConventionUUID,chips:"",clearable:"",hint:"Tags that a registration must have to appear in results. (Any one)"},null,8,["modelValue","onUpdate:modelValue","convention"])]),_:2},1024)]),_:2},1024),o.value.Type===k(Oe).ADMIN_LAYOUT_PANELS?(u(),O(j,{key:0},{default:a(()=>[t(b,{cols:"12",class:"py-0 my-0"},{default:a(()=>[Xo]),_:1}),t(b,{cols:"6",sm:"4",lg:"2"},{default:a(()=>[t(te,{modelValue:N.Meta.cols,"onUpdate:modelValue":p=>N.Meta.cols=p,modelModifiers:{number:!0},clearable:!0,"hide-details":"",label:"Default",type:"number",min:"1",max:"12"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),t(b,{cols:"6",sm:"4",lg:"2"},{default:a(()=>[t(te,{modelValue:N.Meta.cols_xs,"onUpdate:modelValue":p=>N.Meta.cols_xs=p,modelModifiers:{number:!0},clearable:!0,"hide-details":"",label:"XS",type:"number",min:"1",max:"12"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),t(b,{cols:"6",sm:"4",lg:"2"},{default:a(()=>[t(te,{modelValue:N.Meta.cols_sm,"onUpdate:modelValue":p=>N.Meta.cols_sm=p,modelModifiers:{number:!0},clearable:!0,"hide-details":"",label:"SM",type:"number",min:"1",max:"12"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),t(b,{cols:"6",sm:"4",lg:"2"},{default:a(()=>[t(te,{modelValue:N.Meta.cols_md,"onUpdate:modelValue":p=>N.Meta.cols_md=p,modelModifiers:{number:!0},clearable:!0,"hide-details":"",label:"MD",type:"number",min:"1",max:"12"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),t(b,{cols:"6",sm:"4",lg:"2"},{default:a(()=>[t(te,{modelValue:N.Meta.cols_lg,"onUpdate:modelValue":p=>N.Meta.cols_lg=p,modelModifiers:{number:!0},clearable:!0,"hide-details":"",label:"LG",type:"number",min:"1",max:"12"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),t(b,{cols:"6",sm:"4",lg:"2"},{default:a(()=>[t(te,{modelValue:N.Meta.cols_xl,"onUpdate:modelValue":p=>N.Meta.cols_xl=p,modelModifiers:{number:!0},clearable:!0,"hide-details":"",label:"XL",type:"number",min:"1",max:"12"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)):$("",!0)]),_:2},1024),t(Vt,{modelValue:N.Items,"onUpdate:modelValue":p=>N.Items=p,"new-item":T(N),closeable:!1,title:"Items",label:"Label","slot-name-prefix":"item"},We({_:2},[W(N.Items,(p,M)=>({name:`item_${M}`,fn:a(()=>[t(ge,{class:"px-0 mx-0",fluid:!0},{default:a(()=>[t(j,null,{default:a(()=>[t(b,{cols:"12",sm:"6"},{default:a(()=>[t(te,{modelValue:p.Label,"onUpdate:modelValue":V=>p.Label=V,label:"Name",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024),t(j,null,{default:a(()=>[t(b,{cols:"12",sm:"6"},{default:a(()=>[t(Ue,{modelValue:p.SourceType,"onUpdate:modelValue":V=>p.SourceType=V,label:"Source Type",items:k(Kl),"item-title":"title","item-value":"value",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"])]),_:2},1024),t(b,{cols:"12",sm:"6"},{default:a(()=>[p.SourceType==="LAYOUT_ITEM_SOURCE_FORM"?(u(),O(Ue,{key:0,modelValue:p.SectionFieldUUID,"onUpdate:modelValue":V=>p.SectionFieldUUID=V,label:"Form Data",items:i.value,"item-title":"title","item-value":"value",variant:"outlined","hide-details":"",onBlur:V=>A(p)},null,8,["modelValue","onUpdate:modelValue","items","onBlur"])):p.SourceType==="LAYOUT_ITEM_SOURCE_META"?(u(),O(Ue,{key:1,modelValue:p.MetaField,"onUpdate:modelValue":V=>p.MetaField=V,label:"Miscellaneous Data",items:k(Ql),"item-title":"title","item-value":"value",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"])):p.SourceType==="LAYOUT_ITEM_SOURCE_USER"?(u(),O(Ue,{key:2,modelValue:p.UserField,"onUpdate:modelValue":V=>p.UserField=V,label:"User Profile Data",items:k(Wl),"item-title":"title","item-value":"value",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"])):$("",!0)]),_:2},1024)]),_:2},1024),v.layouts&&p.SourceType==="LAYOUT_ITEM_SOURCE_META"&&p.MetaField===k(Z).META_DATA_SOURCE_DATA_LAYOUT?(u(),O(j,{key:0},{default:a(()=>[t(b,{cols:"6",sm:"4",lg:"2"},{default:a(()=>[t(Ue,{modelValue:m.value[p.LayoutItemUUID],"onUpdate:modelValue":[V=>m.value[p.LayoutItemUUID]=V,V=>g(p)],clearable:!0,items:v.layouts.filter(V=>V.Type===k(Oe).ADMIN_LAYOUT_PANELS)||[],multiple:!0,label:"Data Display","item-title":"Name","item-value":"AdminLayoutUUID",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"])]),_:2},1024)]),_:2},1024)):$("",!0),o.value.Type===k(Oe).ADMIN_LAYOUT_TABLE&&(p.SourceType!==k(be).LAYOUT_ITEM_SOURCE_META||p.MetaField!==k(Z).META_DATA_SOURCE_DATA_LAYOUT)?(u(),O(j,{key:1},{default:a(()=>[t(b,null,{default:a(()=>[t(ia,{modelValue:p.DefaultSort,"onUpdate:modelValue":V=>p.DefaultSort=V,label:"Default Sort","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)):$("",!0)]),_:2},1024)])}))]),1032,["modelValue","onUpdate:modelValue","new-item"])])}))]),1032,["modelValue","title"])]),_:1})]),_:1}),t(j,null,{default:a(()=>[t(b,null,{default:a(()=>[t(H,{onClick:U[3]||(U[3]=N=>s.value=!0),"prepend-icon":"mdi:mdi-delete",color:"red-darken-4"},{default:a(()=>[h("Delete Layout")]),_:1})]),_:1})]),_:1}),s.value?(u(),O(Ta,{key:0,modelValue:s.value,"onUpdate:modelValue":U[4]||(U[4]=N=>s.value=N),message:l.value,title:"Delete Layout",subtitle:"Removes this layout and all it's panels",onDelete:U[5]||(U[5]=N=>d("delete"))},null,8,["modelValue","message"])):$("",!0)]),_:1}))}}),ei=z({__name:"EditAdminLayouts",props:ee({title:{},convention:{}},{modelValue:{type:Boolean,required:!0}}),emits:ee(["save"],["update:modelValue"]),setup(e,{emit:d}){const o=ve(e,"modelValue"),i=f([]),n=f([]),m=f([]),l=_e(),s=()=>({ID:0,AdminLayoutUUID:Ie(),ConventionID:e.convention.ID,ConventionUUID:e.convention.ConventionUUID,Name:"New Layout",Type:Oe.ADMIN_LAYOUT_PANELS,Panels:[]}),r=()=>{let g=!1;[...new Set(m.value)].forEach(c=>{const v=i.value.findIndex(U=>U.AdminLayoutUUID===c);v<0||v>=i.value.length||(l.saveAdminLayout(i.value[v]).then(U=>{U&&i.value.splice(v,1,U)}).catch(()=>{}),g=!0)}),n.value.forEach(c=>{l.deleteAdminLayout(c).catch(()=>{})}),n.value=[],m.value=[],g&&d("save")},T=g=>{const A=i.value.findIndex(c=>c.AdminLayoutUUID===g.AdminLayoutUUID);A<0||A>=i.value.length||(i.value[A].ID>0&&n.value.push(g.AdminLayoutUUID),i.value.splice(A,1))};return l.getConventionAdminLayouts(e.convention.ConventionUUID).then(g=>{g&&(i.value=g)}).catch(()=>[]),(g,A)=>(u(),O(dt,{modelValue:o.value,"onUpdate:modelValue":A[2]||(A[2]=c=>o.value=c),scrollable:!0,"retain-focus":!0,persistent:!0,fullscreen:!0},{default:a(()=>[t(Vt,{modelValue:i.value,"onUpdate:modelValue":A[0]||(A[0]=c=>i.value=c),"new-item":s,closeable:!0,"show-delete":!1,"show-save":!0,"has-order":!1,title:g.title,label:"Name","slot-name-prefix":"panel",onClose:A[1]||(A[1]=c=>o.value=!1),onSave:r},We({_:2},[W(i.value,(c,v)=>({name:`panel_${v}`,fn:a(()=>[t(ge,{class:"px-0 mx-0",fluid:!0},{default:a(()=>[t(j,null,{default:a(()=>[t(b,{cols:"12"},{default:a(()=>[t(Zo,{modelValue:i.value[v],"onUpdate:modelValue":U=>i.value[v]=U,layouts:i.value,onChange:U=>m.value.push(c.AdminLayoutUUID),onDelete:U=>T(c)},null,8,["modelValue","onUpdate:modelValue","layouts","onChange","onDelete"])]),_:2},1024)]),_:2},1024)]),_:2},1024)])}))]),1032,["modelValue","title"])]),_:1},8,["modelValue"]))}});function ti(){const e=f([]);qa(()=>e.value=[]);function d(o,i){e.value[i]=o}return{refs:e,updateRef:d}}const ai=ta({activeColor:String,start:{type:[Number,String],default:1},modelValue:{type:Number,default:e=>e.start},disabled:Boolean,length:{type:[Number,String],default:1,validator:e=>e%1===0},totalVisible:[Number,String],firstIcon:{type:st,default:"$first"},prevIcon:{type:st,default:"$prev"},nextIcon:{type:st,default:"$next"},lastIcon:{type:st,default:"$last"},ariaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.root"},pageAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.page"},currentPageAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.currentPage"},firstAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.first"},previousAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.previous"},nextAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.next"},lastAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.last"},ellipsis:{type:String,default:"..."},showFirstLastPage:Boolean,...rl(),...dl(),...ml(),...cl(),...vl(),...fl(),...Ul({tag:"nav"}),...ja(),...gl({variant:"text"})},"VPagination"),li=aa()({name:"VPagination",props:ai(),emits:{"update:modelValue":e=>!0,first:e=>!0,prev:e=>!0,next:e=>!0,last:e=>!0},setup(e,d){let{slots:o,emit:i}=d;const n=za(e,"modelValue"),{t:m,n:l}=Ka(),{isRtl:s}=Qa(),{themeClasses:r}=Wa(e),{width:T}=Ja(),g=Xa(-1);St(void 0,{scoped:!0});const{resizeRef:A}=_l(I=>{if(!I.length)return;const{target:D,contentRect:S}=I[0],L=D.querySelector(".v-pagination__list > *");if(!L)return;const B=S.width,le=L.offsetWidth+parseFloat(getComputedStyle(L).marginRight)*2;g.value=N(B,le)}),c=ie(()=>parseInt(e.length,10)),v=ie(()=>parseInt(e.start,10)),U=ie(()=>e.totalVisible?parseInt(e.totalVisible,10):g.value>=0?g.value:N(T.value,58));function N(I,D){const S=e.showFirstLastPage?5:3;return Math.max(0,Math.floor(+((I-D*S)/D).toFixed(2)))}const K=ie(()=>{if(c.value<=0||isNaN(c.value)||c.value>Number.MAX_SAFE_INTEGER)return[];if(U.value<=1)return[n.value];if(c.value<=U.value)return ut(c.value,v.value);const I=U.value%2===0,D=I?U.value/2:Math.floor(U.value/2),S=I?D:D+1,L=c.value-D;if(S-n.value>=0)return[...ut(Math.max(1,U.value-1),v.value),e.ellipsis,c.value];if(n.value-L>=(I?1:0)){const B=U.value-1,le=c.value-B+v.value;return[v.value,e.ellipsis,...ut(B,le)]}else{const B=Math.max(1,U.value-3),le=B===1?n.value:n.value-Math.ceil(B/2)+v.value;return[v.value,e.ellipsis,...ut(B,le),e.ellipsis,c.value]}});function p(I,D,S){I.preventDefault(),n.value=D,S&&i(S,D)}const{refs:M,updateRef:V}=ti();St({VPaginationBtn:{color:Ae(e,"color"),border:Ae(e,"border"),density:Ae(e,"density"),size:Ae(e,"size"),variant:Ae(e,"variant"),rounded:Ae(e,"rounded"),elevation:Ae(e,"elevation")}});const ae=ie(()=>K.value.map((I,D)=>{const S=L=>V(L,D);if(typeof I=="string")return{isActive:!1,key:`ellipsis-${D}`,page:I,props:{ref:S,ellipsis:!0,icon:!0,disabled:!0}};{const L=I===n.value;return{isActive:L,key:I,page:l(I),props:{ref:S,ellipsis:!1,icon:!0,disabled:!!e.disabled||+e.length<2,color:L?e.activeColor:e.color,ariaCurrent:L,ariaLabel:m(L?e.currentPageAriaLabel:e.pageAriaLabel,I),onClick:B=>p(B,I)}}}})),x=ie(()=>{const I=!!e.disabled||n.value<=v.value,D=!!e.disabled||n.value>=v.value+c.value-1;return{first:e.showFirstLastPage?{icon:s.value?e.lastIcon:e.firstIcon,onClick:S=>p(S,v.value,"first"),disabled:I,ariaLabel:m(e.firstAriaLabel),ariaDisabled:I}:void 0,prev:{icon:s.value?e.nextIcon:e.prevIcon,onClick:S=>p(S,n.value-1,"prev"),disabled:I,ariaLabel:m(e.previousAriaLabel),ariaDisabled:I},next:{icon:s.value?e.prevIcon:e.nextIcon,onClick:S=>p(S,n.value+1,"next"),disabled:D,ariaLabel:m(e.nextAriaLabel),ariaDisabled:D},last:e.showFirstLastPage?{icon:s.value?e.firstIcon:e.lastIcon,onClick:S=>p(S,v.value+c.value-1,"last"),disabled:D,ariaLabel:m(e.lastAriaLabel),ariaDisabled:D}:void 0}});function ne(){var D;const I=n.value-v.value;(D=M.value[I])==null||D.$el.focus()}function J(I){I.key===Gt.left&&!e.disabled&&n.value>+e.start?(n.value=n.value-1,Qe(ne)):I.key===Gt.right&&!e.disabled&&n.value<v.value+c.value-1&&(n.value=n.value+1,Qe(ne))}return da(()=>t(e.tag,{ref:A,class:["v-pagination",r.value,e.class],style:e.style,role:"navigation","aria-label":m(e.ariaLabel),onKeydown:J,"data-test":"v-pagination-root"},{default:()=>[t("ul",{class:"v-pagination__list"},[e.showFirstLastPage&&t("li",{key:"first",class:"v-pagination__first","data-test":"v-pagination-first"},[o.first?o.first(x.value.first):t(H,Ve({_as:"VPaginationBtn"},x.value.first),null)]),t("li",{key:"prev",class:"v-pagination__prev","data-test":"v-pagination-prev"},[o.prev?o.prev(x.value.prev):t(H,Ve({_as:"VPaginationBtn"},x.value.prev),null)]),ae.value.map((I,D)=>t("li",{key:I.key,class:["v-pagination__item",{"v-pagination__item--is-active":I.isActive}],"data-test":"v-pagination-item"},[o.item?o.item(I):t(H,Ve({_as:"VPaginationBtn"},I.props),{default:()=>[I.page]})])),t("li",{key:"next",class:"v-pagination__next","data-test":"v-pagination-next"},[o.next?o.next(x.value.next):t(H,Ve({_as:"VPaginationBtn"},x.value.next),null)]),e.showFirstLastPage&&t("li",{key:"last",class:"v-pagination__last","data-test":"v-pagination-last"},[o.last?o.last(x.value.last):t(H,Ve({_as:"VPaginationBtn"},x.value.last),null)])])]})),{}}}),ni=["colspan"],oi={style:{opacity:"var(--v-medium-emphasis-opacity)"}},qi=z({__name:"RegistrationsView",emits:["pageTitle"],setup(e,{emit:d}){var Ft;const o=va();d("pageTitle","Registration Manager");const i=Za(),n=el(),m=f(!0);let l=((Ft=i.params.convention)==null?void 0:Ft.toString())||"";const s=f({ID:0,ConventionUUID:Ie(),OrganisationID:0,OrganisationUUID:Dt,Name:"New Convention",Description:"",DetailLink:"",Logo:"",Slug:"",Accommodation:[],Tickets:[],Extras:[],Interests:[],Visible:!1}),r=_e(),T=tl.getInstance(),g=f([]),A=f({ID:0,AdminLayoutUUID:Ie(),ConventionID:s.value.ID,ConventionUUID:s.value.ConventionUUID,Name:"Registration Table",Type:Oe.ADMIN_LAYOUT_TABLE,Panels:[]}),c=f([]),v=f([]),U=f([]),N=f([]),K=f([]),p=f([]),M=f(1),V=f(10),ae=f([]),x=f(0),ne=f(!1),J=f(""),I=f(""),D=f(""),S=f(""),L=f({FieldUUID:"591c9bca-c78c-4e97-8aef-bc596ef472fb",Value:""}),B=f({FieldUUID:"50189b21-6c55-4c99-a38f-7740a01ec4a4",Value:""}),le=f({FieldUUID:"1523ef15-f2c3-46b9-a687-dcd7bc2c0a50",Value:""}),fe=f({FieldUUID:"926d43c6-a743-4ab7-bef2-060d762d37a9",Value:""}),me=f(new Map([["591c9bca-c78c-4e97-8aef-bc596ef472fb",L.value],["50189b21-6c55-4c99-a38f-7740a01ec4a4",B.value],["1523ef15-f2c3-46b9-a687-dcd7bc2c0a50",le.value],["926d43c6-a743-4ab7-bef2-060d762d37a9",fe.value]])),Ye=f(""),He=f(""),Ze=f([]),qe=f([]),De=f([]),ke=f([]),Me=f([]),Ne=f([]),Se=f(0),ye=f(),Le=f(!1),Lt=f(!1),Ra=f(!1),ot=f(),wt=f(),pt=f(),je=f(!1),Ca=Nt(),ce=Jo(()=>{I.value=Date.now().toString()});de(J,y=>{const _=p.value.find(w=>w.uuid===y);if(_){const w=_.headers.find(R=>R.defaultSort===!0);w&&(ae.value=[{key:w.key,order:"asc"}],Ze.value=[{key:w.key,order:"asc"}])}}),de(Se,y=>{y===7&&Pt()}),de(Ye,()=>{ce()}),de(He,()=>{ce()});const Va=()=>{c.value=[],U.value=[],N.value=[],p.value=[];try{r.getConventionAdminLayoutByName(s.value.ConventionUUID,"Registration Table").then(y=>{Se.value+=1,y?A.value=y:(A.value.ConventionID=s.value.ID,A.value.ConventionUUID=s.value.ConventionUUID)})}catch{A.value.ConventionID=s.value.ID,A.value.ConventionUUID=s.value.ConventionUUID}try{r.getConventionAdminLayouts(s.value.ConventionUUID).then(y=>{Se.value+=1,y&&(U.value=y)})}catch{}try{r.getConventionForms(s.value.ConventionUUID).then(y=>{Se.value+=1,y&&(c.value=y)})}catch{}try{r.getConventionAccommodation(s.value.ConventionUUID).then(y=>{Se.value+=1,y&&(qe.value=y)})}catch{}try{r.getConventionVenues(s.value.ConventionUUID).then(y=>{Se.value+=1,y&&(Ne.value=y)})}catch{}try{r.getConventionExtras(s.value.ConventionUUID).then(y=>{Se.value+=1,y&&(De.value=y)})}catch{}try{r.getConventionInterests(s.value.ConventionUUID).then(y=>{Se.value+=1,y&&(ke.value=y)})}catch{}try{r.getConventionTickets(s.value.ConventionUUID).then(y=>{Se.value+=1,y&&(Me.value=y)})}catch{}try{r.getConventionGroups(s.value.ConventionUUID).then(y=>{y&&(v.value=y.sort((_,w)=>_.Name.localeCompare(w.Name)))})}catch{}try{r.getConventionTags(s.value.ConventionUUID).then(y=>{y&&(K.value=y.sort((_,w)=>_.Title.localeCompare(w.Title)).map(_=>(_.Title=`${_.Title} [${_.Key}]`,_)))})}catch{}},_t=({page:y,itemsPerPage:_,sortBy:w})=>{m.value=!0,M.value=y,ae.value=w;const R=p.value.find(se=>se.uuid==J.value),re=R==null?void 0:R.layout.Items;let oe="",$t="";if(w&&re&&w.length>=1){const se=re.find(Tt=>Tt.LayoutItemUUID==w[0].key);switch($t=w[0].order||"asc",se==null?void 0:se.MetaField){case Z.META_DATA_SOURCE_ACCOMMODATION_FORM:oe="submission.status";break;case Z.META_DATA_SOURCE_BADGE_FORM:oe="submission.status";break;case Z.META_DATA_SOURCE_DEALER_FORM:oe="submission.status";break;case Z.META_DATA_SOURCE_REGISTRATION_FORM:oe="submission.status";break;case Z.META_DATA_SOURCE_REGISTRATION_REFERENCE:oe="reference";break;case Z.META_DATA_SOURCE_SUBMISSION_DATE:oe="created";break;case Z.META_DATA_SOURCE_SUBMISSION_STATUS:oe="submission.status";break}switch(se==null?void 0:se.UserField){case ue.USER_DATA_SOURCE_DISPLAY_NAME:oe="user.display_name";break;case ue.USER_DATA_SOURCE_EMAIL:oe="user.email";break;case ue.USER_DATA_SOURCE_FIRST_NAME:oe="user.firstname";break;case ue.USER_DATA_SOURCE_HANDLE:oe="user.handle";break;case ue.USER_DATA_SOURCE_LAST_NAME:oe="user.lastname";break}}try{const se={Direction:$t,Limit:_,Offset:(y-1)*_,Order:oe};R&&R.layout.RequiredRegistrationTags.length>0&&(se.PanelUUID=R==null?void 0:R.layout.LayoutPanelUUID),(R==null?void 0:R.layout.RequiredFormType)===Te.FORM_TYPE_ACCOMMODATION&&(se.Accommodation=!0),(R==null?void 0:R.layout.RequiredFormType)===Te.FORM_TYPE_BADGE&&(se.Badge=!0),(R==null?void 0:R.layout.RequiredFormType)===Te.FORM_TYPE_DEALER&&(se.Dealer=!0),(R==null?void 0:R.layout.RequiredFormType)===Te.FORM_TYPE_REGISTRATION&&(se.Registration=!0),se.GroupUUID=Ye.value||Dt,se.TagUUID=He.value||Dt,se.Email=S.value,se.Reference=D.value,se.FieldValues=Array.from(me.value.values());const Tt=I.value;r.searchConventionRegistrations(s.value.ConventionUUID,se).then(yt=>{yt&&Tt===I.value&&(x.value=yt.Total,N.value=yt.Registrations,p.value.forEach(It=>{const Pa=It.layout;It.items=N.value.map(q=>{const it=[];let Re;q.Leader?Re=q:Re=q.Primary,it.push({Name:Re.User.DisplayName,UUID:Re.UserUUID,UserUUID:Re.User.UserUUID,IsLeader:!0,Reference:Re.Reference,Paid:Re.Paid,Total:Re.Total}),it.push(...Re.Members.map(Ce=>({Name:Ce.User.DisplayName,UUID:Ce.UserUUID,UserUUID:Ce.User.UserUUID,IsLeader:!1,Reference:Ce.Reference,Paid:Ce.Paid,Total:Ce.Total})));const X={};return It.headers.forEach(Ce=>{var xt;const Y=Pa.Items.find(et=>et.LayoutItemUUID===Ce.key);if(Y){if(Y.SourceType==="LAYOUT_ITEM_SOURCE_FORM"&&Y.SectionField)q.Submissions.forEach(et=>{const ze=et.Data.find(G=>G.SectionFieldUUID===Y.SectionFieldUUID);if(ze){Ce.type===ol.ACCOMMODATION?X[Y.LayoutItemUUID]={Data:ze.Data,Registration:q}:X[Y.LayoutItemUUID]=ze.Data;return}});else if(Y.SourceType==="LAYOUT_ITEM_SOURCE_USER"&&Y.UserField)switch(Y.UserField){case ue.USER_DATA_SOURCE_AVATAR:X[Y.LayoutItemUUID]=o.GetProfileImageURL(q.UserUUID);break;case ue.USER_DATA_SOURCE_DISPLAY_NAME:X[Y.LayoutItemUUID]=q.User.DisplayName;break;case ue.USER_DATA_SOURCE_EMAIL:X[Y.LayoutItemUUID]=q.User.Additional.Email;break;case ue.USER_DATA_SOURCE_HANDLE:X[Y.LayoutItemUUID]=q.User.Handle;break;case ue.USER_DATA_SOURCE_DATE_OF_BIRTH:X[Y.LayoutItemUUID]=q.User.Additional.DOB;break;case ue.USER_DATA_SOURCE_FIRST_NAME:X[Y.LayoutItemUUID]=q.User.Additional.FirstName;break;case ue.USER_DATA_SOURCE_LAST_NAME:X[Y.LayoutItemUUID]=q.User.Additional.LastName;break;case ue.USER_DATA_SOURCE_TELEGRAM:X[Y.LayoutItemUUID]="";break}else if(Y.SourceType==="LAYOUT_ITEM_SOURCE_META"&&Y.MetaField){const et=(xt=c.value.find(G=>G.Type===Te.FORM_TYPE_REGISTRATION))==null?void 0:xt.FormUUID,ze=q.Submissions.find(G=>G.FormUUID===et);switch(Y.MetaField){case Z.META_DATA_SOURCE_REGISTRATION_ACTIONS:X[Y.LayoutItemUUID]=q;break;case Z.META_DATA_SOURCE_REGISTRATION_GROUP:X[Y.LayoutItemUUID]=it;break;case Z.META_DATA_SOURCE_REGISTRATION_REFERENCE:X[Y.LayoutItemUUID]=q.Reference;break;case Z.META_DATA_SOURCE_SUBMISSION_DATE:if(ze){const G=new Date(ze.CreatedAt||"");X[Y.LayoutItemUUID]=`${G.getFullYear()}-${(G.getMonth()+1).toString().padStart(2,"0")}-${G.getDate().toString().padStart(2,"0")} ${G.getHours().toString().padStart(2,"0")}:${G.getMinutes().toString().padStart(2,"0")}:${G.getSeconds().toString().padStart(2,"0")}`}else{const G=new Date(q.CreatedAt||"");X[Y.LayoutItemUUID]=`${G.getFullYear()}-${(G.getMonth()+1).toString().padStart(2,"0")}-${G.getDate().toString().padStart(2,"0")} ${G.getHours().toString().padStart(2,"0")}:${G.getMinutes().toString().padStart(2,"0")}:${G.getSeconds().toString().padStart(2,"0")}`}break;case Z.META_DATA_SOURCE_ACCOMMODATION_FORM:X[Y.LayoutItemUUID]=q.Submissions.map(G=>{const Q=c.value.find(we=>we.FormUUID===G.FormUUID);return{Heading:Q==null?void 0:Q.Heading,Form:Q,Submission:G,Registration:q}}).filter(G=>{var Q;return((Q=G.Form)==null?void 0:Q.Type)===Te.FORM_TYPE_ACCOMMODATION});break;case Z.META_DATA_SOURCE_BADGE_FORM:X[Y.LayoutItemUUID]=q.Submissions.map(G=>{const Q=c.value.find(we=>we.FormUUID===G.FormUUID);return{Heading:Q==null?void 0:Q.Heading,Form:Q,Submission:G,Registration:q}}).filter(G=>{var Q;return((Q=G.Form)==null?void 0:Q.Type)===Te.FORM_TYPE_BADGE});break;case Z.META_DATA_SOURCE_DEALER_FORM:X[Y.LayoutItemUUID]=q.Submissions.map(G=>{const Q=c.value.find(we=>we.FormUUID===G.FormUUID);return{Heading:Q==null?void 0:Q.Heading,Form:Q,Submission:G,Registration:q}}).filter(G=>{var Q;return((Q=G.Form)==null?void 0:Q.Type)===Te.FORM_TYPE_DEALER});break;case Z.META_DATA_SOURCE_PAYMENT_STATUS:if(q.Paid===0&&q.Total)X[Y.LayoutItemUUID]="REQUIRED";else if(q.Total>q.Paid)X[Y.LayoutItemUUID]="ADDITIONAL_REQUIRED";else{const G=it.find(Q=>Q.Paid===0&&(Q.Total||0)>0);if(G){q.Total===0&&G.Total===0?X[Y.LayoutItemUUID]="NOT_REQUIRED":q.Total===0&&G.Total||q.Total>0&&G.Total===0?X[Y.LayoutItemUUID]="MISSING_REQUIRED":q.Paid>=q.Total?X[Y.LayoutItemUUID]="AWAITING_PARTNER":X[Y.LayoutItemUUID]="ALL_REQUIRED";break}else q.Total===0?X[Y.LayoutItemUUID]="NOT_REQUIRED":X[Y.LayoutItemUUID]="COMPLETE"}break;case Z.META_DATA_SOURCE_SUBMISSION_STATUS:yl(q.Submissions,c.value),X[Y.LayoutItemUUID]=q.Submissions.map(G=>{const Q=c.value.find(we=>we.FormUUID===G.FormUUID);return{Heading:Q==null?void 0:Q.Heading,Form:Q,Submission:G,Registration:q}});break;case Z.META_DATA_SOURCE_DATA_LAYOUT:X[Y.LayoutItemUUID]={Registration:q,Layouts:U.value.filter(G=>{if(Y.Meta&&Y.Meta.LayoutUUID&&Array.isArray(Y.Meta.LayoutUUID))return Y.Meta.LayoutUUID.includes(G.AdminLayoutUUID)})};break}}}}),{key:q.RegistrationUUID,registration:q,...X}})}),m.value=!1)})}catch{}},ba=y=>{ne.value=!1,y&&(A.value=y,Pt())},Pt=()=>{A.value.Panels.forEach(y=>{y.Items.forEach(_=>{(_.SectionField==null||_.SectionField.Field==null)&&c.value.find(w=>{w.Sections.find(R=>{if(R.Fields){const re=R.Fields.find(oe=>oe.SectionFieldUUID===_.SectionFieldUUID);if(re)return _.SectionField=re,!0}})})})}),A.value.Panels.length>0&&(p.value=[],A.value.Panels.forEach(y=>{const _={uuid:Ie(),order:y.Order,name:y.Name,headers:[],items:[],layout:y};y.Items.sort((w,R)=>w.Order>R.Order?1:w.Order==R.Order?0:-1),_.headers=y.Items.map(w=>{var R,re;return{key:w.LayoutItemUUID,title:w.Label||((re=(R=w.SectionField)==null?void 0:R.Field)==null?void 0:re.Label)||"",align:w.Align==="end"?"end":"start",sortable:ha(w),type:Oa(w),defaultSort:w.DefaultSort,meta:w.Meta}}),p.value.push(_)}),p.value=p.value.sort((y,_)=>y.order>_.order?1:y.order==_.order?0:-1)),(J.value==null||J.value=="")&&p.value.length>0&&(J.value=p.value[0].uuid)};l?r.getConvention(l).then(y=>{y&&(s.value=y,A.value.ConventionID=s.value.ID,A.value.ConventionUUID=s.value.ConventionUUID,Va())}).catch(()=>{n.push("/")}):n.push("/");const Oa=y=>{var _,w;if(y.SourceType===be.LAYOUT_ITEM_SOURCE_META)return`${y.SourceType}.${y.MetaField}`;if(y.SourceType===be.LAYOUT_ITEM_SOURCE_FORM)return(w=(_=y.SectionField)==null?void 0:_.Field)==null?void 0:w.Type;if(y.SourceType===be.LAYOUT_ITEM_SOURCE_USER)return`${y.SourceType}.${y.UserField}`},ha=y=>{const _=[Z.META_DATA_SOURCE_ACCOMMODATION_FORM,Z.META_DATA_SOURCE_BADGE_FORM,Z.META_DATA_SOURCE_DEALER_FORM,Z.META_DATA_SOURCE_REGISTRATION_FORM,Z.META_DATA_SOURCE_REGISTRATION_REFERENCE,Z.META_DATA_SOURCE_SUBMISSION_DATE,Z.META_DATA_SOURCE_SUBMISSION_STATUS],w=[ue.USER_DATA_SOURCE_DISPLAY_NAME,ue.USER_DATA_SOURCE_EMAIL,ue.USER_DATA_SOURCE_HANDLE,ue.USER_DATA_SOURCE_DATE_OF_BIRTH,ue.USER_DATA_SOURCE_FIRST_NAME,ue.USER_DATA_SOURCE_LAST_NAME];return _.includes(y.MetaField)||w.includes(y.UserField)},ka=y=>{ye.value=y,Le.value=!0},Ma=y=>{ye.value=y,Lt.value=!0},Na=y=>{ye.value=y,Ra.value=!0};de(Le,y=>{y||(ye.value=void 0)}),de(Lt,y=>{y||(ye.value=void 0)});const At=async(y="")=>{wt.value=await r.getRegistrationGroup(y)},La=({registration:y,form:_,submission:w})=>{ye.value=y,At(y.RegistrationUUID).then(()=>{ot.value=_,pt.value=w,je.value=!0})},wa=y=>{r.switchUser(y.UserUUID).then(_=>{_&&Hl(_.tokens,_.user,n,!1)}).catch(_=>{console.error(_)})};return T.on("registration.group.leave",y=>{r.leaveRegistrationGroup(y).then(_=>{_&&At(y).then(()=>{T.emit("registration.group.left",_)})})}),T.on("registration.group.remove.member",y=>{r.leaveRegistrationGroup(y).then(_=>{_&&At(y).then(()=>{T.emit("registration.group.left",_)})})}),(y,_)=>(u(),O(jl,null,{default:a(()=>[t(bt,{color:"blue-darken-4"},{default:a(()=>[t(fa,{modelValue:J.value,"onUpdate:modelValue":_[0]||(_[0]=w=>J.value=w),"show-arrows":""},{default:a(()=>[(u(!0),E(P,null,W(p.value,w=>(u(),O(Ua,{key:w.uuid,value:w.uuid},{default:a(()=>[h(C(w.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"]),t(xe),t(H,{icon:"mdi:mdi-cog-outline",onClick:_[1]||(_[1]=w=>ne.value=!0)})]),_:1}),t(_a,{modelValue:J.value,"onUpdate:modelValue":_[23]||(_[23]=w=>J.value=w),disabled:!0,touch:!1},{default:a(()=>[(u(!0),E(P,null,W(p.value,w=>(u(),O(Fe,{key:w.uuid,value:w.uuid},{default:a(()=>[w.uuid===J.value?(u(),O(he,{key:0,class:"pa-2"},{default:a(()=>[t(k(en),{expanded:g.value,"onUpdate:expanded":_[19]||(_[19]=R=>g.value=R),page:M.value,"onUpdate:page":_[20]||(_[20]=R=>M.value=R),"items-per-page":V.value,"onUpdate:itemsPerPage":_[21]||(_[21]=R=>V.value=R),"sort-by":Ze.value,"onUpdate:sortBy":_[22]||(_[22]=R=>Ze.value=R),headers:w.headers,"items-length":x.value,items:w.items,"item-value":"key",loading:m.value,search:I.value,"onUpdate:options":_t,"show-expand":""},We({top:a(()=>[t(Ut,{class:"mb-3"},{default:a(()=>[t(ft,null,{default:a(()=>[t(ct,{color:"secondary",class:"font-weight-bold pb-0 pt-0"},{default:a(()=>[t(b,{class:"pa-0"},{default:a(()=>[h(" Search Criteria "),t(rt,{class:"pl-5",icon:"mdi:mdi-credit-card-search-outline"})]),_:1}),t(b,{class:"d-none d-sm-block pa-0",cols:"0"},{default:a(()=>[t(te,{modelValue:D.value,"onUpdate:modelValue":_[2]||(_[2]=R=>D.value=R),label:"Badge No.",clearable:!0,"hide-details":"",variant:"plain",onClick:_[3]||(_[3]=Rt(()=>{},["stop"])),"onClick:clear":k(ce),onInput:k(ce)},null,8,["modelValue","onClick:clear","onInput"])]),_:1}),t(b,{class:"d-none d-md-block pa-0"},{default:a(()=>[t(te,{modelValue:L.value.Value,"onUpdate:modelValue":_[4]||(_[4]=R=>L.value.Value=R),label:"Furry Name",clearable:!0,"hide-details":"",variant:"plain",onClick:_[5]||(_[5]=Rt(()=>{},["stop"])),"onClick:clear":k(ce),onInput:k(ce)},null,8,["modelValue","onClick:clear","onInput"])]),_:1})]),_:1}),t(vt,{class:"pt-2"},{default:a(()=>[t(j,null,{default:a(()=>[t(b,{cols:"12",sm:"6",md:"3",lg:"2",xl:"1"},{default:a(()=>[t(te,{modelValue:D.value,"onUpdate:modelValue":_[6]||(_[6]=R=>D.value=R),label:"Badge No.",clearable:!0,"hide-details":"",variant:"outlined","onClick:clear":k(ce),onInput:k(ce)},null,8,["modelValue","onClick:clear","onInput"])]),_:1}),t(b,{cols:"12",sm:"6",md:"4",lg:"5",xl:"2"},{default:a(()=>[t(te,{modelValue:L.value.Value,"onUpdate:modelValue":_[7]||(_[7]=R=>L.value.Value=R),label:"Furry Name",clearable:!0,"hide-details":"",variant:"outlined","onClick:clear":k(ce),onInput:k(ce)},null,8,["modelValue","onClick:clear","onInput"])]),_:1}),t(b,{cols:"12",sm:"12",md:"5",lg:"5",xl:"3"},{default:a(()=>[t(te,{modelValue:S.value,"onUpdate:modelValue":_[8]||(_[8]=R=>S.value=R),label:"E-mail",clearable:!0,"hide-details":"",variant:"outlined","onClick:clear":k(ce),onInput:k(ce)},null,8,["modelValue","onClick:clear","onInput"])]),_:1}),t(b,{cols:"12",sm:"6",md:"4",lg:"4",xl:"2"},{default:a(()=>[t(te,{modelValue:B.value.Value,"onUpdate:modelValue":_[9]||(_[9]=R=>B.value.Value=R),label:"Legal Forename",clearable:!0,"hide-details":"",variant:"outlined","onClick:clear":k(ce),onInput:k(ce)},null,8,["modelValue","onClick:clear","onInput"])]),_:1}),t(b,{cols:"12",sm:"6",md:"4",lg:"4",xl:"2"},{default:a(()=>[t(te,{modelValue:le.value.Value,"onUpdate:modelValue":_[10]||(_[10]=R=>le.value.Value=R),label:"Legal Surname",clearable:!0,"hide-details":"",variant:"outlined","onClick:clear":k(ce),onInput:k(ce)},null,8,["modelValue","onClick:clear","onInput"])]),_:1}),t(b,{cols:"12",sm:"12",md:"4",lg:"4",xl:"2"},{default:a(()=>[t(te,{modelValue:fe.value.Value,"onUpdate:modelValue":_[11]||(_[11]=R=>fe.value.Value=R),type:"date",label:"Date of Birth",clearable:!0,"hide-details":"",variant:"outlined","onClick:clear":k(ce),onInput:k(ce)},null,8,["modelValue","onClick:clear","onInput"])]),_:1}),t(b,{cols:"12",sm:"6",md:"6",lg:"6",xl:"6"},{default:a(()=>[t(Ue,{modelValue:Ye.value,"onUpdate:modelValue":_[12]||(_[12]=R=>Ye.value=R),label:"Permission Groups",clearable:!0,"hide-details":"",variant:"outlined",items:v.value,"item-value":"GroupUUID","item-title":"Name"},null,8,["modelValue","items"])]),_:1}),t(b,{cols:"12",sm:"6",md:"6",lg:"6",xl:"6"},{default:a(()=>[t(Ue,{modelValue:He.value,"onUpdate:modelValue":_[13]||(_[13]=R=>He.value=R),label:"Tags",clearable:!0,"hide-details":"",variant:"outlined",items:K.value,"item-value":"TagUUID","item-title":"Title"},null,8,["modelValue","items"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),"expanded-row":a(({columns:R,item:re})=>[F("tr",null,[F("td",{colspan:R.length},[t(ea,{modelValue:Le.value,"onUpdate:modelValue":_[15]||(_[15]=oe=>Le.value=oe),registration:re.selectable.registration,"onUpdate:registration":oe=>re.selectable.registration=oe,accommodations:qe.value,convention:s.value,extras:De.value,forms:c.value,interests:ke.value,tickets:Me.value,title:`Registration Controls (#${re.selectable.registration.Reference} ${re.selectable.registration.User.DisplayName})`,"use-dialog":!1,venues:Ne.value},null,8,["modelValue","registration","onUpdate:registration","accommodations","convention","extras","forms","interests","tickets","title","venues"])],8,ni)])]),"item.data-table-expand":a(({item:R})=>[g.value.findIndex(re=>re===R.key)>=0?(u(),O(H,{key:0,"append-icon":"mdi:mdi-chevron-up",size:"xs",variant:"flat",onClick:re=>g.value.splice(g.value.findIndex(oe=>oe===R.key),1)},{default:a(()=>[R.selectable.registration.Notes&&R.selectable.registration.Notes.length>0?(u(),E(P,{key:0},[h(C(R.selectable.registration.Notes.length),1)],64)):$("",!0)]),_:2},1032,["onClick"])):(u(),O(H,{key:1,"append-icon":"mdi:mdi-chevron-down",size:"xs",variant:"flat",onClick:re=>g.value.push(R.key)},{default:a(()=>[R.selectable.registration.Notes&&R.selectable.registration.Notes.length>0?(u(),E(P,{key:0},[h(C(R.selectable.registration.Notes.length),1)],64)):$("",!0)]),_:2},1032,["onClick"]))]),bottom:a(()=>[t(ge,{fluid:!0},{default:a(()=>[t(j,{class:"align-center"},{default:a(()=>[t(b,{cols:"12",lg:"7","order-lg":"3",xl:"8"},{default:a(()=>[t(li,{modelValue:M.value,"onUpdate:modelValue":_[16]||(_[16]=R=>M.value=R),length:Math.ceil(x.value/V.value)},null,8,["modelValue","length"])]),_:1}),t(b,{cols:"6",sm:"4",md:"2",lg:"2",xl:"1","order-lg":"1"},{default:a(()=>[t(Ue,{"model-value":V.value,density:"compact","hide-details":"","item-title":"title","item-value":"value",label:"Items per page",min:"-1",max:"100",type:"number",variant:"outlined",items:[{title:"10",value:10},{title:"25",value:25},{title:"50",value:50},{title:"100",value:100},{title:"All",value:-1}],"onUpdate:modelValue":_[17]||(_[17]=R=>V.value=parseInt(R,10))},null,8,["model-value"])]),_:1}),t(b,{cols:"6",sm:"3",md:"2",lg:"1",xl:"1","order-lg":"2"},{default:a(()=>[t(te,{modelValue:M.value,"onUpdate:modelValue":_[18]||(_[18]=R=>M.value=R),modelModifiers:{number:!0},density:"compact","hide-details":"",label:"Page",min:"1",max:Math.ceil(x.value/V.value),type:"number",variant:"outlined"},null,8,["modelValue","max"])]),_:1}),t(b,{class:"text-right",cols:"12",sm:"5",md:"8",lg:"2",xl:"2","order-lg":"4"},{default:a(()=>[F("span",oi,[V.value===-1?(u(),E(P,{key:0},[h(" 1-"+C(x.value)+" of "+C(x.value),1)],64)):(u(),E(P,{key:1},[h(C((M.value-1)*V.value+1)+"-"+C(M.value*V.value>=x.value?x.value:M.value*V.value)+" of "+C(x.value),1)],64))])]),_:1})]),_:1})]),_:1})]),_:2},[W(w.headers,R=>({name:`item.${R.key}`,fn:a(({item:re})=>[t(jn,{header:R,item:re,accommodations:qe.value,convention:s.value,extras:De.value,forms:c.value,interests:ke.value,tickets:Me.value,user:k(Ca),venues:Ne.value,onOpenActions:ka,onOpenPayments:Ma,onOpenTags:Na,onReload:_[14]||(_[14]=oe=>_t({page:M.value,itemsPerPage:V.value,sortBy:ae.value})),onSwitchUser:wa,onShowForm:La},null,8,["header","item","accommodations","convention","extras","forms","interests","tickets","user","venues"])])}))]),1032,["expanded","page","items-per-page","sort-by","headers","items-length","items","loading","search"])]),_:2},1024)):$("",!0)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"]),ne.value?(u(),O(ei,{key:0,title:"Edit Layouts",modelValue:ne.value,"onUpdate:modelValue":_[24]||(_[24]=w=>ne.value=w),convention:s.value,onSave:ba},null,8,["modelValue","convention"])):$("",!0),ye.value?(u(),E(P,{key:1},[Le.value?(u(),O(ea,{key:0,modelValue:Le.value,"onUpdate:modelValue":_[25]||(_[25]=w=>Le.value=w),registration:ye.value,"onUpdate:registration":_[26]||(_[26]=w=>ye.value=w),accommodations:qe.value,convention:s.value,extras:De.value,forms:c.value,interests:ke.value,tickets:Me.value,title:`Registration Controls (#${ye.value.Reference} ${ye.value.User.DisplayName})`,"use-dialog":!0,venues:Ne.value},null,8,["modelValue","registration","accommodations","convention","extras","forms","interests","tickets","title","venues"])):$("",!0)],64)):$("",!0),je.value&&pt.value&&ot.value?(u(),O(dt,{key:2,modelValue:je.value,"onUpdate:modelValue":_[30]||(_[30]=w=>je.value=w),scrollable:!0,fullscreen:!0,persistent:!0},{default:a(()=>[t(he,{class:"bg-red-darken-4"},{default:a(()=>[t(bt,{color:"error"},{default:a(()=>[t(ya,null,{default:a(()=>[h("Submission Editor - Admin Mode")]),_:1}),t(xe),t(ql,null,{default:a(()=>[t(H,{icon:"mdi:mdi-window-close",onClick:_[27]||(_[27]=w=>je.value=!1)})]),_:1})]),_:1}),t(Ge,null,{default:a(()=>[t(nl,{modelValue:ot.value,"onUpdate:modelValue":_[28]||(_[28]=w=>ot.value=w),admin:!0,convention:s.value,data:pt.value,editable:!0,"registration-group":wt.value,onClose:_[29]||(_[29]=w=>{je.value=!1,_t({page:M.value,itemsPerPage:V.value,sortBy:ae.value})})},null,8,["modelValue","convention","data","registration-group"])]),_:1})]),_:1})]),_:1},8,["modelValue"])):$("",!0)]),_:1}))}});export{qi as default};
