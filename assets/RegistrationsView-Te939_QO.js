import{p as tl,d as al,c as ue,t as qe,a0 as ll,a1 as ol,f as t,F as M,m as ft,i as j,M as J,N as te,r as g,k as Ee,w as fe,n,q as D,v as l,y,D as w,x as R,B as _,Q as W,C as E,A as b,P as Ae,G as Bt,H as xt,_ as dt,a2 as Qe,O as Je,a3 as nl,X as Ut,o as il,b as sl,a4 as ul,a5 as rl,a6 as aa,z as Lt,a7 as dl,a8 as la,Z as ut,V as ml,U as cl,E as vl}from"./index-QUOOrldl.js";import{T as fl,V as Ta,e as Ul,c as _a,d as Al}from"./FormRenderer.vue_vue_type_style_index_0_lang-Pp8jJL_2.js";import{F as _e,a as Tl}from"./form-0fJbSFPv.js";import{u as mt,V as wt}from"./VCheckbox-WDhRdt_p.js";import{_ as Pe}from"./ModelDialog.vue_vue_type_script_setup_true_lang-R9uHMa1F.js";import{h as Oe,b as At,a as _l,c as El,d as oa,P as Pt,u as Ea}from"./useDisplayTransactions-vxkdZfJh.js";import{u as gl,a as me,V as Me}from"./VContainer-Ly74NKFR.js";import{V as Q,a as O}from"./VRow-u4JH772W.js";import{V as we,a as be,c as Tt,d as pl}from"./VList-2jU0t9GU.js";import{V as ve}from"./copyToClipboard-qJ1uDt00.js";import{G as Xe}from"./userData-oLOg8fHt.js";import{C as Ht}from"./canEditRegistrations-A1ez9bSf.js";import{V as K,a as ga}from"./VBtn-6h3Oqwle.js";import{b as pa,c as qt,S as Da,d as na}from"./submission-40fey8Hx.js";import{G as Et}from"./group-7fhbY6WJ.js";import{C as gt}from"./canDo-yWCfI_4r.js";import{a as pt,V as Fe}from"./scopeId-d4QiyDwT.js";import{V as ot,a as We,c as Ze,d as Kt,e as $e}from"./VCard-rrMtFkzq.js";import{V as jt}from"./VAvatar-JEsObcpu.js";import{V as oe}from"./VTextField-hjobzEzq.js";import{v as ye}from"./v4-yQnnJER4.js";import{_ as rt,V as ya}from"./SaveButton.vue_vue_type_script_setup_true_lang-ymlNaupA.js";import{m as Dl,k as yl,l as Sl,n as Il,o as Cl,p as Rl,q as Vl,u as Ol,r as Ml,s as hl,t as kl,v as Nl,w as bl,x as Ll,y as wl,z as ia,A as sa,B as ua,c as Dt,d as yt,e as zt,b as St,V as It,a as Sa,h as Ia,i as Ca,_ as Ra,j as ze,g as Va,f as Ft,C as Pl}from"./VWindowItem-uNiK9Kr5.js";import{_ as Oa}from"./DeleteDialog.vue_vue_type_script_setup_true_lang-QffBDMDa.js";import{a as Ma,V as $t}from"./VToolbar-Kx__c0bs.js";import{V as Fl}from"./VDivider-I9fMka7q.js";import{V as ha}from"./VTextarea-6ACndUxT.js";import{V as _t}from"./VDialog-YSbzXlve.js";import{V as ka,a as Yt}from"./VChip-I1iFUQeY.js";import{V as $l}from"./VForm-zqYi3cSQ.js";import{V as Yl,b as Gl}from"./VNavigationDrawer-ASiQr-qW.js";import{s as Bl}from"./sortSubmissions-NKScr9xj.js";import{V as xl,a as Hl}from"./VAlert-BCVqFDE6.js";import{S as ql}from"./setupLogin-qeg_029Y.js";import{V as Kl}from"./forwardRefs-lQSU0fqa.js";import{u as Nt}from"./nil-rxyd0N8M.js";import{V as ra,a as jl}from"./VTable-HINLf0p3.js";import"./index-OKsbKlsK.js";import"./VFileInput-Hs1_yT61.js";import"./createSimpleFunctional-VWh6wQQj.js";import"./VToolbarItems-Z2I3g8L-.js";var Ne=(e=>(e.ADMIN_LAYOUT_PANELS="ADMIN_LAYOUT_PANELS",e.ADMIN_LAYOUT_TABLE="ADMIN_LAYOUT_TABLE",e))(Ne||{});const zl=[{title:"Panel Layout",value:"ADMIN_LAYOUT_PANELS"},{title:"Table Layout",value:"ADMIN_LAYOUT_TABLE"}];var Le=(e=>(e.LAYOUT_ITEM_SOURCE_FORM="LAYOUT_ITEM_SOURCE_FORM",e.LAYOUT_ITEM_SOURCE_META="LAYOUT_ITEM_SOURCE_META",e.LAYOUT_ITEM_SOURCE_USER="LAYOUT_ITEM_SOURCE_USER",e))(Le||{});const Ql=[{title:"Form Field Submission Data",value:"LAYOUT_ITEM_SOURCE_FORM"},{title:"Miscellaneous Data",value:"LAYOUT_ITEM_SOURCE_META"},{title:"User Profile Data",value:"LAYOUT_ITEM_SOURCE_USER"}];var B=(e=>(e.META_DATA_SOURCE_NULL="",e.META_DATA_SOURCE_ACCOMMODATION_ALLOCATION="META_DATA_SOURCE_ACCOMMODATION_ALLOCATION",e.META_DATA_SOURCE_ACCOMMODATION_FORM="META_DATA_SOURCE_ACCOMMODATION_FORM",e.META_DATA_SOURCE_ADMIN_FORM="META_DATA_SOURCE_ADMIN_FORM",e.META_DATA_SOURCE_BADGE_DISPLAY="META_DATA_SOURCE_BADGE_DISPLAY",e.META_DATA_SOURCE_BADGE_FORM="META_DATA_SOURCE_BADGE_FORM",e.META_DATA_SOURCE_CHECKIN_CONTROL="META_DATA_SOURCE_CHECKIN_CONTROL",e.META_DATA_SOURCE_CHECKIN_STATUS="META_DATA_SOURCE_CHECKIN_STATUS",e.META_DATA_SOURCE_DATA_LAYOUT="META_DATA_SOURCE_DATA_LAYOUT",e.META_DATA_SOURCE_DEALER_FORM="META_DATA_SOURCE_DEALER_FORM",e.META_DATA_SOURCE_EMAILS="META_DATA_SOURCE_EMAILS",e.META_DATA_SOURCE_NOTES="META_DATA_SOURCE_NOTES",e.META_DATA_SOURCE_PAYMENT_STATUS="META_DATA_SOURCE_PAYMENT_STATUS",e.META_DATA_SOURCE_PAYMENTS="META_DATA_SOURCE_PAYMENTS",e.META_DATA_SOURCE_REGISTRATION_ACTIONS="META_DATA_SOURCE_REGISTRATION_ACTIONS",e.META_DATA_SOURCE_REGISTRATION_FORM="META_DATA_SOURCE_REGISTRATION_FORM",e.META_DATA_SOURCE_REGISTRATION_GROUP="META_DATA_SOURCE_REGISTRATION_GROUP",e.META_DATA_SOURCE_REGISTRATION_REFERENCE="META_DATA_SOURCE_REGISTRATION_REFERENCE",e.META_DATA_SOURCE_SUBMISSION_DATE="META_DATA_SOURCE_SUBMISSION_DATE",e.META_DATA_SOURCE_SUBMISSION_STATUS="META_DATA_SOURCE_SUBMISSION_STATUS",e.META_DATA_SOURCE_TAGS="META_DATA_SOURCE_TAGS",e))(B||{});const Jl=[{title:"Accommodation Allocation",value:"META_DATA_SOURCE_ACCOMMODATION_ALLOCATION"},{title:"Accommodation Form",value:"META_DATA_SOURCE_ACCOMMODATION_FORM"},{title:"Actions",value:"META_DATA_SOURCE_REGISTRATION_ACTIONS"},{title:"Badge Display",value:"META_DATA_SOURCE_BADGE_DISPLAY"},{title:"Badge Form",value:"META_DATA_SOURCE_BADGE_FORM"},{title:"Check In Control",value:"META_DATA_SOURCE_CHECKIN_CONTROL"},{title:"Check In Status",value:"META_DATA_SOURCE_CHECKIN_STATUS"},{title:"Data Display",value:"META_DATA_SOURCE_DATA_LAYOUT"},{title:"Dealer Form",value:"META_DATA_SOURCE_DEALER_FORM"},{title:"Emails",value:"META_DATA_SOURCE_EMAILS"},{title:"Notes",value:"META_DATA_SOURCE_NOTES"},{title:"Payment Status",value:"META_DATA_SOURCE_PAYMENT_STATUS"},{title:"Payments",value:"META_DATA_SOURCE_PAYMENTS"},{title:"Registration Group",value:"META_DATA_SOURCE_REGISTRATION_GROUP"},{title:"Registration Reference",value:"META_DATA_SOURCE_REGISTRATION_REFERENCE"},{title:"Registration Form",value:"META_DATA_SOURCE_REGISTRATION_FORM"},{title:"Submission Date",value:"META_DATA_SOURCE_SUBMISSION_DATE"},{title:"Submission Status",value:"META_DATA_SOURCE_SUBMISSION_STATUS"},{title:"Tags",value:"META_DATA_SOURCE_TAGS"}];var De=(e=>(e.PANEL_STYLE_FLEX="PANEL_STYLE_FLEX",e.PANEL_STYLE_NAV_BOTTOM="PANEL_STYLE_NAV_BOTTOM",e.PANEL_STYLE_NAV_LEFT="PANEL_STYLE_NAV_LEFT",e.PANEL_STYLE_NAV_RIGHT="PANEL_STYLE_NAV_RIGHT",e.PANEL_STYLE_NAV_TOP="PANEL_STYLE_NAV_TOP",e))(De||{});const Xl=[{title:"Body Flexible",value:"PANEL_STYLE_FLEX"},{title:"Fixed Bottom",value:"PANEL_STYLE_NAV_BOTTOM"},{title:"Fixed Left",value:"PANEL_STYLE_NAV_LEFT"},{title:"Fixed Right",value:"PANEL_STYLE_NAV_RIGHT"},{title:"Fixed Top",value:"PANEL_STYLE_NAV_TOP"}];var ie=(e=>(e.USER_DATA_SOURCE_NULL="",e.USER_DATA_SOURCE_DISPLAY_NAME="USER_DATA_SOURCE_DISPLAY_NAME",e.USER_DATA_SOURCE_HANDLE="USER_DATA_SOURCE_HANDLE",e.USER_DATA_SOURCE_AVATAR="USER_DATA_SOURCE_AVATAR",e.USER_DATA_SOURCE_FIRST_NAME="USER_DATA_SOURCE_FIRST_NAME",e.USER_DATA_SOURCE_LAST_NAME="USER_DATA_SOURCE_LAST_NAME",e.USER_DATA_SOURCE_DATE_OF_BIRTH="USER_DATA_SOURCE_DATE_OF_BIRTH",e.USER_DATA_SOURCE_EMAIL="USER_DATA_SOURCE_EMAIL",e.USER_DATA_SOURCE_TELEGRAM="USER_DATA_SOURCE_TELEGRAM",e))(ie||{});const Wl=[{title:"Display Name",value:"USER_DATA_SOURCE_DISPLAY_NAME"},{title:"Handle",value:"USER_DATA_SOURCE_HANDLE"},{title:"Avatar",value:"USER_DATA_SOURCE_AVATAR"},{title:"First Name",value:"USER_DATA_SOURCE_FIRST_NAME"},{title:"Last Name",value:"USER_DATA_SOURCE_LAST_NAME"},{title:"Date of Birth",value:"USER_DATA_SOURCE_DATE_OF_BIRTH"},{title:"Email Address",value:"USER_DATA_SOURCE_EMAIL"},{title:"Telegram Username",value:"USER_DATA_SOURCE_TELEGRAM"}],Zl=e=>{switch(e){case"EMAIL_STATUS_QUEUED":return"Queued";case"EMAIL_STATUS_QUEUE_ERROR":return"Processing";case"EMAIL_STATUS_QUEUE_FAILURE":return"Internal Error";case"EMAIL_STATUS_SENDING":return"Sending";case"EMAIL_STATUS_SENT":return"Sent";case"EMAIL_STATUS_SEND_ERROR":return"Failed to Send"}return"Unknown"},eo=e=>e===void 0?!1:gt(e,Et.GROUP_TYPE_SYSTEM).ManageUsers,to=tl({itemsLength:{type:[Number,String],required:!0},...Dl(),...yl(),...Sl()},"VDataTableServer"),ao=al()({name:"VDataTableServer",props:to(),emits:{"update:modelValue":e=>!0,"update:page":e=>!0,"update:itemsPerPage":e=>!0,"update:sortBy":e=>!0,"update:options":e=>!0,"update:expanded":e=>!0,"update:groupBy":e=>!0},setup(e,c){let{attrs:o,slots:i}=c;const{groupBy:r}=Il(e),{sortBy:f,multiSort:A,mustSort:u}=Cl(e),{page:a,itemsPerPage:s}=Rl(e),d=ue(()=>parseInt(e.itemsLength,10)),{columns:U,headers:v}=Vl(e,{groupBy:r,showSelect:qe(e,"showSelect"),showExpand:qe(e,"showExpand")}),{items:m}=Ol(e,U),{toggleSort:p}=Ml({sortBy:f,multiSort:A,mustSort:u,page:a}),{opened:S,isGroupOpen:V,toggleGroup:h,extractRows:N}=hl({groupBy:r,sortBy:f}),{pageCount:T,setItemsPerPage:Y}=kl({page:a,itemsPerPage:s,itemsLength:d}),{flatItems:se}=Nl(m,r,S),{isSelected:z,select:x,selectAll:le,toggleSelect:G,someSelected:$,allSelected:P}=bl(e,{allItems:m,currentPage:m}),{isExpanded:k,toggleExpand:Z}=Ll(e),ce=ue(()=>N(m.value));wl({page:a,itemsPerPage:s,sortBy:f,groupBy:r,search:qe(e,"search")}),ll("v-data-table",{toggleSort:p,sortBy:f}),ol({VDataTableRows:{hideNoData:qe(e,"hideNoData"),noDataText:qe(e,"noDataText"),loading:qe(e,"loading"),loadingText:qe(e,"loadingText")}});const ne=ue(()=>({page:a.value,itemsPerPage:s.value,sortBy:f.value,pageCount:T.value,toggleSort:p,setItemsPerPage:Y,someSelected:$.value,allSelected:P.value,isSelected:z,select:x,selectAll:le,toggleSelect:G,isExpanded:k,toggleExpand:Z,isGroupOpen:V,toggleGroup:h,items:ce.value.map(ge=>ge.raw),internalItems:ce.value,groupedItems:se.value,columns:U.value,headers:v.value}));gl(()=>{const ge=ia.filterProps(e),et=sa.filterProps(e),tt=ua.filterProps(e),nt=ra.filterProps(e);return t(ra,ft({class:["v-data-table",{"v-data-table--loading":e.loading},e.class],style:e.style},nt),{top:()=>{var Ce;return(Ce=i.top)==null?void 0:Ce.call(i,ne.value)},default:()=>{var Ce,Ye,Ge,Be,xe,pe;return i.default?i.default(ne.value):t(M,null,[(Ce=i.colgroup)==null?void 0:Ce.call(i,ne.value),t("thead",{class:"v-data-table__thead",role:"rowgroup"},[t(sa,ft(et,{sticky:e.fixedHeader}),i)]),(Ye=i.thead)==null?void 0:Ye.call(i,ne.value),t("tbody",{class:"v-data-table__tbody",role:"rowgroup"},[(Ge=i["body.prepend"])==null?void 0:Ge.call(i,ne.value),i.body?i.body(ne.value):t(ua,ft(o,tt,{items:se.value}),i),(Be=i["body.append"])==null?void 0:Be.call(i,ne.value)]),(xe=i.tbody)==null?void 0:xe.call(i,ne.value),(pe=i.tfoot)==null?void 0:pe.call(i,ne.value)])},bottom:()=>i.bottom?i.bottom(ne.value):t(ia,ge,{prepend:i["footer.prepend"]})})})}}),lo=w("br",null,null,-1),oo=w("h3",null,"Assigned Accommodation",-1),no=w("br",null,null,-1),io=w("br",null,null,-1),so=w("h3",null,"Accommodation Preferences",-1),uo=w("h3",null,"Selected Tickets",-1),ro=w("br",null,null,-1),mo=j({__name:"EditAccommodationAssignmentDialog",props:J({convention:{},registration:{},selectedAccommodation:{},title:{}},{modelValue:{type:Boolean,required:!0},modelModifiers:{}}),emits:J(["update:field"],["update:modelValue"]),setup(e,{emit:c}){const o=e,{convention:i,registration:r,title:f=""}=o,A=c,u=Ae(),a=te(e,"modelValue"),s=g({capacity:{max:G=>{var k;const $=Y.value.find(Z=>Z.room.RoomUUID===G);return!$||$.room.MaximumCapacity===0?!0:(((k=m.value)==null?void 0:k.Members.length)||0)<=$.room.MaximumCapacity||"Too many people in the group for this room"},min:G=>{var k;const $=Y.value.find(Z=>Z.room.RoomUUID===G);return!$||$.room.MinimumCapacity===0?!0:(((k=m.value)==null?void 0:k.Members.length)||0)>=$.room.MinimumCapacity||"Not enough people in the group for this room"}}}),d=g([]),U=mt(o,A,void 0,void 0,"field"),v=g(Ee(U.value));fe(U,()=>{v.value=Ee(U.value)});const m=g(),p=g(""),S=g(""),V=g([]),h=g({Ticket:[],AddonsChecked:[],ComponentsChecked:[]}),N=async()=>{var k;const G=await u.getConventionAvailableAccommodation(i.ConventionUUID);G&&(d.value=G);const $=await u.getRegistrationGroup(r.RegistrationUUID||"");$&&(m.value=$);const P=await u.getConventionTickets(i.ConventionUUID);P&&(V.value=P);try{h.value=JSON.parse(((k=m.value)==null?void 0:k.TicketData)||"")}catch{}};fe(p,()=>{S.value=Y.value.length>0?Y.value[0].value:""});const T=ue(()=>{const G=se.value;return d.value.map($=>{let P;return G.forEach(k=>{$.Costs.forEach(Z=>{Z.DateStart===(k==null?void 0:k.DateStart)&&Z.DateEnd===k.DateEnd&&(P===void 0||P>Z.Availability)&&(P=Z.Availability)})}),{label:`${$.Name}`,title:`${$.Name} (${P} Available)`,value:$.AccommodationUUID}})}),Y=ue(()=>{const G=se.value,$=d.value.find(P=>P.AccommodationUUID===p.value);return($==null?void 0:$.Pool.map(P=>{var Z,ce;let k;return G.forEach(ne=>{P.Costs.forEach(ge=>{ge.DateStart===(ne==null?void 0:ne.DateStart)&&ge.DateEnd===ne.DateEnd&&(k===void 0||k>ge.Availability)&&(k=ge.Availability)})}),{label:`${(Z=P.Venue)==null?void 0:Z.Name} - ${P.Name}`,title:`${(ce=P.Venue)==null?void 0:ce.Name} - ${P.Name} (${k} Available)`,value:P.RoomUUID,room:P}}))||[]}),se=ue(()=>[...h.value.Ticket,...h.value.AddonsChecked,...h.value.ComponentsChecked].map(G=>V.value.find($=>$.TicketUUID===G)).filter(G=>G!==void 0&&G.RequiresAccommodation)),z=G=>{var $;u.assignAccommodation((($=m.value)==null?void 0:$.Registration.RegistrationUUID)||"",p.value,S.value,!1).then(P=>{P?(N(),G&&G("Room Assigned")):G&&G("Room not assigned")}).catch(()=>{G&&G("Room not assigned")})},x=G=>{var $,P;($=m.value)!=null&&$.Registration.AllocationUUID?u.deleteAllocation(((P=m.value)==null?void 0:P.Registration.AllocationUUID)||"").then(k=>{k?(N(),G&&G("Allocation Deleted")):G&&G("Allocation not deleted")}).catch(()=>{G&&G("Allocation not deleted")}):G&&G("Nothing to Delete")},le=G=>{var P,k;const $=(P=d.value.find(Z=>Z.AccommodationUUID===G.AccommodationUUID))==null?void 0:P.Pool;if($){const Z=$.find(ce=>ce.RoomUUID===G.RoomUUID);if(Z)return`${(k=Z.Venue)==null?void 0:k.Name} - ${Z.Name}`}return""};return N(),(G,$)=>{var P;return n(),D(Pe,{modelValue:a.value,"onUpdate:modelValue":$[2]||($[2]=k=>a.value=k),title:E(f),color:"primary","show-close-action":!0,"show-delete-action":!!((P=m.value)!=null&&P.Registration.Allocation),"show-save-action":!!S.value,"save-button-label":"Assign Room",onDelete:x,onSave:z,fullscreen:!0,persistent:!0},{default:l(()=>[t(me,{class:"pa-0",fluid:!0},{default:l(()=>[t(Q,null,{default:l(()=>{var k;return[t(O,{cols:"12",md:"6"},{default:l(()=>{var Z,ce;return[w("h3",null,"Group Members ("+y((Z=m.value)==null?void 0:Z.Members.length)+")",1),(n(!0),_(M,null,W((ce=m.value)==null?void 0:ce.Members,ne=>(n(),_(M,{key:ne.UUID},[R(" #"+y(ne.Reference)+" "+y(ne.Name),1),lo],64))),128))]}),_:1}),(k=m.value)!=null&&k.Registration.Allocation?(n(),D(O,{key:0,cols:"12",md:"6"},{default:l(()=>[oo,t(we,null,{default:l(()=>{var Z;return[(n(!0),_(M,null,W((Z=m.value)==null?void 0:Z.Registration.Allocation.Periods,ce=>(n(),D(be,{key:ce.AllocationPeriodUUID},{default:l(()=>{var ne;return[R(y((ne=d.value.find(ge=>ge.AccommodationUUID===ce.AccommodationUUID))==null?void 0:ne.Name)+" ",1),no,R(" "+y(le(ce))+" ",1),io,w("small",null,"("+y(E(Oe)(ce.DateStart))+" - "+y(E(Oe)(ce.DateEnd))+")",1)]}),_:2},1024))),128))]}),_:1})]),_:1})):b("",!0)]}),_:1}),t(Q,null,{default:l(()=>[t(O,{cols:"12",md:"6"},{default:l(()=>[G.selectedAccommodation.length?(n(),_(M,{key:0},[so,t(we,null,{default:l(()=>[(n(!0),_(M,null,W(G.selectedAccommodation,(k,Z)=>(n(),D(be,{key:k.AccommodationUUID},{default:l(()=>[R(y(Z+1)+". "+y(k.Name),1)]),_:2},1024))),128))]),_:1})],64)):b("",!0)]),_:1}),t(O,{cosl:"12",md:"6"},{default:l(()=>[uo,t(we,null,{default:l(()=>[(n(!0),_(M,null,W(se.value,k=>(n(),D(be,{key:k==null?void 0:k.TicketUUID},{default:l(()=>[R(y(k.Name)+" ",1),ro,w("small",null,"("+y(E(Oe)(k.DateStart))+" - "+y(E(Oe)(k.DateEnd))+")",1)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1}),t(Q,null,{default:l(()=>[t(O,{cols:"12",md:"6"},{default:l(()=>[t(ve,{modelValue:p.value,"onUpdate:modelValue":$[0]||($[0]=k=>p.value=k),items:T.value,"item-title":"title","item-value":"value",label:"Accommodation"},null,8,["modelValue","items"])]),_:1}),t(O,{cols:"12",md:"6"},{default:l(()=>[t(ve,{modelValue:S.value,"onUpdate:modelValue":$[1]||($[1]=k=>S.value=k),items:Y.value,"item-title":"title","item-value":"value",label:"Room Pool",rules:[s.value.capacity.min,s.value.capacity.max]},null,8,["modelValue","items","rules"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue","title","show-delete-action","show-save-action"])}}}),co=e=>(Bt("data-v-33548a38"),e=e(),xt(),e),vo={key:0,class:"accommodationList"},fo={key:0,class:"text-orange-darken-2"},Uo={key:1,class:"accommodationList"},Ao=co(()=>w("br",null,null,-1)),To=j({__name:"DataTableItemAccommodation",props:{accommodations:{default:()=>[]},convention:{},forms:{},registration:{},tickets:{default:()=>[]},value:{default:""},venues:{}},setup(e){const c=Xe(),o=Ht(c,e.convention),i=g(!1),r=ue(()=>e.registration.Allocation.Periods.map(u=>{var a;return{DateStart:u.DateStart,DateEnd:u.DateEnd,Accommodation:u.Accommodation||((a=e.accommodations)==null?void 0:a.find(s=>s.AccommodationUUID==u.AccommodationUUID))}}).sort((u,a)=>u.DateStart>a.DateStart?1:u.DateStart==a.DateStart?0:-1));e.registration&&e.registration.Allocation&&e.registration.Allocation.Periods&&e.registration.Allocation.Periods.forEach(u=>{var s;if(u.Accommodation)return;const a=(s=e.accommodations)==null?void 0:s.find(d=>d.AccommodationUUID==u.AccommodationUUID);a&&(u.Accommodation=a)});const f=ue(()=>{if(!e.value)return[];const u=JSON.parse(e.value),a=e.accommodations.filter(s=>u.includes(s.AccommodationUUID)).sort((s,d)=>{const U=u.findIndex(m=>m===s.AccommodationUUID),v=u.findIndex(m=>m===d.AccommodationUUID);return U>v?1:-1});return Ee(a)}),A=ue(()=>{let u;const a=e.forms.find(s=>!!s.Sections.find(d=>{var U;return d.Fields?!!((U=d.Fields)!=null&&U.find(v=>{var m;return((m=v.Field)==null?void 0:m.Type)==="TICKET"?(u=v,!0):!1})):!1}));return u?!!e.registration.Submissions.find(s=>{if(s.FormUUID==(a==null?void 0:a.FormUUID))return!!s.Data.find(d=>{if(d.SectionFieldUUID==(u==null?void 0:u.SectionFieldUUID)){const U=JSON.parse(d.Data);return e.tickets.filter(v=>v.RequiresAccommodation).find(v=>U.Ticket.includes(v.TicketUUID)||U.AddonsChecked.includes(v.TicketUUID)||U.ComponentsChecked.includes(v.TicketUUID))}})}):!1});return(u,a)=>A.value?(n(),_(M,{key:0},[u.value?(n(),_("ol",vo,[(n(!0),_(M,null,W(f.value,s=>(n(),_("li",{key:s.AccommodationUUID},[u.registration&&u.registration.Allocation&&u.registration.Allocation.Periods.find(d=>d.AccommodationUUID===s.AccommodationUUID)?(n(),_("strong",fo,y(s.Name),1)):(n(),_(M,{key:1},[R(y(s.Name),1)],64))]))),128))])):(n(),_("ul",Uo,[(n(!0),_(M,null,W(r.value,s=>{var d;return n(),_("li",{key:s.DateStart},[R(y((d=s.Accommodation)==null?void 0:d.Name)+" ("+y(E(Oe)(s.DateStart))+" - "+y(E(Oe)(s.DateEnd))+")",1),Ao])}),128))])),E(o)?(n(),D(K,{key:2,onClick:a[0]||(a[0]=s=>i.value=!0),variant:"flat",color:"success"},{default:l(()=>[R("Assign Accommodation")]),_:1})):b("",!0),u.convention&&i.value?(n(),D(mo,{key:3,modelValue:i.value,"onUpdate:modelValue":a[1]||(a[1]=s=>i.value=s),title:"Accommodation Allocation",convention:u.convention,registration:u.registration,tickets:u.tickets,"selected-accommodation":f.value},null,8,["modelValue","convention","registration","tickets","selected-accommodation"])):b("",!0)],64)):b("",!0)}}),Na=dt(To,[["__scopeId","data-v-33548a38"]]),_o={key:0,class:"addonList"},Eo={key:0},go={key:0},po=j({__name:"DataTableItemExtras",props:{extras:{default:()=>[]},value:{default:""}},setup(e){const c=ue(()=>{if(!e.value)return;const o=JSON.parse(e.value),i=Object.keys(o),r=Ee(e.extras);return r.forEach(f=>{f.Options=f.Options.filter(A=>i.includes(A.OptionUUID)?(A.Choices=A.Choices.filter(u=>u.TagUUID===o[A.OptionUUID].choiceId),o[A.OptionUUID].checked):!1)}),r.filter(f=>f.Options.length>0),r});return(o,i)=>o.value?(n(),_("ul",_o,[(n(!0),_(M,null,W(c.value,r=>(n(),_(M,{key:r.ExtraUUID},[r.Options.length?(n(),_("li",Eo,[w("strong",null,y(r.Name),1),w("ul",null,[(n(!0),_(M,null,W(r.Options,f=>(n(),_("li",{key:f.OptionUUID},[R(y(f.Name)+" ",1),f.Choices.length==1?(n(),_("small",go,"("+y(f.Choices[0].Title)+")",1)):b("",!0)]))),128))])])):b("",!0)],64))),128))])):b("",!0)}}),ba=dt(po,[["__scopeId","data-v-55786e01"]]),Do={key:0},La=j({__name:"DataTableItemInterests",props:{interests:{default:()=>[]},value:{default:""}},setup(e){const c=ue(()=>{if(!e.value)return;const o=JSON.parse(e.value);return Object.entries(o).filter(([,i])=>i).map(([i,r])=>e.interests.find(f=>f.InterestUUID===i)).filter(i=>i!==void 0)});return(o,i)=>o.value?(n(),_("ul",Do,[(n(!0),_(M,null,W(c.value,r=>(n(),_("li",{key:r.InterestUUID},y(r.Name),1))),128))])):b("",!0)}}),yo=w("br",null,null,-1),So=w("small",null,"Options:",-1),Io=w("br",null,null,-1),Co=w("small",null,"Addons:",-1),wa=j({__name:"DataTableItemTicket",props:{tickets:{default:()=>[]},value:{default:""}},setup(e){const c=ue(()=>{if(!e.value)return;let o={Ticket:[],AddonsChecked:[],ComponentsChecked:[]};try{o=JSON.parse(e.value),"ticket"in o&&(o.Ticket=o.ticket),"addonsChecked"in o&&(o.AddonsChecked=o.addonsChecked),"componentsChecked"in o&&(o.ComponentsChecked=o.componentsChecked)}catch{}return o.Ticket.filter(i=>{const r=e.tickets.find(f=>f.TicketUUID===i);return!(!r||r.Type!==fl.TICKET_TYPE_TICKET)}).map(i=>{const r=e.tickets.find(A=>A.TicketUUID===i),f=Ee(r);return f.TicketComponents=r.TicketComponents.filter(A=>o.ComponentsChecked.includes(A.TicketUUID)),f.AddonTickets=r.AddonTickets.filter(A=>o.AddonsChecked.includes(A.TicketUUID)),f})});return(o,i)=>o.value?(n(!0),_(M,{key:0},W(c.value,r=>(n(),_("div",{key:r.TicketUUID},[w("strong",null,y(r.Name),1),r.TicketComponents.length>0?(n(),_(M,{key:0},[yo,So,R("  "),(n(!0),_(M,null,W(r.TicketComponents,f=>(n(),_(M,{key:f.TicketUUID},[w("small",null,y(f.Name),1),R("  ")],64))),128))],64)):b("",!0),r.AddonTickets.length>0?(n(),_(M,{key:1},[Io,Co,R("  "),(n(!0),_(M,null,W(r.AddonTickets,f=>(n(),_("small",{key:f.TicketUUID},[R("("),w("em",null,y(f.Name),1),R(")")]))),128))],64)):b("",!0)]))),128)):b("",!0)}}),Pa=j({__name:"DataPanelAccommodation",props:J({accommodations:{},convention:{},data:{},forms:{},tickets:{},venues:{},registration:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(e){return te(e,"modelValue"),(c,o)=>(n(),_("div",null,[t(Na,{value:c.data,accommodations:c.accommodations,convention:c.convention,forms:c.forms,registration:c.registration,tickets:c.tickets,venues:c.venues},null,8,["value","accommodations","convention","forms","registration","tickets","venues"])]))}}),Ro={key:0,class:"text-red-darken-4 font-weight-bold"},Vo={key:1,class:"text-orange-darken-2 font-weight-bold"},Oo=j({__name:"DataPanelAge",props:J({data:{},forms:{},registration:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(e){const c=te(e,"modelValue"),o=new Date,i=o.getFullYear(),r=(o.getMonth()+1).toLocaleString("en-US",{minimumIntegerDigits:2}),f=o.getDate().toLocaleString("en-US",{minimumIntegerDigits:2}),A=g(!1),u=g(`${i}-${r}-${f}`),a=g(18);e.forms.find(v=>v.Sections.find(m=>m.Fields?m.Fields.find(p=>{var S;return p.SectionFieldUUID===c.value.SectionFieldUUID?(c.value.SectionField=p,(S=p.Field)==null||S.Values.forEach(V=>{switch(V.Title){case"UNDER_AGE_APPLY_TAG":V.Value.length>0&&(A.value=!0);break;case"BEFORE_DATE":u.value=V.Value;break;case"MIN_AGE":a.value=parseInt(V.Value);break}}),!0):!1}):!1));const s=v=>({registration:d(v,e.registration.CreatedAt||"",a.value),convention:d(v,u.value,a.value)}),d=(v,m,p)=>{if(v>=m)return!1;const S=U(v),h=U(m).getTime()-S.getTime(),N=1e3*60*60*24*365.25;return h/N>=p},U=v=>{const[m,p,S]=v.split("-");return new Date(parseInt(m),parseInt(p)-1,parseInt(S))};return(v,m)=>(n(),_("div",null,[w("p",null,[R(y(E(Oe)(v.data,{withDay:!1,withYear:!0}))+" ",1),A.value&&s(v.data).convention&&s(v.data).registration?(n(),D(Me,{key:0,icon:"mdi:mdi-check",color:"success"})):A.value&&!s(v.data).convention?(n(),D(Me,{key:1,icon:"mdi:mdi-alert",color:"error"})):A.value&&s(v.data).convention&&!s(v.data).registration?(n(),D(Me,{key:2,icon:"mdi:mdi-alert",color:"warning"})):b("",!0)]),A.value?(n(),_(M,{key:0},[s(v.data).convention?s(v.data).registration?b("",!0):(n(),_("p",Vo," Attendee was under "+y(a.value)+" at time of registration ",1)):(n(),_("p",Ro," Attendee is under "+y(a.value),1))],64)):b("",!0)]))}}),Qt=j({__name:"Badges",props:{cardClass:{default:""},convention:{},registration:{},showTitle:{type:Boolean,default:!0}},setup(e){const c=Ae(),o=pt(),i=g([]),r=A=>{var a;const u=document.createElement("a");u.download=`${((a=e.convention)==null?void 0:a.Name)||""} Badge Image - ${e.registration.Reference} - ${e.registration.User.DisplayName}.jpg`,u.href=A,document.body.appendChild(u),u.click(),document.body.removeChild(u)},f=async A=>o.GetConBadgeImageURL(e.registration.RegistrationUUID,A);return c.getConBadgeList(e.registration.RegistrationUUID).then(A=>{A.forEach(u=>{f(u).then(a=>{i.value.push({template:u,url:a})})})}).catch(()=>{}),(A,u)=>(n(!0),_(M,null,W(i.value,a=>(n(),D($e,{key:a.template,class:Qe(A.cardClass)},{default:l(()=>[t(ot,null,{default:l(()=>[A.showTitle?(n(),D(We,{key:0},{default:l(()=>[t(Q,{class:"flex-row-reverse"},{default:l(()=>[t(O,{class:"text-wrap flex-grow-1"},{default:l(()=>[R(" Badges (#"+y(A.registration.Reference)+" "+y(A.registration.User.DisplayName)+") ",1)]),_:1})]),_:1})]),_:1})):b("",!0)]),_:1}),t(Ze,null,{default:l(()=>[t(jt,{src:a.url,height:"280",width:"280"},null,8,["src"])]),_:2},1024),t(Kt,null,{default:l(()=>[t(K,{color:"primary","prepend-icon":"mdi:mdi-download",variant:"flat",onClick:s=>r(a.url)},{default:l(()=>[R("Download")]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1032,["class"]))),128))}}),Mo=j({__name:"DataPanelText",props:J({convention:{},data:{},forms:{}},{modelValue:{required:!0},modelModifiers:{},registration:{required:!0},registrationModifiers:{}}),emits:["update:modelValue","update:registration"],setup(e){const c=te(e,"modelValue"),o=te(e,"registration"),i=g(e.data),r=ue(()=>a.value?"":i.value!==e.data?"mdi:mdi-content-save":""),f=Xe(),A=Ae(),u=g(Ht(f,e.convention)),a=g(!1),s=()=>{a.value=!0,A.directEditFieldData(o.value.RegistrationUUID,c.value.LayoutItemUUID,i.value).then(d=>{d&&o.value.Submissions.find(U=>!!U.Data.find(v=>{if(v.SectionFieldUUID===c.value.SectionFieldUUID)return v.Data=d,!0})),a.value=!1}).catch(()=>{})};return(d,U)=>c.value.Meta.DirectEdit&&(u.value||c.value.Meta.DirectEditPermission==="View")?(n(),D(oe,{key:0,modelValue:i.value,"onUpdate:modelValue":U[0]||(U[0]=v=>i.value=v),"append-inner-icon":r.value,"onClick:appendInner":s},Je({_:2},[a.value?{name:"append-inner",fn:l(()=>[t(ga,{color:"primary",indeterminate:"",size:30})]),key:"0"}:void 0]),1032,["modelValue","append-inner-icon"])):(n(),_(M,{key:1},[R(y(d.data),1)],64))}}),ho={key:4},ko={key:8},No=j({__name:"FormDataItem",props:J({accommodations:{},convention:{},extras:{},forms:{},interests:{},itemClass:{},tickets:{},venues:{}},{modelValue:{required:!0},modelModifiers:{},registration:{required:!0},registrationModifiers:{}}),emits:["update:modelValue","update:registration"],setup(e){const c=te(e,"modelValue"),o=te(e,"registration"),i=ue(()=>{var U,v,m,p;const s=c.value,d=()=>{var S;for(let V=0;V<e.forms.length;V+=1)for(let h=0;h<e.forms[V].Sections.length;h+=1)if(e.forms[V].Sections[h].Fields){const N=(S=e.forms[V].Sections[h].Fields)==null?void 0:S.find(T=>T.SectionFieldUUID===s.SectionFieldUUID);if(N)return N}};return((v=(U=s.SectionField)==null?void 0:U.Field)==null?void 0:v.Type)||((p=(m=d())==null?void 0:m.Field)==null?void 0:p.Type)}),r=ue(()=>{for(let s=0;s<o.value.Submissions.length;s+=1){const U=o.value.Submissions[s].Data.find(v=>v.SectionFieldUUID===c.value.SectionFieldUUID);if(U)return U.Data}return""}),f=Ae(),A=pt(),u=g(""),a=g("");if(i.value==="BADGE_IMAGE")try{const s=JSON.parse(r.value||"{}");s.fileUUID&&(a.value=A.GetBadgeImageURL(s.fileUUID)),o.value&&f.getConBadgeDisplayName(o.value.RegistrationUUID).then(d=>{d&&(u.value=d)}).catch(()=>{})}catch{}return(s,d)=>i.value==="ACCOMMODATION"?(n(),D(Pa,{key:0,convention:s.convention,tickets:s.tickets,accommodations:s.accommodations,venues:s.venues,registration:o.value,forms:s.forms,modelValue:c.value,"onUpdate:modelValue":d[0]||(d[0]=U=>c.value=U),data:r.value},null,8,["convention","tickets","accommodations","venues","registration","forms","modelValue","data"])):i.value==="EXTRAS"?(n(),D(ba,{key:1,value:r.value,extras:s.extras},null,8,["value","extras"])):i.value==="TICKET"?(n(),D(wa,{key:2,value:r.value,tickets:s.tickets},null,8,["value","tickets"])):i.value==="INTERESTS"?(n(),D(La,{key:3,value:r.value,interests:s.interests},null,8,["value","interests"])):i.value==="CHECKBOX"?(n(),_("div",ho,[r.value?(n(),D(Me,{key:0,icon:"mdi:mdi-check",color:"success"})):(n(),D(Me,{key:1,icon:"mdi:mdi-close",color:"error"}))])):i.value==="AGE"?(n(),D(Oo,{key:5,data:r.value,forms:s.forms,registration:o.value,modelValue:c.value,"onUpdate:modelValue":d[1]||(d[1]=U=>c.value=U)},null,8,["data","forms","registration","modelValue"])):i.value==="BADGE_IMAGE"?(n(),D(Qt,{key:6,convention:s.convention,registration:o.value,"show-title":!1,"card-class":s.itemClass},null,8,["convention","registration","card-class"])):i.value==="TEXT"?(n(),D(Mo,{key:7,convention:s.convention,data:r.value,forms:s.forms,modelValue:c.value,"onUpdate:modelValue":d[2]||(d[2]=U=>c.value=U),registration:o.value,"onUpdate:registration":d[3]||(d[3]=U=>o.value=U)},null,8,["convention","data","forms","modelValue","registration"])):(n(),_("div",ko,y(r.value),1))}}),bo={key:0},Lo={key:0},wo=w("strong",null,"Total:",-1),Po=j({__name:"DataPanelRegistrationGroup",props:{registration:{}},setup(e){const c=ue(()=>{const o=[];let i;return e.registration.Leader?i=e.registration:i=e.registration.Primary,o.push({Name:i.User.DisplayName,UUID:i.UserUUID,UserUUID:i.User.UserUUID,IsLeader:!0,Reference:i.Reference,Paid:i.Paid,Total:i.Total}),o.push(...i.Members.map(r=>({Name:r.User.DisplayName,UUID:r.UserUUID,UserUUID:r.User.UserUUID,IsLeader:!1,Reference:r.Reference,Paid:r.Paid,Total:r.Total}))),o});return(o,i)=>o.registration.Members.length===0&&!o.registration.Primary?(n(),_("em",bo," Not in a group ")):(n(),_(M,{key:1},[w("ul",null,[(n(!0),_(M,null,W(c.value,r=>(n(),_("li",{key:r.UUID,class:"ml-0"},[R(" #"+y(r.Reference)+" : "+y(r.Name)+" ",1),r.IsLeader?(n(),_("strong",Lo,"(Leader)")):b("",!0)]))),128))]),wo,R(" "+y(c.value.length),1)],64))}}),Fo=j({__name:"DataPanelSubmissionDate",props:{registration:{}},setup(e){const c=ue(()=>{const o=e.registration.Submissions.find(i=>{var r;return((r=i.Form)==null?void 0:r.Type)===_e.FORM_TYPE_REGISTRATION});return o?o.CreatedAt||"":e.registration.CreatedAt||""});return(o,i)=>(n(),_("div",null,y(E(Oe)(c.value,{withDay:!1,withYear:!0})),1))}}),$o={class:"text-grey-lighten-1"},Yo=j({__name:"DataPanelSubmissionStatus",props:{convention:{},forms:{},registration:{}},emits:["showForm"],setup(e,{emit:c}){const o=c,i=Xe(),r=Ht(i,e.convention),f=ue(()=>e.registration.Submissions.map(a=>{const s=e.forms.find(d=>d.FormUUID===a.FormUUID);if(s)return{Heading:s.Heading,Form:s,Submission:a,Registration:e.registration}}).filter(a=>!!a)),A=(a,s,d)=>{o("showForm",a,s,d)},u=a=>({ID:0,SubmissionUUID:ye(),FormID:a.ID,FormUUID:a.FormUUID,Form:a,UserID:e.registration.UserID,UserUUID:e.registration.UserUUID,RegistrationID:e.registration.ID,RegistrationUUID:e.registration.RegistrationUUID,Registration:e.registration,Data:[],Status:Da.SUBMISSION_STATUS_NULL});return(a,s)=>(n(),_(M,null,[w("ul",null,[(n(!0),_(M,null,W(a.forms.filter(d=>d.Type===E(_e).FORM_TYPE_ADMIN&&f.value.findIndex(U=>U.Form.ID===d.ID)<0),d=>(n(),_("li",{key:d.Heading},[w("strong",$o,y(d.Heading),1),E(r)?(n(),D(K,{key:0,class:"text-grey-lighten-1",icon:"mdi:mdi-form-select",title:"Edit Submitted Data",variant:"flat",onClick:U=>A(a.registration,d,u(d))},null,8,["onClick"])):b("",!0)]))),128))]),w("ul",null,[(n(!0),_(M,null,W(f.value,d=>(n(),_("li",{key:d.Heading},[w("strong",null,[R(y(d.Heading),1),d.Form.Type!==E(_e).FORM_TYPE_ADMIN?(n(),_(M,{key:0},[R(": ")],64)):b("",!0)]),d.Form.Type!==E(_e).FORM_TYPE_ADMIN?(n(),_("span",{key:0,class:Qe(E(pa)(d.Submission.Status))},y(E(qt)(d.Submission.Status)),3)):b("",!0),E(r)?(n(),D(K,{key:1,icon:"mdi:mdi-form-select",title:"Edit Submitted Data",variant:"flat",onClick:U=>A(d.Registration,d.Form,d.Submission)},null,8,["onClick"])):b("",!0)]))),128))])],64))}}),Go={key:0,class:"text-blue"},Bo={key:1,class:"text-red"},xo={key:2,class:"text-orange"},Ho={key:3,class:"text-orange"},qo={key:4,class:"text-orange"},Ko={key:5,class:"text-orange"},jo={key:6,class:"text-green"},zo=j({__name:"DataPanelPaymentStatus",props:{registration:{}},setup(e){const c=ue(()=>{if(e.registration.Paid===0&&e.registration.Total)return"REQUIRED";if(e.registration.Total>e.registration.Paid)return"ADDITIONAL_REQUIRED";const o=e.registration.Members.find(i=>i.Paid===0&&(i.Total||0)>0);return o?e.registration.Total===0&&o.Total===0?"NOT_REQUIRED":e.registration.Total===0&&o.Total||e.registration.Total>0&&o.Total===0?"MISSING_REQUIRED":e.registration.Paid>=e.registration.Total?"AWAITING_PARTNER":"ALL_REQUIRED":e.registration.Total===0?"NOT_REQUIRED":"COMPLETE"});return(o,i)=>c.value=="NOT_REQUIRED"?(n(),_("div",Go,"No Payment Requested")):c.value=="MISSING_REQUIRED"?(n(),_("div",Bo,"Partner Payment Not Requested")):c.value=="AWAITING_PARTNER"?(n(),_("div",xo,"Awaiting Partner Payment")):c.value=="ALL_REQUIRED"?(n(),_("div",Ho,"Awaiting Payments")):c.value=="REQUIRED"?(n(),_("div",qo,"Awaiting Payment")):c.value=="ADDITIONAL_REQUIRED"?(n(),_("div",Ko,"Awaiting Additional Payments")):(n(),_("div",jo,"Completed"))}});var Qo=["onActivate","onAddUndo","onBeforeAddUndo","onBeforeExecCommand","onBeforeGetContent","onBeforeRenderUI","onBeforeSetContent","onBeforePaste","onBlur","onChange","onClearUndos","onClick","onContextMenu","onCopy","onCut","onDblclick","onDeactivate","onDirty","onDrag","onDragDrop","onDragEnd","onDragGesture","onDragOver","onDrop","onExecCommand","onFocus","onFocusIn","onFocusOut","onGetContent","onHide","onInit","onKeyDown","onKeyPress","onKeyUp","onLoadContent","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp","onNodeChange","onObjectResizeStart","onObjectResized","onObjectSelected","onPaste","onPostProcess","onPostRender","onPreProcess","onProgressState","onRedo","onRemove","onReset","onSaveContent","onSelectionChange","onSetAttrib","onSetContent","onShow","onSubmit","onUndo","onVisualAid"],Jo=function(e){return Qo.map(function(c){return c.toLowerCase()}).indexOf(e.toLowerCase())!==-1},Xo=function(e,c,o){Object.keys(c).filter(Jo).forEach(function(i){var r=c[i];typeof r=="function"&&(i==="onInit"?r(e,o):o.on(i.substring(2),function(f){return r(f,o)}))})},Wo=function(e,c,o,i){var r=e.modelEvents?e.modelEvents:null,f=Array.isArray(r)?r.join(" "):r;fe(i,function(A,u){o&&typeof A=="string"&&A!==u&&A!==o.getContent({format:e.outputFormat})&&o.setContent(A)}),o.on(f||"change input undo redo",function(){c.emit("update:modelValue",o.getContent({format:e.outputFormat}))})},Zo=function(e,c,o,i,r,f){i.setContent(f()),o.attrs["onUpdate:modelValue"]&&Wo(c,o,i,r),Xo(e,o.attrs,i)},da=0,Fa=function(e){var c=Date.now(),o=Math.floor(Math.random()*1e9);return da++,e+"_"+o+da+String(c)},en=function(e){return e!==null&&e.tagName.toLowerCase()==="textarea"},ma=function(e){return typeof e>"u"||e===""?[]:Array.isArray(e)?e:e.split(" ")},tn=function(e,c){return ma(e).concat(ma(c))},an=function(e){return e==null},ca=function(){return{listeners:[],scriptId:Fa("tiny-script"),scriptLoaded:!1}},ln=function(){var e=ca(),c=function(r,f,A,u){var a=f.createElement("script");a.referrerPolicy="origin",a.type="application/javascript",a.id=r,a.src=A;var s=function(){a.removeEventListener("load",s),u()};a.addEventListener("load",s),f.head&&f.head.appendChild(a)},o=function(r,f,A){e.scriptLoaded?A():(e.listeners.push(A),r.getElementById(e.scriptId)||c(e.scriptId,r,f,function(){e.listeners.forEach(function(u){return u()}),e.scriptLoaded=!0}))},i=function(){e=ca()};return{load:o,reinitialize:i}},on=ln(),nn=function(){return typeof window<"u"?window:global},Ke=function(){var e=nn();return e&&e.tinymce?e.tinymce:null},sn={apiKey:String,cloudChannel:String,id:String,init:Object,initialValue:String,inline:Boolean,modelEvents:[String,Array],plugins:[String,Array],tagName:String,toolbar:[String,Array],modelValue:String,disabled:Boolean,tinymceScriptSrc:String,outputFormat:{type:String,validator:function(e){return e==="html"||e==="text"}}},Ve=function(){return Ve=Object.assign||function(e){for(var c,o=1,i=arguments.length;o<i;o++){c=arguments[o];for(var r in c)Object.prototype.hasOwnProperty.call(c,r)&&(e[r]=c[r])}return e},Ve.apply(this,arguments)},un=function(e,c,o,i){return e(i||"div",{id:c,ref:o})},rn=function(e,c,o){return e("textarea",{id:c,visibility:"hidden",ref:o})},bt={selector:void 0,target:void 0},dn=j({props:sn,setup:function(e,c){var o=e.init?Ve(Ve({},e.init),bt):Ve({},bt),i=nl(e),r=i.disabled,f=i.modelValue,A=i.tagName,u=g(null),a=null,s=e.id||Fa("tiny-vue"),d=e.init&&e.init.inline||e.inline,U=!!c.attrs["onUpdate:modelValue"],v=!0,m=e.initialValue?e.initialValue:"",p="",S=function(N){return U?function(){return f!=null&&f.value?f.value:""}:function(){return N?m:p}},V=function(){var N=S(v),T=Ve(Ve({},o),{readonly:e.disabled,target:u.value,plugins:tn(o.plugins,e.plugins),toolbar:e.toolbar||o.toolbar,inline:d,setup:function(Y){a=Y,Y.on("init",function(se){return Zo(se,e,c,Y,f,N)}),typeof o.setup=="function"&&o.setup(Y)}});en(u.value)&&(u.value.style.visibility=""),Ke().init(T),v=!1};fe(r,function(N){var T;a!==null&&(typeof((T=a.mode)===null||T===void 0?void 0:T.set)=="function"?a.mode.set(N?"readonly":"design"):a.setMode(N?"readonly":"design"))}),fe(A,function(N){var T;U||(p=a.getContent()),(T=Ke())===null||T===void 0||T.remove(a),Ut(function(){return V()})}),il(function(){if(Ke()!==null)V();else if(u.value&&u.value.ownerDocument){var N=e.cloudChannel?e.cloudChannel:"6",T=e.apiKey?e.apiKey:"no-api-key",Y=an(e.tinymceScriptSrc)?"https://cdn.tiny.cloud/1/".concat(T,"/tinymce/").concat(N,"/tinymce.min.js"):e.tinymceScriptSrc;on.load(u.value.ownerDocument,Y,V)}}),sl(function(){Ke()!==null&&Ke().remove(a)}),d||(ul(function(){v||V()}),rl(function(){var N;U||(p=a.getContent()),(N=Ke())===null||N===void 0||N.remove(a)}));var h=function(N){var T;p=a.getContent(),(T=Ke())===null||T===void 0||T.remove(a),o=Ve(Ve(Ve({},o),N),bt),Ut(function(){return V()})};return c.expose({rerender:h,getEditor:function(){return a}}),function(){return d?un(aa,s,u,e.tagName):rn(aa,s,u)}}});const mn=["colspan"],cn=w("strong",null,"E-Mail Content",-1),vn=["innerHTML"],fn=j({__name:"Communications",props:{expanded:{type:Boolean,default:!0},hideHistory:{type:Boolean,default:!1},registration:{},showEditor:{type:Boolean}},emits:["close-editor"],setup(e,{emit:c}){const o=Ae(),i=g([]),r=g({From:"",Subject:"",HTML:""}),f=g(""),A=g(""),u=g(""),a=g(!1),s=g(e.expanded?["1"]:[]),d=g([]),U=g([]),v=g([{key:"CreatedAt",title:"Date"},{key:"Subject",title:"Subject"},{key:"User.DisplayName",title:"Sender"},{key:"Status",title:"Status"}]),m=g([{key:"CreatedAt",order:"asc"}]);fe(r,N=>{u.value=N.From||u.value||"",A.value=N.Subject||A.value||"",f.value=N.HTML||f.value||""});const p=c,S=()=>{o.getRegistrationEmails(e.registration.RegistrationUUID).then(N=>{N&&(N.forEach(T=>{T.CreatedAt=At(new Date(T.CreatedAt||"")),T.Status=Zl(T.Status),T.User||(T.User={ID:0,UserUUID:"",DisplayName:"System",Handle:"",Credentials:[],Additional:{FirstName:"",LastName:"",DOB:"",Email:""},Data:"",Groups:[],Tags:[]})}),U.value=N)})};S(),(()=>{o.getRegistrationEmailTemplates(e.registration.RegistrationUUID).then(N=>{N&&(i.value=N)})})();const h=({callback:N})=>{o.sendRegistrationEmail(e.registration.RegistrationUUID,u.value,A.value,f.value).then(T=>{T?N&&(N("Email Sent"),S(),setTimeout(()=>{a.value=!1},2e3)):N&&N("Not sent")}).catch(()=>{N&&N("Not sent")})};return(N,T)=>(n(),_(M,null,[N.showEditor?(n(),D(me,{key:0,class:"px-0",style:{"max-width":"calc(100vw - 64px)"}},{default:l(()=>[t(Q,null,{default:l(()=>[t(O,null,{default:l(()=>[t(Ta,{items:i.value,"item-title":"Subject","return-object":"",label:"Template","hide-details":"",modelValue:r.value,"onUpdate:modelValue":T[0]||(T[0]=Y=>r.value=Y),variant:"outlined"},null,8,["items","modelValue"])]),_:1})]),_:1}),t(Q,null,{default:l(()=>[t(O,{cols:"12"},{default:l(()=>[t(oe,{modelValue:u.value,"onUpdate:modelValue":T[1]||(T[1]=Y=>u.value=Y),label:"From",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),t(O,{cols:"12"},{default:l(()=>[t(oe,{modelValue:A.value,"onUpdate:modelValue":T[2]||(T[2]=Y=>A.value=Y),label:"Subject",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),t(O,{cols:"12"},{default:l(()=>[t(E(dn),{modelValue:f.value,"onUpdate:modelValue":T[3]||(T[3]=Y=>f.value=Y),"api-key":"g9sce3fktcgvk0i7sp96cahgyk4cos7q27es3ubnlal3xf3z"},null,8,["modelValue"])]),_:1})]),_:1}),t(Q,null,{default:l(()=>[t(O,null,{default:l(()=>[t(rt,{onClick:T[4]||(T[4]=Y=>p("close-editor")),label:"Close E-mail Editor",color:"secondary","prepend-icon":"mdi:mdi-window-close"})]),_:1}),t(O,{class:"text-right"},{default:l(()=>[t(rt,{onClick:h,label:"Send",color:"error"})]),_:1})]),_:1})]),_:1})):b("",!0),U.value.length&&!N.hideHistory?(n(),D(It,{key:1,class:"my-2",multiple:!0,modelValue:s.value,"onUpdate:modelValue":T[7]||(T[7]=Y=>s.value=Y)},{default:l(()=>[t(St,{value:"1"},{default:l(()=>[t(Dt,null,{default:l(()=>[R(" Email History ")]),_:1}),t(yt,null,{default:l(()=>[t(zt,{items:U.value,headers:v.value,"show-expand":!0,"item-value":"EmailUUID",expanded:d.value,"onUpdate:expanded":T[5]||(T[5]=Y=>d.value=Y),"sort-by":m.value,"onUpdate:sortBy":T[6]||(T[6]=Y=>m.value=Y)},{"expanded-row":l(({columns:Y,item:se})=>[w("tr",null,[w("td",{colspan:Y.length},[cn,w("div",{class:"communicationsViewEmailPreview",innerHTML:se.HTML},null,8,vn)],8,mn)])]),"footer.prepend":l(()=>[t(K,{"prepend-icon":"mdi:mdi-refresh",color:"primary",class:"mr-4",onClick:S},{default:l(()=>[R("Refresh")]),_:1})]),_:1},8,["items","headers","expanded","sort-by"])]),_:1})]),_:1})]),_:1},8,["modelValue"])):b("",!0)],64))}}),$a=j({__name:"Emails",props:{allowSending:{type:Boolean,default:!0},expanded:{type:Boolean,default:!0},hideHistory:{type:Boolean,default:!1},showTitle:{type:Boolean,default:!0},registration:{},textClass:{default:""}},setup(e){const c=g(!1);return(o,i)=>(n(),_(M,null,[t($e,null,{default:l(()=>[o.showTitle?(n(),D(ot,{key:0},{default:l(()=>[t(We,null,{default:l(()=>[R(" E-Mails (#"+y(o.registration.Reference)+" "+y(o.registration.User.DisplayName)+") ",1)]),_:1})]),_:1})):b("",!0),t(Ze,{class:Qe(o.textClass)},{default:l(()=>[o.allowSending?(n(),D(Q,{key:0},{default:l(()=>[t(O,{cols:"12"},{default:l(()=>[t(K,{"prepend-icon":"mdi:mdi-email",color:"primary",onClick:i[0]||(i[0]=r=>c.value=!0)},{default:l(()=>[R(" Prepare Email ")]),_:1})]),_:1})]),_:1})):b("",!0)]),_:1},8,["class"])]),_:1}),t(fn,{registration:o.registration,expanded:o.expanded,"hide-history":o.hideHistory,"show-editor":c.value,onCloseEditor:i[1]||(i[1]=r=>c.value=!1)},null,8,["registration","expanded","hide-history","show-editor"])],64))}}),Un=j({__name:"EditNoteCategoryDialog",props:J({convention:{},noteCategory:{},title:{}},{modelValue:{type:Boolean,required:!0},modelModifiers:{}}),emits:J(["update:noteCategory"],["update:modelValue"]),setup(e,{emit:c}){const o=e,{title:i=""}=o,r=c,f=te(e,"modelValue"),A=mt(o,r,void 0,void 0,"noteCategory"),u=g(Ee(A.value));fe(A,()=>{u.value=Ee(A.value)});const a=()=>{f.value=!1},s=()=>{u.value=Ee(A.value)},d=()=>{A.value=u.value};return(U,v)=>(n(),D(Pe,{modelValue:f.value,"onUpdate:modelValue":v[2]||(v[2]=m=>f.value=m),onReset:s,onSave:d,title:E(i),color:"primary",persistent:!0,fullscreen:!1,"hide-extension":!0},{default:l(()=>[t(me,{class:"pa-0",fluid:!0},{default:l(()=>[t(Q,null,{default:l(()=>[t(O,{cols:"12",sm:"6",md:"4"},{default:l(()=>[t(oe,{modelValue:u.value.Name,"onUpdate:modelValue":v[0]||(v[0]=m=>u.value.Name=m),label:"Internal name",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),t(O,{cols:"12",sm:"6",md:"4"},{default:l(()=>[t(Sa,{modelValue:u.value.Groups,"onUpdate:modelValue":v[1]||(v[1]=m=>u.value.Groups=m),convention:U.convention,label:"Groups",variant:"outlined","hide-details":""},null,8,["modelValue","convention"])]),_:1})]),_:1})]),_:1})]),actions:l(()=>[t(K,{color:"blue-darken-1",variant:"text",onClick:a},{default:l(()=>[R(" Cancel ")]),_:1}),t(K,{color:"blue-darken-1",variant:"text",onClick:s},{default:l(()=>[R(" Reset ")]),_:1}),t(Fe),t(K,{color:"blue-darken-1",variant:"text",onClick:d},{default:l(()=>[R(" Save ")]),_:1})]),_:1},8,["modelValue","title"]))}}),An=()=>{const e=g(""),c=()=>{const o={x:window.innerWidth,y:window.innerHeight};o.x<600?e.value="xs":o.x>=600&&o.x<960?e.value="sm":o.x>=960&&o.x<1280?e.value="md":o.x>=1280&&o.x<1920?e.value="lg":o.x>=1920&&o.x<2560?e.value="xl":o.x>=2560&&(e.value="xxl")};return window.addEventListener("resize",c),c(),e},Tn={style:{"list-style":"none"}},_n=j({__name:"NoteCategories",props:{hideHistory:{type:Boolean},convention:{},showEditor:{type:Boolean}},emits:["close"],setup(e,{emit:c}){const o=Ae(),i=c,r=g(!1),f=g(!1),A=g(""),u=g([]),a=g([{key:"Name",title:"Name"},{key:"Groups",title:"Groups"},{key:"actions",title:"",sortable:!1}]),s=An();g([{key:"CreatedAt",order:"asc"}]);const d=()=>({ID:0,NoteCategoryUUID:ye(),ConventionID:e.convention.ID,ConventionUUID:e.convention.ConventionUUID,Name:"",Groups:[],Notes:[]}),U=g(-1),v=g(d()),m=g(d()),p=()=>{m.value.NoteCategoryUUID=ye(),v.value=Object.assign({},d()),U.value=-1,r.value=!0},S=z=>{U.value=u.value.indexOf(z),v.value=Object.assign({},z),r.value=!0},V=z=>{U.value=u.value.indexOf(z),v.value=Object.assign({},z),f.value=!0},h=()=>{o.deleteNoteCategory(v.value.NoteCategoryUUID).then(z=>{z&&(u.value.splice(U.value,1),T())})},N=()=>{r.value=!1,Ut(()=>{v.value=Object.assign({},m.value),U.value=-1})},T=()=>{f.value=!1,Ut(()=>{v.value=Object.assign({},m.value),U.value=-1})},Y=()=>{o.saveNoteCategory(v.value).then(z=>{z&&(U.value>-1?Object.assign(u.value[U.value],z):u.value.push(z),N())})};return(()=>{o.getNoteCategories(e.convention.ConventionUUID).then(z=>{z&&(u.value=z)})})(),(z,x)=>(n(),D(zt,{headers:a.value,items:u.value,"sort-by":[{key:"calories",order:"asc"}],class:"elevation-1"},{top:l(()=>[t($t,{color:"primary"},Je({default:l(()=>[t(Ma,null,{default:l(()=>[R("Note Categories")]),_:1}),t(Fl,{class:"mx-4 d-none d-sm-inline-flex",inset:!0,vertical:!0}),t(Fe,{class:"d-none d-sm-inline-flex"}),E(s)!="xs"?(n(),D(K,{key:0,dark:"",class:"mb-2","prepend-icon":"mdi:mdi-pencil",onClick:p},{default:l(()=>[R(" New Item ")]),_:1})):b("",!0),t(K,{dark:"",class:"mb-2",icon:"mdi:mdi-window-close",onClick:x[0]||(x[0]=le=>i("close"))}),t(Oa,{modelValue:f.value,"onUpdate:modelValue":x[1]||(x[1]=le=>f.value=le),onDelete:h},null,8,["modelValue"])]),_:2},[E(s)=="xs"?{name:"extension",fn:l(()=>[t(Fe),t(K,{dark:"",class:"mb-2","prepend-icon":"mdi:mdi-pencil",onClick:p},{default:l(()=>[R(" New Item ")]),_:1})]),key:"0"}:void 0]),1024),r.value?(n(),D(Un,{key:0,modelValue:r.value,"onUpdate:modelValue":x[2]||(x[2]=le=>r.value=le),"note-category":v.value,"onUpdate:noteCategory":[x[3]||(x[3]=le=>v.value=le),Y],title:A.value,convention:z.convention},null,8,["modelValue","note-category","title","convention"])):b("",!0)]),"item.Groups":l(({item:le})=>[w("ul",Tn,[(n(!0),_(M,null,W(le.Groups,G=>(n(),_("li",{key:G.GroupUUID,class:"py-1"},y(G.Name),1))),128))])]),"item.actions":l(({item:le})=>[t(Me,{size:"small",class:"me-2",onClick:G=>S(le)},{default:l(()=>[R(" mdi:mdi-pencil ")]),_:2},1032,["onClick"]),t(Me,{size:"small",onClick:G=>V(le)},{default:l(()=>[R(" mdi:mdi-delete ")]),_:2},1032,["onClick"])]),_:1},8,["headers","items"]))}}),En=j({__name:"SelectNoteCategories",props:J({convention:{},chips:{type:Boolean,default:!1},clearable:{type:Boolean,default:!1},hint:{default:""},label:{},variant:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:J(["change"],["update:modelValue"]),setup(e,{emit:c}){const o=te(e,"modelValue"),i=c,r=g([]),f=Ae(),A=g([]),u=g(""),a=g(0),s=ue(()=>[...A.value].map(v=>({title:v.Name,value:r.value.find(m=>m.NoteCategoryUUID===v.NoteCategoryUUID)||v})));return typeof e.convention=="object"?u.value=e.convention.ConventionUUID:u.value=e.convention||"",(async()=>{const U=[];u.value&&U.push(f.getNoteCategories(u.value));const v=await Promise.all(U);if(u.value&&v.length==1&&(A.value=v[0].sort((m,p)=>m.Name.localeCompare(p.Name))),Array.isArray(o.value))a.value=2,s.value.forEach(m=>{Array.isArray(o.value)&&o.value.find(S=>S.NoteCategoryUUID===m.value.NoteCategoryUUID)&&r.value.push(m.value)});else if(typeof o.value=="string"){a.value=1;try{const m=JSON.parse(o.value);s.value.forEach(p=>{m.find(V=>V.NoteCategoryUUID===p.value.NoteCategoryUUID)&&r.value.push(p.value)})}catch{}}})(),fe(r,()=>{switch(a.value){default:case 2:{o.value=r.value,i("change");break}case 1:{o.value=JSON.stringify(r.value),i("change");break}}}),(U,v)=>(n(),D(Ta,{modelValue:r.value,"onUpdate:modelValue":v[0]||(v[0]=m=>r.value=m),chips:U.chips,multiple:"",label:U.label||"Tags",variant:U.variant||"solo",hint:U.hint,"persistent-hint":!0,clearable:U.clearable,items:s.value,"item-title":"title","item-value":"value"},null,8,["modelValue","chips","label","variant","hint","clearable","items"]))}}),gn=j({__name:"EditNoteDialog",props:J({convention:{},note:{},title:{}},{modelValue:{type:Boolean,required:!0},modelModifiers:{}}),emits:J(["update:note","saved"],["update:modelValue"]),setup(e,{emit:c}){const o=e,{title:i=""}=o,r=Ae(),f=c,A=te(e,"modelValue"),u=mt(o,f,void 0,void 0,"note"),a=g(Ee(u.value));fe(u,()=>{a.value=Ee(u.value)});const s=()=>{a.value=Ee(u.value)},d=U=>{a.value.NoteCategories===null&&(a.value.NoteCategories=[]),a.value.CreatedAt=void 0,a.value.DeletedAt=void 0,a.value.UpdatedAt=void 0,a.value.Admin=void 0,a.value.AdminID=void 0,a.value.AdminUUID=void 0,r.saveNote(a.value).then(v=>{v?(a.value=Ee(v),U&&U("Note Saved"),u.value=a.value,f("saved",u.value)):U&&U("Internal Error Saving Note")}).catch(v=>{U&&U("Error Saving Note:"+v.ErrorMessage)})};return(U,v)=>a.value?(n(),D(Pe,{key:0,"card-class":"pa-4",modelValue:A.value,"onUpdate:modelValue":v[3]||(v[3]=m=>A.value=m),onReset:s,onSave:d,title:E(i),color:"primary",persistent:!0,fullscreen:!1,"hide-extension":!0,"show-close-action":!0,"show-reset-action":!0,"show-save-action":!0},{default:l(()=>[t(me,{class:"pa-0",fluid:!0},{default:l(()=>[t(Q,null,{default:l(()=>[t(O,{cols:"12"},{default:l(()=>[t(En,{modelValue:a.value.NoteCategories,"onUpdate:modelValue":v[0]||(v[0]=m=>a.value.NoteCategories=m),convention:U.convention,label:"Categories",variant:"outlined","hide-details":"",chips:!0},null,8,["modelValue","convention"])]),_:1})]),_:1}),t(Q,null,{default:l(()=>[t(O,{cols:"12"},{default:l(()=>[t(oe,{modelValue:a.value.Subject,"onUpdate:modelValue":v[1]||(v[1]=m=>a.value.Subject=m),label:"Subject",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),t(O,{cols:"12"},{default:l(()=>[t(ha,{modelValue:a.value.Description,"onUpdate:modelValue":v[2]||(v[2]=m=>a.value.Description=m),label:"Note",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue","title"])):b("",!0)}}),Ya=j({__name:"Notes",props:{allowAdding:{type:Boolean,default:!0},cardClass:{default:""},convention:{},expanded:{type:Boolean,default:!0},hideHistory:{type:Boolean},registration:{},showControlPanel:{type:Boolean,default:!0},showEditor:{type:Boolean},showTitle:{type:Boolean,default:!0},textClass:{default:""}},setup(e){const c=Ae(),o=()=>({ID:0,NoteUUID:ye(),Description:"",NoteCategories:[],Registration:e.registration,RegistrationID:e.registration.ID,RegistrationUUID:e.registration.RegistrationUUID,Subject:""}),i=g(!1),r=g(!1),f=g([]),A=g([]),u=g(o()),a=()=>{u.value=o(),i.value=!0},s=v=>{u.value=v,i.value=!0},d=()=>{c.getRegistrationNotes(e.registration.RegistrationUUID).then(v=>{v&&(v.forEach(m=>{m.CreatedAt=At(new Date(m.CreatedAt||"")),m.Admin||(m.Admin={ID:0,UserUUID:"",DisplayName:"System",Handle:"",Credentials:[],Additional:{FirstName:"",LastName:"",DOB:"",Email:""},Data:"",Groups:[],Tags:[]})}),f.value=v,e.expanded&&(A.value=v.map(m=>m.NoteUUID)))})},U=()=>{d(),setTimeout(()=>{i.value=!1},2e3)};return d(),(v,m)=>(n(),_(M,null,[t($e,{class:Qe(v.cardClass)},{default:l(()=>[t(ot,null,{default:l(()=>[t(We,null,{default:l(()=>[t(Q,{class:"flex-row-reverse"},{default:l(()=>[v.showControlPanel?(n(),D(O,{key:0,class:"text-right flex-shrink-1 flex-grow-0",style:{"flex-grow":"0 !important"}},{default:l(()=>[t(K,{class:"d-sm-none",size:"xs",icon:"mdi:mdi-cog",variant:"text",color:"warning",onClick:m[0]||(m[0]=p=>r.value=!0)}),t(K,{class:"d-none d-sm-inline-flex","prepend-icon":"mdi:mdi-cog",variant:"text",color:"warning",onClick:m[1]||(m[1]=p=>r.value=!0)},{default:l(()=>[R("Categories")]),_:1})]),_:1})):b("",!0),v.showTitle?(n(),D(O,{key:1,class:"text-wrap flex-grow-1"},{default:l(()=>[R(" Notes (#"+y(v.registration.Reference)+" "+y(v.registration.User.DisplayName)+") ",1)]),_:1})):b("",!0)]),_:1})]),_:1})]),_:1}),t(Ze,{class:Qe(v.textClass)},{default:l(()=>[f.value.length===0?(n(),_(M,{key:0},[R(" No Notes Recorded ")],64)):(n(),D(It,{key:1,multiple:!0,variant:"accordion",modelValue:A.value,"onUpdate:modelValue":m[2]||(m[2]=p=>A.value=p)},{default:l(()=>[(n(!0),_(M,null,W(f.value,p=>(n(),D(St,{key:`${p.NoteUUID}.${p.UpdatedAt}`,value:p.NoteUUID},{default:l(()=>[t(Dt,{class:"py-0"},{default:l(()=>[R(y(p.Subject)+" ",1),t(ka,{class:"ml-4"},{default:l(()=>[p.NoteCategories.length===0?(n(),D(Yt,{key:0},{default:l(()=>[R(" Global ")]),_:1})):b("",!0),(n(!0),_(M,null,W(p.NoteCategories,S=>(n(),D(Yt,{key:S.NoteCategoryUUID},{default:l(()=>[R(y(S.Name),1)]),_:2},1024))),128))]),_:2},1024)]),_:2},1024),t(yt,null,{default:l(()=>[t(Q,null,{default:l(()=>[t(O,null,{default:l(()=>[R(y(p.Description),1)]),_:2},1024)]),_:2},1024),t(Q,null,{default:l(()=>[t(O,null,{default:l(()=>[R(y(E(Oe)(p.UpdatedAt||""))+" ",1),p&&p.Admin&&p.Admin.DisplayName?(n(),_(M,{key:0},[R(" - "+y(p.Admin.DisplayName),1)],64)):b("",!0)]),_:2},1024),t(O,{class:"text-right"},{default:l(()=>[t(K,{color:"primary","prepend-icon":"mdi:mdi-pencil",onClick:S=>s(p)},{default:l(()=>[R("Edit")]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"]))]),_:1},8,["class"]),v.allowAdding?(n(),D(Kt,{key:0},{default:l(()=>[t(K,{color:"primary",variant:"flat",onClick:a},{default:l(()=>[R("Add Note")]),_:1})]),_:1})):b("",!0)]),_:1},8,["class"]),t(_t,{modelValue:i.value,"onUpdate:modelValue":m[5]||(m[5]=p=>i.value=p),title:"Create Note"},{default:l(()=>[t(gn,{modelValue:i.value,"onUpdate:modelValue":m[3]||(m[3]=p=>i.value=p),note:u.value,"onUpdate:note":m[4]||(m[4]=p=>u.value=p),convention:v.convention,title:"Create Note",onSaved:U},null,8,["modelValue","note","convention"])]),_:1},8,["modelValue"]),t(_t,{modelValue:r.value,"onUpdate:modelValue":m[7]||(m[7]=p=>r.value=p),title:"Note Configuration"},{default:l(()=>[t(_n,{convention:v.convention,onClose:m[6]||(m[6]=p=>r.value=!1)},null,8,["convention"])]),_:1},8,["modelValue"])],64))}}),pn=j({__name:"StripeRefundPayment",props:J({paymentTransaction:{}},{modelValue:{type:Boolean,required:!0},modelModifiers:{}}),emits:J(["refunded"],["update:modelValue"]),setup(e,{emit:c}){const o=te(e,"modelValue"),i=c,r=Ae(),f=g(!1),A=g("");let u=0;if(e.paymentTransaction.Data&&e.paymentTransaction.Data.PaymentIntent&&typeof e.paymentTransaction.Data.PaymentIntent=="object"){const m=e.paymentTransaction.Data.PaymentIntent;m&&(u=m.amount)}const a=g({Amount:u/100,Description:"",Reason:""}),s=g([{title:"Duplicate",value:"duplicate"},{title:"Fraudulent",value:"fraudulent"},{title:"Requested By Customer",value:"requested_by_customer"}]),d=g(!1);async function U(m){m.preventDefault(),d.value=!0,r.refundStripePayment(e.paymentTransaction.PaymentTransactionUUID,a.value).then(p=>{p?i("refunded",p):v("An unexpected error occurred.")}).catch(p=>{v("An error occurred processing the refund: "+p.toString())}),d.value=!1}const v=m=>{A.value=m,f.value=!0};return(m,p)=>(n(),D(Pe,{modelValue:o.value,"onUpdate:modelValue":p[7]||(p[7]=S=>o.value=S),title:"Refund a Stripe Payment",color:"blue-darken-4",persistent:""},{default:l(()=>[t(me,{class:"pa-0"},{default:l(()=>[t($l,{ref:"refundForm",id:"refund-form",onSubmit:p[4]||(p[4]=Lt(S=>U(S),["prevent"]))},{default:l(()=>[t(Q,null,{default:l(()=>[t(O,{cols:"12",sm:"6",md:"4",lg:"3",xl:"2"},{default:l(()=>[t(oe,{modelValue:a.value.Amount,"onUpdate:modelValue":p[0]||(p[0]=S=>a.value.Amount=S),modelModifiers:{number:!0},label:"Amount",prefix:"£",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),t(O,{cols:"12",sm:"6",md:"8",lg:"9",xl:"10"},{default:l(()=>[t(ve,{modelValue:a.value.Reason,"onUpdate:modelValue":p[1]||(p[1]=S=>a.value.Reason=S),modelModifiers:{number:!0},items:s.value,"item-title":"title","item-value":"value",label:"Stripe Refund Reason",variant:"outlined","hide-details":""},null,8,["modelValue","items"])]),_:1}),t(O,{cols:"12"},{default:l(()=>[t(oe,{modelValue:a.value.Description,"onUpdate:modelValue":p[2]||(p[2]=S=>a.value.Description=S),modelModifiers:{number:!0},label:"Refund Description",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1})]),_:1}),t(Q,null,{default:l(()=>[t(O,{class:"text-right",cols:"12",sm:"3",md:"2",lg:"2",xl:"1"},{default:l(()=>[t(K,{color:"error",class:"w-100",onClick:p[3]||(p[3]=S=>o.value=!1)},{default:l(()=>[R("Cancel")]),_:1})]),_:1}),t(Fe),t(O,{class:"text-left",cols:"12",sm:"3",md:"2",lg:"2",xl:"1"},{default:l(()=>[t(K,{type:"submit",color:"success",class:"w-100"},Je({default:l(()=>[R(" Issue Refund ")]),_:2},[d.value?{name:"prepend",fn:l(()=>[t(ga,{size:"20",indeterminate:""})]),key:"0"}:void 0]),1024)]),_:1})]),_:1})]),_:1},512)]),_:1}),t(ya,{modelValue:f.value,"onUpdate:modelValue":p[6]||(p[6]=S=>f.value=S)},{actions:l(()=>[t(K,{variant:"text",onClick:p[5]||(p[5]=S=>f.value=!1)},{default:l(()=>[R(" Close ")]),_:1})]),default:l(()=>[R(y(A.value)+" ",1)]),_:1},8,["modelValue"])]),_:1},8,["modelValue"]))}}),Dn=["colspan"],yn=w("strong",null,"Details",-1),Sn=["innerHTML"],Ga=j({__name:"PaymentTransactions",props:{canEdit:{type:Boolean},expanded:{type:Boolean},hideHistory:{type:Boolean},updated:{},registration:{},showEditor:{type:Boolean}},emits:["close-editor","change"],setup(e,{emit:c}){const o=e;let{expanded:i=!0,hideHistory:r=!1,registration:f,showEditor:A}=o;const u=Ae(),a=g([]),s=g(i?["1"]:[]),d=g([]),U=g([{key:"CreatedAt",title:"Date"},{key:"Type",title:"Type"},{key:"Source",title:"Source"},{key:"Description",title:"Description"},{key:"Admin",title:"Admin"},{key:"Amount",title:"Amount"},{key:"Controls",title:""}]),v=g(!1),m=g(),p=g(!1),S=g(""),V=g([{key:"CreatedAt",order:"asc"}]),h=c,N=()=>({PaymentTransactionUUID:ye(),Amount:0,Data:{},Description:"",ID:0,RegistrationID:f.ID,RegistrationUUID:f.RegistrationUUID,Source:oa.PAYMENT_TRANSACTION_SOURCE_NULL,Type:Pt.PAYMENT_TRANSACTION_TYPE_NULL}),T=g(N()),{convertTransactions:Y,getPaymentTransactionsDisplay:se}=Ea();fe(o,()=>{r=o.hideHistory,f=o.registration,A=o.showEditor,se(f.RegistrationUUID).then($=>{d.value=$})});const z=()=>{se(f.RegistrationUUID).then($=>{d.value=$})};z();const x=()=>{u.saveRegistrationPaymentTransaction(T.value).then($=>{$&&(Y($.PaymentTransactions),T.value=N(),h("close-editor"),h("change"))})},le=$=>{const P=d.value.find(k=>k.PaymentTransactionUUID===$);P&&(m.value=P.PaymentTransaction,v.value=!0)},G=$=>{if($)try{d.value=Y($.PaymentTransactions),m.value=void 0,v.value=!1,S.value="Refund Processed",p.value=!0,h("change")}catch(P){console.error(P)}};return($,P)=>(n(),_(M,null,[E(A)?(n(),_(M,{key:0},[t(We,null,{default:l(()=>[R(" Add Transaction ")]),_:1}),t(Q,null,{default:l(()=>[t(O,{cols:"12",sm:"6"},{default:l(()=>[t(ve,{items:E(_l),"item-title":"title","item-value":"value",label:"Transaction Type",clearable:!0,"hide-details":"",modelValue:T.value.Type,"onUpdate:modelValue":P[0]||(P[0]=k=>T.value.Type=k),variant:"outlined"},null,8,["items","modelValue"])]),_:1}),t(O,{cols:"12",sm:"6"},{default:l(()=>[t(ve,{items:E(El),"item-title":"title","item-value":"value",label:"Source",clearable:!0,"hide-details":"",modelValue:T.value.Source,"onUpdate:modelValue":P[1]||(P[1]=k=>T.value.Source=k),variant:"outlined"},null,8,["items","modelValue"])]),_:1})]),_:1}),t(Q,null,{default:l(()=>[t(O,{cols:"12",sm:"8",md:"10"},{default:l(()=>[t(oe,{label:"Description","hide-details":"",modelValue:T.value.Description,"onUpdate:modelValue":P[2]||(P[2]=k=>T.value.Description=k),variant:"outlined"},null,8,["modelValue"])]),_:1}),t(O,{cols:"12",sm:"4",md:"2"},{default:l(()=>[t(oe,{label:"Amount","prepend-inner-icon":"mdi:mdi-currency-gbp","hide-details":"",modelValue:T.value.Amount,"onUpdate:modelValue":P[3]||(P[3]=k=>T.value.Amount=k),modelModifiers:{number:!0},variant:"outlined"},null,8,["modelValue"])]),_:1})]),_:1}),t(Q,null,{default:l(()=>[t(O,{cols:"12",sm:"3",md:"2",lg:"1"},{default:l(()=>[t(K,{class:"w-100",onClick:P[4]||(P[4]=k=>h("close-editor")),color:"warning"},{default:l(()=>[R("Cancel")]),_:1})]),_:1}),t(Fe),t(O,{cols:"12",sm:"6",md:"3",lg:"2",xl:"2"},{default:l(()=>[t(K,{class:"w-100",onClick:x,color:"primary"},{default:l(()=>[R("Submit Transaction")]),_:1})]),_:1})]),_:1})],64)):b("",!0),d.value.length&&!E(r)?(n(),D(It,{key:1,class:"my-2",modelValue:s.value,"onUpdate:modelValue":P[10]||(P[10]=k=>s.value=k)},{default:l(()=>[t(St,{value:"1"},{default:l(()=>[t(Dt,null,{default:l(()=>[R(" Transaction History ")]),_:1}),t(yt,null,{default:l(()=>[t(zt,{items:d.value,headers:U.value,"show-expand":!1,"item-value":"PaymentTransactionUUID",expanded:a.value,"onUpdate:expanded":P[5]||(P[5]=k=>a.value=k),"sort-by":V.value,"onUpdate:sortBy":P[6]||(P[6]=k=>V.value=k),class:"transactionTable"},{"item.Controls":l(({item:k})=>[$.canEdit&&k.PaymentTransaction&&k.PaymentTransaction.Source===E(oa).PAYMENT_TRANSACTION_SOURCE_STRIPE&&k.PaymentTransaction.Type===E(Pt).PAYMENT_TRANSACTION_TYPE_PAYMENT?(n(),D(K,{key:0,icon:"mdi:mdi-credit-card-refund",variant:"text",size:"xs",onClick:Z=>le(k.PaymentTransactionUUID)},null,8,["onClick"])):b("",!0)]),"expanded-row":l(({columns:k,item:Z})=>[w("tr",null,[w("td",{colspan:k.length},[yn,w("div",{innerHTML:Z.Data},null,8,Sn)],8,Dn)])]),"footer.prepend":l(()=>[t(K,{"prepend-icon":"mdi:mdi-refresh",color:"primary",class:"mr-4",onClick:z},{default:l(()=>[R("Refresh")]),_:1})]),_:1},8,["items","headers","expanded","sort-by"]),v.value&&m.value?(n(),D(pn,{key:0,modelValue:v.value,"onUpdate:modelValue":P[7]||(P[7]=k=>v.value=k),"payment-transaction":m.value,onRefunded:G},null,8,["modelValue","payment-transaction"])):b("",!0),t(ya,{modelValue:p.value,"onUpdate:modelValue":P[9]||(P[9]=k=>p.value=k)},{actions:l(()=>[t(K,{variant:"text",onClick:P[8]||(P[8]=k=>p.value=!1)},{default:l(()=>[R(" Close ")]),_:1})]),default:l(()=>[R(y(S.value)+" ",1)]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])):b("",!0)],64))}}),In=j({__name:"DataPanelRegistrationTags",props:J({registration:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(e){const c=te(e,"modelValue"),o=ue(()=>!c.value.Meta.Tags||!Array.isArray(c.value.Meta.Tags)||c.value.Meta.Tags.length===0?e.registration.Tags:e.registration.Tags.filter(i=>c.value.Meta.Tags.includes(i.TagUUID)));return(i,r)=>(n(),D(ka,null,{default:l(()=>[(n(!0),_(M,null,W(o.value,f=>(n(),D(Yt,{key:f.TagUUID},{default:l(()=>[R(y(f.Title),1)]),_:2},1024))),128))]),_:1}))}}),Cn=dt(In,[["__scopeId","data-v-8cc2c172"]]),Rn=(e,c)=>e===void 0?!1:gt(e,Et.GROUP_TYPE_CONVENTION,c.ConventionUUID,c).CheckIn;var Ie=(e=>(e.CHECK_IN_STATUS_PENDING="CHECK_IN_STATUS_PENDING",e.CHECK_IN_STATUS_COMPLETED="CHECK_IN_STATUS_COMPLETED",e.CHECK_IN_STATUS_REJECTED="CHECK_IN_STATUS_REJECTED",e.CHECK_IN_STATUS_REVOKED="CHECK_IN_STATUS_REVOKED",e))(Ie||{});const Vn=[{title:"Pending",value:"CHECK_IN_STATUS_PENDING"},{title:"Completed",value:"CHECK_IN_STATUS_COMPLETED"},{title:"Rejected",value:"CHECK_IN_STATUS_REJECTED"},{title:"Revoked",value:"CHECK_IN_STATUS_REVOKED"}],je=e=>{var c;return((c=Vn.find(o=>o.value===e))==null?void 0:c.title)||""},On=w("span",{class:"font-weight-bold pr-2"},"Status:",-1),Mn={key:0,class:"text-green-darken-2"},hn={key:1,class:"text-yellow-darken-2"},kn={key:2,class:"text-red-darken-4"},Nn=w("br",null,null,-1),bn=w("span",{class:"font-weight-bold pr-2"},"Status:",-1),Ln={key:0,class:"text-green-darken-2"},wn={key:1,class:"text-yellow-darken-2"},Pn={key:2,class:"text-red-darken-4"},Fn=w("span",null,"Not Checked In",-1),Gt=j({__name:"DataPanelCheckIn",props:J({convention:{},showControls:{type:Boolean,default:!1}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(e){const c=te(e,"modelValue"),o=Ae(),i=Xe(),r=Rn(i,e.convention),f=g([]),A=g(!1),u=g(!1),a=g(Ie.CHECK_IN_STATUS_PENDING),s=g(""),d=p=>{A.value=!0,a.value=p},U=()=>{v()},v=()=>{o.getCheckInHistory(c.value.RegistrationUUID).then(p=>{p&&(f.value=p,u.value=!0)}).catch(()=>{})},m=p=>{o.saveCheckIn(c.value.RegistrationUUID,a.value,s.value).then(S=>{S?(c.value.CheckIn=S,p&&(p("Check In Saved"),setTimeout(()=>{A.value=!1},500))):p&&p("Check In Failed")}).catch(()=>{p&&p("Check In Failed")})};return(p,S)=>(n(),_(M,null,[p.showControls&&E(r)?(n(),D(me,{key:0,class:"px-0"},{default:l(()=>[t(Q,null,{default:l(()=>[t(O,null,{default:l(()=>[t(K,{color:"error",class:"w-100","prepend-icon":"mdi:mdi-window-close",onClick:S[0]||(S[0]=V=>d(E(Ie).CHECK_IN_STATUS_REJECTED))},{default:l(()=>[R(" Reject ")]),_:1})]),_:1}),t(O,null,{default:l(()=>[t(K,{color:"warning",class:"w-100","prepend-icon":"mdi:mdi-window-close",onClick:S[1]||(S[1]=V=>d(E(Ie).CHECK_IN_STATUS_REVOKED))},{default:l(()=>[R(" Revoke ")]),_:1})]),_:1}),t(O,null,{default:l(()=>[t(K,{color:"success",class:"w-100","prepend-icon":"mdi:mdi-check",onClick:S[2]||(S[2]=V=>d(E(Ie).CHECK_IN_STATUS_COMPLETED))},{default:l(()=>[R(" Approve ")]),_:1})]),_:1})]),_:1}),t(Pe,{modelValue:A.value,"onUpdate:modelValue":S[4]||(S[4]=V=>A.value=V),fullscreen:!1,"hide-extension":!0,persistent:!1,scrollable:!1,"show-close-action":!0,"show-save-action":!0,"save-button-label":"Confirm",title:`${E(je)(a.value)} Check-In`,onSave:m},{default:l(()=>[t(ha,{modelValue:s.value,"onUpdate:modelValue":S[3]||(S[3]=V=>s.value=V),label:"Notes",variant:"outlined"},null,8,["modelValue"])]),_:1},8,["modelValue","title"])]),_:1})):b("",!0),c.value.CheckIn?(n(),D(me,{key:1,class:"px-0"},{default:l(()=>[t(Q,null,{default:l(()=>[t(O,null,{default:l(()=>[On,c.value.CheckIn.Status===E(Ie).CHECK_IN_STATUS_COMPLETED?(n(),_("span",Mn,y(E(je)(c.value.CheckIn.Status)),1)):c.value.CheckIn.Status===E(Ie).CHECK_IN_STATUS_REVOKED?(n(),_("span",hn,y(E(je)(c.value.CheckIn.Status)),1)):c.value.CheckIn.Status===E(Ie).CHECK_IN_STATUS_REJECTED?(n(),_("span",kn,y(E(je)(c.value.CheckIn.Status)),1)):b("",!0),Nn,t(K,{style:{"font-size":"0.75rem","text-transform":"none"},"append-icon":"mdi:mdi-chevron-down",size:"xs",variant:"text",onClick:U},{default:l(()=>[R("History")]),_:1})]),_:1}),t(O,{class:"text-right"},{default:l(()=>{var V;return[w("small",null,y((V=c.value.CheckIn.Admin)==null?void 0:V.DisplayName)+" "+y(E(At)(c.value.CheckIn.CreatedAt||"")),1)]}),_:1})]),_:1}),t(Pe,{modelValue:u.value,"onUpdate:modelValue":S[5]||(S[5]=V=>u.value=V),fullscreen:!1,"hide-extension":!0,persistent:!1,scrollable:!0,"show-close-action":!0,"show-save-action":!1,title:"Check-In History"},{default:l(()=>[t(we,null,{default:l(()=>[(n(!0),_(M,null,W(f.value,V=>(n(),D(be,{key:V.CheckInUUID},{default:l(()=>[t(Tt,null,{default:l(()=>[t(Q,null,{default:l(()=>[t(O,null,{default:l(()=>[bn,V.Status===E(Ie).CHECK_IN_STATUS_COMPLETED?(n(),_("span",Ln,y(E(je)(V.Status)),1)):V.Status===E(Ie).CHECK_IN_STATUS_REVOKED?(n(),_("span",wn,y(E(je)(V.Status)),1)):V.Status===E(Ie).CHECK_IN_STATUS_REJECTED?(n(),_("span",Pn,y(E(je)(V.Status)),1)):b("",!0)]),_:2},1024),t(O,{class:"text-right"},{default:l(()=>{var h;return[w("small",null,y((h=V.Admin)==null?void 0:h.DisplayName)+" "+y(E(At)(V.CreatedAt||"")),1)]}),_:2},1024)]),_:2},1024)]),_:2},1024),V.Details?(n(),D(pl,{key:0},{default:l(()=>[R(y(V.Details),1)]),_:2},1024)):b("",!0)]),_:2},1024))),128))]),_:1})]),_:1},8,["modelValue"])]),_:1})):(n(),D(me,{key:2,class:"px-0"},{default:l(()=>[Fn]),_:1}))],64))}}),$n=j({__name:"MetaDataItem",props:J({accommodations:{},convention:{},forms:{},interests:{},itemClass:{},tickets:{},venues:{}},{modelValue:{required:!0},modelModifiers:{},registration:{required:!0},registrationModifiers:{}}),emits:J(["openActions","showForm"],["update:modelValue","update:registration"]),setup(e,{emit:c}){const o=te(e,"modelValue"),i=te(e,"registration"),r=c,f=u=>{r("openActions",u)},A=(u,a,s)=>{r("showForm",u,a,s)};return(u,a)=>o.value.MetaField===E(B).META_DATA_SOURCE_ACCOMMODATION_ALLOCATION?(n(),D(Pa,{key:0,convention:u.convention,tickets:u.tickets,accommodations:u.accommodations,venues:u.venues,registration:i.value,forms:u.forms,modelValue:o.value,"onUpdate:modelValue":a[0]||(a[0]=s=>o.value=s),data:""},null,8,["convention","tickets","accommodations","venues","registration","forms","modelValue"])):o.value.MetaField===E(B).META_DATA_SOURCE_BADGE_DISPLAY?(n(),D(Qt,{key:1,"card-class":u.itemClass,registration:i.value,"show-title":!1},null,8,["card-class","registration"])):o.value.MetaField===E(B).META_DATA_SOURCE_EMAILS?(n(),D($a,{key:2,"allow-sending":!1,expanded:!1,"show-title":!1,registration:i.value,"text-class":"pa-0 ma-0"},null,8,["registration"])):o.value.MetaField===E(B).META_DATA_SOURCE_NOTES?(n(),D(Ya,{key:3,"allow-adding":!0,"card-class":u.itemClass,convention:u.convention,expanded:!1,registration:i.value,"show-control-panel":!1,"show-title":!1,"text-class":"pa-0 ma-0"},null,8,["card-class","convention","registration"])):o.value.MetaField===E(B).META_DATA_SOURCE_PAYMENT_STATUS?(n(),D(zo,{key:4,registration:i.value},null,8,["registration"])):o.value.MetaField===E(B).META_DATA_SOURCE_PAYMENTS?(n(),D(Ga,{key:5,registration:i.value,expanded:!1},null,8,["registration"])):o.value.MetaField===E(B).META_DATA_SOURCE_REGISTRATION_ACTIONS?(n(),D(K,{key:6,icon:"mdi:mdi-briefcase",variant:"flat",onClick:a[1]||(a[1]=s=>f(i.value))})):o.value.MetaField===E(B).META_DATA_SOURCE_SUBMISSION_STATUS||o.value.MetaField===E(B).META_DATA_SOURCE_ACCOMMODATION_FORM||o.value.MetaField===E(B).META_DATA_SOURCE_ADMIN_FORM||o.value.MetaField===E(B).META_DATA_SOURCE_DEALER_FORM||o.value.MetaField===E(B).META_DATA_SOURCE_BADGE_FORM||o.value.MetaField===E(B).META_DATA_SOURCE_REGISTRATION_FORM?(n(),D(Yo,{key:7,convention:u.convention,forms:u.forms,registration:i.value,onShowForm:A},null,8,["convention","forms","registration"])):o.value.MetaField===E(B).META_DATA_SOURCE_REGISTRATION_GROUP?(n(),D(Po,{key:8,registration:i.value},null,8,["registration"])):o.value.MetaField===E(B).META_DATA_SOURCE_REGISTRATION_REFERENCE?(n(),_(M,{key:9},[R(y(i.value.Reference),1)],64)):o.value.MetaField===E(B).META_DATA_SOURCE_SUBMISSION_DATE?(n(),D(Fo,{key:10,registration:i.value},null,8,["registration"])):o.value.MetaField===E(B).META_DATA_SOURCE_TAGS?(n(),D(Cn,{key:11,registration:i.value,modelValue:o.value,"onUpdate:modelValue":a[2]||(a[2]=s=>o.value=s)},null,8,["registration","modelValue"])):o.value.MetaField===E(B).META_DATA_SOURCE_CHECKIN_CONTROL?(n(),D(Gt,{key:12,convention:u.convention,"show-controls":!0,modelValue:i.value,"onUpdate:modelValue":a[3]||(a[3]=s=>i.value=s)},null,8,["convention","modelValue"])):o.value.MetaField===E(B).META_DATA_SOURCE_CHECKIN_STATUS?(n(),D(Gt,{key:13,convention:u.convention,"show-controls":!1,modelValue:i.value,"onUpdate:modelValue":a[4]||(a[4]=s=>i.value=s)},null,8,["convention","modelValue"])):(n(),_(M,{key:14},[R(" Unhandled Meta Item "+y(o.value),1)],64))}}),Yn=j({__name:"UserDataItem",props:J({accommodations:{},convention:{},forms:{},interests:{},itemClass:{},tickets:{},venues:{}},{modelValue:{required:!0},modelModifiers:{},registration:{required:!0},registrationModifiers:{}}),emits:["update:modelValue","update:registration"],setup(e){const c=te(e,"modelValue"),o=te(e,"registration"),i=pt(),r=ue(()=>i.GetProfileImageURL(o.value.UserUUID));return(f,A)=>c.value.UserField===E(ie).USER_DATA_SOURCE_TELEGRAM&&o.value.User.Handle?(n(),_(M,{key:0},[R(" @"+y(o.value.User.Handle),1)],64)):c.value.UserField===E(ie).USER_DATA_SOURCE_AVATAR?(n(),D(jt,{key:1,class:"rounded-circle",src:r.value,height:"32",width:"32"},null,8,["src"])):c.value.UserField===E(ie).USER_DATA_SOURCE_DATE_OF_BIRTH?(n(),_(M,{key:2},[R(y(E(Oe)(o.value.User.Additional.DOB,{withYear:!0,withDay:!1})),1)],64)):c.value.UserField===E(ie).USER_DATA_SOURCE_EMAIL?(n(),_(M,{key:3},[R(y(o.value.User.Additional.Email),1)],64)):c.value.UserField===E(ie).USER_DATA_SOURCE_FIRST_NAME?(n(),_(M,{key:4},[R(y(o.value.User.Additional.FirstName),1)],64)):c.value.UserField===E(ie).USER_DATA_SOURCE_LAST_NAME?(n(),_(M,{key:5},[R(y(o.value.User.Additional.LastName),1)],64)):(n(),_(M,{key:6},[R(" Unhandled User Field "+y(c.value),1)],64))}}),va=j({__name:"PanelItem",props:J({accommodations:{},convention:{},extras:{},forms:{},interests:{},itemClass:{},tickets:{},venues:{}},{modelValue:{required:!0},modelModifiers:{},registration:{required:!0},registrationModifiers:{}}),emits:J(["openActions","showForm"],["update:modelValue","update:registration"]),setup(e,{emit:c}){const o=te(e,"modelValue"),i=te(e,"registration"),r=c,f=u=>{r("openActions",u)},A=(u,a,s)=>{r("showForm",u,a,s)};return(u,a)=>o.value.SourceType===E(Le).LAYOUT_ITEM_SOURCE_FORM?(n(),D(No,{key:0,accommodations:u.accommodations,convention:u.convention,extras:u.extras,forms:u.forms,interests:u.interests,"item-class":u.itemClass,tickets:u.tickets,venues:u.venues,modelValue:o.value,"onUpdate:modelValue":a[0]||(a[0]=s=>o.value=s),registration:i.value,"onUpdate:registration":a[1]||(a[1]=s=>i.value=s)},null,8,["accommodations","convention","extras","forms","interests","item-class","tickets","venues","modelValue","registration"])):o.value.SourceType===E(Le).LAYOUT_ITEM_SOURCE_META?(n(),D($n,{key:1,accommodations:u.accommodations,convention:u.convention,forms:u.forms,interests:u.interests,"item-class":u.itemClass,tickets:u.tickets,venues:u.venues,modelValue:o.value,"onUpdate:modelValue":a[2]||(a[2]=s=>o.value=s),registration:i.value,"onUpdate:registration":a[3]||(a[3]=s=>i.value=s),onOpenActions:f,onShowForm:A},null,8,["accommodations","convention","forms","interests","item-class","tickets","venues","modelValue","registration"])):o.value.SourceType===E(Le).LAYOUT_ITEM_SOURCE_USER?(n(),D(Yn,{key:2,accommodations:u.accommodations,convention:u.convention,forms:u.forms,interests:u.interests,"item-class":u.itemClass,tickets:u.tickets,venues:u.venues,modelValue:o.value,"onUpdate:modelValue":a[4]||(a[4]=s=>o.value=s),registration:i.value,"onUpdate:registration":a[5]||(a[5]=s=>i.value=s)},null,8,["accommodations","convention","forms","interests","item-class","tickets","venues","modelValue","registration"])):b("",!0)}}),Gn=["onClick"],Bn=["onClick"],xn=j({__name:"PanelLayout",props:J({accommodations:{},convention:{},extras:{},forms:{},interests:{},tickets:{},venues:{}},{layout:{required:!0},layoutModifiers:{},modelValue:{required:!0},modelModifiers:{}}),emits:J(["openActions","showForm"],["update:layout","update:modelValue"]),setup(e,{emit:c}){const o=dl(),i=c,r=te(e,"layout"),f=te(e,"modelValue"),A=g({});r.value.Panels.forEach(U=>{A.value[U.LayoutPanelUUID]=!1});const u=U=>{i("openActions",U)},a=(U,v,m)=>{i("showForm",U,v,m)},s=U=>{switch(U.PanelStyle){case De.PANEL_STYLE_NAV_BOTTOM:return"bottom";case De.PANEL_STYLE_NAV_LEFT:return"left";case De.PANEL_STYLE_NAV_RIGHT:return"right";case De.PANEL_STYLE_NAV_TOP:return"top"}},d=(U,v=!1)=>{switch(U.PanelStyle){case De.PANEL_STYLE_NAV_BOTTOM:return v?"mdi:mdi-chevron-double-down":"mdi:mdi-chevron-double-up";case De.PANEL_STYLE_NAV_LEFT:return v?"mdi:mdi-chevron-double-left":"mdi:mdi-chevron-double-right";case De.PANEL_STYLE_NAV_RIGHT:return v?"mdi:mdi-chevron-double-right":"mdi:mdi-chevron-double-left";case De.PANEL_STYLE_NAV_TOP:return v?"mdi:mdi-chevron-double-up":"mdi:mdi-chevron-double-down"}};return(U,v)=>(n(),_(M,null,[(n(!0),_(M,null,W(r.value.Panels,m=>(n(),_(M,{key:m.LayoutPanelUUID},[s(m)!==void 0?(n(),D(Yl,{key:0,permanent:!0,location:s(m),border:E(o).smAndDown.value?1:0,rail:E(o).smAndDown.value&&!A.value[m.LayoutPanelUUID],"rail-width":"30",width:E(o).smAndDown.value?"100%":256},{default:l(()=>[E(o).smAndDown.value&&!A.value[m.LayoutPanelUUID]?(n(),_("h3",{key:0,class:Qe(`bg-secondary fill-height ${s(m)==="top"||s(m)==="bottom"?"px-3 text-right":"py-3 text-left"}`),style:{cursor:"pointer"},onClick:p=>A.value[m.LayoutPanelUUID]=!0},[t(Me,{icon:d(m,!1)},null,8,["icon"])],10,Gn)):(n(),_(M,{key:1},[w("h3",{class:"bg-secondary pa-3 d-flex",style:la(E(o).smAndDown.value?"cursor: pointer;":""),onClick:p=>A.value[m.LayoutPanelUUID]=!1},[R(y(m.Name)+" ",1),E(o).smAndDown.value?(n(),_(M,{key:0},[t(Fe),t(K,{icon:d(m,!0),variant:"plain",size:"sm"},null,8,["icon"])],64)):b("",!0)],12,Bn),t(we,{class:"bg-panel",style:{height:"calc(100vh - 116px)"}},{default:l(()=>[(n(!0),_(M,null,W(m.Items,(p,S)=>(n(),D(be,{key:p.LayoutItemUUID},{default:l(()=>[m.Items.length>1?(n(),D(Tt,{key:0,class:"font-weight-bold"},{default:l(()=>[R(y(p.Label),1)]),_:2},1024)):b("",!0),t(va,{accommodations:U.accommodations,convention:U.convention,extras:U.extras,forms:U.forms,interests:U.interests,"item-class":"bg-panel border-0",tickets:U.tickets,venues:U.venues,modelValue:m.Items[S],"onUpdate:modelValue":V=>m.Items[S]=V,registration:f.value,onOpenActions:u,onShowForm:a},null,8,["accommodations","convention","extras","forms","interests","tickets","venues","modelValue","onUpdate:modelValue","registration"])]),_:2},1024))),128))]),_:2},1024)],64))]),_:2},1032,["location","border","rail","width"])):b("",!0)],64))),128)),t(Gl,{class:"py-0"},{default:l(()=>[t(me,null,{default:l(()=>[t(Q,null,{default:l(()=>[(n(!0),_(M,null,W(r.value.Panels,m=>{var p,S,V,h,N,T;return n(),_(M,{key:m.LayoutPanelUUID},[m.PanelStyle===E(De).PANEL_STYLE_FLEX?(n(),D(O,{key:0,cols:((p=m.Meta.cols)==null?void 0:p.toString())||!1,xs:((S=m.Meta.cols_xs)==null?void 0:S.toString())||!1,sm:((V=m.Meta.cols_sm)==null?void 0:V.toString())||!1,md:((h=m.Meta.cols_md)==null?void 0:h.toString())||!1,lg:((N=m.Meta.cols_lg)==null?void 0:N.toString())||!1,xl:((T=m.Meta.cols_xl)==null?void 0:T.toString())||!1,class:"pa-0 pa-sm-2"},{default:l(()=>[t(me,{class:"bg-panel",style:la(E(o).smAndUp.value?"border-radius: 15px;":"")},{default:l(()=>[w("h3",null,y(m.Name),1),t(we,{class:"bg-panel"},{default:l(()=>[(n(!0),_(M,null,W(m.Items,(Y,se)=>(n(),D(be,{key:Y.LayoutItemUUID,class:"px-0"},{default:l(()=>[m.Items.length>1?(n(),D(Tt,{key:0,class:"font-weight-bold"},{default:l(()=>[R(y(Y.Label),1)]),_:2},1024)):b("",!0),t(va,{accommodations:U.accommodations,convention:U.convention,extras:U.extras,forms:U.forms,interests:U.interests,"item-class":"bg-panel border-0",tickets:U.tickets,venues:U.venues,modelValue:m.Items[se],"onUpdate:modelValue":z=>m.Items[se]=z,registration:f.value,"onUpdate:registration":v[0]||(v[0]=z=>f.value=z),onOpenActions:u,onShowForm:a},null,8,["accommodations","convention","extras","forms","interests","tickets","venues","modelValue","onUpdate:modelValue","registration"])]),_:2},1024))),128))]),_:2},1024)]),_:2},1032,["style"])]),_:2},1032,["cols","xs","sm","md","lg","xl"])):b("",!0)],64)}),128))]),_:1})]),_:1})]),_:1})],64))}}),Hn=j({__name:"DataTableItemPanel",props:J({accommodations:{},cardClass:{},convention:{},extras:{},forms:{},interests:{},tickets:{},venues:{},layouts:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:J(["openActions","showForm"],["update:modelValue"]),setup(e,{emit:c}){const o=g(),i=g(!1),r=s=>{o.value=s,i.value=!0},f=c,A=te(e,"modelValue"),u=s=>{f("openActions",s)},a=(s,d,U)=>{f("showForm",s,d,U)};return(s,d)=>(n(),_("div",null,[s.layouts?(n(),D(we,{key:0},{default:l(()=>[(n(!0),_(M,null,W(s.layouts,U=>(n(),D(be,{key:U.AdminLayoutUUID,class:"d-block pa-0 ma-0"},{default:l(()=>[t(Tt,{style:{"text-overflow":"inherit"},class:"overflow-visible text-wrap"},{default:l(()=>[t(K,{"prepend-icon":"mdi:mdi-page-layout-body",variant:"flat",onClick:v=>r(U)},{default:l(()=>[R(y(U.Name),1)]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024))),128))]),_:1})):b("",!0),i.value&&o.value?(n(),D(Pe,{key:1,modelValue:i.value,"onUpdate:modelValue":d[2]||(d[2]=U=>i.value=U),"hide-extension":!0,fullscreen:!0,title:`#${A.value.Reference} ${A.value.User.DisplayName} - ${o.value.Name} `,scrollable:!0,"card-class":"pa-0","card-style":"margin-bottom: -52px"},{default:l(()=>[t(xn,{accommodations:s.accommodations,convention:s.convention,extras:s.extras,forms:s.forms,interests:s.interests,tickets:s.tickets,venues:s.venues,layout:o.value,"onUpdate:layout":d[0]||(d[0]=U=>o.value=U),modelValue:A.value,"onUpdate:modelValue":d[1]||(d[1]=U=>A.value=U),onOpenActions:u,onShowForm:a},null,8,["accommodations","convention","extras","forms","interests","tickets","venues","layout","modelValue"])]),_:1},8,["modelValue","title"])):b("",!0)]))}}),qn={class:"text-grey-lighten-1"},Kn={key:0,class:"text-blue text-center"},jn={key:1,class:"text-red text-center"},zn={key:2,class:"text-orange text-center"},Qn={key:3,class:"text-orange text-center"},Jn={key:4,class:"text-orange text-center"},Xn={key:5,class:"text-orange text-center"},Wn={key:6,class:"text-green text-center"},Zn={key:0},ei={key:0},ti=w("strong",null,"Total:",-1),ai=j({__name:"RegListRow",props:J({header:{},accommodations:{},convention:{},extras:{},forms:{},interests:{},item:{},tickets:{},user:{},venues:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:J(["openActions","openPayments","openTags","reload","showForm","switchUser"],["update:modelValue"]),setup(e,{emit:c}){const o=c,i=te(e,"modelValue"),r=(a,s,d)=>{o("showForm",{registration:a,form:s,submission:d})},f=a=>{o("openActions",a)},A=a=>{o("switchUser",a)},u=a=>{const s=i.value.registration;return{ID:0,SubmissionUUID:ye(),FormID:a.ID,FormUUID:a.FormUUID,Form:a,UserID:s.UserID,UserUUID:s.UserUUID,RegistrationID:s.ID,RegistrationUUID:s.RegistrationUUID,Registration:s,Data:[],Status:Da.SUBMISSION_STATUS_NULL}};return(a,s)=>a.header.type==="ACCOMMODATION"&&a.accommodations.length>0&&a.item.raw[a.header.key]?(n(),D(Na,{key:0,value:a.item.raw[a.header.key].Data,accommodations:a.accommodations,convention:a.convention,forms:a.forms,tickets:a.tickets,venues:a.venues,registration:a.item.raw[a.header.key].Registration},null,8,["value","accommodations","convention","forms","tickets","venues","registration"])):a.header.type==="EXTRAS"&&a.extras.length>0?(n(),D(ba,{key:1,value:a.item.raw[a.header.key],extras:a.extras},null,8,["value","extras"])):a.header.type==="INTERESTS"&&a.interests.length>0?(n(),D(La,{key:2,value:a.item.raw[a.header.key],interests:a.interests},null,8,["value","interests"])):a.header.type==="TICKET"&&a.tickets.length>0?(n(),D(wa,{key:3,value:a.item.raw[a.header.key],tickets:a.tickets},null,8,["value","tickets"])):a.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_CHECKIN_STATUS"?(n(),D(Gt,{key:4,convention:a.convention,"show-controls":!1,modelValue:a.item.raw.registration,"onUpdate:modelValue":s[0]||(s[0]=d=>a.item.raw.registration=d)},null,8,["convention","modelValue"])):a.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_SUBMISSION_STATUS"||a.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_ACCOMMODATION_FORM"||a.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_ADMIN_FORM"||a.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_DEALER_FORM"||a.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_BADGE_FORM"||a.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_REGISTRATION_FORM"?(n(),_(M,{key:5},[w("ul",null,[(n(!0),_(M,null,W(a.forms.filter(d=>d.Type===E(_e).FORM_TYPE_ADMIN&&a.item.raw[a.header.key].findIndex(U=>U.Form.ID===d.ID)<0),d=>(n(),_("li",{key:d.Heading},[w("strong",qn,y(d.Heading),1),t(K,{class:"text-grey-lighten-1",icon:"mdi:mdi-form-select",title:"Edit Submitted Data",variant:"flat",onClick:U=>r(a.item.raw.registration,d,u(d))},null,8,["onClick"])]))),128))]),w("ul",null,[(n(!0),_(M,null,W(a.item.raw[a.header.key],d=>(n(),_("li",{key:d.Heading},[w("strong",null,[R(y(d.Heading),1),d.Form.Type!==E(_e).FORM_TYPE_ADMIN?(n(),_(M,{key:0},[R(": ")],64)):b("",!0)]),d.Form.Type!==E(_e).FORM_TYPE_ADMIN?(n(),_("span",{key:0,class:Qe(E(pa)(d.Submission.Status))},y(E(qt)(d.Submission.Status)),3)):b("",!0),t(K,{icon:"mdi:mdi-form-select",title:"Edit Submitted Data",variant:"flat",onClick:U=>r(d.Registration,d.Form,d.Submission)},null,8,["onClick"])]))),128))])],64)):a.header.type==="LAYOUT_ITEM_SOURCE_USER.USER_DATA_SOURCE_AVATAR"?(n(),D(jt,{key:6,class:"rounded-circle",src:a.item.raw[a.header.key],height:"32",width:"32"},null,8,["src"])):a.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_PAYMENT_STATUS"?(n(),_(M,{key:7},[a.item.raw[a.header.key]=="NOT_REQUIRED"?(n(),_("div",Kn,"No Payment Requested")):a.item.raw[a.header.key]=="MISSING_REQUIRED"?(n(),_("div",jn,"Partner Payment Not Requested")):a.item.raw[a.header.key]=="AWAITING_PARTNER"?(n(),_("div",zn,"Awaiting Partner Payment")):a.item.raw[a.header.key]=="ALL_REQUIRED"?(n(),_("div",Qn,"Awaiting Payments")):a.item.raw[a.header.key]=="REQUIRED"?(n(),_("div",Jn,"Awaiting Payment")):a.item.raw[a.header.key]=="ADDITIONAL_REQUIRED"?(n(),_("div",Xn,"Awaiting Additional Payments")):(n(),_("div",Wn,"Completed"))],64)):a.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_REGISTRATION_ACTIONS"?(n(),_(M,{key:8},[t(K,{icon:"mdi:mdi-briefcase",variant:"flat",onClick:s[1]||(s[1]=d=>f(a.item.raw[a.header.key]))}),E(eo)(a.user)?(n(),D(K,{key:0,icon:"mdi:mdi-account-switch-outline",variant:"flat",onClick:s[2]||(s[2]=d=>A(a.item.raw[a.header.key]))})):b("",!0)],64)):a.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_REGISTRATION_GROUP"?(n(),_(M,{key:9},[a.item.raw[a.header.key].length===1?(n(),_("em",Zn," Not in a group ")):(n(),_(M,{key:1},[w("ul",null,[(n(!0),_(M,null,W(a.item.raw[a.header.key],d=>(n(),_("li",{key:d.UUID,class:"ml-0"},[R(" #"+y(d.Reference)+" : "+y(d.Name)+" ",1),d.IsLeader?(n(),_("strong",ei,"(Leader)")):b("",!0)]))),128))]),ti,R(" "+y(a.item.raw[a.header.key].length),1)],64))],64)):a.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_DATA_LAYOUT"?(n(),_(M,{key:10},[i.value.registration?(n(),D(Hn,{key:0,accommodations:a.accommodations,convention:a.convention,extras:a.extras,forms:a.forms,interests:a.interests,tickets:a.tickets,venues:a.venues,layouts:a.item.raw[a.header.key].Layouts,modelValue:i.value.registration,"onUpdate:modelValue":s[3]||(s[3]=d=>i.value.registration=d),onOpenActions:f,onShowForm:r},null,8,["accommodations","convention","extras","forms","interests","tickets","venues","layouts","modelValue"])):b("",!0)],64)):(n(),_(M,{key:11},[R(y(a.item.raw[a.header.key]),1)],64))}}),fa=j({__name:"RegistrationActionTabs",props:J({alignTabs:{},class:{},fixedTabs:{type:Boolean},showArrows:{type:[String,Boolean]},tabs:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(e){const c=e,o=te(e,"modelValue");return(i,r)=>(n(),D(Ia,ft({modelValue:o.value,"onUpdate:modelValue":r[0]||(r[0]=f=>o.value=f)},c),{default:l(()=>[(n(!0),_(M,null,W(i.tabs,f=>(n(),D(Ca,{value:f.value,key:f.value},{default:l(()=>[R(y(f.label),1)]),_:2},1032,["value"]))),128))]),_:1},16,["modelValue"]))}}),li=(e=void 0,c)=>e===void 0?!1:gt(e,Et.GROUP_TYPE_CONVENTION,c.ConventionUUID,c).EditPaymentTransactions,Ct=e=>(Bt("data-v-861debd5"),e=e(),xt(),e),oi={class:"mb-4"},ni={class:"v-row"},ii={key:0,class:"v-col v-col-10 py-1 v-row mx-0 pl-0"},si={class:"v-col v-col-12 v-col-sm-4 v-col-md-3 font-weight-bold pb-0 pr-0"},ui={class:"v-col v-col-12 v-col-sm-8 v-col-md-9 font-italic pt-0 pt-sm-3 pb-sm-0 pl-sm-0"},ri={class:"v-col v-col-2 align-self-end text-right py-1 text-no-wrap"},di=Ct(()=>w("dt",{class:"v-col v-col-9 py-1 font-weight-bold totals"}," Total Charges ",-1)),mi={class:"v-col v-col-3 align-self-end text-right py-1 totals text-no-wrap"},ci=Ct(()=>w("dt",{class:"v-col v-col-9 py-1 font-weight-bold"}," Applied Total ",-1)),vi={class:"v-col v-col-3 align-self-end text-right py-1 text-no-wrap"},fi=Ct(()=>w("dt",{class:"v-col v-col-9 py-1 font-weight-bold"}," Currently Paid ",-1)),Ui={class:"v-col v-col-3 align-self-end text-right py-1 text-no-wrap"},Ai=Ct(()=>w("dt",{class:"v-col v-col-9 py-1 font-weight-bold totals"}," Balance ",-1)),Ti={class:"v-col v-col-3 align-self-end text-right py-1 totals text-no-wrap"},_i=j({__name:"PaymentActions",props:J({forms:{},title:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(e){const c=g(!1),o=g(),i=g([]),r=g(new Date().getTime()),f=g(!1),A=te(e,"modelValue"),u=g(Ee(A.value));fe(A,()=>{u.value=Ee(A.value)});const a=Ae();a.getConvention(A.value.ConventionUUID).then(v=>{v&&(f.value=li(Xe(),v))});const s=()=>{a.generateRegistrationCharges(A.value.RegistrationUUID,!1).then(v=>{v&&(i.value=v.PaymentTransactions,o.value=v.Registration,r.value=new Date().getTime())}).catch(()=>{})};s();const d=()=>{a.generateRegistrationCharges(A.value.RegistrationUUID,!0).then(v=>{v&&(i.value=v.PaymentTransactions,o.value=v.Registration,r.value=new Date().getTime())})},{totalCharges:U}=Ea();return(v,m)=>(n(),D($e,null,{default:l(()=>[t(ot,null,{default:l(()=>[t(We,null,{default:l(()=>[R(" Payments (#"+y(A.value.Reference)+" "+y(A.value.User.DisplayName)+") ",1)]),_:1})]),_:1}),t(Ze,null,{default:l(()=>[o.value?(n(),_(M,{key:0},[w("h3",oi,"#"+y(o.value.Reference)+" "+y(o.value.User.DisplayName),1),w("dl",ni,[(n(!0),_(M,null,W(i.value,p=>(n(),_(M,{key:p.PaymentTransactionUUID},[p.Type===E(Pt).PAYMENT_TRANSACTION_TYPE_CHARGE?(n(),_("dt",ii,[w("div",si,y(p.Description.split(":")[0])+": ",1),w("div",ui,y(p.Description.split(":")[1]),1)])):b("",!0),w("dd",ri," £"+y(p.Amount),1)],64))),128)),di,w("dd",mi," £"+y(E(U)(i.value)),1),ci,w("dd",vi," £"+y(o.value.Total),1),fi,w("dd",Ui," £"+y(o.value.Paid),1),Ai,w("dd",Ti," £"+y(o.value.Total-o.value.Paid),1)]),t(Q,{class:"flex-row-reverse"},{default:l(()=>[t(O,{class:"text-right"},{default:l(()=>[t(K,{color:"primary",onClick:d},{default:l(()=>[R("Apply Charges")]),_:1})]),_:1}),!c.value&&f.value?(n(),D(O,{key:0},{default:l(()=>[t(K,{color:"secondary",onClick:m[0]||(m[0]=p=>c.value=!0)},{default:l(()=>[R("Transaction Entry")]),_:1})]),_:1})):b("",!0)]),_:1})],64)):b("",!0),t(Ga,{"can-edit":f.value,registration:A.value,"show-editor":c.value,onCloseEditor:m[1]||(m[1]=p=>c.value=!1),updated:r.value,onChange:s},null,8,["can-edit","registration","show-editor","updated"])]),_:1})]),_:1}))}}),Ei=dt(_i,[["__scopeId","data-v-861debd5"]]),gi=j({__name:"RegistrationFormStatus",props:J({forms:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(e){const c=Ae(),o=te(e,"modelValue"),i=(r,f)=>{const A=o.value.Submissions.find(u=>u.SubmissionUUID==f);if(!A){r&&r("Submission not found");return}c.setSubmissionStatus(f,A.Status).then(u=>{u?(o.value.Submissions.forEach((a,s)=>{o.value.Submissions[s].Status=a.Status}),r&&r("Status Saved")):r&&r("Status not saved")}).catch(()=>{r&&r("Status not saved")})};return(r,f)=>(n(),D($e,null,{default:l(()=>[t(ot,null,{default:l(()=>[t(We,null,{default:l(()=>[R("Status (#"+y(o.value.Reference)+" "+y(o.value.User.DisplayName)+")",1)]),_:1})]),_:1}),t(Ze,null,{default:l(()=>[t(we,null,{default:l(()=>[(n(!0),_(M,null,W(o.value.Submissions,A=>(n(),D(be,{key:A.SubmissionUUID,class:"pa-0"},{default:l(()=>[t(Q,{class:"py-2 align-center"},{default:l(()=>[t(O,{cols:"9",sm:"10",md:"10",lg:"9"},{default:l(()=>{var u;return[t(ve,{modelValue:A.Status,"onUpdate:modelValue":a=>A.Status=a,items:E(na),"item-text":"title","item-value":"value",variant:"outlined","hide-details":"",label:((u=r.forms.find(a=>a.FormUUID==A.FormUUID))==null?void 0:u.Name)||""},{selection:l(()=>[t(Me,{class:"mr-4 d-none d-sm-inline"},{default:l(()=>{var a;return[R(y((a=E(na).find(s=>s.value===A.Status))==null?void 0:a.icon),1)]}),_:2},1024),R(" "+y(E(qt)(A.Status)),1)]),item:l(({item:a,props:{onClick:s}})=>[t(be,{title:a.title,"prepend-icon":a.raw.icon,onClick:s},null,8,["title","prepend-icon","onClick"])]),_:2},1032,["modelValue","onUpdate:modelValue","items","label"])]}),_:2},1024),t(O,{cols:"3",sm:"2",md:"2",lg:"1"},{default:l(()=>[t(rt,{class:"d-none d-sm-inline-flex",title:"Save","prepend-icon":"mdi:mdi-content-save",color:"warning",onClick:u=>i(u.callback,A.SubmissionUUID)},null,8,["onClick"]),t(rt,{class:"d-sm-none",size:"35",icon:"mdi:mdi-content-save",color:"warning",onClick:u=>i(u.callback,A.SubmissionUUID)},null,8,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1}))}}),pi=e=>(Bt("data-v-a4024c39"),e=e(),xt(),e),Di=pi(()=>w("p",null,"Any tags controlled through registration form fields will be reset when the applicable form is saved. If you don't know what you're doing here, don't touch!",-1)),yi={class:"mb-4"},Si=j({__name:"RegistrationTags",props:J({title:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(e){const c=Ae(),o=te(e,"modelValue"),i=g(Ee(o.value)),r=g(!1),f=g(i.value.Tags);fe(o,()=>{i.value=Ee(o.value)});const A=({callback:u})=>{const a=[],s=[];i.value.Tags.forEach(d=>{f.value.find(v=>v.TagUUID===d.TagUUID)||a.push(d.TagUUID)}),f.value.forEach(d=>{i.value.Tags.find(v=>d.TagUUID===v.TagUUID)||s.push(d.TagUUID)}),c.updateRegistrationTags(a,s,i.value.RegistrationUUID).then(d=>{d?u&&(u("Tags Saved"),o.value.Tags=d.Tags):u&&u("Error Saving Tags")}).catch(()=>{u&&u("Error Saving Tags")})};return(u,a)=>(n(),D($e,null,{default:l(()=>[t(ot,null,{default:l(()=>[t(We,null,{default:l(()=>[R("Tags (#"+y(i.value.Reference)+" "+y(i.value.User.DisplayName)+")",1)]),_:1})]),_:1}),t(Ze,null,{default:l(()=>[t(xl,{class:"my-4"},{default:l(()=>[t(Hl,null,{default:l(()=>[R("Caution")]),_:1}),Di]),_:1}),w("h3",yi,"#"+y(i.value.Reference)+" "+y(i.value.User.DisplayName),1),t(Ra,{modelValue:i.value.Tags,"onUpdate:modelValue":a[0]||(a[0]=s=>i.value.Tags=s),convention:i.value.ConventionUUID,"show-key":!0,chips:!0,"show-uuid":r.value},null,8,["modelValue","convention","show-uuid"])]),_:1}),t(Kt,{class:"px-4 align-start"},{default:l(()=>[t(wt,{label:"Show UUID",modelValue:r.value,"onUpdate:modelValue":a[1]||(a[1]=s=>r.value=s)},null,8,["modelValue"]),t(rt,{onClick:A,variant:"flat"})]),_:1})]),_:1}))}}),Ii=dt(Si,[["__scopeId","data-v-a4024c39"]]),Ua=j({__name:"RegistrationActionWindows",props:J({accommodations:{},convention:{},extras:{},forms:{},interests:{},registration:{},tickets:{},venues:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:J(["update:registration"],["update:modelValue"]),setup(e,{emit:c}){const o=e,i=te(e,"modelValue"),f=mt(o,c,void 0,void 0,"registration");return(A,u)=>(n(),D(Va,{modelValue:i.value,"onUpdate:modelValue":u[3]||(u[3]=a=>i.value=a)},{default:l(()=>[t(ze,{value:"badges"},{default:l(()=>[i.value=="badges"?(n(),D(me,{key:0,class:"pa-0 mx-0",fluid:!0},{default:l(()=>[t(Qt,{convention:A.convention,registration:E(f)},null,8,["convention","registration"])]),_:1})):b("",!0)]),_:1}),t(ze,{value:"emails"},{default:l(()=>[i.value=="emails"?(n(),D(me,{key:0,class:"pa-0 mx-0",fluid:!0},{default:l(()=>[t($a,{registration:E(f)},null,8,["registration"])]),_:1})):b("",!0)]),_:1}),t(ze,{value:"notes"},{default:l(()=>[i.value=="notes"?(n(),D(me,{key:0,class:"pa-0 mx-0",fluid:!0},{default:l(()=>[t(Ya,{convention:A.convention,expanded:!1,registration:E(f)},null,8,["convention","registration"])]),_:1})):b("",!0)]),_:1}),t(ze,{value:"payments"},{default:l(()=>[i.value=="payments"?(n(),D(me,{key:0,class:"pa-0 mx-0",fluid:!0},{default:l(()=>[t(Ei,{modelValue:E(f),"onUpdate:modelValue":u[0]||(u[0]=a=>ut(f)?f.value=a:null),forms:A.forms,title:"Registration Payments"},null,8,["modelValue","forms"])]),_:1})):b("",!0)]),_:1}),t(ze,{value:"status"},{default:l(()=>[i.value=="status"?(n(),D(me,{key:0,class:"pa-0 mx-0",fluid:!0},{default:l(()=>[t(gi,{modelValue:E(f),"onUpdate:modelValue":u[1]||(u[1]=a=>ut(f)?f.value=a:null),forms:A.forms},null,8,["modelValue","forms"])]),_:1})):b("",!0)]),_:1}),t(ze,{value:"tags"},{default:l(()=>[i.value=="tags"?(n(),D(me,{key:0,class:"pa-0 mx-0",fluid:!0},{default:l(()=>[t(Ii,{modelValue:E(f),"onUpdate:modelValue":u[2]||(u[2]=a=>ut(f)?f.value=a:null),title:"Registration Tags"},null,8,["modelValue"])]),_:1})):b("",!0)]),_:1})]),_:1},8,["modelValue"]))}}),Ci=(e,c)=>e===void 0?!1:gt(e,Et.GROUP_TYPE_CONVENTION,c.ConventionUUID,c).ViewPaymentTransactions,Ri={key:0},Vi={key:1},Aa=j({__name:"RegistrationActions",props:J({accommodations:{},convention:{},extras:{},forms:{},interests:{},registration:{},tickets:{},title:{},useDialog:{type:Boolean},venues:{}},{modelValue:{type:Boolean,required:!0},modelModifiers:{}}),emits:J(["update:registration"],["update:modelValue"]),setup(e,{emit:c}){const o=e,i=te(e,"modelValue"),f=mt(o,c,void 0,void 0,"registration"),A=g("notes"),u=Xe(),a=[{label:"Badge",value:"badges"},{label:"Emails",value:"emails"},{label:"Notes",value:"notes"},{label:"Status",value:"status"},{label:"Tags",value:"tags"}];return Ci(u,o.convention)&&a.splice(2,0,{label:"Payments",value:"payments"}),(s,d)=>s.useDialog?(n(),_("div",Ri,[t(Pe,{modelValue:i.value,"onUpdate:modelValue":d[3]||(d[3]=U=>i.value=U),title:s.title,"show-close-action":!0,color:"primary","close-action-label":"Close",persistent:!0,"retain-focus":!1,scrollable:!0,fullscreen:"","card-class":"ma-0 pa-0"},{extension:l(()=>[t(fa,{modelValue:A.value,"onUpdate:modelValue":d[0]||(d[0]=U=>A.value=U),tabs:a,"show-arrows":!0},null,8,["modelValue"])]),default:l(()=>[t(Ua,{modelValue:A.value,"onUpdate:modelValue":d[1]||(d[1]=U=>A.value=U),registration:E(f),"onUpdate:registration":d[2]||(d[2]=U=>ut(f)?f.value=U:null),accommodations:s.accommodations,convention:s.convention,extras:s.extras,forms:s.forms,interests:s.interests,tabs:a,tickets:s.tickets,venues:s.venues},null,8,["modelValue","registration","accommodations","convention","extras","forms","interests","tickets","venues"])]),_:1},8,["modelValue","title"])])):(n(),_("div",Vi,[t(fa,{modelValue:A.value,"onUpdate:modelValue":d[4]||(d[4]=U=>A.value=U),tabs:a,"show-arrows":!0},null,8,["modelValue"]),t(Ua,{modelValue:A.value,"onUpdate:modelValue":d[5]||(d[5]=U=>A.value=U),registration:E(f),"onUpdate:registration":d[6]||(d[6]=U=>ut(f)?f.value=U:null),accommodations:s.accommodations,convention:s.convention,extras:s.extras,forms:s.forms,interests:s.interests,tabs:a,tickets:s.tickets,venues:s.venues},null,8,["modelValue","registration","accommodations","convention","extras","forms","interests","tickets","venues"])]))}}),Oi=(e,c=500,o=!1)=>{let i;return(...r)=>{const A=function(){i=void 0,o||e.apply(void 0,r)},u=o&&!i;clearTimeout(i),i=setTimeout(A,c),u&&e.apply(void 0,r)}},Ba=(e,c)=>{e.forEach(o=>{o.Items.forEach(i=>{(i.SectionField==null||i.SectionField.Field==null)&&c.find(r=>{r.Sections.find(f=>{if(f.Fields){const A=f.Fields.find(u=>u.SectionFieldUUID===i.SectionFieldUUID);if(A)return i.SectionField=A,!0}})})})})},Mi=w("h4",null,"Grid Size (Max 12)",-1),hi={key:0,class:"text-warning text-right pl-1"},ki=j({__name:"EditAdminLayout",props:J({convention:{},layouts:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:J(["change","delete"],["update:modelValue"]),setup(e,{emit:c}){const o=te(e,"modelValue"),i=g([]),r=Ae(),f=c,A=g(Object.assign({},...e.layouts.map(S=>S.Panels.map(V=>V.Items.map(h=>{if(!h.Meta)return{};const N={};return Object.entries(h.Meta).forEach(T=>{Array.isArray(T[1])?(N[`${h.LayoutItemUUID}.${T[0]}`]=[],T[1].forEach(Y=>{N[`${h.LayoutItemUUID}.${T[0]}`].push(Y.toString())})):T[1]!==void 0&&T[1]!==null&&(N[`${h.LayoutItemUUID}.${T[0]}`]=[T[1].toString()])}),N}))).flat(2))),u=g(`
Are you sure you wish to delete this layout? All panels relating to it will be
removed and can not be recovered. This action can not be undone once saved.
You will have to create a new layout.
`),a=g(!1),s=g([]);r.getConventionTags(e.convention.ConventionUUID).then(S=>{S&&(s.value=S)}).catch(()=>{});const d=()=>({ID:0,LayoutPanelUUID:ye(),AdminLayoutID:o.value.ID,AdminLayoutUUID:o.value.AdminLayoutUUID,Name:"",Order:o.value.Panels.length+1,Items:[],PanelStyle:De.PANEL_STYLE_FLEX,RequiredFormType:_e.FORM_TYPE_NIL,RequiredGroupMemberships:[],RequiredRegistrationTags:[],Meta:{}}),U=S=>()=>({ID:0,LayoutItemUUID:ye(),LayoutPanelID:S.ID,LayoutPanelUUID:S.LayoutPanelUUID,Label:"",SourceType:Le.LAYOUT_ITEM_SOURCE_FORM,SectionFieldID:void 0,SectionFieldUUID:void 0,SectionField:void 0,MetaField:void 0,UserField:void 0,Align:"",Order:S.Items.length+1,DefaultSort:!1,Meta:{}}),v=(S,V)=>{S.Meta[V]=A.value[`${S.LayoutItemUUID}.${V}`]},m=S=>{const V=i.value.find(h=>h.value===S.SectionFieldUUID);V&&(S.SectionFieldID=V.object.ID,S.SectionField=V.object)};r.getConventionForms(o.value.ConventionUUID).then(S=>{S&&(S.forEach(V=>V.Sections.forEach(h=>h.Fields&&i.value.push(...h.Fields.map(N=>{var Y;return{title:`${V.Name} - ${h.Name} - ${(Y=N.Field)==null?void 0:Y.Name}`,value:N.SectionFieldUUID,object:N}})))),i.value.sort(Ul("title")),Ba(o.value.Panels,S))});const p=ue(()=>{switch(o.value.Type){case Ne.ADMIN_LAYOUT_PANELS:return"Panels";case Ne.ADMIN_LAYOUT_TABLE:return"Tabs"}return"Unknown"});return fe(o,()=>{f("change")},{deep:!0}),(S,V)=>(n(),D(me,{class:"px-0 mx-0",fluid:!0},{default:l(()=>[t(Q,null,{default:l(()=>[t(O,{cols:"12",sm:"6"},{default:l(()=>[t(oe,{modelValue:o.value.Name,"onUpdate:modelValue":V[0]||(V[0]=h=>o.value.Name=h),label:"Name",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),t(O,{cols:"12",sm:"6"},{default:l(()=>[t(ve,{modelValue:o.value.Type,"onUpdate:modelValue":V[1]||(V[1]=h=>o.value.Type=h),label:"Layout Type",items:E(zl),"item-title":"title","item-value":"value",variant:"outlined","hide-details":""},null,8,["modelValue","items"])]),_:1})]),_:1}),t(Q,null,{default:l(()=>[t(O,null,{default:l(()=>[t(Ft,{modelValue:o.value.Panels,"onUpdate:modelValue":V[2]||(V[2]=h=>o.value.Panels=h),"new-item":d,closeable:!1,title:p.value,label:"Name","slot-name-prefix":"panel"},Je({_:2},[W(o.value.Panels,(h,N)=>({name:`panel_${N}`,fn:l(()=>[t(me,{class:"px-0 mx-0",fluid:!0},{default:l(()=>[t(Q,null,{default:l(()=>[t(O,{cols:"12",sm:"6"},{default:l(()=>[t(oe,{modelValue:h.Name,"onUpdate:modelValue":T=>h.Name=T,label:"Name",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),o.value.Type===E(Ne).ADMIN_LAYOUT_PANELS?(n(),D(O,{key:0,cols:"12",sm:"6"},{default:l(()=>[t(ve,{modelValue:h.PanelStyle,"onUpdate:modelValue":T=>h.PanelStyle=T,items:E(Xl),clearable:!0,label:"Panel Style",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"])]),_:2},1024)):b("",!0),t(O,{cols:"12",sm:"6"},{default:l(()=>[t(ve,{modelValue:h.RequiredFormType,"onUpdate:modelValue":T=>h.RequiredFormType=T,items:E(Tl),clearable:!0,label:"Required Form",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"])]),_:2},1024),t(O,{cols:"12",sm:"6"},{default:l(()=>[t(Sa,{label:"Required Groups",variant:"outlined",modelValue:h.RequiredGroupMemberships,"onUpdate:modelValue":T=>h.RequiredGroupMemberships=T,convention:o.value.ConventionUUID,chips:"",clearable:"",hint:"Groups that a user must be in to see this panel. (Any one)"},null,8,["modelValue","onUpdate:modelValue","convention"])]),_:2},1024),t(O,{cols:"12",sm:"6"},{default:l(()=>[t(Ra,{label:"Registration Tags",variant:"outlined",modelValue:h.RequiredRegistrationTags,"onUpdate:modelValue":T=>h.RequiredRegistrationTags=T,convention:o.value.ConventionUUID,chips:"",clearable:"",hint:"Tags that a registration must have to appear in results. (Any one)"},null,8,["modelValue","onUpdate:modelValue","convention"])]),_:2},1024)]),_:2},1024),o.value.Type===E(Ne).ADMIN_LAYOUT_PANELS&&h.PanelStyle===E(De).PANEL_STYLE_FLEX?(n(),D(Q,{key:0},{default:l(()=>[t(O,{cols:"12",class:"py-0 my-0"},{default:l(()=>[Mi]),_:1}),t(O,{cols:"6",sm:"4",lg:"2"},{default:l(()=>[t(oe,{modelValue:h.Meta.cols,"onUpdate:modelValue":T=>h.Meta.cols=T,modelModifiers:{number:!0},clearable:!0,"hide-details":"",label:"Default",type:"number",min:"1",max:"12"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),t(O,{cols:"6",sm:"4",lg:"2"},{default:l(()=>[t(oe,{modelValue:h.Meta.cols_xs,"onUpdate:modelValue":T=>h.Meta.cols_xs=T,modelModifiers:{number:!0},clearable:!0,"hide-details":"",label:"XS",type:"number",min:"1",max:"12"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),t(O,{cols:"6",sm:"4",lg:"2"},{default:l(()=>[t(oe,{modelValue:h.Meta.cols_sm,"onUpdate:modelValue":T=>h.Meta.cols_sm=T,modelModifiers:{number:!0},clearable:!0,"hide-details":"",label:"SM",type:"number",min:"1",max:"12"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),t(O,{cols:"6",sm:"4",lg:"2"},{default:l(()=>[t(oe,{modelValue:h.Meta.cols_md,"onUpdate:modelValue":T=>h.Meta.cols_md=T,modelModifiers:{number:!0},clearable:!0,"hide-details":"",label:"MD",type:"number",min:"1",max:"12"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),t(O,{cols:"6",sm:"4",lg:"2"},{default:l(()=>[t(oe,{modelValue:h.Meta.cols_lg,"onUpdate:modelValue":T=>h.Meta.cols_lg=T,modelModifiers:{number:!0},clearable:!0,"hide-details":"",label:"LG",type:"number",min:"1",max:"12"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),t(O,{cols:"6",sm:"4",lg:"2"},{default:l(()=>[t(oe,{modelValue:h.Meta.cols_xl,"onUpdate:modelValue":T=>h.Meta.cols_xl=T,modelModifiers:{number:!0},clearable:!0,"hide-details":"",label:"XL",type:"number",min:"1",max:"12"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)):b("",!0)]),_:2},1024),t(Ft,{modelValue:h.Items,"onUpdate:modelValue":T=>h.Items=T,"new-item":U(h),closeable:!1,title:"Items",label:"Label","slot-name-prefix":"item"},Je({_:2},[W(h.Items,(T,Y)=>({name:`item_${Y}`,fn:l(()=>[t(me,{class:"px-0 mx-0",fluid:!0},{default:l(()=>{var se,z;return[t(Q,null,{default:l(()=>[t(O,{cols:"12",sm:"6"},{default:l(()=>[t(oe,{modelValue:T.Label,"onUpdate:modelValue":x=>T.Label=x,label:"Name",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024),t(Q,null,{default:l(()=>[t(O,{cols:"12",sm:"6"},{default:l(()=>[t(ve,{modelValue:T.SourceType,"onUpdate:modelValue":x=>T.SourceType=x,label:"Source Type",items:E(Ql),"item-title":"title","item-value":"value",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"])]),_:2},1024),t(O,{cols:"12",sm:"6"},{default:l(()=>[T.SourceType==="LAYOUT_ITEM_SOURCE_FORM"?(n(),D(ve,{key:0,modelValue:T.SectionFieldUUID,"onUpdate:modelValue":x=>T.SectionFieldUUID=x,label:"Form Data",items:i.value,"item-title":"title","item-value":"value",variant:"outlined","hide-details":"",onBlur:x=>m(T)},null,8,["modelValue","onUpdate:modelValue","items","onBlur"])):T.SourceType==="LAYOUT_ITEM_SOURCE_META"?(n(),D(ve,{key:1,modelValue:T.MetaField,"onUpdate:modelValue":x=>T.MetaField=x,label:"Miscellaneous Data",items:E(Jl),"item-title":"title","item-value":"value",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"])):T.SourceType==="LAYOUT_ITEM_SOURCE_USER"?(n(),D(ve,{key:2,modelValue:T.UserField,"onUpdate:modelValue":x=>T.UserField=x,label:"User Profile Data",items:E(Wl),"item-title":"title","item-value":"value",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"])):b("",!0)]),_:2},1024)]),_:2},1024),S.layouts&&T.SourceType==="LAYOUT_ITEM_SOURCE_FORM"&&((z=(se=T.SectionField)==null?void 0:se.Field)==null?void 0:z.Type)===E(_a).TEXT?(n(),D(Q,{key:0},{default:l(()=>[t(O,{cols:"12",xs:"6",sm:"6",lg:"3"},{default:l(()=>[t(wt,{modelValue:T.Meta.DirectEdit,"onUpdate:modelValue":x=>T.Meta.DirectEdit=x,label:"Direct Edit","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),t(O,{cols:"12",xs:"6",sm:"6",lg:"3"},{default:l(()=>[t(ve,{modelValue:T.Meta.DirectEditPermission,"onUpdate:modelValue":x=>T.Meta.DirectEditPermission=x,label:"Minimum Permission Required",items:["View","Edit"],"hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)):b("",!0),S.layouts&&T.SourceType==="LAYOUT_ITEM_SOURCE_META"&&T.MetaField===E(B).META_DATA_SOURCE_DATA_LAYOUT?(n(),D(Q,{key:1},{default:l(()=>[t(O,{cols:"6",sm:"4",lg:"2"},{default:l(()=>[t(ve,{modelValue:A.value[`${T.LayoutItemUUID}.LayoutUUID`],"onUpdate:modelValue":[x=>A.value[`${T.LayoutItemUUID}.LayoutUUID`]=x,x=>v(T,"LayoutUUID")],clearable:!0,items:S.layouts.filter(x=>x.Type===E(Ne).ADMIN_LAYOUT_PANELS)||[],multiple:!0,label:"Data Display","item-title":"Name","item-value":"AdminLayoutUUID",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"])]),_:2},1024)]),_:2},1024)):b("",!0),S.layouts&&T.SourceType==="LAYOUT_ITEM_SOURCE_META"&&T.MetaField===E(B).META_DATA_SOURCE_TAGS?(n(),D(Q,{key:2},{default:l(()=>[t(O,{cols:"6",sm:"4",lg:"2"},{default:l(()=>[t(ve,{modelValue:A.value[`${T.LayoutItemUUID}.Tags`],"onUpdate:modelValue":[x=>A.value[`${T.LayoutItemUUID}.Tags`]=x,x=>v(T,"Tags")],clearable:!0,items:s.value||[],multiple:!0,label:"Tags to Display","item-title":"Title","item-value":"TagUUID",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"]),!A.value[T.LayoutItemUUID]||A.value[T.LayoutItemUUID].length===0?(n(),_("small",hi," Will show all tags ")):b("",!0)]),_:2},1024)]),_:2},1024)):b("",!0),o.value.Type===E(Ne).ADMIN_LAYOUT_TABLE&&(T.SourceType!==E(Le).LAYOUT_ITEM_SOURCE_META||T.MetaField!==E(B).META_DATA_SOURCE_DATA_LAYOUT)?(n(),D(Q,{key:3},{default:l(()=>[t(O,null,{default:l(()=>[t(wt,{modelValue:T.DefaultSort,"onUpdate:modelValue":x=>T.DefaultSort=x,label:"Default Sort","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)):b("",!0)]}),_:2},1024)])}))]),1032,["modelValue","onUpdate:modelValue","new-item"])])}))]),1032,["modelValue","title"])]),_:1})]),_:1}),t(Q,null,{default:l(()=>[t(O,null,{default:l(()=>[t(K,{onClick:V[3]||(V[3]=h=>a.value=!0),"prepend-icon":"mdi:mdi-delete",color:"red-darken-4"},{default:l(()=>[R("Delete Layout")]),_:1})]),_:1})]),_:1}),a.value?(n(),D(Oa,{key:0,modelValue:a.value,"onUpdate:modelValue":V[4]||(V[4]=h=>a.value=h),message:u.value,title:"Delete Layout",subtitle:"Removes this layout and all it's panels",onDelete:V[5]||(V[5]=h=>f("delete"))},null,8,["modelValue","message"])):b("",!0)]),_:1}))}}),Ni=j({__name:"EditAdminLayouts",props:J({title:{},convention:{}},{modelValue:{type:Boolean,required:!0},modelModifiers:{}}),emits:J(["save"],["update:modelValue"]),setup(e,{emit:c}){const o=te(e,"modelValue"),i=c,r=g([]),f=g([]),A=g([]),u=Ae(),a=()=>({ID:0,AdminLayoutUUID:ye(),ConventionID:e.convention.ID,ConventionUUID:e.convention.ConventionUUID,Name:"New Layout",Type:Ne.ADMIN_LAYOUT_PANELS,Panels:[]}),s=()=>{let U=!1;[...new Set(A.value)].forEach(m=>{const p=r.value.findIndex(S=>S.AdminLayoutUUID===m);p<0||p>=r.value.length||(u.saveAdminLayout(r.value[p]).then(S=>{S&&r.value.splice(p,1,S)}).catch(()=>{}),U=!0)}),f.value.forEach(m=>{u.deleteAdminLayout(m).catch(()=>{})}),f.value=[],A.value=[],U&&i("save")},d=U=>{const v=r.value.findIndex(m=>m.AdminLayoutUUID===U.AdminLayoutUUID);v<0||v>=r.value.length||(r.value[v].ID>0&&f.value.push(U.AdminLayoutUUID),r.value.splice(v,1))};return u.getConventionAdminLayouts(e.convention.ConventionUUID).then(U=>{U&&(r.value=U)}).catch(()=>[]),(U,v)=>(n(),D(_t,{modelValue:o.value,"onUpdate:modelValue":v[2]||(v[2]=m=>o.value=m),scrollable:!0,"retain-focus":!0,persistent:!0,fullscreen:!0},{default:l(()=>[t(Ft,{modelValue:r.value,"onUpdate:modelValue":v[0]||(v[0]=m=>r.value=m),"new-item":a,closeable:!0,"show-delete":!1,"show-save":!0,"has-order":!1,title:U.title,label:"Name","slot-name-prefix":"panel",onClose:v[1]||(v[1]=m=>o.value=!1),onSave:s},Je({_:2},[W(r.value,(m,p)=>({name:`panel_${p}`,fn:l(()=>[t(me,{class:"px-0 mx-0",fluid:!0},{default:l(()=>[t(Q,null,{default:l(()=>[t(O,{cols:"12"},{default:l(()=>[t(ki,{modelValue:r.value[p],"onUpdate:modelValue":S=>r.value[p]=S,convention:U.convention,layouts:r.value,onChange:S=>A.value.push(m.AdminLayoutUUID),onDelete:S=>d(m)},null,8,["modelValue","onUpdate:modelValue","convention","layouts","onChange","onDelete"])]),_:2},1024)]),_:2},1024)]),_:2},1024)])}))]),1032,["modelValue","title"])]),_:1},8,["modelValue"]))}}),bi=["colspan"],Li={style:{opacity:"var(--v-medium-emphasis-opacity)"}},ys=j({__name:"RegistrationsView",emits:["pageTitle"],setup(e,{emit:c}){var Zt;const o=pt();c("pageTitle","Registration Manager");const r=ml(),f=cl(),A=g(!0);let u=((Zt=r.params.convention)==null?void 0:Zt.toString())||"";const a=g({ID:0,ConventionUUID:ye(),OrganisationID:0,OrganisationUUID:Nt,Name:"New Convention",Description:"",DetailLink:"",Logo:"",Slug:"",Accommodation:[],Tickets:[],Extras:[],Interests:[],Visible:!1}),s=Ae(),d=vl.getInstance(),U=g([]),v=g({ID:0,AdminLayoutUUID:ye(),ConventionID:a.value.ID,ConventionUUID:a.value.ConventionUUID,Name:"Registration Table",Type:Ne.ADMIN_LAYOUT_TABLE,Panels:[]}),m=g([]),p=g([]),S=g([]),V=g([]),h=g([]),N=g([]),T=g(1),Y=g(10),se=g([]),z=g(0),x=g(!1),le=g(""),G=g(""),$=g(""),P=g(""),k=g({FieldUUID:"591c9bca-c78c-4e97-8aef-bc596ef472fb",Value:""}),Z=g({FieldUUID:"50189b21-6c55-4c99-a38f-7740a01ec4a4",Value:""}),ce=g({FieldUUID:"1523ef15-f2c3-46b9-a687-dcd7bc2c0a50",Value:""}),ne=g({FieldUUID:"926d43c6-a743-4ab7-bef2-060d762d37a9",Value:""}),ge=g(new Map([["591c9bca-c78c-4e97-8aef-bc596ef472fb",k.value],["50189b21-6c55-4c99-a38f-7740a01ec4a4",Z.value],["1523ef15-f2c3-46b9-a687-dcd7bc2c0a50",ce.value],["926d43c6-a743-4ab7-bef2-060d762d37a9",ne.value]])),et=g(""),tt=g(""),nt=g([]),Ce=g([]),Ye=g([]),Ge=g([]),Be=g([]),xe=g([]),pe=g(0),Se=g(),He=g(!1),Jt=g(!1),xa=g(!1),ct=g(),Xt=g(),Rt=g(),at=g(!1),Ha=Xe(),Ue=Oi(()=>{G.value=Date.now().toString()});fe(le,C=>{const I=N.value.find(F=>F.uuid===C);if(I){const F=I.headers.find(L=>L.defaultSort===!0);F&&(se.value=[{key:F.key,order:"asc"}],nt.value=[{key:F.key,order:"asc"}])}}),fe(pe,C=>{C===8&&Wt()}),fe(et,()=>{Ue()}),fe(tt,()=>{Ue()});const qa=()=>{m.value=[],S.value=[],V.value=[],N.value=[];try{s.getConventionAdminLayoutByName(a.value.ConventionUUID,"Registration Table").then(C=>{pe.value+=1,C?v.value=C:(v.value.ConventionID=a.value.ID,v.value.ConventionUUID=a.value.ConventionUUID)})}catch{v.value.ConventionID=a.value.ID,v.value.ConventionUUID=a.value.ConventionUUID}try{s.getConventionAdminLayouts(a.value.ConventionUUID).then(C=>{pe.value+=1,C&&(S.value=C)})}catch{}try{s.getConventionForms(a.value.ConventionUUID).then(C=>{pe.value+=1,C&&(m.value=C)})}catch{}try{s.getConventionAccommodation(a.value.ConventionUUID).then(C=>{pe.value+=1,C&&(Ce.value=C)})}catch{}try{s.getConventionVenues(a.value.ConventionUUID).then(C=>{pe.value+=1,C&&(xe.value=C)})}catch{}try{s.getConventionExtras(a.value.ConventionUUID).then(C=>{pe.value+=1,C&&(Ye.value=C)})}catch{}try{s.getConventionInterests(a.value.ConventionUUID).then(C=>{pe.value+=1,C&&(Ge.value=C)})}catch{}try{s.getConventionTickets(a.value.ConventionUUID).then(C=>{pe.value+=1,C&&(Be.value=C)})}catch{}try{s.getConventionGroups(a.value.ConventionUUID).then(C=>{C&&(p.value=C.sort((I,F)=>I.Name.localeCompare(F.Name)))})}catch{}try{s.getConventionTags(a.value.ConventionUUID).then(C=>{C&&(h.value=C.sort((I,F)=>I.Title.localeCompare(F.Title)).map(I=>(I.Title=`${I.Title} [${I.Key}]`,I)))})}catch{}},Vt=({page:C,itemsPerPage:I,sortBy:F})=>{A.value=!0,T.value=C,se.value=F;const L=N.value.find(de=>de.uuid==le.value),Te=L==null?void 0:L.layout.Items;let re="",it="";if(F&&Te&&F.length>=1){const de=Te.find(Mt=>Mt.LayoutItemUUID==F[0].key);switch(it=F[0].order||"asc",de==null?void 0:de.MetaField){case B.META_DATA_SOURCE_ACCOMMODATION_FORM:re="submission.status";break;case B.META_DATA_SOURCE_BADGE_FORM:re="submission.status";break;case B.META_DATA_SOURCE_DEALER_FORM:re="submission.status";break;case B.META_DATA_SOURCE_REGISTRATION_FORM:re="submission.status";break;case B.META_DATA_SOURCE_REGISTRATION_REFERENCE:re="reference";break;case B.META_DATA_SOURCE_SUBMISSION_DATE:re="created";break;case B.META_DATA_SOURCE_SUBMISSION_STATUS:re="submission.status";break}switch(de==null?void 0:de.UserField){case ie.USER_DATA_SOURCE_DISPLAY_NAME:re="user.display_name";break;case ie.USER_DATA_SOURCE_EMAIL:re="user.email";break;case ie.USER_DATA_SOURCE_FIRST_NAME:re="user.firstname";break;case ie.USER_DATA_SOURCE_HANDLE:re="user.handle";break;case ie.USER_DATA_SOURCE_LAST_NAME:re="user.lastname";break}}try{const de={Direction:it,Limit:I,Offset:(C-1)*I,Order:re};L&&L.layout.RequiredRegistrationTags.length>0&&(de.PanelUUID=L==null?void 0:L.layout.LayoutPanelUUID),(L==null?void 0:L.layout.RequiredFormType)===_e.FORM_TYPE_ACCOMMODATION&&(de.Accommodation=!0),(L==null?void 0:L.layout.RequiredFormType)===_e.FORM_TYPE_BADGE&&(de.Badge=!0),(L==null?void 0:L.layout.RequiredFormType)===_e.FORM_TYPE_DEALER&&(de.Dealer=!0),(L==null?void 0:L.layout.RequiredFormType)===_e.FORM_TYPE_REGISTRATION&&(de.Registration=!0),de.GroupUUID=et.value||Nt,de.TagUUID=tt.value||Nt,de.Email=P.value,de.Reference=$.value,de.FieldValues=Array.from(ge.value.values());const Mt=G.value;s.searchConventionRegistrations(a.value.ConventionUUID,de).then(ht=>{ht&&Mt===G.value&&(z.value=ht.Total,V.value=ht.Registrations,N.value.forEach(kt=>{const el=kt.layout;kt.items=V.value.map(X=>{const vt=[];let he;X.Leader?he=X:he=X.Primary,vt.push({Name:he.User.DisplayName,UUID:he.UserUUID,UserUUID:he.User.UserUUID,IsLeader:!0,Reference:he.Reference,Paid:he.Paid,Total:he.Total}),vt.push(...he.Members.map(ke=>({Name:ke.User.DisplayName,UUID:ke.UserUUID,UserUUID:ke.User.UserUUID,IsLeader:!1,Reference:ke.Reference,Paid:ke.Paid,Total:ke.Total})));const ae={};return kt.headers.forEach(ke=>{var ea;const q=el.Items.find(st=>st.LayoutItemUUID===ke.key);if(q){if(q.SourceType==="LAYOUT_ITEM_SOURCE_FORM"&&q.SectionField)X.Submissions.forEach(st=>{const lt=st.Data.find(H=>H.SectionFieldUUID===q.SectionFieldUUID);if(lt){ke.type===_a.ACCOMMODATION?ae[q.LayoutItemUUID]={Data:lt.Data,Registration:X}:ae[q.LayoutItemUUID]=lt.Data;return}});else if(q.SourceType==="LAYOUT_ITEM_SOURCE_USER"&&q.UserField)switch(q.UserField){case ie.USER_DATA_SOURCE_AVATAR:ae[q.LayoutItemUUID]=o.GetProfileImageURL(X.UserUUID);break;case ie.USER_DATA_SOURCE_DISPLAY_NAME:ae[q.LayoutItemUUID]=X.User.DisplayName;break;case ie.USER_DATA_SOURCE_EMAIL:ae[q.LayoutItemUUID]=X.User.Additional.Email;break;case ie.USER_DATA_SOURCE_HANDLE:ae[q.LayoutItemUUID]=X.User.Handle;break;case ie.USER_DATA_SOURCE_DATE_OF_BIRTH:ae[q.LayoutItemUUID]=X.User.Additional.DOB;break;case ie.USER_DATA_SOURCE_FIRST_NAME:ae[q.LayoutItemUUID]=X.User.Additional.FirstName;break;case ie.USER_DATA_SOURCE_LAST_NAME:ae[q.LayoutItemUUID]=X.User.Additional.LastName;break;case ie.USER_DATA_SOURCE_TELEGRAM:ae[q.LayoutItemUUID]="";break}else if(q.SourceType==="LAYOUT_ITEM_SOURCE_META"&&q.MetaField){const st=(ea=m.value.find(H=>H.Type===_e.FORM_TYPE_REGISTRATION))==null?void 0:ea.FormUUID,lt=X.Submissions.find(H=>H.FormUUID===st);switch(q.MetaField){case B.META_DATA_SOURCE_REGISTRATION_ACTIONS:ae[q.LayoutItemUUID]=X;break;case B.META_DATA_SOURCE_REGISTRATION_GROUP:ae[q.LayoutItemUUID]=vt;break;case B.META_DATA_SOURCE_REGISTRATION_REFERENCE:ae[q.LayoutItemUUID]=X.Reference;break;case B.META_DATA_SOURCE_SUBMISSION_DATE:if(lt){const H=new Date(lt.CreatedAt||"");ae[q.LayoutItemUUID]=`${H.getFullYear()}-${(H.getMonth()+1).toString().padStart(2,"0")}-${H.getDate().toString().padStart(2,"0")} ${H.getHours().toString().padStart(2,"0")}:${H.getMinutes().toString().padStart(2,"0")}:${H.getSeconds().toString().padStart(2,"0")}`}else{const H=new Date(X.CreatedAt||"");ae[q.LayoutItemUUID]=`${H.getFullYear()}-${(H.getMonth()+1).toString().padStart(2,"0")}-${H.getDate().toString().padStart(2,"0")} ${H.getHours().toString().padStart(2,"0")}:${H.getMinutes().toString().padStart(2,"0")}:${H.getSeconds().toString().padStart(2,"0")}`}break;case B.META_DATA_SOURCE_ACCOMMODATION_FORM:ae[q.LayoutItemUUID]=X.Submissions.map(H=>{const ee=m.value.find(Re=>Re.FormUUID===H.FormUUID);return{Heading:ee==null?void 0:ee.Heading,Form:ee,Submission:H,Registration:X}}).filter(H=>{var ee;return((ee=H.Form)==null?void 0:ee.Type)===_e.FORM_TYPE_ACCOMMODATION});break;case B.META_DATA_SOURCE_BADGE_FORM:ae[q.LayoutItemUUID]=X.Submissions.map(H=>{const ee=m.value.find(Re=>Re.FormUUID===H.FormUUID);return{Heading:ee==null?void 0:ee.Heading,Form:ee,Submission:H,Registration:X}}).filter(H=>{var ee;return((ee=H.Form)==null?void 0:ee.Type)===_e.FORM_TYPE_BADGE});break;case B.META_DATA_SOURCE_DEALER_FORM:ae[q.LayoutItemUUID]=X.Submissions.map(H=>{const ee=m.value.find(Re=>Re.FormUUID===H.FormUUID);return{Heading:ee==null?void 0:ee.Heading,Form:ee,Submission:H,Registration:X}}).filter(H=>{var ee;return((ee=H.Form)==null?void 0:ee.Type)===_e.FORM_TYPE_DEALER});break;case B.META_DATA_SOURCE_PAYMENT_STATUS:if(X.Paid===0&&X.Total)ae[q.LayoutItemUUID]="REQUIRED";else if(X.Total>X.Paid)ae[q.LayoutItemUUID]="ADDITIONAL_REQUIRED";else{const H=vt.find(ee=>ee.Paid===0&&(ee.Total||0)>0);if(H){X.Total===0&&H.Total===0?ae[q.LayoutItemUUID]="NOT_REQUIRED":X.Total===0&&H.Total||X.Total>0&&H.Total===0?ae[q.LayoutItemUUID]="MISSING_REQUIRED":X.Paid>=X.Total?ae[q.LayoutItemUUID]="AWAITING_PARTNER":ae[q.LayoutItemUUID]="ALL_REQUIRED";break}else X.Total===0?ae[q.LayoutItemUUID]="NOT_REQUIRED":ae[q.LayoutItemUUID]="COMPLETE"}break;case B.META_DATA_SOURCE_SUBMISSION_STATUS:Bl(X.Submissions,m.value),ae[q.LayoutItemUUID]=X.Submissions.map(H=>{const ee=m.value.find(Re=>Re.FormUUID===H.FormUUID);return{Heading:ee==null?void 0:ee.Heading,Form:ee,Submission:H,Registration:X}});break;case B.META_DATA_SOURCE_DATA_LAYOUT:ae[q.LayoutItemUUID]={Registration:X,Layouts:S.value.filter(H=>{if(q.Meta&&q.Meta.LayoutUUID&&Array.isArray(q.Meta.LayoutUUID))return H.Panels.forEach(ee=>{ee.Items.sort((Re,ta)=>Re.Order>ta.Order?1:Re.Order===ta.Order?0:-1)}),q.Meta.LayoutUUID.includes(H.AdminLayoutUUID)})};break}}}}),{key:X.RegistrationUUID,registration:X,...ae}})}),A.value=!1)})}catch{}},Ka=C=>{x.value=!1,C&&(v.value=C,Wt())},Wt=()=>{Ba(v.value.Panels,m.value),v.value.Panels.length>0&&(N.value=[],v.value.Panels.forEach(C=>{const I={uuid:ye(),order:C.Order,name:C.Name,headers:[],items:[],layout:C};C.Items.sort((F,L)=>F.Order>L.Order?1:F.Order==L.Order?0:-1),I.headers=C.Items.map(F=>{var L,Te;return{key:F.LayoutItemUUID,title:F.Label||((Te=(L=F.SectionField)==null?void 0:L.Field)==null?void 0:Te.Label)||"",align:F.Align==="end"?"end":"start",sortable:za(F),type:ja(F),defaultSort:F.DefaultSort,meta:F.Meta}}),N.value.push(I)}),N.value=N.value.sort((C,I)=>C.order>I.order?1:C.order==I.order?0:-1)),(le.value==null||le.value=="")&&N.value.length>0&&(le.value=N.value[0].uuid)};u?s.getConvention(u).then(C=>{C&&(a.value=C,v.value.ConventionID=a.value.ID,v.value.ConventionUUID=a.value.ConventionUUID,qa())}).catch(()=>{f.push("/")}):f.push("/");const ja=C=>{var I,F;if(C.SourceType===Le.LAYOUT_ITEM_SOURCE_META)return`${C.SourceType}.${C.MetaField}`;if(C.SourceType===Le.LAYOUT_ITEM_SOURCE_FORM)return(F=(I=C.SectionField)==null?void 0:I.Field)==null?void 0:F.Type;if(C.SourceType===Le.LAYOUT_ITEM_SOURCE_USER)return`${C.SourceType}.${C.UserField}`},za=C=>{const I=[B.META_DATA_SOURCE_ACCOMMODATION_FORM,B.META_DATA_SOURCE_BADGE_FORM,B.META_DATA_SOURCE_DEALER_FORM,B.META_DATA_SOURCE_REGISTRATION_FORM,B.META_DATA_SOURCE_REGISTRATION_REFERENCE,B.META_DATA_SOURCE_SUBMISSION_DATE,B.META_DATA_SOURCE_SUBMISSION_STATUS],F=[ie.USER_DATA_SOURCE_DISPLAY_NAME,ie.USER_DATA_SOURCE_EMAIL,ie.USER_DATA_SOURCE_HANDLE,ie.USER_DATA_SOURCE_DATE_OF_BIRTH,ie.USER_DATA_SOURCE_FIRST_NAME,ie.USER_DATA_SOURCE_LAST_NAME];return I.includes(C.MetaField)||F.includes(C.UserField)},Qa=C=>{Se.value=C,He.value=!0},Ja=C=>{Se.value=C,Jt.value=!0},Xa=C=>{Se.value=C,xa.value=!0};fe(He,C=>{C||(Se.value=void 0)}),fe(Jt,C=>{C||(Se.value=void 0)});const Ot=async(C="")=>{Xt.value=await s.getRegistrationGroup(C)},Wa=({registration:C,form:I,submission:F})=>{Se.value=C,Ot(C.RegistrationUUID).then(()=>{ct.value=I,Rt.value=F,at.value=!0})},Za=C=>{s.switchUser(C.UserUUID).then(I=>{I&&ql(I.tokens,I.user,f,!1)}).catch(I=>{console.error(I)})};return d.on("registration.group.leave",C=>{s.leaveRegistrationGroup(C).then(I=>{I&&Ot(C).then(()=>{d.emit("registration.group.left",I)})})}),d.on("registration.group.remove.member",C=>{s.leaveRegistrationGroup(C).then(I=>{I&&Ot(C).then(()=>{d.emit("registration.group.left",I)})})}),(C,I)=>(n(),D(jl,null,{default:l(()=>[t($t,{color:"blue-darken-4"},{default:l(()=>[t(Ia,{modelValue:le.value,"onUpdate:modelValue":I[0]||(I[0]=F=>le.value=F),"show-arrows":""},{default:l(()=>[(n(!0),_(M,null,W(N.value,F=>(n(),D(Ca,{key:F.uuid,value:F.uuid},{default:l(()=>[R(y(F.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"]),t(Fe),t(K,{icon:"mdi:mdi-cog-outline",onClick:I[1]||(I[1]=F=>x.value=!0)})]),_:1}),t(Va,{modelValue:le.value,"onUpdate:modelValue":I[23]||(I[23]=F=>le.value=F),disabled:!0,touch:!1},{default:l(()=>[(n(!0),_(M,null,W(N.value,F=>(n(),D(ze,{key:F.uuid,value:F.uuid},{default:l(()=>[F.uuid===le.value?(n(),D($e,{key:0,class:"pa-2"},{default:l(()=>[t(ao,{expanded:U.value,"onUpdate:expanded":I[19]||(I[19]=L=>U.value=L),page:T.value,"onUpdate:page":I[20]||(I[20]=L=>T.value=L),"items-per-page":Y.value,"onUpdate:itemsPerPage":I[21]||(I[21]=L=>Y.value=L),"sort-by":nt.value,"onUpdate:sortBy":I[22]||(I[22]=L=>nt.value=L),headers:F.headers,"items-length":z.value,items:F.items,"item-value":"key",loading:A.value,search:G.value,"onUpdate:options":Vt,"show-expand":""},Je({top:l(()=>[t(It,{class:"mb-3"},{default:l(()=>[t(St,null,{default:l(()=>[t(Dt,{color:"secondary",class:"font-weight-bold pb-0 pt-0"},{default:l(()=>[t(O,{class:"pa-0"},{default:l(()=>[R(" Search Criteria "),t(Me,{class:"pl-5",icon:"mdi:mdi-credit-card-search-outline"})]),_:1}),t(O,{class:"d-none d-sm-block pa-0",cols:"0"},{default:l(()=>[t(oe,{modelValue:$.value,"onUpdate:modelValue":I[2]||(I[2]=L=>$.value=L),label:"Badge No.",clearable:!0,"hide-details":"",variant:"plain",onClick:I[3]||(I[3]=Lt(()=>{},["stop"])),"onClick:clear":E(Ue),onInput:E(Ue)},null,8,["modelValue","onClick:clear","onInput"])]),_:1}),t(O,{class:"d-none d-md-block pa-0"},{default:l(()=>[t(oe,{modelValue:k.value.Value,"onUpdate:modelValue":I[4]||(I[4]=L=>k.value.Value=L),label:"Furry Name",clearable:!0,"hide-details":"",variant:"plain",onClick:I[5]||(I[5]=Lt(()=>{},["stop"])),"onClick:clear":E(Ue),onInput:E(Ue)},null,8,["modelValue","onClick:clear","onInput"])]),_:1})]),_:1}),t(yt,{class:"pt-2"},{default:l(()=>[t(Q,null,{default:l(()=>[t(O,{cols:"12",sm:"6",md:"3",lg:"2",xl:"1"},{default:l(()=>[R(y($.value)+" ",1),t(oe,{modelValue:$.value,"onUpdate:modelValue":I[6]||(I[6]=L=>$.value=L),label:"Badge No.",clearable:!0,"hide-details":"",variant:"outlined","onClick:clear":E(Ue),onInput:E(Ue)},null,8,["modelValue","onClick:clear","onInput"])]),_:1}),t(O,{cols:"12",sm:"6",md:"4",lg:"5",xl:"2"},{default:l(()=>[t(oe,{modelValue:k.value.Value,"onUpdate:modelValue":I[7]||(I[7]=L=>k.value.Value=L),label:"Furry Name",clearable:!0,"hide-details":"",variant:"outlined","onClick:clear":E(Ue),onInput:E(Ue)},null,8,["modelValue","onClick:clear","onInput"])]),_:1}),t(O,{cols:"12",sm:"12",md:"5",lg:"5",xl:"3"},{default:l(()=>[t(oe,{modelValue:P.value,"onUpdate:modelValue":I[8]||(I[8]=L=>P.value=L),label:"E-mail",clearable:!0,"hide-details":"",variant:"outlined","onClick:clear":E(Ue),onInput:E(Ue)},null,8,["modelValue","onClick:clear","onInput"])]),_:1}),t(O,{cols:"12",sm:"6",md:"4",lg:"4",xl:"2"},{default:l(()=>[t(oe,{modelValue:Z.value.Value,"onUpdate:modelValue":I[9]||(I[9]=L=>Z.value.Value=L),label:"Legal Forename",clearable:!0,"hide-details":"",variant:"outlined","onClick:clear":E(Ue),onInput:E(Ue)},null,8,["modelValue","onClick:clear","onInput"])]),_:1}),t(O,{cols:"12",sm:"6",md:"4",lg:"4",xl:"2"},{default:l(()=>[t(oe,{modelValue:ce.value.Value,"onUpdate:modelValue":I[10]||(I[10]=L=>ce.value.Value=L),label:"Legal Surname",clearable:!0,"hide-details":"",variant:"outlined","onClick:clear":E(Ue),onInput:E(Ue)},null,8,["modelValue","onClick:clear","onInput"])]),_:1}),t(O,{cols:"12",sm:"12",md:"4",lg:"4",xl:"2"},{default:l(()=>[t(oe,{modelValue:ne.value.Value,"onUpdate:modelValue":I[11]||(I[11]=L=>ne.value.Value=L),type:"date",label:"Date of Birth",clearable:!0,"hide-details":"",variant:"outlined","onClick:clear":E(Ue),onInput:E(Ue)},null,8,["modelValue","onClick:clear","onInput"])]),_:1}),t(O,{cols:"12",sm:"6",md:"6",lg:"6",xl:"6"},{default:l(()=>[t(ve,{modelValue:et.value,"onUpdate:modelValue":I[12]||(I[12]=L=>et.value=L),label:"Permission Groups",clearable:!0,"hide-details":"",variant:"outlined",items:p.value,"item-value":"GroupUUID","item-title":"Name"},null,8,["modelValue","items"])]),_:1}),t(O,{cols:"12",sm:"6",md:"6",lg:"6",xl:"6"},{default:l(()=>[t(ve,{modelValue:tt.value,"onUpdate:modelValue":I[13]||(I[13]=L=>tt.value=L),label:"Tags",clearable:!0,"hide-details":"",variant:"outlined",items:h.value,"item-value":"TagUUID","item-title":"Title"},null,8,["modelValue","items"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),"expanded-row":l(({columns:L,internalItem:Te})=>[w("tr",null,[w("td",{colspan:L.length},[t(Aa,{modelValue:He.value,"onUpdate:modelValue":I[15]||(I[15]=re=>He.value=re),registration:Te.raw.registration,"onUpdate:registration":re=>Te.raw.registration=re,accommodations:Ce.value,convention:a.value,extras:Ye.value,forms:m.value,interests:Ge.value,tickets:Be.value,title:`Registration Controls (#${Te.raw.registration.Reference} ${Te.raw.registration.User.DisplayName})`,"use-dialog":!1,venues:xe.value,style:{"max-width":"calc(100vw - 48px)"},class:"ml-auto mr-0"},null,8,["modelValue","registration","onUpdate:registration","accommodations","convention","extras","forms","interests","tickets","title","venues"])],8,bi)])]),"item.data-table-expand":l(({internalItem:L})=>[U.value.findIndex(Te=>Te===L.key)>=0?(n(),D(K,{key:0,"append-icon":"mdi:mdi-chevron-up",size:"xs",variant:"flat",onClick:Te=>U.value.splice(U.value.findIndex(re=>re===L.key),1)},{default:l(()=>[L.raw.registration.Notes&&L.raw.registration.Notes.length>0?(n(),_(M,{key:0},[R(y(L.raw.registration.Notes.length),1)],64)):b("",!0)]),_:2},1032,["onClick"])):(n(),D(K,{key:1,"append-icon":"mdi:mdi-chevron-down",size:"xs",variant:"flat",onClick:Te=>U.value.push(L.key)},{default:l(()=>[L.raw.registration.Notes&&L.raw.registration.Notes.length>0?(n(),_(M,{key:0},[R(y(L.raw.registration.Notes.length),1)],64)):b("",!0)]),_:2},1032,["onClick"]))]),bottom:l(()=>[t(me,{fluid:!0},{default:l(()=>[t(Q,{class:"align-center"},{default:l(()=>[t(O,{cols:"12",lg:"7","order-lg":"3",xl:"8"},{default:l(()=>[t(Pl,{modelValue:T.value,"onUpdate:modelValue":I[16]||(I[16]=L=>T.value=L),length:Math.ceil(z.value/Y.value)},null,8,["modelValue","length"])]),_:1}),t(O,{cols:"6",sm:"4",md:"2",lg:"2",xl:"1","order-lg":"1"},{default:l(()=>[t(ve,{modelValue:Y.value,"onUpdate:modelValue":I[17]||(I[17]=L=>Y.value=L),density:"compact","hide-details":"","item-title":"title","item-value":"value",label:"Items per page",min:"-1",max:"100",type:"number",variant:"outlined",items:[{title:"10",value:10},{title:"25",value:25},{title:"50",value:50},{title:"100",value:100},{title:"All",value:-1}]},null,8,["modelValue"])]),_:1}),t(O,{cols:"6",sm:"3",md:"2",lg:"1",xl:"1","order-lg":"2"},{default:l(()=>[t(oe,{modelValue:T.value,"onUpdate:modelValue":I[18]||(I[18]=L=>T.value=L),modelModifiers:{number:!0},density:"compact","hide-details":"",label:"Page",min:"1",max:Math.ceil(z.value/Y.value),type:"number",variant:"outlined"},null,8,["modelValue","max"])]),_:1}),t(O,{class:"text-right",cols:"12",sm:"5",md:"8",lg:"2",xl:"2","order-lg":"4"},{default:l(()=>[w("span",Li,[Y.value===-1?(n(),_(M,{key:0},[R(" 1-"+y(z.value)+" of "+y(z.value),1)],64)):(n(),_(M,{key:1},[R(y((T.value-1)*Y.value+1)+"-"+y(T.value*Y.value>=z.value?z.value:T.value*Y.value)+" of "+y(z.value),1)],64))])]),_:1})]),_:1})]),_:1})]),_:2},[W(F.headers,L=>({name:`item.${L.key}`,fn:l(({internalItem:Te,index:re})=>[t(ai,{header:L,item:Te,accommodations:Ce.value,convention:a.value,extras:Ye.value,forms:m.value,interests:Ge.value,tickets:Be.value,user:E(Ha),venues:xe.value,modelValue:F.items[re],"onUpdate:modelValue":it=>F.items[re]=it,onOpenActions:Qa,onOpenPayments:Ja,onOpenTags:Xa,onReload:I[14]||(I[14]=it=>Vt({page:T.value,itemsPerPage:Y.value,sortBy:se.value})),onSwitchUser:Za,onShowForm:Wa},null,8,["header","item","accommodations","convention","extras","forms","interests","tickets","user","venues","modelValue","onUpdate:modelValue"])])}))]),1032,["expanded","page","items-per-page","sort-by","headers","items-length","items","loading","search"])]),_:2},1024)):b("",!0)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"]),x.value?(n(),D(Ni,{key:0,title:"Edit Layouts",modelValue:x.value,"onUpdate:modelValue":I[24]||(I[24]=F=>x.value=F),convention:a.value,onSave:Ka},null,8,["modelValue","convention"])):b("",!0),Se.value?(n(),_(M,{key:1},[He.value?(n(),D(Aa,{key:0,modelValue:He.value,"onUpdate:modelValue":I[25]||(I[25]=F=>He.value=F),registration:Se.value,"onUpdate:registration":I[26]||(I[26]=F=>Se.value=F),accommodations:Ce.value,convention:a.value,extras:Ye.value,forms:m.value,interests:Ge.value,tickets:Be.value,title:`Registration Controls (#${Se.value.Reference} ${Se.value.User.DisplayName})`,"use-dialog":!0,venues:xe.value},null,8,["modelValue","registration","accommodations","convention","extras","forms","interests","tickets","title","venues"])):b("",!0)],64)):b("",!0),at.value&&Rt.value&&ct.value?(n(),D(_t,{key:2,modelValue:at.value,"onUpdate:modelValue":I[30]||(I[30]=F=>at.value=F),scrollable:!0,fullscreen:!0,persistent:!0},{default:l(()=>[t($e,{class:"bg-red-darken-4"},{default:l(()=>[t($t,{color:"error"},{default:l(()=>[t(Ma,null,{default:l(()=>[R("Submission Editor - Admin Mode")]),_:1}),t(Fe),t(Kl,null,{default:l(()=>[t(K,{icon:"mdi:mdi-window-close",onClick:I[27]||(I[27]=F=>at.value=!1)})]),_:1})]),_:1}),t(Ze,null,{default:l(()=>[t(Al,{modelValue:ct.value,"onUpdate:modelValue":I[28]||(I[28]=F=>ct.value=F),admin:!0,convention:a.value,data:Rt.value,editable:!0,"registration-group":Xt.value,onClose:I[29]||(I[29]=F=>{at.value=!1,Vt({page:T.value,itemsPerPage:Y.value,sortBy:se.value})})},null,8,["modelValue","convention","data","registration-group"])]),_:1})]),_:1})]),_:1},8,["modelValue"])):b("",!0)]),_:1}))}});export{ys as default};
