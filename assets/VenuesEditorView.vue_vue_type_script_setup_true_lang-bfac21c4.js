import{s as y}from"./index-71069b21.js";import{C as q,a as Y,b as Z,c as H,V as J}from"./VExpansionPanel-46f9d4eb.js";import{a as P,V as p}from"./VRow-507c8708.js";import{V as b}from"./VTextField-0c9ac203.js";import{V as K}from"./VSelect-b81109c3.js";import{V as N,a as Q}from"./VBtn-99c3a21a.js";import{d as w,Y as k,Z as O,o as v,b as M,w as l,c as e,M as I,y as C,S as G,O as _,F as D,f as m,G as V,e as c,L,P as S,k as W}from"./index-181421cc.js";import{u as F}from"./useGrazeAPI-c1e75c1b.js";import{_ as A}from"./SaveButton.vue_vue_type_script_setup_true_lang-ae6005f8.js";import{V as j}from"./VContainer-c8b4685d.js";import{V as X}from"./VDialog-c1da656d.js";import{V as ee}from"./VTable-77615c8f.js";import{e as le,c as ae}from"./VCard-1b7e593d.js";import{b as te,V as oe}from"./VToolbar-bce2e74a.js";import{V as ue}from"./VSpacer-d97ac40e.js";import{V as ne}from"./VToolbarItems-45324ad8.js";import{V as $}from"./VSheet-e0689af5.js";import{V as z}from"./VTextarea-5d8731c6.js";import{v as B}from"./v4-a960c1f4.js";const se=w({__name:"VenueRoomCost",props:{modelValue:{required:!0}},emits:k(["deleted"],["update:modelValue"]),setup(U,{emit:R}){const d=O(U,"modelValue"),r=[{title:"Per Room",value:"PER_ROOM"},{title:"Per Person",value:"PER_PERSON"}],n=()=>{R("deleted")};return(a,s)=>(v(),M(P,{dense:""},{default:l(()=>[e(p,{cols:"12",sm:"4",md:"2",lg:"2"},{default:l(()=>[e(b,{label:I(y).formLabelDateStart,type:"date",variant:"outlined",modelValue:d.value.DateStart,"onUpdate:modelValue":s[0]||(s[0]=i=>d.value.DateStart=i)},null,8,["label","modelValue"])]),_:1}),e(p,{cols:"12",sm:"4",md:"2",lg:"2"},{default:l(()=>[e(b,{label:I(y).formLabelDateEnd,type:"date",variant:"outlined",modelValue:d.value.DateEnd,"onUpdate:modelValue":s[1]||(s[1]=i=>d.value.DateEnd=i)},null,8,["label","modelValue"])]),_:1}),e(p,{cols:"6",sm:"4",md:"2",lg:"2"},{default:l(()=>[e(b,{label:I(y).formLabelAvailability,type:"number",variant:"outlined",modelValue:d.value.Availability,"onUpdate:modelValue":s[2]||(s[2]=i=>d.value.Availability=i),modelModifiers:{number:!0}},null,8,["label","modelValue"])]),_:1}),e(p,{cols:"6",sm:"4",md:"2",lg:"2"},{default:l(()=>[e(b,{label:I(y).formLabelPrice,type:"number","prepend-inner-icon":"mdi:mdi-currency-gbp",variant:"outlined",modelValue:d.value.Price,"onUpdate:modelValue":s[3]||(s[3]=i=>d.value.Price=i),modelModifiers:{number:!0}},null,8,["label","modelValue"])]),_:1}),e(p,{cols:"6",sm:"4",md:"3",lg:"3"},{default:l(()=>[e(K,{label:I(y).formLabelPriceType,variant:"outlined",modelValue:d.value.Type,"onUpdate:modelValue":s[4]||(s[4]=i=>d.value.Type=i),items:r,"item-value":"value","item-title":"title"},null,8,["label","modelValue"])]),_:1}),e(p,{cols:"6",sm:"4",md:"1",class:"text-right"},{default:l(()=>[e(N,{color:"red",icon:"mdi:mdi-minus",onClick:n})]),_:1})]),_:1}))}}),de=m("strong",null,"Capacity:",-1),ie=m("thead",null,[m("tr",null,[m("th",null,"Date"),m("th",null,"Price"),m("th",null,"Availability")])],-1),me={class:"d-flex flex-wrap justify-space-between",style:{gap:"1rem"}},re=m("h4",null," Availability & Costs (To Organisation) ",-1),ve=w({__name:"VenueRoom",props:{modelValue:{required:!0}},emits:k(["deleted"],["update:modelValue"]),setup(U,{emit:R}){const d=F(),r=C(y),n=O(U,"modelValue"),a=C(G(n.value)),s=C(!1),i=u=>{switch(u.Type){case q.PER_PERSON:return r.value.enumPER_PERSON;case q.PER_ROOM:return r.value.enumPER_ROOM}return"Unknown"},g=()=>{a.value.Costs||(a.value.Costs=[]),a.value.Costs.push({ID:0,CostUUID:B(),Availability:0,DateStart:"",DateEnd:"",Price:0,Type:"PER_ROOM"})},T=u=>{a.value.Costs.splice(u,1)},x=({callback:u})=>{const t=()=>{u&&u("Failed to Delete Room")},o=()=>{u&&u("Room Deleted")};d.deleteRoom(a.value.RoomUUID).then(f=>{f?(o(),R("deleted",a.value)):t()}).catch(()=>{t()})},h=()=>{d.saveRoom(a.value).then(()=>{n.value=a.value,s.value=!1})};return(u,t)=>(v(),_(D,null,[e(j,{fluid:"",class:"pa-1 pa-sm-2"},{default:l(()=>[m("h4",null,V(a.value.Name),1),m("p",null,V(a.value.Notes),1),m("p",null,[de,c(" "+V(a.value.MinimumCapacity)+" ",1),a.value.MinimumCapacity!=a.value.MaximumCapacity?(v(),_(D,{key:0},[c(" - "+V(a.value.MaximumCapacity),1)],64)):L("",!0)]),e(ee,{density:"compact"},{default:l(()=>[ie,m("tbody",null,[(v(!0),_(D,null,S(a.value.Costs,o=>(v(),_("tr",{key:`venue-room-${a.value.ID}-cost-${o.ID}`},[m("td",null,V(o.DateStart)+" - "+V(o.DateEnd),1),m("td",null,V(r.value.currencySymbol)+V(o.Price)+" "+V(i(o)),1),m("td",null,V(o.Availability),1)]))),128))])]),_:1}),m("div",me,[e(N,{color:"primary","prepend-icon":"mdi:mdi-playlist-edit",onClick:t[0]||(t[0]=o=>s.value=!0)},{default:l(()=>[c("Edit Room")]),_:1}),e(A,{color:"red-darken-3","prepend-icon":"mdi:mdi-minus",onClick:x},{default:l(()=>[c("Delete Room")]),_:1})])]),_:1}),e(X,{scrollable:"",modelValue:s.value,"onUpdate:modelValue":t[6]||(t[6]=o=>s.value=o),width:"auto"},{default:l(()=>[e(le,null,{default:l(()=>[e(te,{dark:"",color:"primary"},{default:l(()=>[e(N,{icon:"",dark:"",onClick:t[1]||(t[1]=o=>s.value=!1)},{default:l(()=>[e(Q,null,{default:l(()=>[c("mdi:mdi-close")]),_:1})]),_:1}),e(oe,null,{default:l(()=>[c("Room Details ("+V(a.value.Name)+")",1)]),_:1}),e(ue),e(ne,null,{default:l(()=>[e(N,{variant:"text",onClick:h},{default:l(()=>[c(" Save ")]),_:1})]),_:1})]),_:1}),e(ae,null,{default:l(()=>[e($,null,{default:l(()=>[e(P,null,{default:l(()=>[e(p,{cols:"12"},{default:l(()=>[e(b,{label:r.value.formLabelName,type:"text",variant:"outlined",modelValue:a.value.Name,"onUpdate:modelValue":t[2]||(t[2]=o=>a.value.Name=o)},null,8,["label","modelValue"])]),_:1})]),_:1}),e(P,null,{default:l(()=>[e(p,null,{default:l(()=>[e(z,{label:r.value.formLabelNotes,variant:"outlined",modelValue:a.value.Notes,"onUpdate:modelValue":t[3]||(t[3]=o=>a.value.Notes=o)},null,8,["label","modelValue"])]),_:1})]),_:1}),e(P,null,{default:l(()=>[e(p,{cols:"12",sm:"6"},{default:l(()=>[e(b,{type:"number",label:r.value.formLabelMinimumCapacity,variant:"outlined",modelValue:a.value.MinimumCapacity,"onUpdate:modelValue":t[4]||(t[4]=o=>a.value.MinimumCapacity=o),modelModifiers:{number:!0}},null,8,["label","modelValue"])]),_:1}),e(p,{cols:"12",sm:"6"},{default:l(()=>[e(b,{type:"number",label:r.value.formLabelMaximumCapacity,variant:"outlined",modelValue:a.value.MaximumCapacity,"onUpdate:modelValue":t[5]||(t[5]=o=>a.value.MaximumCapacity=o),modelModifiers:{number:!0}},null,8,["label","modelValue"])]),_:1})]),_:1}),e(P,null,{default:l(()=>[e(p,null,{default:l(()=>[re]),_:1})]),_:1}),(v(!0),_(D,null,S(a.value.Costs,(o,f)=>(v(),_(D,{key:`venue-room-${a.value.ID}-cost-${o.ID}`},[a.value.Costs&&a.value.Costs[f]?(v(),M(se,{key:0,modelValue:a.value.Costs[f],"onUpdate:modelValue":E=>a.value.Costs[f]=E,onDeleted:E=>T(f)},null,8,["modelValue","onUpdate:modelValue","onDeleted"])):L("",!0)],64))),128)),e(N,{color:"primary","prepend-icon":"mdi:mdi-plus",onClick:g},{default:l(()=>[c("Add Row")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}}),pe=m("h3",null,"Rooms",-1),Ve=w({__name:"Venue",props:{modelValue:{required:!0}},emits:k(["deleted"],["update:modelValue"]),setup(U,{emit:R}){const d=F(),r=O(U,"modelValue"),n=C(G(r.value)),a=C([]),s=C(!1),i=C(!1);d.getVenueRooms(n.value.VenueUUID).then(u=>{a.value=u}),W(n.value,()=>{i.value=!0});const g=({callback:u})=>{s.value=!0,d.saveVenue(n.value).then(()=>{s.value=!1,i.value=!1,r.value=n.value,u&&u("Venue Saved")}).catch(()=>{s.value=!1,u&&u("Failed to Saved Venue")})},T=({callback:u})=>{s.value=!0,d.deleteVenue(n.value.VenueUUID).then(t=>{s.value=!1,t?u&&(u("Venue Deleted"),R("deleted")):u&&u("Failed to Delete Venue")}).catch(()=>{u&&(u("Failed to Delete Venue"),s.value=!1)})},x=()=>{const u={ID:0,RoomUUID:B(),VenueID:n.value.ID,VenueUUID:n.value.VenueUUID,Order:a.value.length+1,Name:"New Room",Notes:"",MaximumCapacity:1,MinimumCapacity:1,Costs:[]};d.saveRoom(u).then(t=>{t&&a.value.push(t)})},h=(u,t)=>{d.deleteRoom(a.value[t].RoomUUID).then(o=>{o&&a.value.splice(t,1)})};return(u,t)=>(v(),M(Y,null,{default:l(()=>[e(Z,null,{default:l(()=>[c(V(n.value.Name),1)]),_:1}),e(H,null,{default:l(()=>[e(P,{"no-gutters":""},{default:l(()=>[e(p,{cols:"12"},{default:l(()=>[e(b,{label:I(y).formLabelName,name:"name",variant:"outlined",modelValue:n.value.Name,"onUpdate:modelValue":t[0]||(t[0]=o=>n.value.Name=o)},null,8,["label","modelValue"])]),_:1}),e(p,{cols:"12"},{default:l(()=>[e(z,{label:I(y).formLabelDescription,name:"description",variant:"outlined",modelValue:n.value.Description,"onUpdate:modelValue":t[1]||(t[1]=o=>n.value.Description=o)},null,8,["label","modelValue"])]),_:1}),e(p,{class:"text-right",cols:"12"},{default:l(()=>[e(A,{class:"mr-2",color:"red-darken-3",label:"Delete",onClick:T}),e(A,{enabled:i.value,timeout:"7",onClick:g},null,8,["enabled"])]),_:1})]),_:1}),pe,(v(!0),_(D,null,S(a.value,(o,f)=>(v(),M($,{variant:"elevation",elevation:"6",key:`venue-room-${o.ID}`},{default:l(()=>[a.value&&a.value[f]?(v(),M(ve,{key:0,modelValue:a.value[f],"onUpdate:modelValue":E=>a.value[f]=E,onDeleted:E=>h(E,f)},null,8,["modelValue","onUpdate:modelValue","onDeleted"])):L("",!0)]),_:2},1024))),128)),e($,{class:"ma-2"},{default:l(()=>[e(N,{color:"primary","prepend-icon":"mdi:mdi-plus",onClick:x},{default:l(()=>[c("Add Room")]),_:1})]),_:1})]),_:1})]),_:1}))}}),fe=m("h3",null,"Venues",-1),ce=m("p",null," Venues and the rooms they supply to the organisation, this is internal data not seen by attendees. ",-1),_e=m("p",null," Attendee options are configured via the accommodation tab. ",-1),Oe=w({__name:"VenuesEditorView",props:{modelValue:{required:!0}},emits:k(["close","pageTitle","refresh"],["update:modelValue"]),setup(U,{emit:R}){const d=F(),r=O(U,"modelValue");R("pageTitle","Venues");const n=C([]);d.getConventionVenues(r.value.ConventionUUID).then(i=>{n.value=i});const a=()=>{const i={ID:0,VenueUUID:B(),ConventionID:r.value.ID,ConventionUUID:r.value.ConventionUUID,Order:n.value.length+1,Name:"New Venue",Description:"",Rooms:[]};d.saveVenue(i).then(g=>{g&&n.value.push(g)})},s=i=>{n.value.splice(i,1)};return(i,g)=>(v(),_(D,null,[e(j,{fluid:"",class:"px-0"},{default:l(()=>[e(P,null,{default:l(()=>[e(p,null,{default:l(()=>[fe]),_:1})]),_:1})]),_:1}),ce,_e,e($,null,{default:l(()=>[e(J,{variant:"accordion"},{default:l(()=>[(v(!0),_(D,null,S(n.value,(T,x)=>(v(),M(Ve,{key:`venues-${T.ID}`,modelValue:n.value[x],"onUpdate:modelValue":h=>n.value[x]=h,onDeleted:h=>s(x)},null,8,["modelValue","onUpdate:modelValue","onDeleted"]))),128))]),_:1}),e($,{class:"pa-2"},{default:l(()=>[e(N,{color:"primary",onClick:a},{default:l(()=>[c("Add Venue")]),_:1})]),_:1})]),_:1})],64))}});export{Oe as _};
