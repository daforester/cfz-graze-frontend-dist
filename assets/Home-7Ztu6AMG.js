import{i as W,M as Se,N as he,j as Te,r as D,w as se,n as e,q as l,v as t,x as n,f as u,z as ke,y as h,A as g,O as Ie,D as v,P as le,k as ve,B as r,F as f,Q as H,C as d,p as Ue,R as Ee,d as Ae,u as be,S as De,c as F,m as ae,l as ne,G as we,H as Pe,_ as _e}from"./index-i0ULDOXJ.js";import{G as ie}from"./userData-5JNjAdS-.js";import{_ as Ce}from"./LoginView.vue_vue_type_script_setup_true_lang-hFIjpT15.js";import{s as ee}from"./index-2XRRB2DS.js";import{F as I}from"./form-0fJbSFPv.js";import{S as $,a as Ve}from"./submission-40fey8Hx.js";import{u as Oe}from"./useStoreAPI-oz7yEeoV.js";import{c as J}from"./canEditForm-viF788U5.js";import{s as Re}from"./sortSubmissions-NKScr9xj.js";import{P as Q,a as Fe,u as Me}from"./useDisplayTransactions-X9B8jrFM.js";import{l as Ne}from"./stripe.esm-sevhGlMX.js";import{_ as $e}from"./ModelDialog.vue_vue_type_script_setup_true_lang-u4vVkL7h.js";import{c as re,V as c,n as Ye,u as Le}from"./VContainer-k1BohBpm.js";import{V as ze}from"./VAlert-vkpAnOB_.js";import{V as xe}from"./VForm-2S6Ko-xi.js";import{V as X,a as j}from"./VRow-NZgdOiCq.js";import{V as ge,u as Be}from"./scopeId-qGdo5CfT.js";import{V as Ge,m as He,a as fe}from"./SaveButton.vue_vue_type_script_setup_true_lang-dne48IvW.js";import{f as qe,h as pe}from"./date-1rFCglLs.js";import{V as je,a as te,b as ye,c as oe,d as We,e as Ke}from"./VCard-0whrmwGD.js";import{f as Je,V as Qe}from"./forwardRefs-btF0tueM.js";import{V as Xe,a as Ze,c as et,d as tt}from"./VList-qYBHItk9.js";import"./emailFormVariant-1EY2p0cn.js";import"./LoginButton-9XG814K_.js";import"./VDialog-y9ulYbeJ.js";import"./VToolbar-wYfWzr5y.js";import"./createSimpleFunctional-iCMwO9Wh.js";import"./form-S5xfevEa.js";import"./VDivider-6RPl5Osu.js";const ot=v("p",{class:"my-4"},[n(" Payments are non-refundable, please check our "),v("a",{target:"_blank",href:"https://www.scotiacon.org.uk/policies"},"policies"),n(" for further information. ")],-1),at=v("p",{class:"my-4"}," You must be over 18 to attend the convention and be able to produce valid ID matching the details on your registration. ",-1),nt=v("p",{class:"my-4"}," If you are unable to provide valid ID when asked at the convention you will not be issued your attendee badge. ",-1),st=v("p",{class:"my-4"}," Payments should be made by the authorised card holder only. ",-1),lt=v("p",{class:"my-4"},[n(" Please contact "),v("a",{href:"mailto:registration@scotiacon.org.uk"},"registration@scotiacon.org.uk"),n(" if you need any further assistance. ")],-1),it=v("div",{id:"link-authentication-element"},null,-1),rt=v("div",{id:"payment-element"},null,-1),ut=W({__name:"StripePayment",props:Se({paymentTransactions:{},registration:{}},{modelValue:{type:Boolean,required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(i){const U=he(i,"modelValue"),T=le(),E=ie(),_=Te(),s=D(),y=D(),A=D((E==null?void 0:E.Additional.Email)||""),V=D(!1),Y=D("");let M;const z=D(!1);se(U,k=>{k&&T.stripePublicKey().then(async S=>{S&&(y.value=await Ne(S),await L(y.value))})});const x=k=>{Y.value=k,V.value=!0};async function L(k){var p;if(!k)return;const S=await T.stripePaymentIntent(((p=i.registration)==null?void 0:p.RegistrationUUID)||""),w={theme:"stripe"};_.current.value.dark&&(w.theme="night"),M=k.elements({clientSecret:S,appearance:w});const B=M.create("linkAuthentication",{defaultValues:{email:A.value}});B.mount("#link-authentication-element"),B.on("change",m=>{A.value=m.value.email});const Z={layout:"tabs"};M.create("payment",Z).mount("#payment-element")}async function G(k,S){if(!S)return;k.preventDefault(),z.value=!0;const w=new URL(location.href);w.pathname+="payment/stripe/processing";const{error:B}=await S.confirmPayment({elements:M,confirmParams:{return_url:w.toString(),receipt_email:A.value}});B.type==="card_error"||B.type==="validation_error"?x(B.message):x("An unexpected error occurred."),z.value=!1}return(k,S)=>(e(),l($e,{modelValue:U.value,"onUpdate:modelValue":S[4]||(S[4]=w=>U.value=w),title:"Make a Payment",color:"blue-darken-4",fullscreen:"",persistent:""},{default:t(()=>[u(re,{class:"pa-0"},{default:t(()=>[u(ze,{class:"mb-2",closable:!0},{title:t(()=>[n(" Payment Information ")]),text:t(()=>[ot,at,nt,st,lt]),_:1}),u(xe,{ref_key:"paymentForm",ref:s,id:"payment-form",onSubmit:S[1]||(S[1]=ke(w=>G(w,y.value),["prevent"]))},{default:t(()=>[u(X,null,{default:t(()=>[u(j,null,{default:t(()=>[it]),_:1})]),_:1}),u(X,null,{default:t(()=>[u(j,null,{default:t(()=>[rt]),_:1})]),_:1}),u(X,null,{default:t(()=>[k.registration?(e(),l(j,{key:0,class:"font-weight-bold text-right"},{default:t(()=>[n(" Payment Amount: £"+h(k.registration.Total-k.registration.Paid),1)]),_:1})):g("",!0)]),_:1}),u(X,null,{default:t(()=>[u(j,{class:"text-right",cols:"12",sm:"3",md:"2",lg:"2",xl:"1"},{default:t(()=>[u(c,{color:"error",class:"w-100",onClick:S[0]||(S[0]=w=>U.value=!1)},{default:t(()=>[n("Cancel")]),_:1})]),_:1}),u(ge),u(j,{class:"text-left",cols:"12",sm:"3",md:"2",lg:"2",xl:"1"},{default:t(()=>[u(c,{type:"submit",color:"success",class:"w-100"},Ie({default:t(()=>[n(" Pay Now ")]),_:2},[z.value?{name:"prepend",fn:t(()=>[u(Ye,{size:"20",indeterminate:""})]),key:"0"}:void 0]),1024)]),_:1})]),_:1})]),_:1},512)]),_:1}),u(Ge,{modelValue:V.value,"onUpdate:modelValue":S[3]||(S[3]=w=>V.value=w)},{actions:t(()=>[u(c,{variant:"text",onClick:S[2]||(S[2]=w=>V.value=!1)},{default:t(()=>[n(" Close ")]),_:1})]),default:t(()=>[n(h(Y.value)+" ",1)]),_:1},8,["modelValue"])]),_:1},8,["modelValue"]))}}),ct={key:0},dt={key:1,class:"v-row"},mt={key:0,class:"v-col v-col-10 py-1 v-row mx-0 pl-0"},vt={class:"v-col v-col-12 v-col-sm-4 v-col-md-3 font-weight-bold pb-0 pr-0"},ft={class:"v-col v-col-12 v-col-sm-8 v-col-md-9 font-italic pt-0 pt-sm-3 pb-sm-0 pl-sm-0"},pt={key:1,class:"v-col v-col-10 py-1 v-row mx-0 pl-0"},yt={class:"v-col v-col-12 v-col-sm-4 v-col-md-3 font-weight-bold pb-0 pr-0"},_t={class:"v-col v-col-12 v-col-sm-8 v-col-md-9 font-italic pt-0 pt-sm-3 pb-sm-0 pl-sm-0"},gt={class:"v-col v-col-2 align-self-end text-right py-1 text-no-wrap"},St=v("dt",{class:"v-col v-col-9 py-1 font-weight-bold totals"}," Total Charges ",-1),ht={class:"v-col v-col-3 align-self-end text-right py-1 totals text-no-wrap"},Tt=v("dt",{class:"v-col v-col-9 py-1 font-weight-bold"}," Current Payments ",-1),kt={class:"v-col v-col-3 align-self-end text-right py-1 text-no-wrap"},It=v("dt",{class:"v-col v-col-9 py-1 font-weight-bold totals"}," Balance Due ",-1),Ut={class:"v-col v-col-3 align-self-end text-right py-1 totals text-no-wrap"},Et=W({__name:"AttendeeTransactionList",props:{paymentTransactions:{},registration:{}},setup(i){const U=i,T=D(ve(U.paymentTransactions));se(U,()=>{T.value=ve(U.paymentTransactions)});const E=(_,s)=>_.Type===Q.PAYMENT_TRANSACTION_TYPE_CHARGE&&s.Type!==Q.PAYMENT_TRANSACTION_TYPE_CHARGE?-1:_.Type!==Q.PAYMENT_TRANSACTION_TYPE_CHARGE&&s.Type===Q.PAYMENT_TRANSACTION_TYPE_CHARGE||(_.UpdatedAt||0)>(s.UpdatedAt||0)?1:_.UpdatedAt===s.UpdatedAt?0:-1;return(_,s)=>_.registration.Total==0?(e(),r("p",ct," Your registration is currently being processed, payment information will appear here when ready. ")):(e(),r("dl",dt,[(e(!0),r(f,null,H(T.value.sort(E),y=>{var A;return e(),r(f,{key:y.PaymentTransactionUUID},[y.Type===d(Q).PAYMENT_TRANSACTION_TYPE_CHARGE?(e(),r("dt",mt,[v("div",vt,h(y.Description.split(":")[0]),1),v("div",ft,h(y.Description.split(":")[1]),1)])):(e(),r("dt",pt,[v("div",yt,h((A=d(Fe).find(V=>V.value===y.Type))==null?void 0:A.title),1),v("div",_t," [ "+h(d(qe)(y.UpdatedAt||""))+" ] "+h(y.Description),1)])),v("dd",gt," £"+h(y.Amount),1)],64)}),128)),St,v("dd",ht," £"+h(_.registration.Total),1),Tt,v("dd",kt," £"+h(_.registration.Paid),1),It,v("dd",Ut," £"+h(_.registration.Total-_.registration.Paid),1)]))}}),At=Ue({id:String,text:String,...Ee(He({closeOnBack:!1,location:"end",locationStrategy:"connected",eager:!0,minWidth:0,offset:10,openOnClick:!1,openOnHover:!0,origin:"auto",scrim:!1,scrollStrategy:"reposition",transition:!1}),["absolute","persistent"])},"VTooltip"),bt=Ae()({name:"VTooltip",props:At(),emits:{"update:modelValue":i=>!0},setup(i,U){let{slots:T}=U;const E=be(i,"modelValue"),{scopeId:_}=Be(),s=De(),y=F(()=>i.id||`v-tooltip-${s}`),A=D(),V=F(()=>i.location.split(" ").length>1?i.location:i.location+" center"),Y=F(()=>i.origin==="auto"||i.origin==="overlap"||i.origin.split(" ").length>1||i.location.split(" ").length>1?i.origin:i.origin+" center"),M=F(()=>i.transition?i.transition:E.value?"scale-transition":"fade-transition"),z=F(()=>ae({"aria-describedby":y.value},i.activatorProps));return Le(()=>{const x=fe.filterProps(i);return u(fe,ae({ref:A,class:["v-tooltip",i.class],style:i.style,id:y.value},x,{modelValue:E.value,"onUpdate:modelValue":L=>E.value=L,transition:M.value,absolute:!0,location:V.value,origin:Y.value,persistent:!0,role:"tooltip",activatorProps:z.value,_disableGlobalStack:!0},_),{activator:T.activator,default:function(){var S;for(var L=arguments.length,G=new Array(L),k=0;k<L;k++)G[k]=arguments[k];return((S=T.default)==null?void 0:S.call(T,...G))??i.text}})}),Je({},A)}}),K=i=>(we("data-v-e0f22da7"),i=i(),Pe(),i),Dt=["innerHTML"],wt={key:0},Pt={key:0,class:"font-weight-bold float-left pt-1 w-50"},Ct={key:1,class:"pa-1"},Vt=K(()=>v("dt",null,[v("h3",null,"Forms Available")],-1)),Ot=K(()=>v("dd",{class:"mb-2"}," The following forms are currently available for completion. ",-1)),Rt={class:"font-weight-bold float-left pt-1 w-50 pt-3",style:{clear:"both"}},Ft={class:"pt-2"},Mt=K(()=>v("dt",{class:"mt-3"},[v("h3",null,"Received Forms")],-1)),Nt=K(()=>v("dd",{class:"mb-2"}," The following forms have been received from you. ",-1)),$t={key:0,class:"font-weight-bold float-left pt-1 w-50",style:{clear:"both"}},Yt={key:1},Lt={class:"font-weight-bold float-left pt-1 w-50",style:{clear:"both"}},zt={class:"text-red-darken-4"},xt={key:1,class:"text-red-darken-4 mt-4"},Bt=K(()=>v("strong",null,"There are forms above that require completion, please edit and save them.",-1)),Gt=[Bt],Ht=K(()=>v("br",null,null,-1)),qt=W({__name:"OpenConvention",props:{convention:{},forms:{default:()=>[]}},setup(i){const U=Oe(),T=le(),{getPaymentTransactions:E}=Me(),_=D(U.GetConventionLogoURL(i.convention.ConventionUUID)),s=D(),y=D([]),A=D([]),V=D([]),Y=D(!1),M=D([]),z=F(()=>{var o;return J(i.forms,((o=s.value)==null?void 0:o.Submissions)||[],I.FORM_TYPE_REGISTRATION)}),x=F(()=>{var o;return J(i.forms,((o=s.value)==null?void 0:o.Submissions)||[],I.FORM_TYPE_DEALER)}),L=F(()=>{var o;return J(i.forms,((o=s.value)==null?void 0:o.Submissions)||[],I.FORM_TYPE_BADGE)}),G=F(()=>{var o;return J(i.forms,((o=s.value)==null?void 0:o.Submissions)||[],I.FORM_TYPE_ACCOMMODATION)}),k=F(()=>{var o;return J(i.forms,((o=s.value)==null?void 0:o.Submissions)||[],I.FORM_TYPE_ADDITIONAL)}),S=F(()=>s.value?i.forms.filter(o=>{var p;return o.State.Independent?(p=s.value)!=null&&p.Submissions&&"Submissions"in s.value?!s.value.Submissions.find(m=>{var O;return((O=m.Form)==null?void 0:O.FormUUID)===o.FormUUID}):!0:!1}):i.forms),w=F(()=>{var o,p;return s.value&&((o=s.value)!=null&&o.Submissions)?!!((p=s.value)!=null&&p.Submissions.find(m=>{var O;return((O=m.Form)==null?void 0:O.Type)==I.FORM_TYPE_REGISTRATION&&(m.Status==$.SUBMISSION_STATUS_ACCEPTED||m.Status==$.SUBMISSION_STATUS_COMPLETED)})):!1}),B=async()=>{s.value&&"RegistrationUUID"in s.value&&T.getRegistrationAllocationPeriods(s.value.RegistrationUUID).then(o=>{o&&(A.value=[],y.value=o,y.value.sort((p,m)=>p.DateStart>m.DateStart?1:-1).forEach(p=>{var O;const m=A.value.find(P=>{var C;return P.name===((C=p.Accommodation)==null?void 0:C.Name)});if(m){const P=m.periods.find(R=>R.start===p.DateEnd),C=m.periods.find(R=>R.end===p.DateStart);P?P.start=p.DateStart:C?C.end=p.DateEnd:m.periods.push({start:p.DateStart,end:p.DateEnd})}else A.value.push({name:((O=p.Accommodation)==null?void 0:O.Name)||"",periods:[{start:p.DateStart,end:p.DateEnd}]})}))}).catch(()=>{})},Z=()=>{T.getRegistrationByConvention(i.convention.ConventionUUID).then(o=>{var p;o&&(o.Submissions?(o.Submissions.forEach((m,O)=>{m.Form||(o.Submissions[O].Form=i.forms.find(P=>P.FormUUID===m.FormUUID))}),Re(o.Submissions)):o.Submissions=[],s.value=o,B(),w.value&&E(((p=s.value)==null?void 0:p.RegistrationUUID)||"").then(m=>{V.value=m}))})};return se(()=>i.forms,()=>{Z()}),Z(),(o,p)=>{const m=ne("router-link"),O=ne("RouterLink");return e(),l(Ke,{class:"elevation-5 flex-1-0 d-flex flex-column"},{default:t(()=>[u(je,{class:"flex-1-1 align-content-start"},{default:t(()=>[_.value?(e(),l(Qe,{key:0,src:_.value,title:o.convention.Name,class:"logo text-center"},null,8,["src","title"])):g("",!0),o.convention.Name?(e(),l(te,{key:1,class:"text-center"},{default:t(()=>[n(h(o.convention.Name),1)]),_:1})):g("",!0),o.convention.Description?(e(),l(ye,{key:2,class:"text-wrap subtitle"},{default:t(()=>[v("div",{innerHTML:o.convention.Description},null,8,Dt)]),_:1})):g("",!0)]),_:1}),u(oe,null,{default:t(()=>{var P,C,R;return[s.value?(e(),r("dl",wt,[s.value.Reference?(e(),r("dt",Pt," Badge No: ")):g("",!0),s.value.Reference?(e(),r("dd",Ct," #"+h(s.value.Reference),1)):g("",!0),S.value.length>0?(e(),r(f,{key:2},[Vt,Ot],64)):g("",!0),(e(!0),r(f,null,H(S.value,(a,N)=>(e(),r(f,{key:a.FormUUID},[v("dt",Rt,h(a.Heading),1),v("dd",Ft,[(a==null?void 0:a.Type)===d(I).FORM_TYPE_DEALER?(e(),l(m,{key:0,to:`/register/${o.convention.Slug||o.convention.ConventionUUID}/dealer`},{default:t(()=>[a!=null&&a.State.Edit&&x.value?(e(),l(c,{key:0,size:"small",variant:"flat",color:"success",class:"ml-2"},{default:t(()=>[n(" Open form ")]),_:1})):(e(),l(c,{key:1,size:"small",variant:"text",color:"warning"},{default:t(()=>[n("View")]),_:1}))]),_:2},1032,["to"])):(a==null?void 0:a.Type)===d(I).FORM_TYPE_BADGE?(e(),l(m,{key:1,to:`/register/${o.convention.Slug||o.convention.ConventionUUID}/badge`},{default:t(()=>[a!=null&&a.State.Edit&&L.value?(e(),l(c,{key:0,size:"small",variant:"flat",color:"success",class:"ml-2"},{default:t(()=>[n(" Open form ")]),_:1})):(e(),l(c,{key:1,size:"small",variant:"text",color:"warning"},{default:t(()=>[n("View")]),_:1}))]),_:2},1032,["to"])):(a==null?void 0:a.Type)===d(I).FORM_TYPE_ADDITIONAL?(e(),l(m,{key:2,to:`/register/${o.convention.Slug||o.convention.ConventionUUID}/additional`},{default:t(()=>[a!=null&&a.State.Edit&&k.value?(e(),l(c,{key:0,size:"small",variant:"flat",color:"success",class:"ml-2"},{default:t(()=>[n(" Open form ")]),_:1})):(e(),l(c,{key:1,size:"small",variant:"text",color:"warning"},{default:t(()=>[n("View")]),_:1}))]),_:2},1032,["to"])):g("",!0)])],64))),128)),((P=s.value)==null?void 0:P.Submissions.length)>0?(e(),r(f,{key:3},[Mt,Nt],64)):g("",!0),(e(!0),r(f,null,H((C=s.value)==null?void 0:C.Submissions,(a,N)=>{var q,ue,ce,de,me;return e(),r(f,{key:a.SubmissionUUID},[a.Form?(e(),r(f,{key:0},[a.Form?(e(),r("dt",$t,h(a.Form.Heading),1)):g("",!0),a.Form?(e(),r("dd",Yt,[u(bt,{modelValue:M.value[N],"onUpdate:modelValue":b=>M.value[N]=b},{activator:t(({props:b})=>[u(c,ae(b,{color:"blue-darken-2",icon:"mdi:mdi-information",variant:"text",size:"xs",onClick:Zt=>M.value[N]=!M.value[N]}),null,16,["onClick"])]),default:t(()=>[a.Status===d($).SUBMISSION_STATUS_NULL?(e(),r(f,{key:0},[n(" There is an error with your submission, please contact the registration team for support. ")],64)):a.Status===d($).SUBMISSION_STATUS_INCOMPLETE?(e(),r(f,{key:1},[n(" Something is missing on your submission which requires completing to be able to process your request. Please contact the registration team for further advice. ")],64)):a.Status===d($).SUBMISSION_STATUS_OPEN?(e(),r(f,{key:2},[n(" Your submission has been received by our system but you may still make changes before the registration team begins processing it. ")],64)):a.Status===d($).SUBMISSION_STATUS_LOCKED?(e(),r(f,{key:3},[n(" We have locked your submission to prevent further changes whilst we process it. If you need to change something please get in touch. ")],64)):a.Status===d($).SUBMISSION_STATUS_ACCEPTED?(e(),r(f,{key:4},[n(" We have locked your submission to prevent further changes whilst we process it. If you need to change something please get in touch. ")],64)):a.Status===d($).SUBMISSION_STATUS_COMPLETED?(e(),r(f,{key:5},[n(" Congratulations everything is complete. If you need to make changes please get in touch. ")],64)):a.Status===d($).SUBMISSION_STATUS_REJECTED?(e(),r(f,{key:6},[n(" Your request has been rejected. The registration team will provide an explanation. ")],64)):a.Status===d($).SUBMISSION_STATUS_INVALID?(e(),r(f,{key:7},[n(" Your request has been identified as having errors or being incomplete. Please contact the registration team for additional support. ")],64)):a.Status===d($).SUBMISSION_STATUS_CANCELLED?(e(),r(f,{key:8},[n(" Your submission has been cancelled. This may be at your request or another reason. The registration team will be able to provide further details. ")],64)):(e(),r(f,{key:9},[n(" Please contact the registration team for support. ")],64))]),_:2},1032,["modelValue","onUpdate:modelValue"]),n(" "+h(d(Ve)(a.Status))+" ",1),((q=a.Form)==null?void 0:q.Type)===d(I).FORM_TYPE_REGISTRATION?(e(),l(m,{key:0,to:`/register/${o.convention.Slug||o.convention.ConventionUUID}/registration`},{default:t(()=>{var b;return[(b=a.Form)!=null&&b.State.Edit&&z.value?(e(),l(c,{key:0,size:"small",variant:"text",color:"success"},{default:t(()=>[n(" Edit ")]),_:1})):(e(),l(c,{key:1,size:"small",variant:"text",color:"warning"},{default:t(()=>[n("View")]),_:1}))]}),_:2},1032,["to"])):((ue=a.Form)==null?void 0:ue.Type)===d(I).FORM_TYPE_ACCOMMODATION?(e(),l(m,{key:1,to:`/register/${o.convention.Slug||o.convention.ConventionUUID}/accommodation`},{default:t(()=>{var b;return[(b=a.Form)!=null&&b.State.Edit&&G.value?(e(),l(c,{key:0,size:"small",variant:"text",color:"success"},{default:t(()=>[n(" Edit ")]),_:1})):(e(),l(c,{key:1,size:"small",variant:"text",color:"warning"},{default:t(()=>[n("View")]),_:1}))]}),_:2},1032,["to"])):((ce=a.Form)==null?void 0:ce.Type)===d(I).FORM_TYPE_DEALER?(e(),l(m,{key:2,to:`/register/${o.convention.Slug||o.convention.ConventionUUID}/dealer`},{default:t(()=>{var b;return[(b=a.Form)!=null&&b.State.Edit&&x.value?(e(),l(c,{key:0,size:"small",variant:"text",color:"success"},{default:t(()=>[n(" Edit ")]),_:1})):(e(),l(c,{key:1,size:"small",variant:"text",color:"warning"},{default:t(()=>[n("View")]),_:1}))]}),_:2},1032,["to"])):((de=a.Form)==null?void 0:de.Type)===d(I).FORM_TYPE_BADGE?(e(),l(m,{key:3,to:`/register/${o.convention.Slug||o.convention.ConventionUUID}/badge`},{default:t(()=>{var b;return[(b=a.Form)!=null&&b.State.Edit&&L.value?(e(),l(c,{key:0,size:"small",variant:"text",color:"success"},{default:t(()=>[n(" Edit ")]),_:1})):(e(),l(c,{key:1,size:"small",variant:"text",color:"warning"},{default:t(()=>[n("View")]),_:1}))]}),_:2},1032,["to"])):((me=a.Form)==null?void 0:me.Type)===d(I).FORM_TYPE_ADDITIONAL?(e(),l(m,{key:4,to:`/register/${o.convention.Slug||o.convention.ConventionUUID}/additional`},{default:t(()=>{var b;return[(b=a.Form)!=null&&b.State.Edit&&k.value?(e(),l(c,{key:0,size:"small",variant:"text",color:"success"},{default:t(()=>[n(" Edit ")]),_:1})):(e(),l(c,{key:1,size:"small",variant:"text",color:"warning"},{default:t(()=>[n("View")]),_:1}))]}),_:2},1032,["to"])):g("",!0)])):g("",!0)],64)):g("",!0)],64)}),128)),((R=s.value)==null?void 0:R.Submissions.length)>=1?(e(!0),r(f,{key:4},H(o.forms,a=>{var N;return e(),r(f,{key:a.FormUUID},[!((N=s.value)!=null&&N.Submissions.find(q=>q.FormUUID===a.FormUUID))&&!a.State.Independent?(e(),r(f,{key:0},[v("dt",Lt,h(a.Heading),1),v("dd",zt,[n(" Requires Completion "),a.Type===d(I).FORM_TYPE_REGISTRATION?(e(),l(m,{key:0,to:`/register/${o.convention.Slug||o.convention.ConventionUUID}/registration`},{default:t(()=>[a.State.Edit&&z.value?(e(),l(c,{key:0,size:"small",variant:"text",color:"success"},{default:t(()=>[n(" Edit ")]),_:1})):(e(),l(c,{key:1,size:"small",variant:"text",color:"warning"},{default:t(()=>[n("View")]),_:1}))]),_:2},1032,["to"])):a.Type===d(I).FORM_TYPE_ACCOMMODATION?(e(),l(m,{key:1,to:`/register/${o.convention.Slug||o.convention.ConventionUUID}/accommodation`},{default:t(()=>[a.State.Edit&&G.value?(e(),l(c,{key:0,size:"small",variant:"text",color:"success"},{default:t(()=>[n(" Edit ")]),_:1})):(e(),l(c,{key:1,size:"small",variant:"text",color:"warning"},{default:t(()=>[n("View")]),_:1}))]),_:2},1032,["to"])):a.Type===d(I).FORM_TYPE_DEALER?(e(),l(m,{key:2,to:`/register/${o.convention.Slug||o.convention.ConventionUUID}/dealer`},{default:t(()=>[a.State.Edit&&x.value?(e(),l(c,{key:0,size:"small",variant:"text",color:"success"},{default:t(()=>[n(" Edit ")]),_:1})):(e(),l(c,{key:1,size:"small",variant:"text",color:"warning"},{default:t(()=>[n("View")]),_:1}))]),_:2},1032,["to"])):a.Type===d(I).FORM_TYPE_BADGE?(e(),l(m,{key:3,to:`/register/${o.convention.Slug||o.convention.ConventionUUID}/badge`},{default:t(()=>[a.State.Edit&&L.value?(e(),l(c,{key:0,size:"small",variant:"text",color:"success"},{default:t(()=>[n(" Edit ")]),_:1})):(e(),l(c,{key:1,size:"small",variant:"text",color:"warning"},{default:t(()=>[n("View")]),_:1}))]),_:2},1032,["to"])):a.Type===d(I).FORM_TYPE_ADDITIONAL?(e(),l(m,{key:4,to:`/register/${o.convention.Slug||o.convention.ConventionUUID}/additional`},{default:t(()=>[a.State.Edit&&k.value?(e(),l(c,{key:0,size:"small",variant:"text",color:"success"},{default:t(()=>[n(" Edit ")]),_:1})):(e(),l(c,{key:1,size:"small",variant:"text",color:"warning"},{default:t(()=>[n("View")]),_:1}))]),_:2},1032,["to"])):g("",!0)])],64)):g("",!0)],64)}),128)):g("",!0)])):g("",!0),s.value&&s.value.Submissions.length>=1&&o.forms.filter(a=>{var N;return!a.State.Independent&&!((N=s.value)!=null&&N.Submissions.find(q=>q.FormUUID==a.FormUUID))}).length>0?(e(),r("div",xt,Gt)):g("",!0)]}),_:1}),A.value.length>0?(e(),r(f,{key:0},[u(te,{class:"pb-0"},{default:t(()=>[n("Allocated Accommodation")]),_:1}),u(ye,{class:"text-wrap"},{default:t(()=>[n("The following accommodation has been allocated to your registration. In some cases this may not have been your first choice.")]),_:1}),u(oe,null,{default:t(()=>[u(Xe,{density:"compact"},{default:t(()=>[(e(!0),r(f,null,H(A.value,P=>(e(),l(Ze,{key:P.name},{default:t(()=>[u(et,null,{default:t(()=>[n(h(P.name),1)]),_:2},1024),(e(!0),r(f,null,H(P.periods,C=>(e(),l(tt,{key:C.start},{default:t(()=>[n(" ("+h(d(pe)(C.start))+" - "+h(d(pe)(C.end))+")",1),Ht]),_:2},1024))),128))]),_:2},1024))),128))]),_:1})]),_:1})],64)):g("",!0),w.value&&s.value?(e(),r(f,{key:1},[u(te,{class:"pb-4"},{default:t(()=>[n("Payment Information")]),_:1}),u(oe,null,{default:t(()=>[u(Et,{"payment-transactions":V.value,registration:s.value},null,8,["payment-transactions","registration"])]),_:1})],64)):g("",!0),u(We,null,{default:t(()=>{var P,C;return[o.convention.DetailLink?(e(),l(c,{key:0,color:"orange",href:o.convention.DetailLink},{default:t(()=>[n(h(d(ee).buttonDetails),1)]),_:1},8,["href"])):g("",!0),u(ge),z.value?(e(),r(f,{key:1},[(P=s.value)!=null&&P.Submissions.find(R=>{var a;return((a=R.Form)==null?void 0:a.Type)===d(I).FORM_TYPE_REGISTRATION})?(e(),l(O,{key:1,to:`/register/${o.convention.Slug||o.convention.ConventionUUID}`},{default:t(()=>[u(c,{color:"primary"},{default:t(()=>[n(h(d(ee).buttonViewRegistration),1)]),_:1})]),_:1},8,["to"])):(e(),r(f,{key:0},[(C=o.forms.find(R=>R.Type===d(I).FORM_TYPE_REGISTRATION))!=null&&C.State.New?(e(),l(O,{key:0,to:`/register/${o.convention.Slug||o.convention.ConventionUUID}`},{default:t(()=>[u(c,{color:"primary"},{default:t(()=>[n(h(d(ee).buttonRegister),1)]),_:1})]),_:1},8,["to"])):g("",!0)],64))],64)):w.value&&s.value&&s.value.Total>s.value.Paid?(e(),r(f,{key:2},[u(c,{color:"success",variant:"elevated",onClick:p[0]||(p[0]=R=>Y.value=!0)},{default:t(()=>[n("Make Payment")]),_:1}),s.value?(e(),l(ut,{key:0,"payment-transactions":V.value,registration:s.value,modelValue:Y.value,"onUpdate:modelValue":p[1]||(p[1]=R=>Y.value=R)},null,8,["payment-transactions","registration","modelValue"])):g("",!0)],64)):g("",!0)]}),_:1})]),_:1})}}}),jt=_e(qt,[["__scopeId","data-v-e0f22da7"]]),Wt=W({__name:"Conventions",setup(i){const U=le(),T=D([]),E=D([]);return U.getOpenConventionsList().then(_=>{_&&(T.value=[...T.value,..._],U.getAvailableConventionForms(T.value.map(s=>s.ConventionUUID)).then(s=>{E.value=[...E.value,...s]}).catch(s=>{console.error(s)}))}),(_,s)=>(e(),l(re,null,{default:t(()=>[u(X,{class:"justify-center"},{default:t(()=>[(e(!0),r(f,null,H(T.value,y=>(e(),l(j,{key:y.ConventionUUID,cols:"12",sm:"11",md:"11",lg:"8",xl:"6",class:"d-flex flex-column"},{default:t(()=>[u(jt,{convention:y,forms:E.value.filter(A=>A.ConventionUUID===y.ConventionUUID)},null,8,["convention","forms"])]),_:2},1024))),128))]),_:1})]),_:1}))}}),Kt={};function Jt(i,U){return e(),r("div")}const Qt=_e(Kt,[["render",Jt]]),Xt=W({__name:"MainView",emits:["pageTitle"],setup(i,{emit:U}){U("pageTitle","Scotiacon Registration System"),sessionStorage.getItem("reload")==="true"&&(sessionStorage.removeItem("reload"),setTimeout(()=>{location.reload()},500));const _=localStorage.getItem("gjt_token"),s=localStorage.getItem("ajt_token");_?(localStorage.removeItem("gjt_token"),location.href=_):s&&(localStorage.removeItem("ajt_token"),location.href=s);const y=D(ie());return(A,V)=>{const Y=ne("router-link");return e(),r(f,null,[y.value&&(!y.value.Additional||!y.value.Additional.Email)?(e(),l(re,{key:0,class:"bg-red-darken-4 text-center",fluid:!0},{default:t(()=>[n(" Please enter a Contact Email on the "),u(Y,{to:"/profile",class:"text-white font-weight-bold"},{default:t(()=>[n("manage account page")]),_:1}),n(" to ensure we can contact you. ")]),_:1})):g("",!0),u(Wt),u(Qt)],64)}}}),Po=W({__name:"Home",props:{loggedIn:{type:Boolean}},emits:["pageTitle"],setup(i,{emit:U}){const T=ie(),E=U;return E("pageTitle","Telegram Login"),(_,s)=>(e(),r("div",null,[_.loggedIn&&d(T)?(e(),l(Xt,{key:0,onPageTitle:s[0]||(s[0]=y=>E("pageTitle",y))})):(e(),l(Ce,{key:1}))]))}});export{Po as default};
