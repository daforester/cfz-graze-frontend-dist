import{p as Ot,n as ht,e as se,t as ve,c as ia,G as it,v as t,H as F,x as Re,I as me,a0 as fe,a1 as Pe,r as A,K as Ue,M as m,N as G,O as l,a3 as ye,W as H,a2 as Qe,a4 as le,S as q,w as re,X as k,Q as V,V as C,P as w,_ as Je,ac as sa,ad as ua,E as Ke,k as ra,f as da,d as ma,o as va,ae as Ut,R as ca,Y as bt,Z as Mt,af as fa,ag as He,z as Ua,u as _a,ah as Ta,A as Aa,B as ga,D as Ea,s as Sa,ai as qe,aj as _t,a7 as pa,a6 as ya,U as Ia}from"./index-8cb7e7a0.js";import{e as Da,T as Ra,V as Ca,d as Oa,c as ha}from"./FormRenderer.vue_vue_type_style_index_0_lang-4655200c.js";import{a as ba,F as pe}from"./form-29fd1dbb.js";import{_ as Fe}from"./ModelDialog.vue_vue_type_script_setup_true_lang-bd1106d6.js";import{m as Ma,k as Va,l as ka,n as La,o as Na,p as Pa,q as Fa,u as wa,r as $a,s as Ba,t as xa,v as Ga,w as Ya,x as Ha,y as qa,z as Tt,A as At,B as gt,a as ja,_ as Vt,f as Et,c as kt,d as Lt,e as Nt,b as Pt,V as Ft,g as za,h as Qa,i as Ka,j as Wa}from"./VWindowItem-7202690d.js";import{V as Z,a as L}from"./VRow-4bc07cd5.js";import{V as ce}from"./VTextField-026dca3a.js";import{V as de}from"./copyToClipboard-9537b31e.js";import{u as wt,j as ge,V as Ja,b as Xa,m as Za,k as el,c as tl,d as al,l as ll,a as nl,n as ol}from"./VContainer-bd70b904.js";import{V as $t,u as Xe}from"./VCheckbox-ec3506a1.js";import{v as Ne}from"./v4-a960c1f4.js";import{h as je,b as il,a as sl,c as ul,d as St,P as st,u as Bt}from"./useDisplayTransactions-efa82f1b.js";import{V as ze,a as Be}from"./VList-f07cbd85.js";import{V as K,a as rl,u as dl}from"./VBtn-40af85c7.js";import{b as ml,c as xt,d as pt}from"./submission-6136b51d.js";import{G as Gt}from"./group-d2a77946.js";import{C as Yt}from"./canDo-2c299106.js";import{V as vl}from"./VAvatar-4b143dd0.js";import{s as cl}from"./sortSubmissions-8ed80f07.js";import{V as We,a as fl}from"./scopeId-f9937d33.js";import{_ as ut,V as Ht}from"./SaveButton.vue_vue_type_script_setup_true_lang-546e8776.js";import{V as Ul}from"./VForm-05c55aff.js";import{V as _l,e as rt,c as Tl}from"./VCard-f4b4b0c0.js";import{G as qt}from"./userData-1a647968.js";import{V as Al,a as gl}from"./VAlert-97116f66.js";import{S as El}from"./setupLogin-78879c1f.js";import{V as Sl}from"./forwardRefs-65aa6bd6.js";import{u as nt}from"./nil-d01db1aa.js";import{V as yt,a as pl}from"./VToolbar-6bf20f2b.js";import{V as It,a as yl}from"./VTable-ab6e1378.js";import{V as Il}from"./VDialog-f8fb49d0.js";import"./index-26b71cef.js";import"./VTextarea-e5c0ffbd.js";import"./VChip-2dbf9e53.js";import"./VToolbarItems-0d9b3d5f.js";import"./VDivider-1dc7b284.js";import"./createSimpleFunctional-19d22dc3.js";var jt=(e=>(e.ADMIN_LAYOUT_PANELS="ADMIN_LAYOUT_PANELS",e.ADMIN_LAYOUT_TABLE="ADMIN_LAYOUT_TABLE",e))(jt||{});const Dl=[{title:"Panel Layout",value:"ADMIN_LAYOUT_PANELS"},{title:"Table Layout",value:"ADMIN_LAYOUT_TABLE"}];var xe=(e=>(e.LAYOUT_ITEM_SOURCE_FORM="LAYOUT_ITEM_SOURCE_FORM",e.LAYOUT_ITEM_SOURCE_META="LAYOUT_ITEM_SOURCE_META",e.LAYOUT_ITEM_SOURCE_USER="LAYOUT_ITEM_SOURCE_USER",e))(xe||{});const Rl=[{title:"Form Field Submission Data",value:"LAYOUT_ITEM_SOURCE_FORM"},{title:"Miscellaneous Data",value:"LAYOUT_ITEM_SOURCE_META"},{title:"User Profile Data",value:"LAYOUT_ITEM_SOURCE_USER"}];var W=(e=>(e.META_DATA_SOURCE_ACCOMMODATION_ALLOCATION="META_DATA_SOURCE_ACCOMMODATION_ALLOCATION",e.META_DATA_SOURCE_ACCOMMODATION_FORM="META_DATA_SOURCE_ACCOMMODATION_FORM",e.META_DATA_SOURCE_BADGE_FORM="META_DATA_SOURCE_BADGE_FORM",e.META_DATA_SOURCE_DEALER_FORM="META_DATA_SOURCE_DEALER_FORM",e.META_DATA_SOURCE_PAYMENT_STATUS="META_DATA_SOURCE_PAYMENT_STATUS",e.META_DATA_SOURCE_REGISTRATION_ACTIONS="META_DATA_SOURCE_REGISTRATION_ACTIONS",e.META_DATA_SOURCE_REGISTRATION_FORM="META_DATA_SOURCE_REGISTRATION_FORM",e.META_DATA_SOURCE_REGISTRATION_GROUP="META_DATA_SOURCE_REGISTRATION_GROUP",e.META_DATA_SOURCE_REGISTRATION_REFERENCE="META_DATA_SOURCE_REGISTRATION_REFERENCE",e.META_DATA_SOURCE_SUBMISSION_DATE="META_DATA_SOURCE_SUBMISSION_DATE",e.META_DATA_SOURCE_SUBMISSION_STATUS="META_DATA_SOURCE_SUBMISSION_STATUS",e))(W||{});const Cl=[{title:"Accommodation Allocation",value:"META_DATA_SOURCE_ACCOMMODATION_ALLOCATION"},{title:"Accommodation Form",value:"META_DATA_SOURCE_ACCOMMODATION_FORM"},{title:"Actions",value:"META_DATA_SOURCE_REGISTRATION_ACTIONS"},{title:"Badge Form",value:"META_DATA_SOURCE_BADGE_FORM"},{title:"Dealer Form",value:"META_DATA_SOURCE_DEALER_FORM"},{title:"Payment Status",value:"META_DATA_SOURCE_PAYMENT_STATUS"},{title:"Registration Group",value:"META_DATA_SOURCE_REGISTRATION_GROUP"},{title:"Registration Reference",value:"META_DATA_SOURCE_REGISTRATION_REFERENCE"},{title:"Registration Form",value:"META_DATA_SOURCE_REGISTRATION_FORM"},{title:"Submission Date",value:"META_DATA_SOURCE_SUBMISSION_DATE"},{title:"Submission Status",value:"META_DATA_SOURCE_SUBMISSION_STATUS"}];var ae=(e=>(e.USER_DATA_SOURCE_NULL="",e.USER_DATA_SOURCE_DISPLAY_NAME="USER_DATA_SOURCE_DISPLAY_NAME",e.USER_DATA_SOURCE_HANDLE="USER_DATA_SOURCE_HANDLE",e.USER_DATA_SOURCE_AVATAR="USER_DATA_SOURCE_AVATAR",e.USER_DATA_SOURCE_FIRST_NAME="USER_DATA_SOURCE_FIRST_NAME",e.USER_DATA_SOURCE_LAST_NAME="USER_DATA_SOURCE_LAST_NAME",e.USER_DATA_SOURCE_DATE_OF_BIRTH="USER_DATA_SOURCE_DATE_OF_BIRTH",e.USER_DATA_SOURCE_EMAIL="USER_DATA_SOURCE_EMAIL",e.USER_DATA_SOURCE_TELEGRAM="USER_DATA_SOURCE_TELEGRAM",e))(ae||{});const Ol=[{title:"Display Name",value:"USER_DATA_SOURCE_DISPLAY_NAME"},{title:"Handle",value:"USER_DATA_SOURCE_HANDLE"},{title:"Avatar",value:"USER_DATA_SOURCE_AVATAR"},{title:"First Name",value:"USER_DATA_SOURCE_FIRST_NAME"},{title:"Last Name",value:"USER_DATA_SOURCE_LAST_NAME"},{title:"Date of Birth",value:"USER_DATA_SOURCE_DATE_OF_BIRTH"},{title:"Email Address",value:"USER_DATA_SOURCE_EMAIL"},{title:"Telegram Username",value:"USER_DATA_SOURCE_TELEGRAM"}],hl=e=>{switch(e){case"EMAIL_STATUS_QUEUED":return"Queued";case"EMAIL_STATUS_QUEUE_ERROR":return"Processing";case"EMAIL_STATUS_QUEUE_FAILURE":return"Internal Error";case"EMAIL_STATUS_SENDING":return"Sending";case"EMAIL_STATUS_SENT":return"Sent";case"EMAIL_STATUS_SEND_ERROR":return"Failed to Send"}return"Unknown"},bl=e=>e===void 0?!1:Yt(e,Gt.GROUP_TYPE_SYSTEM).ManageUsers,Ml=Ot({itemsLength:{type:[Number,String],required:!0},...Ma(),...Va(),...ka()},"VDataTableServer"),Vl=ht()({name:"VDataTableServer",props:Ml(),emits:{"update:modelValue":e=>!0,"update:page":e=>!0,"update:itemsPerPage":e=>!0,"update:sortBy":e=>!0,"update:options":e=>!0,"update:expanded":e=>!0,"update:groupBy":e=>!0,"click:row":(e,p)=>!0},setup(e,p){let{emit:i,slots:s}=p;const{groupBy:n}=La(e),{sortBy:r,multiSort:U,mustSort:a}=Na(e),{page:_,itemsPerPage:g}=Pa(e),T=se(()=>parseInt(e.itemsLength,10)),{columns:S,headers:d}=Fa(e,{groupBy:n,showSelect:ve(e,"showSelect"),showExpand:ve(e,"showExpand")}),{items:f}=wa(e,S),{toggleSort:E}=$a({sortBy:r,multiSort:U,mustSort:a,page:_}),{opened:$,isGroupOpen:y,toggleGroup:D,extractRows:b}=Ba({groupBy:n,sortBy:r}),{pageCount:M,setItemsPerPage:X}=xa({page:_,itemsPerPage:g,itemsLength:T}),{flatItems:j}=Ga(f,n,$),{isSelected:oe,select:J,selectAll:u,toggleSelect:c,someSelected:h,allSelected:R}=Ya(e,{allItems:f,currentPage:f}),{isExpanded:N,toggleExpand:Q}=Ha(e),ie=se(()=>b(f.value));qa({page:_,itemsPerPage:g,sortBy:r,groupBy:n,search:ve(e,"search")}),ia("v-data-table",{toggleSort:E,sortBy:r}),it({VDataTableRows:{hideNoData:ve(e,"hideNoData"),noDataText:ve(e,"noDataText"),loading:ve(e,"loading"),loadingText:ve(e,"loadingText")}});const ee=se(()=>({page:_.value,itemsPerPage:g.value,sortBy:r.value,pageCount:M.value,toggleSort:E,setItemsPerPage:X,someSelected:h.value,allSelected:R.value,isSelected:oe,select:J,selectAll:u,toggleSelect:c,isExpanded:N,toggleExpand:Q,isGroupOpen:y,toggleGroup:D,items:ie.value,groupedItems:j.value,columns:S.value,headers:d.value}));wt(()=>{const[be]=Tt.filterProps(e),[Me]=At.filterProps(e),[Ve]=gt.filterProps(e),[_e]=It.filterProps(e);return t(It,Re({class:["v-data-table",{"v-data-table--loading":e.loading},e.class],style:e.style},_e),{top:()=>{var ne;return(ne=s.top)==null?void 0:ne.call(s,ee.value)},default:()=>{var ne,Ie,De,Ce;return s.default?s.default(ee.value):t(F,null,[(ne=s.colgroup)==null?void 0:ne.call(s,ee.value),t("thead",{class:"v-data-table__thead",role:"rowgroup"},[t(At,Re(Me,{sticky:e.fixedHeader}),s)]),(Ie=s.thead)==null?void 0:Ie.call(s,ee.value),t("tbody",{class:"v-data-table__tbody",role:"rowgroup"},[s.body?s.body(ee.value):t(gt,Re(Ve,{items:j.value}),s)]),(De=s.tbody)==null?void 0:De.call(s,ee.value),(Ce=s.tfoot)==null?void 0:Ce.call(s,ee.value)])},bottom:()=>s.bottom?s.bottom(ee.value):t(Tt,be,{prepend:s["footer.prepend"]})})})}}),kl=me({__name:"EditAdminLayout",props:fe({title:{default:""},layout:{}},{modelValue:{type:Boolean,required:!0}}),emits:fe(["save"],["update:modelValue"]),setup(e,{emit:p}){const i=Pe(e,"modelValue"),s=A(Ue(e.layout)),n=A([]),r=ye(),U=({callback:T})=>{const S=()=>{T&&T("Failed to Save Layout")},d=()=>{T&&T("Layout Saved")};r.saveAdminLayout(s.value).then(f=>{f?(d(),p("save",f)):S()}).catch(()=>{S()})},a=()=>({ID:0,LayoutPanelUUID:Ne(),AdminLayoutID:s.value.ID,AdminLayoutUUID:s.value.AdminLayoutUUID,Name:"",Order:s.value.Panels.length+1,Items:[],RequiredFormType:pe.FORM_TYPE_NIL,RequiredGroupMemberships:[],RequiredRegistrationTags:[]}),_=T=>()=>({ID:0,LayoutItemUUID:Ne(),LayoutPanelID:T.ID,LayoutPanelUUID:T.LayoutPanelUUID,Label:"",SourceType:xe.LAYOUT_ITEM_SOURCE_FORM,SectionFieldID:void 0,SectionFieldUUID:void 0,SectionField:void 0,MetaField:void 0,UserField:void 0,Align:"",Order:T.Items.length+1,DefaultSort:!1}),g=T=>{const S=n.value.find(d=>d.value===T.SectionFieldUUID);S&&(T.SectionFieldID=S.object.ID,T.SectionField=S.object)};return r.getConventionForms(e.layout.ConventionUUID).then(T=>{T.forEach(S=>S.Sections.forEach(d=>d.Fields&&n.value.push(...d.Fields.map(f=>{var $;return{title:`${S.Name} - ${d.Name} - ${($=f.Field)==null?void 0:$.Name}`,value:f.SectionFieldUUID,object:f}})))),n.value.sort(Da("title"))}),(T,S)=>(m(),G(Fe,{modelValue:i.value,"onUpdate:modelValue":S[3]||(S[3]=d=>i.value=d),onSave:U,title:T.title,color:"primary",fullscreen:!0,persistent:!0},{default:l(()=>[t(ge,{class:"px-0 mx-0",fluid:!0},{default:l(()=>[t(Z,null,{default:l(()=>[t(L,{cols:"12",sm:"6"},{default:l(()=>[t(ce,{modelValue:s.value.Name,"onUpdate:modelValue":S[0]||(S[0]=d=>s.value.Name=d),label:"Name",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),t(L,{cols:"12",sm:"6"},{default:l(()=>[t(de,{modelValue:s.value.Type,"onUpdate:modelValue":S[1]||(S[1]=d=>s.value.Type=d),label:"Layout Type",items:H(Dl),"item-title":"title","item-value":"value",variant:"outlined","hide-details":""},null,8,["modelValue","items"])]),_:1})]),_:1})]),_:1}),t(Et,{modelValue:s.value.Panels,"onUpdate:modelValue":S[2]||(S[2]=d=>s.value.Panels=d),"new-item":a,closeable:!1,title:"Panels",label:"Name","slot-name-prefix":"panel"},Qe({_:2},[le(s.value.Panels,(d,f)=>({name:`panel_${f}`,fn:l(()=>[t(ge,{class:"px-0 mx-0",fluid:!0},{default:l(()=>[t(Z,null,{default:l(()=>[t(L,{cols:"12",sm:"6"},{default:l(()=>[t(ce,{modelValue:d.Name,"onUpdate:modelValue":E=>d.Name=E,label:"Name",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),t(L,{cols:"12",sm:"6"},{default:l(()=>[t(de,{modelValue:d.RequiredFormType,"onUpdate:modelValue":E=>d.RequiredFormType=E,items:H(ba),clearable:!0,label:"Required Form",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"])]),_:2},1024)]),_:2},1024),t(Z,null,{default:l(()=>[t(L,{cols:"12",sm:"6"},{default:l(()=>[t(ja,{label:"Required Groups",variant:"outlined",modelValue:d.RequiredGroupMemberships,"onUpdate:modelValue":E=>d.RequiredGroupMemberships=E,convention:s.value.ConventionUUID,chips:"",clearable:"",hint:"Groups that a user must be in to see this form. (Any one)"},null,8,["modelValue","onUpdate:modelValue","convention"])]),_:2},1024),t(L,{cols:"12",sm:"6"},{default:l(()=>[t(Vt,{label:"Registration Tags",variant:"outlined",modelValue:d.RequiredRegistrationTags,"onUpdate:modelValue":E=>d.RequiredRegistrationTags=E,convention:s.value.ConventionUUID,chips:"",clearable:"",hint:"Tags that a registration must have to appear in results. (Any one)"},null,8,["modelValue","onUpdate:modelValue","convention"])]),_:2},1024)]),_:2},1024)]),_:2},1024),t(Et,{modelValue:d.Items,"onUpdate:modelValue":E=>d.Items=E,"new-item":_(d),closeable:!1,title:"Items",label:"Label","slot-name-prefix":"item"},Qe({_:2},[le(d.Items,(E,$)=>({name:`item_${$}`,fn:l(()=>[t(ge,{class:"px-0 mx-0",fluid:!0},{default:l(()=>[t(Z,null,{default:l(()=>[t(L,{cols:"12",sm:"6"},{default:l(()=>[t(ce,{modelValue:E.Label,"onUpdate:modelValue":y=>E.Label=y,label:"Name",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024),t(Z,null,{default:l(()=>[t(L,{cols:"12",sm:"6"},{default:l(()=>[t(de,{modelValue:E.SourceType,"onUpdate:modelValue":y=>E.SourceType=y,label:"Source Type",items:H(Rl),"item-title":"title","item-value":"value",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"])]),_:2},1024),t(L,{cols:"12",sm:"6"},{default:l(()=>[E.SourceType==="LAYOUT_ITEM_SOURCE_FORM"?(m(),G(de,{key:0,modelValue:E.SectionFieldUUID,"onUpdate:modelValue":y=>E.SectionFieldUUID=y,label:"Form Data",items:n.value,"item-title":"title","item-value":"value",variant:"outlined","hide-details":"",onBlur:y=>g(E)},null,8,["modelValue","onUpdate:modelValue","items","onBlur"])):E.SourceType==="LAYOUT_ITEM_SOURCE_META"?(m(),G(de,{key:1,modelValue:E.MetaField,"onUpdate:modelValue":y=>E.MetaField=y,label:"Miscellaneous Data",items:H(Cl),"item-title":"title","item-value":"value",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"])):E.SourceType==="LAYOUT_ITEM_SOURCE_USER"?(m(),G(de,{key:2,modelValue:E.UserField,"onUpdate:modelValue":y=>E.UserField=y,label:"User Profile Data",items:H(Ol),"item-title":"title","item-value":"value",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"])):q("",!0)]),_:2},1024)]),_:2},1024),t(Z,null,{default:l(()=>[t(L,null,{default:l(()=>[t($t,{modelValue:E.DefaultSort,"onUpdate:modelValue":y=>E.DefaultSort=y,label:"Default Sort","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)]),_:2},1024)])}))]),1032,["modelValue","onUpdate:modelValue","new-item"])])}))]),1032,["modelValue"])]),_:1},8,["modelValue","title"]))}}),Ll=k("br",null,null,-1),Nl=k("h3",null,"Assigned Accommodation",-1),Pl=k("br",null,null,-1),Fl=k("br",null,null,-1),wl=k("h3",null,"Accommodation Preferences",-1),$l=k("h3",null,"Selected Tickets",-1),Bl=k("br",null,null,-1),xl=me({__name:"EditAccommodationAssignmentDialog",props:fe({convention:{},registration:{},selectedAccommodation:{},title:{}},{modelValue:{type:Boolean,required:!0}}),emits:fe(["update:field"],["update:modelValue"]),setup(e,{emit:p}){const i=e,{convention:s,registration:n,title:r=""}=i,U=ye(),a=Pe(e,"modelValue"),_=A({capacity:{max:u=>{var R;const c=M.value.find(N=>N.room.RoomUUID===u);return!c||c.room.MaximumCapacity===0?!0:(((R=d.value)==null?void 0:R.Members.length)||0)<=c.room.MaximumCapacity||"Too many people in the group for this room"},min:u=>{var R;const c=M.value.find(N=>N.room.RoomUUID===u);return!c||c.room.MinimumCapacity===0?!0:(((R=d.value)==null?void 0:R.Members.length)||0)>=c.room.MinimumCapacity||"Not enough people in the group for this room"}}}),g=A([]),T=Xe(i,p,void 0,void 0,"field"),S=A(Ue(T.value));re(T,()=>{S.value=Ue(T.value)});const d=A(),f=A(""),E=A(""),$=A([]),y=A({Ticket:[],AddonsChecked:[],ComponentsChecked:[]}),D=async()=>{var R;const u=await U.getConventionAvailableAccommodation(s.ConventionUUID);u&&(g.value=u);const c=await U.getRegistrationGroup(n.RegistrationUUID||"");c&&(d.value=c);const h=await U.getConventionTickets(s.ConventionUUID);h&&($.value=h);try{y.value=JSON.parse(((R=d.value)==null?void 0:R.TicketData)||"")}catch{}};re(f,()=>{E.value=M.value.length>0?M.value[0].value:""});const b=se(()=>{const u=X.value;return g.value.map(c=>{let h;return u.forEach(R=>{c.Costs.forEach(N=>{N.DateStart===(R==null?void 0:R.DateStart)&&N.DateEnd===R.DateEnd&&(h===void 0||h>N.Availability)&&(h=N.Availability)})}),{label:`${c.Name}`,title:`${c.Name} (${h} Available)`,value:c.AccommodationUUID}})}),M=se(()=>{const u=X.value,c=g.value.find(h=>h.AccommodationUUID===f.value);return(c==null?void 0:c.Pool.map(h=>{var N,Q;let R;return u.forEach(ie=>{h.Costs.forEach(ee=>{ee.DateStart===(ie==null?void 0:ie.DateStart)&&ee.DateEnd===ie.DateEnd&&(R===void 0||R>ee.Availability)&&(R=ee.Availability)})}),{label:`${(N=h.Venue)==null?void 0:N.Name} - ${h.Name}`,title:`${(Q=h.Venue)==null?void 0:Q.Name} - ${h.Name} (${R} Available)`,value:h.RoomUUID,room:h}}))||[]}),X=se(()=>[...y.value.Ticket,...y.value.AddonsChecked,...y.value.ComponentsChecked].map(u=>$.value.find(c=>c.TicketUUID===u)).filter(u=>u!==void 0&&u.RequiresAccommodation)),j=u=>{var c;U.assignAccommodation(((c=d.value)==null?void 0:c.Registration.RegistrationUUID)||"",f.value,E.value,!1).then(h=>{h?(D(),u&&u("Room Assigned")):u&&u("Room not assigned")}).catch(()=>{u&&u("Room not assigned")})},oe=u=>{var c,h;(c=d.value)!=null&&c.Registration.AllocationUUID?U.deleteAllocation(((h=d.value)==null?void 0:h.Registration.AllocationUUID)||"").then(R=>{R?(D(),u&&u("Allocation Deleted")):u&&u("Allocation not deleted")}).catch(()=>{u&&u("Allocation not deleted")}):u&&u("Nothing to Delete")},J=u=>{var h,R;const c=(h=g.value.find(N=>N.AccommodationUUID===u.AccommodationUUID))==null?void 0:h.Pool;if(c){const N=c.find(Q=>Q.RoomUUID===u.RoomUUID);if(N)return`${(R=N.Venue)==null?void 0:R.Name} - ${N.Name}`}return""};return D(),(u,c)=>{var h;return m(),G(Fe,{modelValue:a.value,"onUpdate:modelValue":c[2]||(c[2]=R=>a.value=R),title:H(r),color:"primary","show-close-action":!0,"show-delete-action":!!((h=d.value)!=null&&h.Registration.Allocation),"show-save-action":!!E.value,"save-button-label":"Assign Room",onDelete:oe,onSave:j,fullscreen:!0,persistent:!0},{default:l(()=>[t(ge,{class:"pa-0",fluid:!0},{default:l(()=>[t(Z,null,{default:l(()=>{var R;return[t(L,{cols:"12",md:"6"},{default:l(()=>{var N,Q;return[k("h3",null,"Group Members ("+V((N=d.value)==null?void 0:N.Members.length)+")",1),(m(!0),C(F,null,le((Q=d.value)==null?void 0:Q.Members,ie=>(m(),C(F,{key:ie.UUID},[w(" #"+V(ie.Reference)+" "+V(ie.Name),1),Ll],64))),128))]}),_:1}),(R=d.value)!=null&&R.Registration.Allocation?(m(),G(L,{key:0,cols:"12",md:"6"},{default:l(()=>[Nl,t(ze,null,{default:l(()=>{var N;return[(m(!0),C(F,null,le((N=d.value)==null?void 0:N.Registration.Allocation.Periods,Q=>(m(),G(Be,{key:Q.AllocationPeriodUUID},{default:l(()=>{var ie;return[w(V((ie=g.value.find(ee=>ee.AccommodationUUID===Q.AccommodationUUID))==null?void 0:ie.Name)+" ",1),Pl,w(" "+V(J(Q))+" ",1),Fl,k("small",null,"("+V(H(je)(Q.DateStart))+" - "+V(H(je)(Q.DateEnd))+")",1)]}),_:2},1024))),128))]}),_:1})]),_:1})):q("",!0)]}),_:1}),t(Z,null,{default:l(()=>[t(L,{cols:"12",md:"6"},{default:l(()=>[u.selectedAccommodation.length?(m(),C(F,{key:0},[wl,t(ze,null,{default:l(()=>[(m(!0),C(F,null,le(u.selectedAccommodation,(R,N)=>(m(),G(Be,{key:R.AccommodationUUID},{default:l(()=>[w(V(N+1)+". "+V(R.Name),1)]),_:2},1024))),128))]),_:1})],64)):q("",!0)]),_:1}),t(L,{cosl:"12",md:"6"},{default:l(()=>[$l,t(ze,null,{default:l(()=>[(m(!0),C(F,null,le(X.value,R=>(m(),G(Be,{key:R==null?void 0:R.TicketUUID},{default:l(()=>[w(V(R.Name)+" ",1),Bl,k("small",null,"("+V(H(je)(R.DateStart))+" - "+V(H(je)(R.DateEnd))+")",1)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1}),t(Z,null,{default:l(()=>[t(L,{cols:"12",md:"6"},{default:l(()=>[t(de,{modelValue:f.value,"onUpdate:modelValue":c[0]||(c[0]=R=>f.value=R),items:b.value,"item-title":"title","item-value":"value",label:"Accommodation"},null,8,["modelValue","items"])]),_:1}),t(L,{cols:"12",md:"6"},{default:l(()=>[t(de,{modelValue:E.value,"onUpdate:modelValue":c[1]||(c[1]=R=>E.value=R),items:M.value,"item-title":"title","item-value":"value",label:"Room Pool",rules:[_.value.capacity.min,_.value.capacity.max]},null,8,["modelValue","items","rules"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue","title","show-delete-action","show-save-action"])}}}),Gl={key:0,class:"accommodationList"},Yl={key:0,class:"text-orange-darken-2"},Hl=me({__name:"DataTableItemAccommodation",props:{accommodations:{default:()=>[]},convention:{},forms:{},registration:{},tickets:{default:()=>[]},value:{default:""},venues:{}},setup(e){const p=A(!1),i=se(()=>{if(!e.value)return[];const n=JSON.parse(e.value),r=e.accommodations.filter(U=>n.includes(U.AccommodationUUID)).sort((U,a)=>{const _=n.findIndex(T=>T===U.AccommodationUUID),g=n.findIndex(T=>T===a.AccommodationUUID);return _>g?1:-1});return Ue(r)}),s=se(()=>{let n;const r=e.forms.find(U=>U.Sections.find(a=>{var _;return(_=a.Fields)==null?void 0:_.find(g=>{var T;if(((T=g.Field)==null?void 0:T.Type)==="TICKET")return n=g,!0})}));return n?!!e.registration.Submissions.find(U=>{if(U.FormUUID==(r==null?void 0:r.FormUUID))return U.Data.find(a=>{if(a.SectionFieldUUID==(n==null?void 0:n.SectionFieldUUID)){const _=JSON.parse(a.Data);return e.tickets.filter(g=>g.RequiresAccommodation).find(g=>_.Ticket.includes(g.TicketUUID)||_.AddonsChecked.includes(g.TicketUUID)||_.ComponentsChecked.includes(g.TicketUUID))}})}):!1});return(n,r)=>s.value?(m(),C(F,{key:0},[n.value?(m(),C("ol",Gl,[(m(!0),C(F,null,le(i.value,U=>(m(),C("li",{key:U.AccommodationUUID},[n.registration&&n.registration.Allocation&&n.registration.Allocation.Periods.find(a=>a.AccommodationUUID===U.AccommodationUUID)?(m(),C("strong",Yl,V(U.Name),1)):(m(),C(F,{key:1},[w(V(U.Name),1)],64))]))),128))])):q("",!0),t(K,{onClick:r[0]||(r[0]=U=>p.value=!0),variant:"flat",color:"success"},{default:l(()=>[w("Assign Accommodation")]),_:1}),n.convention&&p.value?(m(),G(xl,{key:1,modelValue:p.value,"onUpdate:modelValue":r[1]||(r[1]=U=>p.value=U),title:"Accommodation Allocation",convention:n.convention,registration:n.registration,"selected-accommodation":i.value},null,8,["modelValue","convention","registration","selected-accommodation"])):q("",!0)],64)):q("",!0)}});const ql=Je(Hl,[["__scopeId","data-v-7a102d46"]]),jl={key:0,class:"addonList"},zl={key:0},Ql={key:0},Kl=me({__name:"DataTableItemExtras",props:{extras:{default:()=>[]},value:{default:""}},setup(e){const p=se(()=>{if(!e.value)return;const i=JSON.parse(e.value),s=Object.keys(i),n=Ue(e.extras);return n.forEach(r=>{r.Options=r.Options.filter(U=>s.includes(U.OptionUUID)?(U.Choices=U.Choices.filter(a=>a.TagUUID===i[U.OptionUUID].choiceId),i[U.OptionUUID].checked):!1)}),n.filter(r=>r.Options.length>0),n});return(i,s)=>i.value?(m(),C("ul",jl,[(m(!0),C(F,null,le(p.value,n=>(m(),C(F,{key:n.ExtraUUID},[n.Options.length?(m(),C("li",zl,[k("strong",null,V(n.Name),1),k("ul",null,[(m(!0),C(F,null,le(n.Options,r=>(m(),C("li",{key:r.OptionUUID},[w(V(r.Name)+" ",1),r.Choices.length==1?(m(),C("small",Ql,"("+V(r.Choices[0].Title)+")",1)):q("",!0)]))),128))])])):q("",!0)],64))),128))])):q("",!0)}});const Wl=Je(Kl,[["__scopeId","data-v-55786e01"]]),Jl={key:0},Xl=me({__name:"DataTableItemInterests",props:{interests:{default:()=>[]},value:{default:""}},setup(e){const p=se(()=>{if(!e.value)return;const i=JSON.parse(e.value);return Object.entries(i).filter(([,s])=>s).map(([s,n])=>e.interests.find(r=>r.InterestUUID===s)).filter(s=>s!==void 0)});return(i,s)=>i.value?(m(),C("ul",Jl,[(m(!0),C(F,null,le(p.value,n=>(m(),C("li",{key:n.InterestUUID},V(n.Name),1))),128))])):q("",!0)}}),Zl=k("br",null,null,-1),en=k("small",null,"Options:",-1),tn=k("br",null,null,-1),an=k("small",null,"Addons:",-1),ln=me({__name:"DataTableItemTicket",props:{tickets:{default:()=>[]},value:{default:""}},setup(e){const p=se(()=>{if(!e.value)return;let i={Ticket:[],AddonsChecked:[],ComponentsChecked:[]};try{i=JSON.parse(e.value),"ticket"in i&&(i.Ticket=i.ticket),"addonsChecked"in i&&(i.AddonsChecked=i.addonsChecked),"componentsChecked"in i&&(i.ComponentsChecked=i.componentsChecked)}catch{}return i.Ticket.filter(s=>{const n=e.tickets.find(r=>r.TicketUUID===s);return!(!n||n.Type!==Ra.TICKET_TYPE_TICKET)}).map(s=>{const n=e.tickets.find(U=>U.TicketUUID===s),r=Ue(n);return r.TicketComponents=n.TicketComponents.filter(U=>i.ComponentsChecked.includes(U.TicketUUID)),r.AddonTickets=n.AddonTickets.filter(U=>i.AddonsChecked.includes(U.TicketUUID)),r})});return(i,s)=>i.value?(m(!0),C(F,{key:0},le(p.value,n=>(m(),C("div",{key:n.TicketUUID},[k("strong",null,V(n.Name),1),n.TicketComponents.length>0?(m(),C(F,{key:0},[Zl,en,w("  "),(m(!0),C(F,null,le(n.TicketComponents,r=>(m(),C(F,{key:r.TicketUUID},[k("small",null,V(r.Name),1),w("  ")],64))),128))],64)):q("",!0),n.AddonTickets.length>0?(m(),C(F,{key:1},[tn,an,w("  "),(m(!0),C(F,null,le(n.AddonTickets,r=>(m(),C("small",{key:r.TicketUUID},[w("("),k("em",null,V(r.Name),1),w(")")]))),128))],64)):q("",!0)]))),128)):q("",!0)}}),nn={key:0,class:"text-blue text-center"},on={key:1,class:"text-red text-center"},sn={key:2,class:"text-orange text-center"},un={key:3,class:"text-orange text-center"},rn={key:4,class:"text-orange text-center"},dn={key:5,class:"text-orange text-center"},mn={key:6,class:"text-green text-center"},vn={key:0},cn={key:0},fn=k("strong",null,"Total:",-1),Un=me({__name:"RegListRow",props:{header:{},accommodations:{},convention:{},extras:{},forms:{},item:{},interests:{},tickets:{},user:{},venues:{}},emits:["openActions","openPayments","openTags","reload","showForm","switchUser"],setup(e,{emit:p}){const i=(a,_,g)=>{p("showForm",{registration:a,form:_,submission:g})},s=a=>{p("openActions",a)},n=a=>{p("openPayments",a)},r=a=>{p("openTags",a)},U=a=>{p("switchUser",a)};return(a,_)=>a.header.type==="ACCOMMODATION"&&a.accommodations.length>0&&a.item.raw[a.header.key]?(m(),G(ql,{key:0,value:a.item.raw[a.header.key].Data,accommodations:a.accommodations,convention:a.convention,forms:a.forms,tickets:a.tickets,venues:a.venues,registration:a.item.raw[a.header.key].Registration},null,8,["value","accommodations","convention","forms","tickets","venues","registration"])):a.header.type==="EXTRAS"&&a.extras.length>0?(m(),G(Wl,{key:1,value:a.item.raw[a.header.key],extras:a.extras},null,8,["value","extras"])):a.header.type==="INTERESTS"&&a.interests.length>0?(m(),G(Xl,{key:2,value:a.item.raw[a.header.key],interests:a.interests},null,8,["value","interests"])):a.header.type==="TICKET"&&a.tickets.length>0?(m(),G(ln,{key:3,value:a.item.raw[a.header.key],tickets:a.tickets},null,8,["value","tickets"])):a.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_SUBMISSION_STATUS"||a.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_ACCOMMODATION_FORM"||a.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_DEALER_FORM"||a.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_BADGE_FORM"||a.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_REGISTRATION_FORM"?(m(!0),C(F,{key:4},le(a.item.raw[a.header.key],g=>(m(),C("ul",{key:g.Heading},[k("li",null,[k("strong",null,V(g.Heading)+": ",1),k("span",{class:sa(H(ml)(g.Submission.Status))},V(H(xt)(g.Submission.Status)),3),t(K,{icon:"mdi:mdi-form-select",title:"Edit Submitted Data",variant:"flat",onClick:T=>i(g.Registration,g.Form,g.Submission)},null,8,["onClick"])])]))),128)):a.header.type==="LAYOUT_ITEM_SOURCE_USER.USER_DATA_SOURCE_AVATAR"?(m(),G(vl,{key:5,class:"rounded-circle",src:a.item.raw[a.header.key],height:"32",width:"32"},null,8,["src"])):a.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_PAYMENT_STATUS"?(m(),C(F,{key:6},[a.item.raw[a.header.key]=="NOT_REQUIRED"?(m(),C("div",nn,"No Payment Requested")):a.item.raw[a.header.key]=="MISSING_REQUIRED"?(m(),C("div",on,"Partner Payment Not Requested")):a.item.raw[a.header.key]=="AWAITING_PARTNER"?(m(),C("div",sn,"Awaiting Partner Payment")):a.item.raw[a.header.key]=="ALL_REQUIRED"?(m(),C("div",un,"Awaiting Payments")):a.item.raw[a.header.key]=="REQUIRED"?(m(),C("div",rn,"Awaiting Payment")):a.item.raw[a.header.key]=="ADDITIONAL_REQUIRED"?(m(),C("div",dn,"Awaiting Additional Payments")):(m(),C("div",mn,"Completed"))],64)):a.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_REGISTRATION_ACTIONS"?(m(),C(F,{key:7},[t(K,{icon:"mdi:mdi-email-fast",variant:"flat",onClick:_[0]||(_[0]=g=>s(a.item.raw[a.header.key]))}),t(K,{icon:"mdi:mdi-cash-multiple",variant:"flat",onClick:_[1]||(_[1]=g=>n(a.item.raw[a.header.key]))}),t(K,{icon:"mdi:mdi-tag-text",variant:"flat",onClick:_[2]||(_[2]=g=>r(a.item.raw[a.header.key]))}),H(bl)(a.user)?(m(),G(K,{key:0,icon:"mdi:mdi-account-switch-outline",variant:"flat",onClick:_[3]||(_[3]=g=>U(a.item.raw[a.header.key]))})):q("",!0)],64)):a.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_REGISTRATION_GROUP"?(m(),C(F,{key:8},[a.item.raw[a.header.key].length===1?(m(),C("em",vn," Not in a group ")):(m(),C(F,{key:1},[k("ul",null,[(m(!0),C(F,null,le(a.item.raw[a.header.key],g=>(m(),C("li",{key:g.UUID,class:"ml-0"},[w(" #"+V(g.Reference)+" : "+V(g.Name)+" ",1),g.IsLeader?(m(),C("strong",cn,"(Leader)")):q("",!0)]))),128))]),fn,w(" "+V(a.item.raw[a.header.key].length),1)],64))],64)):(m(),C(F,{key:9},[w(V(a.item.raw[a.header.key]),1)],64))}});var _n=["onActivate","onAddUndo","onBeforeAddUndo","onBeforeExecCommand","onBeforeGetContent","onBeforeRenderUI","onBeforeSetContent","onBeforePaste","onBlur","onChange","onClearUndos","onClick","onContextMenu","onCopy","onCut","onDblclick","onDeactivate","onDirty","onDrag","onDragDrop","onDragEnd","onDragGesture","onDragOver","onDrop","onExecCommand","onFocus","onFocusIn","onFocusOut","onGetContent","onHide","onInit","onKeyDown","onKeyPress","onKeyUp","onLoadContent","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp","onNodeChange","onObjectResizeStart","onObjectResized","onObjectSelected","onPaste","onPostProcess","onPostRender","onPreProcess","onProgressState","onRedo","onRemove","onReset","onSaveContent","onSelectionChange","onSetAttrib","onSetContent","onShow","onSubmit","onUndo","onVisualAid"],Tn=function(e){return _n.map(function(p){return p.toLowerCase()}).indexOf(e.toLowerCase())!==-1},An=function(e,p,i){Object.keys(p).filter(Tn).forEach(function(s){var n=p[s];typeof n=="function"&&(s==="onInit"?n(e,i):i.on(s.substring(2),function(r){return n(r,i)}))})},gn=function(e,p,i,s){var n=e.modelEvents?e.modelEvents:null,r=Array.isArray(n)?n.join(" "):n;re(s,function(U,a){i&&typeof U=="string"&&U!==a&&U!==i.getContent({format:e.outputFormat})&&i.setContent(U)}),i.on(r||"change input undo redo",function(){p.emit("update:modelValue",i.getContent({format:e.outputFormat}))})},En=function(e,p,i,s,n,r){s.setContent(r()),i.attrs["onUpdate:modelValue"]&&gn(p,i,s,n),An(e,i.attrs,s)},Dt=0,zt=function(e){var p=Date.now(),i=Math.floor(Math.random()*1e9);return Dt++,e+"_"+i+Dt+String(p)},Sn=function(e){return e!==null&&e.tagName.toLowerCase()==="textarea"},Rt=function(e){return typeof e>"u"||e===""?[]:Array.isArray(e)?e:e.split(" ")},pn=function(e,p){return Rt(e).concat(Rt(p))},yn=function(e){return e==null},Ct=function(){return{listeners:[],scriptId:zt("tiny-script"),scriptLoaded:!1}},In=function(){var e=Ct(),p=function(n,r,U,a){var _=r.createElement("script");_.referrerPolicy="origin",_.type="application/javascript",_.id=n,_.src=U;var g=function(){_.removeEventListener("load",g),a()};_.addEventListener("load",g),r.head&&r.head.appendChild(_)},i=function(n,r,U){e.scriptLoaded?U():(e.listeners.push(U),n.getElementById(e.scriptId)||p(e.scriptId,n,r,function(){e.listeners.forEach(function(a){return a()}),e.scriptLoaded=!0}))},s=function(){e=Ct()};return{load:i,reinitialize:s}},Dn=In(),Rn=function(){return typeof window<"u"?window:global},he=function(){var e=Rn();return e&&e.tinymce?e.tinymce:null},Cn={apiKey:String,cloudChannel:String,id:String,init:Object,initialValue:String,inline:Boolean,modelEvents:[String,Array],plugins:[String,Array],tagName:String,toolbar:[String,Array],modelValue:String,disabled:Boolean,tinymceScriptSrc:String,outputFormat:{type:String,validator:function(e){return e==="html"||e==="text"}}},Ae=globalThis&&globalThis.__assign||function(){return Ae=Object.assign||function(e){for(var p,i=1,s=arguments.length;i<s;i++){p=arguments[i];for(var n in p)Object.prototype.hasOwnProperty.call(p,n)&&(e[n]=p[n])}return e},Ae.apply(this,arguments)},On=function(e,p,i,s){return e(s||"div",{id:p,ref:i})},hn=function(e,p,i){return e("textarea",{id:p,visibility:"hidden",ref:i})},ot={selector:void 0,target:void 0},bn=me({props:Cn,setup:function(e,p){var i=e.init?Ae(Ae({},e.init),ot):Ae({},ot),s=ua(e),n=s.disabled,r=s.modelValue,U=s.tagName,a=A(null),_=null,g=e.id||zt("tiny-vue"),T=e.init&&e.init.inline||e.inline,S=!!p.attrs["onUpdate:modelValue"],d=!0,f=e.initialValue?e.initialValue:"",E="",$=function(b){return S?function(){return r!=null&&r.value?r.value:""}:function(){return b?f:E}},y=function(){var b=$(d),M=Ae(Ae({},i),{readonly:e.disabled,target:a.value,plugins:pn(i.plugins,e.plugins),toolbar:e.toolbar||i.toolbar,inline:T,setup:function(X){_=X,X.on("init",function(j){return En(j,e,p,X,r,b)}),typeof i.setup=="function"&&i.setup(X)}});Sn(a.value)&&(a.value.style.visibility=""),he().init(M),d=!1};re(n,function(b){var M;_!==null&&(typeof((M=_.mode)===null||M===void 0?void 0:M.set)=="function"?_.mode.set(b?"readonly":"design"):_.setMode(b?"readonly":"design"))}),re(U,function(b){var M;S||(E=_.getContent()),(M=he())===null||M===void 0||M.remove(_),Ke(function(){return y()})}),ra(function(){if(he()!==null)y();else if(a.value&&a.value.ownerDocument){var b=e.cloudChannel?e.cloudChannel:"6",M=e.apiKey?e.apiKey:"no-api-key",X=yn(e.tinymceScriptSrc)?"https://cdn.tiny.cloud/1/".concat(M,"/tinymce/").concat(b,"/tinymce.min.js"):e.tinymceScriptSrc;Dn.load(a.value.ownerDocument,X,y)}}),da(function(){he()!==null&&he().remove(_)}),T||(ma(function(){d||y()}),va(function(){var b;S||(E=_.getContent()),(b=he())===null||b===void 0||b.remove(_)}));var D=function(b){var M;E=_.getContent(),(M=he())===null||M===void 0||M.remove(_),i=Ae(Ae(Ae({},i),b),ot),Ke(function(){return y()})};return p.expose({rerender:D,getEditor:function(){return _}}),function(){return T?On(Ut,g,a,e.tagName):hn(Ut,g,a)}}});const Mn=["colspan"],Vn=k("strong",null,"E-Mail Content",-1),kn=["innerHTML"],Qt=me({__name:"Communications",props:{hideHistory:{type:Boolean,default:!1},registration:{},showEditor:{type:Boolean}},emits:["close-editor"],setup(e,{emit:p}){const i=ye(),s=A([]),n=A({From:"",Subject:"",HTML:""}),r=A(""),U=A(""),a=A(""),_=A(!1),g=A([]),T=A([]),S=A([{key:"CreatedAt",title:"Date"},{key:"Subject",title:"Subject"},{key:"User.DisplayName",title:"Sender"},{key:"Status",title:"Status"}]),d=A([{key:"CreatedAt",order:"asc"}]);re(n,y=>{a.value=y.From||a.value||"",U.value=y.Subject||U.value||"",r.value=y.HTML||r.value||""});const f=()=>{i.getRegistrationEmails(e.registration.RegistrationUUID).then(y=>{y&&(y.forEach(D=>{D.CreatedAt=il(new Date(D.CreatedAt||"")),D.Status=hl(D.Status),D.User||(D.User={ID:0,UserUUID:"",DisplayName:"System",Handle:"",Credentials:[],Additional:{FirstName:"",LastName:"",DOB:"",Email:""},Data:"",Groups:[],Tags:[]})}),T.value=y)})};f(),(()=>{i.getRegistrationEmailTemplates(e.registration.RegistrationUUID).then(y=>{y&&(s.value=y)})})();const $=({callback:y})=>{i.sendRegistrationEmail(e.registration.RegistrationUUID,a.value,U.value,r.value).then(D=>{D?y&&(y("Email Sent"),f(),setTimeout(()=>{_.value=!1},2e3)):y&&y("Not sent")}).catch(()=>{y&&y("Not sent")})};return(y,D)=>(m(),C(F,null,[y.showEditor?(m(),C(F,{key:0},[t(Z,null,{default:l(()=>[t(L,null,{default:l(()=>[t(Ca,{items:s.value,"item-title":"Subject","return-object":"",label:"Template","hide-details":"",modelValue:n.value,"onUpdate:modelValue":D[0]||(D[0]=b=>n.value=b),variant:"outlined"},null,8,["items","modelValue"])]),_:1})]),_:1}),t(Z,null,{default:l(()=>[t(L,{cols:"12"},{default:l(()=>[t(ce,{modelValue:a.value,"onUpdate:modelValue":D[1]||(D[1]=b=>a.value=b),label:"From",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),t(L,{cols:"12"},{default:l(()=>[t(ce,{modelValue:U.value,"onUpdate:modelValue":D[2]||(D[2]=b=>U.value=b),label:"Subject",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),t(L,{cols:"12"},{default:l(()=>[t(H(bn),{modelValue:r.value,"onUpdate:modelValue":D[3]||(D[3]=b=>r.value=b),"api-key":"g9sce3fktcgvk0i7sp96cahgyk4cos7q27es3ubnlal3xf3z"},null,8,["modelValue"])]),_:1})]),_:1}),t(Z,null,{default:l(()=>[t(L,null,{default:l(()=>[t(ut,{onClick:D[4]||(D[4]=b=>p("close-editor")),label:"Close E-mail Editor",color:"secondary","prepend-icon":"mdi:mdi-window-close"})]),_:1}),t(L,{class:"text-right"},{default:l(()=>[t(ut,{onClick:$,label:"Send",color:"error"})]),_:1})]),_:1})],64)):q("",!0),T.value.length&&!y.hideHistory?(m(),G(Ft,{key:1,class:"my-2"},{default:l(()=>[t(Pt,null,{default:l(()=>[t(kt,null,{default:l(()=>[w(" Email History ")]),_:1}),t(Lt,null,{default:l(()=>[t(H(Nt),{items:T.value,headers:S.value,"show-expand":!0,"item-value":"EmailUUID",expanded:g.value,"onUpdate:expanded":D[5]||(D[5]=b=>g.value=b),"sort-by":d.value,"onUpdate:sortBy":D[6]||(D[6]=b=>d.value=b)},{"expanded-row":l(({columns:b,item:M})=>[k("tr",null,[k("td",{colspan:b.length},[Vn,k("div",{class:"communicationsViewEmailPreview",innerHTML:M.raw.HTML},null,8,kn)],8,Mn)])]),"footer.prepend":l(()=>[t(K,{"prepend-icon":"mdi:mdi-refresh",color:"primary",class:"mr-4",onClick:f},{default:l(()=>[w("Refresh")]),_:1})]),_:1},8,["items","headers","expanded","sort-by"])]),_:1})]),_:1})]),_:1})):q("",!0)],64))}});const Ln=me({__name:"StripeRefundPayment",props:fe({paymentTransaction:{}},{modelValue:{type:Boolean,required:!0}}),emits:fe(["refunded"],["update:modelValue"]),setup(e,{emit:p}){const i=Pe(e,"modelValue"),s=ye(),n=A(!1),r=A("");let U=0;if(e.paymentTransaction.Data&&e.paymentTransaction.Data.PaymentIntent&&typeof e.paymentTransaction.Data.PaymentIntent=="object"){const d=e.paymentTransaction.Data.PaymentIntent;d&&(U=d.amount)}const a=A({Amount:U/100,Description:"",Reason:""}),_=A([{title:"Duplicate",value:"duplicate"},{title:"Fraudulent",value:"fraudulent"},{title:"Requested By Customer",value:"requested_by_customer"}]),g=A(!1);async function T(d){d.preventDefault(),g.value=!0,s.refundStripePayment(e.paymentTransaction.PaymentTransactionUUID,a.value).then(f=>{f?p("refunded",f):S("An unexpected error occurred.")}).catch(f=>{S("An error occurred processing the refund: "+f.toString())}),g.value=!1}const S=d=>{r.value=d,n.value=!0};return(d,f)=>(m(),G(Fe,{modelValue:i.value,"onUpdate:modelValue":f[7]||(f[7]=E=>i.value=E),title:"Refund a Stripe Payment",color:"blue-darken-4",persistent:""},{default:l(()=>[t(ge,{class:"pa-0"},{default:l(()=>[t(Ul,{ref:"refundForm",id:"refund-form",onSubmit:f[4]||(f[4]=ca(E=>T(E),["prevent"]))},{default:l(()=>[t(Z,null,{default:l(()=>[t(L,{cols:"12",sm:"6",md:"4",lg:"3",xl:"2"},{default:l(()=>[t(ce,{modelValue:a.value.Amount,"onUpdate:modelValue":f[0]||(f[0]=E=>a.value.Amount=E),modelModifiers:{number:!0},label:"Amount",prefix:"£",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),t(L,{cols:"12",sm:"6",md:"8",lg:"9",xl:"10"},{default:l(()=>[t(de,{modelValue:a.value.Reason,"onUpdate:modelValue":f[1]||(f[1]=E=>a.value.Reason=E),modelModifiers:{number:!0},items:_.value,"item-title":"title","item-value":"value",label:"Stripe Refund Reason",variant:"outlined","hide-details":""},null,8,["modelValue","items"])]),_:1}),t(L,{cols:"12"},{default:l(()=>[t(ce,{modelValue:a.value.Description,"onUpdate:modelValue":f[2]||(f[2]=E=>a.value.Description=E),modelModifiers:{number:!0},label:"Refund Description",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1})]),_:1}),t(Z,null,{default:l(()=>[t(L,{class:"text-right",cols:"12",sm:"3",md:"2",lg:"2",xl:"1"},{default:l(()=>[t(K,{color:"error",class:"w-100",onClick:f[3]||(f[3]=E=>i.value=!1)},{default:l(()=>[w("Cancel")]),_:1})]),_:1}),t(We),t(L,{class:"text-left",cols:"12",sm:"3",md:"2",lg:"2",xl:"1"},{default:l(()=>[t(K,{type:"submit",color:"success",class:"w-100"},Qe({default:l(()=>[w(" Issue Refund ")]),_:2},[g.value?{name:"prepend",fn:l(()=>[t(rl,{size:"20",indeterminate:""})]),key:"0"}:void 0]),1024)]),_:1})]),_:1})]),_:1},512)]),_:1}),t(Ht,{modelValue:n.value,"onUpdate:modelValue":f[6]||(f[6]=E=>n.value=E)},{actions:l(()=>[t(K,{variant:"text",onClick:f[5]||(f[5]=E=>n.value=!1)},{default:l(()=>[w(" Close ")]),_:1})]),default:l(()=>[w(V(r.value)+" ",1)]),_:1},8,["modelValue"])]),_:1},8,["modelValue"]))}}),Nn=["colspan"],Pn=k("strong",null,"Details",-1),Fn=["innerHTML"],wn=me({__name:"PaymentTransactions",props:{canEdit:{type:Boolean},hideHistory:{type:Boolean},updated:{},registration:{},showEditor:{type:Boolean}},emits:["close-editor","change"],setup(e,{emit:p}){const i=e;let{hideHistory:s=!1,registration:n,showEditor:r}=i;const U=ye(),a=A([]),_=A([]),g=A([{key:"CreatedAt",title:"Date"},{key:"Type",title:"Type"},{key:"Source",title:"Source"},{key:"Description",title:"Description"},{key:"Admin",title:"Admin"},{key:"Amount",title:"Amount"},{key:"Controls",title:""}]),T=A(!1),S=A(),d=A(!1),f=A(""),E=A([{key:"CreatedAt",order:"asc"}]),$=()=>({PaymentTransactionUUID:Ne(),Amount:0,Data:{},Description:"",ID:0,RegistrationID:n.ID,RegistrationUUID:n.RegistrationUUID,Source:St.PAYMENT_TRANSACTION_SOURCE_NULL,Type:st.PAYMENT_TRANSACTION_TYPE_NULL}),y=A($()),{convertTransactions:D,getPaymentTransactionsDisplay:b}=Bt();re(i,()=>{s=i.hideHistory,n=i.registration,r=i.showEditor,b(n.RegistrationUUID).then(J=>{_.value=J})});const M=()=>{b(n.RegistrationUUID).then(J=>{_.value=J})};M();const X=()=>{U.saveRegistrationPaymentTransaction(y.value).then(J=>{J&&(D(J.PaymentTransactions),y.value=$(),p("close-editor"),p("change"))})},j=J=>{const u=_.value.find(c=>c.PaymentTransactionUUID===J);u&&(S.value=u.PaymentTransaction,T.value=!0)},oe=J=>{if(J)try{_.value=D(J.PaymentTransactions),S.value=void 0,T.value=!1,f.value="Refund Processed",d.value=!0,p("change")}catch(u){console.error(u)}};return(J,u)=>(m(),C(F,null,[H(r)?(m(),C(F,{key:0},[t(_l,null,{default:l(()=>[w(" Add Transaction ")]),_:1}),t(Z,null,{default:l(()=>[t(L,{cols:"12",sm:"6"},{default:l(()=>[t(de,{items:H(sl),"item-title":"title","item-value":"value",label:"Transaction Type",clearable:!0,"hide-details":"",modelValue:y.value.Type,"onUpdate:modelValue":u[0]||(u[0]=c=>y.value.Type=c),variant:"outlined"},null,8,["items","modelValue"])]),_:1}),t(L,{cols:"12",sm:"6"},{default:l(()=>[t(de,{items:H(ul),"item-title":"title","item-value":"value",label:"Source",clearable:!0,"hide-details":"",modelValue:y.value.Source,"onUpdate:modelValue":u[1]||(u[1]=c=>y.value.Source=c),variant:"outlined"},null,8,["items","modelValue"])]),_:1})]),_:1}),t(Z,null,{default:l(()=>[t(L,{cols:"12",sm:"8",md:"10"},{default:l(()=>[t(ce,{label:"Description","hide-details":"",modelValue:y.value.Description,"onUpdate:modelValue":u[2]||(u[2]=c=>y.value.Description=c),variant:"outlined"},null,8,["modelValue"])]),_:1}),t(L,{cols:"12",sm:"4",md:"2"},{default:l(()=>[t(ce,{label:"Amount","prepend-inner-icon":"mdi:mdi-currency-gbp","hide-details":"",modelValue:y.value.Amount,"onUpdate:modelValue":u[3]||(u[3]=c=>y.value.Amount=c),modelModifiers:{number:!0},variant:"outlined"},null,8,["modelValue"])]),_:1})]),_:1}),t(Z,null,{default:l(()=>[t(L,{cols:"12",sm:"3",md:"2",lg:"1"},{default:l(()=>[t(K,{class:"w-100",onClick:u[4]||(u[4]=c=>p("close-editor")),color:"warning"},{default:l(()=>[w("Cancel")]),_:1})]),_:1}),t(We),t(L,{cols:"12",sm:"6",md:"3",lg:"2",xl:"2"},{default:l(()=>[t(K,{class:"w-100",onClick:X,color:"primary"},{default:l(()=>[w("Submit Transaction")]),_:1})]),_:1})]),_:1})],64)):q("",!0),_.value.length&&!H(s)?(m(),G(Ft,{key:1,class:"my-2"},{default:l(()=>[t(Pt,null,{default:l(()=>[t(kt,null,{default:l(()=>[w(" Transaction History ")]),_:1}),t(Lt,null,{default:l(()=>[t(H(Nt),{items:_.value,headers:g.value,"show-expand":!1,"item-value":"PaymentTransactionUUID",expanded:a.value,"onUpdate:expanded":u[5]||(u[5]=c=>a.value=c),"sort-by":E.value,"onUpdate:sortBy":u[6]||(u[6]=c=>E.value=c),class:"transactionTable"},{"item.Controls":l(({item:c})=>[J.canEdit&&c.raw.PaymentTransaction.Source===H(St).PAYMENT_TRANSACTION_SOURCE_STRIPE&&c.raw.PaymentTransaction.Type===H(st).PAYMENT_TRANSACTION_TYPE_PAYMENT?(m(),G(K,{key:0,icon:"mdi:mdi-credit-card-refund",variant:"text",size:"xs",onClick:h=>j(c.key)},null,8,["onClick"])):q("",!0)]),"expanded-row":l(({columns:c,item:h})=>[k("tr",null,[k("td",{colspan:c.length},[Pn,k("div",{innerHTML:h.raw.HTML},null,8,Fn)],8,Nn)])]),"footer.prepend":l(()=>[t(K,{"prepend-icon":"mdi:mdi-refresh",color:"primary",class:"mr-4",onClick:M},{default:l(()=>[w("Refresh")]),_:1})]),_:1},8,["items","headers","expanded","sort-by"]),T.value&&S.value?(m(),G(Ln,{key:0,modelValue:T.value,"onUpdate:modelValue":u[7]||(u[7]=c=>T.value=c),"payment-transaction":S.value,onRefunded:oe},null,8,["modelValue","payment-transaction"])):q("",!0),t(Ht,{modelValue:d.value,"onUpdate:modelValue":u[9]||(u[9]=c=>d.value=c)},{actions:l(()=>[t(K,{variant:"text",onClick:u[8]||(u[8]=c=>d.value=!1)},{default:l(()=>[w(" Close ")]),_:1})]),default:l(()=>[w(V(f.value)+" ",1)]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})):q("",!0)],64))}});const $n=(e=void 0,p)=>e===void 0?!1:Yt(e,Gt.GROUP_TYPE_CONVENTION,p.ConventionUUID,p).EditPaymentTransactions,Ze=e=>(bt("data-v-e32ba6e4"),e=e(),Mt(),e),Bn={class:"mb-4"},xn={class:"v-row"},Gn={key:0,class:"v-col v-col-10 py-1 v-row mx-0 pl-0"},Yn={class:"v-col v-col-12 v-col-sm-4 v-col-md-3 font-weight-bold pb-0 pr-0"},Hn={class:"v-col v-col-12 v-col-sm-8 v-col-md-9 font-italic pt-0 pt-sm-3 pb-sm-0 pl-sm-0"},qn={class:"v-col v-col-2 align-self-end text-right py-1 text-no-wrap"},jn=Ze(()=>k("dt",{class:"v-col v-col-9 py-1 font-weight-bold totals"}," Total Charges ",-1)),zn={class:"v-col v-col-3 align-self-end text-right py-1 totals text-no-wrap"},Qn=Ze(()=>k("dt",{class:"v-col v-col-9 py-1 font-weight-bold"}," Applied Total ",-1)),Kn={class:"v-col v-col-3 align-self-end text-right py-1 text-no-wrap"},Wn=Ze(()=>k("dt",{class:"v-col v-col-9 py-1 font-weight-bold"}," Currently Paid ",-1)),Jn={class:"v-col v-col-3 align-self-end text-right py-1 text-no-wrap"},Xn=Ze(()=>k("dt",{class:"v-col v-col-9 py-1 font-weight-bold totals"}," Balance ",-1)),Zn={class:"v-col v-col-3 align-self-end text-right py-1 totals text-no-wrap"},eo=me({__name:"PaymentActions",props:fe({forms:{},registration:{},title:{}},{modelValue:{type:Boolean,required:!0}}),emits:fe(["update:registration"],["update:modelValue"]),setup(e,{emit:p}){const i=e,s=Pe(e,"modelValue"),{registration:n}=i,r=A(!1),U=A(!1),a=A(),_=A([]),g=A(new Date().getTime()),T=A(!1),S=Xe(i,p,void 0,void 0,"registration"),d=A(Ue(S.value));re(S,()=>{d.value=Ue(S.value)});const f=ye();f.getConvention(n.ConventionUUID).then(D=>{D&&(T.value=$n(qt(),D))});const E=()=>{f.generateRegistrationCharges(n.RegistrationUUID,!1).then(D=>{D&&(_.value=D.PaymentTransactions,a.value=D.Registration,g.value=new Date().getTime())}).catch(()=>{})};E();const $=()=>{f.generateRegistrationCharges(n.RegistrationUUID,!0).then(D=>{D&&(_.value=D.PaymentTransactions,a.value=D.Registration,g.value=new Date().getTime())})},{totalCharges:y}=Bt();return(D,b)=>(m(),G(Fe,{modelValue:s.value,"onUpdate:modelValue":b[3]||(b[3]=M=>s.value=M),title:D.title,"show-close-action":!0,color:"primary","close-action-label":"Close",persistent:!0,"retain-focus":!1,scrollable:!0,fullscreen:""},{default:l(()=>[t(ge,{class:"pa-0 mx-0",fluid:!0},{default:l(()=>[a.value?(m(),C(F,{key:0},[k("h3",Bn,"#"+V(a.value.Reference)+" "+V(a.value.User.DisplayName),1),k("dl",xn,[(m(!0),C(F,null,le(_.value,M=>(m(),C(F,{key:M.PaymentTransactionUUID},[M.Type===H(st).PAYMENT_TRANSACTION_TYPE_CHARGE?(m(),C("dt",Gn,[k("div",Yn,V(M.Description.split(":")[0])+": ",1),k("div",Hn,V(M.Description.split(":")[1]),1)])):q("",!0),k("dd",qn," £"+V(M.Amount),1)],64))),128)),jn,k("dd",zn," £"+V(H(y)(_.value)),1),Qn,k("dd",Kn," £"+V(a.value.Total),1),Wn,k("dd",Jn," £"+V(a.value.Paid),1),Xn,k("dd",Zn," £"+V(a.value.Total-a.value.Paid),1)]),t(Z,{class:"flex-row-reverse"},{default:l(()=>[t(L,{class:"text-right"},{default:l(()=>[t(K,{color:"primary",onClick:$},{default:l(()=>[w("Apply Charges")]),_:1})]),_:1}),!U.value&&T.value?(m(),G(L,{key:0},{default:l(()=>[t(K,{color:"secondary",onClick:b[0]||(b[0]=M=>U.value=!0)},{default:l(()=>[w("Transaction Entry")]),_:1})]),_:1})):q("",!0)]),_:1})],64)):q("",!0),t(wn,{"can-edit":T.value,registration:H(n),"show-editor":U.value,onCloseEditor:b[1]||(b[1]=M=>U.value=!1),updated:g.value,onChange:E},null,8,["can-edit","registration","show-editor","updated"]),t(Qt,{registration:H(n),"show-editor":r.value,onCloseEditor:b[2]||(b[2]=M=>r.value=!1)},null,8,["registration","show-editor"])]),_:1})]),_:1},8,["modelValue","title"]))}});const to=Je(eo,[["__scopeId","data-v-e32ba6e4"]]),ao=me({__name:"RegistrationActions",props:fe({forms:{},registration:{},title:{}},{modelValue:{type:Boolean,required:!0}}),emits:fe(["update:registration"],["update:modelValue"]),setup(e,{emit:p}){const i=e,s=Pe(e,"modelValue"),n=A(!1),r=Xe(i,p,void 0,void 0,"registration"),U=A(Ue(r.value));re(r,()=>{U.value=Ue(r.value)});const a=ye(),_=(g,T)=>{const S=U.value.Submissions.find(d=>d.SubmissionUUID==T);if(!S){g&&g("Submission not found");return}a.setSubmissionStatus(T,S.Status).then(d=>{d?(U.value.Submissions.forEach((f,E)=>{r.value.Submissions[E].Status=f.Status}),g&&g("Status Saved")):g&&g("Status not saved")}).catch(()=>{g&&g("Status not saved")})};return(g,T)=>(m(),G(Fe,{modelValue:s.value,"onUpdate:modelValue":T[2]||(T[2]=S=>s.value=S),title:g.title,"show-close-action":!0,color:"primary","close-action-label":"Close",persistent:!0,"retain-focus":!1,scrollable:!0,fullscreen:""},{default:l(()=>[t(rt),t(ge,{class:"pa-0 mx-0",fluid:!0},{default:l(()=>[k("h3",null,"#"+V(g.registration.Reference)+" "+V(g.registration.User.DisplayName),1),t(ze,null,{default:l(()=>[(m(!0),C(F,null,le(U.value.Submissions,S=>(m(),G(Be,{key:S.SubmissionUUID,class:"pa-0"},{default:l(()=>[t(Z,{class:"py-2 align-center"},{default:l(()=>[t(L,{cols:"8"},{default:l(()=>{var d;return[t(de,{modelValue:S.Status,"onUpdate:modelValue":f=>S.Status=f,items:H(pt),"item-text":"title","item-value":"value",variant:"outlined","hide-details":"",label:((d=g.forms.find(f=>f.FormUUID==S.FormUUID))==null?void 0:d.Name)||""},{selection:l(()=>[t(Ja,{class:"mr-4"},{default:l(()=>{var f;return[w(V((f=H(pt).find(E=>E.value===S.Status))==null?void 0:f.icon),1)]}),_:2},1024),w(" "+V(H(xt)(S.Status)),1)]),item:l(({item:f,props:{onClick:E}})=>[t(Be,{title:f.title,"prepend-icon":f.raw.icon,onClick:E},null,8,["title","prepend-icon","onClick"])]),_:2},1032,["modelValue","onUpdate:modelValue","items","label"])]}),_:2},1024),t(L,{cols:"4"},{default:l(()=>[t(ut,{title:"Save","prepend-icon":"mdi:mdi-content-save",color:"warning",onClick:d=>_(d.callback,S.SubmissionUUID)},null,8,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1}),t(Z,null,{default:l(()=>[t(L,{cols:"12"},{default:l(()=>[t(K,{"prepend-icon":"mdi:mdi-email",color:"primary",onClick:T[0]||(T[0]=S=>n.value=!0)},{default:l(()=>[w("Prepare Email")]),_:1})]),_:1})]),_:1}),t(Qt,{registration:g.registration,"show-editor":n.value,onCloseEditor:T[1]||(T[1]=S=>n.value=!1)},null,8,["registration","show-editor"])]),_:1})]),_:1},8,["modelValue","title"]))}});const lo=e=>(bt("data-v-1f1ef289"),e=e(),Mt(),e),no=lo(()=>k("p",null,"Any tags controlled through registration form fields will be reset when the applicable form is saved. If you don't know what you're doing here, don't touch!",-1)),oo={class:"mb-4"},io=me({__name:"RegistrationTags",props:fe({registration:{},title:{}},{modelValue:{type:Boolean,required:!0}}),emits:fe(["update:registration"],["update:modelValue"]),setup(e,{emit:p}){const i=e,s=Pe(e,"modelValue"),n=ye(),r=Xe(i,p,void 0,void 0,"registration"),U=A(Ue(r.value)),a=A(!1),_=A(U.value.Tags);re(r,()=>{U.value=Ue(r.value)});const g=T=>{const S=[],d=[];U.value.Tags.forEach(f=>{_.value.find($=>$.TagUUID===f.TagUUID)||S.push(f.TagUUID)}),_.value.forEach(f=>{U.value.Tags.find($=>f.TagUUID===$.TagUUID)||d.push(f.TagUUID)}),n.updateRegistrationTags(S,d,U.value.RegistrationUUID).then(f=>{f?T&&(T("Tags Saved"),r.value.Tags=f.Tags,s.value=!1):T&&T("Error Saving Tags")}).catch(()=>{T&&T("Error Saving Tags")})};return(T,S)=>(m(),G(Fe,{modelValue:s.value,"onUpdate:modelValue":S[2]||(S[2]=d=>s.value=d),title:T.title,"show-close-action":!0,color:"primary","close-action-label":"Close",persistent:!0,"retain-focus":!1,scrollable:!0,onSave:g,"show-save-action":!0},{default:l(()=>[t(ge,{class:"pa-0 mx-0",fluid:!0},{default:l(()=>[U.value?(m(),C(F,{key:0},[t(Al,{class:"my-4"},{default:l(()=>[t(gl,null,{default:l(()=>[w("Caution")]),_:1}),no]),_:1}),k("h3",oo,"#"+V(U.value.Reference)+" "+V(U.value.User.DisplayName),1),t(Vt,{modelValue:U.value.Tags,"onUpdate:modelValue":S[0]||(S[0]=d=>U.value.Tags=d),convention:U.value.ConventionUUID,"show-key":!0,chips:!0,"show-uuid":a.value},null,8,["modelValue","convention","show-uuid"]),t($t,{label:"Enable Debug Mode",modelValue:a.value,"onUpdate:modelValue":S[1]||(S[1]=d=>a.value=d)},null,8,["modelValue"])],64)):q("",!0)]),_:1})]),_:1},8,["modelValue","title"]))}});const so=Je(io,[["__scopeId","data-v-1f1ef289"]]);function uo(){const e=A([]);fa(()=>e.value=[]);function p(i,s){e.value[s]=i}return{refs:e,updateRef:p}}const ro=Ot({activeColor:String,start:{type:[Number,String],default:1},modelValue:{type:Number,default:e=>e.start},disabled:Boolean,length:{type:[Number,String],default:1,validator:e=>e%1===0},totalVisible:[Number,String],firstIcon:{type:He,default:"$first"},prevIcon:{type:He,default:"$prev"},nextIcon:{type:He,default:"$next"},lastIcon:{type:He,default:"$last"},ariaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.root"},pageAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.page"},currentPageAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.currentPage"},firstAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.first"},previousAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.previous"},nextAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.next"},lastAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.last"},ellipsis:{type:String,default:"..."},showFirstLastPage:Boolean,...Xa(),...Za(),...el(),...tl(),...al(),...ll(),...nl({tag:"nav"}),...Ua(),...ol({variant:"text"})},"VPagination"),mo=ht()({name:"VPagination",props:ro(),emits:{"update:modelValue":e=>!0,first:e=>!0,prev:e=>!0,next:e=>!0,last:e=>!0},setup(e,p){let{slots:i,emit:s}=p;const n=_a(e,"modelValue"),{t:r,n:U}=Ta(),{isRtl:a}=Aa(),{themeClasses:_}=ga(e),{width:g}=Ea(),T=Sa(-1);it(void 0,{scoped:!0});const{resizeRef:S}=dl(u=>{if(!u.length)return;const{target:c,contentRect:h}=u[0],R=c.querySelector(".v-pagination__list > *");if(!R)return;const N=h.width,Q=R.offsetWidth+parseFloat(getComputedStyle(R).marginRight)*2;T.value=$(N,Q)}),d=se(()=>parseInt(e.length,10)),f=se(()=>parseInt(e.start,10)),E=se(()=>e.totalVisible?parseInt(e.totalVisible,10):T.value>=0?T.value:$(g.value,58));function $(u,c){const h=e.showFirstLastPage?5:3;return Math.max(0,Math.floor(+((u-c*h)/c).toFixed(2)))}const y=se(()=>{if(d.value<=0||isNaN(d.value)||d.value>Number.MAX_SAFE_INTEGER)return[];if(E.value<=1)return[n.value];if(d.value<=E.value)return qe(d.value,f.value);const u=E.value%2===0,c=u?E.value/2:Math.floor(E.value/2),h=u?c:c+1,R=d.value-c;if(h-n.value>=0)return[...qe(Math.max(1,E.value-1),f.value),e.ellipsis,d.value];if(n.value-R>=(u?1:0)){const N=E.value-1,Q=d.value-N+f.value;return[f.value,e.ellipsis,...qe(N,Q)]}else{const N=Math.max(1,E.value-3),Q=N===1?n.value:n.value-Math.ceil(N/2)+f.value;return[f.value,e.ellipsis,...qe(N,Q),e.ellipsis,d.value]}});function D(u,c,h){u.preventDefault(),n.value=c,h&&s(h,c)}const{refs:b,updateRef:M}=uo();it({VPaginationBtn:{color:ve(e,"color"),border:ve(e,"border"),density:ve(e,"density"),size:ve(e,"size"),variant:ve(e,"variant"),rounded:ve(e,"rounded"),elevation:ve(e,"elevation")}});const X=se(()=>y.value.map((u,c)=>{const h=R=>M(R,c);if(typeof u=="string")return{isActive:!1,key:`ellipsis-${c}`,page:u,props:{ref:h,ellipsis:!0,icon:!0,disabled:!0}};{const R=u===n.value;return{isActive:R,key:u,page:U(u),props:{ref:h,ellipsis:!1,icon:!0,disabled:!!e.disabled||+e.length<2,color:R?e.activeColor:e.color,ariaCurrent:R,ariaLabel:r(R?e.currentPageAriaLabel:e.pageAriaLabel,u),onClick:N=>D(N,u)}}}})),j=se(()=>{const u=!!e.disabled||n.value<=f.value,c=!!e.disabled||n.value>=f.value+d.value-1;return{first:e.showFirstLastPage?{icon:a.value?e.lastIcon:e.firstIcon,onClick:h=>D(h,f.value,"first"),disabled:u,ariaLabel:r(e.firstAriaLabel),ariaDisabled:u}:void 0,prev:{icon:a.value?e.nextIcon:e.prevIcon,onClick:h=>D(h,n.value-1,"prev"),disabled:u,ariaLabel:r(e.previousAriaLabel),ariaDisabled:u},next:{icon:a.value?e.prevIcon:e.nextIcon,onClick:h=>D(h,n.value+1,"next"),disabled:c,ariaLabel:r(e.nextAriaLabel),ariaDisabled:c},last:e.showFirstLastPage?{icon:a.value?e.firstIcon:e.lastIcon,onClick:h=>D(h,f.value+d.value-1,"last"),disabled:c,ariaLabel:r(e.lastAriaLabel),ariaDisabled:c}:void 0}});function oe(){var c;const u=n.value-f.value;(c=b.value[u])==null||c.$el.focus()}function J(u){u.key===_t.left&&!e.disabled&&n.value>+e.start?(n.value=n.value-1,Ke(oe)):u.key===_t.right&&!e.disabled&&n.value<f.value+d.value-1&&(n.value=n.value+1,Ke(oe))}return wt(()=>t(e.tag,{ref:S,class:["v-pagination",_.value,e.class],style:e.style,role:"navigation","aria-label":r(e.ariaLabel),onKeydown:J,"data-test":"v-pagination-root"},{default:()=>[t("ul",{class:"v-pagination__list"},[e.showFirstLastPage&&t("li",{key:"first",class:"v-pagination__first","data-test":"v-pagination-first"},[i.first?i.first(j.value.first):t(K,Re({_as:"VPaginationBtn"},j.value.first),null)]),t("li",{key:"prev",class:"v-pagination__prev","data-test":"v-pagination-prev"},[i.prev?i.prev(j.value.prev):t(K,Re({_as:"VPaginationBtn"},j.value.prev),null)]),X.value.map((u,c)=>t("li",{key:u.key,class:["v-pagination__item",{"v-pagination__item--is-active":u.isActive}],"data-test":"v-pagination-item"},[i.item?i.item(u):t(K,Re({_as:"VPaginationBtn"},u.props),{default:()=>[u.page]})])),t("li",{key:"next",class:"v-pagination__next","data-test":"v-pagination-next"},[i.next?i.next(j.value.next):t(K,Re({_as:"VPaginationBtn"},j.value.next),null)]),e.showFirstLastPage&&t("li",{key:"last",class:"v-pagination__last","data-test":"v-pagination-last"},[i.last?i.last(j.value.last):t(K,Re({_as:"VPaginationBtn"},j.value.last),null)])])]})),{}}}),vo={style:{opacity:"var(--v-medium-emphasis-opacity)"}},Wo=me({__name:"RegistrationsView",emits:["pageTitle"],setup(e,{emit:p}){var vt;const i=fl();p("pageTitle","Registration Manager");const s=pa(),n=ya(),r=A(!0);let U=((vt=s.params.convention)==null?void 0:vt.toString())||"";const a=A({ID:0,ConventionUUID:Ne(),OrganisationID:0,OrganisationUUID:nt,Name:"New Convention",Description:"",DetailLink:"",Logo:"",Slug:"",Accommodation:[],Tickets:[],Extras:[],Interests:[],Visible:!1}),_=ye(),g=Ia.getInstance(),T=A({ID:0,AdminLayoutUUID:Ne(),ConventionID:a.value.ID,ConventionUUID:a.value.ConventionUUID,Name:"Registration Table",Type:jt.ADMIN_LAYOUT_TABLE,Panels:[]}),S=A([]),d=A([]),f=A([]),E=A([]),$=A([]),y=A(1),D=A(10),b=A([]),M=A(0),X=A(!1),j=A(""),oe=A(""),J=A(""),u=A(""),c=A({FieldUUID:"591c9bca-c78c-4e97-8aef-bc596ef472fb",Value:""}),h=A(new Map([["591c9bca-c78c-4e97-8aef-bc596ef472fb",c.value]])),R=A(""),N=A(""),Q=A([]),ie=A([]),ee=A([]),be=A([]),Me=A([]),Ve=A([]),_e=A(0),ne=A(),Ie=A(!1),De=A(!1),Ce=A(!1),Ge=A(),dt=A(),et=A(),ke=A(!1),Kt=qt();re(j,v=>{const o=$.value.find(I=>I.uuid===v);if(o){const I=o.headers.find(O=>O.defaultSort===!0);I&&(b.value=[{key:I.key,order:"asc"}],Q.value=[{key:I.key,order:"asc"}])}}),re(_e,v=>{v===7&&mt()}),re(R,()=>{oe.value=Date.now().toString()}),re(N,()=>{oe.value=Date.now().toString()});const Wt=()=>{S.value=[],f.value=[],$.value=[];try{_.getConventionAdminLayoutByName(a.value.ConventionUUID,"Registration Table").then(v=>{_e.value+=1,v?T.value=v:(T.value.ConventionID=a.value.ID,T.value.ConventionUUID=a.value.ConventionUUID)})}catch{T.value.ConventionID=a.value.ID,T.value.ConventionUUID=a.value.ConventionUUID}try{_.getConventionForms(a.value.ConventionUUID).then(v=>{_e.value+=1,v&&(S.value=v)})}catch{}try{_.getConventionAccommodation(a.value.ConventionUUID).then(v=>{_e.value+=1,v&&(ie.value=v)})}catch{}try{_.getConventionVenues(a.value.ConventionUUID).then(v=>{_e.value+=1,v&&(Ve.value=v)})}catch{}try{_.getConventionExtras(a.value.ConventionUUID).then(v=>{_e.value+=1,v&&(ee.value=v)})}catch{}try{_.getConventionInterests(a.value.ConventionUUID).then(v=>{_e.value+=1,v&&(be.value=v)})}catch{}try{_.getConventionTickets(a.value.ConventionUUID).then(v=>{_e.value+=1,v&&(Me.value=v)})}catch{}try{_.getConventionGroups(a.value.ConventionUUID).then(v=>{v&&(d.value=v.sort((o,I)=>o.Name.localeCompare(I.Name)))})}catch{}try{_.getConventionTags(a.value.ConventionUUID).then(v=>{v&&(E.value=v.sort((o,I)=>o.Title.localeCompare(I.Title)).map(o=>(o.Title=`${o.Title} [${o.Key}]`,o)))})}catch{}},tt=({page:v,itemsPerPage:o,sortBy:I})=>{r.value=!0,y.value=v,b.value=I;const O=$.value.find(te=>te.uuid==j.value),Te=O==null?void 0:O.layout.Items;let ue="",ct="";if(I&&Te&&I.length>=1){const te=Te.find(we=>we.LayoutItemUUID==I[0].key);switch(ct=I[0].order||"asc",te==null?void 0:te.MetaField){case W.META_DATA_SOURCE_ACCOMMODATION_FORM:ue="submission.status";break;case W.META_DATA_SOURCE_BADGE_FORM:ue="submission.status";break;case W.META_DATA_SOURCE_DEALER_FORM:ue="submission.status";break;case W.META_DATA_SOURCE_REGISTRATION_FORM:ue="submission.status";break;case W.META_DATA_SOURCE_REGISTRATION_REFERENCE:ue="reference";break;case W.META_DATA_SOURCE_SUBMISSION_DATE:ue="created";break;case W.META_DATA_SOURCE_SUBMISSION_STATUS:ue="submission.status";break}switch(te==null?void 0:te.UserField){case ae.USER_DATA_SOURCE_DISPLAY_NAME:ue="user.display_name";break;case ae.USER_DATA_SOURCE_EMAIL:ue="user.email";break;case ae.USER_DATA_SOURCE_FIRST_NAME:ue="user.firstname";break;case ae.USER_DATA_SOURCE_HANDLE:ue="user.handle";break;case ae.USER_DATA_SOURCE_LAST_NAME:ue="user.lastname";break}}try{const te={Direction:ct,Limit:o,Offset:(v-1)*o,Order:ue};O&&O.layout.RequiredRegistrationTags.length>0&&(te.PanelUUID=O==null?void 0:O.layout.LayoutPanelUUID),(O==null?void 0:O.layout.RequiredFormType)===pe.FORM_TYPE_ACCOMMODATION&&(te.Accommodation=!0),(O==null?void 0:O.layout.RequiredFormType)===pe.FORM_TYPE_BADGE&&(te.Badge=!0),(O==null?void 0:O.layout.RequiredFormType)===pe.FORM_TYPE_DEALER&&(te.Dealer=!0),(O==null?void 0:O.layout.RequiredFormType)===pe.FORM_TYPE_REGISTRATION&&(te.Registration=!0),te.GroupUUID=R.value||nt,te.TagUUID=N.value||nt,te.Email=u.value,te.Reference=J.value,te.FieldValues=Array.from(h.value.values()),_.searchConventionRegistrations(a.value.ConventionUUID,te).then(we=>{we&&(M.value=we.Total,f.value=we.Registrations,$.value.forEach(lt=>{const oa=lt.layout;lt.items=f.value.map(x=>{const Ye=[];let Ee;x.Leader?Ee=x:Ee=x.Primary,Ye.push({Name:Ee.User.DisplayName,UUID:Ee.UserUUID,UserUUID:Ee.User.UserUUID,IsLeader:!0,Reference:Ee.Reference,Paid:Ee.Paid,Total:Ee.Total}),Ye.push(...Ee.Members.map(Se=>({Name:Se.User.DisplayName,UUID:Se.UserUUID,UserUUID:Se.User.UserUUID,IsLeader:!1,Reference:Se.Reference,Paid:Se.Paid,Total:Se.Total})));const z={};return lt.headers.forEach(Se=>{var ft;const B=oa.Items.find($e=>$e.LayoutItemUUID===Se.key);if(B){if(B.SourceType==="LAYOUT_ITEM_SOURCE_FORM"&&B.SectionField)x.Submissions.forEach($e=>{const Le=$e.Data.find(P=>P.SectionFieldUUID===B.SectionFieldUUID);if(Le){Se.type===ha.ACCOMMODATION?z[B.LayoutItemUUID]={Data:Le.Data,Registration:x}:z[B.LayoutItemUUID]=Le.Data;return}});else if(B.SourceType==="LAYOUT_ITEM_SOURCE_USER"&&B.UserField)switch(B.UserField){case ae.USER_DATA_SOURCE_AVATAR:z[B.LayoutItemUUID]=i.GetProfileImageURL(x.UserUUID);break;case ae.USER_DATA_SOURCE_DISPLAY_NAME:z[B.LayoutItemUUID]=x.User.DisplayName;break;case ae.USER_DATA_SOURCE_EMAIL:z[B.LayoutItemUUID]=x.User.Additional.Email;break;case ae.USER_DATA_SOURCE_HANDLE:z[B.LayoutItemUUID]=x.User.Handle;break;case ae.USER_DATA_SOURCE_DATE_OF_BIRTH:z[B.LayoutItemUUID]=x.User.Additional.DOB;break;case ae.USER_DATA_SOURCE_FIRST_NAME:z[B.LayoutItemUUID]=x.User.Additional.FirstName;break;case ae.USER_DATA_SOURCE_LAST_NAME:z[B.LayoutItemUUID]=x.User.Additional.LastName;break;case ae.USER_DATA_SOURCE_TELEGRAM:z[B.LayoutItemUUID]="";break}else if(B.SourceType==="LAYOUT_ITEM_SOURCE_META"&&B.MetaField){const $e=(ft=S.value.find(P=>P.Type===pe.FORM_TYPE_REGISTRATION))==null?void 0:ft.FormUUID,Le=x.Submissions.find(P=>P.FormUUID===$e);switch(B.MetaField){case W.META_DATA_SOURCE_REGISTRATION_ACTIONS:z[B.LayoutItemUUID]=x;break;case W.META_DATA_SOURCE_REGISTRATION_GROUP:z[B.LayoutItemUUID]=Ye;break;case W.META_DATA_SOURCE_REGISTRATION_REFERENCE:z[B.LayoutItemUUID]=x.Reference;break;case W.META_DATA_SOURCE_SUBMISSION_DATE:if(Le){const P=new Date(Le.CreatedAt||"");z[B.LayoutItemUUID]=`${P.getFullYear()}-${(P.getMonth()+1).toString().padStart(2,"0")}-${P.getDate().toString().padStart(2,"0")} ${P.getHours().toString().padStart(2,"0")}:${P.getMinutes().toString().padStart(2,"0")}:${P.getSeconds().toString().padStart(2,"0")}`}else{const P=new Date(x.CreatedAt||"");z[B.LayoutItemUUID]=`${P.getFullYear()}-${(P.getMonth()+1).toString().padStart(2,"0")}-${P.getDate().toString().padStart(2,"0")} ${P.getHours().toString().padStart(2,"0")}:${P.getMinutes().toString().padStart(2,"0")}:${P.getSeconds().toString().padStart(2,"0")}`}break;case W.META_DATA_SOURCE_ACCOMMODATION_FORM:z[B.LayoutItemUUID]=x.Submissions.map(P=>{const Y=S.value.find(Oe=>Oe.FormUUID===P.FormUUID);return{Heading:Y==null?void 0:Y.Heading,Form:Y,Submission:P,Registration:x}}).filter(P=>{var Y;return((Y=P.Form)==null?void 0:Y.Type)===pe.FORM_TYPE_ACCOMMODATION});break;case W.META_DATA_SOURCE_BADGE_FORM:z[B.LayoutItemUUID]=x.Submissions.map(P=>{const Y=S.value.find(Oe=>Oe.FormUUID===P.FormUUID);return{Heading:Y==null?void 0:Y.Heading,Form:Y,Submission:P,Registration:x}}).filter(P=>{var Y;return((Y=P.Form)==null?void 0:Y.Type)===pe.FORM_TYPE_BADGE});break;case W.META_DATA_SOURCE_DEALER_FORM:z[B.LayoutItemUUID]=x.Submissions.map(P=>{const Y=S.value.find(Oe=>Oe.FormUUID===P.FormUUID);return{Heading:Y==null?void 0:Y.Heading,Form:Y,Submission:P,Registration:x}}).filter(P=>{var Y;return((Y=P.Form)==null?void 0:Y.Type)===pe.FORM_TYPE_DEALER});break;case W.META_DATA_SOURCE_PAYMENT_STATUS:if(x.Paid===0&&x.Total)z[B.LayoutItemUUID]="REQUIRED";else if(x.Total>x.Paid)z[B.LayoutItemUUID]="ADDITIONAL_REQUIRED";else{const P=Ye.find(Y=>Y.Paid===0&&(Y.Total||0)>0);if(P){x.Total===0&&P.Total===0?z[B.LayoutItemUUID]="NOT_REQUIRED":x.Total===0&&P.Total||x.Total>0&&P.Total===0?z[B.LayoutItemUUID]="MISSING_REQUIRED":x.Paid>=x.Total?z[B.LayoutItemUUID]="AWAITING_PARTNER":z[B.LayoutItemUUID]="ALL_REQUIRED";break}else x.Total===0?z[B.LayoutItemUUID]="NOT_REQUIRED":z[B.LayoutItemUUID]="COMPLETE"}break;case W.META_DATA_SOURCE_SUBMISSION_STATUS:cl(x.Submissions,S.value),z[B.LayoutItemUUID]=x.Submissions.map(P=>{const Y=S.value.find(Oe=>Oe.FormUUID===P.FormUUID);return{Heading:Y==null?void 0:Y.Heading,Form:Y,Submission:P,Registration:x}});break}}}}),z})}),r.value=!1)})}catch{}},Jt=v=>{X.value=!1,v&&(T.value=v,mt())},mt=()=>{T.value.Panels.forEach(v=>{v.Items.forEach(o=>{(o.SectionField==null||o.SectionField.Field==null)&&S.value.find(I=>{I.Sections.find(O=>{if(O.Fields){const Te=O.Fields.find(ue=>ue.SectionFieldUUID===o.SectionFieldUUID);if(Te)return o.SectionField=Te,!0}})})})}),T.value.Panels.length>0&&($.value=[],T.value.Panels.forEach(v=>{const o={uuid:Ne(),order:v.Order,name:v.Name,headers:[],items:[],layout:v};v.Items.sort((I,O)=>I.Order>O.Order?1:I.Order==O.Order?0:-1),o.headers=v.Items.map(I=>{var O,Te;return{key:I.LayoutItemUUID,title:I.Label||((Te=(O=I.SectionField)==null?void 0:O.Field)==null?void 0:Te.Label)||"",align:I.Align==="end"?"end":"start",sortable:Zt(I),type:Xt(I),defaultSort:I.DefaultSort}}),$.value.push(o)}),$.value=$.value.sort((v,o)=>v.order>o.order?1:v.order==o.order?0:-1)),(j.value==null||j.value=="")&&$.value.length>0&&(j.value=$.value[0].uuid)};U?_.getConvention(U).then(v=>{v&&(a.value=v,T.value.ConventionID=a.value.ID,T.value.ConventionUUID=a.value.ConventionUUID,Wt())}).catch(()=>{n.push("/")}):n.push("/");const Xt=v=>{var o,I;if(v.SourceType===xe.LAYOUT_ITEM_SOURCE_META)return`${v.SourceType}.${v.MetaField}`;if(v.SourceType===xe.LAYOUT_ITEM_SOURCE_FORM)return(I=(o=v.SectionField)==null?void 0:o.Field)==null?void 0:I.Type;if(v.SourceType===xe.LAYOUT_ITEM_SOURCE_USER)return`${v.SourceType}.${v.UserField}`},Zt=v=>{const o=[W.META_DATA_SOURCE_ACCOMMODATION_FORM,W.META_DATA_SOURCE_BADGE_FORM,W.META_DATA_SOURCE_DEALER_FORM,W.META_DATA_SOURCE_REGISTRATION_FORM,W.META_DATA_SOURCE_REGISTRATION_REFERENCE,W.META_DATA_SOURCE_SUBMISSION_DATE,W.META_DATA_SOURCE_SUBMISSION_STATUS],I=[ae.USER_DATA_SOURCE_DISPLAY_NAME,ae.USER_DATA_SOURCE_EMAIL,ae.USER_DATA_SOURCE_HANDLE,ae.USER_DATA_SOURCE_DATE_OF_BIRTH,ae.USER_DATA_SOURCE_FIRST_NAME,ae.USER_DATA_SOURCE_LAST_NAME];return o.includes(v.MetaField)||I.includes(v.UserField)},ea=v=>{ne.value=v,Ie.value=!0},ta=v=>{ne.value=v,De.value=!0},aa=v=>{ne.value=v,Ce.value=!0};re(Ie,v=>{v||(ne.value=void 0)}),re(De,v=>{v||(ne.value=void 0)});const at=async(v="")=>{dt.value=await _.getRegistrationGroup(v)},la=({registration:v,form:o,submission:I})=>{ne.value=v,at(v.RegistrationUUID).then(()=>{Ge.value=o,et.value=I,ke.value=!0})},na=v=>{_.switchUser(v.UserUUID).then(o=>{o&&El(o.tokens,o.user,n,!1)}).catch(o=>{console.error(o)})};return g.on("registration.group.leave",v=>{_.leaveRegistrationGroup(v).then(o=>{o&&at(v).then(()=>{g.emit("registration.group.left",o)})})}),g.on("registration.group.remove.member",v=>{_.leaveRegistrationGroup(v).then(o=>{o&&at(v).then(()=>{g.emit("registration.group.left",o)})})}),(v,o)=>(m(),G(yl,null,{default:l(()=>[t(yt,{color:"blue-darken-4"},{default:l(()=>[t(za,{modelValue:j.value,"onUpdate:modelValue":o[0]||(o[0]=I=>j.value=I),"show-arrows":""},{default:l(()=>[(m(!0),C(F,null,le($.value,I=>(m(),G(Qa,{key:I.uuid,value:I.uuid},{default:l(()=>[w(V(I.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"]),t(We),t(K,{icon:"mdi:mdi-cog-outline",onClick:o[1]||(o[1]=I=>X.value=!0)})]),_:1}),t(Wa,{modelValue:j.value,"onUpdate:modelValue":o[20]||(o[20]=I=>j.value=I),disabled:!0},{default:l(()=>[(m(!0),C(F,null,le($.value,I=>(m(),G(Ka,{key:I.uuid,value:I.uuid},{default:l(()=>[I.uuid===j.value?(m(),G(rt,{key:0,class:"pa-2"},{default:l(()=>[t(H(Vl),{page:y.value,"onUpdate:page":o[17]||(o[17]=O=>y.value=O),"items-per-page":D.value,"onUpdate:itemsPerPage":o[18]||(o[18]=O=>D.value=O),"sort-by":Q.value,"onUpdate:sortBy":o[19]||(o[19]=O=>Q.value=O),headers:I.headers,"items-length":M.value,items:I.items,"item-value":"LayoutItemUUID",loading:r.value,search:oe.value,"onUpdate:options":tt},Qe({top:l(()=>[t(ge,null,{default:l(()=>[t(Z,null,{default:l(()=>[t(L,{cols:"12",sm:"12",md:"3",lg:"2",xl:"2"},{default:l(()=>[t(ce,{modelValue:J.value,"onUpdate:modelValue":o[2]||(o[2]=O=>J.value=O),label:"Search by Badge",clearable:!0,"hide-details":"","onClick:clear":o[3]||(o[3]=O=>oe.value=Date.now().toString()),onInput:o[4]||(o[4]=O=>oe.value=Date.now().toString())},null,8,["modelValue"])]),_:1}),t(L,{cols:"12",sm:"12",md:"4",lg:"5",xl:"3"},{default:l(()=>[t(ce,{modelValue:c.value.Value,"onUpdate:modelValue":o[5]||(o[5]=O=>c.value.Value=O),label:"Search By Furry Name",clearable:!0,"hide-details":"","onClick:clear":o[6]||(o[6]=O=>oe.value=Date.now().toString()),onInput:o[7]||(o[7]=O=>oe.value=Date.now().toString())},null,8,["modelValue"])]),_:1}),t(L,{cols:"12",sm:"12",md:"5",lg:"5",xl:"3"},{default:l(()=>[t(ce,{modelValue:u.value,"onUpdate:modelValue":o[8]||(o[8]=O=>u.value=O),label:"Search By Email",clearable:!0,"hide-details":"","onClick:clear":o[9]||(o[9]=O=>oe.value=Date.now().toString()),onInput:o[10]||(o[10]=O=>oe.value=Date.now().toString())},null,8,["modelValue"])]),_:1}),t(L,{cols:"12",sm:"6",md:"6",lg:"6",xl:"2"},{default:l(()=>[t(de,{modelValue:R.value,"onUpdate:modelValue":o[11]||(o[11]=O=>R.value=O),label:"Search By Group",clearable:!0,"hide-details":"",items:d.value,"item-value":"GroupUUID","item-title":"Name"},null,8,["modelValue","items"])]),_:1}),t(L,{cols:"12",sm:"6",md:"6",lg:"6",xl:"2"},{default:l(()=>[t(de,{modelValue:N.value,"onUpdate:modelValue":o[12]||(o[12]=O=>N.value=O),label:"Search By Tag",clearable:!0,"hide-details":"",items:E.value,"item-value":"TagUUID","item-title":"Title"},null,8,["modelValue","items"])]),_:1})]),_:1})]),_:1})]),bottom:l(()=>[t(ge,{fluid:!0},{default:l(()=>[t(Z,{class:"align-center"},{default:l(()=>[t(L,{cols:"12",lg:"7","order-lg":"3",xl:"8"},{default:l(()=>[t(mo,{modelValue:y.value,"onUpdate:modelValue":o[14]||(o[14]=O=>y.value=O),length:Math.ceil(M.value/D.value)},null,8,["modelValue","length"])]),_:1}),t(L,{cols:"6",sm:"4",md:"2",lg:"2",xl:"1","order-lg":"1"},{default:l(()=>[t(de,{"model-value":D.value,density:"compact","hide-details":"","item-title":"title","item-value":"value",label:"Items per page",min:"-1",max:"100",type:"number",variant:"outlined",items:[{title:"10",value:10},{title:"25",value:25},{title:"50",value:50},{title:"100",value:100},{title:"All",value:-1}],"onUpdate:modelValue":o[15]||(o[15]=O=>D.value=parseInt(O,10))},null,8,["model-value"])]),_:1}),t(L,{cols:"6",sm:"3",md:"2",lg:"1",xl:"1","order-lg":"2"},{default:l(()=>[t(ce,{modelValue:y.value,"onUpdate:modelValue":o[16]||(o[16]=O=>y.value=O),modelModifiers:{number:!0},density:"compact","hide-details":"",label:"Page",min:"1",max:Math.ceil(M.value/D.value),type:"number",variant:"outlined"},null,8,["modelValue","max"])]),_:1}),t(L,{class:"text-right",cols:"12",sm:"5",md:"8",lg:"2",xl:"2","order-lg":"4"},{default:l(()=>[k("span",vo,[D.value===-1?(m(),C(F,{key:0},[w(" 1-"+V(M.value)+" of "+V(M.value),1)],64)):(m(),C(F,{key:1},[w(V((y.value-1)*D.value+1)+"-"+V(y.value*D.value>=M.value?M.value:y.value*D.value)+" of "+V(M.value),1)],64))])]),_:1})]),_:1})]),_:1})]),_:2},[le(I.headers,O=>({name:`item.${O.key}`,fn:l(({item:Te})=>[t(Un,{header:O,item:Te,accommodations:ie.value,convention:a.value,extras:ee.value,forms:S.value,interests:be.value,tickets:Me.value,user:H(Kt),venues:Ve.value,onOpenActions:ea,onOpenPayments:ta,onOpenTags:aa,onReload:o[13]||(o[13]=ue=>tt({page:y.value,itemsPerPage:D.value,sortBy:b.value})),onSwitchUser:na,onShowForm:la},null,8,["header","item","accommodations","convention","extras","forms","interests","tickets","user","venues"])])}))]),1032,["page","items-per-page","sort-by","headers","items-length","items","loading","search"])]),_:2},1024)):q("",!0)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"]),X.value?(m(),G(kl,{key:0,title:"Edit Layout",modelValue:X.value,"onUpdate:modelValue":o[21]||(o[21]=I=>X.value=I),layout:T.value,onSave:Jt},null,8,["modelValue","layout"])):q("",!0),ne.value?(m(),C(F,{key:1},[Ie.value?(m(),G(ao,{key:0,modelValue:Ie.value,"onUpdate:modelValue":o[22]||(o[22]=I=>Ie.value=I),registration:ne.value,"onUpdate:registration":o[23]||(o[23]=I=>ne.value=I),accommodations:ie.value,convention:a.value,extras:ee.value,forms:S.value,interests:be.value,tickets:Me.value,title:"Registration Status & Communications",venues:Ve.value},null,8,["modelValue","registration","accommodations","convention","extras","forms","interests","tickets","venues"])):De.value?(m(),G(to,{key:1,modelValue:De.value,"onUpdate:modelValue":o[24]||(o[24]=I=>De.value=I),registration:ne.value,"onUpdate:registration":o[25]||(o[25]=I=>ne.value=I),accommodations:ie.value,convention:a.value,extras:ee.value,forms:S.value,interests:be.value,tickets:Me.value,title:"Registration Payments",venues:Ve.value},null,8,["modelValue","registration","accommodations","convention","extras","forms","interests","tickets","venues"])):Ce.value?(m(),G(so,{key:2,modelValue:Ce.value,"onUpdate:modelValue":o[26]||(o[26]=I=>Ce.value=I),registration:ne.value,"onUpdate:registration":o[27]||(o[27]=I=>ne.value=I),convention:a.value,title:"Registration Tags"},null,8,["modelValue","registration","convention"])):q("",!0)],64)):q("",!0),ke.value&&et.value&&Ge.value?(m(),G(Il,{key:2,modelValue:ke.value,"onUpdate:modelValue":o[31]||(o[31]=I=>ke.value=I),scrollable:!0,fullscreen:!0,persistent:!0},{default:l(()=>[t(rt,{class:"bg-red-darken-4"},{default:l(()=>[t(yt,{color:"error"},{default:l(()=>[t(pl,null,{default:l(()=>[w("Submission Editor - Admin Mode")]),_:1}),t(We),t(Sl,null,{default:l(()=>[t(K,{icon:"mdi:mdi-window-close",onClick:o[28]||(o[28]=I=>ke.value=!1)})]),_:1})]),_:1}),t(Tl,null,{default:l(()=>[t(Oa,{modelValue:Ge.value,"onUpdate:modelValue":o[29]||(o[29]=I=>Ge.value=I),admin:!0,convention:a.value,data:et.value,editable:!0,"registration-group":dt.value,onClose:o[30]||(o[30]=I=>{ke.value=!1,tt({page:y.value,itemsPerPage:D.value,sortBy:b.value})})},null,8,["modelValue","convention","data","registration-group"])]),_:1})]),_:1})]),_:1},8,["modelValue"])):q("",!0)]),_:1}))}});export{Wo as default};
