import{m as ge,u as Ce,a as Ve,b as _e}from"./VSelect-YZABySN7.js";import{c as Ie,V as W}from"./VTextField-ozhsr0ft.js";import{j as ye,u as Ee,V as X,A as Pe}from"./VContainer-idBlWw-g.js";import{m as we,u as ke}from"./filter-DVZn3oYe.js";import{u as xe,f as Se}from"./forwardRefs-hvhJWHEi.js";import{e as be,V as Ae,a as $}from"./VList-pzsIS5D0.js";import{p as De,R as Fe,d as Ke,ad as Re,r as D,s as k,u as U,c as _,w as F,X as J,a7 as Ne,f as o,F as R,m as K,aM as Oe,x as Me,aN as Ye,aC as Le,aO as Q}from"./index-4xYgdkuk.js";import{m as Ue,a as Be}from"./VAvatar-y17-wQdN.js";import{V as Ge}from"./VCheckboxBtn-Jb8ySQZ2.js";import{a as ze}from"./VChip-UjoYyCBJ.js";var He=(e=>(e.TICKET_TYPE_ADD_ON="TICKET_TYPE_ADD_ON",e.TICKET_TYPE_GROUP="TICKET_TYPE_GROUP",e.TICKET_TYPE_TICKET="TICKET_TYPE_TICKET",e.TICKET_TYPE_TICKET_COMPONENT="TICKET_TYPE_TICKET_COMPONENT",e))(He||{});const ul=[{title:"Add on",value:"TICKET_TYPE_ADD_ON"},{title:"Category",value:"TICKET_TYPE_GROUP"},{title:"Ticket",value:"TICKET_TYPE_TICKET"},{title:"Component",value:"TICKET_TYPE_TICKET_COMPONENT"}];function je(e,g,t){if(g==null)return e;if(Array.isArray(g))throw new Error("Multiple matches is not implemented");return typeof g=="number"&&~g?o(R,null,[o("span",{class:"v-autocomplete__unmask"},[e.substr(0,g)]),o("span",{class:"v-autocomplete__mask"},[e.substr(g,t)]),o("span",{class:"v-autocomplete__unmask"},[e.substr(g+t)])]):e}const qe=De({autoSelectFirst:{type:[Boolean,String]},search:String,...we({filterKeys:["title"]}),...ge(),...Fe(Ie({modelValue:null,role:"combobox"}),["validationValue","dirty","appendInnerIcon"]),...Ue({transition:!1})},"VAutocomplete"),nl=Ke()({name:"VAutocomplete",props:qe(),emits:{"update:focused":e=>!0,"update:search":e=>!0,"update:modelValue":e=>!0,"update:menu":e=>!0},setup(e,g){let{slots:t}=g;const{t:N}=Re(),h=D(),C=k(!1),V=k(!0),x=k(!1),B=D(),G=D(),O=U(e,"menu"),s=_({get:()=>O.value,set:l=>{var a;O.value&&!l&&((a=B.value)!=null&&a.Î¨openChildren)||(O.value=l)}}),i=k(-1),Z=_(()=>{var l;return(l=h.value)==null?void 0:l.color}),z=_(()=>s.value?e.closeText:e.openText),{items:H,transformIn:ee,transformOut:le}=be(e),{textColorClasses:te,textColorStyles:ae}=ye(Z),v=U(e,"search",""),n=U(e,"modelValue",[],l=>ee(l===null?[null]:Le(l)),l=>{const a=le(l);return e.multiple?a:a[0]??null}),ue=_(()=>typeof e.counterValue=="function"?e.counterValue(n.value):typeof e.counterValue=="number"?e.counterValue:n.value.length),P=xe(),{filteredItems:M,getMatches:ne}=ke(e,H,()=>V.value?"":v.value),m=_(()=>e.hideSelected?M.value.filter(l=>!n.value.some(a=>a.value===l.value)):M.value),oe=_(()=>n.value.map(l=>l.props.value)),S=_(()=>{var a;return(e.autoSelectFirst===!0||e.autoSelectFirst==="exact"&&v.value===((a=m.value[0])==null?void 0:a.title))&&m.value.length>0&&!V.value&&!x.value}),Y=_(()=>e.hideNoData&&!m.value.length||e.readonly||(P==null?void 0:P.isReadonly.value)),L=D(),{onListScroll:ie,onListKeydown:se}=Ce(L,h);function re(l){e.openOnClear&&(s.value=!0),v.value=""}function ce(){Y.value||(s.value=!0)}function ve(l){Y.value||(C.value&&(l.preventDefault(),l.stopPropagation()),s.value=!s.value)}function de(l){var p,u,d;if(e.readonly||P!=null&&P.isReadonly.value)return;const a=h.value.selectionStart,c=n.value.length;if((i.value>-1||["Enter","ArrowDown","ArrowUp"].includes(l.key))&&l.preventDefault(),["Enter","ArrowDown"].includes(l.key)&&(s.value=!0),["Escape"].includes(l.key)&&(s.value=!1),S.value&&["Enter","Tab"].includes(l.key)&&I(m.value[0]),l.key==="ArrowDown"&&S.value&&((p=L.value)==null||p.focus("next")),!!e.multiple){if(["Backspace","Delete"].includes(l.key)){if(i.value<0){l.key==="Backspace"&&!v.value&&(i.value=c-1);return}const r=i.value,T=n.value[i.value];T&&!T.props.disabled&&I(T),i.value=r>=c-1?c-2:r}if(l.key==="ArrowLeft"){if(i.value<0&&a>0)return;const r=i.value>-1?i.value-1:c-1;n.value[r]?i.value=r:(i.value=-1,h.value.setSelectionRange((u=v.value)==null?void 0:u.length,(d=v.value)==null?void 0:d.length))}if(l.key==="ArrowRight"){if(i.value<0)return;const r=i.value+1;n.value[r]?i.value=r:(i.value=-1,h.value.setSelectionRange(0,0))}}}function fe(l){if(Q(h.value,":autofill")||Q(h.value,":-webkit-autofill")){const a=H.value.find(c=>c.title===l.target.value);a&&I(a)}}function me(){var l;C.value&&(V.value=!0,(l=h.value)==null||l.focus())}function pe(l){C.value=!0,setTimeout(()=>{x.value=!0})}function Te(l){x.value=!1}function he(l){(l==null||l===""&&!e.multiple)&&(n.value=[])}const w=k(!1);function I(l){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(!l.props.disabled)if(e.multiple){const c=n.value.findIndex(p=>e.valueComparator(p.value,l.value));if(c===-1)n.value=[...n.value,l];else{const p=[...n.value];p.splice(c,1),n.value=p}}else n.value=a?[l]:[],w.value=!0,v.value=a?l.title:"",s.value=!1,V.value=!0,J(()=>w.value=!1)}return F(C,(l,a)=>{var c;l!==a&&(l?(w.value=!0,v.value=e.multiple?"":String(((c=n.value.at(-1))==null?void 0:c.props.title)??""),V.value=!0,J(()=>w.value=!1)):(!e.multiple&&v.value==null?n.value=[]:S.value&&!x.value&&!n.value.some(p=>{let{value:u}=p;return u===m.value[0].value})&&I(m.value[0]),s.value=!1,v.value="",i.value=-1))}),F(v,l=>{!C.value||w.value||(l&&(s.value=!0),V.value=!l)}),F(s,()=>{if(!e.hideSelected&&s.value&&n.value.length){const l=m.value.findIndex(a=>n.value.some(c=>a.value===c.value));Ne&&window.requestAnimationFrame(()=>{var a;l>=0&&((a=G.value)==null||a.scrollToIndex(l))})}}),F(m,(l,a)=>{C.value&&(!l.length&&e.hideNoData&&(s.value=!1),!a.length&&l.length&&(s.value=!0))}),Ee(()=>{const l=!!(e.chips||t.chip),a=!!(!e.hideNoData||m.value.length||t["prepend-item"]||t["append-item"]||t["no-data"]),c=n.value.length>0,p=W.filterProps(e);return o(W,K({ref:h},p,{modelValue:v.value,"onUpdate:modelValue":[u=>v.value=u,he],focused:C.value,"onUpdate:focused":u=>C.value=u,validationValue:n.externalValue,counterValue:ue.value,dirty:c,onChange:fe,class:["v-autocomplete",`v-autocomplete--${e.multiple?"multiple":"single"}`,{"v-autocomplete--active-menu":s.value,"v-autocomplete--chips":!!e.chips,"v-autocomplete--selection-slot":!!t.selection,"v-autocomplete--selecting-index":i.value>-1},e.class],style:e.style,readonly:e.readonly,placeholder:c?void 0:e.placeholder,"onClick:clear":re,"onMousedown:control":ce,onKeydown:de}),{...t,default:()=>o(R,null,[o(Ve,K({ref:B,modelValue:s.value,"onUpdate:modelValue":u=>s.value=u,activator:"parent",contentClass:"v-autocomplete__content",disabled:Y.value,eager:e.eager,maxHeight:310,openOnClick:!1,closeOnContentClick:!1,transition:e.transition,onAfterLeave:me},e.menuProps),{default:()=>[a&&o(Ae,{ref:L,selected:oe.value,selectStrategy:e.multiple?"independent":"single-independent",onMousedown:u=>u.preventDefault(),onKeydown:se,onFocusin:pe,onFocusout:Te,onScrollPassive:ie,tabindex:"-1","aria-live":"polite",color:e.itemColor??e.color},{default:()=>{var u,d,r;return[(u=t["prepend-item"])==null?void 0:u.call(t),!m.value.length&&!e.hideNoData&&(((d=t["no-data"])==null?void 0:d.call(t))??o($,{title:N(e.noDataText)},null)),o(_e,{ref:G,renderless:!0,items:m.value},{default:T=>{var q;let{item:f,index:y,itemRef:E}=T;const j=K(f.props,{ref:E,key:y,active:S.value&&y===0?!0:void 0,onClick:()=>I(f)});return((q=t.item)==null?void 0:q.call(t,{item:f,index:y,props:j}))??o($,j,{prepend:b=>{let{isSelected:A}=b;return o(R,null,[e.multiple&&!e.hideSelected?o(Ge,{key:f.value,modelValue:A,ripple:!1,tabindex:"-1"},null):void 0,f.props.prependAvatar&&o(Be,{image:f.props.prependAvatar},null),f.props.prependIcon&&o(X,{icon:f.props.prependIcon},null)])},title:()=>{var b,A;return V.value?f.title:je(f.title,(b=ne(f))==null?void 0:b.title,((A=v.value)==null?void 0:A.length)??0)}})}}),(r=t["append-item"])==null?void 0:r.call(t)]}})]}),n.value.map((u,d)=>{function r(E){E.stopPropagation(),E.preventDefault(),I(u,!1)}const T={"onClick:close":r,onMousedown(E){E.preventDefault(),E.stopPropagation()},modelValue:!0,"onUpdate:modelValue":void 0},f=l?!!t.chip:!!t.selection,y=f?Oe(l?t.chip({item:u,index:d,props:T}):t.selection({item:u,index:d})):void 0;if(!(f&&!y))return o("div",{key:u.value,class:["v-autocomplete__selection",d===i.value&&["v-autocomplete__selection--selected",te.value]],style:d===i.value?ae.value:{}},[l?t.chip?o(Pe,{key:"chip-defaults",defaults:{VChip:{closable:e.closableChips,size:"small",text:u.title}}},{default:()=>[y]}):o(ze,K({key:"chip",closable:e.closableChips,size:"small",text:u.title,disabled:u.props.disabled},T),null):y??o("span",{class:"v-autocomplete__selection-text"},[u.title,e.multiple&&d<n.value.length-1&&o("span",{class:"v-autocomplete__selection-comma"},[Me(",")])])])})]),"append-inner":function(){var T;for(var u=arguments.length,d=new Array(u),r=0;r<u;r++)d[r]=arguments[r];return o(R,null,[(T=t["append-inner"])==null?void 0:T.call(t,...d),e.menuIcon?o(X,{class:"v-autocomplete__menu-icon",icon:e.menuIcon,onMousedown:ve,onClick:Ye,"aria-label":N(z.value),title:N(z.value)},null):void 0])}})}),Se({isFocused:C,isPristine:V,menu:s,search:v,filteredItems:M,select:I},h)}});export{He as T,nl as V,ul as a};
