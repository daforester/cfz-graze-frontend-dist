import{p as Kt,n as Wt,e as re,t as ge,c as Ca,G as Ut,v as t,H as P,x as Re,I as ee,a0 as se,a1 as Te,r as c,K as ve,M as m,N,O as a,a3 as Ae,W as F,a2 as Xe,a4 as Z,S as B,w as de,X as w,Q as C,V as D,P as O,_ as st,ac as Va,ad as Oa,E as Ge,k as ha,f as ba,d as ka,o as Na,ae as Mt,R as Ma,Y as Jt,Z as Xt,aa as Ke,af as La,ag as lt,z as wa,u as Pa,ah as Fa,A as $a,B as xa,D as Ba,s as Ga,ai as nt,aj as Lt,a7 as Ya,a6 as Ha,U as ja}from"./index-56958cbd.js";import{e as qa,T as za,V as Zt,d as Qa,c as Ka}from"./FormRenderer.vue_vue_type_style_index_0_lang-6c5c130d.js";import{a as Wa,F as De}from"./form-29fd1dbb.js";import{_ as Ye}from"./ModelDialog.vue_vue_type_script_setup_true_lang-55b17201.js";import{m as Ja,k as Xa,l as Za,n as el,o as tl,p as al,q as ll,u as nl,r as ol,s as il,t as sl,v as ul,w as rl,x as dl,y as ml,z as wt,A as Pt,B as Ft,a as ea,_ as ta,f as $t,g as aa,h as la,c as Tt,d as yt,e as Et,b as St,V as It,j as na,i as ke}from"./VWindowItem-cf942956.js";import{V as K,a as k}from"./VRow-45193671.js";import{V as Ue}from"./VTextField-9a6cfa88.js";import{V as ce}from"./copyToClipboard-760ca7f1.js";import{u as oa,j as fe,V as _t,b as vl,m as cl,k as fl,c as Ul,d as _l,l as pl,a as gl,n as Al}from"./VContainer-4db52b77.js";import{V as ia,u as et}from"./VCheckbox-33108da8.js";import{v as Ce}from"./v4-a960c1f4.js";import{h as Qe,b as sa,a as Tl,c as yl,d as xt,P as pt,u as ua}from"./useDisplayTransactions-6c07403f.js";import{V as ot,a as We}from"./VList-0b59e030.js";import{V as q,a as El,u as Sl}from"./VBtn-bbc9679c.js";import{b as Il,c as ra,d as Bt}from"./submission-6136b51d.js";import{G as Dt}from"./group-d2a77946.js";import{C as Rt}from"./canDo-c4127599.js";import{V as da}from"./VAvatar-79e8bbd1.js";import{s as Dl}from"./sortSubmissions-8ed80f07.js";import{a as ma,V as Ne}from"./scopeId-0af77fc3.js";import{V as Me,b as He,c as Le,d as Ct,e as Oe}from"./VCard-5e7ae00a.js";import{_ as Ze,V as va}from"./SaveButton.vue_vue_type_script_setup_true_lang-7f6069a7.js";import{_ as Rl}from"./DeleteDialog.vue_vue_type_script_setup_true_lang-4cfe8c5c.js";import{a as ca,V as gt}from"./VToolbar-f33f2dd3.js";import{V as Cl}from"./VDivider-bad7437a.js";import{V as Vl}from"./VTextarea-ed3ccf6b.js";import{V as Ol,a as hl}from"./VChip-7fa2e17b.js";import{V as At}from"./VDialog-f6d4d7fa.js";import{V as bl}from"./VForm-4fbd258d.js";import{G as Vt}from"./userData-848640f9.js";import{V as kl,a as Nl}from"./VAlert-2a0b3882.js";import{S as Ml}from"./setupLogin-42233f01.js";import{V as Ll}from"./forwardRefs-40b1dec5.js";import{u as ct}from"./nil-d01db1aa.js";import{V as Gt,a as wl}from"./VTable-c1e7af5f.js";import"./index-26b71cef.js";import"./VFileInput-979ebc7f.js";import"./VToolbarItems-1efbf212.js";import"./createSimpleFunctional-47b2240b.js";var it=(e=>(e.ADMIN_LAYOUT_PANELS="ADMIN_LAYOUT_PANELS",e.ADMIN_LAYOUT_TABLE="ADMIN_LAYOUT_TABLE",e))(it||{});const Pl=[{title:"Panel Layout",value:"ADMIN_LAYOUT_PANELS"},{title:"Table Layout",value:"ADMIN_LAYOUT_TABLE"}];var Je=(e=>(e.LAYOUT_ITEM_SOURCE_FORM="LAYOUT_ITEM_SOURCE_FORM",e.LAYOUT_ITEM_SOURCE_META="LAYOUT_ITEM_SOURCE_META",e.LAYOUT_ITEM_SOURCE_USER="LAYOUT_ITEM_SOURCE_USER",e))(Je||{});const Fl=[{title:"Form Field Submission Data",value:"LAYOUT_ITEM_SOURCE_FORM"},{title:"Miscellaneous Data",value:"LAYOUT_ITEM_SOURCE_META"},{title:"User Profile Data",value:"LAYOUT_ITEM_SOURCE_USER"}];var te=(e=>(e.META_DATA_SOURCE_ACCOMMODATION_ALLOCATION="META_DATA_SOURCE_ACCOMMODATION_ALLOCATION",e.META_DATA_SOURCE_ACCOMMODATION_FORM="META_DATA_SOURCE_ACCOMMODATION_FORM",e.META_DATA_SOURCE_BADGE_FORM="META_DATA_SOURCE_BADGE_FORM",e.META_DATA_SOURCE_DEALER_FORM="META_DATA_SOURCE_DEALER_FORM",e.META_DATA_SOURCE_PAYMENT_STATUS="META_DATA_SOURCE_PAYMENT_STATUS",e.META_DATA_SOURCE_REGISTRATION_ACTIONS="META_DATA_SOURCE_REGISTRATION_ACTIONS",e.META_DATA_SOURCE_REGISTRATION_FORM="META_DATA_SOURCE_REGISTRATION_FORM",e.META_DATA_SOURCE_REGISTRATION_GROUP="META_DATA_SOURCE_REGISTRATION_GROUP",e.META_DATA_SOURCE_REGISTRATION_REFERENCE="META_DATA_SOURCE_REGISTRATION_REFERENCE",e.META_DATA_SOURCE_SUBMISSION_DATE="META_DATA_SOURCE_SUBMISSION_DATE",e.META_DATA_SOURCE_SUBMISSION_STATUS="META_DATA_SOURCE_SUBMISSION_STATUS",e))(te||{});const $l=[{title:"Accommodation Allocation",value:"META_DATA_SOURCE_ACCOMMODATION_ALLOCATION"},{title:"Accommodation Form",value:"META_DATA_SOURCE_ACCOMMODATION_FORM"},{title:"Actions",value:"META_DATA_SOURCE_REGISTRATION_ACTIONS"},{title:"Badge Form",value:"META_DATA_SOURCE_BADGE_FORM"},{title:"Dealer Form",value:"META_DATA_SOURCE_DEALER_FORM"},{title:"Payment Status",value:"META_DATA_SOURCE_PAYMENT_STATUS"},{title:"Registration Group",value:"META_DATA_SOURCE_REGISTRATION_GROUP"},{title:"Registration Reference",value:"META_DATA_SOURCE_REGISTRATION_REFERENCE"},{title:"Registration Form",value:"META_DATA_SOURCE_REGISTRATION_FORM"},{title:"Submission Date",value:"META_DATA_SOURCE_SUBMISSION_DATE"},{title:"Submission Status",value:"META_DATA_SOURCE_SUBMISSION_STATUS"}];var ie=(e=>(e.USER_DATA_SOURCE_NULL="",e.USER_DATA_SOURCE_DISPLAY_NAME="USER_DATA_SOURCE_DISPLAY_NAME",e.USER_DATA_SOURCE_HANDLE="USER_DATA_SOURCE_HANDLE",e.USER_DATA_SOURCE_AVATAR="USER_DATA_SOURCE_AVATAR",e.USER_DATA_SOURCE_FIRST_NAME="USER_DATA_SOURCE_FIRST_NAME",e.USER_DATA_SOURCE_LAST_NAME="USER_DATA_SOURCE_LAST_NAME",e.USER_DATA_SOURCE_DATE_OF_BIRTH="USER_DATA_SOURCE_DATE_OF_BIRTH",e.USER_DATA_SOURCE_EMAIL="USER_DATA_SOURCE_EMAIL",e.USER_DATA_SOURCE_TELEGRAM="USER_DATA_SOURCE_TELEGRAM",e))(ie||{});const xl=[{title:"Display Name",value:"USER_DATA_SOURCE_DISPLAY_NAME"},{title:"Handle",value:"USER_DATA_SOURCE_HANDLE"},{title:"Avatar",value:"USER_DATA_SOURCE_AVATAR"},{title:"First Name",value:"USER_DATA_SOURCE_FIRST_NAME"},{title:"Last Name",value:"USER_DATA_SOURCE_LAST_NAME"},{title:"Date of Birth",value:"USER_DATA_SOURCE_DATE_OF_BIRTH"},{title:"Email Address",value:"USER_DATA_SOURCE_EMAIL"},{title:"Telegram Username",value:"USER_DATA_SOURCE_TELEGRAM"}],Bl=e=>{switch(e){case"EMAIL_STATUS_QUEUED":return"Queued";case"EMAIL_STATUS_QUEUE_ERROR":return"Processing";case"EMAIL_STATUS_QUEUE_FAILURE":return"Internal Error";case"EMAIL_STATUS_SENDING":return"Sending";case"EMAIL_STATUS_SENT":return"Sent";case"EMAIL_STATUS_SEND_ERROR":return"Failed to Send"}return"Unknown"},Gl=e=>e===void 0?!1:Rt(e,Dt.GROUP_TYPE_SYSTEM).ManageUsers,Yl=Kt({itemsLength:{type:[Number,String],required:!0},...Ja(),...Xa(),...Za()},"VDataTableServer"),Hl=Wt()({name:"VDataTableServer",props:Yl(),emits:{"update:modelValue":e=>!0,"update:page":e=>!0,"update:itemsPerPage":e=>!0,"update:sortBy":e=>!0,"update:options":e=>!0,"update:expanded":e=>!0,"update:groupBy":e=>!0,"click:row":(e,f)=>!0},setup(e,f){let{emit:s,slots:i}=f;const{groupBy:n}=el(e),{sortBy:l,multiSort:u,mustSort:o}=tl(e),{page:d,itemsPerPage:y}=al(e),T=re(()=>parseInt(e.itemsLength,10)),{columns:U,headers:r}=ll(e,{groupBy:n,showSelect:ge(e,"showSelect"),showExpand:ge(e,"showExpand")}),{items:v}=nl(e,U),{toggleSort:p}=ol({sortBy:l,multiSort:u,mustSort:o,page:d}),{opened:M,isGroupOpen:Y,toggleGroup:I,extractRows:V}=il({groupBy:n,sortBy:l}),{pageCount:L,setItemsPerPage:Q}=sl({page:d,itemsPerPage:y,itemsLength:T}),{flatItems:G}=ul(v,n,M),{isSelected:W,select:ae,selectAll:_,toggleSelect:g,someSelected:S,allSelected:h}=rl(e,{allItems:v,currentPage:v}),{isExpanded:$,toggleExpand:X}=dl(e),me=re(()=>V(v.value));ml({page:d,itemsPerPage:y,sortBy:l,groupBy:n,search:ge(e,"search")}),Ca("v-data-table",{toggleSort:p,sortBy:l}),Ut({VDataTableRows:{hideNoData:ge(e,"hideNoData"),noDataText:ge(e,"noDataText"),loading:ge(e,"loading"),loadingText:ge(e,"loadingText")}});const ne=re(()=>({page:d.value,itemsPerPage:y.value,sortBy:l.value,pageCount:L.value,toggleSort:p,setItemsPerPage:Q,someSelected:S.value,allSelected:h.value,isSelected:W,select:ae,selectAll:_,toggleSelect:g,isExpanded:$,toggleExpand:X,isGroupOpen:Y,toggleGroup:I,items:me.value,groupedItems:G.value,columns:U.value,headers:r.value}));oa(()=>{const[we]=wt.filterProps(e),[Pe]=Pt.filterProps(e),[Fe]=Ft.filterProps(e),[$e]=Gt.filterProps(e);return t(Gt,Re({class:["v-data-table",{"v-data-table--loading":e.loading},e.class],style:e.style},$e),{top:()=>{var _e;return(_e=i.top)==null?void 0:_e.call(i,ne.value)},default:()=>{var _e,pe,ye,je;return i.default?i.default(ne.value):t(P,null,[(_e=i.colgroup)==null?void 0:_e.call(i,ne.value),t("thead",{class:"v-data-table__thead",role:"rowgroup"},[t(Pt,Re(Pe,{sticky:e.fixedHeader}),i)]),(pe=i.thead)==null?void 0:pe.call(i,ne.value),t("tbody",{class:"v-data-table__tbody",role:"rowgroup"},[i.body?i.body(ne.value):t(Ft,Re(Fe,{items:G.value}),i)]),(ye=i.tbody)==null?void 0:ye.call(i,ne.value),(je=i.tfoot)==null?void 0:je.call(i,ne.value)])},bottom:()=>i.bottom?i.bottom(ne.value):t(wt,we,{prepend:i["footer.prepend"]})})})}}),jl=ee({__name:"EditAdminLayout",props:se({title:{default:""},layout:{}},{modelValue:{type:Boolean,required:!0}}),emits:se(["save"],["update:modelValue"]),setup(e,{emit:f}){const s=Te(e,"modelValue"),i=c(ve(e.layout)),n=c([]),l=Ae(),u=({callback:U})=>{const r=()=>{U&&U("Failed to Save Layout")},v=()=>{U&&U("Layout Saved")};l.saveAdminLayout(i.value).then(p=>{p?(v(),f("save",p)):r()}).catch(()=>{r()})},o=()=>({ID:0,LayoutPanelUUID:Ce(),AdminLayoutID:i.value.ID,AdminLayoutUUID:i.value.AdminLayoutUUID,Name:"",Order:i.value.Panels.length+1,Items:[],RequiredFormType:De.FORM_TYPE_NIL,RequiredGroupMemberships:[],RequiredRegistrationTags:[]}),d=U=>()=>({ID:0,LayoutItemUUID:Ce(),LayoutPanelID:U.ID,LayoutPanelUUID:U.LayoutPanelUUID,Label:"",SourceType:Je.LAYOUT_ITEM_SOURCE_FORM,SectionFieldID:void 0,SectionFieldUUID:void 0,SectionField:void 0,MetaField:void 0,UserField:void 0,Align:"",Order:U.Items.length+1,DefaultSort:!1}),y=U=>{const r=n.value.find(v=>v.value===U.SectionFieldUUID);r&&(U.SectionFieldID=r.object.ID,U.SectionField=r.object)};l.getConventionForms(e.layout.ConventionUUID).then(U=>{U.forEach(r=>r.Sections.forEach(v=>v.Fields&&n.value.push(...v.Fields.map(p=>{var Y;return{title:`${r.Name} - ${v.Name} - ${(Y=p.Field)==null?void 0:Y.Name}`,value:p.SectionFieldUUID,object:p}})))),n.value.sort(qa("title"))});const T=re(()=>{switch(i.value.Type){case it.ADMIN_LAYOUT_PANELS:return"Panels";case it.ADMIN_LAYOUT_TABLE:return"Tabs"}});return(U,r)=>(m(),N(Ye,{modelValue:s.value,"onUpdate:modelValue":r[3]||(r[3]=v=>s.value=v),onSave:u,title:U.title,color:"primary",fullscreen:!0,persistent:!0},{default:a(()=>[t(fe,{class:"px-0 mx-0",fluid:!0},{default:a(()=>[t(K,null,{default:a(()=>[t(k,{cols:"12",sm:"6"},{default:a(()=>[t(Ue,{modelValue:i.value.Name,"onUpdate:modelValue":r[0]||(r[0]=v=>i.value.Name=v),label:"Name",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),t(k,{cols:"12",sm:"6"},{default:a(()=>[t(ce,{modelValue:i.value.Type,"onUpdate:modelValue":r[1]||(r[1]=v=>i.value.Type=v),label:"Layout Type",items:F(Pl),"item-title":"title","item-value":"value",variant:"outlined","hide-details":""},null,8,["modelValue","items"])]),_:1})]),_:1})]),_:1}),t($t,{modelValue:i.value.Panels,"onUpdate:modelValue":r[2]||(r[2]=v=>i.value.Panels=v),"new-item":o,closeable:!1,title:T.value,label:"Name","slot-name-prefix":"panel"},Xe({_:2},[Z(i.value.Panels,(v,p)=>({name:`panel_${p}`,fn:a(()=>[t(fe,{class:"px-0 mx-0",fluid:!0},{default:a(()=>[t(K,null,{default:a(()=>[t(k,{cols:"12",sm:"6"},{default:a(()=>[t(Ue,{modelValue:v.Name,"onUpdate:modelValue":M=>v.Name=M,label:"Name",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),t(k,{cols:"12",sm:"6"},{default:a(()=>[t(ce,{modelValue:v.RequiredFormType,"onUpdate:modelValue":M=>v.RequiredFormType=M,items:F(Wa),clearable:!0,label:"Required Form",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"])]),_:2},1024)]),_:2},1024),t(K,null,{default:a(()=>[t(k,{cols:"12",sm:"6"},{default:a(()=>[t(ea,{label:"Required Groups",variant:"outlined",modelValue:v.RequiredGroupMemberships,"onUpdate:modelValue":M=>v.RequiredGroupMemberships=M,convention:i.value.ConventionUUID,chips:"",clearable:"",hint:"Groups that a user must be in to see this form. (Any one)"},null,8,["modelValue","onUpdate:modelValue","convention"])]),_:2},1024),t(k,{cols:"12",sm:"6"},{default:a(()=>[t(ta,{label:"Registration Tags",variant:"outlined",modelValue:v.RequiredRegistrationTags,"onUpdate:modelValue":M=>v.RequiredRegistrationTags=M,convention:i.value.ConventionUUID,chips:"",clearable:"",hint:"Tags that a registration must have to appear in results. (Any one)"},null,8,["modelValue","onUpdate:modelValue","convention"])]),_:2},1024)]),_:2},1024)]),_:2},1024),t($t,{modelValue:v.Items,"onUpdate:modelValue":M=>v.Items=M,"new-item":d(v),closeable:!1,title:"Items",label:"Label","slot-name-prefix":"item"},Xe({_:2},[Z(v.Items,(M,Y)=>({name:`item_${Y}`,fn:a(()=>[t(fe,{class:"px-0 mx-0",fluid:!0},{default:a(()=>[t(K,null,{default:a(()=>[t(k,{cols:"12",sm:"6"},{default:a(()=>[t(Ue,{modelValue:M.Label,"onUpdate:modelValue":I=>M.Label=I,label:"Name",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024),t(K,null,{default:a(()=>[t(k,{cols:"12",sm:"6"},{default:a(()=>[t(ce,{modelValue:M.SourceType,"onUpdate:modelValue":I=>M.SourceType=I,label:"Source Type",items:F(Fl),"item-title":"title","item-value":"value",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"])]),_:2},1024),t(k,{cols:"12",sm:"6"},{default:a(()=>[M.SourceType==="LAYOUT_ITEM_SOURCE_FORM"?(m(),N(ce,{key:0,modelValue:M.SectionFieldUUID,"onUpdate:modelValue":I=>M.SectionFieldUUID=I,label:"Form Data",items:n.value,"item-title":"title","item-value":"value",variant:"outlined","hide-details":"",onBlur:I=>y(M)},null,8,["modelValue","onUpdate:modelValue","items","onBlur"])):M.SourceType==="LAYOUT_ITEM_SOURCE_META"?(m(),N(ce,{key:1,modelValue:M.MetaField,"onUpdate:modelValue":I=>M.MetaField=I,label:"Miscellaneous Data",items:F($l),"item-title":"title","item-value":"value",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"])):M.SourceType==="LAYOUT_ITEM_SOURCE_USER"?(m(),N(ce,{key:2,modelValue:M.UserField,"onUpdate:modelValue":I=>M.UserField=I,label:"User Profile Data",items:F(xl),"item-title":"title","item-value":"value",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"])):B("",!0)]),_:2},1024)]),_:2},1024),t(K,null,{default:a(()=>[t(k,null,{default:a(()=>[t(ia,{modelValue:M.DefaultSort,"onUpdate:modelValue":I=>M.DefaultSort=I,label:"Default Sort","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)]),_:2},1024)])}))]),1032,["modelValue","onUpdate:modelValue","new-item"])])}))]),1032,["modelValue","title"])]),_:1},8,["modelValue","title"]))}}),ql=w("br",null,null,-1),zl=w("h3",null,"Assigned Accommodation",-1),Ql=w("br",null,null,-1),Kl=w("br",null,null,-1),Wl=w("h3",null,"Accommodation Preferences",-1),Jl=w("h3",null,"Selected Tickets",-1),Xl=w("br",null,null,-1),Zl=ee({__name:"EditAccommodationAssignmentDialog",props:se({convention:{},registration:{},selectedAccommodation:{},title:{}},{modelValue:{type:Boolean,required:!0}}),emits:se(["update:field"],["update:modelValue"]),setup(e,{emit:f}){const s=e,{convention:i,registration:n,title:l=""}=s,u=Ae(),o=Te(e,"modelValue"),d=c({capacity:{max:_=>{var h;const g=L.value.find($=>$.room.RoomUUID===_);return!g||g.room.MaximumCapacity===0?!0:(((h=r.value)==null?void 0:h.Members.length)||0)<=g.room.MaximumCapacity||"Too many people in the group for this room"},min:_=>{var h;const g=L.value.find($=>$.room.RoomUUID===_);return!g||g.room.MinimumCapacity===0?!0:(((h=r.value)==null?void 0:h.Members.length)||0)>=g.room.MinimumCapacity||"Not enough people in the group for this room"}}}),y=c([]),T=et(s,f,void 0,void 0,"field"),U=c(ve(T.value));de(T,()=>{U.value=ve(T.value)});const r=c(),v=c(""),p=c(""),M=c([]),Y=c({Ticket:[],AddonsChecked:[],ComponentsChecked:[]}),I=async()=>{var h;const _=await u.getConventionAvailableAccommodation(i.ConventionUUID);_&&(y.value=_);const g=await u.getRegistrationGroup(n.RegistrationUUID||"");g&&(r.value=g);const S=await u.getConventionTickets(i.ConventionUUID);S&&(M.value=S);try{Y.value=JSON.parse(((h=r.value)==null?void 0:h.TicketData)||"")}catch{}};de(v,()=>{p.value=L.value.length>0?L.value[0].value:""});const V=re(()=>{const _=Q.value;return y.value.map(g=>{let S;return _.forEach(h=>{g.Costs.forEach($=>{$.DateStart===(h==null?void 0:h.DateStart)&&$.DateEnd===h.DateEnd&&(S===void 0||S>$.Availability)&&(S=$.Availability)})}),{label:`${g.Name}`,title:`${g.Name} (${S} Available)`,value:g.AccommodationUUID}})}),L=re(()=>{const _=Q.value,g=y.value.find(S=>S.AccommodationUUID===v.value);return(g==null?void 0:g.Pool.map(S=>{var $,X;let h;return _.forEach(me=>{S.Costs.forEach(ne=>{ne.DateStart===(me==null?void 0:me.DateStart)&&ne.DateEnd===me.DateEnd&&(h===void 0||h>ne.Availability)&&(h=ne.Availability)})}),{label:`${($=S.Venue)==null?void 0:$.Name} - ${S.Name}`,title:`${(X=S.Venue)==null?void 0:X.Name} - ${S.Name} (${h} Available)`,value:S.RoomUUID,room:S}}))||[]}),Q=re(()=>[...Y.value.Ticket,...Y.value.AddonsChecked,...Y.value.ComponentsChecked].map(_=>M.value.find(g=>g.TicketUUID===_)).filter(_=>_!==void 0&&_.RequiresAccommodation)),G=_=>{var g;u.assignAccommodation(((g=r.value)==null?void 0:g.Registration.RegistrationUUID)||"",v.value,p.value,!1).then(S=>{S?(I(),_&&_("Room Assigned")):_&&_("Room not assigned")}).catch(()=>{_&&_("Room not assigned")})},W=_=>{var g,S;(g=r.value)!=null&&g.Registration.AllocationUUID?u.deleteAllocation(((S=r.value)==null?void 0:S.Registration.AllocationUUID)||"").then(h=>{h?(I(),_&&_("Allocation Deleted")):_&&_("Allocation not deleted")}).catch(()=>{_&&_("Allocation not deleted")}):_&&_("Nothing to Delete")},ae=_=>{var S,h;const g=(S=y.value.find($=>$.AccommodationUUID===_.AccommodationUUID))==null?void 0:S.Pool;if(g){const $=g.find(X=>X.RoomUUID===_.RoomUUID);if($)return`${(h=$.Venue)==null?void 0:h.Name} - ${$.Name}`}return""};return I(),(_,g)=>{var S;return m(),N(Ye,{modelValue:o.value,"onUpdate:modelValue":g[2]||(g[2]=h=>o.value=h),title:F(l),color:"primary","show-close-action":!0,"show-delete-action":!!((S=r.value)!=null&&S.Registration.Allocation),"show-save-action":!!p.value,"save-button-label":"Assign Room",onDelete:W,onSave:G,fullscreen:!0,persistent:!0},{default:a(()=>[t(fe,{class:"pa-0",fluid:!0},{default:a(()=>[t(K,null,{default:a(()=>{var h;return[t(k,{cols:"12",md:"6"},{default:a(()=>{var $,X;return[w("h3",null,"Group Members ("+C(($=r.value)==null?void 0:$.Members.length)+")",1),(m(!0),D(P,null,Z((X=r.value)==null?void 0:X.Members,me=>(m(),D(P,{key:me.UUID},[O(" #"+C(me.Reference)+" "+C(me.Name),1),ql],64))),128))]}),_:1}),(h=r.value)!=null&&h.Registration.Allocation?(m(),N(k,{key:0,cols:"12",md:"6"},{default:a(()=>[zl,t(ot,null,{default:a(()=>{var $;return[(m(!0),D(P,null,Z(($=r.value)==null?void 0:$.Registration.Allocation.Periods,X=>(m(),N(We,{key:X.AllocationPeriodUUID},{default:a(()=>{var me;return[O(C((me=y.value.find(ne=>ne.AccommodationUUID===X.AccommodationUUID))==null?void 0:me.Name)+" ",1),Ql,O(" "+C(ae(X))+" ",1),Kl,w("small",null,"("+C(F(Qe)(X.DateStart))+" - "+C(F(Qe)(X.DateEnd))+")",1)]}),_:2},1024))),128))]}),_:1})]),_:1})):B("",!0)]}),_:1}),t(K,null,{default:a(()=>[t(k,{cols:"12",md:"6"},{default:a(()=>[_.selectedAccommodation.length?(m(),D(P,{key:0},[Wl,t(ot,null,{default:a(()=>[(m(!0),D(P,null,Z(_.selectedAccommodation,(h,$)=>(m(),N(We,{key:h.AccommodationUUID},{default:a(()=>[O(C($+1)+". "+C(h.Name),1)]),_:2},1024))),128))]),_:1})],64)):B("",!0)]),_:1}),t(k,{cosl:"12",md:"6"},{default:a(()=>[Jl,t(ot,null,{default:a(()=>[(m(!0),D(P,null,Z(Q.value,h=>(m(),N(We,{key:h==null?void 0:h.TicketUUID},{default:a(()=>[O(C(h.Name)+" ",1),Xl,w("small",null,"("+C(F(Qe)(h.DateStart))+" - "+C(F(Qe)(h.DateEnd))+")",1)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1}),t(K,null,{default:a(()=>[t(k,{cols:"12",md:"6"},{default:a(()=>[t(ce,{modelValue:v.value,"onUpdate:modelValue":g[0]||(g[0]=h=>v.value=h),items:V.value,"item-title":"title","item-value":"value",label:"Accommodation"},null,8,["modelValue","items"])]),_:1}),t(k,{cols:"12",md:"6"},{default:a(()=>[t(ce,{modelValue:p.value,"onUpdate:modelValue":g[1]||(g[1]=h=>p.value=h),items:L.value,"item-title":"title","item-value":"value",label:"Room Pool",rules:[d.value.capacity.min,d.value.capacity.max]},null,8,["modelValue","items","rules"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue","title","show-delete-action","show-save-action"])}}}),en={key:0,class:"accommodationList"},tn={key:0,class:"text-orange-darken-2"},an=ee({__name:"DataTableItemAccommodation",props:{accommodations:{default:()=>[]},convention:{},forms:{},registration:{},tickets:{default:()=>[]},value:{default:""},venues:{}},setup(e){const f=c(!1),s=re(()=>{if(!e.value)return[];const n=JSON.parse(e.value),l=e.accommodations.filter(u=>n.includes(u.AccommodationUUID)).sort((u,o)=>{const d=n.findIndex(T=>T===u.AccommodationUUID),y=n.findIndex(T=>T===o.AccommodationUUID);return d>y?1:-1});return ve(l)}),i=re(()=>{let n;const l=e.forms.find(u=>u.Sections.find(o=>{var d;return(d=o.Fields)==null?void 0:d.find(y=>{var T;if(((T=y.Field)==null?void 0:T.Type)==="TICKET")return n=y,!0})}));return n?!!e.registration.Submissions.find(u=>{if(u.FormUUID==(l==null?void 0:l.FormUUID))return u.Data.find(o=>{if(o.SectionFieldUUID==(n==null?void 0:n.SectionFieldUUID)){const d=JSON.parse(o.Data);return e.tickets.filter(y=>y.RequiresAccommodation).find(y=>d.Ticket.includes(y.TicketUUID)||d.AddonsChecked.includes(y.TicketUUID)||d.ComponentsChecked.includes(y.TicketUUID))}})}):!1});return(n,l)=>i.value?(m(),D(P,{key:0},[n.value?(m(),D("ol",en,[(m(!0),D(P,null,Z(s.value,u=>(m(),D("li",{key:u.AccommodationUUID},[n.registration&&n.registration.Allocation&&n.registration.Allocation.Periods.find(o=>o.AccommodationUUID===u.AccommodationUUID)?(m(),D("strong",tn,C(u.Name),1)):(m(),D(P,{key:1},[O(C(u.Name),1)],64))]))),128))])):B("",!0),t(q,{onClick:l[0]||(l[0]=u=>f.value=!0),variant:"flat",color:"success"},{default:a(()=>[O("Assign Accommodation")]),_:1}),n.convention&&f.value?(m(),N(Zl,{key:1,modelValue:f.value,"onUpdate:modelValue":l[1]||(l[1]=u=>f.value=u),title:"Accommodation Allocation",convention:n.convention,registration:n.registration,"selected-accommodation":s.value},null,8,["modelValue","convention","registration","selected-accommodation"])):B("",!0)],64)):B("",!0)}});const ln=st(an,[["__scopeId","data-v-7a102d46"]]),nn={key:0,class:"addonList"},on={key:0},sn={key:0},un=ee({__name:"DataTableItemExtras",props:{extras:{default:()=>[]},value:{default:""}},setup(e){const f=re(()=>{if(!e.value)return;const s=JSON.parse(e.value),i=Object.keys(s),n=ve(e.extras);return n.forEach(l=>{l.Options=l.Options.filter(u=>i.includes(u.OptionUUID)?(u.Choices=u.Choices.filter(o=>o.TagUUID===s[u.OptionUUID].choiceId),s[u.OptionUUID].checked):!1)}),n.filter(l=>l.Options.length>0),n});return(s,i)=>s.value?(m(),D("ul",nn,[(m(!0),D(P,null,Z(f.value,n=>(m(),D(P,{key:n.ExtraUUID},[n.Options.length?(m(),D("li",on,[w("strong",null,C(n.Name),1),w("ul",null,[(m(!0),D(P,null,Z(n.Options,l=>(m(),D("li",{key:l.OptionUUID},[O(C(l.Name)+" ",1),l.Choices.length==1?(m(),D("small",sn,"("+C(l.Choices[0].Title)+")",1)):B("",!0)]))),128))])])):B("",!0)],64))),128))])):B("",!0)}});const rn=st(un,[["__scopeId","data-v-55786e01"]]),dn={key:0},mn=ee({__name:"DataTableItemInterests",props:{interests:{default:()=>[]},value:{default:""}},setup(e){const f=re(()=>{if(!e.value)return;const s=JSON.parse(e.value);return Object.entries(s).filter(([,i])=>i).map(([i,n])=>e.interests.find(l=>l.InterestUUID===i)).filter(i=>i!==void 0)});return(s,i)=>s.value?(m(),D("ul",dn,[(m(!0),D(P,null,Z(f.value,n=>(m(),D("li",{key:n.InterestUUID},C(n.Name),1))),128))])):B("",!0)}}),vn=w("br",null,null,-1),cn=w("small",null,"Options:",-1),fn=w("br",null,null,-1),Un=w("small",null,"Addons:",-1),_n=ee({__name:"DataTableItemTicket",props:{tickets:{default:()=>[]},value:{default:""}},setup(e){const f=re(()=>{if(!e.value)return;let s={Ticket:[],AddonsChecked:[],ComponentsChecked:[]};try{s=JSON.parse(e.value),"ticket"in s&&(s.Ticket=s.ticket),"addonsChecked"in s&&(s.AddonsChecked=s.addonsChecked),"componentsChecked"in s&&(s.ComponentsChecked=s.componentsChecked)}catch{}return s.Ticket.filter(i=>{const n=e.tickets.find(l=>l.TicketUUID===i);return!(!n||n.Type!==za.TICKET_TYPE_TICKET)}).map(i=>{const n=e.tickets.find(u=>u.TicketUUID===i),l=ve(n);return l.TicketComponents=n.TicketComponents.filter(u=>s.ComponentsChecked.includes(u.TicketUUID)),l.AddonTickets=n.AddonTickets.filter(u=>s.AddonsChecked.includes(u.TicketUUID)),l})});return(s,i)=>s.value?(m(!0),D(P,{key:0},Z(f.value,n=>(m(),D("div",{key:n.TicketUUID},[w("strong",null,C(n.Name),1),n.TicketComponents.length>0?(m(),D(P,{key:0},[vn,cn,O("  "),(m(!0),D(P,null,Z(n.TicketComponents,l=>(m(),D(P,{key:l.TicketUUID},[w("small",null,C(l.Name),1),O("  ")],64))),128))],64)):B("",!0),n.AddonTickets.length>0?(m(),D(P,{key:1},[fn,Un,O("  "),(m(!0),D(P,null,Z(n.AddonTickets,l=>(m(),D("small",{key:l.TicketUUID},[O("("),w("em",null,C(l.Name),1),O(")")]))),128))],64)):B("",!0)]))),128)):B("",!0)}}),pn={key:0,class:"text-blue text-center"},gn={key:1,class:"text-red text-center"},An={key:2,class:"text-orange text-center"},Tn={key:3,class:"text-orange text-center"},yn={key:4,class:"text-orange text-center"},En={key:5,class:"text-orange text-center"},Sn={key:6,class:"text-green text-center"},In={key:0},Dn={key:0},Rn=w("strong",null,"Total:",-1),Cn=ee({__name:"RegListRow",props:{header:{},accommodations:{},convention:{},extras:{},forms:{},item:{},interests:{},tickets:{},user:{},venues:{}},emits:["openActions","openPayments","openTags","reload","showForm","switchUser"],setup(e,{emit:f}){const s=(l,u,o)=>{f("showForm",{registration:l,form:u,submission:o})},i=l=>{f("openActions",l)},n=l=>{f("switchUser",l)};return(l,u)=>l.header.type==="ACCOMMODATION"&&l.accommodations.length>0&&l.item.raw[l.header.key]?(m(),N(ln,{key:0,value:l.item.raw[l.header.key].Data,accommodations:l.accommodations,convention:l.convention,forms:l.forms,tickets:l.tickets,venues:l.venues,registration:l.item.raw[l.header.key].Registration},null,8,["value","accommodations","convention","forms","tickets","venues","registration"])):l.header.type==="EXTRAS"&&l.extras.length>0?(m(),N(rn,{key:1,value:l.item.raw[l.header.key],extras:l.extras},null,8,["value","extras"])):l.header.type==="INTERESTS"&&l.interests.length>0?(m(),N(mn,{key:2,value:l.item.raw[l.header.key],interests:l.interests},null,8,["value","interests"])):l.header.type==="TICKET"&&l.tickets.length>0?(m(),N(_n,{key:3,value:l.item.raw[l.header.key],tickets:l.tickets},null,8,["value","tickets"])):l.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_SUBMISSION_STATUS"||l.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_ACCOMMODATION_FORM"||l.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_DEALER_FORM"||l.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_BADGE_FORM"||l.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_REGISTRATION_FORM"?(m(!0),D(P,{key:4},Z(l.item.raw[l.header.key],o=>(m(),D("ul",{key:o.Heading},[w("li",null,[w("strong",null,C(o.Heading)+": ",1),w("span",{class:Va(F(Il)(o.Submission.Status))},C(F(ra)(o.Submission.Status)),3),t(q,{icon:"mdi:mdi-form-select",title:"Edit Submitted Data",variant:"flat",onClick:d=>s(o.Registration,o.Form,o.Submission)},null,8,["onClick"])])]))),128)):l.header.type==="LAYOUT_ITEM_SOURCE_USER.USER_DATA_SOURCE_AVATAR"?(m(),N(da,{key:5,class:"rounded-circle",src:l.item.raw[l.header.key],height:"32",width:"32"},null,8,["src"])):l.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_PAYMENT_STATUS"?(m(),D(P,{key:6},[l.item.raw[l.header.key]=="NOT_REQUIRED"?(m(),D("div",pn,"No Payment Requested")):l.item.raw[l.header.key]=="MISSING_REQUIRED"?(m(),D("div",gn,"Partner Payment Not Requested")):l.item.raw[l.header.key]=="AWAITING_PARTNER"?(m(),D("div",An,"Awaiting Partner Payment")):l.item.raw[l.header.key]=="ALL_REQUIRED"?(m(),D("div",Tn,"Awaiting Payments")):l.item.raw[l.header.key]=="REQUIRED"?(m(),D("div",yn,"Awaiting Payment")):l.item.raw[l.header.key]=="ADDITIONAL_REQUIRED"?(m(),D("div",En,"Awaiting Additional Payments")):(m(),D("div",Sn,"Completed"))],64)):l.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_REGISTRATION_ACTIONS"?(m(),D(P,{key:7},[t(q,{icon:"mdi:mdi-briefcase",variant:"flat",onClick:u[0]||(u[0]=o=>i(l.item.raw[l.header.key]))}),F(Gl)(l.user)?(m(),N(q,{key:0,icon:"mdi:mdi-account-switch-outline",variant:"flat",onClick:u[1]||(u[1]=o=>n(l.item.raw[l.header.key]))})):B("",!0)],64)):l.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_REGISTRATION_GROUP"?(m(),D(P,{key:8},[l.item.raw[l.header.key].length===1?(m(),D("em",In," Not in a group ")):(m(),D(P,{key:1},[w("ul",null,[(m(!0),D(P,null,Z(l.item.raw[l.header.key],o=>(m(),D("li",{key:o.UUID,class:"ml-0"},[O(" #"+C(o.Reference)+" : "+C(o.Name)+" ",1),o.IsLeader?(m(),D("strong",Dn,"(Leader)")):B("",!0)]))),128))]),Rn,O(" "+C(l.item.raw[l.header.key].length),1)],64))],64)):(m(),D(P,{key:9},[O(C(l.item.raw[l.header.key]),1)],64))}}),Yt=ee({__name:"RegistrationActionTabs",props:se({alignTabs:{},class:{},fixedTabs:{type:Boolean},showArrows:{type:[String,Boolean]},tabs:{}},{modelValue:{required:!0}}),emits:["update:modelValue"],setup(e){const f=e,s=Te(e,"modelValue");return(i,n)=>(m(),N(aa,Re({modelValue:s.value,"onUpdate:modelValue":n[0]||(n[0]=l=>s.value=l)},f),{default:a(()=>[(m(!0),D(P,null,Z(i.tabs,l=>(m(),N(la,{value:l.value,key:l.value},{default:a(()=>[O(C(l.label),1)]),_:2},1032,["value"]))),128))]),_:1},16,["modelValue"]))}}),Vn=ee({__name:"Badges",props:{convention:{},registration:{}},setup(e){const f=Ae(),s=ma(),i=c([]),n=u=>{var d;const o=document.createElement("a");o.download=`${((d=e.convention)==null?void 0:d.Name)||""} Badge Image - ${e.registration.Reference} - ${e.registration.User.DisplayName}.jpg`,o.href=u,document.body.appendChild(o),o.click(),document.body.removeChild(o)},l=async u=>s.GetConBadgeImageURL(e.registration.RegistrationUUID,u);return f.getConBadgeList(e.registration.RegistrationUUID).then(u=>{u.forEach(o=>{l(o).then(d=>{i.value.push({template:o,url:d})})})}).catch(()=>{}),(u,o)=>(m(!0),D(P,null,Z(i.value,d=>(m(),N(Oe,{key:d.template},{default:a(()=>[t(He,null,{default:a(()=>[t(Me,null,{default:a(()=>[t(K,{class:"flex-row-reverse"},{default:a(()=>[t(k,{class:"text-wrap flex-grow-1"},{default:a(()=>[O(" Badges (#"+C(u.registration.Reference)+" "+C(u.registration.User.DisplayName)+") ",1)]),_:1})]),_:1})]),_:1})]),_:1}),t(Le,null,{default:a(()=>[t(da,{src:d.url,height:"280",width:"280"},null,8,["src"])]),_:2},1024),t(Ct,null,{default:a(()=>[t(q,{color:"primary","prepend-icon":"mdi:mdi-download",variant:"flat",onClick:y=>n(d.url)},{default:a(()=>[O("Download")]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024))),128))}});var On=["onActivate","onAddUndo","onBeforeAddUndo","onBeforeExecCommand","onBeforeGetContent","onBeforeRenderUI","onBeforeSetContent","onBeforePaste","onBlur","onChange","onClearUndos","onClick","onContextMenu","onCopy","onCut","onDblclick","onDeactivate","onDirty","onDrag","onDragDrop","onDragEnd","onDragGesture","onDragOver","onDrop","onExecCommand","onFocus","onFocusIn","onFocusOut","onGetContent","onHide","onInit","onKeyDown","onKeyPress","onKeyUp","onLoadContent","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp","onNodeChange","onObjectResizeStart","onObjectResized","onObjectSelected","onPaste","onPostProcess","onPostRender","onPreProcess","onProgressState","onRedo","onRemove","onReset","onSaveContent","onSelectionChange","onSetAttrib","onSetContent","onShow","onSubmit","onUndo","onVisualAid"],hn=function(e){return On.map(function(f){return f.toLowerCase()}).indexOf(e.toLowerCase())!==-1},bn=function(e,f,s){Object.keys(f).filter(hn).forEach(function(i){var n=f[i];typeof n=="function"&&(i==="onInit"?n(e,s):s.on(i.substring(2),function(l){return n(l,s)}))})},kn=function(e,f,s,i){var n=e.modelEvents?e.modelEvents:null,l=Array.isArray(n)?n.join(" "):n;de(i,function(u,o){s&&typeof u=="string"&&u!==o&&u!==s.getContent({format:e.outputFormat})&&s.setContent(u)}),s.on(l||"change input undo redo",function(){f.emit("update:modelValue",s.getContent({format:e.outputFormat}))})},Nn=function(e,f,s,i,n,l){i.setContent(l()),s.attrs["onUpdate:modelValue"]&&kn(f,s,i,n),bn(e,s.attrs,i)},Ht=0,fa=function(e){var f=Date.now(),s=Math.floor(Math.random()*1e9);return Ht++,e+"_"+s+Ht+String(f)},Mn=function(e){return e!==null&&e.tagName.toLowerCase()==="textarea"},jt=function(e){return typeof e>"u"||e===""?[]:Array.isArray(e)?e:e.split(" ")},Ln=function(e,f){return jt(e).concat(jt(f))},wn=function(e){return e==null},qt=function(){return{listeners:[],scriptId:fa("tiny-script"),scriptLoaded:!1}},Pn=function(){var e=qt(),f=function(n,l,u,o){var d=l.createElement("script");d.referrerPolicy="origin",d.type="application/javascript",d.id=n,d.src=u;var y=function(){d.removeEventListener("load",y),o()};d.addEventListener("load",y),l.head&&l.head.appendChild(d)},s=function(n,l,u){e.scriptLoaded?u():(e.listeners.push(u),n.getElementById(e.scriptId)||f(e.scriptId,n,l,function(){e.listeners.forEach(function(o){return o()}),e.scriptLoaded=!0}))},i=function(){e=qt()};return{load:s,reinitialize:i}},Fn=Pn(),$n=function(){return typeof window<"u"?window:global},be=function(){var e=$n();return e&&e.tinymce?e.tinymce:null},xn={apiKey:String,cloudChannel:String,id:String,init:Object,initialValue:String,inline:Boolean,modelEvents:[String,Array],plugins:[String,Array],tagName:String,toolbar:[String,Array],modelValue:String,disabled:Boolean,tinymceScriptSrc:String,outputFormat:{type:String,validator:function(e){return e==="html"||e==="text"}}},Ee=globalThis&&globalThis.__assign||function(){return Ee=Object.assign||function(e){for(var f,s=1,i=arguments.length;s<i;s++){f=arguments[s];for(var n in f)Object.prototype.hasOwnProperty.call(f,n)&&(e[n]=f[n])}return e},Ee.apply(this,arguments)},Bn=function(e,f,s,i){return e(i||"div",{id:f,ref:s})},Gn=function(e,f,s){return e("textarea",{id:f,visibility:"hidden",ref:s})},ft={selector:void 0,target:void 0},Yn=ee({props:xn,setup:function(e,f){var s=e.init?Ee(Ee({},e.init),ft):Ee({},ft),i=Oa(e),n=i.disabled,l=i.modelValue,u=i.tagName,o=c(null),d=null,y=e.id||fa("tiny-vue"),T=e.init&&e.init.inline||e.inline,U=!!f.attrs["onUpdate:modelValue"],r=!0,v=e.initialValue?e.initialValue:"",p="",M=function(V){return U?function(){return l!=null&&l.value?l.value:""}:function(){return V?v:p}},Y=function(){var V=M(r),L=Ee(Ee({},s),{readonly:e.disabled,target:o.value,plugins:Ln(s.plugins,e.plugins),toolbar:e.toolbar||s.toolbar,inline:T,setup:function(Q){d=Q,Q.on("init",function(G){return Nn(G,e,f,Q,l,V)}),typeof s.setup=="function"&&s.setup(Q)}});Mn(o.value)&&(o.value.style.visibility=""),be().init(L),r=!1};de(n,function(V){var L;d!==null&&(typeof((L=d.mode)===null||L===void 0?void 0:L.set)=="function"?d.mode.set(V?"readonly":"design"):d.setMode(V?"readonly":"design"))}),de(u,function(V){var L;U||(p=d.getContent()),(L=be())===null||L===void 0||L.remove(d),Ge(function(){return Y()})}),ha(function(){if(be()!==null)Y();else if(o.value&&o.value.ownerDocument){var V=e.cloudChannel?e.cloudChannel:"6",L=e.apiKey?e.apiKey:"no-api-key",Q=wn(e.tinymceScriptSrc)?"https://cdn.tiny.cloud/1/".concat(L,"/tinymce/").concat(V,"/tinymce.min.js"):e.tinymceScriptSrc;Fn.load(o.value.ownerDocument,Q,Y)}}),ba(function(){be()!==null&&be().remove(d)}),T||(ka(function(){r||Y()}),Na(function(){var V;U||(p=d.getContent()),(V=be())===null||V===void 0||V.remove(d)}));var I=function(V){var L;p=d.getContent(),(L=be())===null||L===void 0||L.remove(d),s=Ee(Ee(Ee({},s),V),ft),Ge(function(){return Y()})};return f.expose({rerender:I,getEditor:function(){return d}}),function(){return T?Bn(Mt,y,o,e.tagName):Gn(Mt,y,o)}}});const Hn=["colspan"],jn=w("strong",null,"E-Mail Content",-1),qn=["innerHTML"],zn=ee({__name:"Communications",props:{hideHistory:{type:Boolean,default:!1},registration:{},showEditor:{type:Boolean}},emits:["close-editor"],setup(e,{emit:f}){const s=Ae(),i=c([]),n=c({From:"",Subject:"",HTML:""}),l=c(""),u=c(""),o=c(""),d=c(!1),y=c([]),T=c(["1"]),U=c([]),r=c([{key:"CreatedAt",title:"Date"},{key:"Subject",title:"Subject"},{key:"User.DisplayName",title:"Sender"},{key:"Status",title:"Status"}]),v=c([{key:"CreatedAt",order:"asc"}]);de(n,I=>{o.value=I.From||o.value||"",u.value=I.Subject||u.value||"",l.value=I.HTML||l.value||""});const p=()=>{s.getRegistrationEmails(e.registration.RegistrationUUID).then(I=>{I&&(I.forEach(V=>{V.CreatedAt=sa(new Date(V.CreatedAt||"")),V.Status=Bl(V.Status),V.User||(V.User={ID:0,UserUUID:"",DisplayName:"System",Handle:"",Credentials:[],Additional:{FirstName:"",LastName:"",DOB:"",Email:""},Data:"",Groups:[],Tags:[]})}),U.value=I)})};p(),(()=>{s.getRegistrationEmailTemplates(e.registration.RegistrationUUID).then(I=>{I&&(i.value=I)})})();const Y=({callback:I})=>{s.sendRegistrationEmail(e.registration.RegistrationUUID,o.value,u.value,l.value).then(V=>{V?I&&(I("Email Sent"),p(),setTimeout(()=>{d.value=!1},2e3)):I&&I("Not sent")}).catch(()=>{I&&I("Not sent")})};return(I,V)=>(m(),D(P,null,[I.showEditor?(m(),D(P,{key:0},[t(K,null,{default:a(()=>[t(k,null,{default:a(()=>[t(Zt,{items:i.value,"item-title":"Subject","return-object":"",label:"Template","hide-details":"",modelValue:n.value,"onUpdate:modelValue":V[0]||(V[0]=L=>n.value=L),variant:"outlined"},null,8,["items","modelValue"])]),_:1})]),_:1}),t(K,null,{default:a(()=>[t(k,{cols:"12"},{default:a(()=>[t(Ue,{modelValue:o.value,"onUpdate:modelValue":V[1]||(V[1]=L=>o.value=L),label:"From",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),t(k,{cols:"12"},{default:a(()=>[t(Ue,{modelValue:u.value,"onUpdate:modelValue":V[2]||(V[2]=L=>u.value=L),label:"Subject",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),t(k,{cols:"12"},{default:a(()=>[t(F(Yn),{modelValue:l.value,"onUpdate:modelValue":V[3]||(V[3]=L=>l.value=L),"api-key":"g9sce3fktcgvk0i7sp96cahgyk4cos7q27es3ubnlal3xf3z"},null,8,["modelValue"])]),_:1})]),_:1}),t(K,null,{default:a(()=>[t(k,null,{default:a(()=>[t(Ze,{onClick:V[4]||(V[4]=L=>f("close-editor")),label:"Close E-mail Editor",color:"secondary","prepend-icon":"mdi:mdi-window-close"})]),_:1}),t(k,{class:"text-right"},{default:a(()=>[t(Ze,{onClick:Y,label:"Send",color:"error"})]),_:1})]),_:1})],64)):B("",!0),U.value.length&&!I.hideHistory?(m(),N(It,{key:1,class:"my-2",multiple:!0,modelValue:T.value,"onUpdate:modelValue":V[7]||(V[7]=L=>T.value=L)},{default:a(()=>[t(St,{value:"1"},{default:a(()=>[t(Tt,null,{default:a(()=>[O(" Email History ")]),_:1}),t(yt,null,{default:a(()=>[t(F(Et),{items:U.value,headers:r.value,"show-expand":!0,"item-value":"EmailUUID",expanded:y.value,"onUpdate:expanded":V[5]||(V[5]=L=>y.value=L),"sort-by":v.value,"onUpdate:sortBy":V[6]||(V[6]=L=>v.value=L)},{"expanded-row":a(({columns:L,item:Q})=>[w("tr",null,[w("td",{colspan:L.length},[jn,w("div",{class:"communicationsViewEmailPreview",innerHTML:Q.raw.HTML},null,8,qn)],8,Hn)])]),"footer.prepend":a(()=>[t(q,{"prepend-icon":"mdi:mdi-refresh",color:"primary",class:"mr-4",onClick:p},{default:a(()=>[O("Refresh")]),_:1})]),_:1},8,["items","headers","expanded","sort-by"])]),_:1})]),_:1})]),_:1},8,["modelValue"])):B("",!0)],64))}});const Qn=ee({__name:"Emails",props:{registration:{}},setup(e){const f=c(!1);return(s,i)=>(m(),N(Oe,null,{default:a(()=>[t(He,null,{default:a(()=>[t(Me,null,{default:a(()=>[O(" E-Mails (#"+C(s.registration.Reference)+" "+C(s.registration.User.DisplayName)+") ",1)]),_:1})]),_:1}),t(Le,null,{default:a(()=>[t(K,null,{default:a(()=>[t(k,{cols:"12"},{default:a(()=>[t(q,{"prepend-icon":"mdi:mdi-email",color:"primary",onClick:i[0]||(i[0]=n=>f.value=!0)},{default:a(()=>[O("Prepare Email")]),_:1})]),_:1})]),_:1}),t(zn,{registration:s.registration,"show-editor":f.value,onCloseEditor:i[1]||(i[1]=n=>f.value=!1)},null,8,["registration","show-editor"])]),_:1})]),_:1}))}}),Kn=ee({__name:"EditNoteCategoryDialog",props:se({convention:{},noteCategory:{},title:{}},{modelValue:{type:Boolean,required:!0}}),emits:se(["update:noteCategory"],["update:modelValue"]),setup(e,{emit:f}){const s=e,{title:i=""}=s,n=Te(e,"modelValue"),l=et(s,f,void 0,void 0,"noteCategory"),u=c(ve(l.value));de(l,()=>{u.value=ve(l.value)});const o=()=>{n.value=!1},d=()=>{u.value=ve(l.value)},y=()=>{l.value=u.value};return(T,U)=>(m(),N(Ye,{modelValue:n.value,"onUpdate:modelValue":U[2]||(U[2]=r=>n.value=r),onReset:d,onSave:y,title:F(i),color:"primary",persistent:!0,fullscreen:!1,"hide-extension":!0},{default:a(()=>[t(fe,{class:"pa-0",fluid:!0},{default:a(()=>[t(K,null,{default:a(()=>[t(k,{cols:"12",sm:"6",md:"4"},{default:a(()=>[t(Ue,{modelValue:u.value.Name,"onUpdate:modelValue":U[0]||(U[0]=r=>u.value.Name=r),label:"Internal name",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),t(k,{cols:"12",sm:"6",md:"4"},{default:a(()=>[t(ea,{modelValue:u.value.Groups,"onUpdate:modelValue":U[1]||(U[1]=r=>u.value.Groups=r),convention:T.convention,label:"Groups",variant:"outlined","hide-details":""},null,8,["modelValue","convention"])]),_:1})]),_:1})]),_:1})]),actions:a(()=>[t(q,{color:"blue-darken-1",variant:"text",onClick:o},{default:a(()=>[O(" Cancel ")]),_:1}),t(q,{color:"blue-darken-1",variant:"text",onClick:d},{default:a(()=>[O(" Reset ")]),_:1}),t(Ne),t(q,{color:"blue-darken-1",variant:"text",onClick:y},{default:a(()=>[O(" Save ")]),_:1})]),_:1},8,["modelValue","title"]))}}),Wn=()=>{const e=c(""),f=()=>{const s={x:window.innerWidth,y:window.innerHeight};s.x<600?e.value="xs":s.x>=600&&s.x<960?e.value="sm":s.x>=960&&s.x<1280?e.value="md":s.x>=1280&&s.x<1920?e.value="lg":s.x>=1920&&s.x<2560?e.value="xl":s.x>=2560&&(e.value="xxl")};return window.addEventListener("resize",f),f(),e},Jn={style:{"list-style":"none"}},Xn=ee({__name:"NoteCategories",props:{hideHistory:{type:Boolean},convention:{},showEditor:{type:Boolean}},emits:["close"],setup(e,{emit:f}){const s=Ae(),i=c(!1),n=c(!1),l=c(""),u=c([]),o=c([{key:"Name",title:"Name"},{key:"Groups",title:"Groups"},{key:"actions",title:"",sortable:!1}]),d=Wn();c([{key:"CreatedAt",order:"asc"}]);const y=()=>({ID:0,NoteCategoryUUID:Ce(),ConventionID:e.convention.ID,ConventionUUID:e.convention.ConventionUUID,Name:"",Groups:[],Notes:[]}),T=c(-1),U=c(y()),r=c(y()),v=()=>{r.value.NoteCategoryUUID=Ce(),U.value=Object.assign({},y()),T.value=-1,i.value=!0},p=G=>{T.value=u.value.indexOf(G),U.value=Object.assign({},G),i.value=!0},M=G=>{T.value=u.value.indexOf(G),U.value=Object.assign({},G),n.value=!0},Y=()=>{s.deleteNoteCategory(U.value.NoteCategoryUUID).then(G=>{G&&(u.value.splice(T.value,1),V())})},I=()=>{i.value=!1,Ge(()=>{U.value=Object.assign({},r.value),T.value=-1})},V=()=>{n.value=!1,Ge(()=>{U.value=Object.assign({},r.value),T.value=-1})},L=()=>{s.saveNoteCategory(U.value).then(G=>{G&&(T.value>-1?Object.assign(u.value[T.value],G):u.value.push(G),I())})};return(()=>{s.getNoteCategories(e.convention.ConventionUUID).then(G=>{G&&(u.value=G)})})(),(G,W)=>(m(),N(F(Et),{headers:o.value,items:u.value,"sort-by":[{key:"calories",order:"asc"}],class:"elevation-1"},{top:a(()=>[t(gt,{color:"primary"},Xe({default:a(()=>[t(ca,null,{default:a(()=>[O("Note Categories")]),_:1}),t(Cl,{class:"mx-4 d-none d-sm-inline-flex",inset:!0,vertical:!0}),t(Ne,{class:"d-none d-sm-inline-flex"}),F(d)!="xs"?(m(),N(q,{key:0,dark:"",class:"mb-2","prepend-icon":"mdi:mdi-pencil",onClick:v},{default:a(()=>[O(" New Item ")]),_:1})):B("",!0),t(q,{dark:"",class:"mb-2",icon:"mdi:mdi-window-close",onClick:W[0]||(W[0]=ae=>f("close"))}),t(Rl,{modelValue:n.value,"onUpdate:modelValue":W[1]||(W[1]=ae=>n.value=ae),onDelete:Y},null,8,["modelValue"])]),_:2},[F(d)=="xs"?{name:"extension",fn:a(()=>[t(Ne),t(q,{dark:"",class:"mb-2","prepend-icon":"mdi:mdi-pencil",onClick:v},{default:a(()=>[O(" New Item ")]),_:1})]),key:"0"}:void 0]),1024),i.value?(m(),N(Kn,{key:0,modelValue:i.value,"onUpdate:modelValue":W[2]||(W[2]=ae=>i.value=ae),"note-category":U.value,"onUpdate:noteCategory":[W[3]||(W[3]=ae=>U.value=ae),L],title:l.value,convention:G.convention},null,8,["modelValue","note-category","title","convention"])):B("",!0)]),"item.Groups":a(({item:ae})=>[w("ul",Jn,[(m(!0),D(P,null,Z(ae.selectable.Groups,_=>(m(),D("li",{key:_.GroupUUID,class:"py-1"},C(_.Name),1))),128))])]),"item.actions":a(({item:ae})=>[t(_t,{size:"small",class:"me-2",onClick:_=>p(ae.raw)},{default:a(()=>[O(" mdi:mdi-pencil ")]),_:2},1032,["onClick"]),t(_t,{size:"small",onClick:_=>M(ae.raw)},{default:a(()=>[O(" mdi:mdi-delete ")]),_:2},1032,["onClick"])]),_:1},8,["headers","items"]))}}),Zn=ee({__name:"SelectNoteCategories",props:se({convention:{},chips:{type:Boolean,default:!1},clearable:{type:Boolean,default:!1},hint:{default:""},label:{},variant:{}},{modelValue:{required:!0}}),emits:se(["change"],["update:modelValue"]),setup(e,{emit:f}){const s=Te(e,"modelValue"),i=c([]),n=Ae(),l=c([]),u=c(""),o=c(0),d=re(()=>[...l.value].map(U=>({title:U.Name,value:i.value.find(r=>r.NoteCategoryUUID===U.NoteCategoryUUID)||U})));return typeof e.convention=="object"?u.value=e.convention.ConventionUUID:u.value=e.convention||"",(async()=>{const T=[];u.value&&T.push(n.getNoteCategories(u.value));const U=await Promise.all(T);if(u.value&&U.length==1&&(l.value=U[0].sort((r,v)=>r.Name.localeCompare(v.Name))),Array.isArray(s.value))o.value=2,d.value.forEach(r=>{Array.isArray(s.value)&&s.value.find(p=>p.NoteCategoryUUID===r.value.NoteCategoryUUID)&&i.value.push(r.value)});else if(typeof s.value=="string"){o.value=1;try{const r=JSON.parse(s.value);d.value.forEach(v=>{r.find(M=>M.NoteCategoryUUID===v.value.NoteCategoryUUID)&&i.value.push(v.value)})}catch{}}})(),de(i,()=>{switch(o.value){default:case 2:{s.value=i.value,f("change");break}case 1:{s.value=JSON.stringify(i.value),f("change");break}}}),(T,U)=>(m(),N(Zt,{modelValue:i.value,"onUpdate:modelValue":U[0]||(U[0]=r=>i.value=r),chips:T.chips,multiple:"",label:T.label||"Tags",variant:T.variant||"solo",hint:T.hint,"persistent-hint":!0,clearable:T.clearable,items:d.value,"item-title":"title","item-value":"value"},null,8,["modelValue","chips","label","variant","hint","clearable","items"]))}}),eo=ee({__name:"EditNoteDialog",props:se({convention:{},note:{},title:{}},{modelValue:{type:Boolean,required:!0}}),emits:se(["update:note","saved"],["update:modelValue"]),setup(e,{emit:f}){const s=e,{title:i=""}=s,n=Ae(),l=Te(e,"modelValue"),u=et(s,f,void 0,void 0,"note"),o=c(ve(u.value));de(u,()=>{o.value=ve(u.value)});const d=()=>{o.value=ve(u.value)},y=T=>{o.value.NoteCategories===null&&(o.value.NoteCategories=[]),o.value.CreatedAt=void 0,o.value.DeletedAt=void 0,o.value.UpdatedAt=void 0,o.value.Admin=void 0,o.value.AdminID=void 0,o.value.AdminUUID=void 0,n.saveNote(o.value).then(U=>{U?(o.value=ve(U),T&&T("Note Saved"),u.value=o.value,f("saved",u.value)):T&&T("Internal Error Saving Note")}).catch(U=>{T&&T("Error Saving Note:"+U.ErrorMessage)})};return(T,U)=>o.value?(m(),N(Ye,{key:0,"card-class":"pa-4",modelValue:l.value,"onUpdate:modelValue":U[3]||(U[3]=r=>l.value=r),onReset:d,onSave:y,title:F(i),color:"primary",persistent:!0,fullscreen:!1,"hide-extension":!0,"show-close-action":!0,"show-reset-action":!0,"show-save-action":!0},{default:a(()=>[t(fe,{class:"pa-0",fluid:!0},{default:a(()=>[t(K,null,{default:a(()=>[t(k,{cols:"12"},{default:a(()=>[t(Zn,{modelValue:o.value.NoteCategories,"onUpdate:modelValue":U[0]||(U[0]=r=>o.value.NoteCategories=r),convention:T.convention,label:"Categories",variant:"outlined","hide-details":"",chips:!0},null,8,["modelValue","convention"])]),_:1})]),_:1}),t(K,null,{default:a(()=>[t(k,{cols:"12"},{default:a(()=>[t(Ue,{modelValue:o.value.Subject,"onUpdate:modelValue":U[1]||(U[1]=r=>o.value.Subject=r),label:"Subject",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),t(k,{cols:"12"},{default:a(()=>[t(Vl,{modelValue:o.value.Description,"onUpdate:modelValue":U[2]||(U[2]=r=>o.value.Description=r),label:"Note",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue","title"])):B("",!0)}}),to=ee({__name:"Notes",props:{convention:{},hideHistory:{type:Boolean},registration:{},showEditor:{type:Boolean}},setup(e){const f=Ae(),s=()=>({ID:0,NoteUUID:Ce(),Description:"",NoteCategories:[],Registration:e.registration,RegistrationID:e.registration.ID,RegistrationUUID:e.registration.RegistrationUUID,Subject:""}),i=c(!1),n=c(!1),l=c([]),u=c([]),o=c(s()),d=()=>{o.value=s(),i.value=!0},y=r=>{o.value=r,i.value=!0},T=()=>{f.getRegistrationNotes(e.registration.RegistrationUUID).then(r=>{r&&(r.forEach(v=>{v.CreatedAt=sa(new Date(v.CreatedAt||"")),v.Admin||(v.Admin={ID:0,UserUUID:"",DisplayName:"System",Handle:"",Credentials:[],Additional:{FirstName:"",LastName:"",DOB:"",Email:""},Data:"",Groups:[],Tags:[]})}),l.value=r,u.value=r.map(v=>v.NoteUUID))})},U=()=>{T(),setTimeout(()=>{i.value=!1},2e3)};return T(),(r,v)=>(m(),D(P,null,[t(Oe,null,{default:a(()=>[t(He,null,{default:a(()=>[t(Me,null,{default:a(()=>[t(K,{class:"flex-row-reverse"},{default:a(()=>[t(k,{class:"text-right flex-shrink-1 flex-grow-0",style:{"flex-grow":"0 !important"}},{default:a(()=>[t(q,{class:"d-sm-none",size:"xs",icon:"mdi:mdi-cog",variant:"text",color:"warning",onClick:v[0]||(v[0]=p=>n.value=!0)}),t(q,{class:"d-none d-sm-inline-flex","prepend-icon":"mdi:mdi-cog",variant:"text",color:"warning",onClick:v[1]||(v[1]=p=>n.value=!0)},{default:a(()=>[O("Categories")]),_:1})]),_:1}),t(k,{class:"text-wrap flex-grow-1"},{default:a(()=>[O(" Notes (#"+C(r.registration.Reference)+" "+C(r.registration.User.DisplayName)+") ",1)]),_:1})]),_:1})]),_:1})]),_:1}),t(Le,null,{default:a(()=>[t(It,{multiple:!0,variant:"accordion",modelValue:u.value,"onUpdate:modelValue":v[2]||(v[2]=p=>u.value=p)},{default:a(()=>[(m(!0),D(P,null,Z(l.value,p=>(m(),N(St,{key:`${p.NoteUUID}.${p.UpdatedAt}`,value:p.NoteUUID},{default:a(()=>[t(Tt,null,{default:a(()=>[O(C(p.Subject)+" ",1),t(Ol,{class:"ml-4"},{default:a(()=>[(m(!0),D(P,null,Z(p.NoteCategories,M=>(m(),N(hl,{key:M.NoteCategoryUUID},{default:a(()=>[O(C(M.Name),1)]),_:2},1024))),128))]),_:2},1024)]),_:2},1024),t(yt,null,{default:a(()=>[t(K,null,{default:a(()=>[t(k,null,{default:a(()=>[O(C(p.Description),1)]),_:2},1024)]),_:2},1024),t(K,null,{default:a(()=>[t(k,null,{default:a(()=>[O(C(F(Qe)(p.UpdatedAt||""))+" ",1),p&&p.Admin&&p.Admin.DisplayName?(m(),D(P,{key:0},[O(" - "+C(p.Admin.DisplayName),1)],64)):B("",!0)]),_:2},1024),t(k,{class:"text-right"},{default:a(()=>[t(q,{color:"primary","prepend-icon":"mdi:mdi-pencil",onClick:M=>y(p)},{default:a(()=>[O("Edit")]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(Ct,null,{default:a(()=>[t(q,{color:"primary",variant:"flat",onClick:d},{default:a(()=>[O("Add Note")]),_:1})]),_:1})]),_:1}),t(At,{modelValue:i.value,"onUpdate:modelValue":v[5]||(v[5]=p=>i.value=p),title:"Create Note"},{default:a(()=>[t(eo,{modelValue:i.value,"onUpdate:modelValue":v[3]||(v[3]=p=>i.value=p),note:o.value,"onUpdate:note":v[4]||(v[4]=p=>o.value=p),convention:r.convention,title:"Create Note",onSaved:U},null,8,["modelValue","note","convention"])]),_:1},8,["modelValue"]),t(At,{modelValue:n.value,"onUpdate:modelValue":v[7]||(v[7]=p=>n.value=p),title:"Note Configuration"},{default:a(()=>[t(Xn,{convention:r.convention,onClose:v[6]||(v[6]=p=>n.value=!1)},null,8,["convention"])]),_:1},8,["modelValue"])],64))}}),ao=ee({__name:"StripeRefundPayment",props:se({paymentTransaction:{}},{modelValue:{type:Boolean,required:!0}}),emits:se(["refunded"],["update:modelValue"]),setup(e,{emit:f}){const s=Te(e,"modelValue"),i=Ae(),n=c(!1),l=c("");let u=0;if(e.paymentTransaction.Data&&e.paymentTransaction.Data.PaymentIntent&&typeof e.paymentTransaction.Data.PaymentIntent=="object"){const r=e.paymentTransaction.Data.PaymentIntent;r&&(u=r.amount)}const o=c({Amount:u/100,Description:"",Reason:""}),d=c([{title:"Duplicate",value:"duplicate"},{title:"Fraudulent",value:"fraudulent"},{title:"Requested By Customer",value:"requested_by_customer"}]),y=c(!1);async function T(r){r.preventDefault(),y.value=!0,i.refundStripePayment(e.paymentTransaction.PaymentTransactionUUID,o.value).then(v=>{v?f("refunded",v):U("An unexpected error occurred.")}).catch(v=>{U("An error occurred processing the refund: "+v.toString())}),y.value=!1}const U=r=>{l.value=r,n.value=!0};return(r,v)=>(m(),N(Ye,{modelValue:s.value,"onUpdate:modelValue":v[7]||(v[7]=p=>s.value=p),title:"Refund a Stripe Payment",color:"blue-darken-4",persistent:""},{default:a(()=>[t(fe,{class:"pa-0"},{default:a(()=>[t(bl,{ref:"refundForm",id:"refund-form",onSubmit:v[4]||(v[4]=Ma(p=>T(p),["prevent"]))},{default:a(()=>[t(K,null,{default:a(()=>[t(k,{cols:"12",sm:"6",md:"4",lg:"3",xl:"2"},{default:a(()=>[t(Ue,{modelValue:o.value.Amount,"onUpdate:modelValue":v[0]||(v[0]=p=>o.value.Amount=p),modelModifiers:{number:!0},label:"Amount",prefix:"£",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),t(k,{cols:"12",sm:"6",md:"8",lg:"9",xl:"10"},{default:a(()=>[t(ce,{modelValue:o.value.Reason,"onUpdate:modelValue":v[1]||(v[1]=p=>o.value.Reason=p),modelModifiers:{number:!0},items:d.value,"item-title":"title","item-value":"value",label:"Stripe Refund Reason",variant:"outlined","hide-details":""},null,8,["modelValue","items"])]),_:1}),t(k,{cols:"12"},{default:a(()=>[t(Ue,{modelValue:o.value.Description,"onUpdate:modelValue":v[2]||(v[2]=p=>o.value.Description=p),modelModifiers:{number:!0},label:"Refund Description",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1})]),_:1}),t(K,null,{default:a(()=>[t(k,{class:"text-right",cols:"12",sm:"3",md:"2",lg:"2",xl:"1"},{default:a(()=>[t(q,{color:"error",class:"w-100",onClick:v[3]||(v[3]=p=>s.value=!1)},{default:a(()=>[O("Cancel")]),_:1})]),_:1}),t(Ne),t(k,{class:"text-left",cols:"12",sm:"3",md:"2",lg:"2",xl:"1"},{default:a(()=>[t(q,{type:"submit",color:"success",class:"w-100"},Xe({default:a(()=>[O(" Issue Refund ")]),_:2},[y.value?{name:"prepend",fn:a(()=>[t(El,{size:"20",indeterminate:""})]),key:"0"}:void 0]),1024)]),_:1})]),_:1})]),_:1},512)]),_:1}),t(va,{modelValue:n.value,"onUpdate:modelValue":v[6]||(v[6]=p=>n.value=p)},{actions:a(()=>[t(q,{variant:"text",onClick:v[5]||(v[5]=p=>n.value=!1)},{default:a(()=>[O(" Close ")]),_:1})]),default:a(()=>[O(C(l.value)+" ",1)]),_:1},8,["modelValue"])]),_:1},8,["modelValue"]))}}),lo=["colspan"],no=w("strong",null,"Details",-1),oo=["innerHTML"],io=ee({__name:"PaymentTransactions",props:{canEdit:{type:Boolean},hideHistory:{type:Boolean},updated:{},registration:{},showEditor:{type:Boolean}},emits:["close-editor","change"],setup(e,{emit:f}){const s=e;let{hideHistory:i=!1,registration:n,showEditor:l}=s;const u=Ae(),o=c([]),d=c(["1"]),y=c([]),T=c([{key:"CreatedAt",title:"Date"},{key:"Type",title:"Type"},{key:"Source",title:"Source"},{key:"Description",title:"Description"},{key:"Admin",title:"Admin"},{key:"Amount",title:"Amount"},{key:"Controls",title:""}]),U=c(!1),r=c(),v=c(!1),p=c(""),M=c([{key:"CreatedAt",order:"asc"}]),Y=()=>({PaymentTransactionUUID:Ce(),Amount:0,Data:{},Description:"",ID:0,RegistrationID:n.ID,RegistrationUUID:n.RegistrationUUID,Source:xt.PAYMENT_TRANSACTION_SOURCE_NULL,Type:pt.PAYMENT_TRANSACTION_TYPE_NULL}),I=c(Y()),{convertTransactions:V,getPaymentTransactionsDisplay:L}=ua();de(s,()=>{i=s.hideHistory,n=s.registration,l=s.showEditor,L(n.RegistrationUUID).then(_=>{y.value=_})});const Q=()=>{L(n.RegistrationUUID).then(_=>{y.value=_})};Q();const G=()=>{u.saveRegistrationPaymentTransaction(I.value).then(_=>{_&&(V(_.PaymentTransactions),I.value=Y(),f("close-editor"),f("change"))})},W=_=>{const g=y.value.find(S=>S.PaymentTransactionUUID===_);g&&(r.value=g.PaymentTransaction,U.value=!0)},ae=_=>{if(_)try{y.value=V(_.PaymentTransactions),r.value=void 0,U.value=!1,p.value="Refund Processed",v.value=!0,f("change")}catch(g){console.error(g)}};return(_,g)=>(m(),D(P,null,[F(l)?(m(),D(P,{key:0},[t(Me,null,{default:a(()=>[O(" Add Transaction ")]),_:1}),t(K,null,{default:a(()=>[t(k,{cols:"12",sm:"6"},{default:a(()=>[t(ce,{items:F(Tl),"item-title":"title","item-value":"value",label:"Transaction Type",clearable:!0,"hide-details":"",modelValue:I.value.Type,"onUpdate:modelValue":g[0]||(g[0]=S=>I.value.Type=S),variant:"outlined"},null,8,["items","modelValue"])]),_:1}),t(k,{cols:"12",sm:"6"},{default:a(()=>[t(ce,{items:F(yl),"item-title":"title","item-value":"value",label:"Source",clearable:!0,"hide-details":"",modelValue:I.value.Source,"onUpdate:modelValue":g[1]||(g[1]=S=>I.value.Source=S),variant:"outlined"},null,8,["items","modelValue"])]),_:1})]),_:1}),t(K,null,{default:a(()=>[t(k,{cols:"12",sm:"8",md:"10"},{default:a(()=>[t(Ue,{label:"Description","hide-details":"",modelValue:I.value.Description,"onUpdate:modelValue":g[2]||(g[2]=S=>I.value.Description=S),variant:"outlined"},null,8,["modelValue"])]),_:1}),t(k,{cols:"12",sm:"4",md:"2"},{default:a(()=>[t(Ue,{label:"Amount","prepend-inner-icon":"mdi:mdi-currency-gbp","hide-details":"",modelValue:I.value.Amount,"onUpdate:modelValue":g[3]||(g[3]=S=>I.value.Amount=S),modelModifiers:{number:!0},variant:"outlined"},null,8,["modelValue"])]),_:1})]),_:1}),t(K,null,{default:a(()=>[t(k,{cols:"12",sm:"3",md:"2",lg:"1"},{default:a(()=>[t(q,{class:"w-100",onClick:g[4]||(g[4]=S=>f("close-editor")),color:"warning"},{default:a(()=>[O("Cancel")]),_:1})]),_:1}),t(Ne),t(k,{cols:"12",sm:"6",md:"3",lg:"2",xl:"2"},{default:a(()=>[t(q,{class:"w-100",onClick:G,color:"primary"},{default:a(()=>[O("Submit Transaction")]),_:1})]),_:1})]),_:1})],64)):B("",!0),y.value.length&&!F(i)?(m(),N(It,{key:1,class:"my-2",modelValue:d.value,"onUpdate:modelValue":g[10]||(g[10]=S=>d.value=S)},{default:a(()=>[t(St,{value:"1"},{default:a(()=>[t(Tt,null,{default:a(()=>[O(" Transaction History ")]),_:1}),t(yt,null,{default:a(()=>[t(F(Et),{items:y.value,headers:T.value,"show-expand":!1,"item-value":"PaymentTransactionUUID",expanded:o.value,"onUpdate:expanded":g[5]||(g[5]=S=>o.value=S),"sort-by":M.value,"onUpdate:sortBy":g[6]||(g[6]=S=>M.value=S),class:"transactionTable"},{"item.Controls":a(({item:S})=>[_.canEdit&&S.raw.PaymentTransaction.Source===F(xt).PAYMENT_TRANSACTION_SOURCE_STRIPE&&S.raw.PaymentTransaction.Type===F(pt).PAYMENT_TRANSACTION_TYPE_PAYMENT?(m(),N(q,{key:0,icon:"mdi:mdi-credit-card-refund",variant:"text",size:"xs",onClick:h=>W(S.key)},null,8,["onClick"])):B("",!0)]),"expanded-row":a(({columns:S,item:h})=>[w("tr",null,[w("td",{colspan:S.length},[no,w("div",{innerHTML:h.raw.HTML},null,8,oo)],8,lo)])]),"footer.prepend":a(()=>[t(q,{"prepend-icon":"mdi:mdi-refresh",color:"primary",class:"mr-4",onClick:Q},{default:a(()=>[O("Refresh")]),_:1})]),_:1},8,["items","headers","expanded","sort-by"]),U.value&&r.value?(m(),N(ao,{key:0,modelValue:U.value,"onUpdate:modelValue":g[7]||(g[7]=S=>U.value=S),"payment-transaction":r.value,onRefunded:ae},null,8,["modelValue","payment-transaction"])):B("",!0),t(va,{modelValue:v.value,"onUpdate:modelValue":g[9]||(g[9]=S=>v.value=S)},{actions:a(()=>[t(q,{variant:"text",onClick:g[8]||(g[8]=S=>v.value=!1)},{default:a(()=>[O(" Close ")]),_:1})]),default:a(()=>[O(C(p.value)+" ",1)]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])):B("",!0)],64))}});const so=(e=void 0,f)=>e===void 0?!1:Rt(e,Dt.GROUP_TYPE_CONVENTION,f.ConventionUUID,f).EditPaymentTransactions,ut=e=>(Jt("data-v-861debd5"),e=e(),Xt(),e),uo={class:"mb-4"},ro={class:"v-row"},mo={key:0,class:"v-col v-col-10 py-1 v-row mx-0 pl-0"},vo={class:"v-col v-col-12 v-col-sm-4 v-col-md-3 font-weight-bold pb-0 pr-0"},co={class:"v-col v-col-12 v-col-sm-8 v-col-md-9 font-italic pt-0 pt-sm-3 pb-sm-0 pl-sm-0"},fo={class:"v-col v-col-2 align-self-end text-right py-1 text-no-wrap"},Uo=ut(()=>w("dt",{class:"v-col v-col-9 py-1 font-weight-bold totals"}," Total Charges ",-1)),_o={class:"v-col v-col-3 align-self-end text-right py-1 totals text-no-wrap"},po=ut(()=>w("dt",{class:"v-col v-col-9 py-1 font-weight-bold"}," Applied Total ",-1)),go={class:"v-col v-col-3 align-self-end text-right py-1 text-no-wrap"},Ao=ut(()=>w("dt",{class:"v-col v-col-9 py-1 font-weight-bold"}," Currently Paid ",-1)),To={class:"v-col v-col-3 align-self-end text-right py-1 text-no-wrap"},yo=ut(()=>w("dt",{class:"v-col v-col-9 py-1 font-weight-bold totals"}," Balance ",-1)),Eo={class:"v-col v-col-3 align-self-end text-right py-1 totals text-no-wrap"},So=ee({__name:"PaymentActions",props:se({forms:{},title:{}},{modelValue:{required:!0}}),emits:["update:modelValue"],setup(e){const f=c(!1),s=c(),i=c([]),n=c(new Date().getTime()),l=c(!1),u=Te(e,"modelValue"),o=c(ve(u.value));de(u,()=>{o.value=ve(u.value)});const d=Ae();d.getConvention(u.value.ConventionUUID).then(r=>{r&&(l.value=so(Vt(),r))});const y=()=>{d.generateRegistrationCharges(u.value.RegistrationUUID,!1).then(r=>{r&&(i.value=r.PaymentTransactions,s.value=r.Registration,n.value=new Date().getTime())}).catch(()=>{})};y();const T=()=>{d.generateRegistrationCharges(u.value.RegistrationUUID,!0).then(r=>{r&&(i.value=r.PaymentTransactions,s.value=r.Registration,n.value=new Date().getTime())})},{totalCharges:U}=ua();return(r,v)=>(m(),N(Oe,null,{default:a(()=>[t(He,null,{default:a(()=>[t(Me,null,{default:a(()=>[O(" Payments (#"+C(u.value.Reference)+" "+C(u.value.User.DisplayName)+") ",1)]),_:1})]),_:1}),t(Le,null,{default:a(()=>[s.value?(m(),D(P,{key:0},[w("h3",uo,"#"+C(s.value.Reference)+" "+C(s.value.User.DisplayName),1),w("dl",ro,[(m(!0),D(P,null,Z(i.value,p=>(m(),D(P,{key:p.PaymentTransactionUUID},[p.Type===F(pt).PAYMENT_TRANSACTION_TYPE_CHARGE?(m(),D("dt",mo,[w("div",vo,C(p.Description.split(":")[0])+": ",1),w("div",co,C(p.Description.split(":")[1]),1)])):B("",!0),w("dd",fo," £"+C(p.Amount),1)],64))),128)),Uo,w("dd",_o," £"+C(F(U)(i.value)),1),po,w("dd",go," £"+C(s.value.Total),1),Ao,w("dd",To," £"+C(s.value.Paid),1),yo,w("dd",Eo," £"+C(s.value.Total-s.value.Paid),1)]),t(K,{class:"flex-row-reverse"},{default:a(()=>[t(k,{class:"text-right"},{default:a(()=>[t(q,{color:"primary",onClick:T},{default:a(()=>[O("Apply Charges")]),_:1})]),_:1}),!f.value&&l.value?(m(),N(k,{key:0},{default:a(()=>[t(q,{color:"secondary",onClick:v[0]||(v[0]=p=>f.value=!0)},{default:a(()=>[O("Transaction Entry")]),_:1})]),_:1})):B("",!0)]),_:1})],64)):B("",!0),t(io,{"can-edit":l.value,registration:u.value,"show-editor":f.value,onCloseEditor:v[1]||(v[1]=p=>f.value=!1),updated:n.value,onChange:y},null,8,["can-edit","registration","show-editor","updated"])]),_:1})]),_:1}))}});const Io=st(So,[["__scopeId","data-v-861debd5"]]),Do=ee({__name:"RegistrationFormStatus",props:se({forms:{}},{modelValue:{required:!0}}),emits:["update:modelValue"],setup(e){const f=Ae(),s=Te(e,"modelValue"),i=(n,l)=>{const u=s.value.Submissions.find(o=>o.SubmissionUUID==l);if(!u){n&&n("Submission not found");return}f.setSubmissionStatus(l,u.Status).then(o=>{o?(s.value.Submissions.forEach((d,y)=>{s.value.Submissions[y].Status=d.Status}),n&&n("Status Saved")):n&&n("Status not saved")}).catch(()=>{n&&n("Status not saved")})};return(n,l)=>(m(),N(Oe,null,{default:a(()=>[t(He,null,{default:a(()=>[t(Me,null,{default:a(()=>[O("Status (#"+C(s.value.Reference)+" "+C(s.value.User.DisplayName)+")",1)]),_:1})]),_:1}),t(Le,null,{default:a(()=>[t(ot,null,{default:a(()=>[(m(!0),D(P,null,Z(s.value.Submissions,u=>(m(),N(We,{key:u.SubmissionUUID,class:"pa-0"},{default:a(()=>[t(K,{class:"py-2 align-center"},{default:a(()=>[t(k,{cols:"9",sm:"10",md:"10",lg:"9"},{default:a(()=>{var o;return[t(ce,{modelValue:u.Status,"onUpdate:modelValue":d=>u.Status=d,items:F(Bt),"item-text":"title","item-value":"value",variant:"outlined","hide-details":"",label:((o=n.forms.find(d=>d.FormUUID==u.FormUUID))==null?void 0:o.Name)||""},{selection:a(()=>[t(_t,{class:"mr-4 d-none d-sm-inline"},{default:a(()=>{var d;return[O(C((d=F(Bt).find(y=>y.value===u.Status))==null?void 0:d.icon),1)]}),_:2},1024),O(" "+C(F(ra)(u.Status)),1)]),item:a(({item:d,props:{onClick:y}})=>[t(We,{title:d.title,"prepend-icon":d.raw.icon,onClick:y},null,8,["title","prepend-icon","onClick"])]),_:2},1032,["modelValue","onUpdate:modelValue","items","label"])]}),_:2},1024),t(k,{cols:"3",sm:"2",md:"2",lg:"1"},{default:a(()=>[t(Ze,{class:"d-none d-sm-inline-flex",title:"Save","prepend-icon":"mdi:mdi-content-save",color:"warning",onClick:o=>i(o.callback,u.SubmissionUUID)},null,8,["onClick"]),t(Ze,{class:"d-sm-none",size:"35",icon:"mdi:mdi-content-save",color:"warning",onClick:o=>i(o.callback,u.SubmissionUUID)},null,8,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1}))}}),Ro=e=>(Jt("data-v-a4024c39"),e=e(),Xt(),e),Co=Ro(()=>w("p",null,"Any tags controlled through registration form fields will be reset when the applicable form is saved. If you don't know what you're doing here, don't touch!",-1)),Vo={class:"mb-4"},Oo=ee({__name:"RegistrationTags",props:se({title:{}},{modelValue:{required:!0}}),emits:["update:modelValue"],setup(e){const f=Ae(),s=Te(e,"modelValue"),i=c(ve(s.value)),n=c(!1),l=c(i.value.Tags);de(s,()=>{i.value=ve(s.value)});const u=({callback:o})=>{const d=[],y=[];i.value.Tags.forEach(T=>{l.value.find(r=>r.TagUUID===T.TagUUID)||d.push(T.TagUUID)}),l.value.forEach(T=>{i.value.Tags.find(r=>T.TagUUID===r.TagUUID)||y.push(T.TagUUID)}),f.updateRegistrationTags(d,y,i.value.RegistrationUUID).then(T=>{T?o&&(o("Tags Saved"),s.value.Tags=T.Tags):o&&o("Error Saving Tags")}).catch(()=>{o&&o("Error Saving Tags")})};return(o,d)=>(m(),N(Oe,null,{default:a(()=>[t(He,null,{default:a(()=>[t(Me,null,{default:a(()=>[O("Tags (#"+C(i.value.Reference)+" "+C(i.value.User.DisplayName)+")",1)]),_:1})]),_:1}),t(Le,null,{default:a(()=>[t(kl,{class:"my-4"},{default:a(()=>[t(Nl,null,{default:a(()=>[O("Caution")]),_:1}),Co]),_:1}),w("h3",Vo,"#"+C(i.value.Reference)+" "+C(i.value.User.DisplayName),1),t(ta,{modelValue:i.value.Tags,"onUpdate:modelValue":d[0]||(d[0]=y=>i.value.Tags=y),convention:i.value.ConventionUUID,"show-key":!0,chips:!0,"show-uuid":n.value},null,8,["modelValue","convention","show-uuid"])]),_:1}),t(Ct,{class:"px-4 align-start"},{default:a(()=>[t(ia,{label:"Show UUID",modelValue:n.value,"onUpdate:modelValue":d[1]||(d[1]=y=>n.value=y)},null,8,["modelValue"]),t(Ze,{onClick:u,variant:"flat"})]),_:1})]),_:1}))}});const ho=st(Oo,[["__scopeId","data-v-a4024c39"]]),zt=ee({__name:"RegistrationActionWindows",props:se({accommodations:{},convention:{},extras:{},forms:{},interests:{},registration:{},tickets:{},venues:{}},{modelValue:{required:!0}}),emits:se(["update:registration"],["update:modelValue"]),setup(e,{emit:f}){const s=e,i=Te(e,"modelValue"),n=et(s,f,void 0,void 0,"registration");return(l,u)=>(m(),N(na,{modelValue:i.value,"onUpdate:modelValue":u[3]||(u[3]=o=>i.value=o)},{default:a(()=>[t(ke,{value:"badges"},{default:a(()=>[i.value=="badges"?(m(),N(fe,{key:0,class:"pa-0 mx-0",fluid:!0},{default:a(()=>[t(Vn,{convention:l.convention,registration:F(n)},null,8,["convention","registration"])]),_:1})):B("",!0)]),_:1}),t(ke,{value:"emails"},{default:a(()=>[i.value=="emails"?(m(),N(fe,{key:0,class:"pa-0 mx-0",fluid:!0},{default:a(()=>[t(Qn,{registration:F(n)},null,8,["registration"])]),_:1})):B("",!0)]),_:1}),t(ke,{value:"notes"},{default:a(()=>[i.value=="notes"?(m(),N(fe,{key:0,class:"pa-0 mx-0",fluid:!0},{default:a(()=>[t(to,{convention:l.convention,registration:F(n)},null,8,["convention","registration"])]),_:1})):B("",!0)]),_:1}),t(ke,{value:"payments"},{default:a(()=>[i.value=="payments"?(m(),N(fe,{key:0,class:"pa-0 mx-0",fluid:!0},{default:a(()=>[t(Io,{modelValue:F(n),"onUpdate:modelValue":u[0]||(u[0]=o=>Ke(n)?n.value=o:null),forms:l.forms,title:"Registration Payments"},null,8,["modelValue","forms"])]),_:1})):B("",!0)]),_:1}),t(ke,{value:"status"},{default:a(()=>[i.value=="status"?(m(),N(fe,{key:0,class:"pa-0 mx-0",fluid:!0},{default:a(()=>[t(Do,{modelValue:F(n),"onUpdate:modelValue":u[1]||(u[1]=o=>Ke(n)?n.value=o:null),forms:l.forms},null,8,["modelValue","forms"])]),_:1})):B("",!0)]),_:1}),t(ke,{value:"tags"},{default:a(()=>[i.value=="tags"?(m(),N(fe,{key:0,class:"pa-0 mx-0",fluid:!0},{default:a(()=>[t(ho,{modelValue:F(n),"onUpdate:modelValue":u[2]||(u[2]=o=>Ke(n)?n.value=o:null),title:"Registration Tags"},null,8,["modelValue"])]),_:1})):B("",!0)]),_:1})]),_:1},8,["modelValue"]))}}),bo=(e,f)=>e===void 0?!1:Rt(e,Dt.GROUP_TYPE_CONVENTION,f.ConventionUUID,f).ViewPaymentTransactions,Qt=ee({__name:"RegistrationActions",props:se({accommodations:{},convention:{},extras:{},forms:{},interests:{},registration:{},tickets:{},title:{},useDialog:{type:Boolean},venues:{}},{modelValue:{type:Boolean,required:!0}}),emits:se(["update:registration"],["update:modelValue"]),setup(e,{emit:f}){const s=e,i=Te(e,"modelValue"),n=et(s,f,void 0,void 0,"registration"),l=c("notes"),u=Vt(),o=[{label:"Badge",value:"badges"},{label:"Emails",value:"emails"},{label:"Notes",value:"notes"},{label:"Status",value:"status"},{label:"Tags",value:"tags"}];return bo(u,s.convention)&&o.splice(2,0,{label:"Payments",value:"payments"}),(d,y)=>d.useDialog?(m(),N(Ye,{key:0,modelValue:i.value,"onUpdate:modelValue":y[3]||(y[3]=T=>i.value=T),title:d.title,"show-close-action":!0,color:"primary","close-action-label":"Close",persistent:!0,"retain-focus":!1,scrollable:!0,fullscreen:"","card-class":"ma-0 pa-0"},{extension:a(()=>[t(Yt,{modelValue:l.value,"onUpdate:modelValue":y[0]||(y[0]=T=>l.value=T),tabs:o,"show-arrows":!0},null,8,["modelValue"])]),default:a(()=>[t(zt,{modelValue:l.value,"onUpdate:modelValue":y[1]||(y[1]=T=>l.value=T),registration:F(n),"onUpdate:registration":y[2]||(y[2]=T=>Ke(n)?n.value=T:null),accommodations:d.accommodations,convention:d.convention,extras:d.extras,forms:d.forms,interests:d.interests,tabs:o,tickets:d.tickets,venues:d.venues},null,8,["modelValue","registration","accommodations","convention","extras","forms","interests","tickets","venues"])]),_:1},8,["modelValue","title"])):(m(),D(P,{key:1},[t(Yt,{modelValue:l.value,"onUpdate:modelValue":y[4]||(y[4]=T=>l.value=T),tabs:o,"show-arrows":!0},null,8,["modelValue"]),t(zt,{modelValue:l.value,"onUpdate:modelValue":y[5]||(y[5]=T=>l.value=T),registration:F(n),"onUpdate:registration":y[6]||(y[6]=T=>Ke(n)?n.value=T:null),accommodations:d.accommodations,convention:d.convention,extras:d.extras,forms:d.forms,interests:d.interests,tabs:o,tickets:d.tickets,venues:d.venues},null,8,["modelValue","registration","accommodations","convention","extras","forms","interests","tickets","venues"])],64))}});const ko=(e,f=500,s=!1)=>{let i;return(...n)=>{const u=function(){i=void 0,s||e.apply(void 0,n)},o=s&&!i;clearTimeout(i),i=setTimeout(u,f),o&&e.apply(void 0,n)}};function No(){const e=c([]);La(()=>e.value=[]);function f(s,i){e.value[i]=s}return{refs:e,updateRef:f}}const Mo=Kt({activeColor:String,start:{type:[Number,String],default:1},modelValue:{type:Number,default:e=>e.start},disabled:Boolean,length:{type:[Number,String],default:1,validator:e=>e%1===0},totalVisible:[Number,String],firstIcon:{type:lt,default:"$first"},prevIcon:{type:lt,default:"$prev"},nextIcon:{type:lt,default:"$next"},lastIcon:{type:lt,default:"$last"},ariaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.root"},pageAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.page"},currentPageAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.currentPage"},firstAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.first"},previousAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.previous"},nextAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.next"},lastAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.last"},ellipsis:{type:String,default:"..."},showFirstLastPage:Boolean,...vl(),...cl(),...fl(),...Ul(),..._l(),...pl(),...gl({tag:"nav"}),...wa(),...Al({variant:"text"})},"VPagination"),Lo=Wt()({name:"VPagination",props:Mo(),emits:{"update:modelValue":e=>!0,first:e=>!0,prev:e=>!0,next:e=>!0,last:e=>!0},setup(e,f){let{slots:s,emit:i}=f;const n=Pa(e,"modelValue"),{t:l,n:u}=Fa(),{isRtl:o}=$a(),{themeClasses:d}=xa(e),{width:y}=Ba(),T=Ga(-1);Ut(void 0,{scoped:!0});const{resizeRef:U}=Sl(_=>{if(!_.length)return;const{target:g,contentRect:S}=_[0],h=g.querySelector(".v-pagination__list > *");if(!h)return;const $=S.width,X=h.offsetWidth+parseFloat(getComputedStyle(h).marginRight)*2;T.value=M($,X)}),r=re(()=>parseInt(e.length,10)),v=re(()=>parseInt(e.start,10)),p=re(()=>e.totalVisible?parseInt(e.totalVisible,10):T.value>=0?T.value:M(y.value,58));function M(_,g){const S=e.showFirstLastPage?5:3;return Math.max(0,Math.floor(+((_-g*S)/g).toFixed(2)))}const Y=re(()=>{if(r.value<=0||isNaN(r.value)||r.value>Number.MAX_SAFE_INTEGER)return[];if(p.value<=1)return[n.value];if(r.value<=p.value)return nt(r.value,v.value);const _=p.value%2===0,g=_?p.value/2:Math.floor(p.value/2),S=_?g:g+1,h=r.value-g;if(S-n.value>=0)return[...nt(Math.max(1,p.value-1),v.value),e.ellipsis,r.value];if(n.value-h>=(_?1:0)){const $=p.value-1,X=r.value-$+v.value;return[v.value,e.ellipsis,...nt($,X)]}else{const $=Math.max(1,p.value-3),X=$===1?n.value:n.value-Math.ceil($/2)+v.value;return[v.value,e.ellipsis,...nt($,X),e.ellipsis,r.value]}});function I(_,g,S){_.preventDefault(),n.value=g,S&&i(S,g)}const{refs:V,updateRef:L}=No();Ut({VPaginationBtn:{color:ge(e,"color"),border:ge(e,"border"),density:ge(e,"density"),size:ge(e,"size"),variant:ge(e,"variant"),rounded:ge(e,"rounded"),elevation:ge(e,"elevation")}});const Q=re(()=>Y.value.map((_,g)=>{const S=h=>L(h,g);if(typeof _=="string")return{isActive:!1,key:`ellipsis-${g}`,page:_,props:{ref:S,ellipsis:!0,icon:!0,disabled:!0}};{const h=_===n.value;return{isActive:h,key:_,page:u(_),props:{ref:S,ellipsis:!1,icon:!0,disabled:!!e.disabled||+e.length<2,color:h?e.activeColor:e.color,ariaCurrent:h,ariaLabel:l(h?e.currentPageAriaLabel:e.pageAriaLabel,_),onClick:$=>I($,_)}}}})),G=re(()=>{const _=!!e.disabled||n.value<=v.value,g=!!e.disabled||n.value>=v.value+r.value-1;return{first:e.showFirstLastPage?{icon:o.value?e.lastIcon:e.firstIcon,onClick:S=>I(S,v.value,"first"),disabled:_,ariaLabel:l(e.firstAriaLabel),ariaDisabled:_}:void 0,prev:{icon:o.value?e.nextIcon:e.prevIcon,onClick:S=>I(S,n.value-1,"prev"),disabled:_,ariaLabel:l(e.previousAriaLabel),ariaDisabled:_},next:{icon:o.value?e.prevIcon:e.nextIcon,onClick:S=>I(S,n.value+1,"next"),disabled:g,ariaLabel:l(e.nextAriaLabel),ariaDisabled:g},last:e.showFirstLastPage?{icon:o.value?e.firstIcon:e.lastIcon,onClick:S=>I(S,v.value+r.value-1,"last"),disabled:g,ariaLabel:l(e.lastAriaLabel),ariaDisabled:g}:void 0}});function W(){var g;const _=n.value-v.value;(g=V.value[_])==null||g.$el.focus()}function ae(_){_.key===Lt.left&&!e.disabled&&n.value>+e.start?(n.value=n.value-1,Ge(W)):_.key===Lt.right&&!e.disabled&&n.value<v.value+r.value-1&&(n.value=n.value+1,Ge(W))}return oa(()=>t(e.tag,{ref:U,class:["v-pagination",d.value,e.class],style:e.style,role:"navigation","aria-label":l(e.ariaLabel),onKeydown:ae,"data-test":"v-pagination-root"},{default:()=>[t("ul",{class:"v-pagination__list"},[e.showFirstLastPage&&t("li",{key:"first",class:"v-pagination__first","data-test":"v-pagination-first"},[s.first?s.first(G.value.first):t(q,Re({_as:"VPaginationBtn"},G.value.first),null)]),t("li",{key:"prev",class:"v-pagination__prev","data-test":"v-pagination-prev"},[s.prev?s.prev(G.value.prev):t(q,Re({_as:"VPaginationBtn"},G.value.prev),null)]),Q.value.map((_,g)=>t("li",{key:_.key,class:["v-pagination__item",{"v-pagination__item--is-active":_.isActive}],"data-test":"v-pagination-item"},[s.item?s.item(_):t(q,Re({_as:"VPaginationBtn"},_.props),{default:()=>[_.page]})])),t("li",{key:"next",class:"v-pagination__next","data-test":"v-pagination-next"},[s.next?s.next(G.value.next):t(q,Re({_as:"VPaginationBtn"},G.value.next),null)]),e.showFirstLastPage&&t("li",{key:"last",class:"v-pagination__last","data-test":"v-pagination-last"},[s.last?s.last(G.value.last):t(q,Re({_as:"VPaginationBtn"},G.value.last),null)])])]})),{}}}),wo=["colspan"],Po={style:{opacity:"var(--v-medium-emphasis-opacity)"}},Si=ee({__name:"RegistrationsView",emits:["pageTitle"],setup(e,{emit:f}){var bt;const s=ma();f("pageTitle","Registration Manager");const i=Ya(),n=Ha(),l=c(!0);let u=((bt=i.params.convention)==null?void 0:bt.toString())||"";const o=c({ID:0,ConventionUUID:Ce(),OrganisationID:0,OrganisationUUID:ct,Name:"New Convention",Description:"",DetailLink:"",Logo:"",Slug:"",Accommodation:[],Tickets:[],Extras:[],Interests:[],Visible:!1}),d=Ae(),y=ja.getInstance(),T=c([]),U=c({ID:0,AdminLayoutUUID:Ce(),ConventionID:o.value.ID,ConventionUUID:o.value.ConventionUUID,Name:"Registration Table",Type:it.ADMIN_LAYOUT_TABLE,Panels:[]}),r=c([]),v=c([]),p=c([]),M=c([]),Y=c([]),I=c(1),V=c(10),L=c([]),Q=c(0),G=c(!1),W=c(""),ae=c(""),_=c(""),g=c(""),S=c({FieldUUID:"591c9bca-c78c-4e97-8aef-bc596ef472fb",Value:""}),h=c(new Map([["591c9bca-c78c-4e97-8aef-bc596ef472fb",S.value]])),$=c(""),X=c(""),me=c([]),ne=c([]),we=c([]),Pe=c([]),Fe=c([]),$e=c([]),_e=c(0),pe=c(),ye=c(!1),je=c(!1),Ua=c(!1),tt=c(),Ot=c(),rt=c(),xe=c(!1),_a=Vt(),Ve=ko(()=>{ae.value=Date.now().toString()});de(W,A=>{const E=Y.value.find(b=>b.uuid===A);if(E){const b=E.headers.find(R=>R.defaultSort===!0);b&&(L.value=[{key:b.key,order:"asc"}],me.value=[{key:b.key,order:"asc"}])}}),de(_e,A=>{A===7&&ht()}),de($,()=>{Ve()}),de(X,()=>{Ve()});const pa=()=>{r.value=[],p.value=[],Y.value=[];try{d.getConventionAdminLayoutByName(o.value.ConventionUUID,"Registration Table").then(A=>{_e.value+=1,A?U.value=A:(U.value.ConventionID=o.value.ID,U.value.ConventionUUID=o.value.ConventionUUID)})}catch{U.value.ConventionID=o.value.ID,U.value.ConventionUUID=o.value.ConventionUUID}try{d.getConventionForms(o.value.ConventionUUID).then(A=>{_e.value+=1,A&&(r.value=A)})}catch{}try{d.getConventionAccommodation(o.value.ConventionUUID).then(A=>{_e.value+=1,A&&(ne.value=A)})}catch{}try{d.getConventionVenues(o.value.ConventionUUID).then(A=>{_e.value+=1,A&&($e.value=A)})}catch{}try{d.getConventionExtras(o.value.ConventionUUID).then(A=>{_e.value+=1,A&&(we.value=A)})}catch{}try{d.getConventionInterests(o.value.ConventionUUID).then(A=>{_e.value+=1,A&&(Pe.value=A)})}catch{}try{d.getConventionTickets(o.value.ConventionUUID).then(A=>{_e.value+=1,A&&(Fe.value=A)})}catch{}try{d.getConventionGroups(o.value.ConventionUUID).then(A=>{A&&(v.value=A.sort((E,b)=>E.Name.localeCompare(b.Name)))})}catch{}try{d.getConventionTags(o.value.ConventionUUID).then(A=>{A&&(M.value=A.sort((E,b)=>E.Title.localeCompare(b.Title)).map(E=>(E.Title=`${E.Title} [${E.Key}]`,E)))})}catch{}},dt=({page:A,itemsPerPage:E,sortBy:b})=>{l.value=!0,I.value=A,L.value=b;const R=Y.value.find(oe=>oe.uuid==W.value),ue=R==null?void 0:R.layout.Items;let le="",kt="";if(b&&ue&&b.length>=1){const oe=ue.find(qe=>qe.LayoutItemUUID==b[0].key);switch(kt=b[0].order||"asc",oe==null?void 0:oe.MetaField){case te.META_DATA_SOURCE_ACCOMMODATION_FORM:le="submission.status";break;case te.META_DATA_SOURCE_BADGE_FORM:le="submission.status";break;case te.META_DATA_SOURCE_DEALER_FORM:le="submission.status";break;case te.META_DATA_SOURCE_REGISTRATION_FORM:le="submission.status";break;case te.META_DATA_SOURCE_REGISTRATION_REFERENCE:le="reference";break;case te.META_DATA_SOURCE_SUBMISSION_DATE:le="created";break;case te.META_DATA_SOURCE_SUBMISSION_STATUS:le="submission.status";break}switch(oe==null?void 0:oe.UserField){case ie.USER_DATA_SOURCE_DISPLAY_NAME:le="user.display_name";break;case ie.USER_DATA_SOURCE_EMAIL:le="user.email";break;case ie.USER_DATA_SOURCE_FIRST_NAME:le="user.firstname";break;case ie.USER_DATA_SOURCE_HANDLE:le="user.handle";break;case ie.USER_DATA_SOURCE_LAST_NAME:le="user.lastname";break}}try{const oe={Direction:kt,Limit:E,Offset:(A-1)*E,Order:le};R&&R.layout.RequiredRegistrationTags.length>0&&(oe.PanelUUID=R==null?void 0:R.layout.LayoutPanelUUID),(R==null?void 0:R.layout.RequiredFormType)===De.FORM_TYPE_ACCOMMODATION&&(oe.Accommodation=!0),(R==null?void 0:R.layout.RequiredFormType)===De.FORM_TYPE_BADGE&&(oe.Badge=!0),(R==null?void 0:R.layout.RequiredFormType)===De.FORM_TYPE_DEALER&&(oe.Dealer=!0),(R==null?void 0:R.layout.RequiredFormType)===De.FORM_TYPE_REGISTRATION&&(oe.Registration=!0),oe.GroupUUID=$.value||ct,oe.TagUUID=X.value||ct,oe.Email=g.value,oe.Reference=_.value,oe.FieldValues=Array.from(h.value.values()),d.searchConventionRegistrations(o.value.ConventionUUID,oe).then(qe=>{qe&&(Q.value=qe.Total,p.value=qe.Registrations,Y.value.forEach(vt=>{const Ra=vt.layout;vt.items=p.value.map(H=>{const at=[];let Se;H.Leader?Se=H:Se=H.Primary,at.push({Name:Se.User.DisplayName,UUID:Se.UserUUID,UserUUID:Se.User.UserUUID,IsLeader:!0,Reference:Se.Reference,Paid:Se.Paid,Total:Se.Total}),at.push(...Se.Members.map(Ie=>({Name:Ie.User.DisplayName,UUID:Ie.UserUUID,UserUUID:Ie.User.UserUUID,IsLeader:!1,Reference:Ie.Reference,Paid:Ie.Paid,Total:Ie.Total})));const J={};return vt.headers.forEach(Ie=>{var Nt;const j=Ra.Items.find(ze=>ze.LayoutItemUUID===Ie.key);if(j){if(j.SourceType==="LAYOUT_ITEM_SOURCE_FORM"&&j.SectionField)H.Submissions.forEach(ze=>{const Be=ze.Data.find(x=>x.SectionFieldUUID===j.SectionFieldUUID);if(Be){Ie.type===Ka.ACCOMMODATION?J[j.LayoutItemUUID]={Data:Be.Data,Registration:H}:J[j.LayoutItemUUID]=Be.Data;return}});else if(j.SourceType==="LAYOUT_ITEM_SOURCE_USER"&&j.UserField)switch(j.UserField){case ie.USER_DATA_SOURCE_AVATAR:J[j.LayoutItemUUID]=s.GetProfileImageURL(H.UserUUID);break;case ie.USER_DATA_SOURCE_DISPLAY_NAME:J[j.LayoutItemUUID]=H.User.DisplayName;break;case ie.USER_DATA_SOURCE_EMAIL:J[j.LayoutItemUUID]=H.User.Additional.Email;break;case ie.USER_DATA_SOURCE_HANDLE:J[j.LayoutItemUUID]=H.User.Handle;break;case ie.USER_DATA_SOURCE_DATE_OF_BIRTH:J[j.LayoutItemUUID]=H.User.Additional.DOB;break;case ie.USER_DATA_SOURCE_FIRST_NAME:J[j.LayoutItemUUID]=H.User.Additional.FirstName;break;case ie.USER_DATA_SOURCE_LAST_NAME:J[j.LayoutItemUUID]=H.User.Additional.LastName;break;case ie.USER_DATA_SOURCE_TELEGRAM:J[j.LayoutItemUUID]="";break}else if(j.SourceType==="LAYOUT_ITEM_SOURCE_META"&&j.MetaField){const ze=(Nt=r.value.find(x=>x.Type===De.FORM_TYPE_REGISTRATION))==null?void 0:Nt.FormUUID,Be=H.Submissions.find(x=>x.FormUUID===ze);switch(j.MetaField){case te.META_DATA_SOURCE_REGISTRATION_ACTIONS:J[j.LayoutItemUUID]=H;break;case te.META_DATA_SOURCE_REGISTRATION_GROUP:J[j.LayoutItemUUID]=at;break;case te.META_DATA_SOURCE_REGISTRATION_REFERENCE:J[j.LayoutItemUUID]=H.Reference;break;case te.META_DATA_SOURCE_SUBMISSION_DATE:if(Be){const x=new Date(Be.CreatedAt||"");J[j.LayoutItemUUID]=`${x.getFullYear()}-${(x.getMonth()+1).toString().padStart(2,"0")}-${x.getDate().toString().padStart(2,"0")} ${x.getHours().toString().padStart(2,"0")}:${x.getMinutes().toString().padStart(2,"0")}:${x.getSeconds().toString().padStart(2,"0")}`}else{const x=new Date(H.CreatedAt||"");J[j.LayoutItemUUID]=`${x.getFullYear()}-${(x.getMonth()+1).toString().padStart(2,"0")}-${x.getDate().toString().padStart(2,"0")} ${x.getHours().toString().padStart(2,"0")}:${x.getMinutes().toString().padStart(2,"0")}:${x.getSeconds().toString().padStart(2,"0")}`}break;case te.META_DATA_SOURCE_ACCOMMODATION_FORM:J[j.LayoutItemUUID]=H.Submissions.map(x=>{const z=r.value.find(he=>he.FormUUID===x.FormUUID);return{Heading:z==null?void 0:z.Heading,Form:z,Submission:x,Registration:H}}).filter(x=>{var z;return((z=x.Form)==null?void 0:z.Type)===De.FORM_TYPE_ACCOMMODATION});break;case te.META_DATA_SOURCE_BADGE_FORM:J[j.LayoutItemUUID]=H.Submissions.map(x=>{const z=r.value.find(he=>he.FormUUID===x.FormUUID);return{Heading:z==null?void 0:z.Heading,Form:z,Submission:x,Registration:H}}).filter(x=>{var z;return((z=x.Form)==null?void 0:z.Type)===De.FORM_TYPE_BADGE});break;case te.META_DATA_SOURCE_DEALER_FORM:J[j.LayoutItemUUID]=H.Submissions.map(x=>{const z=r.value.find(he=>he.FormUUID===x.FormUUID);return{Heading:z==null?void 0:z.Heading,Form:z,Submission:x,Registration:H}}).filter(x=>{var z;return((z=x.Form)==null?void 0:z.Type)===De.FORM_TYPE_DEALER});break;case te.META_DATA_SOURCE_PAYMENT_STATUS:if(H.Paid===0&&H.Total)J[j.LayoutItemUUID]="REQUIRED";else if(H.Total>H.Paid)J[j.LayoutItemUUID]="ADDITIONAL_REQUIRED";else{const x=at.find(z=>z.Paid===0&&(z.Total||0)>0);if(x){H.Total===0&&x.Total===0?J[j.LayoutItemUUID]="NOT_REQUIRED":H.Total===0&&x.Total||H.Total>0&&x.Total===0?J[j.LayoutItemUUID]="MISSING_REQUIRED":H.Paid>=H.Total?J[j.LayoutItemUUID]="AWAITING_PARTNER":J[j.LayoutItemUUID]="ALL_REQUIRED";break}else H.Total===0?J[j.LayoutItemUUID]="NOT_REQUIRED":J[j.LayoutItemUUID]="COMPLETE"}break;case te.META_DATA_SOURCE_SUBMISSION_STATUS:Dl(H.Submissions,r.value),J[j.LayoutItemUUID]=H.Submissions.map(x=>{const z=r.value.find(he=>he.FormUUID===x.FormUUID);return{Heading:z==null?void 0:z.Heading,Form:z,Submission:x,Registration:H}});break}}}}),{key:H.RegistrationUUID,registration:H,...J}})}),l.value=!1)})}catch{}},ga=A=>{G.value=!1,A&&(U.value=A,ht())},ht=()=>{U.value.Panels.forEach(A=>{A.Items.forEach(E=>{(E.SectionField==null||E.SectionField.Field==null)&&r.value.find(b=>{b.Sections.find(R=>{if(R.Fields){const ue=R.Fields.find(le=>le.SectionFieldUUID===E.SectionFieldUUID);if(ue)return E.SectionField=ue,!0}})})})}),U.value.Panels.length>0&&(Y.value=[],U.value.Panels.forEach(A=>{const E={uuid:Ce(),order:A.Order,name:A.Name,headers:[],items:[],layout:A};A.Items.sort((b,R)=>b.Order>R.Order?1:b.Order==R.Order?0:-1),E.headers=A.Items.map(b=>{var R,ue;return{key:b.LayoutItemUUID,title:b.Label||((ue=(R=b.SectionField)==null?void 0:R.Field)==null?void 0:ue.Label)||"",align:b.Align==="end"?"end":"start",sortable:Ta(b),type:Aa(b),defaultSort:b.DefaultSort}}),Y.value.push(E)}),Y.value=Y.value.sort((A,E)=>A.order>E.order?1:A.order==E.order?0:-1)),(W.value==null||W.value=="")&&Y.value.length>0&&(W.value=Y.value[0].uuid)};u?d.getConvention(u).then(A=>{A&&(o.value=A,U.value.ConventionID=o.value.ID,U.value.ConventionUUID=o.value.ConventionUUID,pa())}).catch(()=>{n.push("/")}):n.push("/");const Aa=A=>{var E,b;if(A.SourceType===Je.LAYOUT_ITEM_SOURCE_META)return`${A.SourceType}.${A.MetaField}`;if(A.SourceType===Je.LAYOUT_ITEM_SOURCE_FORM)return(b=(E=A.SectionField)==null?void 0:E.Field)==null?void 0:b.Type;if(A.SourceType===Je.LAYOUT_ITEM_SOURCE_USER)return`${A.SourceType}.${A.UserField}`},Ta=A=>{const E=[te.META_DATA_SOURCE_ACCOMMODATION_FORM,te.META_DATA_SOURCE_BADGE_FORM,te.META_DATA_SOURCE_DEALER_FORM,te.META_DATA_SOURCE_REGISTRATION_FORM,te.META_DATA_SOURCE_REGISTRATION_REFERENCE,te.META_DATA_SOURCE_SUBMISSION_DATE,te.META_DATA_SOURCE_SUBMISSION_STATUS],b=[ie.USER_DATA_SOURCE_DISPLAY_NAME,ie.USER_DATA_SOURCE_EMAIL,ie.USER_DATA_SOURCE_HANDLE,ie.USER_DATA_SOURCE_DATE_OF_BIRTH,ie.USER_DATA_SOURCE_FIRST_NAME,ie.USER_DATA_SOURCE_LAST_NAME];return E.includes(A.MetaField)||b.includes(A.UserField)},ya=A=>{pe.value=A,ye.value=!0},Ea=A=>{pe.value=A,je.value=!0},Sa=A=>{pe.value=A,Ua.value=!0};de(ye,A=>{A||(pe.value=void 0)}),de(je,A=>{A||(pe.value=void 0)});const mt=async(A="")=>{Ot.value=await d.getRegistrationGroup(A)},Ia=({registration:A,form:E,submission:b})=>{pe.value=A,mt(A.RegistrationUUID).then(()=>{tt.value=E,rt.value=b,xe.value=!0})},Da=A=>{d.switchUser(A.UserUUID).then(E=>{E&&Ml(E.tokens,E.user,n,!1)}).catch(E=>{console.error(E)})};return y.on("registration.group.leave",A=>{d.leaveRegistrationGroup(A).then(E=>{E&&mt(A).then(()=>{y.emit("registration.group.left",E)})})}),y.on("registration.group.remove.member",A=>{d.leaveRegistrationGroup(A).then(E=>{E&&mt(A).then(()=>{y.emit("registration.group.left",E)})})}),(A,E)=>(m(),N(wl,null,{default:a(()=>[t(gt,{color:"blue-darken-4"},{default:a(()=>[t(aa,{modelValue:W.value,"onUpdate:modelValue":E[0]||(E[0]=b=>W.value=b),"show-arrows":""},{default:a(()=>[(m(!0),D(P,null,Z(Y.value,b=>(m(),N(la,{key:b.uuid,value:b.uuid},{default:a(()=>[O(C(b.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"]),t(Ne),t(q,{icon:"mdi:mdi-cog-outline",onClick:E[1]||(E[1]=b=>G.value=!0)})]),_:1}),t(na,{modelValue:W.value,"onUpdate:modelValue":E[16]||(E[16]=b=>W.value=b),disabled:!0,touch:!1},{default:a(()=>[(m(!0),D(P,null,Z(Y.value,b=>(m(),N(ke,{key:b.uuid,value:b.uuid},{default:a(()=>[b.uuid===W.value?(m(),N(Oe,{key:0,class:"pa-2"},{default:a(()=>[t(F(Hl),{expanded:T.value,"onUpdate:expanded":E[12]||(E[12]=R=>T.value=R),page:I.value,"onUpdate:page":E[13]||(E[13]=R=>I.value=R),"items-per-page":V.value,"onUpdate:itemsPerPage":E[14]||(E[14]=R=>V.value=R),"sort-by":me.value,"onUpdate:sortBy":E[15]||(E[15]=R=>me.value=R),headers:b.headers,"items-length":Q.value,items:b.items,"item-value":"key",loading:l.value,search:ae.value,"onUpdate:options":dt,"show-expand":""},Xe({top:a(()=>[t(fe,null,{default:a(()=>[t(K,null,{default:a(()=>[t(k,{cols:"12",sm:"12",md:"3",lg:"2",xl:"2"},{default:a(()=>[t(Ue,{modelValue:_.value,"onUpdate:modelValue":E[2]||(E[2]=R=>_.value=R),label:"Search by Badge",clearable:!0,"hide-details":"","onClick:clear":F(Ve),onInput:F(Ve)},null,8,["modelValue","onClick:clear","onInput"])]),_:1}),t(k,{cols:"12",sm:"12",md:"4",lg:"5",xl:"3"},{default:a(()=>[t(Ue,{modelValue:S.value.Value,"onUpdate:modelValue":E[3]||(E[3]=R=>S.value.Value=R),label:"Search By Furry Name",clearable:!0,"hide-details":"","onClick:clear":F(Ve),onInput:F(Ve)},null,8,["modelValue","onClick:clear","onInput"])]),_:1}),t(k,{cols:"12",sm:"12",md:"5",lg:"5",xl:"3"},{default:a(()=>[t(Ue,{modelValue:g.value,"onUpdate:modelValue":E[4]||(E[4]=R=>g.value=R),label:"Search By Email",clearable:!0,"hide-details":"","onClick:clear":F(Ve),onInput:F(Ve)},null,8,["modelValue","onClick:clear","onInput"])]),_:1}),t(k,{cols:"12",sm:"6",md:"6",lg:"6",xl:"2"},{default:a(()=>[t(ce,{modelValue:$.value,"onUpdate:modelValue":E[5]||(E[5]=R=>$.value=R),label:"Search By Group",clearable:!0,"hide-details":"",items:v.value,"item-value":"GroupUUID","item-title":"Name"},null,8,["modelValue","items"])]),_:1}),t(k,{cols:"12",sm:"6",md:"6",lg:"6",xl:"2"},{default:a(()=>[t(ce,{modelValue:X.value,"onUpdate:modelValue":E[6]||(E[6]=R=>X.value=R),label:"Search By Tag",clearable:!0,"hide-details":"",items:M.value,"item-value":"TagUUID","item-title":"Title"},null,8,["modelValue","items"])]),_:1})]),_:1})]),_:1})]),"expanded-row":a(({columns:R,item:ue})=>[w("tr",null,[w("td",{colspan:R.length},[t(Qt,{modelValue:ye.value,"onUpdate:modelValue":E[8]||(E[8]=le=>ye.value=le),registration:ue.selectable.registration,"onUpdate:registration":le=>ue.selectable.registration=le,accommodations:ne.value,convention:o.value,extras:we.value,forms:r.value,interests:Pe.value,tickets:Fe.value,title:`Registration Controls (#${ue.selectable.registration.Reference} ${ue.selectable.registration.User.DisplayName})`,"use-dialog":!1,venues:$e.value},null,8,["modelValue","registration","onUpdate:registration","accommodations","convention","extras","forms","interests","tickets","title","venues"])],8,wo)])]),"item.data-table-expand":a(({item:R})=>[T.value.findIndex(ue=>ue===R.key)>=0?(m(),N(q,{key:0,"append-icon":"mdi:mdi-chevron-up",size:"xs",variant:"flat",onClick:ue=>T.value.splice(T.value.findIndex(le=>le===R.key),1)},{default:a(()=>[R.selectable.registration.Notes&&R.selectable.registration.Notes.length>0?(m(),D(P,{key:0},[O(C(R.selectable.registration.Notes.length),1)],64)):B("",!0)]),_:2},1032,["onClick"])):(m(),N(q,{key:1,"append-icon":"mdi:mdi-chevron-down",size:"xs",variant:"flat",onClick:ue=>T.value.push(R.key)},{default:a(()=>[R.selectable.registration.Notes&&R.selectable.registration.Notes.length>0?(m(),D(P,{key:0},[O(C(R.selectable.registration.Notes.length),1)],64)):B("",!0)]),_:2},1032,["onClick"]))]),bottom:a(()=>[t(fe,{fluid:!0},{default:a(()=>[t(K,{class:"align-center"},{default:a(()=>[t(k,{cols:"12",lg:"7","order-lg":"3",xl:"8"},{default:a(()=>[t(Lo,{modelValue:I.value,"onUpdate:modelValue":E[9]||(E[9]=R=>I.value=R),length:Math.ceil(Q.value/V.value)},null,8,["modelValue","length"])]),_:1}),t(k,{cols:"6",sm:"4",md:"2",lg:"2",xl:"1","order-lg":"1"},{default:a(()=>[t(ce,{"model-value":V.value,density:"compact","hide-details":"","item-title":"title","item-value":"value",label:"Items per page",min:"-1",max:"100",type:"number",variant:"outlined",items:[{title:"10",value:10},{title:"25",value:25},{title:"50",value:50},{title:"100",value:100},{title:"All",value:-1}],"onUpdate:modelValue":E[10]||(E[10]=R=>V.value=parseInt(R,10))},null,8,["model-value"])]),_:1}),t(k,{cols:"6",sm:"3",md:"2",lg:"1",xl:"1","order-lg":"2"},{default:a(()=>[t(Ue,{modelValue:I.value,"onUpdate:modelValue":E[11]||(E[11]=R=>I.value=R),modelModifiers:{number:!0},density:"compact","hide-details":"",label:"Page",min:"1",max:Math.ceil(Q.value/V.value),type:"number",variant:"outlined"},null,8,["modelValue","max"])]),_:1}),t(k,{class:"text-right",cols:"12",sm:"5",md:"8",lg:"2",xl:"2","order-lg":"4"},{default:a(()=>[w("span",Po,[V.value===-1?(m(),D(P,{key:0},[O(" 1-"+C(Q.value)+" of "+C(Q.value),1)],64)):(m(),D(P,{key:1},[O(C((I.value-1)*V.value+1)+"-"+C(I.value*V.value>=Q.value?Q.value:I.value*V.value)+" of "+C(Q.value),1)],64))])]),_:1})]),_:1})]),_:1})]),_:2},[Z(b.headers,R=>({name:`item.${R.key}`,fn:a(({item:ue})=>[t(Cn,{header:R,item:ue,accommodations:ne.value,convention:o.value,extras:we.value,forms:r.value,interests:Pe.value,tickets:Fe.value,user:F(_a),venues:$e.value,onOpenActions:ya,onOpenPayments:Ea,onOpenTags:Sa,onReload:E[7]||(E[7]=le=>dt({page:I.value,itemsPerPage:V.value,sortBy:L.value})),onSwitchUser:Da,onShowForm:Ia},null,8,["header","item","accommodations","convention","extras","forms","interests","tickets","user","venues"])])}))]),1032,["expanded","page","items-per-page","sort-by","headers","items-length","items","loading","search"])]),_:2},1024)):B("",!0)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"]),G.value?(m(),N(jl,{key:0,title:"Edit Layout",modelValue:G.value,"onUpdate:modelValue":E[17]||(E[17]=b=>G.value=b),layout:U.value,onSave:ga},null,8,["modelValue","layout"])):B("",!0),pe.value?(m(),D(P,{key:1},[ye.value?(m(),N(Qt,{key:0,modelValue:ye.value,"onUpdate:modelValue":E[18]||(E[18]=b=>ye.value=b),registration:pe.value,"onUpdate:registration":E[19]||(E[19]=b=>pe.value=b),accommodations:ne.value,convention:o.value,extras:we.value,forms:r.value,interests:Pe.value,tickets:Fe.value,title:`Registration Controls (#${pe.value.Reference} ${pe.value.User.DisplayName})`,"use-dialog":!0,venues:$e.value},null,8,["modelValue","registration","accommodations","convention","extras","forms","interests","tickets","title","venues"])):B("",!0)],64)):B("",!0),xe.value&&rt.value&&tt.value?(m(),N(At,{key:2,modelValue:xe.value,"onUpdate:modelValue":E[23]||(E[23]=b=>xe.value=b),scrollable:!0,fullscreen:!0,persistent:!0},{default:a(()=>[t(Oe,{class:"bg-red-darken-4"},{default:a(()=>[t(gt,{color:"error"},{default:a(()=>[t(ca,null,{default:a(()=>[O("Submission Editor - Admin Mode")]),_:1}),t(Ne),t(Ll,null,{default:a(()=>[t(q,{icon:"mdi:mdi-window-close",onClick:E[20]||(E[20]=b=>xe.value=!1)})]),_:1})]),_:1}),t(Le,null,{default:a(()=>[t(Qa,{modelValue:tt.value,"onUpdate:modelValue":E[21]||(E[21]=b=>tt.value=b),admin:!0,convention:o.value,data:rt.value,editable:!0,"registration-group":Ot.value,onClose:E[22]||(E[22]=b=>{xe.value=!1,dt({page:I.value,itemsPerPage:V.value,sortBy:L.value})})},null,8,["modelValue","convention","data","registration-group"])]),_:1})]),_:1})]),_:1},8,["modelValue"])):B("",!0)]),_:1}))}});export{Si as default};
