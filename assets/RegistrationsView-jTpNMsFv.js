import{p as al,d as ll,c as ue,t as Ke,a0 as ol,a1 as nl,f as t,F as h,m as ft,i as j,M as Q,N as te,r as E,k as Ee,w as fe,n,q as S,v as l,y,D as w,x as R,B as _,Q as W,C as g,A as N,P as Ae,G as xt,H as Ht,_ as dt,a2 as il,a3 as Je,O as Xe,a4 as sl,X as Ut,o as ul,b as rl,a5 as dl,a6 as ml,a7 as aa,z as wt,a8 as cl,a9 as la,Z as ut,V as vl,U as fl,E as Ul}from"./index-qrnKhx_T.js";import{T as Al,V as Ta,e as Tl,c as _a,d as _l}from"./FormRenderer.vue_vue_type_style_index_0_lang--dPWr2or.js";import{F as _e,a as El}from"./form-0fJbSFPv.js";import{u as mt,V as Ft}from"./VCheckbox-q0aKFgG-.js";import{_ as Fe}from"./ModelDialog.vue_vue_type_script_setup_true_lang-sScBNtfJ.js";import{h as Oe,b as At,a as gl,c as pl,d as oa,P as Pt,u as Ea}from"./useDisplayTransactions-TlfYliu7.js";import{u as Sl,a as me,V as Me}from"./VContainer-gWvyuF1h.js";import{V as X,a as M}from"./VRow-UcVvURYV.js";import{V as we,a as be,c as Tt,d as Dl}from"./VList-I03sduVq.js";import{V as ve}from"./copyToClipboard-0uXNAf42.js";import{G as Be}from"./userData-jTd1ttDI.js";import{C as Et}from"./canEditRegistrations-A1ez9bSf.js";import{V as q,a as ga}from"./VBtn-Av-8rse3.js";import{b as pa,c as qt,S as Sa,d as na}from"./submission-40fey8Hx.js";import{G as gt}from"./group-7fhbY6WJ.js";import{C as pt}from"./canDo-yWCfI_4r.js";import{a as St,V as Pe}from"./scopeId-kmVgcqbQ.js";import{b as yl,_ as rt,V as Da}from"./SaveButton.vue_vue_type_script_setup_true_lang-z-LO4g_8.js";import{V as ot,a as We,c as Ze,d as Kt,e as $e}from"./VCard-Y7aFevFa.js";import{V as jt}from"./VAvatar-kJpqjpP2.js";import{V as oe}from"./VTextField-0XScCu3_.js";import{v as ye}from"./v4-yQnnJER4.js";import{m as Il,k as Cl,l as Rl,n as Vl,o as Ol,p as Ml,q as hl,u as kl,r as Nl,s as bl,t as Ll,v as wl,w as Fl,x as Pl,y as $l,z as ia,A as sa,B as ua,c as Dt,d as yt,e as zt,b as It,V as Ct,a as ya,h as Ia,i as Ca,_ as Ra,j as Qe,g as Va,f as $t,C as Bl}from"./VWindowItem-HYliMrAL.js";import{_ as Oa}from"./DeleteDialog.vue_vue_type_script_setup_true_lang-MDvKSimo.js";import{a as Ma,V as Bt}from"./VToolbar-QqPu0_VI.js";import{V as Yl}from"./VDivider-54Y3u5Pj.js";import{V as ha}from"./VTextarea-tGvAG899.js";import{V as _t}from"./VDialog-tpQLKbBU.js";import{V as ka,a as Yt}from"./VChip-HAPZLQwu.js";import{V as Gl}from"./VForm-9fBepPZ3.js";import{V as xl,b as Hl}from"./VNavigationDrawer-wFYC9sZ6.js";import{s as ql}from"./sortSubmissions-NKScr9xj.js";import{V as Kl,a as jl}from"./VAlert-tSmYj0Y6.js";import{S as zl}from"./setupLogin-cxDSA0Pc.js";import{V as Ql}from"./forwardRefs-U4OdwkyO.js";import{u as bt}from"./nil-rxyd0N8M.js";import{V as ra,a as Jl}from"./VTable-iJFHtGpH.js";import"./index-OKsbKlsK.js";import"./VFileInput-NO7cDzm9.js";import"./createSimpleFunctional-InvJdGk4.js";import"./VToolbarItems-3rhXWaud.js";var Ne=(e=>(e.ADMIN_LAYOUT_PANELS="ADMIN_LAYOUT_PANELS",e.ADMIN_LAYOUT_TABLE="ADMIN_LAYOUT_TABLE",e))(Ne||{});const Xl=[{title:"Panel Layout",value:"ADMIN_LAYOUT_PANELS"},{title:"Table Layout",value:"ADMIN_LAYOUT_TABLE"}];var Le=(e=>(e.LAYOUT_ITEM_SOURCE_FORM="LAYOUT_ITEM_SOURCE_FORM",e.LAYOUT_ITEM_SOURCE_META="LAYOUT_ITEM_SOURCE_META",e.LAYOUT_ITEM_SOURCE_USER="LAYOUT_ITEM_SOURCE_USER",e))(Le||{});const Wl=[{title:"Form Field Submission Data",value:"LAYOUT_ITEM_SOURCE_FORM"},{title:"Miscellaneous Data",value:"LAYOUT_ITEM_SOURCE_META"},{title:"User Profile Data",value:"LAYOUT_ITEM_SOURCE_USER"}];var G=(e=>(e.META_DATA_SOURCE_NULL="",e.META_DATA_SOURCE_ACCOMMODATION_ALLOCATION="META_DATA_SOURCE_ACCOMMODATION_ALLOCATION",e.META_DATA_SOURCE_ACCOMMODATION_FORM="META_DATA_SOURCE_ACCOMMODATION_FORM",e.META_DATA_SOURCE_ADMIN_FORM="META_DATA_SOURCE_ADMIN_FORM",e.META_DATA_SOURCE_BADGE_DISPLAY="META_DATA_SOURCE_BADGE_DISPLAY",e.META_DATA_SOURCE_BADGE_FORM="META_DATA_SOURCE_BADGE_FORM",e.META_DATA_SOURCE_CHECKIN_CONTROL="META_DATA_SOURCE_CHECKIN_CONTROL",e.META_DATA_SOURCE_CHECKIN_STATUS="META_DATA_SOURCE_CHECKIN_STATUS",e.META_DATA_SOURCE_DATA_LAYOUT="META_DATA_SOURCE_DATA_LAYOUT",e.META_DATA_SOURCE_DEALER_FORM="META_DATA_SOURCE_DEALER_FORM",e.META_DATA_SOURCE_EMAILS="META_DATA_SOURCE_EMAILS",e.META_DATA_SOURCE_NOTES="META_DATA_SOURCE_NOTES",e.META_DATA_SOURCE_PAYMENT_STATUS="META_DATA_SOURCE_PAYMENT_STATUS",e.META_DATA_SOURCE_PAYMENTS="META_DATA_SOURCE_PAYMENTS",e.META_DATA_SOURCE_REGISTRATION_ACTIONS="META_DATA_SOURCE_REGISTRATION_ACTIONS",e.META_DATA_SOURCE_REGISTRATION_FORM="META_DATA_SOURCE_REGISTRATION_FORM",e.META_DATA_SOURCE_REGISTRATION_GROUP="META_DATA_SOURCE_REGISTRATION_GROUP",e.META_DATA_SOURCE_REGISTRATION_REFERENCE="META_DATA_SOURCE_REGISTRATION_REFERENCE",e.META_DATA_SOURCE_SUBMISSION_DATE="META_DATA_SOURCE_SUBMISSION_DATE",e.META_DATA_SOURCE_SUBMISSION_STATUS="META_DATA_SOURCE_SUBMISSION_STATUS",e.META_DATA_SOURCE_TAGS="META_DATA_SOURCE_TAGS",e))(G||{});const Zl=[{title:"Accommodation Allocation",value:"META_DATA_SOURCE_ACCOMMODATION_ALLOCATION"},{title:"Accommodation Form",value:"META_DATA_SOURCE_ACCOMMODATION_FORM"},{title:"Actions",value:"META_DATA_SOURCE_REGISTRATION_ACTIONS"},{title:"Badge Display",value:"META_DATA_SOURCE_BADGE_DISPLAY"},{title:"Badge Form",value:"META_DATA_SOURCE_BADGE_FORM"},{title:"Check In Control",value:"META_DATA_SOURCE_CHECKIN_CONTROL"},{title:"Check In Status",value:"META_DATA_SOURCE_CHECKIN_STATUS"},{title:"Data Display",value:"META_DATA_SOURCE_DATA_LAYOUT"},{title:"Dealer Form",value:"META_DATA_SOURCE_DEALER_FORM"},{title:"Emails",value:"META_DATA_SOURCE_EMAILS"},{title:"Notes",value:"META_DATA_SOURCE_NOTES"},{title:"Payment Status",value:"META_DATA_SOURCE_PAYMENT_STATUS"},{title:"Payments",value:"META_DATA_SOURCE_PAYMENTS"},{title:"Registration Group",value:"META_DATA_SOURCE_REGISTRATION_GROUP"},{title:"Registration Reference",value:"META_DATA_SOURCE_REGISTRATION_REFERENCE"},{title:"Registration Form",value:"META_DATA_SOURCE_REGISTRATION_FORM"},{title:"Submission Date",value:"META_DATA_SOURCE_SUBMISSION_DATE"},{title:"Submission Status",value:"META_DATA_SOURCE_SUBMISSION_STATUS"},{title:"Tags",value:"META_DATA_SOURCE_TAGS"}];var De=(e=>(e.PANEL_STYLE_FLEX="PANEL_STYLE_FLEX",e.PANEL_STYLE_NAV_BOTTOM="PANEL_STYLE_NAV_BOTTOM",e.PANEL_STYLE_NAV_LEFT="PANEL_STYLE_NAV_LEFT",e.PANEL_STYLE_NAV_RIGHT="PANEL_STYLE_NAV_RIGHT",e.PANEL_STYLE_NAV_TOP="PANEL_STYLE_NAV_TOP",e))(De||{});const eo=[{title:"Body Flexible",value:"PANEL_STYLE_FLEX"},{title:"Fixed Bottom",value:"PANEL_STYLE_NAV_BOTTOM"},{title:"Fixed Left",value:"PANEL_STYLE_NAV_LEFT"},{title:"Fixed Right",value:"PANEL_STYLE_NAV_RIGHT"},{title:"Fixed Top",value:"PANEL_STYLE_NAV_TOP"}];var ie=(e=>(e.USER_DATA_SOURCE_NULL="",e.USER_DATA_SOURCE_DISPLAY_NAME="USER_DATA_SOURCE_DISPLAY_NAME",e.USER_DATA_SOURCE_HANDLE="USER_DATA_SOURCE_HANDLE",e.USER_DATA_SOURCE_AVATAR="USER_DATA_SOURCE_AVATAR",e.USER_DATA_SOURCE_FIRST_NAME="USER_DATA_SOURCE_FIRST_NAME",e.USER_DATA_SOURCE_LAST_NAME="USER_DATA_SOURCE_LAST_NAME",e.USER_DATA_SOURCE_DATE_OF_BIRTH="USER_DATA_SOURCE_DATE_OF_BIRTH",e.USER_DATA_SOURCE_EMAIL="USER_DATA_SOURCE_EMAIL",e.USER_DATA_SOURCE_TELEGRAM="USER_DATA_SOURCE_TELEGRAM",e))(ie||{});const to=[{title:"Display Name",value:"USER_DATA_SOURCE_DISPLAY_NAME"},{title:"Handle",value:"USER_DATA_SOURCE_HANDLE"},{title:"Avatar",value:"USER_DATA_SOURCE_AVATAR"},{title:"First Name",value:"USER_DATA_SOURCE_FIRST_NAME"},{title:"Last Name",value:"USER_DATA_SOURCE_LAST_NAME"},{title:"Date of Birth",value:"USER_DATA_SOURCE_DATE_OF_BIRTH"},{title:"Email Address",value:"USER_DATA_SOURCE_EMAIL"},{title:"Telegram Username",value:"USER_DATA_SOURCE_TELEGRAM"}],ao=e=>{switch(e){case"EMAIL_STATUS_QUEUED":return"Queued";case"EMAIL_STATUS_QUEUE_ERROR":return"Processing";case"EMAIL_STATUS_QUEUE_FAILURE":return"Internal Error";case"EMAIL_STATUS_SENDING":return"Sending";case"EMAIL_STATUS_SENT":return"Sent";case"EMAIL_STATUS_SEND_ERROR":return"Failed to Send"}return"Unknown"},lo=e=>e===void 0?!1:pt(e,gt.GROUP_TYPE_SYSTEM).ManageUsers,oo=al({itemsLength:{type:[Number,String],required:!0},...Il(),...Cl(),...Rl()},"VDataTableServer"),no=ll()({name:"VDataTableServer",props:oo(),emits:{"update:modelValue":e=>!0,"update:page":e=>!0,"update:itemsPerPage":e=>!0,"update:sortBy":e=>!0,"update:options":e=>!0,"update:expanded":e=>!0,"update:groupBy":e=>!0},setup(e,c){let{attrs:o,slots:i}=c;const{groupBy:r}=Vl(e),{sortBy:f,multiSort:T,mustSort:u}=Ol(e),{page:a,itemsPerPage:s}=Ml(e),d=ue(()=>parseInt(e.itemsLength,10)),{columns:U,headers:v}=hl(e,{groupBy:r,showSelect:Ke(e,"showSelect"),showExpand:Ke(e,"showExpand")}),{items:m}=kl(e,U),{toggleSort:p}=Nl({sortBy:f,multiSort:T,mustSort:u,page:a}),{opened:I,isGroupOpen:k,toggleGroup:D,extractRows:V}=bl({groupBy:r,sortBy:f}),{pageCount:A,setItemsPerPage:P}=Ll({page:a,itemsPerPage:s,itemsLength:d}),{flatItems:se}=wl(m,r,I),{isSelected:z,select:x,selectAll:le,toggleSelect:Y,someSelected:B,allSelected:F}=Fl(e,{allItems:m,currentPage:m}),{isExpanded:b,toggleExpand:Z}=Pl(e),ce=ue(()=>V(m.value));$l({page:a,itemsPerPage:s,sortBy:f,groupBy:r,search:Ke(e,"search")}),ol("v-data-table",{toggleSort:p,sortBy:f}),nl({VDataTableRows:{hideNoData:Ke(e,"hideNoData"),noDataText:Ke(e,"noDataText"),loading:Ke(e,"loading"),loadingText:Ke(e,"loadingText")}});const ne=ue(()=>({page:a.value,itemsPerPage:s.value,sortBy:f.value,pageCount:A.value,toggleSort:p,setItemsPerPage:P,someSelected:B.value,allSelected:F.value,isSelected:z,select:x,selectAll:le,toggleSelect:Y,isExpanded:b,toggleExpand:Z,isGroupOpen:k,toggleGroup:D,items:ce.value.map(pe=>pe.raw),internalItems:ce.value,groupedItems:se.value,columns:U.value,headers:v.value}));Sl(()=>{const pe=ia.filterProps(e),et=sa.filterProps(e),tt=ua.filterProps(e),nt=ra.filterProps(e);return t(ra,ft({class:["v-data-table",{"v-data-table--loading":e.loading},e.class],style:e.style},nt),{top:()=>{var Ce;return(Ce=i.top)==null?void 0:Ce.call(i,ne.value)},default:()=>{var Ce,Ye,Ge,xe,He,Se;return i.default?i.default(ne.value):t(h,null,[(Ce=i.colgroup)==null?void 0:Ce.call(i,ne.value),t("thead",{class:"v-data-table__thead",role:"rowgroup"},[t(sa,ft(et,{sticky:e.fixedHeader}),i)]),(Ye=i.thead)==null?void 0:Ye.call(i,ne.value),t("tbody",{class:"v-data-table__tbody",role:"rowgroup"},[(Ge=i["body.prepend"])==null?void 0:Ge.call(i,ne.value),i.body?i.body(ne.value):t(ua,ft(o,tt,{items:se.value}),i),(xe=i["body.append"])==null?void 0:xe.call(i,ne.value)]),(He=i.tbody)==null?void 0:He.call(i,ne.value),(Se=i.tfoot)==null?void 0:Se.call(i,ne.value)])},bottom:()=>i.bottom?i.bottom(ne.value):t(ia,pe,{prepend:i["footer.prepend"]})})})}}),io=w("br",null,null,-1),so=w("h3",null,"Assigned Accommodation",-1),uo=w("br",null,null,-1),ro=w("br",null,null,-1),mo=w("h3",null,"Accommodation Preferences",-1),co=w("h3",null,"Selected Tickets",-1),vo=w("br",null,null,-1),fo=j({__name:"EditAccommodationAssignmentDialog",props:Q({convention:{},registration:{},selectedAccommodation:{},title:{}},{modelValue:{type:Boolean,required:!0},modelModifiers:{}}),emits:Q(["update:field"],["update:modelValue"]),setup(e,{emit:c}){const o=e,{convention:i,registration:r,title:f=""}=o,T=c,u=Ae(),a=te(e,"modelValue"),s=E({capacity:{max:Y=>{var b;const B=P.value.find(Z=>Z.room.RoomUUID===Y);return!B||B.room.MaximumCapacity===0?!0:(((b=m.value)==null?void 0:b.Members.length)||0)<=B.room.MaximumCapacity||"Too many people in the group for this room"},min:Y=>{var b;const B=P.value.find(Z=>Z.room.RoomUUID===Y);return!B||B.room.MinimumCapacity===0?!0:(((b=m.value)==null?void 0:b.Members.length)||0)>=B.room.MinimumCapacity||"Not enough people in the group for this room"}}}),d=E([]),U=mt(o,T,void 0,void 0,"field"),v=E(Ee(U.value));fe(U,()=>{v.value=Ee(U.value)});const m=E(),p=E(""),I=E(""),k=E([]),D=E({Ticket:[],AddonsChecked:[],ComponentsChecked:[]}),V=async()=>{var b;const Y=await u.getConventionAvailableAccommodation(i.ConventionUUID);Y&&(d.value=Y);const B=await u.getRegistrationGroup(r.RegistrationUUID||"");B&&(m.value=B);const F=await u.getConventionTickets(i.ConventionUUID);F&&(k.value=F);try{D.value=JSON.parse(((b=m.value)==null?void 0:b.TicketData)||"")}catch{}};fe(p,()=>{I.value=P.value.length>0?P.value[0].value:""});const A=ue(()=>{const Y=se.value;return d.value.map(B=>{let F;return Y.forEach(b=>{B.Costs.forEach(Z=>{Z.DateStart===(b==null?void 0:b.DateStart)&&Z.DateEnd===b.DateEnd&&(F===void 0||F>Z.Availability)&&(F=Z.Availability)})}),{label:`${B.Name}`,title:`${B.Name} (${F} Available)`,value:B.AccommodationUUID}})}),P=ue(()=>{const Y=se.value,B=d.value.find(F=>F.AccommodationUUID===p.value);return(B==null?void 0:B.Pool.map(F=>{var Z,ce;let b;return Y.forEach(ne=>{F.Costs.forEach(pe=>{pe.DateStart===(ne==null?void 0:ne.DateStart)&&pe.DateEnd===ne.DateEnd&&(b===void 0||b>pe.Availability)&&(b=pe.Availability)})}),{label:`${(Z=F.Venue)==null?void 0:Z.Name} - ${F.Name}`,title:`${(ce=F.Venue)==null?void 0:ce.Name} - ${F.Name} (${b} Available)`,value:F.RoomUUID,room:F}}))||[]}),se=ue(()=>[...D.value.Ticket,...D.value.AddonsChecked,...D.value.ComponentsChecked].map(Y=>k.value.find(B=>B.TicketUUID===Y)).filter(Y=>Y!==void 0&&Y.RequiresAccommodation)),z=Y=>{var B;u.assignAccommodation(((B=m.value)==null?void 0:B.Registration.RegistrationUUID)||"",p.value,I.value,!1).then(F=>{F?(V(),Y&&Y("Room Assigned")):Y&&Y("Room not assigned")}).catch(()=>{Y&&Y("Room not assigned")})},x=Y=>{var B,F;(B=m.value)!=null&&B.Registration.AllocationUUID?u.deleteAllocation(((F=m.value)==null?void 0:F.Registration.AllocationUUID)||"").then(b=>{b?(V(),Y&&Y("Allocation Deleted")):Y&&Y("Allocation not deleted")}).catch(()=>{Y&&Y("Allocation not deleted")}):Y&&Y("Nothing to Delete")},le=Y=>{var F,b;const B=(F=d.value.find(Z=>Z.AccommodationUUID===Y.AccommodationUUID))==null?void 0:F.Pool;if(B){const Z=B.find(ce=>ce.RoomUUID===Y.RoomUUID);if(Z)return`${(b=Z.Venue)==null?void 0:b.Name} - ${Z.Name}`}return""};return V(),(Y,B)=>{var F;return n(),S(Fe,{modelValue:a.value,"onUpdate:modelValue":B[2]||(B[2]=b=>a.value=b),title:g(f),color:"primary","show-close-action":!0,"show-delete-action":!!((F=m.value)!=null&&F.Registration.Allocation),"show-save-action":!!I.value,"save-button-label":"Assign Room",onDelete:x,onSave:z,fullscreen:!0,persistent:!0},{default:l(()=>[t(me,{class:"pa-0",fluid:!0},{default:l(()=>[t(X,null,{default:l(()=>{var b;return[t(M,{cols:"12",md:"6"},{default:l(()=>{var Z,ce;return[w("h3",null,"Group Members ("+y((Z=m.value)==null?void 0:Z.Members.length)+")",1),(n(!0),_(h,null,W((ce=m.value)==null?void 0:ce.Members,ne=>(n(),_(h,{key:ne.UUID},[R(" #"+y(ne.Reference)+" "+y(ne.Name),1),io],64))),128))]}),_:1}),(b=m.value)!=null&&b.Registration.Allocation?(n(),S(M,{key:0,cols:"12",md:"6"},{default:l(()=>[so,t(we,null,{default:l(()=>{var Z;return[(n(!0),_(h,null,W((Z=m.value)==null?void 0:Z.Registration.Allocation.Periods,ce=>(n(),S(be,{key:ce.AllocationPeriodUUID},{default:l(()=>{var ne;return[R(y((ne=d.value.find(pe=>pe.AccommodationUUID===ce.AccommodationUUID))==null?void 0:ne.Name)+" ",1),uo,R(" "+y(le(ce))+" ",1),ro,w("small",null,"("+y(g(Oe)(ce.DateStart))+" - "+y(g(Oe)(ce.DateEnd))+")",1)]}),_:2},1024))),128))]}),_:1})]),_:1})):N("",!0)]}),_:1}),t(X,null,{default:l(()=>[t(M,{cols:"12",md:"6"},{default:l(()=>[Y.selectedAccommodation.length?(n(),_(h,{key:0},[mo,t(we,null,{default:l(()=>[(n(!0),_(h,null,W(Y.selectedAccommodation,(b,Z)=>(n(),S(be,{key:b.AccommodationUUID},{default:l(()=>[R(y(Z+1)+". "+y(b.Name),1)]),_:2},1024))),128))]),_:1})],64)):N("",!0)]),_:1}),t(M,{cosl:"12",md:"6"},{default:l(()=>[co,t(we,null,{default:l(()=>[(n(!0),_(h,null,W(se.value,b=>(n(),S(be,{key:b==null?void 0:b.TicketUUID},{default:l(()=>[R(y(b.Name)+" ",1),vo,w("small",null,"("+y(g(Oe)(b.DateStart))+" - "+y(g(Oe)(b.DateEnd))+")",1)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1}),t(X,null,{default:l(()=>[t(M,{cols:"12",md:"6"},{default:l(()=>[t(ve,{modelValue:p.value,"onUpdate:modelValue":B[0]||(B[0]=b=>p.value=b),items:A.value,"item-title":"title","item-value":"value",label:"Accommodation"},null,8,["modelValue","items"])]),_:1}),t(M,{cols:"12",md:"6"},{default:l(()=>[t(ve,{modelValue:I.value,"onUpdate:modelValue":B[1]||(B[1]=b=>I.value=b),items:P.value,"item-title":"title","item-value":"value",label:"Room Pool",rules:[s.value.capacity.min,s.value.capacity.max]},null,8,["modelValue","items","rules"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue","title","show-delete-action","show-save-action"])}}}),Uo=e=>(xt("data-v-33548a38"),e=e(),Ht(),e),Ao={key:0,class:"accommodationList"},To={key:0,class:"text-orange-darken-2"},_o={key:1,class:"accommodationList"},Eo=Uo(()=>w("br",null,null,-1)),go=j({__name:"DataTableItemAccommodation",props:{accommodations:{default:()=>[]},convention:{},forms:{},registration:{},tickets:{default:()=>[]},value:{default:""},venues:{}},setup(e){const c=Be(),o=Et(c,e.convention),i=E(!1),r=ue(()=>e.registration.Allocation.Periods.map(u=>{var a;return{DateStart:u.DateStart,DateEnd:u.DateEnd,Accommodation:u.Accommodation||((a=e.accommodations)==null?void 0:a.find(s=>s.AccommodationUUID==u.AccommodationUUID))}}).sort((u,a)=>u.DateStart>a.DateStart?1:u.DateStart==a.DateStart?0:-1));e.registration&&e.registration.Allocation&&e.registration.Allocation.Periods&&e.registration.Allocation.Periods.forEach(u=>{var s;if(u.Accommodation)return;const a=(s=e.accommodations)==null?void 0:s.find(d=>d.AccommodationUUID==u.AccommodationUUID);a&&(u.Accommodation=a)});const f=ue(()=>{if(!e.value)return[];const u=JSON.parse(e.value),a=e.accommodations.filter(s=>u.includes(s.AccommodationUUID)).sort((s,d)=>{const U=u.findIndex(m=>m===s.AccommodationUUID),v=u.findIndex(m=>m===d.AccommodationUUID);return U>v?1:-1});return Ee(a)}),T=ue(()=>{let u;const a=e.forms.find(s=>!!s.Sections.find(d=>{var U;return d.Fields?!!((U=d.Fields)!=null&&U.find(v=>{var m;return((m=v.Field)==null?void 0:m.Type)==="TICKET"?(u=v,!0):!1})):!1}));return u?!!e.registration.Submissions.find(s=>{if(s.FormUUID==(a==null?void 0:a.FormUUID))return!!s.Data.find(d=>{if(d.SectionFieldUUID==(u==null?void 0:u.SectionFieldUUID)){const U=JSON.parse(d.Data);return e.tickets.filter(v=>v.RequiresAccommodation).find(v=>U.Ticket.includes(v.TicketUUID)||U.AddonsChecked.includes(v.TicketUUID)||U.ComponentsChecked.includes(v.TicketUUID))}})}):!1});return(u,a)=>T.value?(n(),_(h,{key:0},[u.value?(n(),_("ol",Ao,[(n(!0),_(h,null,W(f.value,s=>(n(),_("li",{key:s.AccommodationUUID},[u.registration&&u.registration.Allocation&&u.registration.Allocation.Periods.find(d=>d.AccommodationUUID===s.AccommodationUUID)?(n(),_("strong",To,y(s.Name),1)):(n(),_(h,{key:1},[R(y(s.Name),1)],64))]))),128))])):(n(),_("ul",_o,[(n(!0),_(h,null,W(r.value,s=>{var d;return n(),_("li",{key:s.DateStart},[R(y((d=s.Accommodation)==null?void 0:d.Name)+" ("+y(g(Oe)(s.DateStart))+" - "+y(g(Oe)(s.DateEnd))+")",1),Eo])}),128))])),g(o)?(n(),S(q,{key:2,onClick:a[0]||(a[0]=s=>i.value=!0),variant:"flat",color:"success"},{default:l(()=>[R("Assign Accommodation")]),_:1})):N("",!0),u.convention&&i.value?(n(),S(fo,{key:3,modelValue:i.value,"onUpdate:modelValue":a[1]||(a[1]=s=>i.value=s),title:"Accommodation Allocation",convention:u.convention,registration:u.registration,tickets:u.tickets,"selected-accommodation":f.value},null,8,["modelValue","convention","registration","tickets","selected-accommodation"])):N("",!0)],64)):N("",!0)}}),Na=dt(go,[["__scopeId","data-v-33548a38"]]),po={key:0,class:"addonList"},So={key:0},Do={key:0},yo=j({__name:"DataTableItemExtras",props:{extras:{default:()=>[]},value:{default:""}},setup(e){const c=ue(()=>{if(!e.value)return;const o=JSON.parse(e.value),i=Object.keys(o),r=Ee(e.extras);return r.forEach(f=>{f.Options=f.Options.filter(T=>i.includes(T.OptionUUID)?(T.Choices=T.Choices.filter(u=>u.TagUUID===o[T.OptionUUID].choiceId),o[T.OptionUUID].checked):!1)}),r.filter(f=>f.Options.length>0),r});return(o,i)=>o.value?(n(),_("ul",po,[(n(!0),_(h,null,W(c.value,r=>(n(),_(h,{key:r.ExtraUUID},[r.Options.length?(n(),_("li",So,[w("strong",null,y(r.Name),1),w("ul",null,[(n(!0),_(h,null,W(r.Options,f=>(n(),_("li",{key:f.OptionUUID},[R(y(f.Name)+" ",1),f.Choices.length==1?(n(),_("small",Do,"("+y(f.Choices[0].Title)+")",1)):N("",!0)]))),128))])])):N("",!0)],64))),128))])):N("",!0)}}),ba=dt(yo,[["__scopeId","data-v-55786e01"]]),Io={key:0},La=j({__name:"DataTableItemInterests",props:{interests:{default:()=>[]},value:{default:""}},setup(e){const c=ue(()=>{if(!e.value)return;const o=JSON.parse(e.value);return Object.entries(o).filter(([,i])=>i).map(([i,r])=>e.interests.find(f=>f.InterestUUID===i)).filter(i=>i!==void 0)});return(o,i)=>o.value?(n(),_("ul",Io,[(n(!0),_(h,null,W(c.value,r=>(n(),_("li",{key:r.InterestUUID},y(r.Name),1))),128))])):N("",!0)}}),Co=w("br",null,null,-1),Ro=w("small",null,"Options:",-1),Vo=w("br",null,null,-1),Oo=w("small",null,"Addons:",-1),wa=j({__name:"DataTableItemTicket",props:{tickets:{default:()=>[]},value:{default:""}},setup(e){const c=ue(()=>{if(!e.value)return;let o={Ticket:[],AddonsChecked:[],ComponentsChecked:[]};try{o=JSON.parse(e.value),"ticket"in o&&(o.Ticket=o.ticket),"addonsChecked"in o&&(o.AddonsChecked=o.addonsChecked),"componentsChecked"in o&&(o.ComponentsChecked=o.componentsChecked)}catch{}return o.Ticket.filter(i=>{const r=e.tickets.find(f=>f.TicketUUID===i);return!(!r||r.Type!==Al.TICKET_TYPE_TICKET)}).map(i=>{const r=e.tickets.find(T=>T.TicketUUID===i),f=Ee(r);return f.TicketComponents=r.TicketComponents.filter(T=>o.ComponentsChecked.includes(T.TicketUUID)),f.AddonTickets=r.AddonTickets.filter(T=>o.AddonsChecked.includes(T.TicketUUID)),f})});return(o,i)=>o.value?(n(!0),_(h,{key:0},W(c.value,r=>(n(),_("div",{key:r.TicketUUID},[w("strong",null,y(r.Name),1),r.TicketComponents.length>0?(n(),_(h,{key:0},[Co,Ro,R("  "),(n(!0),_(h,null,W(r.TicketComponents,f=>(n(),_(h,{key:f.TicketUUID},[w("small",null,y(f.Name),1),R("  ")],64))),128))],64)):N("",!0),r.AddonTickets.length>0?(n(),_(h,{key:1},[Vo,Oo,R("  "),(n(!0),_(h,null,W(r.AddonTickets,f=>(n(),_("small",{key:f.TicketUUID},[R("("),w("em",null,y(f.Name),1),R(")")]))),128))],64)):N("",!0)]))),128)):N("",!0)}}),Fa=j({__name:"DataPanelAccommodation",props:Q({accommodations:{},convention:{},data:{},forms:{},tickets:{},venues:{},registration:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(e){return te(e,"modelValue"),(c,o)=>(n(),_("div",null,[t(Na,{value:c.data,accommodations:c.accommodations,convention:c.convention,forms:c.forms,registration:c.registration,tickets:c.tickets,venues:c.venues},null,8,["value","accommodations","convention","forms","registration","tickets","venues"])]))}}),Mo={key:0,class:"text-red-darken-4 font-weight-bold"},ho={key:1,class:"text-orange-darken-2 font-weight-bold"},ko=j({__name:"DataPanelAge",props:Q({data:{},forms:{},registration:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(e){const c=te(e,"modelValue"),o=new Date,i=o.getFullYear(),r=(o.getMonth()+1).toLocaleString("en-US",{minimumIntegerDigits:2}),f=o.getDate().toLocaleString("en-US",{minimumIntegerDigits:2}),T=E(!1),u=E(`${i}-${r}-${f}`),a=E(18);e.forms.find(v=>v.Sections.find(m=>m.Fields?m.Fields.find(p=>{var I;return p.SectionFieldUUID===c.value.SectionFieldUUID?(c.value.SectionField=p,(I=p.Field)==null||I.Values.forEach(k=>{switch(k.Title){case"UNDER_AGE_APPLY_TAG":k.Value.length>0&&(T.value=!0);break;case"BEFORE_DATE":u.value=k.Value;break;case"MIN_AGE":a.value=parseInt(k.Value);break}}),!0):!1}):!1));const s=v=>({registration:d(v,e.registration.CreatedAt||"",a.value),convention:d(v,u.value,a.value)}),d=(v,m,p)=>{if(v>=m)return!1;const I=U(v),D=U(m).getTime()-I.getTime(),V=1e3*60*60*24*365.25;return D/V>=p},U=v=>{const[m,p,I]=v.split("-");return new Date(parseInt(m),parseInt(p)-1,parseInt(I))};return(v,m)=>(n(),_("div",null,[w("p",null,[R(y(g(Oe)(v.data,{withDay:!1,withYear:!0}))+" ",1),T.value&&s(v.data).convention&&s(v.data).registration?(n(),S(Me,{key:0,icon:"mdi:mdi-check",color:"success"})):T.value&&!s(v.data).convention?(n(),S(Me,{key:1,icon:"mdi:mdi-alert",color:"error"})):T.value&&s(v.data).convention&&!s(v.data).registration?(n(),S(Me,{key:2,icon:"mdi:mdi-alert",color:"warning"})):N("",!0)]),T.value?(n(),_(h,{key:0},[s(v.data).convention?s(v.data).registration?N("",!0):(n(),_("p",ho," Attendee was under "+y(a.value)+" at time of registration ",1)):(n(),_("p",Mo," Attendee is under "+y(a.value),1))],64)):N("",!0)]))}}),Pa=(e,c)=>e===void 0?!1:pt(e,gt.GROUP_TYPE_CONVENTION,c.ConventionUUID,c).CheckIn,No={key:0,class:"font-weight-bold pt-2"},Qt=j({__name:"Badges",props:{cardClass:{default:""},convention:{},registration:{},showTitle:{type:Boolean,default:!0}},setup(e){const c=Ae(),o=St(),i=E([]);let r;const f=il();f&&"$NDEFReader"in f.appContext.config.globalProperties&&(r=f.appContext.config.globalProperties.$NDEFReader);const T=E(!!r),u=E(e.registration.BadgeSerialNumber),a=E(""),s=E(!1),d=E(2),U=Be();let v=!1,m=!1;e.convention&&(v=Pa(U,e.convention),m=Et(U,e.convention));const p=D=>{var A;const V=document.createElement("a");V.download=`${((A=e.convention)==null?void 0:A.Name)||""} Badge Image - ${e.registration.Reference} - ${e.registration.User.DisplayName}.jpg`,V.href=D,document.body.appendChild(V),V.click(),document.body.removeChild(V)},I=async D=>o.GetConBadgeImageURL(e.registration.RegistrationUUID,D),k=()=>{if(T.value)try{const D=new r;D.addEventListener("readingerror",()=>{a.value="Error Reading Card",s.value=!0}),D.addEventListener("reading",V=>{if(V.serialNumber){const A=V.serialNumber;a.value="Obtained Card Details",s.value=!0,u.value=A,c.setBadgeSerial(e.registration.RegistrationUUID,u.value).then(P=>{P?(a.value="Badge Serial Saved",s.value=!0):(a.value="Failed to Save Badge Serial",s.value=!0)})}else a.value="Serial Number not Found",s.value=!0}),D.scan&&D.scan()}catch{}};return c.getConBadgeList(e.registration.RegistrationUUID).then(D=>{D.forEach(V=>{I(V).then(A=>{i.value.push({template:V,url:A})})})}).catch(()=>{}),(D,V)=>(n(!0),_(h,null,W(i.value,A=>(n(),S($e,{key:A.template,class:Je(D.cardClass)},{default:l(()=>[t(ot,null,{default:l(()=>[D.showTitle?(n(),S(We,{key:0,class:"text-center"},{default:l(()=>[R(" Badges (#"+y(D.registration.Reference)+" "+y(D.registration.User.DisplayName)+") ",1)]),_:1})):N("",!0)]),_:1}),t(Ze,{class:"text-center"},{default:l(()=>[t(jt,{class:"d-block ma-auto",src:A.url,height:"280",width:"280"},null,8,["src"]),u.value?(n(),_("p",No,y(u.value),1)):N("",!0)]),_:2},1024),t(Kt,{class:"justify-center"},{default:l(()=>[T.value&&(g(m)||g(v))?(n(),S(q,{key:0,"prepend-icon":"mdi:mdi-nfc",color:"warning",variant:"flat",onClick:k},{default:l(()=>[R("Link Card")]),_:1})):N("",!0),t(q,{color:"primary","prepend-icon":"mdi:mdi-download",variant:"flat",onClick:P=>p(A.url)},{default:l(()=>[R("Download")]),_:2},1032,["onClick"])]),_:2},1024),t(yl,{modelValue:s.value,"onUpdate:modelValue":V[0]||(V[0]=P=>s.value=P),message:a.value,timeout:d.value*1e3},null,8,["modelValue","message","timeout"])]),_:2},1032,["class"]))),128))}}),bo=j({__name:"DataPanelText",props:Q({convention:{},data:{},forms:{}},{modelValue:{required:!0},modelModifiers:{},registration:{required:!0},registrationModifiers:{}}),emits:["update:modelValue","update:registration"],setup(e){const c=te(e,"modelValue"),o=te(e,"registration"),i=E(e.data),r=ue(()=>a.value?"":i.value!==e.data?"mdi:mdi-content-save":""),f=Be(),T=Ae(),u=E(Et(f,e.convention)),a=E(!1),s=()=>{a.value=!0,T.directEditFieldData(o.value.RegistrationUUID,c.value.LayoutItemUUID,i.value).then(d=>{d&&o.value.Submissions.find(U=>!!U.Data.find(v=>{if(v.SectionFieldUUID===c.value.SectionFieldUUID)return v.Data=d,!0})),a.value=!1}).catch(()=>{})};return(d,U)=>c.value.Meta.DirectEdit&&(u.value||c.value.Meta.DirectEditPermission==="View")?(n(),S(oe,{key:0,modelValue:i.value,"onUpdate:modelValue":U[0]||(U[0]=v=>i.value=v),"append-inner-icon":r.value,"onClick:appendInner":s},Xe({_:2},[a.value?{name:"append-inner",fn:l(()=>[t(ga,{color:"primary",indeterminate:"",size:30})]),key:"0"}:void 0]),1032,["modelValue","append-inner-icon"])):(n(),_(h,{key:1},[R(y(d.data),1)],64))}}),Lo={key:4},wo={key:8},Fo=j({__name:"FormDataItem",props:Q({accommodations:{},convention:{},extras:{},forms:{},interests:{},itemClass:{},tickets:{},venues:{}},{modelValue:{required:!0},modelModifiers:{},registration:{required:!0},registrationModifiers:{}}),emits:["update:modelValue","update:registration"],setup(e){const c=te(e,"modelValue"),o=te(e,"registration"),i=ue(()=>{var U,v,m,p;const s=c.value,d=()=>{var I;for(let k=0;k<e.forms.length;k+=1)for(let D=0;D<e.forms[k].Sections.length;D+=1)if(e.forms[k].Sections[D].Fields){const V=(I=e.forms[k].Sections[D].Fields)==null?void 0:I.find(A=>A.SectionFieldUUID===s.SectionFieldUUID);if(V)return V}};return((v=(U=s.SectionField)==null?void 0:U.Field)==null?void 0:v.Type)||((p=(m=d())==null?void 0:m.Field)==null?void 0:p.Type)}),r=ue(()=>{for(let s=0;s<o.value.Submissions.length;s+=1){const U=o.value.Submissions[s].Data.find(v=>v.SectionFieldUUID===c.value.SectionFieldUUID);if(U)return U.Data}return""}),f=Ae(),T=St(),u=E(""),a=E("");if(i.value==="BADGE_IMAGE")try{const s=JSON.parse(r.value||"{}");s.fileUUID&&(a.value=T.GetBadgeImageURL(s.fileUUID)),o.value&&f.getConBadgeDisplayName(o.value.RegistrationUUID).then(d=>{d&&(u.value=d)}).catch(()=>{})}catch{}return(s,d)=>i.value==="ACCOMMODATION"?(n(),S(Fa,{key:0,convention:s.convention,tickets:s.tickets,accommodations:s.accommodations,venues:s.venues,registration:o.value,forms:s.forms,modelValue:c.value,"onUpdate:modelValue":d[0]||(d[0]=U=>c.value=U),data:r.value},null,8,["convention","tickets","accommodations","venues","registration","forms","modelValue","data"])):i.value==="EXTRAS"?(n(),S(ba,{key:1,value:r.value,extras:s.extras},null,8,["value","extras"])):i.value==="TICKET"?(n(),S(wa,{key:2,value:r.value,tickets:s.tickets},null,8,["value","tickets"])):i.value==="INTERESTS"?(n(),S(La,{key:3,value:r.value,interests:s.interests},null,8,["value","interests"])):i.value==="CHECKBOX"?(n(),_("div",Lo,[r.value?(n(),S(Me,{key:0,icon:"mdi:mdi-check",color:"success"})):(n(),S(Me,{key:1,icon:"mdi:mdi-close",color:"error"}))])):i.value==="AGE"?(n(),S(ko,{key:5,data:r.value,forms:s.forms,registration:o.value,modelValue:c.value,"onUpdate:modelValue":d[1]||(d[1]=U=>c.value=U)},null,8,["data","forms","registration","modelValue"])):i.value==="BADGE_IMAGE"?(n(),S(Qt,{key:6,convention:s.convention,registration:o.value,"show-title":!1,"card-class":s.itemClass},null,8,["convention","registration","card-class"])):i.value==="TEXT"?(n(),S(bo,{key:7,convention:s.convention,data:r.value,forms:s.forms,modelValue:c.value,"onUpdate:modelValue":d[2]||(d[2]=U=>c.value=U),registration:o.value,"onUpdate:registration":d[3]||(d[3]=U=>o.value=U)},null,8,["convention","data","forms","modelValue","registration"])):(n(),_("div",wo,y(r.value),1))}}),Po={key:0},$o={key:0},Bo=w("strong",null,"Total:",-1),Yo=j({__name:"DataPanelRegistrationGroup",props:{registration:{}},setup(e){const c=ue(()=>{const o=[];let i;return e.registration.Leader?i=e.registration:i=e.registration.Primary,o.push({Name:i.User.DisplayName,UUID:i.UserUUID,UserUUID:i.User.UserUUID,IsLeader:!0,Reference:i.Reference,Paid:i.Paid,Total:i.Total}),o.push(...i.Members.map(r=>({Name:r.User.DisplayName,UUID:r.UserUUID,UserUUID:r.User.UserUUID,IsLeader:!1,Reference:r.Reference,Paid:r.Paid,Total:r.Total}))),o});return(o,i)=>o.registration.Members.length===0&&!o.registration.Primary?(n(),_("em",Po," Not in a group ")):(n(),_(h,{key:1},[w("ul",null,[(n(!0),_(h,null,W(c.value,r=>(n(),_("li",{key:r.UUID,class:"ml-0"},[R(" #"+y(r.Reference)+" : "+y(r.Name)+" ",1),r.IsLeader?(n(),_("strong",$o,"(Leader)")):N("",!0)]))),128))]),Bo,R(" "+y(c.value.length),1)],64))}}),Go=j({__name:"DataPanelSubmissionDate",props:{registration:{}},setup(e){const c=ue(()=>{const o=e.registration.Submissions.find(i=>{var r;return((r=i.Form)==null?void 0:r.Type)===_e.FORM_TYPE_REGISTRATION});return o?o.CreatedAt||"":e.registration.CreatedAt||""});return(o,i)=>(n(),_("div",null,y(g(Oe)(c.value,{withDay:!1,withYear:!0})),1))}}),xo={class:"text-grey-lighten-1"},Ho=j({__name:"DataPanelSubmissionStatus",props:{convention:{},forms:{},registration:{}},emits:["showForm"],setup(e,{emit:c}){const o=c,i=Be(),r=Et(i,e.convention),f=ue(()=>e.registration.Submissions.map(a=>{const s=e.forms.find(d=>d.FormUUID===a.FormUUID);if(s)return{Heading:s.Heading,Form:s,Submission:a,Registration:e.registration}}).filter(a=>!!a)),T=(a,s,d)=>{o("showForm",a,s,d)},u=a=>({ID:0,SubmissionUUID:ye(),FormID:a.ID,FormUUID:a.FormUUID,Form:a,UserID:e.registration.UserID,UserUUID:e.registration.UserUUID,RegistrationID:e.registration.ID,RegistrationUUID:e.registration.RegistrationUUID,Registration:e.registration,Data:[],Status:Sa.SUBMISSION_STATUS_NULL});return(a,s)=>(n(),_(h,null,[w("ul",null,[(n(!0),_(h,null,W(a.forms.filter(d=>d.Type===g(_e).FORM_TYPE_ADMIN&&f.value.findIndex(U=>U.Form.ID===d.ID)<0),d=>(n(),_("li",{key:d.Heading},[w("strong",xo,y(d.Heading),1),g(r)?(n(),S(q,{key:0,class:"text-grey-lighten-1",icon:"mdi:mdi-form-select",title:"Edit Submitted Data",variant:"flat",onClick:U=>T(a.registration,d,u(d))},null,8,["onClick"])):N("",!0)]))),128))]),w("ul",null,[(n(!0),_(h,null,W(f.value,d=>(n(),_("li",{key:d.Heading},[w("strong",null,[R(y(d.Heading),1),d.Form.Type!==g(_e).FORM_TYPE_ADMIN?(n(),_(h,{key:0},[R(": ")],64)):N("",!0)]),d.Form.Type!==g(_e).FORM_TYPE_ADMIN?(n(),_("span",{key:0,class:Je(g(pa)(d.Submission.Status))},y(g(qt)(d.Submission.Status)),3)):N("",!0),g(r)?(n(),S(q,{key:1,icon:"mdi:mdi-form-select",title:"Edit Submitted Data",variant:"flat",onClick:U=>T(d.Registration,d.Form,d.Submission)},null,8,["onClick"])):N("",!0)]))),128))])],64))}}),qo={key:0,class:"text-blue"},Ko={key:1,class:"text-red"},jo={key:2,class:"text-orange"},zo={key:3,class:"text-orange"},Qo={key:4,class:"text-orange"},Jo={key:5,class:"text-orange"},Xo={key:6,class:"text-green"},Wo=j({__name:"DataPanelPaymentStatus",props:{registration:{}},setup(e){const c=ue(()=>{if(e.registration.Paid===0&&e.registration.Total)return"REQUIRED";if(e.registration.Total>e.registration.Paid)return"ADDITIONAL_REQUIRED";const o=e.registration.Members.find(i=>i.Paid===0&&(i.Total||0)>0);return o?e.registration.Total===0&&o.Total===0?"NOT_REQUIRED":e.registration.Total===0&&o.Total||e.registration.Total>0&&o.Total===0?"MISSING_REQUIRED":e.registration.Paid>=e.registration.Total?"AWAITING_PARTNER":"ALL_REQUIRED":e.registration.Total===0?"NOT_REQUIRED":"COMPLETE"});return(o,i)=>c.value=="NOT_REQUIRED"?(n(),_("div",qo,"No Payment Requested")):c.value=="MISSING_REQUIRED"?(n(),_("div",Ko,"Partner Payment Not Requested")):c.value=="AWAITING_PARTNER"?(n(),_("div",jo,"Awaiting Partner Payment")):c.value=="ALL_REQUIRED"?(n(),_("div",zo,"Awaiting Payments")):c.value=="REQUIRED"?(n(),_("div",Qo,"Awaiting Payment")):c.value=="ADDITIONAL_REQUIRED"?(n(),_("div",Jo,"Awaiting Additional Payments")):(n(),_("div",Xo,"Completed"))}});var Zo=["onActivate","onAddUndo","onBeforeAddUndo","onBeforeExecCommand","onBeforeGetContent","onBeforeRenderUI","onBeforeSetContent","onBeforePaste","onBlur","onChange","onClearUndos","onClick","onContextMenu","onCopy","onCut","onDblclick","onDeactivate","onDirty","onDrag","onDragDrop","onDragEnd","onDragGesture","onDragOver","onDrop","onExecCommand","onFocus","onFocusIn","onFocusOut","onGetContent","onHide","onInit","onKeyDown","onKeyPress","onKeyUp","onLoadContent","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp","onNodeChange","onObjectResizeStart","onObjectResized","onObjectSelected","onPaste","onPostProcess","onPostRender","onPreProcess","onProgressState","onRedo","onRemove","onReset","onSaveContent","onSelectionChange","onSetAttrib","onSetContent","onShow","onSubmit","onUndo","onVisualAid"],en=function(e){return Zo.map(function(c){return c.toLowerCase()}).indexOf(e.toLowerCase())!==-1},tn=function(e,c,o){Object.keys(c).filter(en).forEach(function(i){var r=c[i];typeof r=="function"&&(i==="onInit"?r(e,o):o.on(i.substring(2),function(f){return r(f,o)}))})},an=function(e,c,o,i){var r=e.modelEvents?e.modelEvents:null,f=Array.isArray(r)?r.join(" "):r;fe(i,function(T,u){o&&typeof T=="string"&&T!==u&&T!==o.getContent({format:e.outputFormat})&&o.setContent(T)}),o.on(f||"change input undo redo",function(){c.emit("update:modelValue",o.getContent({format:e.outputFormat}))})},ln=function(e,c,o,i,r,f){i.setContent(f()),o.attrs["onUpdate:modelValue"]&&an(c,o,i,r),tn(e,o.attrs,i)},da=0,$a=function(e){var c=Date.now(),o=Math.floor(Math.random()*1e9);return da++,e+"_"+o+da+String(c)},on=function(e){return e!==null&&e.tagName.toLowerCase()==="textarea"},ma=function(e){return typeof e>"u"||e===""?[]:Array.isArray(e)?e:e.split(" ")},nn=function(e,c){return ma(e).concat(ma(c))},sn=function(e){return e==null},ca=function(){return{listeners:[],scriptId:$a("tiny-script"),scriptLoaded:!1}},un=function(){var e=ca(),c=function(r,f,T,u){var a=f.createElement("script");a.referrerPolicy="origin",a.type="application/javascript",a.id=r,a.src=T;var s=function(){a.removeEventListener("load",s),u()};a.addEventListener("load",s),f.head&&f.head.appendChild(a)},o=function(r,f,T){e.scriptLoaded?T():(e.listeners.push(T),r.getElementById(e.scriptId)||c(e.scriptId,r,f,function(){e.listeners.forEach(function(u){return u()}),e.scriptLoaded=!0}))},i=function(){e=ca()};return{load:o,reinitialize:i}},rn=un(),dn=function(){return typeof window<"u"?window:global},je=function(){var e=dn();return e&&e.tinymce?e.tinymce:null},mn={apiKey:String,cloudChannel:String,id:String,init:Object,initialValue:String,inline:Boolean,modelEvents:[String,Array],plugins:[String,Array],tagName:String,toolbar:[String,Array],modelValue:String,disabled:Boolean,tinymceScriptSrc:String,outputFormat:{type:String,validator:function(e){return e==="html"||e==="text"}}},Ve=function(){return Ve=Object.assign||function(e){for(var c,o=1,i=arguments.length;o<i;o++){c=arguments[o];for(var r in c)Object.prototype.hasOwnProperty.call(c,r)&&(e[r]=c[r])}return e},Ve.apply(this,arguments)},cn=function(e,c,o,i){return e(i||"div",{id:c,ref:o})},vn=function(e,c,o){return e("textarea",{id:c,visibility:"hidden",ref:o})},Lt={selector:void 0,target:void 0},fn=j({props:mn,setup:function(e,c){var o=e.init?Ve(Ve({},e.init),Lt):Ve({},Lt),i=sl(e),r=i.disabled,f=i.modelValue,T=i.tagName,u=E(null),a=null,s=e.id||$a("tiny-vue"),d=e.init&&e.init.inline||e.inline,U=!!c.attrs["onUpdate:modelValue"],v=!0,m=e.initialValue?e.initialValue:"",p="",I=function(V){return U?function(){return f!=null&&f.value?f.value:""}:function(){return V?m:p}},k=function(){var V=I(v),A=Ve(Ve({},o),{readonly:e.disabled,target:u.value,plugins:nn(o.plugins,e.plugins),toolbar:e.toolbar||o.toolbar,inline:d,setup:function(P){a=P,P.on("init",function(se){return ln(se,e,c,P,f,V)}),typeof o.setup=="function"&&o.setup(P)}});on(u.value)&&(u.value.style.visibility=""),je().init(A),v=!1};fe(r,function(V){var A;a!==null&&(typeof((A=a.mode)===null||A===void 0?void 0:A.set)=="function"?a.mode.set(V?"readonly":"design"):a.setMode(V?"readonly":"design"))}),fe(T,function(V){var A;U||(p=a.getContent()),(A=je())===null||A===void 0||A.remove(a),Ut(function(){return k()})}),ul(function(){if(je()!==null)k();else if(u.value&&u.value.ownerDocument){var V=e.cloudChannel?e.cloudChannel:"6",A=e.apiKey?e.apiKey:"no-api-key",P=sn(e.tinymceScriptSrc)?"https://cdn.tiny.cloud/1/".concat(A,"/tinymce/").concat(V,"/tinymce.min.js"):e.tinymceScriptSrc;rn.load(u.value.ownerDocument,P,k)}}),rl(function(){je()!==null&&je().remove(a)}),d||(dl(function(){v||k()}),ml(function(){var V;U||(p=a.getContent()),(V=je())===null||V===void 0||V.remove(a)}));var D=function(V){var A;p=a.getContent(),(A=je())===null||A===void 0||A.remove(a),o=Ve(Ve(Ve({},o),V),Lt),Ut(function(){return k()})};return c.expose({rerender:D,getEditor:function(){return a}}),function(){return d?cn(aa,s,u,e.tagName):vn(aa,s,u)}}});const Un=["colspan"],An=w("strong",null,"E-Mail Content",-1),Tn=["innerHTML"],_n=j({__name:"Communications",props:{expanded:{type:Boolean,default:!0},hideHistory:{type:Boolean,default:!1},registration:{},showEditor:{type:Boolean}},emits:["close-editor"],setup(e,{emit:c}){const o=Ae(),i=E([]),r=E({From:"",Subject:"",HTML:""}),f=E(""),T=E(""),u=E(""),a=E(!1),s=E(e.expanded?["1"]:[]),d=E([]),U=E([]),v=E([{key:"CreatedAt",title:"Date"},{key:"Subject",title:"Subject"},{key:"User.DisplayName",title:"Sender"},{key:"Status",title:"Status"}]),m=E([{key:"CreatedAt",order:"asc"}]);fe(r,V=>{u.value=V.From||u.value||"",T.value=V.Subject||T.value||"",f.value=V.HTML||f.value||""});const p=c,I=()=>{o.getRegistrationEmails(e.registration.RegistrationUUID).then(V=>{V&&(V.forEach(A=>{A.CreatedAt=At(new Date(A.CreatedAt||"")),A.Status=ao(A.Status),A.User||(A.User={ID:0,UserUUID:"",DisplayName:"System",Handle:"",Credentials:[],Additional:{FirstName:"",LastName:"",DOB:"",Email:""},Data:"",Groups:[],Tags:[]})}),U.value=V)})};I(),(()=>{o.getRegistrationEmailTemplates(e.registration.RegistrationUUID).then(V=>{V&&(i.value=V)})})();const D=({callback:V})=>{o.sendRegistrationEmail(e.registration.RegistrationUUID,u.value,T.value,f.value).then(A=>{A?V&&(V("Email Sent"),I(),setTimeout(()=>{a.value=!1},2e3)):V&&V("Not sent")}).catch(()=>{V&&V("Not sent")})};return(V,A)=>(n(),_(h,null,[V.showEditor?(n(),S(me,{key:0,class:"px-0",style:{"max-width":"calc(100vw - 64px)"}},{default:l(()=>[t(X,null,{default:l(()=>[t(M,null,{default:l(()=>[t(Ta,{items:i.value,"item-title":"Subject","return-object":"",label:"Template","hide-details":"",modelValue:r.value,"onUpdate:modelValue":A[0]||(A[0]=P=>r.value=P),variant:"outlined"},null,8,["items","modelValue"])]),_:1})]),_:1}),t(X,null,{default:l(()=>[t(M,{cols:"12"},{default:l(()=>[t(oe,{modelValue:u.value,"onUpdate:modelValue":A[1]||(A[1]=P=>u.value=P),label:"From",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),t(M,{cols:"12"},{default:l(()=>[t(oe,{modelValue:T.value,"onUpdate:modelValue":A[2]||(A[2]=P=>T.value=P),label:"Subject",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),t(M,{cols:"12"},{default:l(()=>[t(g(fn),{modelValue:f.value,"onUpdate:modelValue":A[3]||(A[3]=P=>f.value=P),"api-key":"g9sce3fktcgvk0i7sp96cahgyk4cos7q27es3ubnlal3xf3z"},null,8,["modelValue"])]),_:1})]),_:1}),t(X,null,{default:l(()=>[t(M,null,{default:l(()=>[t(rt,{onClick:A[4]||(A[4]=P=>p("close-editor")),label:"Close E-mail Editor",color:"secondary","prepend-icon":"mdi:mdi-window-close"})]),_:1}),t(M,{class:"text-right"},{default:l(()=>[t(rt,{onClick:D,label:"Send",color:"error"})]),_:1})]),_:1})]),_:1})):N("",!0),U.value.length&&!V.hideHistory?(n(),S(Ct,{key:1,class:"my-2",multiple:!0,modelValue:s.value,"onUpdate:modelValue":A[7]||(A[7]=P=>s.value=P)},{default:l(()=>[t(It,{value:"1"},{default:l(()=>[t(Dt,null,{default:l(()=>[R(" Email History ")]),_:1}),t(yt,null,{default:l(()=>[t(zt,{items:U.value,headers:v.value,"show-expand":!0,"item-value":"EmailUUID",expanded:d.value,"onUpdate:expanded":A[5]||(A[5]=P=>d.value=P),"sort-by":m.value,"onUpdate:sortBy":A[6]||(A[6]=P=>m.value=P)},{"expanded-row":l(({columns:P,item:se})=>[w("tr",null,[w("td",{colspan:P.length},[An,w("div",{class:"communicationsViewEmailPreview",innerHTML:se.HTML},null,8,Tn)],8,Un)])]),"footer.prepend":l(()=>[t(q,{"prepend-icon":"mdi:mdi-refresh",color:"primary",class:"mr-4",onClick:I},{default:l(()=>[R("Refresh")]),_:1})]),_:1},8,["items","headers","expanded","sort-by"])]),_:1})]),_:1})]),_:1},8,["modelValue"])):N("",!0)],64))}}),Ba=j({__name:"Emails",props:{allowSending:{type:Boolean,default:!0},expanded:{type:Boolean,default:!0},hideHistory:{type:Boolean,default:!1},showTitle:{type:Boolean,default:!0},registration:{},textClass:{default:""}},setup(e){const c=E(!1);return(o,i)=>(n(),_(h,null,[t($e,null,{default:l(()=>[o.showTitle?(n(),S(ot,{key:0},{default:l(()=>[t(We,null,{default:l(()=>[R(" E-Mails (#"+y(o.registration.Reference)+" "+y(o.registration.User.DisplayName)+") ",1)]),_:1})]),_:1})):N("",!0),t(Ze,{class:Je(o.textClass)},{default:l(()=>[o.allowSending?(n(),S(X,{key:0},{default:l(()=>[t(M,{cols:"12"},{default:l(()=>[t(q,{"prepend-icon":"mdi:mdi-email",color:"primary",onClick:i[0]||(i[0]=r=>c.value=!0)},{default:l(()=>[R(" Prepare Email ")]),_:1})]),_:1})]),_:1})):N("",!0)]),_:1},8,["class"])]),_:1}),t(_n,{registration:o.registration,expanded:o.expanded,"hide-history":o.hideHistory,"show-editor":c.value,onCloseEditor:i[1]||(i[1]=r=>c.value=!1)},null,8,["registration","expanded","hide-history","show-editor"])],64))}}),En=j({__name:"EditNoteCategoryDialog",props:Q({convention:{},noteCategory:{},title:{}},{modelValue:{type:Boolean,required:!0},modelModifiers:{}}),emits:Q(["update:noteCategory"],["update:modelValue"]),setup(e,{emit:c}){const o=e,{title:i=""}=o,r=c,f=te(e,"modelValue"),T=mt(o,r,void 0,void 0,"noteCategory"),u=E(Ee(T.value));fe(T,()=>{u.value=Ee(T.value)});const a=()=>{f.value=!1},s=()=>{u.value=Ee(T.value)},d=()=>{T.value=u.value};return(U,v)=>(n(),S(Fe,{modelValue:f.value,"onUpdate:modelValue":v[2]||(v[2]=m=>f.value=m),onReset:s,onSave:d,title:g(i),color:"primary",persistent:!0,fullscreen:!1,"hide-extension":!0},{default:l(()=>[t(me,{class:"pa-0",fluid:!0},{default:l(()=>[t(X,null,{default:l(()=>[t(M,{cols:"12",sm:"6",md:"4"},{default:l(()=>[t(oe,{modelValue:u.value.Name,"onUpdate:modelValue":v[0]||(v[0]=m=>u.value.Name=m),label:"Internal name",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),t(M,{cols:"12",sm:"6",md:"4"},{default:l(()=>[t(ya,{modelValue:u.value.Groups,"onUpdate:modelValue":v[1]||(v[1]=m=>u.value.Groups=m),convention:U.convention,label:"Groups",variant:"outlined","hide-details":""},null,8,["modelValue","convention"])]),_:1})]),_:1})]),_:1})]),actions:l(()=>[t(q,{color:"blue-darken-1",variant:"text",onClick:a},{default:l(()=>[R(" Cancel ")]),_:1}),t(q,{color:"blue-darken-1",variant:"text",onClick:s},{default:l(()=>[R(" Reset ")]),_:1}),t(Pe),t(q,{color:"blue-darken-1",variant:"text",onClick:d},{default:l(()=>[R(" Save ")]),_:1})]),_:1},8,["modelValue","title"]))}}),gn=()=>{const e=E(""),c=()=>{const o={x:window.innerWidth,y:window.innerHeight};o.x<600?e.value="xs":o.x>=600&&o.x<960?e.value="sm":o.x>=960&&o.x<1280?e.value="md":o.x>=1280&&o.x<1920?e.value="lg":o.x>=1920&&o.x<2560?e.value="xl":o.x>=2560&&(e.value="xxl")};return window.addEventListener("resize",c),c(),e},pn={style:{"list-style":"none"}},Sn=j({__name:"NoteCategories",props:{hideHistory:{type:Boolean},convention:{},showEditor:{type:Boolean}},emits:["close"],setup(e,{emit:c}){const o=Ae(),i=c,r=E(!1),f=E(!1),T=E(""),u=E([]),a=E([{key:"Name",title:"Name"},{key:"Groups",title:"Groups"},{key:"actions",title:"",sortable:!1}]),s=gn();E([{key:"CreatedAt",order:"asc"}]);const d=()=>({ID:0,NoteCategoryUUID:ye(),ConventionID:e.convention.ID,ConventionUUID:e.convention.ConventionUUID,Name:"",Groups:[],Notes:[]}),U=E(-1),v=E(d()),m=E(d()),p=()=>{m.value.NoteCategoryUUID=ye(),v.value=Object.assign({},d()),U.value=-1,r.value=!0},I=z=>{U.value=u.value.indexOf(z),v.value=Object.assign({},z),r.value=!0},k=z=>{U.value=u.value.indexOf(z),v.value=Object.assign({},z),f.value=!0},D=()=>{o.deleteNoteCategory(v.value.NoteCategoryUUID).then(z=>{z&&(u.value.splice(U.value,1),A())})},V=()=>{r.value=!1,Ut(()=>{v.value=Object.assign({},m.value),U.value=-1})},A=()=>{f.value=!1,Ut(()=>{v.value=Object.assign({},m.value),U.value=-1})},P=()=>{o.saveNoteCategory(v.value).then(z=>{z&&(U.value>-1?Object.assign(u.value[U.value],z):u.value.push(z),V())})};return(()=>{o.getNoteCategories(e.convention.ConventionUUID).then(z=>{z&&(u.value=z)})})(),(z,x)=>(n(),S(zt,{headers:a.value,items:u.value,"sort-by":[{key:"calories",order:"asc"}],class:"elevation-1"},{top:l(()=>[t(Bt,{color:"primary"},Xe({default:l(()=>[t(Ma,null,{default:l(()=>[R("Note Categories")]),_:1}),t(Yl,{class:"mx-4 d-none d-sm-inline-flex",inset:!0,vertical:!0}),t(Pe,{class:"d-none d-sm-inline-flex"}),g(s)!="xs"?(n(),S(q,{key:0,dark:"",class:"mb-2","prepend-icon":"mdi:mdi-pencil",onClick:p},{default:l(()=>[R(" New Item ")]),_:1})):N("",!0),t(q,{dark:"",class:"mb-2",icon:"mdi:mdi-window-close",onClick:x[0]||(x[0]=le=>i("close"))}),t(Oa,{modelValue:f.value,"onUpdate:modelValue":x[1]||(x[1]=le=>f.value=le),onDelete:D},null,8,["modelValue"])]),_:2},[g(s)=="xs"?{name:"extension",fn:l(()=>[t(Pe),t(q,{dark:"",class:"mb-2","prepend-icon":"mdi:mdi-pencil",onClick:p},{default:l(()=>[R(" New Item ")]),_:1})]),key:"0"}:void 0]),1024),r.value?(n(),S(En,{key:0,modelValue:r.value,"onUpdate:modelValue":x[2]||(x[2]=le=>r.value=le),"note-category":v.value,"onUpdate:noteCategory":[x[3]||(x[3]=le=>v.value=le),P],title:T.value,convention:z.convention},null,8,["modelValue","note-category","title","convention"])):N("",!0)]),"item.Groups":l(({item:le})=>[w("ul",pn,[(n(!0),_(h,null,W(le.Groups,Y=>(n(),_("li",{key:Y.GroupUUID,class:"py-1"},y(Y.Name),1))),128))])]),"item.actions":l(({item:le})=>[t(Me,{size:"small",class:"me-2",onClick:Y=>I(le)},{default:l(()=>[R(" mdi:mdi-pencil ")]),_:2},1032,["onClick"]),t(Me,{size:"small",onClick:Y=>k(le)},{default:l(()=>[R(" mdi:mdi-delete ")]),_:2},1032,["onClick"])]),_:1},8,["headers","items"]))}}),Dn=j({__name:"SelectNoteCategories",props:Q({convention:{},chips:{type:Boolean,default:!1},clearable:{type:Boolean,default:!1},hint:{default:""},label:{},variant:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:Q(["change"],["update:modelValue"]),setup(e,{emit:c}){const o=te(e,"modelValue"),i=c,r=E([]),f=Ae(),T=E([]),u=E(""),a=E(0),s=ue(()=>[...T.value].map(v=>({title:v.Name,value:r.value.find(m=>m.NoteCategoryUUID===v.NoteCategoryUUID)||v})));return typeof e.convention=="object"?u.value=e.convention.ConventionUUID:u.value=e.convention||"",(async()=>{const U=[];u.value&&U.push(f.getNoteCategories(u.value));const v=await Promise.all(U);if(u.value&&v.length==1&&(T.value=v[0].sort((m,p)=>m.Name.localeCompare(p.Name))),Array.isArray(o.value))a.value=2,s.value.forEach(m=>{Array.isArray(o.value)&&o.value.find(I=>I.NoteCategoryUUID===m.value.NoteCategoryUUID)&&r.value.push(m.value)});else if(typeof o.value=="string"){a.value=1;try{const m=JSON.parse(o.value);s.value.forEach(p=>{m.find(k=>k.NoteCategoryUUID===p.value.NoteCategoryUUID)&&r.value.push(p.value)})}catch{}}})(),fe(r,()=>{switch(a.value){default:case 2:{o.value=r.value,i("change");break}case 1:{o.value=JSON.stringify(r.value),i("change");break}}}),(U,v)=>(n(),S(Ta,{modelValue:r.value,"onUpdate:modelValue":v[0]||(v[0]=m=>r.value=m),chips:U.chips,multiple:"",label:U.label||"Tags",variant:U.variant||"solo",hint:U.hint,"persistent-hint":!0,clearable:U.clearable,items:s.value,"item-title":"title","item-value":"value"},null,8,["modelValue","chips","label","variant","hint","clearable","items"]))}}),yn=j({__name:"EditNoteDialog",props:Q({convention:{},note:{},title:{}},{modelValue:{type:Boolean,required:!0},modelModifiers:{}}),emits:Q(["update:note","saved"],["update:modelValue"]),setup(e,{emit:c}){const o=e,{title:i=""}=o,r=Ae(),f=c,T=te(e,"modelValue"),u=mt(o,f,void 0,void 0,"note"),a=E(Ee(u.value));fe(u,()=>{a.value=Ee(u.value)});const s=()=>{a.value=Ee(u.value)},d=U=>{a.value.NoteCategories===null&&(a.value.NoteCategories=[]),a.value.CreatedAt=void 0,a.value.DeletedAt=void 0,a.value.UpdatedAt=void 0,a.value.Admin=void 0,a.value.AdminID=void 0,a.value.AdminUUID=void 0,r.saveNote(a.value).then(v=>{v?(a.value=Ee(v),U&&U("Note Saved"),u.value=a.value,f("saved",u.value)):U&&U("Internal Error Saving Note")}).catch(v=>{U&&U("Error Saving Note:"+v.ErrorMessage)})};return(U,v)=>a.value?(n(),S(Fe,{key:0,"card-class":"pa-4",modelValue:T.value,"onUpdate:modelValue":v[3]||(v[3]=m=>T.value=m),onReset:s,onSave:d,title:g(i),color:"primary",persistent:!0,fullscreen:!1,"hide-extension":!0,"show-close-action":!0,"show-reset-action":!0,"show-save-action":!0},{default:l(()=>[t(me,{class:"pa-0",fluid:!0},{default:l(()=>[t(X,null,{default:l(()=>[t(M,{cols:"12"},{default:l(()=>[t(Dn,{modelValue:a.value.NoteCategories,"onUpdate:modelValue":v[0]||(v[0]=m=>a.value.NoteCategories=m),convention:U.convention,label:"Categories",variant:"outlined","hide-details":"",chips:!0},null,8,["modelValue","convention"])]),_:1})]),_:1}),t(X,null,{default:l(()=>[t(M,{cols:"12"},{default:l(()=>[t(oe,{modelValue:a.value.Subject,"onUpdate:modelValue":v[1]||(v[1]=m=>a.value.Subject=m),label:"Subject",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),t(M,{cols:"12"},{default:l(()=>[t(ha,{modelValue:a.value.Description,"onUpdate:modelValue":v[2]||(v[2]=m=>a.value.Description=m),label:"Note",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue","title"])):N("",!0)}}),Ya=j({__name:"Notes",props:{allowAdding:{type:Boolean,default:!0},cardClass:{default:""},convention:{},expanded:{type:Boolean,default:!0},hideHistory:{type:Boolean},registration:{},showControlPanel:{type:Boolean,default:!0},showEditor:{type:Boolean},showTitle:{type:Boolean,default:!0},textClass:{default:""}},setup(e){const c=Ae(),o=()=>({ID:0,NoteUUID:ye(),Description:"",NoteCategories:[],Registration:e.registration,RegistrationID:e.registration.ID,RegistrationUUID:e.registration.RegistrationUUID,Subject:""}),i=E(!1),r=E(!1),f=E([]),T=E([]),u=E(o()),a=()=>{u.value=o(),i.value=!0},s=v=>{u.value=v,i.value=!0},d=()=>{c.getRegistrationNotes(e.registration.RegistrationUUID).then(v=>{v&&(v.forEach(m=>{m.CreatedAt=At(new Date(m.CreatedAt||"")),m.Admin||(m.Admin={ID:0,UserUUID:"",DisplayName:"System",Handle:"",Credentials:[],Additional:{FirstName:"",LastName:"",DOB:"",Email:""},Data:"",Groups:[],Tags:[]})}),f.value=v,e.expanded&&(T.value=v.map(m=>m.NoteUUID)))})},U=()=>{d(),setTimeout(()=>{i.value=!1},2e3)};return d(),(v,m)=>(n(),_(h,null,[t($e,{class:Je(v.cardClass)},{default:l(()=>[t(ot,null,{default:l(()=>[t(We,null,{default:l(()=>[t(X,{class:"flex-row-reverse"},{default:l(()=>[v.showControlPanel?(n(),S(M,{key:0,class:"text-right flex-shrink-1 flex-grow-0",style:{"flex-grow":"0 !important"}},{default:l(()=>[t(q,{class:"d-sm-none",size:"xs",icon:"mdi:mdi-cog",variant:"text",color:"warning",onClick:m[0]||(m[0]=p=>r.value=!0)}),t(q,{class:"d-none d-sm-inline-flex","prepend-icon":"mdi:mdi-cog",variant:"text",color:"warning",onClick:m[1]||(m[1]=p=>r.value=!0)},{default:l(()=>[R("Categories")]),_:1})]),_:1})):N("",!0),v.showTitle?(n(),S(M,{key:1,class:"text-wrap flex-grow-1"},{default:l(()=>[R(" Notes (#"+y(v.registration.Reference)+" "+y(v.registration.User.DisplayName)+") ",1)]),_:1})):N("",!0)]),_:1})]),_:1})]),_:1}),t(Ze,{class:Je(v.textClass)},{default:l(()=>[f.value.length===0?(n(),_(h,{key:0},[R(" No Notes Recorded ")],64)):(n(),S(Ct,{key:1,multiple:!0,variant:"accordion",modelValue:T.value,"onUpdate:modelValue":m[2]||(m[2]=p=>T.value=p)},{default:l(()=>[(n(!0),_(h,null,W(f.value,p=>(n(),S(It,{key:`${p.NoteUUID}.${p.UpdatedAt}`,value:p.NoteUUID},{default:l(()=>[t(Dt,{class:"py-0"},{default:l(()=>[R(y(p.Subject)+" ",1),t(ka,{class:"ml-4"},{default:l(()=>[p.NoteCategories.length===0?(n(),S(Yt,{key:0},{default:l(()=>[R(" Global ")]),_:1})):N("",!0),(n(!0),_(h,null,W(p.NoteCategories,I=>(n(),S(Yt,{key:I.NoteCategoryUUID},{default:l(()=>[R(y(I.Name),1)]),_:2},1024))),128))]),_:2},1024)]),_:2},1024),t(yt,null,{default:l(()=>[t(X,null,{default:l(()=>[t(M,null,{default:l(()=>[R(y(p.Description),1)]),_:2},1024)]),_:2},1024),t(X,null,{default:l(()=>[t(M,null,{default:l(()=>[R(y(g(Oe)(p.UpdatedAt||""))+" ",1),p&&p.Admin&&p.Admin.DisplayName?(n(),_(h,{key:0},[R(" - "+y(p.Admin.DisplayName),1)],64)):N("",!0)]),_:2},1024),t(M,{class:"text-right"},{default:l(()=>[t(q,{color:"primary","prepend-icon":"mdi:mdi-pencil",onClick:I=>s(p)},{default:l(()=>[R("Edit")]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"]))]),_:1},8,["class"]),v.allowAdding?(n(),S(Kt,{key:0},{default:l(()=>[t(q,{color:"primary",variant:"flat",onClick:a},{default:l(()=>[R("Add Note")]),_:1})]),_:1})):N("",!0)]),_:1},8,["class"]),t(_t,{modelValue:i.value,"onUpdate:modelValue":m[5]||(m[5]=p=>i.value=p),title:"Create Note"},{default:l(()=>[t(yn,{modelValue:i.value,"onUpdate:modelValue":m[3]||(m[3]=p=>i.value=p),note:u.value,"onUpdate:note":m[4]||(m[4]=p=>u.value=p),convention:v.convention,title:"Create Note",onSaved:U},null,8,["modelValue","note","convention"])]),_:1},8,["modelValue"]),t(_t,{modelValue:r.value,"onUpdate:modelValue":m[7]||(m[7]=p=>r.value=p),title:"Note Configuration"},{default:l(()=>[t(Sn,{convention:v.convention,onClose:m[6]||(m[6]=p=>r.value=!1)},null,8,["convention"])]),_:1},8,["modelValue"])],64))}}),In=j({__name:"StripeRefundPayment",props:Q({paymentTransaction:{}},{modelValue:{type:Boolean,required:!0},modelModifiers:{}}),emits:Q(["refunded"],["update:modelValue"]),setup(e,{emit:c}){const o=te(e,"modelValue"),i=c,r=Ae(),f=E(!1),T=E("");let u=0;if(e.paymentTransaction.Data&&e.paymentTransaction.Data.PaymentIntent&&typeof e.paymentTransaction.Data.PaymentIntent=="object"){const m=e.paymentTransaction.Data.PaymentIntent;m&&(u=m.amount)}const a=E({Amount:u/100,Description:"",Reason:""}),s=E([{title:"Duplicate",value:"duplicate"},{title:"Fraudulent",value:"fraudulent"},{title:"Requested By Customer",value:"requested_by_customer"}]),d=E(!1);async function U(m){m.preventDefault(),d.value=!0,r.refundStripePayment(e.paymentTransaction.PaymentTransactionUUID,a.value).then(p=>{p?i("refunded",p):v("An unexpected error occurred.")}).catch(p=>{v("An error occurred processing the refund: "+p.toString())}),d.value=!1}const v=m=>{T.value=m,f.value=!0};return(m,p)=>(n(),S(Fe,{modelValue:o.value,"onUpdate:modelValue":p[7]||(p[7]=I=>o.value=I),title:"Refund a Stripe Payment",color:"blue-darken-4",persistent:""},{default:l(()=>[t(me,{class:"pa-0"},{default:l(()=>[t(Gl,{ref:"refundForm",id:"refund-form",onSubmit:p[4]||(p[4]=wt(I=>U(I),["prevent"]))},{default:l(()=>[t(X,null,{default:l(()=>[t(M,{cols:"12",sm:"6",md:"4",lg:"3",xl:"2"},{default:l(()=>[t(oe,{modelValue:a.value.Amount,"onUpdate:modelValue":p[0]||(p[0]=I=>a.value.Amount=I),modelModifiers:{number:!0},label:"Amount",prefix:"£",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),t(M,{cols:"12",sm:"6",md:"8",lg:"9",xl:"10"},{default:l(()=>[t(ve,{modelValue:a.value.Reason,"onUpdate:modelValue":p[1]||(p[1]=I=>a.value.Reason=I),modelModifiers:{number:!0},items:s.value,"item-title":"title","item-value":"value",label:"Stripe Refund Reason",variant:"outlined","hide-details":""},null,8,["modelValue","items"])]),_:1}),t(M,{cols:"12"},{default:l(()=>[t(oe,{modelValue:a.value.Description,"onUpdate:modelValue":p[2]||(p[2]=I=>a.value.Description=I),modelModifiers:{number:!0},label:"Refund Description",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1})]),_:1}),t(X,null,{default:l(()=>[t(M,{class:"text-right",cols:"12",sm:"3",md:"2",lg:"2",xl:"1"},{default:l(()=>[t(q,{color:"error",class:"w-100",onClick:p[3]||(p[3]=I=>o.value=!1)},{default:l(()=>[R("Cancel")]),_:1})]),_:1}),t(Pe),t(M,{class:"text-left",cols:"12",sm:"3",md:"2",lg:"2",xl:"1"},{default:l(()=>[t(q,{type:"submit",color:"success",class:"w-100"},Xe({default:l(()=>[R(" Issue Refund ")]),_:2},[d.value?{name:"prepend",fn:l(()=>[t(ga,{size:"20",indeterminate:""})]),key:"0"}:void 0]),1024)]),_:1})]),_:1})]),_:1},512)]),_:1}),t(Da,{modelValue:f.value,"onUpdate:modelValue":p[6]||(p[6]=I=>f.value=I)},{actions:l(()=>[t(q,{variant:"text",onClick:p[5]||(p[5]=I=>f.value=!1)},{default:l(()=>[R(" Close ")]),_:1})]),default:l(()=>[R(y(T.value)+" ",1)]),_:1},8,["modelValue"])]),_:1},8,["modelValue"]))}}),Cn=["colspan"],Rn=w("strong",null,"Details",-1),Vn=["innerHTML"],Ga=j({__name:"PaymentTransactions",props:{canEdit:{type:Boolean},expanded:{type:Boolean},hideHistory:{type:Boolean},updated:{},registration:{},showEditor:{type:Boolean}},emits:["close-editor","change"],setup(e,{emit:c}){const o=e;let{expanded:i=!0,hideHistory:r=!1,registration:f,showEditor:T}=o;const u=Ae(),a=E([]),s=E(i?["1"]:[]),d=E([]),U=E([{key:"CreatedAt",title:"Date"},{key:"Type",title:"Type"},{key:"Source",title:"Source"},{key:"Description",title:"Description"},{key:"Admin",title:"Admin"},{key:"Amount",title:"Amount"},{key:"Controls",title:""}]),v=E(!1),m=E(),p=E(!1),I=E(""),k=E([{key:"CreatedAt",order:"asc"}]),D=c,V=()=>({PaymentTransactionUUID:ye(),Amount:0,Data:{},Description:"",ID:0,RegistrationID:f.ID,RegistrationUUID:f.RegistrationUUID,Source:oa.PAYMENT_TRANSACTION_SOURCE_NULL,Type:Pt.PAYMENT_TRANSACTION_TYPE_NULL}),A=E(V()),{convertTransactions:P,getPaymentTransactionsDisplay:se}=Ea();fe(o,()=>{r=o.hideHistory,f=o.registration,T=o.showEditor,se(f.RegistrationUUID).then(B=>{d.value=B})});const z=()=>{se(f.RegistrationUUID).then(B=>{d.value=B})};z();const x=()=>{u.saveRegistrationPaymentTransaction(A.value).then(B=>{B&&(P(B.PaymentTransactions),A.value=V(),D("close-editor"),D("change"))})},le=B=>{const F=d.value.find(b=>b.PaymentTransactionUUID===B);F&&(m.value=F.PaymentTransaction,v.value=!0)},Y=B=>{if(B)try{d.value=P(B.PaymentTransactions),m.value=void 0,v.value=!1,I.value="Refund Processed",p.value=!0,D("change")}catch(F){console.error(F)}};return(B,F)=>(n(),_(h,null,[g(T)?(n(),_(h,{key:0},[t(We,null,{default:l(()=>[R(" Add Transaction ")]),_:1}),t(X,null,{default:l(()=>[t(M,{cols:"12",sm:"6"},{default:l(()=>[t(ve,{items:g(gl),"item-title":"title","item-value":"value",label:"Transaction Type",clearable:!0,"hide-details":"",modelValue:A.value.Type,"onUpdate:modelValue":F[0]||(F[0]=b=>A.value.Type=b),variant:"outlined"},null,8,["items","modelValue"])]),_:1}),t(M,{cols:"12",sm:"6"},{default:l(()=>[t(ve,{items:g(pl),"item-title":"title","item-value":"value",label:"Source",clearable:!0,"hide-details":"",modelValue:A.value.Source,"onUpdate:modelValue":F[1]||(F[1]=b=>A.value.Source=b),variant:"outlined"},null,8,["items","modelValue"])]),_:1})]),_:1}),t(X,null,{default:l(()=>[t(M,{cols:"12",sm:"8",md:"10"},{default:l(()=>[t(oe,{label:"Description","hide-details":"",modelValue:A.value.Description,"onUpdate:modelValue":F[2]||(F[2]=b=>A.value.Description=b),variant:"outlined"},null,8,["modelValue"])]),_:1}),t(M,{cols:"12",sm:"4",md:"2"},{default:l(()=>[t(oe,{label:"Amount","prepend-inner-icon":"mdi:mdi-currency-gbp","hide-details":"",modelValue:A.value.Amount,"onUpdate:modelValue":F[3]||(F[3]=b=>A.value.Amount=b),modelModifiers:{number:!0},variant:"outlined"},null,8,["modelValue"])]),_:1})]),_:1}),t(X,null,{default:l(()=>[t(M,{cols:"12",sm:"3",md:"2",lg:"1"},{default:l(()=>[t(q,{class:"w-100",onClick:F[4]||(F[4]=b=>D("close-editor")),color:"warning"},{default:l(()=>[R("Cancel")]),_:1})]),_:1}),t(Pe),t(M,{cols:"12",sm:"6",md:"3",lg:"2",xl:"2"},{default:l(()=>[t(q,{class:"w-100",onClick:x,color:"primary"},{default:l(()=>[R("Submit Transaction")]),_:1})]),_:1})]),_:1})],64)):N("",!0),d.value.length&&!g(r)?(n(),S(Ct,{key:1,class:"my-2",modelValue:s.value,"onUpdate:modelValue":F[10]||(F[10]=b=>s.value=b)},{default:l(()=>[t(It,{value:"1"},{default:l(()=>[t(Dt,null,{default:l(()=>[R(" Transaction History ")]),_:1}),t(yt,null,{default:l(()=>[t(zt,{items:d.value,headers:U.value,"show-expand":!1,"item-value":"PaymentTransactionUUID",expanded:a.value,"onUpdate:expanded":F[5]||(F[5]=b=>a.value=b),"sort-by":k.value,"onUpdate:sortBy":F[6]||(F[6]=b=>k.value=b),class:"transactionTable"},{"item.Controls":l(({item:b})=>[B.canEdit&&b.PaymentTransaction&&b.PaymentTransaction.Source===g(oa).PAYMENT_TRANSACTION_SOURCE_STRIPE&&b.PaymentTransaction.Type===g(Pt).PAYMENT_TRANSACTION_TYPE_PAYMENT?(n(),S(q,{key:0,icon:"mdi:mdi-credit-card-refund",variant:"text",size:"xs",onClick:Z=>le(b.PaymentTransactionUUID)},null,8,["onClick"])):N("",!0)]),"expanded-row":l(({columns:b,item:Z})=>[w("tr",null,[w("td",{colspan:b.length},[Rn,w("div",{innerHTML:Z.Data},null,8,Vn)],8,Cn)])]),"footer.prepend":l(()=>[t(q,{"prepend-icon":"mdi:mdi-refresh",color:"primary",class:"mr-4",onClick:z},{default:l(()=>[R("Refresh")]),_:1})]),_:1},8,["items","headers","expanded","sort-by"]),v.value&&m.value?(n(),S(In,{key:0,modelValue:v.value,"onUpdate:modelValue":F[7]||(F[7]=b=>v.value=b),"payment-transaction":m.value,onRefunded:Y},null,8,["modelValue","payment-transaction"])):N("",!0),t(Da,{modelValue:p.value,"onUpdate:modelValue":F[9]||(F[9]=b=>p.value=b)},{actions:l(()=>[t(q,{variant:"text",onClick:F[8]||(F[8]=b=>p.value=!1)},{default:l(()=>[R(" Close ")]),_:1})]),default:l(()=>[R(y(I.value)+" ",1)]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])):N("",!0)],64))}}),On=j({__name:"DataPanelRegistrationTags",props:Q({registration:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(e){const c=te(e,"modelValue"),o=ue(()=>!c.value.Meta.Tags||!Array.isArray(c.value.Meta.Tags)||c.value.Meta.Tags.length===0?e.registration.Tags:e.registration.Tags.filter(i=>c.value.Meta.Tags.includes(i.TagUUID)));return(i,r)=>(n(),S(ka,null,{default:l(()=>[(n(!0),_(h,null,W(o.value,f=>(n(),S(Yt,{key:f.TagUUID},{default:l(()=>[R(y(f.Title),1)]),_:2},1024))),128))]),_:1}))}}),Mn=dt(On,[["__scopeId","data-v-8cc2c172"]]);var ge=(e=>(e.CHECK_IN_STATUS_PENDING="CHECK_IN_STATUS_PENDING",e.CHECK_IN_STATUS_COMPLETED="CHECK_IN_STATUS_COMPLETED",e.CHECK_IN_STATUS_REJECTED="CHECK_IN_STATUS_REJECTED",e.CHECK_IN_STATUS_REVOKED="CHECK_IN_STATUS_REVOKED",e))(ge||{});const hn=[{title:"Pending",value:"CHECK_IN_STATUS_PENDING"},{title:"Completed",value:"CHECK_IN_STATUS_COMPLETED"},{title:"Rejected",value:"CHECK_IN_STATUS_REJECTED"},{title:"Revoked",value:"CHECK_IN_STATUS_REVOKED"}],ze=e=>{var c;return((c=hn.find(o=>o.value===e))==null?void 0:c.title)||""},kn=w("span",{class:"font-weight-bold pr-2"},"Status:",-1),Nn={key:0,class:"text-green-darken-2"},bn={key:1,class:"text-yellow-darken-4"},Ln={key:2,class:"text-red-darken-4"},wn=w("br",null,null,-1),Fn=w("span",{class:"font-weight-bold pr-2"},"Status:",-1),Pn={key:0,class:"text-green-darken-2"},$n={key:1,class:"text-yellow-darken-4"},Bn={key:2,class:"text-red-darken-4"},Yn=w("span",null,"Not Checked In",-1),Gt=j({__name:"DataPanelCheckIn",props:Q({convention:{},showControls:{type:Boolean,default:!1}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(e){const c=te(e,"modelValue"),o=Ae(),i=Be(),r=Pa(i,e.convention),f=E([]),T=E(!1),u=E(!1),a=E(ge.CHECK_IN_STATUS_PENDING),s=E(""),d=I=>{T.value=!0,a.value=I},U=()=>{v()},v=()=>{o.getCheckInHistory(c.value.RegistrationUUID).then(I=>{I&&(f.value=I,u.value=!0,I.length&&(c.value.CheckIn=I[0]))}).catch(()=>{})},m=I=>{o.saveCheckIn(c.value.RegistrationUUID,a.value,s.value).then(k=>{k?(c.value.CheckIn=k,I&&(I("Check In Saved"),setTimeout(()=>{T.value=!1},500))):I&&I("Check In Failed")}).catch(()=>{I&&I("Check In Failed")})},p=ue(()=>{switch(a.value){case ge.CHECK_IN_STATUS_REVOKED:return"yellow-darken-4";case ge.CHECK_IN_STATUS_REJECTED:return"red-darken-4";case ge.CHECK_IN_STATUS_COMPLETED:return"green-darken-2"}return""});return(I,k)=>(n(),_(h,null,[I.showControls&&g(r)?(n(),S(me,{key:0,class:"px-0"},{default:l(()=>[t(X,null,{default:l(()=>[t(M,null,{default:l(()=>[t(q,{color:"error",class:"w-100","prepend-icon":"mdi:mdi-window-close",onClick:k[0]||(k[0]=D=>d(g(ge).CHECK_IN_STATUS_REJECTED))},{default:l(()=>[R(" Reject ")]),_:1})]),_:1}),t(M,null,{default:l(()=>[t(q,{color:"warning",class:"w-100","prepend-icon":"mdi:mdi-window-close",onClick:k[1]||(k[1]=D=>d(g(ge).CHECK_IN_STATUS_REVOKED))},{default:l(()=>[R(" Revoke ")]),_:1})]),_:1}),t(M,null,{default:l(()=>[t(q,{color:"success",class:"w-100","prepend-icon":"mdi:mdi-check",onClick:k[2]||(k[2]=D=>d(g(ge).CHECK_IN_STATUS_COMPLETED))},{default:l(()=>[R(" Approve ")]),_:1})]),_:1})]),_:1}),t(Fe,{modelValue:T.value,"onUpdate:modelValue":k[4]||(k[4]=D=>T.value=D),color:p.value,fullscreen:!1,"hide-extension":!0,persistent:!1,scrollable:!1,"show-close-action":!0,"show-save-action":!0,"save-button-label":"Confirm",title:`${g(ze)(a.value)} Check-In`,onSave:m},{default:l(()=>[t(ha,{modelValue:s.value,"onUpdate:modelValue":k[3]||(k[3]=D=>s.value=D),label:"Notes",variant:"outlined"},null,8,["modelValue"])]),_:1},8,["modelValue","color","title"])]),_:1})):N("",!0),c.value.CheckIn?(n(),S(me,{key:1,class:"px-0"},{default:l(()=>[t(X,null,{default:l(()=>[t(M,null,{default:l(()=>[kn,c.value.CheckIn.Status===g(ge).CHECK_IN_STATUS_COMPLETED?(n(),_("span",Nn,y(g(ze)(c.value.CheckIn.Status)),1)):c.value.CheckIn.Status===g(ge).CHECK_IN_STATUS_REVOKED?(n(),_("span",bn,y(g(ze)(c.value.CheckIn.Status)),1)):c.value.CheckIn.Status===g(ge).CHECK_IN_STATUS_REJECTED?(n(),_("span",Ln,y(g(ze)(c.value.CheckIn.Status)),1)):N("",!0),wn,t(q,{style:{"font-size":"0.75rem","text-transform":"none"},"append-icon":"mdi:mdi-chevron-down",size:"xs",variant:"text",onClick:U},{default:l(()=>[R("History")]),_:1})]),_:1}),t(M,{class:"text-right"},{default:l(()=>{var D;return[w("small",null,y((D=c.value.CheckIn.Admin)==null?void 0:D.DisplayName)+" "+y(g(At)(c.value.CheckIn.CreatedAt||"")),1)]}),_:1})]),_:1}),t(Fe,{modelValue:u.value,"onUpdate:modelValue":k[5]||(k[5]=D=>u.value=D),fullscreen:!1,"hide-extension":!0,persistent:!1,scrollable:!0,"show-close-action":!0,"show-save-action":!1,title:"Check-In History"},{default:l(()=>[t(we,null,{default:l(()=>[(n(!0),_(h,null,W(f.value,D=>(n(),S(be,{key:D.CheckInUUID},{default:l(()=>[t(Tt,null,{default:l(()=>[t(X,null,{default:l(()=>[t(M,null,{default:l(()=>[Fn,D.Status===g(ge).CHECK_IN_STATUS_COMPLETED?(n(),_("span",Pn,y(g(ze)(D.Status)),1)):D.Status===g(ge).CHECK_IN_STATUS_REVOKED?(n(),_("span",$n,y(g(ze)(D.Status)),1)):D.Status===g(ge).CHECK_IN_STATUS_REJECTED?(n(),_("span",Bn,y(g(ze)(D.Status)),1)):N("",!0)]),_:2},1024),t(M,{class:"text-right"},{default:l(()=>{var V;return[w("small",null,y((V=D.Admin)==null?void 0:V.DisplayName)+" "+y(g(At)(D.CreatedAt||"")),1)]}),_:2},1024)]),_:2},1024)]),_:2},1024),D.Details?(n(),S(Dl,{key:0},{default:l(()=>[R(y(D.Details),1)]),_:2},1024)):N("",!0)]),_:2},1024))),128))]),_:1})]),_:1},8,["modelValue"])]),_:1})):(n(),S(me,{key:2,class:"px-0"},{default:l(()=>[Yn]),_:1}))],64))}}),Gn=j({__name:"MetaDataItem",props:Q({accommodations:{},convention:{},forms:{},interests:{},itemClass:{},tickets:{},venues:{}},{modelValue:{required:!0},modelModifiers:{},registration:{required:!0},registrationModifiers:{}}),emits:Q(["openActions","showForm"],["update:modelValue","update:registration"]),setup(e,{emit:c}){const o=te(e,"modelValue"),i=te(e,"registration"),r=c,f=u=>{r("openActions",u)},T=(u,a,s)=>{r("showForm",u,a,s)};return(u,a)=>o.value.MetaField===g(G).META_DATA_SOURCE_ACCOMMODATION_ALLOCATION?(n(),S(Fa,{key:0,convention:u.convention,tickets:u.tickets,accommodations:u.accommodations,venues:u.venues,registration:i.value,forms:u.forms,modelValue:o.value,"onUpdate:modelValue":a[0]||(a[0]=s=>o.value=s),data:""},null,8,["convention","tickets","accommodations","venues","registration","forms","modelValue"])):o.value.MetaField===g(G).META_DATA_SOURCE_BADGE_DISPLAY?(n(),S(Qt,{key:1,"card-class":u.itemClass,convention:u.convention,registration:i.value,"show-title":!1},null,8,["card-class","convention","registration"])):o.value.MetaField===g(G).META_DATA_SOURCE_EMAILS?(n(),S(Ba,{key:2,"allow-sending":!1,expanded:!1,"show-title":!1,registration:i.value,"text-class":"pa-0 ma-0"},null,8,["registration"])):o.value.MetaField===g(G).META_DATA_SOURCE_NOTES?(n(),S(Ya,{key:3,"allow-adding":!0,"card-class":u.itemClass,convention:u.convention,expanded:!1,registration:i.value,"show-control-panel":!1,"show-title":!1,"text-class":"pa-0 ma-0"},null,8,["card-class","convention","registration"])):o.value.MetaField===g(G).META_DATA_SOURCE_PAYMENT_STATUS?(n(),S(Wo,{key:4,registration:i.value},null,8,["registration"])):o.value.MetaField===g(G).META_DATA_SOURCE_PAYMENTS?(n(),S(Ga,{key:5,registration:i.value,expanded:!1},null,8,["registration"])):o.value.MetaField===g(G).META_DATA_SOURCE_REGISTRATION_ACTIONS?(n(),S(q,{key:6,icon:"mdi:mdi-briefcase",variant:"flat",onClick:a[1]||(a[1]=s=>f(i.value))})):o.value.MetaField===g(G).META_DATA_SOURCE_SUBMISSION_STATUS||o.value.MetaField===g(G).META_DATA_SOURCE_ACCOMMODATION_FORM||o.value.MetaField===g(G).META_DATA_SOURCE_ADMIN_FORM||o.value.MetaField===g(G).META_DATA_SOURCE_DEALER_FORM||o.value.MetaField===g(G).META_DATA_SOURCE_BADGE_FORM||o.value.MetaField===g(G).META_DATA_SOURCE_REGISTRATION_FORM?(n(),S(Ho,{key:7,convention:u.convention,forms:u.forms,registration:i.value,onShowForm:T},null,8,["convention","forms","registration"])):o.value.MetaField===g(G).META_DATA_SOURCE_REGISTRATION_GROUP?(n(),S(Yo,{key:8,registration:i.value},null,8,["registration"])):o.value.MetaField===g(G).META_DATA_SOURCE_REGISTRATION_REFERENCE?(n(),_(h,{key:9},[R(y(i.value.Reference),1)],64)):o.value.MetaField===g(G).META_DATA_SOURCE_SUBMISSION_DATE?(n(),S(Go,{key:10,registration:i.value},null,8,["registration"])):o.value.MetaField===g(G).META_DATA_SOURCE_TAGS?(n(),S(Mn,{key:11,registration:i.value,modelValue:o.value,"onUpdate:modelValue":a[2]||(a[2]=s=>o.value=s)},null,8,["registration","modelValue"])):o.value.MetaField===g(G).META_DATA_SOURCE_CHECKIN_CONTROL?(n(),S(Gt,{key:12,convention:u.convention,"show-controls":!0,modelValue:i.value,"onUpdate:modelValue":a[3]||(a[3]=s=>i.value=s)},null,8,["convention","modelValue"])):o.value.MetaField===g(G).META_DATA_SOURCE_CHECKIN_STATUS?(n(),S(Gt,{key:13,convention:u.convention,"show-controls":!1,modelValue:i.value,"onUpdate:modelValue":a[4]||(a[4]=s=>i.value=s)},null,8,["convention","modelValue"])):(n(),_(h,{key:14},[R(" Unhandled Meta Item "+y(o.value),1)],64))}}),xn=j({__name:"UserDataItem",props:Q({accommodations:{},convention:{},forms:{},interests:{},itemClass:{},tickets:{},venues:{}},{modelValue:{required:!0},modelModifiers:{},registration:{required:!0},registrationModifiers:{}}),emits:["update:modelValue","update:registration"],setup(e){const c=te(e,"modelValue"),o=te(e,"registration"),i=St(),r=ue(()=>i.GetProfileImageURL(o.value.UserUUID));return(f,T)=>c.value.UserField===g(ie).USER_DATA_SOURCE_TELEGRAM&&o.value.User.Handle?(n(),_(h,{key:0},[R(" @"+y(o.value.User.Handle),1)],64)):c.value.UserField===g(ie).USER_DATA_SOURCE_AVATAR?(n(),S(jt,{key:1,class:"rounded-circle",src:r.value,height:"32",width:"32"},null,8,["src"])):c.value.UserField===g(ie).USER_DATA_SOURCE_DATE_OF_BIRTH?(n(),_(h,{key:2},[R(y(g(Oe)(o.value.User.Additional.DOB,{withYear:!0,withDay:!1})),1)],64)):c.value.UserField===g(ie).USER_DATA_SOURCE_EMAIL?(n(),_(h,{key:3},[R(y(o.value.User.Additional.Email),1)],64)):c.value.UserField===g(ie).USER_DATA_SOURCE_FIRST_NAME?(n(),_(h,{key:4},[R(y(o.value.User.Additional.FirstName),1)],64)):c.value.UserField===g(ie).USER_DATA_SOURCE_LAST_NAME?(n(),_(h,{key:5},[R(y(o.value.User.Additional.LastName),1)],64)):(n(),_(h,{key:6},[R(" Unhandled User Field "+y(c.value),1)],64))}}),va=j({__name:"PanelItem",props:Q({accommodations:{},convention:{},extras:{},forms:{},interests:{},itemClass:{},tickets:{},venues:{}},{modelValue:{required:!0},modelModifiers:{},registration:{required:!0},registrationModifiers:{}}),emits:Q(["openActions","showForm"],["update:modelValue","update:registration"]),setup(e,{emit:c}){const o=te(e,"modelValue"),i=te(e,"registration"),r=c,f=u=>{r("openActions",u)},T=(u,a,s)=>{r("showForm",u,a,s)};return(u,a)=>o.value.SourceType===g(Le).LAYOUT_ITEM_SOURCE_FORM?(n(),S(Fo,{key:0,accommodations:u.accommodations,convention:u.convention,extras:u.extras,forms:u.forms,interests:u.interests,"item-class":u.itemClass,tickets:u.tickets,venues:u.venues,modelValue:o.value,"onUpdate:modelValue":a[0]||(a[0]=s=>o.value=s),registration:i.value,"onUpdate:registration":a[1]||(a[1]=s=>i.value=s)},null,8,["accommodations","convention","extras","forms","interests","item-class","tickets","venues","modelValue","registration"])):o.value.SourceType===g(Le).LAYOUT_ITEM_SOURCE_META?(n(),S(Gn,{key:1,accommodations:u.accommodations,convention:u.convention,forms:u.forms,interests:u.interests,"item-class":u.itemClass,tickets:u.tickets,venues:u.venues,modelValue:o.value,"onUpdate:modelValue":a[2]||(a[2]=s=>o.value=s),registration:i.value,"onUpdate:registration":a[3]||(a[3]=s=>i.value=s),onOpenActions:f,onShowForm:T},null,8,["accommodations","convention","forms","interests","item-class","tickets","venues","modelValue","registration"])):o.value.SourceType===g(Le).LAYOUT_ITEM_SOURCE_USER?(n(),S(xn,{key:2,accommodations:u.accommodations,convention:u.convention,forms:u.forms,interests:u.interests,"item-class":u.itemClass,tickets:u.tickets,venues:u.venues,modelValue:o.value,"onUpdate:modelValue":a[4]||(a[4]=s=>o.value=s),registration:i.value,"onUpdate:registration":a[5]||(a[5]=s=>i.value=s)},null,8,["accommodations","convention","forms","interests","item-class","tickets","venues","modelValue","registration"])):N("",!0)}}),Hn=["onClick"],qn=["onClick"],Kn=j({__name:"PanelLayout",props:Q({accommodations:{},convention:{},extras:{},forms:{},interests:{},tickets:{},venues:{}},{layout:{required:!0},layoutModifiers:{},modelValue:{required:!0},modelModifiers:{}}),emits:Q(["openActions","showForm"],["update:layout","update:modelValue"]),setup(e,{emit:c}){const o=cl(),i=c,r=te(e,"layout"),f=te(e,"modelValue"),T=E({});r.value.Panels.forEach(U=>{T.value[U.LayoutPanelUUID]=!1});const u=U=>{i("openActions",U)},a=(U,v,m)=>{i("showForm",U,v,m)},s=U=>{switch(U.PanelStyle){case De.PANEL_STYLE_NAV_BOTTOM:return"bottom";case De.PANEL_STYLE_NAV_LEFT:return"left";case De.PANEL_STYLE_NAV_RIGHT:return"right";case De.PANEL_STYLE_NAV_TOP:return"top"}},d=(U,v=!1)=>{switch(U.PanelStyle){case De.PANEL_STYLE_NAV_BOTTOM:return v?"mdi:mdi-chevron-double-down":"mdi:mdi-chevron-double-up";case De.PANEL_STYLE_NAV_LEFT:return v?"mdi:mdi-chevron-double-left":"mdi:mdi-chevron-double-right";case De.PANEL_STYLE_NAV_RIGHT:return v?"mdi:mdi-chevron-double-right":"mdi:mdi-chevron-double-left";case De.PANEL_STYLE_NAV_TOP:return v?"mdi:mdi-chevron-double-up":"mdi:mdi-chevron-double-down"}};return(U,v)=>(n(),_(h,null,[(n(!0),_(h,null,W(r.value.Panels,m=>(n(),_(h,{key:m.LayoutPanelUUID},[s(m)!==void 0?(n(),S(xl,{key:0,permanent:!0,location:s(m),border:g(o).smAndDown.value?1:0,rail:g(o).smAndDown.value&&!T.value[m.LayoutPanelUUID],"rail-width":"30",width:g(o).smAndDown.value?"100%":256},{default:l(()=>[g(o).smAndDown.value&&!T.value[m.LayoutPanelUUID]?(n(),_("h3",{key:0,class:Je(`bg-secondary fill-height ${s(m)==="top"||s(m)==="bottom"?"px-3 text-right":"py-3 text-left"}`),style:{cursor:"pointer"},onClick:p=>T.value[m.LayoutPanelUUID]=!0},[t(Me,{icon:d(m,!1)},null,8,["icon"])],10,Hn)):(n(),_(h,{key:1},[w("h3",{class:"bg-secondary pa-3 d-flex",style:la(g(o).smAndDown.value?"cursor: pointer;":""),onClick:p=>T.value[m.LayoutPanelUUID]=!1},[R(y(m.Name)+" ",1),g(o).smAndDown.value?(n(),_(h,{key:0},[t(Pe),t(q,{icon:d(m,!0),variant:"plain",size:"sm"},null,8,["icon"])],64)):N("",!0)],12,qn),t(we,{class:"bg-panel",style:{height:"calc(100vh - 116px)"}},{default:l(()=>[(n(!0),_(h,null,W(m.Items,(p,I)=>(n(),S(be,{key:p.LayoutItemUUID},{default:l(()=>[m.Items.length>1?(n(),S(Tt,{key:0,class:"font-weight-bold"},{default:l(()=>[R(y(p.Label),1)]),_:2},1024)):N("",!0),t(va,{accommodations:U.accommodations,convention:U.convention,extras:U.extras,forms:U.forms,interests:U.interests,"item-class":"bg-panel border-0",tickets:U.tickets,venues:U.venues,modelValue:m.Items[I],"onUpdate:modelValue":k=>m.Items[I]=k,registration:f.value,onOpenActions:u,onShowForm:a},null,8,["accommodations","convention","extras","forms","interests","tickets","venues","modelValue","onUpdate:modelValue","registration"])]),_:2},1024))),128))]),_:2},1024)],64))]),_:2},1032,["location","border","rail","width"])):N("",!0)],64))),128)),t(Hl,{class:"py-0"},{default:l(()=>[t(me,null,{default:l(()=>[t(X,null,{default:l(()=>[(n(!0),_(h,null,W(r.value.Panels,m=>{var p,I,k,D,V,A;return n(),_(h,{key:m.LayoutPanelUUID},[m.PanelStyle===g(De).PANEL_STYLE_FLEX?(n(),S(M,{key:0,cols:((p=m.Meta.cols)==null?void 0:p.toString())||!1,xs:((I=m.Meta.cols_xs)==null?void 0:I.toString())||!1,sm:((k=m.Meta.cols_sm)==null?void 0:k.toString())||!1,md:((D=m.Meta.cols_md)==null?void 0:D.toString())||!1,lg:((V=m.Meta.cols_lg)==null?void 0:V.toString())||!1,xl:((A=m.Meta.cols_xl)==null?void 0:A.toString())||!1,class:"pa-0 pa-sm-2"},{default:l(()=>[t(me,{class:"bg-panel",style:la(g(o).smAndUp.value?"border-radius: 15px;":"")},{default:l(()=>[w("h3",null,y(m.Name),1),t(we,{class:"bg-panel"},{default:l(()=>[(n(!0),_(h,null,W(m.Items,(P,se)=>(n(),S(be,{key:P.LayoutItemUUID,class:"px-0"},{default:l(()=>[m.Items.length>1?(n(),S(Tt,{key:0,class:"font-weight-bold"},{default:l(()=>[R(y(P.Label),1)]),_:2},1024)):N("",!0),t(va,{accommodations:U.accommodations,convention:U.convention,extras:U.extras,forms:U.forms,interests:U.interests,"item-class":"bg-panel border-0",tickets:U.tickets,venues:U.venues,modelValue:m.Items[se],"onUpdate:modelValue":z=>m.Items[se]=z,registration:f.value,"onUpdate:registration":v[0]||(v[0]=z=>f.value=z),onOpenActions:u,onShowForm:a},null,8,["accommodations","convention","extras","forms","interests","tickets","venues","modelValue","onUpdate:modelValue","registration"])]),_:2},1024))),128))]),_:2},1024)]),_:2},1032,["style"])]),_:2},1032,["cols","xs","sm","md","lg","xl"])):N("",!0)],64)}),128))]),_:1})]),_:1})]),_:1})],64))}}),jn=j({__name:"DataTableItemPanel",props:Q({accommodations:{},cardClass:{},convention:{},extras:{},forms:{},interests:{},tickets:{},venues:{},layouts:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:Q(["openActions","showForm"],["update:modelValue"]),setup(e,{emit:c}){const o=E(),i=E(!1),r=s=>{o.value=s,i.value=!0},f=c,T=te(e,"modelValue"),u=s=>{f("openActions",s)},a=(s,d,U)=>{f("showForm",s,d,U)};return(s,d)=>(n(),_("div",null,[s.layouts?(n(),S(we,{key:0},{default:l(()=>[(n(!0),_(h,null,W(s.layouts,U=>(n(),S(be,{key:U.AdminLayoutUUID,class:"d-block pa-0 ma-0"},{default:l(()=>[t(Tt,{style:{"text-overflow":"inherit"},class:"overflow-visible text-wrap"},{default:l(()=>[t(q,{"prepend-icon":"mdi:mdi-page-layout-body",variant:"flat",onClick:v=>r(U)},{default:l(()=>[R(y(U.Name),1)]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024))),128))]),_:1})):N("",!0),i.value&&o.value?(n(),S(Fe,{key:1,modelValue:i.value,"onUpdate:modelValue":d[2]||(d[2]=U=>i.value=U),"hide-extension":!0,fullscreen:!0,title:`#${T.value.Reference} ${T.value.User.DisplayName} - ${o.value.Name} `,scrollable:!0,"card-class":"pa-0","card-style":"margin-bottom: -52px"},{default:l(()=>[t(Kn,{accommodations:s.accommodations,convention:s.convention,extras:s.extras,forms:s.forms,interests:s.interests,tickets:s.tickets,venues:s.venues,layout:o.value,"onUpdate:layout":d[0]||(d[0]=U=>o.value=U),modelValue:T.value,"onUpdate:modelValue":d[1]||(d[1]=U=>T.value=U),onOpenActions:u,onShowForm:a},null,8,["accommodations","convention","extras","forms","interests","tickets","venues","layout","modelValue"])]),_:1},8,["modelValue","title"])):N("",!0)]))}}),zn={class:"text-grey-lighten-1"},Qn={key:0,class:"text-blue text-center"},Jn={key:1,class:"text-red text-center"},Xn={key:2,class:"text-orange text-center"},Wn={key:3,class:"text-orange text-center"},Zn={key:4,class:"text-orange text-center"},ei={key:5,class:"text-orange text-center"},ti={key:6,class:"text-green text-center"},ai={key:0},li={key:0},oi=w("strong",null,"Total:",-1),ni=j({__name:"RegListRow",props:Q({header:{},accommodations:{},convention:{},extras:{},forms:{},interests:{},item:{},tickets:{},user:{},venues:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:Q(["openActions","openPayments","openTags","reload","showForm","switchUser"],["update:modelValue"]),setup(e,{emit:c}){const o=c,i=te(e,"modelValue"),r=(a,s,d)=>{o("showForm",{registration:a,form:s,submission:d})},f=a=>{o("openActions",a)},T=a=>{o("switchUser",a)},u=a=>{const s=i.value.registration;return{ID:0,SubmissionUUID:ye(),FormID:a.ID,FormUUID:a.FormUUID,Form:a,UserID:s.UserID,UserUUID:s.UserUUID,RegistrationID:s.ID,RegistrationUUID:s.RegistrationUUID,Registration:s,Data:[],Status:Sa.SUBMISSION_STATUS_NULL}};return(a,s)=>a.header.type==="ACCOMMODATION"&&a.accommodations.length>0&&a.item.raw[a.header.key]?(n(),S(Na,{key:0,value:a.item.raw[a.header.key].Data,accommodations:a.accommodations,convention:a.convention,forms:a.forms,tickets:a.tickets,venues:a.venues,registration:a.item.raw[a.header.key].Registration},null,8,["value","accommodations","convention","forms","tickets","venues","registration"])):a.header.type==="EXTRAS"&&a.extras.length>0?(n(),S(ba,{key:1,value:a.item.raw[a.header.key],extras:a.extras},null,8,["value","extras"])):a.header.type==="INTERESTS"&&a.interests.length>0?(n(),S(La,{key:2,value:a.item.raw[a.header.key],interests:a.interests},null,8,["value","interests"])):a.header.type==="TICKET"&&a.tickets.length>0?(n(),S(wa,{key:3,value:a.item.raw[a.header.key],tickets:a.tickets},null,8,["value","tickets"])):a.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_CHECKIN_STATUS"?(n(),S(Gt,{key:4,convention:a.convention,"show-controls":!1,modelValue:a.item.raw.registration,"onUpdate:modelValue":s[0]||(s[0]=d=>a.item.raw.registration=d)},null,8,["convention","modelValue"])):a.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_SUBMISSION_STATUS"||a.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_ACCOMMODATION_FORM"||a.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_ADMIN_FORM"||a.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_DEALER_FORM"||a.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_BADGE_FORM"||a.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_REGISTRATION_FORM"?(n(),_(h,{key:5},[w("ul",null,[(n(!0),_(h,null,W(a.forms.filter(d=>d.Type===g(_e).FORM_TYPE_ADMIN&&a.item.raw[a.header.key].findIndex(U=>U.Form.ID===d.ID)<0),d=>(n(),_("li",{key:d.Heading},[w("strong",zn,y(d.Heading),1),t(q,{class:"text-grey-lighten-1",icon:"mdi:mdi-form-select",title:"Edit Submitted Data",variant:"flat",onClick:U=>r(a.item.raw.registration,d,u(d))},null,8,["onClick"])]))),128))]),w("ul",null,[(n(!0),_(h,null,W(a.item.raw[a.header.key],d=>(n(),_("li",{key:d.Heading},[w("strong",null,[R(y(d.Heading),1),d.Form.Type!==g(_e).FORM_TYPE_ADMIN?(n(),_(h,{key:0},[R(": ")],64)):N("",!0)]),d.Form.Type!==g(_e).FORM_TYPE_ADMIN?(n(),_("span",{key:0,class:Je(g(pa)(d.Submission.Status))},y(g(qt)(d.Submission.Status)),3)):N("",!0),t(q,{icon:"mdi:mdi-form-select",title:"Edit Submitted Data",variant:"flat",onClick:U=>r(d.Registration,d.Form,d.Submission)},null,8,["onClick"])]))),128))])],64)):a.header.type==="LAYOUT_ITEM_SOURCE_USER.USER_DATA_SOURCE_AVATAR"?(n(),S(jt,{key:6,class:"rounded-circle",src:a.item.raw[a.header.key],height:"32",width:"32"},null,8,["src"])):a.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_PAYMENT_STATUS"?(n(),_(h,{key:7},[a.item.raw[a.header.key]=="NOT_REQUIRED"?(n(),_("div",Qn,"No Payment Requested")):a.item.raw[a.header.key]=="MISSING_REQUIRED"?(n(),_("div",Jn,"Partner Payment Not Requested")):a.item.raw[a.header.key]=="AWAITING_PARTNER"?(n(),_("div",Xn,"Awaiting Partner Payment")):a.item.raw[a.header.key]=="ALL_REQUIRED"?(n(),_("div",Wn,"Awaiting Payments")):a.item.raw[a.header.key]=="REQUIRED"?(n(),_("div",Zn,"Awaiting Payment")):a.item.raw[a.header.key]=="ADDITIONAL_REQUIRED"?(n(),_("div",ei,"Awaiting Additional Payments")):(n(),_("div",ti,"Completed"))],64)):a.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_REGISTRATION_ACTIONS"?(n(),_(h,{key:8},[t(q,{icon:"mdi:mdi-briefcase",variant:"flat",onClick:s[1]||(s[1]=d=>f(a.item.raw[a.header.key]))}),g(lo)(a.user)?(n(),S(q,{key:0,icon:"mdi:mdi-account-switch-outline",variant:"flat",onClick:s[2]||(s[2]=d=>T(a.item.raw[a.header.key]))})):N("",!0)],64)):a.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_REGISTRATION_GROUP"?(n(),_(h,{key:9},[a.item.raw[a.header.key].length===1?(n(),_("em",ai," Not in a group ")):(n(),_(h,{key:1},[w("ul",null,[(n(!0),_(h,null,W(a.item.raw[a.header.key],d=>(n(),_("li",{key:d.UUID,class:"ml-0"},[R(" #"+y(d.Reference)+" : "+y(d.Name)+" ",1),d.IsLeader?(n(),_("strong",li,"(Leader)")):N("",!0)]))),128))]),oi,R(" "+y(a.item.raw[a.header.key].length),1)],64))],64)):a.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_DATA_LAYOUT"?(n(),_(h,{key:10},[i.value.registration?(n(),S(jn,{key:0,accommodations:a.accommodations,convention:a.convention,extras:a.extras,forms:a.forms,interests:a.interests,tickets:a.tickets,venues:a.venues,layouts:a.item.raw[a.header.key].Layouts,modelValue:i.value.registration,"onUpdate:modelValue":s[3]||(s[3]=d=>i.value.registration=d),onOpenActions:f,onShowForm:r},null,8,["accommodations","convention","extras","forms","interests","tickets","venues","layouts","modelValue"])):N("",!0)],64)):(n(),_(h,{key:11},[R(y(a.item.raw[a.header.key]),1)],64))}}),fa=j({__name:"RegistrationActionTabs",props:Q({alignTabs:{},class:{},fixedTabs:{type:Boolean},showArrows:{type:[String,Boolean]},tabs:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(e){const c=e,o=te(e,"modelValue");return(i,r)=>(n(),S(Ia,ft({modelValue:o.value,"onUpdate:modelValue":r[0]||(r[0]=f=>o.value=f)},c),{default:l(()=>[(n(!0),_(h,null,W(i.tabs,f=>(n(),S(Ca,{value:f.value,key:f.value},{default:l(()=>[R(y(f.label),1)]),_:2},1032,["value"]))),128))]),_:1},16,["modelValue"]))}}),ii=(e=void 0,c)=>e===void 0?!1:pt(e,gt.GROUP_TYPE_CONVENTION,c.ConventionUUID,c).EditPaymentTransactions,Rt=e=>(xt("data-v-861debd5"),e=e(),Ht(),e),si={class:"mb-4"},ui={class:"v-row"},ri={key:0,class:"v-col v-col-10 py-1 v-row mx-0 pl-0"},di={class:"v-col v-col-12 v-col-sm-4 v-col-md-3 font-weight-bold pb-0 pr-0"},mi={class:"v-col v-col-12 v-col-sm-8 v-col-md-9 font-italic pt-0 pt-sm-3 pb-sm-0 pl-sm-0"},ci={class:"v-col v-col-2 align-self-end text-right py-1 text-no-wrap"},vi=Rt(()=>w("dt",{class:"v-col v-col-9 py-1 font-weight-bold totals"}," Total Charges ",-1)),fi={class:"v-col v-col-3 align-self-end text-right py-1 totals text-no-wrap"},Ui=Rt(()=>w("dt",{class:"v-col v-col-9 py-1 font-weight-bold"}," Applied Total ",-1)),Ai={class:"v-col v-col-3 align-self-end text-right py-1 text-no-wrap"},Ti=Rt(()=>w("dt",{class:"v-col v-col-9 py-1 font-weight-bold"}," Currently Paid ",-1)),_i={class:"v-col v-col-3 align-self-end text-right py-1 text-no-wrap"},Ei=Rt(()=>w("dt",{class:"v-col v-col-9 py-1 font-weight-bold totals"}," Balance ",-1)),gi={class:"v-col v-col-3 align-self-end text-right py-1 totals text-no-wrap"},pi=j({__name:"PaymentActions",props:Q({forms:{},title:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(e){const c=E(!1),o=E(),i=E([]),r=E(new Date().getTime()),f=E(!1),T=te(e,"modelValue"),u=E(Ee(T.value));fe(T,()=>{u.value=Ee(T.value)});const a=Ae();a.getConvention(T.value.ConventionUUID).then(v=>{v&&(f.value=ii(Be(),v))});const s=()=>{a.generateRegistrationCharges(T.value.RegistrationUUID,!1).then(v=>{v&&(i.value=v.PaymentTransactions,o.value=v.Registration,r.value=new Date().getTime())}).catch(()=>{})};s();const d=()=>{a.generateRegistrationCharges(T.value.RegistrationUUID,!0).then(v=>{v&&(i.value=v.PaymentTransactions,o.value=v.Registration,r.value=new Date().getTime())})},{totalCharges:U}=Ea();return(v,m)=>(n(),S($e,null,{default:l(()=>[t(ot,null,{default:l(()=>[t(We,null,{default:l(()=>[R(" Payments (#"+y(T.value.Reference)+" "+y(T.value.User.DisplayName)+") ",1)]),_:1})]),_:1}),t(Ze,null,{default:l(()=>[o.value?(n(),_(h,{key:0},[w("h3",si,"#"+y(o.value.Reference)+" "+y(o.value.User.DisplayName),1),w("dl",ui,[(n(!0),_(h,null,W(i.value,p=>(n(),_(h,{key:p.PaymentTransactionUUID},[p.Type===g(Pt).PAYMENT_TRANSACTION_TYPE_CHARGE?(n(),_("dt",ri,[w("div",di,y(p.Description.split(":")[0])+": ",1),w("div",mi,y(p.Description.split(":")[1]),1)])):N("",!0),w("dd",ci," £"+y(p.Amount),1)],64))),128)),vi,w("dd",fi," £"+y(g(U)(i.value)),1),Ui,w("dd",Ai," £"+y(o.value.Total),1),Ti,w("dd",_i," £"+y(o.value.Paid),1),Ei,w("dd",gi," £"+y(o.value.Total-o.value.Paid),1)]),t(X,{class:"flex-row-reverse"},{default:l(()=>[t(M,{class:"text-right"},{default:l(()=>[t(q,{color:"primary",onClick:d},{default:l(()=>[R("Apply Charges")]),_:1})]),_:1}),!c.value&&f.value?(n(),S(M,{key:0},{default:l(()=>[t(q,{color:"secondary",onClick:m[0]||(m[0]=p=>c.value=!0)},{default:l(()=>[R("Transaction Entry")]),_:1})]),_:1})):N("",!0)]),_:1})],64)):N("",!0),t(Ga,{"can-edit":f.value,registration:T.value,"show-editor":c.value,onCloseEditor:m[1]||(m[1]=p=>c.value=!1),updated:r.value,onChange:s},null,8,["can-edit","registration","show-editor","updated"])]),_:1})]),_:1}))}}),Si=dt(pi,[["__scopeId","data-v-861debd5"]]),Di=j({__name:"RegistrationFormStatus",props:Q({forms:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(e){const c=Ae(),o=te(e,"modelValue"),i=(r,f)=>{const T=o.value.Submissions.find(u=>u.SubmissionUUID==f);if(!T){r&&r("Submission not found");return}c.setSubmissionStatus(f,T.Status).then(u=>{u?(o.value.Submissions.forEach((a,s)=>{o.value.Submissions[s].Status=a.Status}),r&&r("Status Saved")):r&&r("Status not saved")}).catch(()=>{r&&r("Status not saved")})};return(r,f)=>(n(),S($e,null,{default:l(()=>[t(ot,null,{default:l(()=>[t(We,null,{default:l(()=>[R("Status (#"+y(o.value.Reference)+" "+y(o.value.User.DisplayName)+")",1)]),_:1})]),_:1}),t(Ze,null,{default:l(()=>[t(we,null,{default:l(()=>[(n(!0),_(h,null,W(o.value.Submissions,T=>(n(),S(be,{key:T.SubmissionUUID,class:"pa-0"},{default:l(()=>[t(X,{class:"py-2 align-center"},{default:l(()=>[t(M,{cols:"9",sm:"10",md:"10",lg:"9"},{default:l(()=>{var u;return[t(ve,{modelValue:T.Status,"onUpdate:modelValue":a=>T.Status=a,items:g(na),"item-text":"title","item-value":"value",variant:"outlined","hide-details":"",label:((u=r.forms.find(a=>a.FormUUID==T.FormUUID))==null?void 0:u.Name)||""},{selection:l(()=>[t(Me,{class:"mr-4 d-none d-sm-inline"},{default:l(()=>{var a;return[R(y((a=g(na).find(s=>s.value===T.Status))==null?void 0:a.icon),1)]}),_:2},1024),R(" "+y(g(qt)(T.Status)),1)]),item:l(({item:a,props:{onClick:s}})=>[t(be,{title:a.title,"prepend-icon":a.raw.icon,onClick:s},null,8,["title","prepend-icon","onClick"])]),_:2},1032,["modelValue","onUpdate:modelValue","items","label"])]}),_:2},1024),t(M,{cols:"3",sm:"2",md:"2",lg:"1"},{default:l(()=>[t(rt,{class:"d-none d-sm-inline-flex",title:"Save","prepend-icon":"mdi:mdi-content-save",color:"warning",onClick:u=>i(u.callback,T.SubmissionUUID)},null,8,["onClick"]),t(rt,{class:"d-sm-none",size:"35",icon:"mdi:mdi-content-save",color:"warning",onClick:u=>i(u.callback,T.SubmissionUUID)},null,8,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1}))}}),yi=e=>(xt("data-v-a4024c39"),e=e(),Ht(),e),Ii=yi(()=>w("p",null,"Any tags controlled through registration form fields will be reset when the applicable form is saved. If you don't know what you're doing here, don't touch!",-1)),Ci={class:"mb-4"},Ri=j({__name:"RegistrationTags",props:Q({title:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(e){const c=Ae(),o=te(e,"modelValue"),i=E(Ee(o.value)),r=E(!1),f=E(i.value.Tags);fe(o,()=>{i.value=Ee(o.value)});const T=({callback:u})=>{const a=[],s=[];i.value.Tags.forEach(d=>{f.value.find(v=>v.TagUUID===d.TagUUID)||a.push(d.TagUUID)}),f.value.forEach(d=>{i.value.Tags.find(v=>d.TagUUID===v.TagUUID)||s.push(d.TagUUID)}),c.updateRegistrationTags(a,s,i.value.RegistrationUUID).then(d=>{d?u&&(u("Tags Saved"),o.value.Tags=d.Tags):u&&u("Error Saving Tags")}).catch(()=>{u&&u("Error Saving Tags")})};return(u,a)=>(n(),S($e,null,{default:l(()=>[t(ot,null,{default:l(()=>[t(We,null,{default:l(()=>[R("Tags (#"+y(i.value.Reference)+" "+y(i.value.User.DisplayName)+")",1)]),_:1})]),_:1}),t(Ze,null,{default:l(()=>[t(Kl,{class:"my-4"},{default:l(()=>[t(jl,null,{default:l(()=>[R("Caution")]),_:1}),Ii]),_:1}),w("h3",Ci,"#"+y(i.value.Reference)+" "+y(i.value.User.DisplayName),1),t(Ra,{modelValue:i.value.Tags,"onUpdate:modelValue":a[0]||(a[0]=s=>i.value.Tags=s),convention:i.value.ConventionUUID,"show-key":!0,chips:!0,"show-uuid":r.value},null,8,["modelValue","convention","show-uuid"])]),_:1}),t(Kt,{class:"px-4 align-start"},{default:l(()=>[t(Ft,{label:"Show UUID",modelValue:r.value,"onUpdate:modelValue":a[1]||(a[1]=s=>r.value=s)},null,8,["modelValue"]),t(rt,{onClick:T,variant:"flat"})]),_:1})]),_:1}))}}),Vi=dt(Ri,[["__scopeId","data-v-a4024c39"]]),Ua=j({__name:"RegistrationActionWindows",props:Q({accommodations:{},convention:{},extras:{},forms:{},interests:{},registration:{},tickets:{},venues:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:Q(["update:registration"],["update:modelValue"]),setup(e,{emit:c}){const o=e,i=te(e,"modelValue"),f=mt(o,c,void 0,void 0,"registration");return(T,u)=>(n(),S(Va,{modelValue:i.value,"onUpdate:modelValue":u[3]||(u[3]=a=>i.value=a)},{default:l(()=>[t(Qe,{value:"badges"},{default:l(()=>[i.value=="badges"?(n(),S(me,{key:0,class:"pa-0 mx-0",fluid:!0},{default:l(()=>[t(Qt,{convention:T.convention,registration:g(f)},null,8,["convention","registration"])]),_:1})):N("",!0)]),_:1}),t(Qe,{value:"emails"},{default:l(()=>[i.value=="emails"?(n(),S(me,{key:0,class:"pa-0 mx-0",fluid:!0},{default:l(()=>[t(Ba,{registration:g(f)},null,8,["registration"])]),_:1})):N("",!0)]),_:1}),t(Qe,{value:"notes"},{default:l(()=>[i.value=="notes"?(n(),S(me,{key:0,class:"pa-0 mx-0",fluid:!0},{default:l(()=>[t(Ya,{convention:T.convention,expanded:!1,registration:g(f)},null,8,["convention","registration"])]),_:1})):N("",!0)]),_:1}),t(Qe,{value:"payments"},{default:l(()=>[i.value=="payments"?(n(),S(me,{key:0,class:"pa-0 mx-0",fluid:!0},{default:l(()=>[t(Si,{modelValue:g(f),"onUpdate:modelValue":u[0]||(u[0]=a=>ut(f)?f.value=a:null),forms:T.forms,title:"Registration Payments"},null,8,["modelValue","forms"])]),_:1})):N("",!0)]),_:1}),t(Qe,{value:"status"},{default:l(()=>[i.value=="status"?(n(),S(me,{key:0,class:"pa-0 mx-0",fluid:!0},{default:l(()=>[t(Di,{modelValue:g(f),"onUpdate:modelValue":u[1]||(u[1]=a=>ut(f)?f.value=a:null),forms:T.forms},null,8,["modelValue","forms"])]),_:1})):N("",!0)]),_:1}),t(Qe,{value:"tags"},{default:l(()=>[i.value=="tags"?(n(),S(me,{key:0,class:"pa-0 mx-0",fluid:!0},{default:l(()=>[t(Vi,{modelValue:g(f),"onUpdate:modelValue":u[2]||(u[2]=a=>ut(f)?f.value=a:null),title:"Registration Tags"},null,8,["modelValue"])]),_:1})):N("",!0)]),_:1})]),_:1},8,["modelValue"]))}}),Oi=(e,c)=>e===void 0?!1:pt(e,gt.GROUP_TYPE_CONVENTION,c.ConventionUUID,c).ViewPaymentTransactions,Mi={key:0},hi={key:1},Aa=j({__name:"RegistrationActions",props:Q({accommodations:{},convention:{},extras:{},forms:{},interests:{},registration:{},tickets:{},title:{},useDialog:{type:Boolean},venues:{}},{modelValue:{type:Boolean,required:!0},modelModifiers:{}}),emits:Q(["update:registration"],["update:modelValue"]),setup(e,{emit:c}){const o=e,i=te(e,"modelValue"),f=mt(o,c,void 0,void 0,"registration"),T=E("notes"),u=Be(),a=[{label:"Badge",value:"badges"},{label:"Emails",value:"emails"},{label:"Notes",value:"notes"},{label:"Status",value:"status"},{label:"Tags",value:"tags"}];return Oi(u,o.convention)&&a.splice(2,0,{label:"Payments",value:"payments"}),(s,d)=>s.useDialog?(n(),_("div",Mi,[t(Fe,{modelValue:i.value,"onUpdate:modelValue":d[3]||(d[3]=U=>i.value=U),title:s.title,"show-close-action":!0,color:"primary","close-action-label":"Close",persistent:!0,"retain-focus":!1,scrollable:!0,fullscreen:"","card-class":"ma-0 pa-0"},{extension:l(()=>[t(fa,{modelValue:T.value,"onUpdate:modelValue":d[0]||(d[0]=U=>T.value=U),tabs:a,"show-arrows":!0},null,8,["modelValue"])]),default:l(()=>[t(Ua,{modelValue:T.value,"onUpdate:modelValue":d[1]||(d[1]=U=>T.value=U),registration:g(f),"onUpdate:registration":d[2]||(d[2]=U=>ut(f)?f.value=U:null),accommodations:s.accommodations,convention:s.convention,extras:s.extras,forms:s.forms,interests:s.interests,tabs:a,tickets:s.tickets,venues:s.venues},null,8,["modelValue","registration","accommodations","convention","extras","forms","interests","tickets","venues"])]),_:1},8,["modelValue","title"])])):(n(),_("div",hi,[t(fa,{modelValue:T.value,"onUpdate:modelValue":d[4]||(d[4]=U=>T.value=U),tabs:a,"show-arrows":!0},null,8,["modelValue"]),t(Ua,{modelValue:T.value,"onUpdate:modelValue":d[5]||(d[5]=U=>T.value=U),registration:g(f),"onUpdate:registration":d[6]||(d[6]=U=>ut(f)?f.value=U:null),accommodations:s.accommodations,convention:s.convention,extras:s.extras,forms:s.forms,interests:s.interests,tabs:a,tickets:s.tickets,venues:s.venues},null,8,["modelValue","registration","accommodations","convention","extras","forms","interests","tickets","venues"])]))}}),ki=(e,c=500,o=!1)=>{let i;return(...r)=>{const T=function(){i=void 0,o||e.apply(void 0,r)},u=o&&!i;clearTimeout(i),i=setTimeout(T,c),u&&e.apply(void 0,r)}},xa=(e,c)=>{e.forEach(o=>{o.Items.forEach(i=>{(i.SectionField==null||i.SectionField.Field==null)&&c.find(r=>{r.Sections.find(f=>{if(f.Fields){const T=f.Fields.find(u=>u.SectionFieldUUID===i.SectionFieldUUID);if(T)return i.SectionField=T,!0}})})})})},Ni=w("h4",null,"Grid Size (Max 12)",-1),bi={key:0,class:"text-warning text-right pl-1"},Li=j({__name:"EditAdminLayout",props:Q({convention:{},layouts:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:Q(["change","delete"],["update:modelValue"]),setup(e,{emit:c}){const o=te(e,"modelValue"),i=E([]),r=Ae(),f=c,T=E(Object.assign({},...e.layouts.map(I=>I.Panels.map(k=>k.Items.map(D=>{if(!D.Meta)return{};const V={};return Object.entries(D.Meta).forEach(A=>{Array.isArray(A[1])?(V[`${D.LayoutItemUUID}.${A[0]}`]=[],A[1].forEach(P=>{V[`${D.LayoutItemUUID}.${A[0]}`].push(P.toString())})):A[1]!==void 0&&A[1]!==null&&(V[`${D.LayoutItemUUID}.${A[0]}`]=[A[1].toString()])}),V}))).flat(2))),u=E(`
Are you sure you wish to delete this layout? All panels relating to it will be
removed and can not be recovered. This action can not be undone once saved.
You will have to create a new layout.
`),a=E(!1),s=E([]);r.getConventionTags(e.convention.ConventionUUID).then(I=>{I&&(s.value=I)}).catch(()=>{});const d=()=>({ID:0,LayoutPanelUUID:ye(),AdminLayoutID:o.value.ID,AdminLayoutUUID:o.value.AdminLayoutUUID,Name:"",Order:o.value.Panels.length+1,Items:[],PanelStyle:De.PANEL_STYLE_FLEX,RequiredFormType:_e.FORM_TYPE_NIL,RequiredGroupMemberships:[],RequiredRegistrationTags:[],Meta:{}}),U=I=>()=>({ID:0,LayoutItemUUID:ye(),LayoutPanelID:I.ID,LayoutPanelUUID:I.LayoutPanelUUID,Label:"",SourceType:Le.LAYOUT_ITEM_SOURCE_FORM,SectionFieldID:void 0,SectionFieldUUID:void 0,SectionField:void 0,MetaField:void 0,UserField:void 0,Align:"",Order:I.Items.length+1,DefaultSort:!1,Meta:{}}),v=(I,k)=>{I.Meta[k]=T.value[`${I.LayoutItemUUID}.${k}`]},m=I=>{const k=i.value.find(D=>D.value===I.SectionFieldUUID);k&&(I.SectionFieldID=k.object.ID,I.SectionField=k.object)};r.getConventionForms(o.value.ConventionUUID).then(I=>{I&&(I.forEach(k=>k.Sections.forEach(D=>D.Fields&&i.value.push(...D.Fields.map(V=>{var P;return{title:`${k.Name} - ${D.Name} - ${(P=V.Field)==null?void 0:P.Name}`,value:V.SectionFieldUUID,object:V}})))),i.value.sort(Tl("title")),xa(o.value.Panels,I))});const p=ue(()=>{switch(o.value.Type){case Ne.ADMIN_LAYOUT_PANELS:return"Panels";case Ne.ADMIN_LAYOUT_TABLE:return"Tabs"}return"Unknown"});return fe(o,()=>{f("change")},{deep:!0}),(I,k)=>(n(),S(me,{class:"px-0 mx-0",fluid:!0},{default:l(()=>[t(X,null,{default:l(()=>[t(M,{cols:"12",sm:"6"},{default:l(()=>[t(oe,{modelValue:o.value.Name,"onUpdate:modelValue":k[0]||(k[0]=D=>o.value.Name=D),label:"Name",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),t(M,{cols:"12",sm:"6"},{default:l(()=>[t(ve,{modelValue:o.value.Type,"onUpdate:modelValue":k[1]||(k[1]=D=>o.value.Type=D),label:"Layout Type",items:g(Xl),"item-title":"title","item-value":"value",variant:"outlined","hide-details":""},null,8,["modelValue","items"])]),_:1})]),_:1}),t(X,null,{default:l(()=>[t(M,null,{default:l(()=>[t($t,{modelValue:o.value.Panels,"onUpdate:modelValue":k[2]||(k[2]=D=>o.value.Panels=D),"new-item":d,closeable:!1,title:p.value,label:"Name","slot-name-prefix":"panel"},Xe({_:2},[W(o.value.Panels,(D,V)=>({name:`panel_${V}`,fn:l(()=>[t(me,{class:"px-0 mx-0",fluid:!0},{default:l(()=>[t(X,null,{default:l(()=>[t(M,{cols:"12",sm:"6"},{default:l(()=>[t(oe,{modelValue:D.Name,"onUpdate:modelValue":A=>D.Name=A,label:"Name",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),o.value.Type===g(Ne).ADMIN_LAYOUT_PANELS?(n(),S(M,{key:0,cols:"12",sm:"6"},{default:l(()=>[t(ve,{modelValue:D.PanelStyle,"onUpdate:modelValue":A=>D.PanelStyle=A,items:g(eo),clearable:!0,label:"Panel Style",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"])]),_:2},1024)):N("",!0),t(M,{cols:"12",sm:"6"},{default:l(()=>[t(ve,{modelValue:D.RequiredFormType,"onUpdate:modelValue":A=>D.RequiredFormType=A,items:g(El),clearable:!0,label:"Required Form",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"])]),_:2},1024),t(M,{cols:"12",sm:"6"},{default:l(()=>[t(ya,{label:"Required Groups",variant:"outlined",modelValue:D.RequiredGroupMemberships,"onUpdate:modelValue":A=>D.RequiredGroupMemberships=A,convention:o.value.ConventionUUID,chips:"",clearable:"",hint:"Groups that a user must be in to see this panel. (Any one)"},null,8,["modelValue","onUpdate:modelValue","convention"])]),_:2},1024),t(M,{cols:"12",sm:"6"},{default:l(()=>[t(Ra,{label:"Registration Tags",variant:"outlined",modelValue:D.RequiredRegistrationTags,"onUpdate:modelValue":A=>D.RequiredRegistrationTags=A,convention:o.value.ConventionUUID,chips:"",clearable:"",hint:"Tags that a registration must have to appear in results. (Any one)"},null,8,["modelValue","onUpdate:modelValue","convention"])]),_:2},1024)]),_:2},1024),o.value.Type===g(Ne).ADMIN_LAYOUT_PANELS&&D.PanelStyle===g(De).PANEL_STYLE_FLEX?(n(),S(X,{key:0},{default:l(()=>[t(M,{cols:"12",class:"py-0 my-0"},{default:l(()=>[Ni]),_:1}),t(M,{cols:"6",sm:"4",lg:"2"},{default:l(()=>[t(oe,{modelValue:D.Meta.cols,"onUpdate:modelValue":A=>D.Meta.cols=A,modelModifiers:{number:!0},clearable:!0,"hide-details":"",label:"Default",type:"number",min:"1",max:"12"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),t(M,{cols:"6",sm:"4",lg:"2"},{default:l(()=>[t(oe,{modelValue:D.Meta.cols_xs,"onUpdate:modelValue":A=>D.Meta.cols_xs=A,modelModifiers:{number:!0},clearable:!0,"hide-details":"",label:"XS",type:"number",min:"1",max:"12"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),t(M,{cols:"6",sm:"4",lg:"2"},{default:l(()=>[t(oe,{modelValue:D.Meta.cols_sm,"onUpdate:modelValue":A=>D.Meta.cols_sm=A,modelModifiers:{number:!0},clearable:!0,"hide-details":"",label:"SM",type:"number",min:"1",max:"12"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),t(M,{cols:"6",sm:"4",lg:"2"},{default:l(()=>[t(oe,{modelValue:D.Meta.cols_md,"onUpdate:modelValue":A=>D.Meta.cols_md=A,modelModifiers:{number:!0},clearable:!0,"hide-details":"",label:"MD",type:"number",min:"1",max:"12"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),t(M,{cols:"6",sm:"4",lg:"2"},{default:l(()=>[t(oe,{modelValue:D.Meta.cols_lg,"onUpdate:modelValue":A=>D.Meta.cols_lg=A,modelModifiers:{number:!0},clearable:!0,"hide-details":"",label:"LG",type:"number",min:"1",max:"12"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),t(M,{cols:"6",sm:"4",lg:"2"},{default:l(()=>[t(oe,{modelValue:D.Meta.cols_xl,"onUpdate:modelValue":A=>D.Meta.cols_xl=A,modelModifiers:{number:!0},clearable:!0,"hide-details":"",label:"XL",type:"number",min:"1",max:"12"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)):N("",!0)]),_:2},1024),t($t,{modelValue:D.Items,"onUpdate:modelValue":A=>D.Items=A,"new-item":U(D),closeable:!1,title:"Items",label:"Label","slot-name-prefix":"item"},Xe({_:2},[W(D.Items,(A,P)=>({name:`item_${P}`,fn:l(()=>[t(me,{class:"px-0 mx-0",fluid:!0},{default:l(()=>{var se,z;return[t(X,null,{default:l(()=>[t(M,{cols:"12",sm:"6"},{default:l(()=>[t(oe,{modelValue:A.Label,"onUpdate:modelValue":x=>A.Label=x,label:"Name",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024),t(X,null,{default:l(()=>[t(M,{cols:"12",sm:"6"},{default:l(()=>[t(ve,{modelValue:A.SourceType,"onUpdate:modelValue":x=>A.SourceType=x,label:"Source Type",items:g(Wl),"item-title":"title","item-value":"value",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"])]),_:2},1024),t(M,{cols:"12",sm:"6"},{default:l(()=>[A.SourceType==="LAYOUT_ITEM_SOURCE_FORM"?(n(),S(ve,{key:0,modelValue:A.SectionFieldUUID,"onUpdate:modelValue":x=>A.SectionFieldUUID=x,label:"Form Data",items:i.value,"item-title":"title","item-value":"value",variant:"outlined","hide-details":"",onBlur:x=>m(A)},null,8,["modelValue","onUpdate:modelValue","items","onBlur"])):A.SourceType==="LAYOUT_ITEM_SOURCE_META"?(n(),S(ve,{key:1,modelValue:A.MetaField,"onUpdate:modelValue":x=>A.MetaField=x,label:"Miscellaneous Data",items:g(Zl),"item-title":"title","item-value":"value",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"])):A.SourceType==="LAYOUT_ITEM_SOURCE_USER"?(n(),S(ve,{key:2,modelValue:A.UserField,"onUpdate:modelValue":x=>A.UserField=x,label:"User Profile Data",items:g(to),"item-title":"title","item-value":"value",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"])):N("",!0)]),_:2},1024)]),_:2},1024),I.layouts&&A.SourceType==="LAYOUT_ITEM_SOURCE_FORM"&&((z=(se=A.SectionField)==null?void 0:se.Field)==null?void 0:z.Type)===g(_a).TEXT?(n(),S(X,{key:0},{default:l(()=>[t(M,{cols:"12",xs:"6",sm:"6",lg:"3"},{default:l(()=>[t(Ft,{modelValue:A.Meta.DirectEdit,"onUpdate:modelValue":x=>A.Meta.DirectEdit=x,label:"Direct Edit","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),t(M,{cols:"12",xs:"6",sm:"6",lg:"3"},{default:l(()=>[t(ve,{modelValue:A.Meta.DirectEditPermission,"onUpdate:modelValue":x=>A.Meta.DirectEditPermission=x,label:"Minimum Permission Required",items:["View","Edit"],"hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)):N("",!0),I.layouts&&A.SourceType==="LAYOUT_ITEM_SOURCE_META"&&A.MetaField===g(G).META_DATA_SOURCE_DATA_LAYOUT?(n(),S(X,{key:1},{default:l(()=>[t(M,{cols:"6",sm:"4",lg:"2"},{default:l(()=>[t(ve,{modelValue:T.value[`${A.LayoutItemUUID}.LayoutUUID`],"onUpdate:modelValue":[x=>T.value[`${A.LayoutItemUUID}.LayoutUUID`]=x,x=>v(A,"LayoutUUID")],clearable:!0,items:I.layouts.filter(x=>x.Type===g(Ne).ADMIN_LAYOUT_PANELS)||[],multiple:!0,label:"Data Display","item-title":"Name","item-value":"AdminLayoutUUID",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"])]),_:2},1024)]),_:2},1024)):N("",!0),I.layouts&&A.SourceType==="LAYOUT_ITEM_SOURCE_META"&&A.MetaField===g(G).META_DATA_SOURCE_TAGS?(n(),S(X,{key:2},{default:l(()=>[t(M,{cols:"6",sm:"4",lg:"2"},{default:l(()=>[t(ve,{modelValue:T.value[`${A.LayoutItemUUID}.Tags`],"onUpdate:modelValue":[x=>T.value[`${A.LayoutItemUUID}.Tags`]=x,x=>v(A,"Tags")],clearable:!0,items:s.value||[],multiple:!0,label:"Tags to Display","item-title":"Title","item-value":"TagUUID",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"]),!T.value[A.LayoutItemUUID]||T.value[A.LayoutItemUUID].length===0?(n(),_("small",bi," Will show all tags ")):N("",!0)]),_:2},1024)]),_:2},1024)):N("",!0),o.value.Type===g(Ne).ADMIN_LAYOUT_TABLE&&(A.SourceType!==g(Le).LAYOUT_ITEM_SOURCE_META||A.MetaField!==g(G).META_DATA_SOURCE_DATA_LAYOUT)?(n(),S(X,{key:3},{default:l(()=>[t(M,null,{default:l(()=>[t(Ft,{modelValue:A.DefaultSort,"onUpdate:modelValue":x=>A.DefaultSort=x,label:"Default Sort","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)):N("",!0)]}),_:2},1024)])}))]),1032,["modelValue","onUpdate:modelValue","new-item"])])}))]),1032,["modelValue","title"])]),_:1})]),_:1}),t(X,null,{default:l(()=>[t(M,null,{default:l(()=>[t(q,{onClick:k[3]||(k[3]=D=>a.value=!0),"prepend-icon":"mdi:mdi-delete",color:"red-darken-4"},{default:l(()=>[R("Delete Layout")]),_:1})]),_:1})]),_:1}),a.value?(n(),S(Oa,{key:0,modelValue:a.value,"onUpdate:modelValue":k[4]||(k[4]=D=>a.value=D),message:u.value,title:"Delete Layout",subtitle:"Removes this layout and all it's panels",onDelete:k[5]||(k[5]=D=>f("delete"))},null,8,["modelValue","message"])):N("",!0)]),_:1}))}}),wi=j({__name:"EditAdminLayouts",props:Q({title:{},convention:{}},{modelValue:{type:Boolean,required:!0},modelModifiers:{}}),emits:Q(["save"],["update:modelValue"]),setup(e,{emit:c}){const o=te(e,"modelValue"),i=c,r=E([]),f=E([]),T=E([]),u=Ae(),a=()=>({ID:0,AdminLayoutUUID:ye(),ConventionID:e.convention.ID,ConventionUUID:e.convention.ConventionUUID,Name:"New Layout",Type:Ne.ADMIN_LAYOUT_PANELS,Panels:[]}),s=()=>{let U=!1;[...new Set(T.value)].forEach(m=>{const p=r.value.findIndex(I=>I.AdminLayoutUUID===m);p<0||p>=r.value.length||(u.saveAdminLayout(r.value[p]).then(I=>{I&&r.value.splice(p,1,I)}).catch(()=>{}),U=!0)}),f.value.forEach(m=>{u.deleteAdminLayout(m).catch(()=>{})}),f.value=[],T.value=[],U&&i("save")},d=U=>{const v=r.value.findIndex(m=>m.AdminLayoutUUID===U.AdminLayoutUUID);v<0||v>=r.value.length||(r.value[v].ID>0&&f.value.push(U.AdminLayoutUUID),r.value.splice(v,1))};return u.getConventionAdminLayouts(e.convention.ConventionUUID).then(U=>{U&&(r.value=U)}).catch(()=>[]),(U,v)=>(n(),S(_t,{modelValue:o.value,"onUpdate:modelValue":v[2]||(v[2]=m=>o.value=m),scrollable:!0,"retain-focus":!0,persistent:!0,fullscreen:!0},{default:l(()=>[t($t,{modelValue:r.value,"onUpdate:modelValue":v[0]||(v[0]=m=>r.value=m),"new-item":a,closeable:!0,"show-delete":!1,"show-save":!0,"has-order":!1,title:U.title,label:"Name","slot-name-prefix":"panel",onClose:v[1]||(v[1]=m=>o.value=!1),onSave:s},Xe({_:2},[W(r.value,(m,p)=>({name:`panel_${p}`,fn:l(()=>[t(me,{class:"px-0 mx-0",fluid:!0},{default:l(()=>[t(X,null,{default:l(()=>[t(M,{cols:"12"},{default:l(()=>[t(Li,{modelValue:r.value[p],"onUpdate:modelValue":I=>r.value[p]=I,convention:U.convention,layouts:r.value,onChange:I=>T.value.push(m.AdminLayoutUUID),onDelete:I=>d(m)},null,8,["modelValue","onUpdate:modelValue","convention","layouts","onChange","onDelete"])]),_:2},1024)]),_:2},1024)]),_:2},1024)])}))]),1032,["modelValue","title"])]),_:1},8,["modelValue"]))}}),Fi=["colspan"],Pi={style:{opacity:"var(--v-medium-emphasis-opacity)"}},Cs=j({__name:"RegistrationsView",emits:["pageTitle"],setup(e,{emit:c}){var Zt;const o=St();c("pageTitle","Registration Manager");const r=vl(),f=fl(),T=E(!0);let u=((Zt=r.params.convention)==null?void 0:Zt.toString())||"";const a=E({ID:0,ConventionUUID:ye(),OrganisationID:0,OrganisationUUID:bt,Name:"New Convention",Description:"",DetailLink:"",Logo:"",Slug:"",Accommodation:[],Tickets:[],Extras:[],Interests:[],Visible:!1}),s=Ae(),d=Ul.getInstance(),U=E([]),v=E({ID:0,AdminLayoutUUID:ye(),ConventionID:a.value.ID,ConventionUUID:a.value.ConventionUUID,Name:"Registration Table",Type:Ne.ADMIN_LAYOUT_TABLE,Panels:[]}),m=E([]),p=E([]),I=E([]),k=E([]),D=E([]),V=E([]),A=E(1),P=E(10),se=E([]),z=E(0),x=E(!1),le=E(""),Y=E(""),B=E(""),F=E(""),b=E({FieldUUID:"591c9bca-c78c-4e97-8aef-bc596ef472fb",Value:""}),Z=E({FieldUUID:"50189b21-6c55-4c99-a38f-7740a01ec4a4",Value:""}),ce=E({FieldUUID:"1523ef15-f2c3-46b9-a687-dcd7bc2c0a50",Value:""}),ne=E({FieldUUID:"926d43c6-a743-4ab7-bef2-060d762d37a9",Value:""}),pe=E(new Map([["591c9bca-c78c-4e97-8aef-bc596ef472fb",b.value],["50189b21-6c55-4c99-a38f-7740a01ec4a4",Z.value],["1523ef15-f2c3-46b9-a687-dcd7bc2c0a50",ce.value],["926d43c6-a743-4ab7-bef2-060d762d37a9",ne.value]])),et=E(""),tt=E(""),nt=E([]),Ce=E([]),Ye=E([]),Ge=E([]),xe=E([]),He=E([]),Se=E(0),Ie=E(),qe=E(!1),Jt=E(!1),Ha=E(!1),ct=E(),Xt=E(),Vt=E(),at=E(!1),qa=Be(),Ue=ki(()=>{Y.value=Date.now().toString()});fe(le,O=>{const C=V.value.find($=>$.uuid===O);if(C){const $=C.headers.find(L=>L.defaultSort===!0);$&&(se.value=[{key:$.key,order:"asc"}],nt.value=[{key:$.key,order:"asc"}])}}),fe(Se,O=>{O===8&&Wt()}),fe(et,()=>{Ue()}),fe(tt,()=>{Ue()});const Ka=()=>{m.value=[],I.value=[],k.value=[],V.value=[];try{s.getConventionAdminLayoutByName(a.value.ConventionUUID,"Registration Table").then(O=>{Se.value+=1,O?v.value=O:(v.value.ConventionID=a.value.ID,v.value.ConventionUUID=a.value.ConventionUUID)})}catch{v.value.ConventionID=a.value.ID,v.value.ConventionUUID=a.value.ConventionUUID}try{s.getConventionAdminLayouts(a.value.ConventionUUID).then(O=>{Se.value+=1,O&&(I.value=O)})}catch{}try{s.getConventionForms(a.value.ConventionUUID).then(O=>{Se.value+=1,O&&(m.value=O)})}catch{}try{s.getConventionAccommodation(a.value.ConventionUUID).then(O=>{Se.value+=1,O&&(Ce.value=O)})}catch{}try{s.getConventionVenues(a.value.ConventionUUID).then(O=>{Se.value+=1,O&&(He.value=O)})}catch{}try{s.getConventionExtras(a.value.ConventionUUID).then(O=>{Se.value+=1,O&&(Ye.value=O)})}catch{}try{s.getConventionInterests(a.value.ConventionUUID).then(O=>{Se.value+=1,O&&(Ge.value=O)})}catch{}try{s.getConventionTickets(a.value.ConventionUUID).then(O=>{Se.value+=1,O&&(xe.value=O)})}catch{}try{s.getConventionGroups(a.value.ConventionUUID).then(O=>{O&&(p.value=O.sort((C,$)=>C.Name.localeCompare($.Name)))})}catch{}try{s.getConventionTags(a.value.ConventionUUID).then(O=>{O&&(D.value=O.sort((C,$)=>C.Title.localeCompare($.Title)).map(C=>(C.Title=`${C.Title} [${C.Key}]`,C)))})}catch{}},Ot=({page:O,itemsPerPage:C,sortBy:$})=>{T.value=!0,A.value=O,se.value=$;const L=V.value.find(de=>de.uuid==le.value),Te=L==null?void 0:L.layout.Items;let re="",it="";if($&&Te&&$.length>=1){const de=Te.find(ht=>ht.LayoutItemUUID==$[0].key);switch(it=$[0].order||"asc",de==null?void 0:de.MetaField){case G.META_DATA_SOURCE_ACCOMMODATION_FORM:re="submission.status";break;case G.META_DATA_SOURCE_BADGE_FORM:re="submission.status";break;case G.META_DATA_SOURCE_DEALER_FORM:re="submission.status";break;case G.META_DATA_SOURCE_REGISTRATION_FORM:re="submission.status";break;case G.META_DATA_SOURCE_REGISTRATION_REFERENCE:re="reference";break;case G.META_DATA_SOURCE_SUBMISSION_DATE:re="created";break;case G.META_DATA_SOURCE_SUBMISSION_STATUS:re="submission.status";break}switch(de==null?void 0:de.UserField){case ie.USER_DATA_SOURCE_DISPLAY_NAME:re="user.display_name";break;case ie.USER_DATA_SOURCE_EMAIL:re="user.email";break;case ie.USER_DATA_SOURCE_FIRST_NAME:re="user.firstname";break;case ie.USER_DATA_SOURCE_HANDLE:re="user.handle";break;case ie.USER_DATA_SOURCE_LAST_NAME:re="user.lastname";break}}try{const de={Direction:it,Limit:C,Offset:(O-1)*C,Order:re};L&&L.layout.RequiredRegistrationTags.length>0&&(de.PanelUUID=L==null?void 0:L.layout.LayoutPanelUUID),(L==null?void 0:L.layout.RequiredFormType)===_e.FORM_TYPE_ACCOMMODATION&&(de.Accommodation=!0),(L==null?void 0:L.layout.RequiredFormType)===_e.FORM_TYPE_BADGE&&(de.Badge=!0),(L==null?void 0:L.layout.RequiredFormType)===_e.FORM_TYPE_DEALER&&(de.Dealer=!0),(L==null?void 0:L.layout.RequiredFormType)===_e.FORM_TYPE_REGISTRATION&&(de.Registration=!0),de.GroupUUID=et.value||bt,de.TagUUID=tt.value||bt,de.Email=F.value,de.Reference=B.value,de.FieldValues=Array.from(pe.value.values());const ht=Y.value;s.searchConventionRegistrations(a.value.ConventionUUID,de).then(kt=>{kt&&ht===Y.value&&(z.value=kt.Total,k.value=kt.Registrations,V.value.forEach(Nt=>{const tl=Nt.layout;Nt.items=k.value.map(J=>{const vt=[];let he;J.Leader?he=J:he=J.Primary,vt.push({Name:he.User.DisplayName,UUID:he.UserUUID,UserUUID:he.User.UserUUID,IsLeader:!0,Reference:he.Reference,Paid:he.Paid,Total:he.Total}),vt.push(...he.Members.map(ke=>({Name:ke.User.DisplayName,UUID:ke.UserUUID,UserUUID:ke.User.UserUUID,IsLeader:!1,Reference:ke.Reference,Paid:ke.Paid,Total:ke.Total})));const ae={};return Nt.headers.forEach(ke=>{var ea;const K=tl.Items.find(st=>st.LayoutItemUUID===ke.key);if(K){if(K.SourceType==="LAYOUT_ITEM_SOURCE_FORM"&&K.SectionField)J.Submissions.forEach(st=>{const lt=st.Data.find(H=>H.SectionFieldUUID===K.SectionFieldUUID);if(lt){ke.type===_a.ACCOMMODATION?ae[K.LayoutItemUUID]={Data:lt.Data,Registration:J}:ae[K.LayoutItemUUID]=lt.Data;return}});else if(K.SourceType==="LAYOUT_ITEM_SOURCE_USER"&&K.UserField)switch(K.UserField){case ie.USER_DATA_SOURCE_AVATAR:ae[K.LayoutItemUUID]=o.GetProfileImageURL(J.UserUUID);break;case ie.USER_DATA_SOURCE_DISPLAY_NAME:ae[K.LayoutItemUUID]=J.User.DisplayName;break;case ie.USER_DATA_SOURCE_EMAIL:ae[K.LayoutItemUUID]=J.User.Additional.Email;break;case ie.USER_DATA_SOURCE_HANDLE:ae[K.LayoutItemUUID]=J.User.Handle;break;case ie.USER_DATA_SOURCE_DATE_OF_BIRTH:ae[K.LayoutItemUUID]=J.User.Additional.DOB;break;case ie.USER_DATA_SOURCE_FIRST_NAME:ae[K.LayoutItemUUID]=J.User.Additional.FirstName;break;case ie.USER_DATA_SOURCE_LAST_NAME:ae[K.LayoutItemUUID]=J.User.Additional.LastName;break;case ie.USER_DATA_SOURCE_TELEGRAM:ae[K.LayoutItemUUID]="";break}else if(K.SourceType==="LAYOUT_ITEM_SOURCE_META"&&K.MetaField){const st=(ea=m.value.find(H=>H.Type===_e.FORM_TYPE_REGISTRATION))==null?void 0:ea.FormUUID,lt=J.Submissions.find(H=>H.FormUUID===st);switch(K.MetaField){case G.META_DATA_SOURCE_REGISTRATION_ACTIONS:ae[K.LayoutItemUUID]=J;break;case G.META_DATA_SOURCE_REGISTRATION_GROUP:ae[K.LayoutItemUUID]=vt;break;case G.META_DATA_SOURCE_REGISTRATION_REFERENCE:ae[K.LayoutItemUUID]=J.Reference;break;case G.META_DATA_SOURCE_SUBMISSION_DATE:if(lt){const H=new Date(lt.CreatedAt||"");ae[K.LayoutItemUUID]=`${H.getFullYear()}-${(H.getMonth()+1).toString().padStart(2,"0")}-${H.getDate().toString().padStart(2,"0")} ${H.getHours().toString().padStart(2,"0")}:${H.getMinutes().toString().padStart(2,"0")}:${H.getSeconds().toString().padStart(2,"0")}`}else{const H=new Date(J.CreatedAt||"");ae[K.LayoutItemUUID]=`${H.getFullYear()}-${(H.getMonth()+1).toString().padStart(2,"0")}-${H.getDate().toString().padStart(2,"0")} ${H.getHours().toString().padStart(2,"0")}:${H.getMinutes().toString().padStart(2,"0")}:${H.getSeconds().toString().padStart(2,"0")}`}break;case G.META_DATA_SOURCE_ACCOMMODATION_FORM:ae[K.LayoutItemUUID]=J.Submissions.map(H=>{const ee=m.value.find(Re=>Re.FormUUID===H.FormUUID);return{Heading:ee==null?void 0:ee.Heading,Form:ee,Submission:H,Registration:J}}).filter(H=>{var ee;return((ee=H.Form)==null?void 0:ee.Type)===_e.FORM_TYPE_ACCOMMODATION});break;case G.META_DATA_SOURCE_BADGE_FORM:ae[K.LayoutItemUUID]=J.Submissions.map(H=>{const ee=m.value.find(Re=>Re.FormUUID===H.FormUUID);return{Heading:ee==null?void 0:ee.Heading,Form:ee,Submission:H,Registration:J}}).filter(H=>{var ee;return((ee=H.Form)==null?void 0:ee.Type)===_e.FORM_TYPE_BADGE});break;case G.META_DATA_SOURCE_DEALER_FORM:ae[K.LayoutItemUUID]=J.Submissions.map(H=>{const ee=m.value.find(Re=>Re.FormUUID===H.FormUUID);return{Heading:ee==null?void 0:ee.Heading,Form:ee,Submission:H,Registration:J}}).filter(H=>{var ee;return((ee=H.Form)==null?void 0:ee.Type)===_e.FORM_TYPE_DEALER});break;case G.META_DATA_SOURCE_PAYMENT_STATUS:if(J.Paid===0&&J.Total)ae[K.LayoutItemUUID]="REQUIRED";else if(J.Total>J.Paid)ae[K.LayoutItemUUID]="ADDITIONAL_REQUIRED";else{const H=vt.find(ee=>ee.Paid===0&&(ee.Total||0)>0);if(H){J.Total===0&&H.Total===0?ae[K.LayoutItemUUID]="NOT_REQUIRED":J.Total===0&&H.Total||J.Total>0&&H.Total===0?ae[K.LayoutItemUUID]="MISSING_REQUIRED":J.Paid>=J.Total?ae[K.LayoutItemUUID]="AWAITING_PARTNER":ae[K.LayoutItemUUID]="ALL_REQUIRED";break}else J.Total===0?ae[K.LayoutItemUUID]="NOT_REQUIRED":ae[K.LayoutItemUUID]="COMPLETE"}break;case G.META_DATA_SOURCE_SUBMISSION_STATUS:ql(J.Submissions,m.value),ae[K.LayoutItemUUID]=J.Submissions.map(H=>{const ee=m.value.find(Re=>Re.FormUUID===H.FormUUID);return{Heading:ee==null?void 0:ee.Heading,Form:ee,Submission:H,Registration:J}});break;case G.META_DATA_SOURCE_DATA_LAYOUT:ae[K.LayoutItemUUID]={Registration:J,Layouts:I.value.filter(H=>{if(K.Meta&&K.Meta.LayoutUUID&&Array.isArray(K.Meta.LayoutUUID))return H.Panels.forEach(ee=>{ee.Items.sort((Re,ta)=>Re.Order>ta.Order?1:Re.Order===ta.Order?0:-1)}),K.Meta.LayoutUUID.includes(H.AdminLayoutUUID)})};break}}}}),{key:J.RegistrationUUID,registration:J,...ae}})}),T.value=!1)})}catch{}},ja=O=>{x.value=!1,O&&(v.value=O,Wt())},Wt=()=>{xa(v.value.Panels,m.value),v.value.Panels.length>0&&(V.value=[],v.value.Panels.forEach(O=>{const C={uuid:ye(),order:O.Order,name:O.Name,headers:[],items:[],layout:O};O.Items.sort(($,L)=>$.Order>L.Order?1:$.Order==L.Order?0:-1),C.headers=O.Items.map($=>{var L,Te;return{key:$.LayoutItemUUID,title:$.Label||((Te=(L=$.SectionField)==null?void 0:L.Field)==null?void 0:Te.Label)||"",align:$.Align==="end"?"end":"start",sortable:Qa($),type:za($),defaultSort:$.DefaultSort,meta:$.Meta}}),V.value.push(C)}),V.value=V.value.sort((O,C)=>O.order>C.order?1:O.order==C.order?0:-1)),(le.value==null||le.value=="")&&V.value.length>0&&(le.value=V.value[0].uuid)};u?s.getConvention(u).then(O=>{O&&(a.value=O,v.value.ConventionID=a.value.ID,v.value.ConventionUUID=a.value.ConventionUUID,Ka())}).catch(()=>{f.push("/")}):f.push("/");const za=O=>{var C,$;if(O.SourceType===Le.LAYOUT_ITEM_SOURCE_META)return`${O.SourceType}.${O.MetaField}`;if(O.SourceType===Le.LAYOUT_ITEM_SOURCE_FORM)return($=(C=O.SectionField)==null?void 0:C.Field)==null?void 0:$.Type;if(O.SourceType===Le.LAYOUT_ITEM_SOURCE_USER)return`${O.SourceType}.${O.UserField}`},Qa=O=>{const C=[G.META_DATA_SOURCE_ACCOMMODATION_FORM,G.META_DATA_SOURCE_BADGE_FORM,G.META_DATA_SOURCE_DEALER_FORM,G.META_DATA_SOURCE_REGISTRATION_FORM,G.META_DATA_SOURCE_REGISTRATION_REFERENCE,G.META_DATA_SOURCE_SUBMISSION_DATE,G.META_DATA_SOURCE_SUBMISSION_STATUS],$=[ie.USER_DATA_SOURCE_DISPLAY_NAME,ie.USER_DATA_SOURCE_EMAIL,ie.USER_DATA_SOURCE_HANDLE,ie.USER_DATA_SOURCE_DATE_OF_BIRTH,ie.USER_DATA_SOURCE_FIRST_NAME,ie.USER_DATA_SOURCE_LAST_NAME];return C.includes(O.MetaField)||$.includes(O.UserField)},Ja=O=>{Ie.value=O,qe.value=!0},Xa=O=>{Ie.value=O,Jt.value=!0},Wa=O=>{Ie.value=O,Ha.value=!0};fe(qe,O=>{O||(Ie.value=void 0)}),fe(Jt,O=>{O||(Ie.value=void 0)});const Mt=async(O="")=>{Xt.value=await s.getRegistrationGroup(O)},Za=({registration:O,form:C,submission:$})=>{Ie.value=O,Mt(O.RegistrationUUID).then(()=>{ct.value=C,Vt.value=$,at.value=!0})},el=O=>{s.switchUser(O.UserUUID).then(C=>{C&&zl(C.tokens,C.user,f,!1)}).catch(C=>{console.error(C)})};return d.on("registration.group.leave",O=>{s.leaveRegistrationGroup(O).then(C=>{C&&Mt(O).then(()=>{d.emit("registration.group.left",C)})})}),d.on("registration.group.remove.member",O=>{s.leaveRegistrationGroup(O).then(C=>{C&&Mt(O).then(()=>{d.emit("registration.group.left",C)})})}),(O,C)=>(n(),S(Jl,null,{default:l(()=>[t(Bt,{color:"blue-darken-4"},{default:l(()=>[t(Ia,{modelValue:le.value,"onUpdate:modelValue":C[0]||(C[0]=$=>le.value=$),"show-arrows":""},{default:l(()=>[(n(!0),_(h,null,W(V.value,$=>(n(),S(Ca,{key:$.uuid,value:$.uuid},{default:l(()=>[R(y($.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"]),t(Pe),t(q,{icon:"mdi:mdi-cog-outline",onClick:C[1]||(C[1]=$=>x.value=!0)})]),_:1}),t(Va,{modelValue:le.value,"onUpdate:modelValue":C[23]||(C[23]=$=>le.value=$),disabled:!0,touch:!1},{default:l(()=>[(n(!0),_(h,null,W(V.value,$=>(n(),S(Qe,{key:$.uuid,value:$.uuid},{default:l(()=>[$.uuid===le.value?(n(),S($e,{key:0,class:"pa-2"},{default:l(()=>[t(no,{expanded:U.value,"onUpdate:expanded":C[19]||(C[19]=L=>U.value=L),page:A.value,"onUpdate:page":C[20]||(C[20]=L=>A.value=L),"items-per-page":P.value,"onUpdate:itemsPerPage":C[21]||(C[21]=L=>P.value=L),"sort-by":nt.value,"onUpdate:sortBy":C[22]||(C[22]=L=>nt.value=L),headers:$.headers,"items-length":z.value,items:$.items,"item-value":"key",loading:T.value,search:Y.value,"onUpdate:options":Ot,"show-expand":""},Xe({top:l(()=>[t(Ct,{class:"mb-3"},{default:l(()=>[t(It,null,{default:l(()=>[t(Dt,{color:"secondary",class:"font-weight-bold pb-0 pt-0"},{default:l(()=>[t(M,{class:"pa-0"},{default:l(()=>[R(" Search Criteria "),t(Me,{class:"pl-5",icon:"mdi:mdi-credit-card-search-outline"})]),_:1}),t(M,{class:"d-none d-sm-block pa-0",cols:"0"},{default:l(()=>[t(oe,{modelValue:B.value,"onUpdate:modelValue":C[2]||(C[2]=L=>B.value=L),label:"Badge No.",clearable:!0,"hide-details":"",variant:"plain",onClick:C[3]||(C[3]=wt(()=>{},["stop"])),"onClick:clear":g(Ue),onInput:g(Ue)},null,8,["modelValue","onClick:clear","onInput"])]),_:1}),t(M,{class:"d-none d-md-block pa-0"},{default:l(()=>[t(oe,{modelValue:b.value.Value,"onUpdate:modelValue":C[4]||(C[4]=L=>b.value.Value=L),label:"Furry Name",clearable:!0,"hide-details":"",variant:"plain",onClick:C[5]||(C[5]=wt(()=>{},["stop"])),"onClick:clear":g(Ue),onInput:g(Ue)},null,8,["modelValue","onClick:clear","onInput"])]),_:1})]),_:1}),t(yt,{class:"pt-2"},{default:l(()=>[t(X,null,{default:l(()=>[t(M,{cols:"12",sm:"6",md:"3",lg:"2",xl:"1"},{default:l(()=>[R(y(B.value)+" ",1),t(oe,{modelValue:B.value,"onUpdate:modelValue":C[6]||(C[6]=L=>B.value=L),label:"Badge No.",clearable:!0,"hide-details":"",variant:"outlined","onClick:clear":g(Ue),onInput:g(Ue)},null,8,["modelValue","onClick:clear","onInput"])]),_:1}),t(M,{cols:"12",sm:"6",md:"4",lg:"5",xl:"2"},{default:l(()=>[t(oe,{modelValue:b.value.Value,"onUpdate:modelValue":C[7]||(C[7]=L=>b.value.Value=L),label:"Furry Name",clearable:!0,"hide-details":"",variant:"outlined","onClick:clear":g(Ue),onInput:g(Ue)},null,8,["modelValue","onClick:clear","onInput"])]),_:1}),t(M,{cols:"12",sm:"12",md:"5",lg:"5",xl:"3"},{default:l(()=>[t(oe,{modelValue:F.value,"onUpdate:modelValue":C[8]||(C[8]=L=>F.value=L),label:"E-mail",clearable:!0,"hide-details":"",variant:"outlined","onClick:clear":g(Ue),onInput:g(Ue)},null,8,["modelValue","onClick:clear","onInput"])]),_:1}),t(M,{cols:"12",sm:"6",md:"4",lg:"4",xl:"2"},{default:l(()=>[t(oe,{modelValue:Z.value.Value,"onUpdate:modelValue":C[9]||(C[9]=L=>Z.value.Value=L),label:"Legal Forename",clearable:!0,"hide-details":"",variant:"outlined","onClick:clear":g(Ue),onInput:g(Ue)},null,8,["modelValue","onClick:clear","onInput"])]),_:1}),t(M,{cols:"12",sm:"6",md:"4",lg:"4",xl:"2"},{default:l(()=>[t(oe,{modelValue:ce.value.Value,"onUpdate:modelValue":C[10]||(C[10]=L=>ce.value.Value=L),label:"Legal Surname",clearable:!0,"hide-details":"",variant:"outlined","onClick:clear":g(Ue),onInput:g(Ue)},null,8,["modelValue","onClick:clear","onInput"])]),_:1}),t(M,{cols:"12",sm:"12",md:"4",lg:"4",xl:"2"},{default:l(()=>[t(oe,{modelValue:ne.value.Value,"onUpdate:modelValue":C[11]||(C[11]=L=>ne.value.Value=L),type:"date",label:"Date of Birth",clearable:!0,"hide-details":"",variant:"outlined","onClick:clear":g(Ue),onInput:g(Ue)},null,8,["modelValue","onClick:clear","onInput"])]),_:1}),t(M,{cols:"12",sm:"6",md:"6",lg:"6",xl:"6"},{default:l(()=>[t(ve,{modelValue:et.value,"onUpdate:modelValue":C[12]||(C[12]=L=>et.value=L),label:"Permission Groups",clearable:!0,"hide-details":"",variant:"outlined",items:p.value,"item-value":"GroupUUID","item-title":"Name"},null,8,["modelValue","items"])]),_:1}),t(M,{cols:"12",sm:"6",md:"6",lg:"6",xl:"6"},{default:l(()=>[t(ve,{modelValue:tt.value,"onUpdate:modelValue":C[13]||(C[13]=L=>tt.value=L),label:"Tags",clearable:!0,"hide-details":"",variant:"outlined",items:D.value,"item-value":"TagUUID","item-title":"Title"},null,8,["modelValue","items"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),"expanded-row":l(({columns:L,internalItem:Te})=>[w("tr",null,[w("td",{colspan:L.length},[t(Aa,{modelValue:qe.value,"onUpdate:modelValue":C[15]||(C[15]=re=>qe.value=re),registration:Te.raw.registration,"onUpdate:registration":re=>Te.raw.registration=re,accommodations:Ce.value,convention:a.value,extras:Ye.value,forms:m.value,interests:Ge.value,tickets:xe.value,title:`Registration Controls (#${Te.raw.registration.Reference} ${Te.raw.registration.User.DisplayName})`,"use-dialog":!1,venues:He.value,style:{"max-width":"calc(100vw - 48px)"},class:"ml-auto mr-0"},null,8,["modelValue","registration","onUpdate:registration","accommodations","convention","extras","forms","interests","tickets","title","venues"])],8,Fi)])]),"item.data-table-expand":l(({internalItem:L})=>[U.value.findIndex(Te=>Te===L.key)>=0?(n(),S(q,{key:0,"append-icon":"mdi:mdi-chevron-up",size:"xs",variant:"flat",onClick:Te=>U.value.splice(U.value.findIndex(re=>re===L.key),1)},{default:l(()=>[L.raw.registration.Notes&&L.raw.registration.Notes.length>0?(n(),_(h,{key:0},[R(y(L.raw.registration.Notes.length),1)],64)):N("",!0)]),_:2},1032,["onClick"])):(n(),S(q,{key:1,"append-icon":"mdi:mdi-chevron-down",size:"xs",variant:"flat",onClick:Te=>U.value.push(L.key)},{default:l(()=>[L.raw.registration.Notes&&L.raw.registration.Notes.length>0?(n(),_(h,{key:0},[R(y(L.raw.registration.Notes.length),1)],64)):N("",!0)]),_:2},1032,["onClick"]))]),bottom:l(()=>[t(me,{fluid:!0},{default:l(()=>[t(X,{class:"align-center"},{default:l(()=>[t(M,{cols:"12",lg:"7","order-lg":"3",xl:"8"},{default:l(()=>[t(Bl,{modelValue:A.value,"onUpdate:modelValue":C[16]||(C[16]=L=>A.value=L),length:Math.ceil(z.value/P.value)},null,8,["modelValue","length"])]),_:1}),t(M,{cols:"6",sm:"4",md:"2",lg:"2",xl:"1","order-lg":"1"},{default:l(()=>[t(ve,{modelValue:P.value,"onUpdate:modelValue":C[17]||(C[17]=L=>P.value=L),density:"compact","hide-details":"","item-title":"title","item-value":"value",label:"Items per page",min:"-1",max:"100",type:"number",variant:"outlined",items:[{title:"10",value:10},{title:"25",value:25},{title:"50",value:50},{title:"100",value:100},{title:"All",value:-1}]},null,8,["modelValue"])]),_:1}),t(M,{cols:"6",sm:"3",md:"2",lg:"1",xl:"1","order-lg":"2"},{default:l(()=>[t(oe,{modelValue:A.value,"onUpdate:modelValue":C[18]||(C[18]=L=>A.value=L),modelModifiers:{number:!0},density:"compact","hide-details":"",label:"Page",min:"1",max:Math.ceil(z.value/P.value),type:"number",variant:"outlined"},null,8,["modelValue","max"])]),_:1}),t(M,{class:"text-right",cols:"12",sm:"5",md:"8",lg:"2",xl:"2","order-lg":"4"},{default:l(()=>[w("span",Pi,[P.value===-1?(n(),_(h,{key:0},[R(" 1-"+y(z.value)+" of "+y(z.value),1)],64)):(n(),_(h,{key:1},[R(y((A.value-1)*P.value+1)+"-"+y(A.value*P.value>=z.value?z.value:A.value*P.value)+" of "+y(z.value),1)],64))])]),_:1})]),_:1})]),_:1})]),_:2},[W($.headers,L=>({name:`item.${L.key}`,fn:l(({internalItem:Te,index:re})=>[t(ni,{header:L,item:Te,accommodations:Ce.value,convention:a.value,extras:Ye.value,forms:m.value,interests:Ge.value,tickets:xe.value,user:g(qa),venues:He.value,modelValue:$.items[re],"onUpdate:modelValue":it=>$.items[re]=it,onOpenActions:Ja,onOpenPayments:Xa,onOpenTags:Wa,onReload:C[14]||(C[14]=it=>Ot({page:A.value,itemsPerPage:P.value,sortBy:se.value})),onSwitchUser:el,onShowForm:Za},null,8,["header","item","accommodations","convention","extras","forms","interests","tickets","user","venues","modelValue","onUpdate:modelValue"])])}))]),1032,["expanded","page","items-per-page","sort-by","headers","items-length","items","loading","search"])]),_:2},1024)):N("",!0)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"]),x.value?(n(),S(wi,{key:0,title:"Edit Layouts",modelValue:x.value,"onUpdate:modelValue":C[24]||(C[24]=$=>x.value=$),convention:a.value,onSave:ja},null,8,["modelValue","convention"])):N("",!0),Ie.value?(n(),_(h,{key:1},[qe.value?(n(),S(Aa,{key:0,modelValue:qe.value,"onUpdate:modelValue":C[25]||(C[25]=$=>qe.value=$),registration:Ie.value,"onUpdate:registration":C[26]||(C[26]=$=>Ie.value=$),accommodations:Ce.value,convention:a.value,extras:Ye.value,forms:m.value,interests:Ge.value,tickets:xe.value,title:`Registration Controls (#${Ie.value.Reference} ${Ie.value.User.DisplayName})`,"use-dialog":!0,venues:He.value},null,8,["modelValue","registration","accommodations","convention","extras","forms","interests","tickets","title","venues"])):N("",!0)],64)):N("",!0),at.value&&Vt.value&&ct.value?(n(),S(_t,{key:2,modelValue:at.value,"onUpdate:modelValue":C[30]||(C[30]=$=>at.value=$),scrollable:!0,fullscreen:!0,persistent:!0},{default:l(()=>[t($e,{class:"bg-red-darken-4"},{default:l(()=>[t(Bt,{color:"error"},{default:l(()=>[t(Ma,null,{default:l(()=>[R("Submission Editor - Admin Mode")]),_:1}),t(Pe),t(Ql,null,{default:l(()=>[t(q,{icon:"mdi:mdi-window-close",onClick:C[27]||(C[27]=$=>at.value=!1)})]),_:1})]),_:1}),t(Ze,null,{default:l(()=>[t(_l,{modelValue:ct.value,"onUpdate:modelValue":C[28]||(C[28]=$=>ct.value=$),admin:!0,convention:a.value,data:Vt.value,editable:!0,"registration-group":Xt.value,onClose:C[29]||(C[29]=$=>{at.value=!1,Ot({page:A.value,itemsPerPage:P.value,sortBy:se.value})})},null,8,["modelValue","convention","data","registration-group"])]),_:1})]),_:1})]),_:1},8,["modelValue"])):N("",!0)]),_:1}))}});export{Cs as default};
