import{i as j,M as ke,N as Ie,j as Ue,r as A,w as se,n as e,q as s,v as t,x as n,f as r,z as Ee,y as S,A as p,O as Ae,D as m,P as le,k as ve,B as i,F as c,Q as Y,C as u,c as B,l as ne,m as De,G as be,H as we,_ as _e}from"./index-PEJhqAcZ.js";import{G as ie}from"./userData-D0W03ZyC.js";import{_ as Ce}from"./LoginView.vue_vue_type_script_setup_true_lang-7vtFP6bl.js";import{s as ae}from"./index-2XRRB2DS.js";import{F as I}from"./form-0fJbSFPv.js";import{S as V,a as Pe}from"./submission-KjP5fLyB.js";import{u as ye}from"./useStoreAPI-RAWzoJwx.js";import{c as J}from"./canEditForm-aU6gUrOw.js";import{s as Oe}from"./sortSubmissions-NKScr9xj.js";import{P as Q,a as Re,u as Fe}from"./useDisplayTransactions-UIWaz0Dq.js";import{l as Ve}from"./stripe.esm-sevhGlMX.js";import{_ as Ne}from"./ModelDialog.vue_vue_type_script_setup_true_lang-Y2ILLnS_.js";import{c as te,V as d,n as Me}from"./VContainer-V1y9fsL9.js";import{V as $e}from"./VAlert-gRBXsepZ.js";import{V as Le}from"./VForm-JrGAlNTA.js";import{V as G,a as x}from"./VRow-TrfFNuqO.js";import{V as ge}from"./scopeId-_R_M3HaF.js";import{V as Ye}from"./SaveButton.vue_vue_type_script_setup_true_lang-74x4ISQS.js";import{f as xe,h as fe}from"./date-RO2WHkId.js";import{V as Se,a as ee,b as pe,c as oe,d as ze,e as he}from"./VCard-aIwQwYfD.js";import{V as Te}from"./forwardRefs-s7kstd5J.js";import{V as Be}from"./VTooltip-njRwyaAI.js";import{V as Ge,a as He,c as qe,d as je}from"./VList--OdXbT0L.js";import"./emailFormVariant-1EY2p0cn.js";import"./LoginButton-FReJmJaR.js";import"./VDialog-LnH2bcDB.js";import"./VToolbar-44RMAhos.js";import"./createSimpleFunctional-95IOEdY3.js";import"./form-9lTVHyLR.js";import"./VDivider-Sf03NogY.js";const Ke=m("p",{class:"my-4"},[n(" Payments are non-refundable, please check our "),m("a",{target:"_blank",href:"https://www.scotiacon.org.uk/policies"},"policies"),n(" for further information. ")],-1),We=m("p",{class:"my-4"}," You must be over 18 to attend the convention and be able to produce valid ID matching the details on your registration. ",-1),Je=m("p",{class:"my-4"}," If you are unable to provide valid ID when asked at the convention you will not be issued your attendee badge. ",-1),Qe=m("p",{class:"my-4"}," Payments should be made by the authorised card holder only. ",-1),Xe=m("p",{class:"my-4"},[n(" Please contact "),m("a",{href:"mailto:registration@scotiacon.org.uk"},"registration@scotiacon.org.uk"),n(" if you need any further assistance. ")],-1),Ze=m("div",{id:"link-authentication-element"},null,-1),et=m("div",{id:"payment-element"},null,-1),tt=j({__name:"StripePayment",props:ke({paymentTransactions:{},registration:{}},{modelValue:{type:Boolean,required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(g){const U=Ie(g,"modelValue"),O=le(),C=ie(),_=Ue(),l=A(),y=A(),h=A((C==null?void 0:C.Additional.Email)||""),T=A(!1),M=A("");let $;const z=A(!1);se(U,b=>{b&&O.stripePublicKey().then(async k=>{k&&(y.value=await Ve(k),await W(y.value))})});const H=b=>{M.value=b,T.value=!0};async function W(b){var f;if(!b)return;const k=await O.stripePaymentIntent(((f=g.registration)==null?void 0:f.RegistrationUUID)||""),D={theme:"stripe"};_.current.value.dark&&(D.theme="night"),$=b.elements({clientSecret:k,appearance:D});const L=$.create("linkAuthentication",{defaultValues:{email:h.value}});L.mount("#link-authentication-element"),L.on("change",v=>{h.value=v.value.email});const Z={layout:"tabs"};$.create("payment",Z).mount("#payment-element")}async function X(b,k){if(!k)return;b.preventDefault(),z.value=!0;const D=new URL(location.href);D.pathname+="payment/stripe/processing";const{error:L}=await k.confirmPayment({elements:$,confirmParams:{return_url:D.toString(),receipt_email:h.value}});L.type==="card_error"||L.type==="validation_error"?H(L.message):H("An unexpected error occurred."),z.value=!1}return(b,k)=>(e(),s(Ne,{modelValue:U.value,"onUpdate:modelValue":k[4]||(k[4]=D=>U.value=D),title:"Make a Payment",color:"blue-darken-4",fullscreen:"",persistent:""},{default:t(()=>[r(te,{class:"pa-0"},{default:t(()=>[r($e,{class:"mb-2",closable:!0},{title:t(()=>[n(" Payment Information ")]),text:t(()=>[Ke,We,Je,Qe,Xe]),_:1}),r(Le,{ref_key:"paymentForm",ref:l,id:"payment-form",onSubmit:k[1]||(k[1]=Ee(D=>X(D,y.value),["prevent"]))},{default:t(()=>[r(G,null,{default:t(()=>[r(x,null,{default:t(()=>[Ze]),_:1})]),_:1}),r(G,null,{default:t(()=>[r(x,null,{default:t(()=>[et]),_:1})]),_:1}),r(G,null,{default:t(()=>[b.registration?(e(),s(x,{key:0,class:"font-weight-bold text-right"},{default:t(()=>[n(" Payment Amount: £"+S(b.registration.Total-b.registration.Paid),1)]),_:1})):p("",!0)]),_:1}),r(G,null,{default:t(()=>[r(x,{class:"text-right",cols:"12",sm:"3",md:"2",lg:"2",xl:"1"},{default:t(()=>[r(d,{color:"error",class:"w-100",onClick:k[0]||(k[0]=D=>U.value=!1)},{default:t(()=>[n("Cancel")]),_:1})]),_:1}),r(ge),r(x,{class:"text-left",cols:"12",sm:"3",md:"2",lg:"2",xl:"1"},{default:t(()=>[r(d,{type:"submit",color:"success",class:"w-100"},Ae({default:t(()=>[n(" Pay Now ")]),_:2},[z.value?{name:"prepend",fn:t(()=>[r(Me,{size:"20",indeterminate:""})]),key:"0"}:void 0]),1024)]),_:1})]),_:1})]),_:1},512)]),_:1}),r(Ye,{modelValue:T.value,"onUpdate:modelValue":k[3]||(k[3]=D=>T.value=D)},{actions:t(()=>[r(d,{variant:"text",onClick:k[2]||(k[2]=D=>T.value=!1)},{default:t(()=>[n(" Close ")]),_:1})]),default:t(()=>[n(S(M.value)+" ",1)]),_:1},8,["modelValue"])]),_:1},8,["modelValue"]))}}),at={key:0},ot={key:1,class:"v-row"},nt={key:0,class:"v-col v-col-10 py-1 v-row mx-0 pl-0"},st={class:"v-col v-col-12 v-col-sm-4 v-col-md-3 font-weight-bold pb-0 pr-0"},lt={class:"v-col v-col-12 v-col-sm-8 v-col-md-9 font-italic pt-0 pt-sm-3 pb-sm-0 pl-sm-0"},it={key:1,class:"v-col v-col-10 py-1 v-row mx-0 pl-0"},rt={class:"v-col v-col-12 v-col-sm-4 v-col-md-3 font-weight-bold pb-0 pr-0"},ut={class:"v-col v-col-12 v-col-sm-8 v-col-md-9 font-italic pt-0 pt-sm-3 pb-sm-0 pl-sm-0"},ct={class:"v-col v-col-2 align-self-end text-right py-1 text-no-wrap"},dt=m("dt",{class:"v-col v-col-9 py-1 font-weight-bold totals"}," Total Charges ",-1),mt={class:"v-col v-col-3 align-self-end text-right py-1 totals text-no-wrap"},vt=m("dt",{class:"v-col v-col-9 py-1 font-weight-bold"}," Current Payments ",-1),ft={class:"v-col v-col-3 align-self-end text-right py-1 text-no-wrap"},pt=m("dt",{class:"v-col v-col-9 py-1 font-weight-bold totals"}," Balance Due ",-1),_t={class:"v-col v-col-3 align-self-end text-right py-1 totals text-no-wrap"},yt=j({__name:"AttendeeTransactionList",props:{paymentTransactions:{},registration:{}},setup(g){const U=g,O=A(ve(U.paymentTransactions));se(U,()=>{O.value=ve(U.paymentTransactions)});const C=(_,l)=>_.Type===Q.PAYMENT_TRANSACTION_TYPE_CHARGE&&l.Type!==Q.PAYMENT_TRANSACTION_TYPE_CHARGE?-1:_.Type!==Q.PAYMENT_TRANSACTION_TYPE_CHARGE&&l.Type===Q.PAYMENT_TRANSACTION_TYPE_CHARGE||(_.UpdatedAt||0)>(l.UpdatedAt||0)?1:_.UpdatedAt===l.UpdatedAt?0:-1;return(_,l)=>_.paymentTransactions.length==0&&_.registration.Total==0?(e(),i("p",at," Your registration is currently being processed, payment information will appear here when ready. ")):(e(),i("dl",ot,[(e(!0),i(c,null,Y(O.value.sort(C),y=>{var h;return e(),i(c,{key:y.PaymentTransactionUUID},[y.Type===u(Q).PAYMENT_TRANSACTION_TYPE_CHARGE?(e(),i("dt",nt,[m("div",st,S(y.Description.split(":")[0]),1),m("div",lt,S(y.Description.split(":")[1]),1)])):(e(),i("dt",it,[m("div",rt,S((h=u(Re).find(T=>T.value===y.Type))==null?void 0:h.title),1),m("div",ut," [ "+S(u(xe)(y.UpdatedAt||""))+" ] "+S(y.Description),1)])),m("dd",ct," £"+S(y.Amount),1)],64)}),128)),dt,m("dd",mt," £"+S(_.registration.Total),1),vt,m("dd",ft," £"+S(_.registration.Paid),1),pt,m("dd",_t," £"+S(_.registration.Total-_.registration.Paid),1)]))}}),K=g=>(be("data-v-33d5cbe7"),g=g(),we(),g),gt=["innerHTML"],St={key:0},ht={key:0,class:"font-weight-bold float-left pt-1 w-50"},Tt={key:1,class:"pa-1"},kt=K(()=>m("dt",null,[m("h3",null,"Forms Available")],-1)),It=K(()=>m("dd",{class:"mb-2"}," The following forms are currently available for completion. ",-1)),Ut={class:"font-weight-bold float-left pt-1 w-50 pt-3",style:{clear:"both"}},Et={class:"pt-2"},At=K(()=>m("dt",{class:"mt-3"},[m("h3",null,"Received Forms")],-1)),Dt=K(()=>m("dd",{class:"mb-2"}," The following forms have been received from you. ",-1)),bt={key:0,class:"font-weight-bold float-left pt-1 w-50",style:{clear:"both"}},wt={key:1},Ct={class:"font-weight-bold float-left pt-1 w-50",style:{clear:"both"}},Pt={class:"text-red-darken-4"},Ot={key:1,class:"text-red-darken-4 mt-4"},Rt=K(()=>m("strong",null,"There are forms above that require completion, please edit and save them.",-1)),Ft=[Rt],Vt=K(()=>m("br",null,null,-1)),Nt=j({__name:"OpenConvention",props:{convention:{},forms:{default:()=>[]}},setup(g){const U=ye(),O=le(),{getPaymentTransactions:C}=Fe(),_=A(U.GetConventionLogoURL(g.convention.ConventionUUID)),l=A(),y=A([]),h=A([]),T=A([]),M=A(!1),$=A([]),z=B(()=>{var a;return J(g.forms,((a=l.value)==null?void 0:a.Submissions)||[],I.FORM_TYPE_REGISTRATION)}),H=B(()=>{var a;return J(g.forms,((a=l.value)==null?void 0:a.Submissions)||[],I.FORM_TYPE_DEALER)}),W=B(()=>{var a;return J(g.forms,((a=l.value)==null?void 0:a.Submissions)||[],I.FORM_TYPE_BADGE)}),X=B(()=>{var a;return J(g.forms,((a=l.value)==null?void 0:a.Submissions)||[],I.FORM_TYPE_ACCOMMODATION)}),b=B(()=>{var a;return J(g.forms,((a=l.value)==null?void 0:a.Submissions)||[],I.FORM_TYPE_ADDITIONAL)}),k=B(()=>l.value?g.forms.filter(a=>{var f;return a.State.Independent?(f=l.value)!=null&&f.Submissions&&"Submissions"in l.value?!l.value.Submissions.find(v=>{var R;return((R=v.Form)==null?void 0:R.FormUUID)===a.FormUUID}):!0:!1}):g.forms),D=B(()=>{var a,f;return l.value&&((a=l.value)!=null&&a.Submissions)?!!((f=l.value)!=null&&f.Submissions.find(v=>{var R;return((R=v.Form)==null?void 0:R.Type)==I.FORM_TYPE_REGISTRATION&&(v.Status==V.SUBMISSION_STATUS_ACCEPTED||v.Status==V.SUBMISSION_STATUS_COMPLETED)})):!1}),L=async()=>{l.value&&"RegistrationUUID"in l.value&&O.getRegistrationAllocationPeriods(l.value.RegistrationUUID).then(a=>{a&&(h.value=[],y.value=a,y.value.sort((f,v)=>f.DateStart>v.DateStart?1:-1).forEach(f=>{var R;const v=h.value.find(w=>{var P;return w.name===((P=f.Accommodation)==null?void 0:P.Name)});if(v){const w=v.periods.find(F=>F.start===f.DateEnd),P=v.periods.find(F=>F.end===f.DateStart);w?w.start=f.DateStart:P?P.end=f.DateEnd:v.periods.push({start:f.DateStart,end:f.DateEnd})}else h.value.push({name:((R=f.Accommodation)==null?void 0:R.Name)||"",periods:[{start:f.DateStart,end:f.DateEnd}]})}))}).catch(()=>{})},Z=()=>{O.getRegistrationByConvention(g.convention.ConventionUUID).then(a=>{var f;a&&(a.Submissions?(a.Submissions.forEach((v,R)=>{v.Form||(a.Submissions[R].Form=g.forms.find(w=>w.FormUUID===v.FormUUID))}),Oe(a.Submissions)):a.Submissions=[],l.value=a,L(),D.value&&C(((f=l.value)==null?void 0:f.RegistrationUUID)||"").then(v=>{T.value=v}))})};return se(()=>g.forms,()=>{Z()}),Z(),(a,f)=>{const v=ne("router-link"),R=ne("RouterLink");return e(),s(he,{class:"elevation-5 flex-1-0 d-flex flex-column"},{default:t(()=>[r(Se,{class:"flex-1-1 align-content-start"},{default:t(()=>[_.value?(e(),s(Te,{key:0,src:_.value,title:a.convention.Name,class:"logo text-center"},null,8,["src","title"])):p("",!0),a.convention.Name?(e(),s(ee,{key:1,class:"text-center"},{default:t(()=>[n(S(a.convention.Name),1)]),_:1})):p("",!0),a.convention.Description?(e(),s(pe,{key:2,class:"text-wrap subtitle"},{default:t(()=>[m("div",{innerHTML:a.convention.Description},null,8,gt)]),_:1})):p("",!0)]),_:1}),r(oe,null,{default:t(()=>{var w,P,F;return[l.value?(e(),i("dl",St,[l.value.Reference?(e(),i("dt",ht," Badge No: ")):p("",!0),l.value.Reference?(e(),i("dd",Tt," #"+S(l.value.Reference),1)):p("",!0),k.value.length>0?(e(),i(c,{key:2},[kt,It],64)):p("",!0),(e(!0),i(c,null,Y(k.value,(o,N)=>(e(),i(c,{key:o.FormUUID},[m("dt",Ut,S(o.Heading),1),m("dd",Et,[(o==null?void 0:o.Type)===u(I).FORM_TYPE_DEALER?(e(),s(v,{key:0,to:`/register/${a.convention.Slug||a.convention.ConventionUUID}/dealer`},{default:t(()=>[o!=null&&o.State.Edit&&H.value?(e(),s(d,{key:0,size:"small",variant:"flat",color:"success",class:"ml-2"},{default:t(()=>[n(" Open form ")]),_:1})):(e(),s(d,{key:1,size:"small",variant:"text",color:"warning"},{default:t(()=>[n("View")]),_:1}))]),_:2},1032,["to"])):(o==null?void 0:o.Type)===u(I).FORM_TYPE_BADGE?(e(),s(v,{key:1,to:`/register/${a.convention.Slug||a.convention.ConventionUUID}/badge`},{default:t(()=>[o!=null&&o.State.Edit&&W.value?(e(),s(d,{key:0,size:"small",variant:"flat",color:"success",class:"ml-2"},{default:t(()=>[n(" Open form ")]),_:1})):(e(),s(d,{key:1,size:"small",variant:"text",color:"warning"},{default:t(()=>[n("View")]),_:1}))]),_:2},1032,["to"])):(o==null?void 0:o.Type)===u(I).FORM_TYPE_ADDITIONAL?(e(),s(v,{key:2,to:`/register/${a.convention.Slug||a.convention.ConventionUUID}/additional`},{default:t(()=>[o!=null&&o.State.Edit&&b.value?(e(),s(d,{key:0,size:"small",variant:"flat",color:"success",class:"ml-2"},{default:t(()=>[n(" Open form ")]),_:1})):(e(),s(d,{key:1,size:"small",variant:"text",color:"warning"},{default:t(()=>[n("View")]),_:1}))]),_:2},1032,["to"])):p("",!0)])],64))),128)),((w=l.value)==null?void 0:w.Submissions.length)>0?(e(),i(c,{key:3},[At,Dt],64)):p("",!0),(e(!0),i(c,null,Y((P=l.value)==null?void 0:P.Submissions,(o,N)=>{var q,re,ue,ce,de,me;return e(),i(c,{key:o.SubmissionUUID},[o.Form?(e(),i(c,{key:0},[o.Form?(e(),i("dt",bt,S(o.Form.Heading),1)):p("",!0),o.Form?(e(),i("dd",wt,[r(Be,{modelValue:$.value[N],"onUpdate:modelValue":E=>$.value[N]=E},{activator:t(({props:E})=>[r(d,De(E,{color:"blue-darken-2",icon:"mdi:mdi-information",variant:"text",size:"xs",onClick:Gt=>$.value[N]=!$.value[N]}),null,16,["onClick"])]),default:t(()=>[o.Status===u(V).SUBMISSION_STATUS_NULL?(e(),i(c,{key:0},[n(" There is an error with your submission, please contact the registration team for support. ")],64)):o.Status===u(V).SUBMISSION_STATUS_INCOMPLETE?(e(),i(c,{key:1},[n(" Something is missing on your submission which requires completing to be able to process your request. Please contact the registration team for further advice. ")],64)):o.Status===u(V).SUBMISSION_STATUS_OPEN?(e(),i(c,{key:2},[n(" Your submission has been received by our system but you may still make changes before the registration team begins processing it. ")],64)):o.Status===u(V).SUBMISSION_STATUS_OPEN_2?(e(),i(c,{key:3},[n(" Your submission has been received by our system but you may still make changes before the registration team begins processing it. ")],64)):o.Status===u(V).SUBMISSION_STATUS_LOCKED?(e(),i(c,{key:4},[n(" We have locked your submission to prevent further changes whilst we process it. If you need to change something please get in touch. ")],64)):o.Status===u(V).SUBMISSION_STATUS_LOCKED_2?(e(),i(c,{key:5},[n(" We have locked your submission to prevent further changes whilst we process it. If you need to change something please get in touch. ")],64)):o.Status===u(V).SUBMISSION_STATUS_ACCEPTED?(e(),i(c,{key:6},[n(" We have locked your submission to prevent further changes whilst we process it. If you need to change something please get in touch. ")],64)):o.Status===u(V).SUBMISSION_STATUS_COMPLETED?(e(),i(c,{key:7},[n(" Congratulations everything is complete. If you need to make changes please get in touch. ")],64)):o.Status===u(V).SUBMISSION_STATUS_REJECTED?(e(),i(c,{key:8},[n(" Your request has been unsuccessful. Contact the convention team for assistance. ")],64)):o.Status===u(V).SUBMISSION_STATUS_INVALID?(e(),i(c,{key:9},[n(" Your request has been identified as having errors or being incomplete. Please contact the registration team for additional support. ")],64)):o.Status===u(V).SUBMISSION_STATUS_CANCELLED?(e(),i(c,{key:10},[n(" Your submission has been cancelled. This may be at your request or another reason. The registration team will be able to provide further details. ")],64)):(e(),i(c,{key:11},[n(" Please contact the registration team for support. ")],64))]),_:2},1032,["modelValue","onUpdate:modelValue"]),n(" "+S(u(Pe)(o.Status,(q=o.Form)==null?void 0:q.Type))+" ",1),((re=o.Form)==null?void 0:re.Type)===u(I).FORM_TYPE_REGISTRATION?(e(),s(v,{key:0,to:`/register/${a.convention.Slug||a.convention.ConventionUUID}/registration`},{default:t(()=>{var E;return[(E=o.Form)!=null&&E.State.Edit&&z.value?(e(),s(d,{key:0,size:"small",variant:"text",color:"success"},{default:t(()=>[n(" Edit ")]),_:1})):(e(),s(d,{key:1,size:"small",variant:"text",color:"warning"},{default:t(()=>[n("View")]),_:1}))]}),_:2},1032,["to"])):((ue=o.Form)==null?void 0:ue.Type)===u(I).FORM_TYPE_ACCOMMODATION?(e(),s(v,{key:1,to:`/register/${a.convention.Slug||a.convention.ConventionUUID}/accommodation`},{default:t(()=>{var E;return[(E=o.Form)!=null&&E.State.Edit&&X.value?(e(),s(d,{key:0,size:"small",variant:"text",color:"success"},{default:t(()=>[n(" Edit ")]),_:1})):(e(),s(d,{key:1,size:"small",variant:"text",color:"warning"},{default:t(()=>[n("View")]),_:1}))]}),_:2},1032,["to"])):((ce=o.Form)==null?void 0:ce.Type)===u(I).FORM_TYPE_DEALER?(e(),s(v,{key:2,to:`/register/${a.convention.Slug||a.convention.ConventionUUID}/dealer`},{default:t(()=>{var E;return[(E=o.Form)!=null&&E.State.Edit&&H.value?(e(),s(d,{key:0,size:"small",variant:"text",color:"success"},{default:t(()=>[n(" Edit ")]),_:1})):(e(),s(d,{key:1,size:"small",variant:"text",color:"warning"},{default:t(()=>[n("View")]),_:1}))]}),_:2},1032,["to"])):((de=o.Form)==null?void 0:de.Type)===u(I).FORM_TYPE_BADGE?(e(),s(v,{key:3,to:`/register/${a.convention.Slug||a.convention.ConventionUUID}/badge`},{default:t(()=>{var E;return[(E=o.Form)!=null&&E.State.Edit&&W.value?(e(),s(d,{key:0,size:"small",variant:"text",color:"success"},{default:t(()=>[n(" Edit ")]),_:1})):(e(),s(d,{key:1,size:"small",variant:"text",color:"warning"},{default:t(()=>[n("View")]),_:1}))]}),_:2},1032,["to"])):((me=o.Form)==null?void 0:me.Type)===u(I).FORM_TYPE_ADDITIONAL?(e(),s(v,{key:4,to:`/register/${a.convention.Slug||a.convention.ConventionUUID}/additional`},{default:t(()=>{var E;return[(E=o.Form)!=null&&E.State.Edit&&b.value?(e(),s(d,{key:0,size:"small",variant:"text",color:"success"},{default:t(()=>[n(" Edit ")]),_:1})):(e(),s(d,{key:1,size:"small",variant:"text",color:"warning"},{default:t(()=>[n("View")]),_:1}))]}),_:2},1032,["to"])):p("",!0)])):p("",!0)],64)):p("",!0)],64)}),128)),((F=l.value)==null?void 0:F.Submissions.length)>=1?(e(!0),i(c,{key:4},Y(a.forms,o=>{var N;return e(),i(c,{key:o.FormUUID},[!((N=l.value)!=null&&N.Submissions.find(q=>q.FormUUID===o.FormUUID))&&!o.State.Independent?(e(),i(c,{key:0},[m("dt",Ct,S(o.Heading),1),m("dd",Pt,[n(" Requires Completion "),o.Type===u(I).FORM_TYPE_REGISTRATION?(e(),s(v,{key:0,to:`/register/${a.convention.Slug||a.convention.ConventionUUID}/registration`},{default:t(()=>[o.State.Edit&&z.value?(e(),s(d,{key:0,size:"small",variant:"text",color:"success"},{default:t(()=>[n(" Edit ")]),_:1})):(e(),s(d,{key:1,size:"small",variant:"text",color:"warning"},{default:t(()=>[n("View")]),_:1}))]),_:2},1032,["to"])):o.Type===u(I).FORM_TYPE_ACCOMMODATION?(e(),s(v,{key:1,to:`/register/${a.convention.Slug||a.convention.ConventionUUID}/accommodation`},{default:t(()=>[o.State.Edit&&X.value?(e(),s(d,{key:0,size:"small",variant:"text",color:"success"},{default:t(()=>[n(" Edit ")]),_:1})):(e(),s(d,{key:1,size:"small",variant:"text",color:"warning"},{default:t(()=>[n("View")]),_:1}))]),_:2},1032,["to"])):o.Type===u(I).FORM_TYPE_DEALER?(e(),s(v,{key:2,to:`/register/${a.convention.Slug||a.convention.ConventionUUID}/dealer`},{default:t(()=>[o.State.Edit&&H.value?(e(),s(d,{key:0,size:"small",variant:"text",color:"success"},{default:t(()=>[n(" Edit ")]),_:1})):(e(),s(d,{key:1,size:"small",variant:"text",color:"warning"},{default:t(()=>[n("View")]),_:1}))]),_:2},1032,["to"])):o.Type===u(I).FORM_TYPE_BADGE?(e(),s(v,{key:3,to:`/register/${a.convention.Slug||a.convention.ConventionUUID}/badge`},{default:t(()=>[o.State.Edit&&W.value?(e(),s(d,{key:0,size:"small",variant:"text",color:"success"},{default:t(()=>[n(" Edit ")]),_:1})):(e(),s(d,{key:1,size:"small",variant:"text",color:"warning"},{default:t(()=>[n("View")]),_:1}))]),_:2},1032,["to"])):o.Type===u(I).FORM_TYPE_ADDITIONAL?(e(),s(v,{key:4,to:`/register/${a.convention.Slug||a.convention.ConventionUUID}/additional`},{default:t(()=>[o.State.Edit&&b.value?(e(),s(d,{key:0,size:"small",variant:"text",color:"success"},{default:t(()=>[n(" Edit ")]),_:1})):(e(),s(d,{key:1,size:"small",variant:"text",color:"warning"},{default:t(()=>[n("View")]),_:1}))]),_:2},1032,["to"])):p("",!0)])],64)):p("",!0)],64)}),128)):p("",!0)])):p("",!0),l.value&&l.value.Submissions.length>=1&&a.forms.filter(o=>{var N;return!o.State.Independent&&!((N=l.value)!=null&&N.Submissions.find(q=>q.FormUUID==o.FormUUID))}).length>0?(e(),i("div",Ot,Ft)):p("",!0)]}),_:1}),h.value.length>0?(e(),i(c,{key:0},[r(ee,{class:"pb-0"},{default:t(()=>[n("Allocated Accommodation")]),_:1}),r(pe,{class:"text-wrap"},{default:t(()=>[n("The following accommodation has been allocated to your registration. In some cases this may not have been your first choice.")]),_:1}),r(oe,null,{default:t(()=>[r(Ge,{density:"compact"},{default:t(()=>[(e(!0),i(c,null,Y(h.value,w=>(e(),s(He,{key:w.name},{default:t(()=>[r(qe,null,{default:t(()=>[n(S(w.name),1)]),_:2},1024),(e(!0),i(c,null,Y(w.periods,P=>(e(),s(je,{key:P.start},{default:t(()=>[n(" ("+S(u(fe)(P.start))+" - "+S(u(fe)(P.end))+")",1),Vt]),_:2},1024))),128))]),_:2},1024))),128))]),_:1})]),_:1})],64)):p("",!0),D.value&&l.value?(e(),i(c,{key:1},[r(ee,{class:"pb-4"},{default:t(()=>[n("Payment Information")]),_:1}),r(oe,null,{default:t(()=>[r(yt,{"payment-transactions":T.value,registration:l.value},null,8,["payment-transactions","registration"])]),_:1})],64)):p("",!0),r(ze,null,{default:t(()=>{var w,P;return[a.convention.DetailLink?(e(),s(d,{key:0,color:"warning",href:a.convention.DetailLink,variant:"flat"},{default:t(()=>[n(S(u(ae).buttonDetails),1)]),_:1},8,["href"])):p("",!0),r(ge),z.value?(e(),i(c,{key:1},[(w=l.value)!=null&&w.Submissions.find(F=>{var o;return((o=F.Form)==null?void 0:o.Type)===u(I).FORM_TYPE_REGISTRATION})?(e(),s(R,{key:1,to:`/register/${a.convention.Slug||a.convention.ConventionUUID}`},{default:t(()=>[r(d,{color:"primary",variant:"flat"},{default:t(()=>[n(S(u(ae).buttonViewRegistration),1)]),_:1})]),_:1},8,["to"])):(e(),i(c,{key:0},[(P=a.forms.find(F=>F.Type===u(I).FORM_TYPE_REGISTRATION))!=null&&P.State.New?(e(),s(R,{key:0,to:`/register/${a.convention.Slug||a.convention.ConventionUUID}`},{default:t(()=>[r(d,{color:"success",variant:"flat"},{default:t(()=>[n(S(u(ae).buttonRegister),1)]),_:1})]),_:1},8,["to"])):p("",!0)],64))],64)):D.value&&l.value&&l.value.Total>l.value.Paid?(e(),i(c,{key:2},[r(d,{color:"success",variant:"elevated",onClick:f[0]||(f[0]=F=>M.value=!0)},{default:t(()=>[n(" Make Payment ")]),_:1}),l.value?(e(),s(tt,{key:0,"payment-transactions":T.value,registration:l.value,modelValue:M.value,"onUpdate:modelValue":f[1]||(f[1]=F=>M.value=F)},null,8,["payment-transactions","registration","modelValue"])):p("",!0)],64)):p("",!0)]}),_:1})]),_:1})}}}),Mt=_e(Nt,[["__scopeId","data-v-33d5cbe7"]]),$t=m("h3",{class:"font-weight-regular px-4"}," Convention Sticker Collection ",-1),Lt=j({__name:"Conventions",setup(g){const U=le(),O=ye(),C=A([]),_=A([]),l=A([]);return U.getOpenConventionsList().then(y=>{y&&(_.value=[..._.value,...y],U.getAvailableConventionForms(_.value.map(h=>h.ConventionUUID)).then(h=>{l.value=[...l.value,...h]}).catch(h=>{console.error(h)}),U.getAttendedConventions().then(h=>{C.value=h}))}),(y,h)=>(e(),i(c,null,[r(te,null,{default:t(()=>[r(G,{class:"justify-center"},{default:t(()=>[(e(!0),i(c,null,Y(_.value,T=>(e(),s(x,{key:T.ConventionUUID,cols:"12",sm:"11",md:"11",lg:"8",xl:"6",class:"d-flex flex-column"},{default:t(()=>[r(Mt,{convention:T,forms:l.value.filter(M=>M.ConventionUUID===T.ConventionUUID)},null,8,["convention","forms"])]),_:2},1024))),128))]),_:1})]),_:1}),C.value.length>0?(e(),s(te,{key:0,fluid:"",class:"px-0"},{default:t(()=>[r(G,{class:"bg-blue-darken-4"},{default:t(()=>[r(x,null,{default:t(()=>[$t]),_:1})]),_:1}),r(G,{class:"justify-center"},{default:t(()=>[(e(!0),i(c,null,Y(C.value,T=>(e(),s(x,{key:T.ConventionUUID,cols:"8",sm:"6",md:"4",lg:"3",xl:"2"},{default:t(()=>[r(he,{class:"elevation-5 flex-1-0 d-flex flex-column"},{default:t(()=>[r(Se,{class:"flex-1-1 align-content-start"},{default:t(()=>[r(Te,{src:u(O).GetConventionLogoURL(T.ConventionUUID),title:T.Name,class:"logo text-center"},null,8,["src","title"]),T.Name?(e(),s(ee,{key:0,class:"text-center text-wrap"},{default:t(()=>[n(S(T.Name),1)]),_:2},1024)):p("",!0)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})):p("",!0)],64))}}),Yt={};function xt(g,U){return e(),i("div")}const zt=_e(Yt,[["render",xt]]),Bt=j({__name:"MainView",emits:["pageTitle"],setup(g,{emit:U}){U("pageTitle","Scotiacon Registration System"),sessionStorage.getItem("reload")==="true"&&(sessionStorage.removeItem("reload"),setTimeout(()=>{location.reload()},500));const _=localStorage.getItem("gjt_token"),l=localStorage.getItem("ajt_token");_?(localStorage.removeItem("gjt_token"),location.href=_):l&&(localStorage.removeItem("ajt_token"),location.href=l);const y=A(ie());return(h,T)=>{const M=ne("router-link");return e(),i(c,null,[y.value&&(!y.value.Additional||!y.value.Additional.Email)?(e(),s(te,{key:0,class:"bg-red-darken-4 text-center",fluid:!0},{default:t(()=>[n(" Please enter a Contact Email on the "),r(M,{to:"/profile",class:"text-white font-weight-bold"},{default:t(()=>[n("manage account page")]),_:1}),n(" to ensure we can contact you. ")]),_:1})):p("",!0),r(Lt),r(zt)],64)}}}),Ta=j({__name:"Home",props:{loggedIn:{type:Boolean}},emits:["pageTitle"],setup(g,{emit:U}){const O=ie(),C=U;return C("pageTitle","Telegram Login"),(_,l)=>(e(),i("div",null,[_.loggedIn&&u(O)?(e(),s(Bt,{key:0,onPageTitle:l[0]||(l[0]=y=>C("pageTitle",y))})):(e(),s(Ce,{key:1}))]))}});export{Ta as default};
