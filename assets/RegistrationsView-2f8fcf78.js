import{p as Kt,n as Wt,e as re,t as Ae,c as Va,G as pt,v as t,H as P,x as Ce,I as ee,a0 as ie,a1 as Te,r as c,K as ce,w as de,M as v,N,O as a,W as F,X as w,Q as C,V as I,a4 as Z,P as V,S as B,a3 as pe,_ as ut,ac as ha,ad as Oa,E as Ge,k as ba,f as ka,d as Na,o as Ma,ae as Lt,a2 as Ye,R as La,Y as Jt,Z as Xt,aa as Ke,af as wa,ag as nt,z as Pa,u as Fa,ah as $a,A as xa,B as Ba,D as Ga,s as Ya,ai as ot,aj as wt,a7 as Ha,a6 as qa,U as ja}from"./index-ea7c22e1.js";import{T as za,V as Zt,e as Qa,d as Ka,c as Wa}from"./FormRenderer.vue_vue_type_style_index_0_lang-1e1a3184.js";import{a as Ja,F as Re}from"./form-29fd1dbb.js";import{u as et,V as ea}from"./VCheckbox-e35eb7e9.js";import{_ as tt}from"./ModelDialog.vue_vue_type_script_setup_true_lang-d8903019.js";import{h as Qe,b as ta,a as Xa,c as Za,d as Pt,P as _t,u as aa}from"./useDisplayTransactions-b2165c46.js";import{V as z,a as k}from"./VRow-ea32f96b.js";import{V as it,a as We}from"./VList-213a65dc.js";import{V as fe}from"./copyToClipboard-49ec7639.js";import{u as la,j as ve,V as gt,b as el,m as tl,k as al,c as ll,d as nl,l as ol,a as il,n as sl}from"./VContainer-97c9cf83.js";import{V as j,a as ul,u as rl}from"./VBtn-64b4c448.js";import{b as dl,c as na,d as Ft}from"./submission-6136b51d.js";import{G as yt}from"./group-d2a77946.js";import{C as Et}from"./canDo-c4127599.js";import{V as oa}from"./VAvatar-a6f6332c.js";import{s as ml}from"./sortSubmissions-8ed80f07.js";import{a as ia,V as Ne}from"./scopeId-9129f934.js";import{m as vl,k as cl,l as fl,n as Ul,o as pl,p as _l,q as gl,u as Al,r as Tl,s as yl,t as El,v as Sl,w as Dl,x as Il,y as Rl,z as $t,A as xt,B as Bt,g as sa,h as ua,c as St,d as Dt,e as It,b as Rt,V as Ct,a as ra,_ as da,j as ma,i as ke,f as At}from"./VWindowItem-ab178afd.js";import{V as Me,b as He,c as Le,d as Vt,e as he}from"./VCard-62939e09.js";import{_ as Xe,V as va}from"./SaveButton.vue_vue_type_script_setup_true_lang-99988617.js";import{V as Ue}from"./VTextField-abf852f0.js";import{_ as ca}from"./DeleteDialog.vue_vue_type_script_setup_true_lang-9d62cbc4.js";import{a as fa,V as Tt}from"./VToolbar-4aa2b4d9.js";import{V as Cl}from"./VDivider-92f007dd.js";import{v as Se}from"./v4-a960c1f4.js";import{V as Vl}from"./VTextarea-530bc3d6.js";import{V as hl,a as Ol}from"./VChip-77e293e5.js";import{V as st}from"./VDialog-bde1671c.js";import{V as bl}from"./VForm-3451141b.js";import{G as ht}from"./userData-b12f6925.js";import{V as kl,a as Nl}from"./VAlert-75c6820a.js";import{S as Ml}from"./setupLogin-fbf3bd24.js";import{V as Ll}from"./forwardRefs-a89641dd.js";import{u as ft}from"./nil-d01db1aa.js";import{V as Gt,a as wl}from"./VTable-d916afe2.js";import"./index-26b71cef.js";import"./VFileInput-c440e4e3.js";import"./createSimpleFunctional-8f2d1fe0.js";import"./VToolbarItems-e95e0a3a.js";var Ze=(e=>(e.ADMIN_LAYOUT_PANELS="ADMIN_LAYOUT_PANELS",e.ADMIN_LAYOUT_TABLE="ADMIN_LAYOUT_TABLE",e))(Ze||{});const Pl=[{title:"Panel Layout",value:"ADMIN_LAYOUT_PANELS"},{title:"Table Layout",value:"ADMIN_LAYOUT_TABLE"}];var Je=(e=>(e.LAYOUT_ITEM_SOURCE_FORM="LAYOUT_ITEM_SOURCE_FORM",e.LAYOUT_ITEM_SOURCE_META="LAYOUT_ITEM_SOURCE_META",e.LAYOUT_ITEM_SOURCE_USER="LAYOUT_ITEM_SOURCE_USER",e))(Je||{});const Fl=[{title:"Form Field Submission Data",value:"LAYOUT_ITEM_SOURCE_FORM"},{title:"Miscellaneous Data",value:"LAYOUT_ITEM_SOURCE_META"},{title:"User Profile Data",value:"LAYOUT_ITEM_SOURCE_USER"}];var te=(e=>(e.META_DATA_SOURCE_ACCOMMODATION_ALLOCATION="META_DATA_SOURCE_ACCOMMODATION_ALLOCATION",e.META_DATA_SOURCE_ACCOMMODATION_FORM="META_DATA_SOURCE_ACCOMMODATION_FORM",e.META_DATA_SOURCE_BADGE_FORM="META_DATA_SOURCE_BADGE_FORM",e.META_DATA_SOURCE_DEALER_FORM="META_DATA_SOURCE_DEALER_FORM",e.META_DATA_SOURCE_PAYMENT_STATUS="META_DATA_SOURCE_PAYMENT_STATUS",e.META_DATA_SOURCE_REGISTRATION_ACTIONS="META_DATA_SOURCE_REGISTRATION_ACTIONS",e.META_DATA_SOURCE_REGISTRATION_FORM="META_DATA_SOURCE_REGISTRATION_FORM",e.META_DATA_SOURCE_REGISTRATION_GROUP="META_DATA_SOURCE_REGISTRATION_GROUP",e.META_DATA_SOURCE_REGISTRATION_REFERENCE="META_DATA_SOURCE_REGISTRATION_REFERENCE",e.META_DATA_SOURCE_SUBMISSION_DATE="META_DATA_SOURCE_SUBMISSION_DATE",e.META_DATA_SOURCE_SUBMISSION_STATUS="META_DATA_SOURCE_SUBMISSION_STATUS",e))(te||{});const $l=[{title:"Accommodation Allocation",value:"META_DATA_SOURCE_ACCOMMODATION_ALLOCATION"},{title:"Accommodation Form",value:"META_DATA_SOURCE_ACCOMMODATION_FORM"},{title:"Actions",value:"META_DATA_SOURCE_REGISTRATION_ACTIONS"},{title:"Badge Form",value:"META_DATA_SOURCE_BADGE_FORM"},{title:"Dealer Form",value:"META_DATA_SOURCE_DEALER_FORM"},{title:"Payment Status",value:"META_DATA_SOURCE_PAYMENT_STATUS"},{title:"Registration Group",value:"META_DATA_SOURCE_REGISTRATION_GROUP"},{title:"Registration Reference",value:"META_DATA_SOURCE_REGISTRATION_REFERENCE"},{title:"Registration Form",value:"META_DATA_SOURCE_REGISTRATION_FORM"},{title:"Submission Date",value:"META_DATA_SOURCE_SUBMISSION_DATE"},{title:"Submission Status",value:"META_DATA_SOURCE_SUBMISSION_STATUS"}];var se=(e=>(e.USER_DATA_SOURCE_NULL="",e.USER_DATA_SOURCE_DISPLAY_NAME="USER_DATA_SOURCE_DISPLAY_NAME",e.USER_DATA_SOURCE_HANDLE="USER_DATA_SOURCE_HANDLE",e.USER_DATA_SOURCE_AVATAR="USER_DATA_SOURCE_AVATAR",e.USER_DATA_SOURCE_FIRST_NAME="USER_DATA_SOURCE_FIRST_NAME",e.USER_DATA_SOURCE_LAST_NAME="USER_DATA_SOURCE_LAST_NAME",e.USER_DATA_SOURCE_DATE_OF_BIRTH="USER_DATA_SOURCE_DATE_OF_BIRTH",e.USER_DATA_SOURCE_EMAIL="USER_DATA_SOURCE_EMAIL",e.USER_DATA_SOURCE_TELEGRAM="USER_DATA_SOURCE_TELEGRAM",e))(se||{});const xl=[{title:"Display Name",value:"USER_DATA_SOURCE_DISPLAY_NAME"},{title:"Handle",value:"USER_DATA_SOURCE_HANDLE"},{title:"Avatar",value:"USER_DATA_SOURCE_AVATAR"},{title:"First Name",value:"USER_DATA_SOURCE_FIRST_NAME"},{title:"Last Name",value:"USER_DATA_SOURCE_LAST_NAME"},{title:"Date of Birth",value:"USER_DATA_SOURCE_DATE_OF_BIRTH"},{title:"Email Address",value:"USER_DATA_SOURCE_EMAIL"},{title:"Telegram Username",value:"USER_DATA_SOURCE_TELEGRAM"}],Bl=e=>{switch(e){case"EMAIL_STATUS_QUEUED":return"Queued";case"EMAIL_STATUS_QUEUE_ERROR":return"Processing";case"EMAIL_STATUS_QUEUE_FAILURE":return"Internal Error";case"EMAIL_STATUS_SENDING":return"Sending";case"EMAIL_STATUS_SENT":return"Sent";case"EMAIL_STATUS_SEND_ERROR":return"Failed to Send"}return"Unknown"},Gl=e=>e===void 0?!1:Et(e,yt.GROUP_TYPE_SYSTEM).ManageUsers,Yl=Kt({itemsLength:{type:[Number,String],required:!0},...vl(),...cl(),...fl()},"VDataTableServer"),Hl=Wt()({name:"VDataTableServer",props:Yl(),emits:{"update:modelValue":e=>!0,"update:page":e=>!0,"update:itemsPerPage":e=>!0,"update:sortBy":e=>!0,"update:options":e=>!0,"update:expanded":e=>!0,"update:groupBy":e=>!0,"click:row":(e,f)=>!0},setup(e,f){let{emit:n,slots:s}=f;const{groupBy:o}=Ul(e),{sortBy:l,multiSort:u,mustSort:i}=pl(e),{page:m,itemsPerPage:A}=_l(e),p=re(()=>parseInt(e.itemsLength,10)),{columns:U,headers:r}=gl(e,{groupBy:o,showSelect:Ae(e,"showSelect"),showExpand:Ae(e,"showExpand")}),{items:d}=Al(e,U),{toggleSort:_}=Tl({sortBy:l,multiSort:u,mustSort:i,page:m}),{opened:M,isGroupOpen:Y,toggleGroup:D,extractRows:h}=yl({groupBy:o,sortBy:l}),{pageCount:L,setItemsPerPage:K}=El({page:m,itemsPerPage:A,itemsLength:p}),{flatItems:G}=Sl(d,o,M),{isSelected:W,select:ae,selectAll:g,toggleSelect:T,someSelected:S,allSelected:O}=Dl(e,{allItems:d,currentPage:d}),{isExpanded:$,toggleExpand:X}=Il(e),me=re(()=>h(d.value));Rl({page:m,itemsPerPage:A,sortBy:l,groupBy:o,search:Ae(e,"search")}),Va("v-data-table",{toggleSort:_,sortBy:l}),pt({VDataTableRows:{hideNoData:Ae(e,"hideNoData"),noDataText:Ae(e,"noDataText"),loading:Ae(e,"loading"),loadingText:Ae(e,"loadingText")}});const ne=re(()=>({page:m.value,itemsPerPage:A.value,sortBy:l.value,pageCount:L.value,toggleSort:_,setItemsPerPage:K,someSelected:S.value,allSelected:O.value,isSelected:W,select:ae,selectAll:g,toggleSelect:T,isExpanded:$,toggleExpand:X,isGroupOpen:Y,toggleGroup:D,items:me.value,groupedItems:G.value,columns:U.value,headers:r.value}));la(()=>{const[we]=$t.filterProps(e),[Pe]=xt.filterProps(e),[Fe]=Bt.filterProps(e),[$e]=Gt.filterProps(e);return t(Gt,Ce({class:["v-data-table",{"v-data-table--loading":e.loading},e.class],style:e.style},$e),{top:()=>{var _e;return(_e=s.top)==null?void 0:_e.call(s,ne.value)},default:()=>{var _e,ge,ye,qe;return s.default?s.default(ne.value):t(P,null,[(_e=s.colgroup)==null?void 0:_e.call(s,ne.value),t("thead",{class:"v-data-table__thead",role:"rowgroup"},[t(xt,Ce(Pe,{sticky:e.fixedHeader}),s)]),(ge=s.thead)==null?void 0:ge.call(s,ne.value),t("tbody",{class:"v-data-table__tbody",role:"rowgroup"},[s.body?s.body(ne.value):t(Bt,Ce(Fe,{items:G.value}),s)]),(ye=s.tbody)==null?void 0:ye.call(s,ne.value),(qe=s.tfoot)==null?void 0:qe.call(s,ne.value)])},bottom:()=>s.bottom?s.bottom(ne.value):t($t,we,{prepend:s["footer.prepend"]})})})}}),ql=w("br",null,null,-1),jl=w("h3",null,"Assigned Accommodation",-1),zl=w("br",null,null,-1),Ql=w("br",null,null,-1),Kl=w("h3",null,"Accommodation Preferences",-1),Wl=w("h3",null,"Selected Tickets",-1),Jl=w("br",null,null,-1),Xl=ee({__name:"EditAccommodationAssignmentDialog",props:ie({convention:{},registration:{},selectedAccommodation:{},title:{}},{modelValue:{type:Boolean,required:!0}}),emits:ie(["update:field"],["update:modelValue"]),setup(e,{emit:f}){const n=e,{convention:s,registration:o,title:l=""}=n,u=pe(),i=Te(e,"modelValue"),m=c({capacity:{max:g=>{var O;const T=L.value.find($=>$.room.RoomUUID===g);return!T||T.room.MaximumCapacity===0?!0:(((O=r.value)==null?void 0:O.Members.length)||0)<=T.room.MaximumCapacity||"Too many people in the group for this room"},min:g=>{var O;const T=L.value.find($=>$.room.RoomUUID===g);return!T||T.room.MinimumCapacity===0?!0:(((O=r.value)==null?void 0:O.Members.length)||0)>=T.room.MinimumCapacity||"Not enough people in the group for this room"}}}),A=c([]),p=et(n,f,void 0,void 0,"field"),U=c(ce(p.value));de(p,()=>{U.value=ce(p.value)});const r=c(),d=c(""),_=c(""),M=c([]),Y=c({Ticket:[],AddonsChecked:[],ComponentsChecked:[]}),D=async()=>{var O;const g=await u.getConventionAvailableAccommodation(s.ConventionUUID);g&&(A.value=g);const T=await u.getRegistrationGroup(o.RegistrationUUID||"");T&&(r.value=T);const S=await u.getConventionTickets(s.ConventionUUID);S&&(M.value=S);try{Y.value=JSON.parse(((O=r.value)==null?void 0:O.TicketData)||"")}catch{}};de(d,()=>{_.value=L.value.length>0?L.value[0].value:""});const h=re(()=>{const g=K.value;return A.value.map(T=>{let S;return g.forEach(O=>{T.Costs.forEach($=>{$.DateStart===(O==null?void 0:O.DateStart)&&$.DateEnd===O.DateEnd&&(S===void 0||S>$.Availability)&&(S=$.Availability)})}),{label:`${T.Name}`,title:`${T.Name} (${S} Available)`,value:T.AccommodationUUID}})}),L=re(()=>{const g=K.value,T=A.value.find(S=>S.AccommodationUUID===d.value);return(T==null?void 0:T.Pool.map(S=>{var $,X;let O;return g.forEach(me=>{S.Costs.forEach(ne=>{ne.DateStart===(me==null?void 0:me.DateStart)&&ne.DateEnd===me.DateEnd&&(O===void 0||O>ne.Availability)&&(O=ne.Availability)})}),{label:`${($=S.Venue)==null?void 0:$.Name} - ${S.Name}`,title:`${(X=S.Venue)==null?void 0:X.Name} - ${S.Name} (${O} Available)`,value:S.RoomUUID,room:S}}))||[]}),K=re(()=>[...Y.value.Ticket,...Y.value.AddonsChecked,...Y.value.ComponentsChecked].map(g=>M.value.find(T=>T.TicketUUID===g)).filter(g=>g!==void 0&&g.RequiresAccommodation)),G=g=>{var T;u.assignAccommodation(((T=r.value)==null?void 0:T.Registration.RegistrationUUID)||"",d.value,_.value,!1).then(S=>{S?(D(),g&&g("Room Assigned")):g&&g("Room not assigned")}).catch(()=>{g&&g("Room not assigned")})},W=g=>{var T,S;(T=r.value)!=null&&T.Registration.AllocationUUID?u.deleteAllocation(((S=r.value)==null?void 0:S.Registration.AllocationUUID)||"").then(O=>{O?(D(),g&&g("Allocation Deleted")):g&&g("Allocation not deleted")}).catch(()=>{g&&g("Allocation not deleted")}):g&&g("Nothing to Delete")},ae=g=>{var S,O;const T=(S=A.value.find($=>$.AccommodationUUID===g.AccommodationUUID))==null?void 0:S.Pool;if(T){const $=T.find(X=>X.RoomUUID===g.RoomUUID);if($)return`${(O=$.Venue)==null?void 0:O.Name} - ${$.Name}`}return""};return D(),(g,T)=>{var S;return v(),N(tt,{modelValue:i.value,"onUpdate:modelValue":T[2]||(T[2]=O=>i.value=O),title:F(l),color:"primary","show-close-action":!0,"show-delete-action":!!((S=r.value)!=null&&S.Registration.Allocation),"show-save-action":!!_.value,"save-button-label":"Assign Room",onDelete:W,onSave:G,fullscreen:!0,persistent:!0},{default:a(()=>[t(ve,{class:"pa-0",fluid:!0},{default:a(()=>[t(z,null,{default:a(()=>{var O;return[t(k,{cols:"12",md:"6"},{default:a(()=>{var $,X;return[w("h3",null,"Group Members ("+C(($=r.value)==null?void 0:$.Members.length)+")",1),(v(!0),I(P,null,Z((X=r.value)==null?void 0:X.Members,me=>(v(),I(P,{key:me.UUID},[V(" #"+C(me.Reference)+" "+C(me.Name),1),ql],64))),128))]}),_:1}),(O=r.value)!=null&&O.Registration.Allocation?(v(),N(k,{key:0,cols:"12",md:"6"},{default:a(()=>[jl,t(it,null,{default:a(()=>{var $;return[(v(!0),I(P,null,Z(($=r.value)==null?void 0:$.Registration.Allocation.Periods,X=>(v(),N(We,{key:X.AllocationPeriodUUID},{default:a(()=>{var me;return[V(C((me=A.value.find(ne=>ne.AccommodationUUID===X.AccommodationUUID))==null?void 0:me.Name)+" ",1),zl,V(" "+C(ae(X))+" ",1),Ql,w("small",null,"("+C(F(Qe)(X.DateStart))+" - "+C(F(Qe)(X.DateEnd))+")",1)]}),_:2},1024))),128))]}),_:1})]),_:1})):B("",!0)]}),_:1}),t(z,null,{default:a(()=>[t(k,{cols:"12",md:"6"},{default:a(()=>[g.selectedAccommodation.length?(v(),I(P,{key:0},[Kl,t(it,null,{default:a(()=>[(v(!0),I(P,null,Z(g.selectedAccommodation,(O,$)=>(v(),N(We,{key:O.AccommodationUUID},{default:a(()=>[V(C($+1)+". "+C(O.Name),1)]),_:2},1024))),128))]),_:1})],64)):B("",!0)]),_:1}),t(k,{cosl:"12",md:"6"},{default:a(()=>[Wl,t(it,null,{default:a(()=>[(v(!0),I(P,null,Z(K.value,O=>(v(),N(We,{key:O==null?void 0:O.TicketUUID},{default:a(()=>[V(C(O.Name)+" ",1),Jl,w("small",null,"("+C(F(Qe)(O.DateStart))+" - "+C(F(Qe)(O.DateEnd))+")",1)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1}),t(z,null,{default:a(()=>[t(k,{cols:"12",md:"6"},{default:a(()=>[t(fe,{modelValue:d.value,"onUpdate:modelValue":T[0]||(T[0]=O=>d.value=O),items:h.value,"item-title":"title","item-value":"value",label:"Accommodation"},null,8,["modelValue","items"])]),_:1}),t(k,{cols:"12",md:"6"},{default:a(()=>[t(fe,{modelValue:_.value,"onUpdate:modelValue":T[1]||(T[1]=O=>_.value=O),items:L.value,"item-title":"title","item-value":"value",label:"Room Pool",rules:[m.value.capacity.min,m.value.capacity.max]},null,8,["modelValue","items","rules"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue","title","show-delete-action","show-save-action"])}}}),Zl={key:0,class:"accommodationList"},en={key:0,class:"text-orange-darken-2"},tn=ee({__name:"DataTableItemAccommodation",props:{accommodations:{default:()=>[]},convention:{},forms:{},registration:{},tickets:{default:()=>[]},value:{default:""},venues:{}},setup(e){const f=c(!1),n=re(()=>{if(!e.value)return[];const o=JSON.parse(e.value),l=e.accommodations.filter(u=>o.includes(u.AccommodationUUID)).sort((u,i)=>{const m=o.findIndex(p=>p===u.AccommodationUUID),A=o.findIndex(p=>p===i.AccommodationUUID);return m>A?1:-1});return ce(l)}),s=re(()=>{let o;const l=e.forms.find(u=>u.Sections.find(i=>{var m;return(m=i.Fields)==null?void 0:m.find(A=>{var p;if(((p=A.Field)==null?void 0:p.Type)==="TICKET")return o=A,!0})}));return o?!!e.registration.Submissions.find(u=>{if(u.FormUUID==(l==null?void 0:l.FormUUID))return u.Data.find(i=>{if(i.SectionFieldUUID==(o==null?void 0:o.SectionFieldUUID)){const m=JSON.parse(i.Data);return e.tickets.filter(A=>A.RequiresAccommodation).find(A=>m.Ticket.includes(A.TicketUUID)||m.AddonsChecked.includes(A.TicketUUID)||m.ComponentsChecked.includes(A.TicketUUID))}})}):!1});return(o,l)=>s.value?(v(),I(P,{key:0},[o.value?(v(),I("ol",Zl,[(v(!0),I(P,null,Z(n.value,u=>(v(),I("li",{key:u.AccommodationUUID},[o.registration&&o.registration.Allocation&&o.registration.Allocation.Periods.find(i=>i.AccommodationUUID===u.AccommodationUUID)?(v(),I("strong",en,C(u.Name),1)):(v(),I(P,{key:1},[V(C(u.Name),1)],64))]))),128))])):B("",!0),t(j,{onClick:l[0]||(l[0]=u=>f.value=!0),variant:"flat",color:"success"},{default:a(()=>[V("Assign Accommodation")]),_:1}),o.convention&&f.value?(v(),N(Xl,{key:1,modelValue:f.value,"onUpdate:modelValue":l[1]||(l[1]=u=>f.value=u),title:"Accommodation Allocation",convention:o.convention,registration:o.registration,"selected-accommodation":n.value},null,8,["modelValue","convention","registration","selected-accommodation"])):B("",!0)],64)):B("",!0)}});const an=ut(tn,[["__scopeId","data-v-7a102d46"]]),ln={key:0,class:"addonList"},nn={key:0},on={key:0},sn=ee({__name:"DataTableItemExtras",props:{extras:{default:()=>[]},value:{default:""}},setup(e){const f=re(()=>{if(!e.value)return;const n=JSON.parse(e.value),s=Object.keys(n),o=ce(e.extras);return o.forEach(l=>{l.Options=l.Options.filter(u=>s.includes(u.OptionUUID)?(u.Choices=u.Choices.filter(i=>i.TagUUID===n[u.OptionUUID].choiceId),n[u.OptionUUID].checked):!1)}),o.filter(l=>l.Options.length>0),o});return(n,s)=>n.value?(v(),I("ul",ln,[(v(!0),I(P,null,Z(f.value,o=>(v(),I(P,{key:o.ExtraUUID},[o.Options.length?(v(),I("li",nn,[w("strong",null,C(o.Name),1),w("ul",null,[(v(!0),I(P,null,Z(o.Options,l=>(v(),I("li",{key:l.OptionUUID},[V(C(l.Name)+" ",1),l.Choices.length==1?(v(),I("small",on,"("+C(l.Choices[0].Title)+")",1)):B("",!0)]))),128))])])):B("",!0)],64))),128))])):B("",!0)}});const un=ut(sn,[["__scopeId","data-v-55786e01"]]),rn={key:0},dn=ee({__name:"DataTableItemInterests",props:{interests:{default:()=>[]},value:{default:""}},setup(e){const f=re(()=>{if(!e.value)return;const n=JSON.parse(e.value);return Object.entries(n).filter(([,s])=>s).map(([s,o])=>e.interests.find(l=>l.InterestUUID===s)).filter(s=>s!==void 0)});return(n,s)=>n.value?(v(),I("ul",rn,[(v(!0),I(P,null,Z(f.value,o=>(v(),I("li",{key:o.InterestUUID},C(o.Name),1))),128))])):B("",!0)}}),mn=w("br",null,null,-1),vn=w("small",null,"Options:",-1),cn=w("br",null,null,-1),fn=w("small",null,"Addons:",-1),Un=ee({__name:"DataTableItemTicket",props:{tickets:{default:()=>[]},value:{default:""}},setup(e){const f=re(()=>{if(!e.value)return;let n={Ticket:[],AddonsChecked:[],ComponentsChecked:[]};try{n=JSON.parse(e.value),"ticket"in n&&(n.Ticket=n.ticket),"addonsChecked"in n&&(n.AddonsChecked=n.addonsChecked),"componentsChecked"in n&&(n.ComponentsChecked=n.componentsChecked)}catch{}return n.Ticket.filter(s=>{const o=e.tickets.find(l=>l.TicketUUID===s);return!(!o||o.Type!==za.TICKET_TYPE_TICKET)}).map(s=>{const o=e.tickets.find(u=>u.TicketUUID===s),l=ce(o);return l.TicketComponents=o.TicketComponents.filter(u=>n.ComponentsChecked.includes(u.TicketUUID)),l.AddonTickets=o.AddonTickets.filter(u=>n.AddonsChecked.includes(u.TicketUUID)),l})});return(n,s)=>n.value?(v(!0),I(P,{key:0},Z(f.value,o=>(v(),I("div",{key:o.TicketUUID},[w("strong",null,C(o.Name),1),o.TicketComponents.length>0?(v(),I(P,{key:0},[mn,vn,V("  "),(v(!0),I(P,null,Z(o.TicketComponents,l=>(v(),I(P,{key:l.TicketUUID},[w("small",null,C(l.Name),1),V("  ")],64))),128))],64)):B("",!0),o.AddonTickets.length>0?(v(),I(P,{key:1},[cn,fn,V("  "),(v(!0),I(P,null,Z(o.AddonTickets,l=>(v(),I("small",{key:l.TicketUUID},[V("("),w("em",null,C(l.Name),1),V(")")]))),128))],64)):B("",!0)]))),128)):B("",!0)}}),pn={key:0,class:"text-blue text-center"},_n={key:1,class:"text-red text-center"},gn={key:2,class:"text-orange text-center"},An={key:3,class:"text-orange text-center"},Tn={key:4,class:"text-orange text-center"},yn={key:5,class:"text-orange text-center"},En={key:6,class:"text-green text-center"},Sn={key:0},Dn={key:0},In=w("strong",null,"Total:",-1),Rn=ee({__name:"RegListRow",props:{header:{},accommodations:{},convention:{},extras:{},forms:{},item:{},interests:{},tickets:{},user:{},venues:{}},emits:["openActions","openPayments","openTags","reload","showForm","switchUser"],setup(e,{emit:f}){const n=(l,u,i)=>{f("showForm",{registration:l,form:u,submission:i})},s=l=>{f("openActions",l)},o=l=>{f("switchUser",l)};return(l,u)=>l.header.type==="ACCOMMODATION"&&l.accommodations.length>0&&l.item.raw[l.header.key]?(v(),N(an,{key:0,value:l.item.raw[l.header.key].Data,accommodations:l.accommodations,convention:l.convention,forms:l.forms,tickets:l.tickets,venues:l.venues,registration:l.item.raw[l.header.key].Registration},null,8,["value","accommodations","convention","forms","tickets","venues","registration"])):l.header.type==="EXTRAS"&&l.extras.length>0?(v(),N(un,{key:1,value:l.item.raw[l.header.key],extras:l.extras},null,8,["value","extras"])):l.header.type==="INTERESTS"&&l.interests.length>0?(v(),N(dn,{key:2,value:l.item.raw[l.header.key],interests:l.interests},null,8,["value","interests"])):l.header.type==="TICKET"&&l.tickets.length>0?(v(),N(Un,{key:3,value:l.item.raw[l.header.key],tickets:l.tickets},null,8,["value","tickets"])):l.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_SUBMISSION_STATUS"||l.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_ACCOMMODATION_FORM"||l.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_DEALER_FORM"||l.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_BADGE_FORM"||l.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_REGISTRATION_FORM"?(v(!0),I(P,{key:4},Z(l.item.raw[l.header.key],i=>(v(),I("ul",{key:i.Heading},[w("li",null,[w("strong",null,C(i.Heading)+": ",1),w("span",{class:ha(F(dl)(i.Submission.Status))},C(F(na)(i.Submission.Status)),3),t(j,{icon:"mdi:mdi-form-select",title:"Edit Submitted Data",variant:"flat",onClick:m=>n(i.Registration,i.Form,i.Submission)},null,8,["onClick"])])]))),128)):l.header.type==="LAYOUT_ITEM_SOURCE_USER.USER_DATA_SOURCE_AVATAR"?(v(),N(oa,{key:5,class:"rounded-circle",src:l.item.raw[l.header.key],height:"32",width:"32"},null,8,["src"])):l.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_PAYMENT_STATUS"?(v(),I(P,{key:6},[l.item.raw[l.header.key]=="NOT_REQUIRED"?(v(),I("div",pn,"No Payment Requested")):l.item.raw[l.header.key]=="MISSING_REQUIRED"?(v(),I("div",_n,"Partner Payment Not Requested")):l.item.raw[l.header.key]=="AWAITING_PARTNER"?(v(),I("div",gn,"Awaiting Partner Payment")):l.item.raw[l.header.key]=="ALL_REQUIRED"?(v(),I("div",An,"Awaiting Payments")):l.item.raw[l.header.key]=="REQUIRED"?(v(),I("div",Tn,"Awaiting Payment")):l.item.raw[l.header.key]=="ADDITIONAL_REQUIRED"?(v(),I("div",yn,"Awaiting Additional Payments")):(v(),I("div",En,"Completed"))],64)):l.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_REGISTRATION_ACTIONS"?(v(),I(P,{key:7},[t(j,{icon:"mdi:mdi-briefcase",variant:"flat",onClick:u[0]||(u[0]=i=>s(l.item.raw[l.header.key]))}),F(Gl)(l.user)?(v(),N(j,{key:0,icon:"mdi:mdi-account-switch-outline",variant:"flat",onClick:u[1]||(u[1]=i=>o(l.item.raw[l.header.key]))})):B("",!0)],64)):l.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_REGISTRATION_GROUP"?(v(),I(P,{key:8},[l.item.raw[l.header.key].length===1?(v(),I("em",Sn," Not in a group ")):(v(),I(P,{key:1},[w("ul",null,[(v(!0),I(P,null,Z(l.item.raw[l.header.key],i=>(v(),I("li",{key:i.UUID,class:"ml-0"},[V(" #"+C(i.Reference)+" : "+C(i.Name)+" ",1),i.IsLeader?(v(),I("strong",Dn,"(Leader)")):B("",!0)]))),128))]),In,V(" "+C(l.item.raw[l.header.key].length),1)],64))],64)):(v(),I(P,{key:9},[V(C(l.item.raw[l.header.key]),1)],64))}}),Yt=ee({__name:"RegistrationActionTabs",props:ie({alignTabs:{},class:{},fixedTabs:{type:Boolean},showArrows:{type:[String,Boolean]},tabs:{}},{modelValue:{required:!0}}),emits:["update:modelValue"],setup(e){const f=e,n=Te(e,"modelValue");return(s,o)=>(v(),N(sa,Ce({modelValue:n.value,"onUpdate:modelValue":o[0]||(o[0]=l=>n.value=l)},f),{default:a(()=>[(v(!0),I(P,null,Z(s.tabs,l=>(v(),N(ua,{value:l.value,key:l.value},{default:a(()=>[V(C(l.label),1)]),_:2},1032,["value"]))),128))]),_:1},16,["modelValue"]))}}),Cn=ee({__name:"Badges",props:{convention:{},registration:{}},setup(e){const f=pe(),n=ia(),s=c([]),o=u=>{var m;const i=document.createElement("a");i.download=`${((m=e.convention)==null?void 0:m.Name)||""} Badge Image - ${e.registration.Reference} - ${e.registration.User.DisplayName}.jpg`,i.href=u,document.body.appendChild(i),i.click(),document.body.removeChild(i)},l=async u=>n.GetConBadgeImageURL(e.registration.RegistrationUUID,u);return f.getConBadgeList(e.registration.RegistrationUUID).then(u=>{u.forEach(i=>{l(i).then(m=>{s.value.push({template:i,url:m})})})}).catch(()=>{}),(u,i)=>(v(!0),I(P,null,Z(s.value,m=>(v(),N(he,{key:m.template},{default:a(()=>[t(He,null,{default:a(()=>[t(Me,null,{default:a(()=>[t(z,{class:"flex-row-reverse"},{default:a(()=>[t(k,{class:"text-wrap flex-grow-1"},{default:a(()=>[V(" Badges (#"+C(u.registration.Reference)+" "+C(u.registration.User.DisplayName)+") ",1)]),_:1})]),_:1})]),_:1})]),_:1}),t(Le,null,{default:a(()=>[t(oa,{src:m.url,height:"280",width:"280"},null,8,["src"])]),_:2},1024),t(Vt,null,{default:a(()=>[t(j,{color:"primary","prepend-icon":"mdi:mdi-download",variant:"flat",onClick:A=>o(m.url)},{default:a(()=>[V("Download")]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024))),128))}});var Vn=["onActivate","onAddUndo","onBeforeAddUndo","onBeforeExecCommand","onBeforeGetContent","onBeforeRenderUI","onBeforeSetContent","onBeforePaste","onBlur","onChange","onClearUndos","onClick","onContextMenu","onCopy","onCut","onDblclick","onDeactivate","onDirty","onDrag","onDragDrop","onDragEnd","onDragGesture","onDragOver","onDrop","onExecCommand","onFocus","onFocusIn","onFocusOut","onGetContent","onHide","onInit","onKeyDown","onKeyPress","onKeyUp","onLoadContent","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp","onNodeChange","onObjectResizeStart","onObjectResized","onObjectSelected","onPaste","onPostProcess","onPostRender","onPreProcess","onProgressState","onRedo","onRemove","onReset","onSaveContent","onSelectionChange","onSetAttrib","onSetContent","onShow","onSubmit","onUndo","onVisualAid"],hn=function(e){return Vn.map(function(f){return f.toLowerCase()}).indexOf(e.toLowerCase())!==-1},On=function(e,f,n){Object.keys(f).filter(hn).forEach(function(s){var o=f[s];typeof o=="function"&&(s==="onInit"?o(e,n):n.on(s.substring(2),function(l){return o(l,n)}))})},bn=function(e,f,n,s){var o=e.modelEvents?e.modelEvents:null,l=Array.isArray(o)?o.join(" "):o;de(s,function(u,i){n&&typeof u=="string"&&u!==i&&u!==n.getContent({format:e.outputFormat})&&n.setContent(u)}),n.on(l||"change input undo redo",function(){f.emit("update:modelValue",n.getContent({format:e.outputFormat}))})},kn=function(e,f,n,s,o,l){s.setContent(l()),n.attrs["onUpdate:modelValue"]&&bn(f,n,s,o),On(e,n.attrs,s)},Ht=0,Ua=function(e){var f=Date.now(),n=Math.floor(Math.random()*1e9);return Ht++,e+"_"+n+Ht+String(f)},Nn=function(e){return e!==null&&e.tagName.toLowerCase()==="textarea"},qt=function(e){return typeof e>"u"||e===""?[]:Array.isArray(e)?e:e.split(" ")},Mn=function(e,f){return qt(e).concat(qt(f))},Ln=function(e){return e==null},jt=function(){return{listeners:[],scriptId:Ua("tiny-script"),scriptLoaded:!1}},wn=function(){var e=jt(),f=function(o,l,u,i){var m=l.createElement("script");m.referrerPolicy="origin",m.type="application/javascript",m.id=o,m.src=u;var A=function(){m.removeEventListener("load",A),i()};m.addEventListener("load",A),l.head&&l.head.appendChild(m)},n=function(o,l,u){e.scriptLoaded?u():(e.listeners.push(u),o.getElementById(e.scriptId)||f(e.scriptId,o,l,function(){e.listeners.forEach(function(i){return i()}),e.scriptLoaded=!0}))},s=function(){e=jt()};return{load:n,reinitialize:s}},Pn=wn(),Fn=function(){return typeof window<"u"?window:global},be=function(){var e=Fn();return e&&e.tinymce?e.tinymce:null},$n={apiKey:String,cloudChannel:String,id:String,init:Object,initialValue:String,inline:Boolean,modelEvents:[String,Array],plugins:[String,Array],tagName:String,toolbar:[String,Array],modelValue:String,disabled:Boolean,tinymceScriptSrc:String,outputFormat:{type:String,validator:function(e){return e==="html"||e==="text"}}},Ee=globalThis&&globalThis.__assign||function(){return Ee=Object.assign||function(e){for(var f,n=1,s=arguments.length;n<s;n++){f=arguments[n];for(var o in f)Object.prototype.hasOwnProperty.call(f,o)&&(e[o]=f[o])}return e},Ee.apply(this,arguments)},xn=function(e,f,n,s){return e(s||"div",{id:f,ref:n})},Bn=function(e,f,n){return e("textarea",{id:f,visibility:"hidden",ref:n})},Ut={selector:void 0,target:void 0},Gn=ee({props:$n,setup:function(e,f){var n=e.init?Ee(Ee({},e.init),Ut):Ee({},Ut),s=Oa(e),o=s.disabled,l=s.modelValue,u=s.tagName,i=c(null),m=null,A=e.id||Ua("tiny-vue"),p=e.init&&e.init.inline||e.inline,U=!!f.attrs["onUpdate:modelValue"],r=!0,d=e.initialValue?e.initialValue:"",_="",M=function(h){return U?function(){return l!=null&&l.value?l.value:""}:function(){return h?d:_}},Y=function(){var h=M(r),L=Ee(Ee({},n),{readonly:e.disabled,target:i.value,plugins:Mn(n.plugins,e.plugins),toolbar:e.toolbar||n.toolbar,inline:p,setup:function(K){m=K,K.on("init",function(G){return kn(G,e,f,K,l,h)}),typeof n.setup=="function"&&n.setup(K)}});Nn(i.value)&&(i.value.style.visibility=""),be().init(L),r=!1};de(o,function(h){var L;m!==null&&(typeof((L=m.mode)===null||L===void 0?void 0:L.set)=="function"?m.mode.set(h?"readonly":"design"):m.setMode(h?"readonly":"design"))}),de(u,function(h){var L;U||(_=m.getContent()),(L=be())===null||L===void 0||L.remove(m),Ge(function(){return Y()})}),ba(function(){if(be()!==null)Y();else if(i.value&&i.value.ownerDocument){var h=e.cloudChannel?e.cloudChannel:"6",L=e.apiKey?e.apiKey:"no-api-key",K=Ln(e.tinymceScriptSrc)?"https://cdn.tiny.cloud/1/".concat(L,"/tinymce/").concat(h,"/tinymce.min.js"):e.tinymceScriptSrc;Pn.load(i.value.ownerDocument,K,Y)}}),ka(function(){be()!==null&&be().remove(m)}),p||(Na(function(){r||Y()}),Ma(function(){var h;U||(_=m.getContent()),(h=be())===null||h===void 0||h.remove(m)}));var D=function(h){var L;_=m.getContent(),(L=be())===null||L===void 0||L.remove(m),n=Ee(Ee(Ee({},n),h),Ut),Ge(function(){return Y()})};return f.expose({rerender:D,getEditor:function(){return m}}),function(){return p?xn(Lt,A,i,e.tagName):Bn(Lt,A,i)}}});const Yn=["colspan"],Hn=w("strong",null,"E-Mail Content",-1),qn=["innerHTML"],jn=ee({__name:"Communications",props:{hideHistory:{type:Boolean,default:!1},registration:{},showEditor:{type:Boolean}},emits:["close-editor"],setup(e,{emit:f}){const n=pe(),s=c([]),o=c({From:"",Subject:"",HTML:""}),l=c(""),u=c(""),i=c(""),m=c(!1),A=c([]),p=c(["1"]),U=c([]),r=c([{key:"CreatedAt",title:"Date"},{key:"Subject",title:"Subject"},{key:"User.DisplayName",title:"Sender"},{key:"Status",title:"Status"}]),d=c([{key:"CreatedAt",order:"asc"}]);de(o,D=>{i.value=D.From||i.value||"",u.value=D.Subject||u.value||"",l.value=D.HTML||l.value||""});const _=()=>{n.getRegistrationEmails(e.registration.RegistrationUUID).then(D=>{D&&(D.forEach(h=>{h.CreatedAt=ta(new Date(h.CreatedAt||"")),h.Status=Bl(h.Status),h.User||(h.User={ID:0,UserUUID:"",DisplayName:"System",Handle:"",Credentials:[],Additional:{FirstName:"",LastName:"",DOB:"",Email:""},Data:"",Groups:[],Tags:[]})}),U.value=D)})};_(),(()=>{n.getRegistrationEmailTemplates(e.registration.RegistrationUUID).then(D=>{D&&(s.value=D)})})();const Y=({callback:D})=>{n.sendRegistrationEmail(e.registration.RegistrationUUID,i.value,u.value,l.value).then(h=>{h?D&&(D("Email Sent"),_(),setTimeout(()=>{m.value=!1},2e3)):D&&D("Not sent")}).catch(()=>{D&&D("Not sent")})};return(D,h)=>(v(),I(P,null,[D.showEditor?(v(),I(P,{key:0},[t(z,null,{default:a(()=>[t(k,null,{default:a(()=>[t(Zt,{items:s.value,"item-title":"Subject","return-object":"",label:"Template","hide-details":"",modelValue:o.value,"onUpdate:modelValue":h[0]||(h[0]=L=>o.value=L),variant:"outlined"},null,8,["items","modelValue"])]),_:1})]),_:1}),t(z,null,{default:a(()=>[t(k,{cols:"12"},{default:a(()=>[t(Ue,{modelValue:i.value,"onUpdate:modelValue":h[1]||(h[1]=L=>i.value=L),label:"From",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),t(k,{cols:"12"},{default:a(()=>[t(Ue,{modelValue:u.value,"onUpdate:modelValue":h[2]||(h[2]=L=>u.value=L),label:"Subject",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),t(k,{cols:"12"},{default:a(()=>[t(F(Gn),{modelValue:l.value,"onUpdate:modelValue":h[3]||(h[3]=L=>l.value=L),"api-key":"g9sce3fktcgvk0i7sp96cahgyk4cos7q27es3ubnlal3xf3z"},null,8,["modelValue"])]),_:1})]),_:1}),t(z,null,{default:a(()=>[t(k,null,{default:a(()=>[t(Xe,{onClick:h[4]||(h[4]=L=>f("close-editor")),label:"Close E-mail Editor",color:"secondary","prepend-icon":"mdi:mdi-window-close"})]),_:1}),t(k,{class:"text-right"},{default:a(()=>[t(Xe,{onClick:Y,label:"Send",color:"error"})]),_:1})]),_:1})],64)):B("",!0),U.value.length&&!D.hideHistory?(v(),N(Ct,{key:1,class:"my-2",multiple:!0,modelValue:p.value,"onUpdate:modelValue":h[7]||(h[7]=L=>p.value=L)},{default:a(()=>[t(Rt,{value:"1"},{default:a(()=>[t(St,null,{default:a(()=>[V(" Email History ")]),_:1}),t(Dt,null,{default:a(()=>[t(F(It),{items:U.value,headers:r.value,"show-expand":!0,"item-value":"EmailUUID",expanded:A.value,"onUpdate:expanded":h[5]||(h[5]=L=>A.value=L),"sort-by":d.value,"onUpdate:sortBy":h[6]||(h[6]=L=>d.value=L)},{"expanded-row":a(({columns:L,item:K})=>[w("tr",null,[w("td",{colspan:L.length},[Hn,w("div",{class:"communicationsViewEmailPreview",innerHTML:K.raw.HTML},null,8,qn)],8,Yn)])]),"footer.prepend":a(()=>[t(j,{"prepend-icon":"mdi:mdi-refresh",color:"primary",class:"mr-4",onClick:_},{default:a(()=>[V("Refresh")]),_:1})]),_:1},8,["items","headers","expanded","sort-by"])]),_:1})]),_:1})]),_:1},8,["modelValue"])):B("",!0)],64))}});const zn=ee({__name:"Emails",props:{registration:{}},setup(e){const f=c(!1);return(n,s)=>(v(),N(he,null,{default:a(()=>[t(He,null,{default:a(()=>[t(Me,null,{default:a(()=>[V(" E-Mails (#"+C(n.registration.Reference)+" "+C(n.registration.User.DisplayName)+") ",1)]),_:1})]),_:1}),t(Le,null,{default:a(()=>[t(z,null,{default:a(()=>[t(k,{cols:"12"},{default:a(()=>[t(j,{"prepend-icon":"mdi:mdi-email",color:"primary",onClick:s[0]||(s[0]=o=>f.value=!0)},{default:a(()=>[V("Prepare Email")]),_:1})]),_:1})]),_:1}),t(jn,{registration:n.registration,"show-editor":f.value,onCloseEditor:s[1]||(s[1]=o=>f.value=!1)},null,8,["registration","show-editor"])]),_:1})]),_:1}))}}),Qn=ee({__name:"EditNoteCategoryDialog",props:ie({convention:{},noteCategory:{},title:{}},{modelValue:{type:Boolean,required:!0}}),emits:ie(["update:noteCategory"],["update:modelValue"]),setup(e,{emit:f}){const n=e,{title:s=""}=n,o=Te(e,"modelValue"),l=et(n,f,void 0,void 0,"noteCategory"),u=c(ce(l.value));de(l,()=>{u.value=ce(l.value)});const i=()=>{o.value=!1},m=()=>{u.value=ce(l.value)},A=()=>{l.value=u.value};return(p,U)=>(v(),N(tt,{modelValue:o.value,"onUpdate:modelValue":U[2]||(U[2]=r=>o.value=r),onReset:m,onSave:A,title:F(s),color:"primary",persistent:!0,fullscreen:!1,"hide-extension":!0},{default:a(()=>[t(ve,{class:"pa-0",fluid:!0},{default:a(()=>[t(z,null,{default:a(()=>[t(k,{cols:"12",sm:"6",md:"4"},{default:a(()=>[t(Ue,{modelValue:u.value.Name,"onUpdate:modelValue":U[0]||(U[0]=r=>u.value.Name=r),label:"Internal name",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),t(k,{cols:"12",sm:"6",md:"4"},{default:a(()=>[t(ra,{modelValue:u.value.Groups,"onUpdate:modelValue":U[1]||(U[1]=r=>u.value.Groups=r),convention:p.convention,label:"Groups",variant:"outlined","hide-details":""},null,8,["modelValue","convention"])]),_:1})]),_:1})]),_:1})]),actions:a(()=>[t(j,{color:"blue-darken-1",variant:"text",onClick:i},{default:a(()=>[V(" Cancel ")]),_:1}),t(j,{color:"blue-darken-1",variant:"text",onClick:m},{default:a(()=>[V(" Reset ")]),_:1}),t(Ne),t(j,{color:"blue-darken-1",variant:"text",onClick:A},{default:a(()=>[V(" Save ")]),_:1})]),_:1},8,["modelValue","title"]))}}),Kn=()=>{const e=c(""),f=()=>{const n={x:window.innerWidth,y:window.innerHeight};n.x<600?e.value="xs":n.x>=600&&n.x<960?e.value="sm":n.x>=960&&n.x<1280?e.value="md":n.x>=1280&&n.x<1920?e.value="lg":n.x>=1920&&n.x<2560?e.value="xl":n.x>=2560&&(e.value="xxl")};return window.addEventListener("resize",f),f(),e},Wn={style:{"list-style":"none"}},Jn=ee({__name:"NoteCategories",props:{hideHistory:{type:Boolean},convention:{},showEditor:{type:Boolean}},emits:["close"],setup(e,{emit:f}){const n=pe(),s=c(!1),o=c(!1),l=c(""),u=c([]),i=c([{key:"Name",title:"Name"},{key:"Groups",title:"Groups"},{key:"actions",title:"",sortable:!1}]),m=Kn();c([{key:"CreatedAt",order:"asc"}]);const A=()=>({ID:0,NoteCategoryUUID:Se(),ConventionID:e.convention.ID,ConventionUUID:e.convention.ConventionUUID,Name:"",Groups:[],Notes:[]}),p=c(-1),U=c(A()),r=c(A()),d=()=>{r.value.NoteCategoryUUID=Se(),U.value=Object.assign({},A()),p.value=-1,s.value=!0},_=G=>{p.value=u.value.indexOf(G),U.value=Object.assign({},G),s.value=!0},M=G=>{p.value=u.value.indexOf(G),U.value=Object.assign({},G),o.value=!0},Y=()=>{n.deleteNoteCategory(U.value.NoteCategoryUUID).then(G=>{G&&(u.value.splice(p.value,1),h())})},D=()=>{s.value=!1,Ge(()=>{U.value=Object.assign({},r.value),p.value=-1})},h=()=>{o.value=!1,Ge(()=>{U.value=Object.assign({},r.value),p.value=-1})},L=()=>{n.saveNoteCategory(U.value).then(G=>{G&&(p.value>-1?Object.assign(u.value[p.value],G):u.value.push(G),D())})};return(()=>{n.getNoteCategories(e.convention.ConventionUUID).then(G=>{G&&(u.value=G)})})(),(G,W)=>(v(),N(F(It),{headers:i.value,items:u.value,"sort-by":[{key:"calories",order:"asc"}],class:"elevation-1"},{top:a(()=>[t(Tt,{color:"primary"},Ye({default:a(()=>[t(fa,null,{default:a(()=>[V("Note Categories")]),_:1}),t(Cl,{class:"mx-4 d-none d-sm-inline-flex",inset:!0,vertical:!0}),t(Ne,{class:"d-none d-sm-inline-flex"}),F(m)!="xs"?(v(),N(j,{key:0,dark:"",class:"mb-2","prepend-icon":"mdi:mdi-pencil",onClick:d},{default:a(()=>[V(" New Item ")]),_:1})):B("",!0),t(j,{dark:"",class:"mb-2",icon:"mdi:mdi-window-close",onClick:W[0]||(W[0]=ae=>f("close"))}),t(ca,{modelValue:o.value,"onUpdate:modelValue":W[1]||(W[1]=ae=>o.value=ae),onDelete:Y},null,8,["modelValue"])]),_:2},[F(m)=="xs"?{name:"extension",fn:a(()=>[t(Ne),t(j,{dark:"",class:"mb-2","prepend-icon":"mdi:mdi-pencil",onClick:d},{default:a(()=>[V(" New Item ")]),_:1})]),key:"0"}:void 0]),1024),s.value?(v(),N(Qn,{key:0,modelValue:s.value,"onUpdate:modelValue":W[2]||(W[2]=ae=>s.value=ae),"note-category":U.value,"onUpdate:noteCategory":[W[3]||(W[3]=ae=>U.value=ae),L],title:l.value,convention:G.convention},null,8,["modelValue","note-category","title","convention"])):B("",!0)]),"item.Groups":a(({item:ae})=>[w("ul",Wn,[(v(!0),I(P,null,Z(ae.selectable.Groups,g=>(v(),I("li",{key:g.GroupUUID,class:"py-1"},C(g.Name),1))),128))])]),"item.actions":a(({item:ae})=>[t(gt,{size:"small",class:"me-2",onClick:g=>_(ae.raw)},{default:a(()=>[V(" mdi:mdi-pencil ")]),_:2},1032,["onClick"]),t(gt,{size:"small",onClick:g=>M(ae.raw)},{default:a(()=>[V(" mdi:mdi-delete ")]),_:2},1032,["onClick"])]),_:1},8,["headers","items"]))}}),Xn=ee({__name:"SelectNoteCategories",props:ie({convention:{},chips:{type:Boolean,default:!1},clearable:{type:Boolean,default:!1},hint:{default:""},label:{},variant:{}},{modelValue:{required:!0}}),emits:ie(["change"],["update:modelValue"]),setup(e,{emit:f}){const n=Te(e,"modelValue"),s=c([]),o=pe(),l=c([]),u=c(""),i=c(0),m=re(()=>[...l.value].map(U=>({title:U.Name,value:s.value.find(r=>r.NoteCategoryUUID===U.NoteCategoryUUID)||U})));return typeof e.convention=="object"?u.value=e.convention.ConventionUUID:u.value=e.convention||"",(async()=>{const p=[];u.value&&p.push(o.getNoteCategories(u.value));const U=await Promise.all(p);if(u.value&&U.length==1&&(l.value=U[0].sort((r,d)=>r.Name.localeCompare(d.Name))),Array.isArray(n.value))i.value=2,m.value.forEach(r=>{Array.isArray(n.value)&&n.value.find(_=>_.NoteCategoryUUID===r.value.NoteCategoryUUID)&&s.value.push(r.value)});else if(typeof n.value=="string"){i.value=1;try{const r=JSON.parse(n.value);m.value.forEach(d=>{r.find(M=>M.NoteCategoryUUID===d.value.NoteCategoryUUID)&&s.value.push(d.value)})}catch{}}})(),de(s,()=>{switch(i.value){default:case 2:{n.value=s.value,f("change");break}case 1:{n.value=JSON.stringify(s.value),f("change");break}}}),(p,U)=>(v(),N(Zt,{modelValue:s.value,"onUpdate:modelValue":U[0]||(U[0]=r=>s.value=r),chips:p.chips,multiple:"",label:p.label||"Tags",variant:p.variant||"solo",hint:p.hint,"persistent-hint":!0,clearable:p.clearable,items:m.value,"item-title":"title","item-value":"value"},null,8,["modelValue","chips","label","variant","hint","clearable","items"]))}}),Zn=ee({__name:"EditNoteDialog",props:ie({convention:{},note:{},title:{}},{modelValue:{type:Boolean,required:!0}}),emits:ie(["update:note","saved"],["update:modelValue"]),setup(e,{emit:f}){const n=e,{title:s=""}=n,o=pe(),l=Te(e,"modelValue"),u=et(n,f,void 0,void 0,"note"),i=c(ce(u.value));de(u,()=>{i.value=ce(u.value)});const m=()=>{i.value=ce(u.value)},A=p=>{i.value.NoteCategories===null&&(i.value.NoteCategories=[]),i.value.CreatedAt=void 0,i.value.DeletedAt=void 0,i.value.UpdatedAt=void 0,i.value.Admin=void 0,i.value.AdminID=void 0,i.value.AdminUUID=void 0,o.saveNote(i.value).then(U=>{U?(i.value=ce(U),p&&p("Note Saved"),u.value=i.value,f("saved",u.value)):p&&p("Internal Error Saving Note")}).catch(U=>{p&&p("Error Saving Note:"+U.ErrorMessage)})};return(p,U)=>i.value?(v(),N(tt,{key:0,"card-class":"pa-4",modelValue:l.value,"onUpdate:modelValue":U[3]||(U[3]=r=>l.value=r),onReset:m,onSave:A,title:F(s),color:"primary",persistent:!0,fullscreen:!1,"hide-extension":!0,"show-close-action":!0,"show-reset-action":!0,"show-save-action":!0},{default:a(()=>[t(ve,{class:"pa-0",fluid:!0},{default:a(()=>[t(z,null,{default:a(()=>[t(k,{cols:"12"},{default:a(()=>[t(Xn,{modelValue:i.value.NoteCategories,"onUpdate:modelValue":U[0]||(U[0]=r=>i.value.NoteCategories=r),convention:p.convention,label:"Categories",variant:"outlined","hide-details":"",chips:!0},null,8,["modelValue","convention"])]),_:1})]),_:1}),t(z,null,{default:a(()=>[t(k,{cols:"12"},{default:a(()=>[t(Ue,{modelValue:i.value.Subject,"onUpdate:modelValue":U[1]||(U[1]=r=>i.value.Subject=r),label:"Subject",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),t(k,{cols:"12"},{default:a(()=>[t(Vl,{modelValue:i.value.Description,"onUpdate:modelValue":U[2]||(U[2]=r=>i.value.Description=r),label:"Note",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue","title"])):B("",!0)}}),eo=ee({__name:"Notes",props:{convention:{},hideHistory:{type:Boolean},registration:{},showEditor:{type:Boolean}},setup(e){const f=pe(),n=()=>({ID:0,NoteUUID:Se(),Description:"",NoteCategories:[],Registration:e.registration,RegistrationID:e.registration.ID,RegistrationUUID:e.registration.RegistrationUUID,Subject:""}),s=c(!1),o=c(!1),l=c([]),u=c([]),i=c(n()),m=()=>{i.value=n(),s.value=!0},A=r=>{i.value=r,s.value=!0},p=()=>{f.getRegistrationNotes(e.registration.RegistrationUUID).then(r=>{r&&(r.forEach(d=>{d.CreatedAt=ta(new Date(d.CreatedAt||"")),d.Admin||(d.Admin={ID:0,UserUUID:"",DisplayName:"System",Handle:"",Credentials:[],Additional:{FirstName:"",LastName:"",DOB:"",Email:""},Data:"",Groups:[],Tags:[]})}),l.value=r,u.value=r.map(d=>d.NoteUUID))})},U=()=>{p(),setTimeout(()=>{s.value=!1},2e3)};return p(),(r,d)=>(v(),I(P,null,[t(he,null,{default:a(()=>[t(He,null,{default:a(()=>[t(Me,null,{default:a(()=>[t(z,{class:"flex-row-reverse"},{default:a(()=>[t(k,{class:"text-right flex-shrink-1 flex-grow-0",style:{"flex-grow":"0 !important"}},{default:a(()=>[t(j,{class:"d-sm-none",size:"xs",icon:"mdi:mdi-cog",variant:"text",color:"warning",onClick:d[0]||(d[0]=_=>o.value=!0)}),t(j,{class:"d-none d-sm-inline-flex","prepend-icon":"mdi:mdi-cog",variant:"text",color:"warning",onClick:d[1]||(d[1]=_=>o.value=!0)},{default:a(()=>[V("Categories")]),_:1})]),_:1}),t(k,{class:"text-wrap flex-grow-1"},{default:a(()=>[V(" Notes (#"+C(r.registration.Reference)+" "+C(r.registration.User.DisplayName)+") ",1)]),_:1})]),_:1})]),_:1})]),_:1}),t(Le,null,{default:a(()=>[t(Ct,{multiple:!0,variant:"accordion",modelValue:u.value,"onUpdate:modelValue":d[2]||(d[2]=_=>u.value=_)},{default:a(()=>[(v(!0),I(P,null,Z(l.value,_=>(v(),N(Rt,{key:`${_.NoteUUID}.${_.UpdatedAt}`,value:_.NoteUUID},{default:a(()=>[t(St,null,{default:a(()=>[V(C(_.Subject)+" ",1),t(hl,{class:"ml-4"},{default:a(()=>[(v(!0),I(P,null,Z(_.NoteCategories,M=>(v(),N(Ol,{key:M.NoteCategoryUUID},{default:a(()=>[V(C(M.Name),1)]),_:2},1024))),128))]),_:2},1024)]),_:2},1024),t(Dt,null,{default:a(()=>[t(z,null,{default:a(()=>[t(k,null,{default:a(()=>[V(C(_.Description),1)]),_:2},1024)]),_:2},1024),t(z,null,{default:a(()=>[t(k,null,{default:a(()=>[V(C(F(Qe)(_.UpdatedAt||""))+" ",1),_&&_.Admin&&_.Admin.DisplayName?(v(),I(P,{key:0},[V(" - "+C(_.Admin.DisplayName),1)],64)):B("",!0)]),_:2},1024),t(k,{class:"text-right"},{default:a(()=>[t(j,{color:"primary","prepend-icon":"mdi:mdi-pencil",onClick:M=>A(_)},{default:a(()=>[V("Edit")]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(Vt,null,{default:a(()=>[t(j,{color:"primary",variant:"flat",onClick:m},{default:a(()=>[V("Add Note")]),_:1})]),_:1})]),_:1}),t(st,{modelValue:s.value,"onUpdate:modelValue":d[5]||(d[5]=_=>s.value=_),title:"Create Note"},{default:a(()=>[t(Zn,{modelValue:s.value,"onUpdate:modelValue":d[3]||(d[3]=_=>s.value=_),note:i.value,"onUpdate:note":d[4]||(d[4]=_=>i.value=_),convention:r.convention,title:"Create Note",onSaved:U},null,8,["modelValue","note","convention"])]),_:1},8,["modelValue"]),t(st,{modelValue:o.value,"onUpdate:modelValue":d[7]||(d[7]=_=>o.value=_),title:"Note Configuration"},{default:a(()=>[t(Jn,{convention:r.convention,onClose:d[6]||(d[6]=_=>o.value=!1)},null,8,["convention"])]),_:1},8,["modelValue"])],64))}}),to=ee({__name:"StripeRefundPayment",props:ie({paymentTransaction:{}},{modelValue:{type:Boolean,required:!0}}),emits:ie(["refunded"],["update:modelValue"]),setup(e,{emit:f}){const n=Te(e,"modelValue"),s=pe(),o=c(!1),l=c("");let u=0;if(e.paymentTransaction.Data&&e.paymentTransaction.Data.PaymentIntent&&typeof e.paymentTransaction.Data.PaymentIntent=="object"){const r=e.paymentTransaction.Data.PaymentIntent;r&&(u=r.amount)}const i=c({Amount:u/100,Description:"",Reason:""}),m=c([{title:"Duplicate",value:"duplicate"},{title:"Fraudulent",value:"fraudulent"},{title:"Requested By Customer",value:"requested_by_customer"}]),A=c(!1);async function p(r){r.preventDefault(),A.value=!0,s.refundStripePayment(e.paymentTransaction.PaymentTransactionUUID,i.value).then(d=>{d?f("refunded",d):U("An unexpected error occurred.")}).catch(d=>{U("An error occurred processing the refund: "+d.toString())}),A.value=!1}const U=r=>{l.value=r,o.value=!0};return(r,d)=>(v(),N(tt,{modelValue:n.value,"onUpdate:modelValue":d[7]||(d[7]=_=>n.value=_),title:"Refund a Stripe Payment",color:"blue-darken-4",persistent:""},{default:a(()=>[t(ve,{class:"pa-0"},{default:a(()=>[t(bl,{ref:"refundForm",id:"refund-form",onSubmit:d[4]||(d[4]=La(_=>p(_),["prevent"]))},{default:a(()=>[t(z,null,{default:a(()=>[t(k,{cols:"12",sm:"6",md:"4",lg:"3",xl:"2"},{default:a(()=>[t(Ue,{modelValue:i.value.Amount,"onUpdate:modelValue":d[0]||(d[0]=_=>i.value.Amount=_),modelModifiers:{number:!0},label:"Amount",prefix:"£",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),t(k,{cols:"12",sm:"6",md:"8",lg:"9",xl:"10"},{default:a(()=>[t(fe,{modelValue:i.value.Reason,"onUpdate:modelValue":d[1]||(d[1]=_=>i.value.Reason=_),modelModifiers:{number:!0},items:m.value,"item-title":"title","item-value":"value",label:"Stripe Refund Reason",variant:"outlined","hide-details":""},null,8,["modelValue","items"])]),_:1}),t(k,{cols:"12"},{default:a(()=>[t(Ue,{modelValue:i.value.Description,"onUpdate:modelValue":d[2]||(d[2]=_=>i.value.Description=_),modelModifiers:{number:!0},label:"Refund Description",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1})]),_:1}),t(z,null,{default:a(()=>[t(k,{class:"text-right",cols:"12",sm:"3",md:"2",lg:"2",xl:"1"},{default:a(()=>[t(j,{color:"error",class:"w-100",onClick:d[3]||(d[3]=_=>n.value=!1)},{default:a(()=>[V("Cancel")]),_:1})]),_:1}),t(Ne),t(k,{class:"text-left",cols:"12",sm:"3",md:"2",lg:"2",xl:"1"},{default:a(()=>[t(j,{type:"submit",color:"success",class:"w-100"},Ye({default:a(()=>[V(" Issue Refund ")]),_:2},[A.value?{name:"prepend",fn:a(()=>[t(ul,{size:"20",indeterminate:""})]),key:"0"}:void 0]),1024)]),_:1})]),_:1})]),_:1},512)]),_:1}),t(va,{modelValue:o.value,"onUpdate:modelValue":d[6]||(d[6]=_=>o.value=_)},{actions:a(()=>[t(j,{variant:"text",onClick:d[5]||(d[5]=_=>o.value=!1)},{default:a(()=>[V(" Close ")]),_:1})]),default:a(()=>[V(C(l.value)+" ",1)]),_:1},8,["modelValue"])]),_:1},8,["modelValue"]))}}),ao=["colspan"],lo=w("strong",null,"Details",-1),no=["innerHTML"],oo=ee({__name:"PaymentTransactions",props:{canEdit:{type:Boolean},hideHistory:{type:Boolean},updated:{},registration:{},showEditor:{type:Boolean}},emits:["close-editor","change"],setup(e,{emit:f}){const n=e;let{hideHistory:s=!1,registration:o,showEditor:l}=n;const u=pe(),i=c([]),m=c(["1"]),A=c([]),p=c([{key:"CreatedAt",title:"Date"},{key:"Type",title:"Type"},{key:"Source",title:"Source"},{key:"Description",title:"Description"},{key:"Admin",title:"Admin"},{key:"Amount",title:"Amount"},{key:"Controls",title:""}]),U=c(!1),r=c(),d=c(!1),_=c(""),M=c([{key:"CreatedAt",order:"asc"}]),Y=()=>({PaymentTransactionUUID:Se(),Amount:0,Data:{},Description:"",ID:0,RegistrationID:o.ID,RegistrationUUID:o.RegistrationUUID,Source:Pt.PAYMENT_TRANSACTION_SOURCE_NULL,Type:_t.PAYMENT_TRANSACTION_TYPE_NULL}),D=c(Y()),{convertTransactions:h,getPaymentTransactionsDisplay:L}=aa();de(n,()=>{s=n.hideHistory,o=n.registration,l=n.showEditor,L(o.RegistrationUUID).then(g=>{A.value=g})});const K=()=>{L(o.RegistrationUUID).then(g=>{A.value=g})};K();const G=()=>{u.saveRegistrationPaymentTransaction(D.value).then(g=>{g&&(h(g.PaymentTransactions),D.value=Y(),f("close-editor"),f("change"))})},W=g=>{const T=A.value.find(S=>S.PaymentTransactionUUID===g);T&&(r.value=T.PaymentTransaction,U.value=!0)},ae=g=>{if(g)try{A.value=h(g.PaymentTransactions),r.value=void 0,U.value=!1,_.value="Refund Processed",d.value=!0,f("change")}catch(T){console.error(T)}};return(g,T)=>(v(),I(P,null,[F(l)?(v(),I(P,{key:0},[t(Me,null,{default:a(()=>[V(" Add Transaction ")]),_:1}),t(z,null,{default:a(()=>[t(k,{cols:"12",sm:"6"},{default:a(()=>[t(fe,{items:F(Xa),"item-title":"title","item-value":"value",label:"Transaction Type",clearable:!0,"hide-details":"",modelValue:D.value.Type,"onUpdate:modelValue":T[0]||(T[0]=S=>D.value.Type=S),variant:"outlined"},null,8,["items","modelValue"])]),_:1}),t(k,{cols:"12",sm:"6"},{default:a(()=>[t(fe,{items:F(Za),"item-title":"title","item-value":"value",label:"Source",clearable:!0,"hide-details":"",modelValue:D.value.Source,"onUpdate:modelValue":T[1]||(T[1]=S=>D.value.Source=S),variant:"outlined"},null,8,["items","modelValue"])]),_:1})]),_:1}),t(z,null,{default:a(()=>[t(k,{cols:"12",sm:"8",md:"10"},{default:a(()=>[t(Ue,{label:"Description","hide-details":"",modelValue:D.value.Description,"onUpdate:modelValue":T[2]||(T[2]=S=>D.value.Description=S),variant:"outlined"},null,8,["modelValue"])]),_:1}),t(k,{cols:"12",sm:"4",md:"2"},{default:a(()=>[t(Ue,{label:"Amount","prepend-inner-icon":"mdi:mdi-currency-gbp","hide-details":"",modelValue:D.value.Amount,"onUpdate:modelValue":T[3]||(T[3]=S=>D.value.Amount=S),modelModifiers:{number:!0},variant:"outlined"},null,8,["modelValue"])]),_:1})]),_:1}),t(z,null,{default:a(()=>[t(k,{cols:"12",sm:"3",md:"2",lg:"1"},{default:a(()=>[t(j,{class:"w-100",onClick:T[4]||(T[4]=S=>f("close-editor")),color:"warning"},{default:a(()=>[V("Cancel")]),_:1})]),_:1}),t(Ne),t(k,{cols:"12",sm:"6",md:"3",lg:"2",xl:"2"},{default:a(()=>[t(j,{class:"w-100",onClick:G,color:"primary"},{default:a(()=>[V("Submit Transaction")]),_:1})]),_:1})]),_:1})],64)):B("",!0),A.value.length&&!F(s)?(v(),N(Ct,{key:1,class:"my-2",modelValue:m.value,"onUpdate:modelValue":T[10]||(T[10]=S=>m.value=S)},{default:a(()=>[t(Rt,{value:"1"},{default:a(()=>[t(St,null,{default:a(()=>[V(" Transaction History ")]),_:1}),t(Dt,null,{default:a(()=>[t(F(It),{items:A.value,headers:p.value,"show-expand":!1,"item-value":"PaymentTransactionUUID",expanded:i.value,"onUpdate:expanded":T[5]||(T[5]=S=>i.value=S),"sort-by":M.value,"onUpdate:sortBy":T[6]||(T[6]=S=>M.value=S),class:"transactionTable"},{"item.Controls":a(({item:S})=>[g.canEdit&&S.raw.PaymentTransaction.Source===F(Pt).PAYMENT_TRANSACTION_SOURCE_STRIPE&&S.raw.PaymentTransaction.Type===F(_t).PAYMENT_TRANSACTION_TYPE_PAYMENT?(v(),N(j,{key:0,icon:"mdi:mdi-credit-card-refund",variant:"text",size:"xs",onClick:O=>W(S.key)},null,8,["onClick"])):B("",!0)]),"expanded-row":a(({columns:S,item:O})=>[w("tr",null,[w("td",{colspan:S.length},[lo,w("div",{innerHTML:O.raw.HTML},null,8,no)],8,ao)])]),"footer.prepend":a(()=>[t(j,{"prepend-icon":"mdi:mdi-refresh",color:"primary",class:"mr-4",onClick:K},{default:a(()=>[V("Refresh")]),_:1})]),_:1},8,["items","headers","expanded","sort-by"]),U.value&&r.value?(v(),N(to,{key:0,modelValue:U.value,"onUpdate:modelValue":T[7]||(T[7]=S=>U.value=S),"payment-transaction":r.value,onRefunded:ae},null,8,["modelValue","payment-transaction"])):B("",!0),t(va,{modelValue:d.value,"onUpdate:modelValue":T[9]||(T[9]=S=>d.value=S)},{actions:a(()=>[t(j,{variant:"text",onClick:T[8]||(T[8]=S=>d.value=!1)},{default:a(()=>[V(" Close ")]),_:1})]),default:a(()=>[V(C(_.value)+" ",1)]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])):B("",!0)],64))}});const io=(e=void 0,f)=>e===void 0?!1:Et(e,yt.GROUP_TYPE_CONVENTION,f.ConventionUUID,f).EditPaymentTransactions,rt=e=>(Jt("data-v-861debd5"),e=e(),Xt(),e),so={class:"mb-4"},uo={class:"v-row"},ro={key:0,class:"v-col v-col-10 py-1 v-row mx-0 pl-0"},mo={class:"v-col v-col-12 v-col-sm-4 v-col-md-3 font-weight-bold pb-0 pr-0"},vo={class:"v-col v-col-12 v-col-sm-8 v-col-md-9 font-italic pt-0 pt-sm-3 pb-sm-0 pl-sm-0"},co={class:"v-col v-col-2 align-self-end text-right py-1 text-no-wrap"},fo=rt(()=>w("dt",{class:"v-col v-col-9 py-1 font-weight-bold totals"}," Total Charges ",-1)),Uo={class:"v-col v-col-3 align-self-end text-right py-1 totals text-no-wrap"},po=rt(()=>w("dt",{class:"v-col v-col-9 py-1 font-weight-bold"}," Applied Total ",-1)),_o={class:"v-col v-col-3 align-self-end text-right py-1 text-no-wrap"},go=rt(()=>w("dt",{class:"v-col v-col-9 py-1 font-weight-bold"}," Currently Paid ",-1)),Ao={class:"v-col v-col-3 align-self-end text-right py-1 text-no-wrap"},To=rt(()=>w("dt",{class:"v-col v-col-9 py-1 font-weight-bold totals"}," Balance ",-1)),yo={class:"v-col v-col-3 align-self-end text-right py-1 totals text-no-wrap"},Eo=ee({__name:"PaymentActions",props:ie({forms:{},title:{}},{modelValue:{required:!0}}),emits:["update:modelValue"],setup(e){const f=c(!1),n=c(),s=c([]),o=c(new Date().getTime()),l=c(!1),u=Te(e,"modelValue"),i=c(ce(u.value));de(u,()=>{i.value=ce(u.value)});const m=pe();m.getConvention(u.value.ConventionUUID).then(r=>{r&&(l.value=io(ht(),r))});const A=()=>{m.generateRegistrationCharges(u.value.RegistrationUUID,!1).then(r=>{r&&(s.value=r.PaymentTransactions,n.value=r.Registration,o.value=new Date().getTime())}).catch(()=>{})};A();const p=()=>{m.generateRegistrationCharges(u.value.RegistrationUUID,!0).then(r=>{r&&(s.value=r.PaymentTransactions,n.value=r.Registration,o.value=new Date().getTime())})},{totalCharges:U}=aa();return(r,d)=>(v(),N(he,null,{default:a(()=>[t(He,null,{default:a(()=>[t(Me,null,{default:a(()=>[V(" Payments (#"+C(u.value.Reference)+" "+C(u.value.User.DisplayName)+") ",1)]),_:1})]),_:1}),t(Le,null,{default:a(()=>[n.value?(v(),I(P,{key:0},[w("h3",so,"#"+C(n.value.Reference)+" "+C(n.value.User.DisplayName),1),w("dl",uo,[(v(!0),I(P,null,Z(s.value,_=>(v(),I(P,{key:_.PaymentTransactionUUID},[_.Type===F(_t).PAYMENT_TRANSACTION_TYPE_CHARGE?(v(),I("dt",ro,[w("div",mo,C(_.Description.split(":")[0])+": ",1),w("div",vo,C(_.Description.split(":")[1]),1)])):B("",!0),w("dd",co," £"+C(_.Amount),1)],64))),128)),fo,w("dd",Uo," £"+C(F(U)(s.value)),1),po,w("dd",_o," £"+C(n.value.Total),1),go,w("dd",Ao," £"+C(n.value.Paid),1),To,w("dd",yo," £"+C(n.value.Total-n.value.Paid),1)]),t(z,{class:"flex-row-reverse"},{default:a(()=>[t(k,{class:"text-right"},{default:a(()=>[t(j,{color:"primary",onClick:p},{default:a(()=>[V("Apply Charges")]),_:1})]),_:1}),!f.value&&l.value?(v(),N(k,{key:0},{default:a(()=>[t(j,{color:"secondary",onClick:d[0]||(d[0]=_=>f.value=!0)},{default:a(()=>[V("Transaction Entry")]),_:1})]),_:1})):B("",!0)]),_:1})],64)):B("",!0),t(oo,{"can-edit":l.value,registration:u.value,"show-editor":f.value,onCloseEditor:d[1]||(d[1]=_=>f.value=!1),updated:o.value,onChange:A},null,8,["can-edit","registration","show-editor","updated"])]),_:1})]),_:1}))}});const So=ut(Eo,[["__scopeId","data-v-861debd5"]]),Do=ee({__name:"RegistrationFormStatus",props:ie({forms:{}},{modelValue:{required:!0}}),emits:["update:modelValue"],setup(e){const f=pe(),n=Te(e,"modelValue"),s=(o,l)=>{const u=n.value.Submissions.find(i=>i.SubmissionUUID==l);if(!u){o&&o("Submission not found");return}f.setSubmissionStatus(l,u.Status).then(i=>{i?(n.value.Submissions.forEach((m,A)=>{n.value.Submissions[A].Status=m.Status}),o&&o("Status Saved")):o&&o("Status not saved")}).catch(()=>{o&&o("Status not saved")})};return(o,l)=>(v(),N(he,null,{default:a(()=>[t(He,null,{default:a(()=>[t(Me,null,{default:a(()=>[V("Status (#"+C(n.value.Reference)+" "+C(n.value.User.DisplayName)+")",1)]),_:1})]),_:1}),t(Le,null,{default:a(()=>[t(it,null,{default:a(()=>[(v(!0),I(P,null,Z(n.value.Submissions,u=>(v(),N(We,{key:u.SubmissionUUID,class:"pa-0"},{default:a(()=>[t(z,{class:"py-2 align-center"},{default:a(()=>[t(k,{cols:"9",sm:"10",md:"10",lg:"9"},{default:a(()=>{var i;return[t(fe,{modelValue:u.Status,"onUpdate:modelValue":m=>u.Status=m,items:F(Ft),"item-text":"title","item-value":"value",variant:"outlined","hide-details":"",label:((i=o.forms.find(m=>m.FormUUID==u.FormUUID))==null?void 0:i.Name)||""},{selection:a(()=>[t(gt,{class:"mr-4 d-none d-sm-inline"},{default:a(()=>{var m;return[V(C((m=F(Ft).find(A=>A.value===u.Status))==null?void 0:m.icon),1)]}),_:2},1024),V(" "+C(F(na)(u.Status)),1)]),item:a(({item:m,props:{onClick:A}})=>[t(We,{title:m.title,"prepend-icon":m.raw.icon,onClick:A},null,8,["title","prepend-icon","onClick"])]),_:2},1032,["modelValue","onUpdate:modelValue","items","label"])]}),_:2},1024),t(k,{cols:"3",sm:"2",md:"2",lg:"1"},{default:a(()=>[t(Xe,{class:"d-none d-sm-inline-flex",title:"Save","prepend-icon":"mdi:mdi-content-save",color:"warning",onClick:i=>s(i.callback,u.SubmissionUUID)},null,8,["onClick"]),t(Xe,{class:"d-sm-none",size:"35",icon:"mdi:mdi-content-save",color:"warning",onClick:i=>s(i.callback,u.SubmissionUUID)},null,8,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1}))}}),Io=e=>(Jt("data-v-a4024c39"),e=e(),Xt(),e),Ro=Io(()=>w("p",null,"Any tags controlled through registration form fields will be reset when the applicable form is saved. If you don't know what you're doing here, don't touch!",-1)),Co={class:"mb-4"},Vo=ee({__name:"RegistrationTags",props:ie({title:{}},{modelValue:{required:!0}}),emits:["update:modelValue"],setup(e){const f=pe(),n=Te(e,"modelValue"),s=c(ce(n.value)),o=c(!1),l=c(s.value.Tags);de(n,()=>{s.value=ce(n.value)});const u=({callback:i})=>{const m=[],A=[];s.value.Tags.forEach(p=>{l.value.find(r=>r.TagUUID===p.TagUUID)||m.push(p.TagUUID)}),l.value.forEach(p=>{s.value.Tags.find(r=>p.TagUUID===r.TagUUID)||A.push(p.TagUUID)}),f.updateRegistrationTags(m,A,s.value.RegistrationUUID).then(p=>{p?i&&(i("Tags Saved"),n.value.Tags=p.Tags):i&&i("Error Saving Tags")}).catch(()=>{i&&i("Error Saving Tags")})};return(i,m)=>(v(),N(he,null,{default:a(()=>[t(He,null,{default:a(()=>[t(Me,null,{default:a(()=>[V("Tags (#"+C(s.value.Reference)+" "+C(s.value.User.DisplayName)+")",1)]),_:1})]),_:1}),t(Le,null,{default:a(()=>[t(kl,{class:"my-4"},{default:a(()=>[t(Nl,null,{default:a(()=>[V("Caution")]),_:1}),Ro]),_:1}),w("h3",Co,"#"+C(s.value.Reference)+" "+C(s.value.User.DisplayName),1),t(da,{modelValue:s.value.Tags,"onUpdate:modelValue":m[0]||(m[0]=A=>s.value.Tags=A),convention:s.value.ConventionUUID,"show-key":!0,chips:!0,"show-uuid":o.value},null,8,["modelValue","convention","show-uuid"])]),_:1}),t(Vt,{class:"px-4 align-start"},{default:a(()=>[t(ea,{label:"Show UUID",modelValue:o.value,"onUpdate:modelValue":m[1]||(m[1]=A=>o.value=A)},null,8,["modelValue"]),t(Xe,{onClick:u,variant:"flat"})]),_:1})]),_:1}))}});const ho=ut(Vo,[["__scopeId","data-v-a4024c39"]]),zt=ee({__name:"RegistrationActionWindows",props:ie({accommodations:{},convention:{},extras:{},forms:{},interests:{},registration:{},tickets:{},venues:{}},{modelValue:{required:!0}}),emits:ie(["update:registration"],["update:modelValue"]),setup(e,{emit:f}){const n=e,s=Te(e,"modelValue"),o=et(n,f,void 0,void 0,"registration");return(l,u)=>(v(),N(ma,{modelValue:s.value,"onUpdate:modelValue":u[3]||(u[3]=i=>s.value=i)},{default:a(()=>[t(ke,{value:"badges"},{default:a(()=>[s.value=="badges"?(v(),N(ve,{key:0,class:"pa-0 mx-0",fluid:!0},{default:a(()=>[t(Cn,{convention:l.convention,registration:F(o)},null,8,["convention","registration"])]),_:1})):B("",!0)]),_:1}),t(ke,{value:"emails"},{default:a(()=>[s.value=="emails"?(v(),N(ve,{key:0,class:"pa-0 mx-0",fluid:!0},{default:a(()=>[t(zn,{registration:F(o)},null,8,["registration"])]),_:1})):B("",!0)]),_:1}),t(ke,{value:"notes"},{default:a(()=>[s.value=="notes"?(v(),N(ve,{key:0,class:"pa-0 mx-0",fluid:!0},{default:a(()=>[t(eo,{convention:l.convention,registration:F(o)},null,8,["convention","registration"])]),_:1})):B("",!0)]),_:1}),t(ke,{value:"payments"},{default:a(()=>[s.value=="payments"?(v(),N(ve,{key:0,class:"pa-0 mx-0",fluid:!0},{default:a(()=>[t(So,{modelValue:F(o),"onUpdate:modelValue":u[0]||(u[0]=i=>Ke(o)?o.value=i:null),forms:l.forms,title:"Registration Payments"},null,8,["modelValue","forms"])]),_:1})):B("",!0)]),_:1}),t(ke,{value:"status"},{default:a(()=>[s.value=="status"?(v(),N(ve,{key:0,class:"pa-0 mx-0",fluid:!0},{default:a(()=>[t(Do,{modelValue:F(o),"onUpdate:modelValue":u[1]||(u[1]=i=>Ke(o)?o.value=i:null),forms:l.forms},null,8,["modelValue","forms"])]),_:1})):B("",!0)]),_:1}),t(ke,{value:"tags"},{default:a(()=>[s.value=="tags"?(v(),N(ve,{key:0,class:"pa-0 mx-0",fluid:!0},{default:a(()=>[t(ho,{modelValue:F(o),"onUpdate:modelValue":u[2]||(u[2]=i=>Ke(o)?o.value=i:null),title:"Registration Tags"},null,8,["modelValue"])]),_:1})):B("",!0)]),_:1})]),_:1},8,["modelValue"]))}}),Oo=(e,f)=>e===void 0?!1:Et(e,yt.GROUP_TYPE_CONVENTION,f.ConventionUUID,f).ViewPaymentTransactions,Qt=ee({__name:"RegistrationActions",props:ie({accommodations:{},convention:{},extras:{},forms:{},interests:{},registration:{},tickets:{},title:{},useDialog:{type:Boolean},venues:{}},{modelValue:{type:Boolean,required:!0}}),emits:ie(["update:registration"],["update:modelValue"]),setup(e,{emit:f}){const n=e,s=Te(e,"modelValue"),o=et(n,f,void 0,void 0,"registration"),l=c("notes"),u=ht(),i=[{label:"Badge",value:"badges"},{label:"Emails",value:"emails"},{label:"Notes",value:"notes"},{label:"Status",value:"status"},{label:"Tags",value:"tags"}];return Oo(u,n.convention)&&i.splice(2,0,{label:"Payments",value:"payments"}),(m,A)=>m.useDialog?(v(),N(tt,{key:0,modelValue:s.value,"onUpdate:modelValue":A[3]||(A[3]=p=>s.value=p),title:m.title,"show-close-action":!0,color:"primary","close-action-label":"Close",persistent:!0,"retain-focus":!1,scrollable:!0,fullscreen:"","card-class":"ma-0 pa-0"},{extension:a(()=>[t(Yt,{modelValue:l.value,"onUpdate:modelValue":A[0]||(A[0]=p=>l.value=p),tabs:i,"show-arrows":!0},null,8,["modelValue"])]),default:a(()=>[t(zt,{modelValue:l.value,"onUpdate:modelValue":A[1]||(A[1]=p=>l.value=p),registration:F(o),"onUpdate:registration":A[2]||(A[2]=p=>Ke(o)?o.value=p:null),accommodations:m.accommodations,convention:m.convention,extras:m.extras,forms:m.forms,interests:m.interests,tabs:i,tickets:m.tickets,venues:m.venues},null,8,["modelValue","registration","accommodations","convention","extras","forms","interests","tickets","venues"])]),_:1},8,["modelValue","title"])):(v(),I(P,{key:1},[t(Yt,{modelValue:l.value,"onUpdate:modelValue":A[4]||(A[4]=p=>l.value=p),tabs:i,"show-arrows":!0},null,8,["modelValue"]),t(zt,{modelValue:l.value,"onUpdate:modelValue":A[5]||(A[5]=p=>l.value=p),registration:F(o),"onUpdate:registration":A[6]||(A[6]=p=>Ke(o)?o.value=p:null),accommodations:m.accommodations,convention:m.convention,extras:m.extras,forms:m.forms,interests:m.interests,tabs:i,tickets:m.tickets,venues:m.venues},null,8,["modelValue","registration","accommodations","convention","extras","forms","interests","tickets","venues"])],64))}});const bo=(e,f=500,n=!1)=>{let s;return(...o)=>{const u=function(){s=void 0,n||e.apply(void 0,o)},i=n&&!s;clearTimeout(s),s=setTimeout(u,f),i&&e.apply(void 0,o)}},ko=ee({__name:"EditAdminLayout",props:{modelValue:{required:!0}},emits:ie(["change","delete"],["update:modelValue"]),setup(e,{emit:f}){const n=Te(e,"modelValue"),s=c([]),o=pe(),l=c(`
Are you sure you wish to delete this layout? All panels relating to it will be
removed and can not be recovered. This action can not be undone once saved.
You will have to create a new layout.
`),u=c(!1),i=()=>({ID:0,LayoutPanelUUID:Se(),AdminLayoutID:n.value.ID,AdminLayoutUUID:n.value.AdminLayoutUUID,Name:"",Order:n.value.Panels.length+1,Items:[],RequiredFormType:Re.FORM_TYPE_NIL,RequiredGroupMemberships:[],RequiredRegistrationTags:[]}),m=U=>()=>({ID:0,LayoutItemUUID:Se(),LayoutPanelID:U.ID,LayoutPanelUUID:U.LayoutPanelUUID,Label:"",SourceType:Je.LAYOUT_ITEM_SOURCE_FORM,SectionFieldID:void 0,SectionFieldUUID:void 0,SectionField:void 0,MetaField:void 0,UserField:void 0,Align:"",Order:U.Items.length+1,DefaultSort:!1}),A=U=>{const r=s.value.find(d=>d.value===U.SectionFieldUUID);r&&(U.SectionFieldID=r.object.ID,U.SectionField=r.object)};o.getConventionForms(n.value.ConventionUUID).then(U=>{U.forEach(r=>r.Sections.forEach(d=>d.Fields&&s.value.push(...d.Fields.map(_=>{var Y;return{title:`${r.Name} - ${d.Name} - ${(Y=_.Field)==null?void 0:Y.Name}`,value:_.SectionFieldUUID,object:_}})))),s.value.sort(Qa("title"))});const p=re(()=>{switch(n.value.Type){case Ze.ADMIN_LAYOUT_PANELS:return"Panels";case Ze.ADMIN_LAYOUT_TABLE:return"Tabs"}return"Unknown"});return de(n,()=>{f("change")},{deep:!0}),(U,r)=>(v(),N(ve,{class:"px-0 mx-0",fluid:!0},{default:a(()=>[t(z,null,{default:a(()=>[t(k,{cols:"12",sm:"6"},{default:a(()=>[t(Ue,{modelValue:n.value.Name,"onUpdate:modelValue":r[0]||(r[0]=d=>n.value.Name=d),label:"Name",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),t(k,{cols:"12",sm:"6"},{default:a(()=>[t(fe,{modelValue:n.value.Type,"onUpdate:modelValue":r[1]||(r[1]=d=>n.value.Type=d),label:"Layout Type",items:F(Pl),"item-title":"title","item-value":"value",variant:"outlined","hide-details":""},null,8,["modelValue","items"])]),_:1})]),_:1}),t(z,null,{default:a(()=>[t(k,null,{default:a(()=>[t(At,{modelValue:n.value.Panels,"onUpdate:modelValue":r[2]||(r[2]=d=>n.value.Panels=d),"new-item":i,closeable:!1,title:p.value,label:"Name","slot-name-prefix":"panel"},Ye({_:2},[Z(n.value.Panels,(d,_)=>({name:`panel_${_}`,fn:a(()=>[t(ve,{class:"px-0 mx-0",fluid:!0},{default:a(()=>[t(z,null,{default:a(()=>[t(k,{cols:"12",sm:"6"},{default:a(()=>[t(Ue,{modelValue:d.Name,"onUpdate:modelValue":M=>d.Name=M,label:"Name",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),t(k,{cols:"12",sm:"6"},{default:a(()=>[t(fe,{modelValue:d.RequiredFormType,"onUpdate:modelValue":M=>d.RequiredFormType=M,items:F(Ja),clearable:!0,label:"Required Form",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"])]),_:2},1024)]),_:2},1024),t(z,null,{default:a(()=>[t(k,{cols:"12",sm:"6"},{default:a(()=>[t(ra,{label:"Required Groups",variant:"outlined",modelValue:d.RequiredGroupMemberships,"onUpdate:modelValue":M=>d.RequiredGroupMemberships=M,convention:n.value.ConventionUUID,chips:"",clearable:"",hint:"Groups that a user must be in to see this form. (Any one)"},null,8,["modelValue","onUpdate:modelValue","convention"])]),_:2},1024),t(k,{cols:"12",sm:"6"},{default:a(()=>[t(da,{label:"Registration Tags",variant:"outlined",modelValue:d.RequiredRegistrationTags,"onUpdate:modelValue":M=>d.RequiredRegistrationTags=M,convention:n.value.ConventionUUID,chips:"",clearable:"",hint:"Tags that a registration must have to appear in results. (Any one)"},null,8,["modelValue","onUpdate:modelValue","convention"])]),_:2},1024)]),_:2},1024)]),_:2},1024),t(At,{modelValue:d.Items,"onUpdate:modelValue":M=>d.Items=M,"new-item":m(d),closeable:!1,title:"Items",label:"Label","slot-name-prefix":"item"},Ye({_:2},[Z(d.Items,(M,Y)=>({name:`item_${Y}`,fn:a(()=>[t(ve,{class:"px-0 mx-0",fluid:!0},{default:a(()=>[t(z,null,{default:a(()=>[t(k,{cols:"12",sm:"6"},{default:a(()=>[t(Ue,{modelValue:M.Label,"onUpdate:modelValue":D=>M.Label=D,label:"Name",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024),t(z,null,{default:a(()=>[t(k,{cols:"12",sm:"6"},{default:a(()=>[t(fe,{modelValue:M.SourceType,"onUpdate:modelValue":D=>M.SourceType=D,label:"Source Type",items:F(Fl),"item-title":"title","item-value":"value",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"])]),_:2},1024),t(k,{cols:"12",sm:"6"},{default:a(()=>[M.SourceType==="LAYOUT_ITEM_SOURCE_FORM"?(v(),N(fe,{key:0,modelValue:M.SectionFieldUUID,"onUpdate:modelValue":D=>M.SectionFieldUUID=D,label:"Form Data",items:s.value,"item-title":"title","item-value":"value",variant:"outlined","hide-details":"",onBlur:D=>A(M)},null,8,["modelValue","onUpdate:modelValue","items","onBlur"])):M.SourceType==="LAYOUT_ITEM_SOURCE_META"?(v(),N(fe,{key:1,modelValue:M.MetaField,"onUpdate:modelValue":D=>M.MetaField=D,label:"Miscellaneous Data",items:F($l),"item-title":"title","item-value":"value",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"])):M.SourceType==="LAYOUT_ITEM_SOURCE_USER"?(v(),N(fe,{key:2,modelValue:M.UserField,"onUpdate:modelValue":D=>M.UserField=D,label:"User Profile Data",items:F(xl),"item-title":"title","item-value":"value",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"])):B("",!0)]),_:2},1024)]),_:2},1024),t(z,null,{default:a(()=>[t(k,null,{default:a(()=>[t(ea,{modelValue:M.DefaultSort,"onUpdate:modelValue":D=>M.DefaultSort=D,label:"Default Sort","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)]),_:2},1024)])}))]),1032,["modelValue","onUpdate:modelValue","new-item"])])}))]),1032,["modelValue","title"])]),_:1})]),_:1}),t(z,null,{default:a(()=>[t(k,null,{default:a(()=>[t(j,{onClick:r[3]||(r[3]=d=>u.value=!0),"prepend-icon":"mdi:mdi-delete",color:"red-darken-4"},{default:a(()=>[V("Delete Layout")]),_:1})]),_:1})]),_:1}),u.value?(v(),N(ca,{key:0,modelValue:u.value,"onUpdate:modelValue":r[4]||(r[4]=d=>u.value=d),message:l.value,title:"Delete Layout",subtitle:"Removes this layout and all it's panels",onDelete:r[5]||(r[5]=d=>f("delete"))},null,8,["modelValue","message"])):B("",!0)]),_:1}))}}),No=ee({__name:"EditAdminLayouts",props:ie({title:{},convention:{}},{modelValue:{type:Boolean,required:!0}}),emits:ie(["save"],["update:modelValue"]),setup(e,{emit:f}){const n=Te(e,"modelValue"),s=c([]),o=c([]),l=c([]),u=pe(),i=()=>({ID:0,AdminLayoutUUID:Se(),ConventionID:e.convention.ID,ConventionUUID:e.convention.ConventionUUID,Name:"New Layout",Type:Ze.ADMIN_LAYOUT_PANELS,Panels:[]}),m=()=>{let p=!1;[...new Set(l.value)].forEach(r=>{const d=s.value.findIndex(_=>_.AdminLayoutUUID===r);d<0||d>=s.value.length||(u.saveAdminLayout(s.value[d]).then(_=>{_&&s.value.splice(d,1,_)}).catch(()=>{}),p=!0)}),o.value.forEach(r=>{u.deleteAdminLayout(r).catch(()=>{})}),o.value=[],l.value=[],p&&f("save")},A=p=>{const U=s.value.findIndex(r=>r.AdminLayoutUUID===p.AdminLayoutUUID);U<0||U>=s.value.length||(s.value[U].ID>0&&o.value.push(p.AdminLayoutUUID),s.value.splice(U,1))};return u.getConventionAdminLayouts(e.convention.ConventionUUID).then(p=>{p&&(s.value=p)}).catch(()=>[]),(p,U)=>(v(),N(st,{modelValue:n.value,"onUpdate:modelValue":U[2]||(U[2]=r=>n.value=r),scrollable:!0,"retain-focus":!0,persistent:!0,fullscreen:!0},{default:a(()=>[t(At,{modelValue:s.value,"onUpdate:modelValue":U[0]||(U[0]=r=>s.value=r),"new-item":i,closeable:!0,"show-delete":!1,"show-save":!0,"has-order":!1,title:p.title,label:"Name","slot-name-prefix":"panel",onClose:U[1]||(U[1]=r=>n.value=!1),onSave:m},Ye({_:2},[Z(s.value,(r,d)=>({name:`panel_${d}`,fn:a(()=>[t(ve,{class:"px-0 mx-0",fluid:!0},{default:a(()=>[t(z,null,{default:a(()=>[t(k,{cols:"12"},{default:a(()=>[t(ko,{modelValue:s.value[d],"onUpdate:modelValue":_=>s.value[d]=_,onChange:_=>l.value.push(r.AdminLayoutUUID),onDelete:_=>A(r)},null,8,["modelValue","onUpdate:modelValue","onChange","onDelete"])]),_:2},1024)]),_:2},1024)]),_:2},1024)])}))]),1032,["modelValue","title"])]),_:1},8,["modelValue"]))}});function Mo(){const e=c([]);wa(()=>e.value=[]);function f(n,s){e.value[s]=n}return{refs:e,updateRef:f}}const Lo=Kt({activeColor:String,start:{type:[Number,String],default:1},modelValue:{type:Number,default:e=>e.start},disabled:Boolean,length:{type:[Number,String],default:1,validator:e=>e%1===0},totalVisible:[Number,String],firstIcon:{type:nt,default:"$first"},prevIcon:{type:nt,default:"$prev"},nextIcon:{type:nt,default:"$next"},lastIcon:{type:nt,default:"$last"},ariaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.root"},pageAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.page"},currentPageAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.currentPage"},firstAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.first"},previousAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.previous"},nextAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.next"},lastAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.last"},ellipsis:{type:String,default:"..."},showFirstLastPage:Boolean,...el(),...tl(),...al(),...ll(),...nl(),...ol(),...il({tag:"nav"}),...Pa(),...sl({variant:"text"})},"VPagination"),wo=Wt()({name:"VPagination",props:Lo(),emits:{"update:modelValue":e=>!0,first:e=>!0,prev:e=>!0,next:e=>!0,last:e=>!0},setup(e,f){let{slots:n,emit:s}=f;const o=Fa(e,"modelValue"),{t:l,n:u}=$a(),{isRtl:i}=xa(),{themeClasses:m}=Ba(e),{width:A}=Ga(),p=Ya(-1);pt(void 0,{scoped:!0});const{resizeRef:U}=rl(g=>{if(!g.length)return;const{target:T,contentRect:S}=g[0],O=T.querySelector(".v-pagination__list > *");if(!O)return;const $=S.width,X=O.offsetWidth+parseFloat(getComputedStyle(O).marginRight)*2;p.value=M($,X)}),r=re(()=>parseInt(e.length,10)),d=re(()=>parseInt(e.start,10)),_=re(()=>e.totalVisible?parseInt(e.totalVisible,10):p.value>=0?p.value:M(A.value,58));function M(g,T){const S=e.showFirstLastPage?5:3;return Math.max(0,Math.floor(+((g-T*S)/T).toFixed(2)))}const Y=re(()=>{if(r.value<=0||isNaN(r.value)||r.value>Number.MAX_SAFE_INTEGER)return[];if(_.value<=1)return[o.value];if(r.value<=_.value)return ot(r.value,d.value);const g=_.value%2===0,T=g?_.value/2:Math.floor(_.value/2),S=g?T:T+1,O=r.value-T;if(S-o.value>=0)return[...ot(Math.max(1,_.value-1),d.value),e.ellipsis,r.value];if(o.value-O>=(g?1:0)){const $=_.value-1,X=r.value-$+d.value;return[d.value,e.ellipsis,...ot($,X)]}else{const $=Math.max(1,_.value-3),X=$===1?o.value:o.value-Math.ceil($/2)+d.value;return[d.value,e.ellipsis,...ot($,X),e.ellipsis,r.value]}});function D(g,T,S){g.preventDefault(),o.value=T,S&&s(S,T)}const{refs:h,updateRef:L}=Mo();pt({VPaginationBtn:{color:Ae(e,"color"),border:Ae(e,"border"),density:Ae(e,"density"),size:Ae(e,"size"),variant:Ae(e,"variant"),rounded:Ae(e,"rounded"),elevation:Ae(e,"elevation")}});const K=re(()=>Y.value.map((g,T)=>{const S=O=>L(O,T);if(typeof g=="string")return{isActive:!1,key:`ellipsis-${T}`,page:g,props:{ref:S,ellipsis:!0,icon:!0,disabled:!0}};{const O=g===o.value;return{isActive:O,key:g,page:u(g),props:{ref:S,ellipsis:!1,icon:!0,disabled:!!e.disabled||+e.length<2,color:O?e.activeColor:e.color,ariaCurrent:O,ariaLabel:l(O?e.currentPageAriaLabel:e.pageAriaLabel,g),onClick:$=>D($,g)}}}})),G=re(()=>{const g=!!e.disabled||o.value<=d.value,T=!!e.disabled||o.value>=d.value+r.value-1;return{first:e.showFirstLastPage?{icon:i.value?e.lastIcon:e.firstIcon,onClick:S=>D(S,d.value,"first"),disabled:g,ariaLabel:l(e.firstAriaLabel),ariaDisabled:g}:void 0,prev:{icon:i.value?e.nextIcon:e.prevIcon,onClick:S=>D(S,o.value-1,"prev"),disabled:g,ariaLabel:l(e.previousAriaLabel),ariaDisabled:g},next:{icon:i.value?e.prevIcon:e.nextIcon,onClick:S=>D(S,o.value+1,"next"),disabled:T,ariaLabel:l(e.nextAriaLabel),ariaDisabled:T},last:e.showFirstLastPage?{icon:i.value?e.firstIcon:e.lastIcon,onClick:S=>D(S,d.value+r.value-1,"last"),disabled:T,ariaLabel:l(e.lastAriaLabel),ariaDisabled:T}:void 0}});function W(){var T;const g=o.value-d.value;(T=h.value[g])==null||T.$el.focus()}function ae(g){g.key===wt.left&&!e.disabled&&o.value>+e.start?(o.value=o.value-1,Ge(W)):g.key===wt.right&&!e.disabled&&o.value<d.value+r.value-1&&(o.value=o.value+1,Ge(W))}return la(()=>t(e.tag,{ref:U,class:["v-pagination",m.value,e.class],style:e.style,role:"navigation","aria-label":l(e.ariaLabel),onKeydown:ae,"data-test":"v-pagination-root"},{default:()=>[t("ul",{class:"v-pagination__list"},[e.showFirstLastPage&&t("li",{key:"first",class:"v-pagination__first","data-test":"v-pagination-first"},[n.first?n.first(G.value.first):t(j,Ce({_as:"VPaginationBtn"},G.value.first),null)]),t("li",{key:"prev",class:"v-pagination__prev","data-test":"v-pagination-prev"},[n.prev?n.prev(G.value.prev):t(j,Ce({_as:"VPaginationBtn"},G.value.prev),null)]),K.value.map((g,T)=>t("li",{key:g.key,class:["v-pagination__item",{"v-pagination__item--is-active":g.isActive}],"data-test":"v-pagination-item"},[n.item?n.item(g):t(j,Ce({_as:"VPaginationBtn"},g.props),{default:()=>[g.page]})])),t("li",{key:"next",class:"v-pagination__next","data-test":"v-pagination-next"},[n.next?n.next(G.value.next):t(j,Ce({_as:"VPaginationBtn"},G.value.next),null)]),e.showFirstLastPage&&t("li",{key:"last",class:"v-pagination__last","data-test":"v-pagination-last"},[n.last?n.last(G.value.last):t(j,Ce({_as:"VPaginationBtn"},G.value.last),null)])])]})),{}}}),Po=["colspan"],Fo={style:{opacity:"var(--v-medium-emphasis-opacity)"}},Di=ee({__name:"RegistrationsView",emits:["pageTitle"],setup(e,{emit:f}){var kt;const n=ia();f("pageTitle","Registration Manager");const s=Ha(),o=qa(),l=c(!0);let u=((kt=s.params.convention)==null?void 0:kt.toString())||"";const i=c({ID:0,ConventionUUID:Se(),OrganisationID:0,OrganisationUUID:ft,Name:"New Convention",Description:"",DetailLink:"",Logo:"",Slug:"",Accommodation:[],Tickets:[],Extras:[],Interests:[],Visible:!1}),m=pe(),A=ja.getInstance(),p=c([]),U=c({ID:0,AdminLayoutUUID:Se(),ConventionID:i.value.ID,ConventionUUID:i.value.ConventionUUID,Name:"Registration Table",Type:Ze.ADMIN_LAYOUT_TABLE,Panels:[]}),r=c([]),d=c([]),_=c([]),M=c([]),Y=c([]),D=c(1),h=c(10),L=c([]),K=c(0),G=c(!1),W=c(""),ae=c(""),g=c(""),T=c(""),S=c({FieldUUID:"591c9bca-c78c-4e97-8aef-bc596ef472fb",Value:""}),O=c(new Map([["591c9bca-c78c-4e97-8aef-bc596ef472fb",S.value]])),$=c(""),X=c(""),me=c([]),ne=c([]),we=c([]),Pe=c([]),Fe=c([]),$e=c([]),_e=c(0),ge=c(),ye=c(!1),qe=c(!1),pa=c(!1),at=c(),Ot=c(),dt=c(),xe=c(!1),_a=ht(),Ve=bo(()=>{ae.value=Date.now().toString()});de(W,y=>{const E=Y.value.find(b=>b.uuid===y);if(E){const b=E.headers.find(R=>R.defaultSort===!0);b&&(L.value=[{key:b.key,order:"asc"}],me.value=[{key:b.key,order:"asc"}])}}),de(_e,y=>{y===7&&bt()}),de($,()=>{Ve()}),de(X,()=>{Ve()});const ga=()=>{r.value=[],_.value=[],Y.value=[];try{m.getConventionAdminLayoutByName(i.value.ConventionUUID,"Registration Table").then(y=>{_e.value+=1,y?U.value=y:(U.value.ConventionID=i.value.ID,U.value.ConventionUUID=i.value.ConventionUUID)})}catch{U.value.ConventionID=i.value.ID,U.value.ConventionUUID=i.value.ConventionUUID}try{m.getConventionForms(i.value.ConventionUUID).then(y=>{_e.value+=1,y&&(r.value=y)})}catch{}try{m.getConventionAccommodation(i.value.ConventionUUID).then(y=>{_e.value+=1,y&&(ne.value=y)})}catch{}try{m.getConventionVenues(i.value.ConventionUUID).then(y=>{_e.value+=1,y&&($e.value=y)})}catch{}try{m.getConventionExtras(i.value.ConventionUUID).then(y=>{_e.value+=1,y&&(we.value=y)})}catch{}try{m.getConventionInterests(i.value.ConventionUUID).then(y=>{_e.value+=1,y&&(Pe.value=y)})}catch{}try{m.getConventionTickets(i.value.ConventionUUID).then(y=>{_e.value+=1,y&&(Fe.value=y)})}catch{}try{m.getConventionGroups(i.value.ConventionUUID).then(y=>{y&&(d.value=y.sort((E,b)=>E.Name.localeCompare(b.Name)))})}catch{}try{m.getConventionTags(i.value.ConventionUUID).then(y=>{y&&(M.value=y.sort((E,b)=>E.Title.localeCompare(b.Title)).map(E=>(E.Title=`${E.Title} [${E.Key}]`,E)))})}catch{}},mt=({page:y,itemsPerPage:E,sortBy:b})=>{l.value=!0,D.value=y,L.value=b;const R=Y.value.find(oe=>oe.uuid==W.value),ue=R==null?void 0:R.layout.Items;let le="",Nt="";if(b&&ue&&b.length>=1){const oe=ue.find(je=>je.LayoutItemUUID==b[0].key);switch(Nt=b[0].order||"asc",oe==null?void 0:oe.MetaField){case te.META_DATA_SOURCE_ACCOMMODATION_FORM:le="submission.status";break;case te.META_DATA_SOURCE_BADGE_FORM:le="submission.status";break;case te.META_DATA_SOURCE_DEALER_FORM:le="submission.status";break;case te.META_DATA_SOURCE_REGISTRATION_FORM:le="submission.status";break;case te.META_DATA_SOURCE_REGISTRATION_REFERENCE:le="reference";break;case te.META_DATA_SOURCE_SUBMISSION_DATE:le="created";break;case te.META_DATA_SOURCE_SUBMISSION_STATUS:le="submission.status";break}switch(oe==null?void 0:oe.UserField){case se.USER_DATA_SOURCE_DISPLAY_NAME:le="user.display_name";break;case se.USER_DATA_SOURCE_EMAIL:le="user.email";break;case se.USER_DATA_SOURCE_FIRST_NAME:le="user.firstname";break;case se.USER_DATA_SOURCE_HANDLE:le="user.handle";break;case se.USER_DATA_SOURCE_LAST_NAME:le="user.lastname";break}}try{const oe={Direction:Nt,Limit:E,Offset:(y-1)*E,Order:le};R&&R.layout.RequiredRegistrationTags.length>0&&(oe.PanelUUID=R==null?void 0:R.layout.LayoutPanelUUID),(R==null?void 0:R.layout.RequiredFormType)===Re.FORM_TYPE_ACCOMMODATION&&(oe.Accommodation=!0),(R==null?void 0:R.layout.RequiredFormType)===Re.FORM_TYPE_BADGE&&(oe.Badge=!0),(R==null?void 0:R.layout.RequiredFormType)===Re.FORM_TYPE_DEALER&&(oe.Dealer=!0),(R==null?void 0:R.layout.RequiredFormType)===Re.FORM_TYPE_REGISTRATION&&(oe.Registration=!0),oe.GroupUUID=$.value||ft,oe.TagUUID=X.value||ft,oe.Email=T.value,oe.Reference=g.value,oe.FieldValues=Array.from(O.value.values()),m.searchConventionRegistrations(i.value.ConventionUUID,oe).then(je=>{je&&(K.value=je.Total,_.value=je.Registrations,Y.value.forEach(ct=>{const Ca=ct.layout;ct.items=_.value.map(H=>{const lt=[];let De;H.Leader?De=H:De=H.Primary,lt.push({Name:De.User.DisplayName,UUID:De.UserUUID,UserUUID:De.User.UserUUID,IsLeader:!0,Reference:De.Reference,Paid:De.Paid,Total:De.Total}),lt.push(...De.Members.map(Ie=>({Name:Ie.User.DisplayName,UUID:Ie.UserUUID,UserUUID:Ie.User.UserUUID,IsLeader:!1,Reference:Ie.Reference,Paid:Ie.Paid,Total:Ie.Total})));const J={};return ct.headers.forEach(Ie=>{var Mt;const q=Ca.Items.find(ze=>ze.LayoutItemUUID===Ie.key);if(q){if(q.SourceType==="LAYOUT_ITEM_SOURCE_FORM"&&q.SectionField)H.Submissions.forEach(ze=>{const Be=ze.Data.find(x=>x.SectionFieldUUID===q.SectionFieldUUID);if(Be){Ie.type===Wa.ACCOMMODATION?J[q.LayoutItemUUID]={Data:Be.Data,Registration:H}:J[q.LayoutItemUUID]=Be.Data;return}});else if(q.SourceType==="LAYOUT_ITEM_SOURCE_USER"&&q.UserField)switch(q.UserField){case se.USER_DATA_SOURCE_AVATAR:J[q.LayoutItemUUID]=n.GetProfileImageURL(H.UserUUID);break;case se.USER_DATA_SOURCE_DISPLAY_NAME:J[q.LayoutItemUUID]=H.User.DisplayName;break;case se.USER_DATA_SOURCE_EMAIL:J[q.LayoutItemUUID]=H.User.Additional.Email;break;case se.USER_DATA_SOURCE_HANDLE:J[q.LayoutItemUUID]=H.User.Handle;break;case se.USER_DATA_SOURCE_DATE_OF_BIRTH:J[q.LayoutItemUUID]=H.User.Additional.DOB;break;case se.USER_DATA_SOURCE_FIRST_NAME:J[q.LayoutItemUUID]=H.User.Additional.FirstName;break;case se.USER_DATA_SOURCE_LAST_NAME:J[q.LayoutItemUUID]=H.User.Additional.LastName;break;case se.USER_DATA_SOURCE_TELEGRAM:J[q.LayoutItemUUID]="";break}else if(q.SourceType==="LAYOUT_ITEM_SOURCE_META"&&q.MetaField){const ze=(Mt=r.value.find(x=>x.Type===Re.FORM_TYPE_REGISTRATION))==null?void 0:Mt.FormUUID,Be=H.Submissions.find(x=>x.FormUUID===ze);switch(q.MetaField){case te.META_DATA_SOURCE_REGISTRATION_ACTIONS:J[q.LayoutItemUUID]=H;break;case te.META_DATA_SOURCE_REGISTRATION_GROUP:J[q.LayoutItemUUID]=lt;break;case te.META_DATA_SOURCE_REGISTRATION_REFERENCE:J[q.LayoutItemUUID]=H.Reference;break;case te.META_DATA_SOURCE_SUBMISSION_DATE:if(Be){const x=new Date(Be.CreatedAt||"");J[q.LayoutItemUUID]=`${x.getFullYear()}-${(x.getMonth()+1).toString().padStart(2,"0")}-${x.getDate().toString().padStart(2,"0")} ${x.getHours().toString().padStart(2,"0")}:${x.getMinutes().toString().padStart(2,"0")}:${x.getSeconds().toString().padStart(2,"0")}`}else{const x=new Date(H.CreatedAt||"");J[q.LayoutItemUUID]=`${x.getFullYear()}-${(x.getMonth()+1).toString().padStart(2,"0")}-${x.getDate().toString().padStart(2,"0")} ${x.getHours().toString().padStart(2,"0")}:${x.getMinutes().toString().padStart(2,"0")}:${x.getSeconds().toString().padStart(2,"0")}`}break;case te.META_DATA_SOURCE_ACCOMMODATION_FORM:J[q.LayoutItemUUID]=H.Submissions.map(x=>{const Q=r.value.find(Oe=>Oe.FormUUID===x.FormUUID);return{Heading:Q==null?void 0:Q.Heading,Form:Q,Submission:x,Registration:H}}).filter(x=>{var Q;return((Q=x.Form)==null?void 0:Q.Type)===Re.FORM_TYPE_ACCOMMODATION});break;case te.META_DATA_SOURCE_BADGE_FORM:J[q.LayoutItemUUID]=H.Submissions.map(x=>{const Q=r.value.find(Oe=>Oe.FormUUID===x.FormUUID);return{Heading:Q==null?void 0:Q.Heading,Form:Q,Submission:x,Registration:H}}).filter(x=>{var Q;return((Q=x.Form)==null?void 0:Q.Type)===Re.FORM_TYPE_BADGE});break;case te.META_DATA_SOURCE_DEALER_FORM:J[q.LayoutItemUUID]=H.Submissions.map(x=>{const Q=r.value.find(Oe=>Oe.FormUUID===x.FormUUID);return{Heading:Q==null?void 0:Q.Heading,Form:Q,Submission:x,Registration:H}}).filter(x=>{var Q;return((Q=x.Form)==null?void 0:Q.Type)===Re.FORM_TYPE_DEALER});break;case te.META_DATA_SOURCE_PAYMENT_STATUS:if(H.Paid===0&&H.Total)J[q.LayoutItemUUID]="REQUIRED";else if(H.Total>H.Paid)J[q.LayoutItemUUID]="ADDITIONAL_REQUIRED";else{const x=lt.find(Q=>Q.Paid===0&&(Q.Total||0)>0);if(x){H.Total===0&&x.Total===0?J[q.LayoutItemUUID]="NOT_REQUIRED":H.Total===0&&x.Total||H.Total>0&&x.Total===0?J[q.LayoutItemUUID]="MISSING_REQUIRED":H.Paid>=H.Total?J[q.LayoutItemUUID]="AWAITING_PARTNER":J[q.LayoutItemUUID]="ALL_REQUIRED";break}else H.Total===0?J[q.LayoutItemUUID]="NOT_REQUIRED":J[q.LayoutItemUUID]="COMPLETE"}break;case te.META_DATA_SOURCE_SUBMISSION_STATUS:ml(H.Submissions,r.value),J[q.LayoutItemUUID]=H.Submissions.map(x=>{const Q=r.value.find(Oe=>Oe.FormUUID===x.FormUUID);return{Heading:Q==null?void 0:Q.Heading,Form:Q,Submission:x,Registration:H}});break}}}}),{key:H.RegistrationUUID,registration:H,...J}})}),l.value=!1)})}catch{}},Aa=y=>{G.value=!1,y&&(U.value=y,bt())},bt=()=>{U.value.Panels.forEach(y=>{y.Items.forEach(E=>{(E.SectionField==null||E.SectionField.Field==null)&&r.value.find(b=>{b.Sections.find(R=>{if(R.Fields){const ue=R.Fields.find(le=>le.SectionFieldUUID===E.SectionFieldUUID);if(ue)return E.SectionField=ue,!0}})})})}),U.value.Panels.length>0&&(Y.value=[],U.value.Panels.forEach(y=>{const E={uuid:Se(),order:y.Order,name:y.Name,headers:[],items:[],layout:y};y.Items.sort((b,R)=>b.Order>R.Order?1:b.Order==R.Order?0:-1),E.headers=y.Items.map(b=>{var R,ue;return{key:b.LayoutItemUUID,title:b.Label||((ue=(R=b.SectionField)==null?void 0:R.Field)==null?void 0:ue.Label)||"",align:b.Align==="end"?"end":"start",sortable:ya(b),type:Ta(b),defaultSort:b.DefaultSort}}),Y.value.push(E)}),Y.value=Y.value.sort((y,E)=>y.order>E.order?1:y.order==E.order?0:-1)),(W.value==null||W.value=="")&&Y.value.length>0&&(W.value=Y.value[0].uuid)};u?m.getConvention(u).then(y=>{y&&(i.value=y,U.value.ConventionID=i.value.ID,U.value.ConventionUUID=i.value.ConventionUUID,ga())}).catch(()=>{o.push("/")}):o.push("/");const Ta=y=>{var E,b;if(y.SourceType===Je.LAYOUT_ITEM_SOURCE_META)return`${y.SourceType}.${y.MetaField}`;if(y.SourceType===Je.LAYOUT_ITEM_SOURCE_FORM)return(b=(E=y.SectionField)==null?void 0:E.Field)==null?void 0:b.Type;if(y.SourceType===Je.LAYOUT_ITEM_SOURCE_USER)return`${y.SourceType}.${y.UserField}`},ya=y=>{const E=[te.META_DATA_SOURCE_ACCOMMODATION_FORM,te.META_DATA_SOURCE_BADGE_FORM,te.META_DATA_SOURCE_DEALER_FORM,te.META_DATA_SOURCE_REGISTRATION_FORM,te.META_DATA_SOURCE_REGISTRATION_REFERENCE,te.META_DATA_SOURCE_SUBMISSION_DATE,te.META_DATA_SOURCE_SUBMISSION_STATUS],b=[se.USER_DATA_SOURCE_DISPLAY_NAME,se.USER_DATA_SOURCE_EMAIL,se.USER_DATA_SOURCE_HANDLE,se.USER_DATA_SOURCE_DATE_OF_BIRTH,se.USER_DATA_SOURCE_FIRST_NAME,se.USER_DATA_SOURCE_LAST_NAME];return E.includes(y.MetaField)||b.includes(y.UserField)},Ea=y=>{ge.value=y,ye.value=!0},Sa=y=>{ge.value=y,qe.value=!0},Da=y=>{ge.value=y,pa.value=!0};de(ye,y=>{y||(ge.value=void 0)}),de(qe,y=>{y||(ge.value=void 0)});const vt=async(y="")=>{Ot.value=await m.getRegistrationGroup(y)},Ia=({registration:y,form:E,submission:b})=>{ge.value=y,vt(y.RegistrationUUID).then(()=>{at.value=E,dt.value=b,xe.value=!0})},Ra=y=>{m.switchUser(y.UserUUID).then(E=>{E&&Ml(E.tokens,E.user,o,!1)}).catch(E=>{console.error(E)})};return A.on("registration.group.leave",y=>{m.leaveRegistrationGroup(y).then(E=>{E&&vt(y).then(()=>{A.emit("registration.group.left",E)})})}),A.on("registration.group.remove.member",y=>{m.leaveRegistrationGroup(y).then(E=>{E&&vt(y).then(()=>{A.emit("registration.group.left",E)})})}),(y,E)=>(v(),N(wl,null,{default:a(()=>[t(Tt,{color:"blue-darken-4"},{default:a(()=>[t(sa,{modelValue:W.value,"onUpdate:modelValue":E[0]||(E[0]=b=>W.value=b),"show-arrows":""},{default:a(()=>[(v(!0),I(P,null,Z(Y.value,b=>(v(),N(ua,{key:b.uuid,value:b.uuid},{default:a(()=>[V(C(b.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"]),t(Ne),t(j,{icon:"mdi:mdi-cog-outline",onClick:E[1]||(E[1]=b=>G.value=!0)})]),_:1}),t(ma,{modelValue:W.value,"onUpdate:modelValue":E[16]||(E[16]=b=>W.value=b),disabled:!0,touch:!1},{default:a(()=>[(v(!0),I(P,null,Z(Y.value,b=>(v(),N(ke,{key:b.uuid,value:b.uuid},{default:a(()=>[b.uuid===W.value?(v(),N(he,{key:0,class:"pa-2"},{default:a(()=>[t(F(Hl),{expanded:p.value,"onUpdate:expanded":E[12]||(E[12]=R=>p.value=R),page:D.value,"onUpdate:page":E[13]||(E[13]=R=>D.value=R),"items-per-page":h.value,"onUpdate:itemsPerPage":E[14]||(E[14]=R=>h.value=R),"sort-by":me.value,"onUpdate:sortBy":E[15]||(E[15]=R=>me.value=R),headers:b.headers,"items-length":K.value,items:b.items,"item-value":"key",loading:l.value,search:ae.value,"onUpdate:options":mt,"show-expand":""},Ye({top:a(()=>[t(ve,null,{default:a(()=>[t(z,null,{default:a(()=>[t(k,{cols:"12",sm:"12",md:"3",lg:"2",xl:"2"},{default:a(()=>[t(Ue,{modelValue:g.value,"onUpdate:modelValue":E[2]||(E[2]=R=>g.value=R),label:"Search by Badge",clearable:!0,"hide-details":"","onClick:clear":F(Ve),onInput:F(Ve)},null,8,["modelValue","onClick:clear","onInput"])]),_:1}),t(k,{cols:"12",sm:"12",md:"4",lg:"5",xl:"3"},{default:a(()=>[t(Ue,{modelValue:S.value.Value,"onUpdate:modelValue":E[3]||(E[3]=R=>S.value.Value=R),label:"Search By Furry Name",clearable:!0,"hide-details":"","onClick:clear":F(Ve),onInput:F(Ve)},null,8,["modelValue","onClick:clear","onInput"])]),_:1}),t(k,{cols:"12",sm:"12",md:"5",lg:"5",xl:"3"},{default:a(()=>[t(Ue,{modelValue:T.value,"onUpdate:modelValue":E[4]||(E[4]=R=>T.value=R),label:"Search By Email",clearable:!0,"hide-details":"","onClick:clear":F(Ve),onInput:F(Ve)},null,8,["modelValue","onClick:clear","onInput"])]),_:1}),t(k,{cols:"12",sm:"6",md:"6",lg:"6",xl:"2"},{default:a(()=>[t(fe,{modelValue:$.value,"onUpdate:modelValue":E[5]||(E[5]=R=>$.value=R),label:"Search By Group",clearable:!0,"hide-details":"",items:d.value,"item-value":"GroupUUID","item-title":"Name"},null,8,["modelValue","items"])]),_:1}),t(k,{cols:"12",sm:"6",md:"6",lg:"6",xl:"2"},{default:a(()=>[t(fe,{modelValue:X.value,"onUpdate:modelValue":E[6]||(E[6]=R=>X.value=R),label:"Search By Tag",clearable:!0,"hide-details":"",items:M.value,"item-value":"TagUUID","item-title":"Title"},null,8,["modelValue","items"])]),_:1})]),_:1})]),_:1})]),"expanded-row":a(({columns:R,item:ue})=>[w("tr",null,[w("td",{colspan:R.length},[t(Qt,{modelValue:ye.value,"onUpdate:modelValue":E[8]||(E[8]=le=>ye.value=le),registration:ue.selectable.registration,"onUpdate:registration":le=>ue.selectable.registration=le,accommodations:ne.value,convention:i.value,extras:we.value,forms:r.value,interests:Pe.value,tickets:Fe.value,title:`Registration Controls (#${ue.selectable.registration.Reference} ${ue.selectable.registration.User.DisplayName})`,"use-dialog":!1,venues:$e.value},null,8,["modelValue","registration","onUpdate:registration","accommodations","convention","extras","forms","interests","tickets","title","venues"])],8,Po)])]),"item.data-table-expand":a(({item:R})=>[p.value.findIndex(ue=>ue===R.key)>=0?(v(),N(j,{key:0,"append-icon":"mdi:mdi-chevron-up",size:"xs",variant:"flat",onClick:ue=>p.value.splice(p.value.findIndex(le=>le===R.key),1)},{default:a(()=>[R.selectable.registration.Notes&&R.selectable.registration.Notes.length>0?(v(),I(P,{key:0},[V(C(R.selectable.registration.Notes.length),1)],64)):B("",!0)]),_:2},1032,["onClick"])):(v(),N(j,{key:1,"append-icon":"mdi:mdi-chevron-down",size:"xs",variant:"flat",onClick:ue=>p.value.push(R.key)},{default:a(()=>[R.selectable.registration.Notes&&R.selectable.registration.Notes.length>0?(v(),I(P,{key:0},[V(C(R.selectable.registration.Notes.length),1)],64)):B("",!0)]),_:2},1032,["onClick"]))]),bottom:a(()=>[t(ve,{fluid:!0},{default:a(()=>[t(z,{class:"align-center"},{default:a(()=>[t(k,{cols:"12",lg:"7","order-lg":"3",xl:"8"},{default:a(()=>[t(wo,{modelValue:D.value,"onUpdate:modelValue":E[9]||(E[9]=R=>D.value=R),length:Math.ceil(K.value/h.value)},null,8,["modelValue","length"])]),_:1}),t(k,{cols:"6",sm:"4",md:"2",lg:"2",xl:"1","order-lg":"1"},{default:a(()=>[t(fe,{"model-value":h.value,density:"compact","hide-details":"","item-title":"title","item-value":"value",label:"Items per page",min:"-1",max:"100",type:"number",variant:"outlined",items:[{title:"10",value:10},{title:"25",value:25},{title:"50",value:50},{title:"100",value:100},{title:"All",value:-1}],"onUpdate:modelValue":E[10]||(E[10]=R=>h.value=parseInt(R,10))},null,8,["model-value"])]),_:1}),t(k,{cols:"6",sm:"3",md:"2",lg:"1",xl:"1","order-lg":"2"},{default:a(()=>[t(Ue,{modelValue:D.value,"onUpdate:modelValue":E[11]||(E[11]=R=>D.value=R),modelModifiers:{number:!0},density:"compact","hide-details":"",label:"Page",min:"1",max:Math.ceil(K.value/h.value),type:"number",variant:"outlined"},null,8,["modelValue","max"])]),_:1}),t(k,{class:"text-right",cols:"12",sm:"5",md:"8",lg:"2",xl:"2","order-lg":"4"},{default:a(()=>[w("span",Fo,[h.value===-1?(v(),I(P,{key:0},[V(" 1-"+C(K.value)+" of "+C(K.value),1)],64)):(v(),I(P,{key:1},[V(C((D.value-1)*h.value+1)+"-"+C(D.value*h.value>=K.value?K.value:D.value*h.value)+" of "+C(K.value),1)],64))])]),_:1})]),_:1})]),_:1})]),_:2},[Z(b.headers,R=>({name:`item.${R.key}`,fn:a(({item:ue})=>[t(Rn,{header:R,item:ue,accommodations:ne.value,convention:i.value,extras:we.value,forms:r.value,interests:Pe.value,tickets:Fe.value,user:F(_a),venues:$e.value,onOpenActions:Ea,onOpenPayments:Sa,onOpenTags:Da,onReload:E[7]||(E[7]=le=>mt({page:D.value,itemsPerPage:h.value,sortBy:L.value})),onSwitchUser:Ra,onShowForm:Ia},null,8,["header","item","accommodations","convention","extras","forms","interests","tickets","user","venues"])])}))]),1032,["expanded","page","items-per-page","sort-by","headers","items-length","items","loading","search"])]),_:2},1024)):B("",!0)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"]),G.value?(v(),N(No,{key:0,title:"Edit Layouts",modelValue:G.value,"onUpdate:modelValue":E[17]||(E[17]=b=>G.value=b),convention:i.value,onSave:Aa},null,8,["modelValue","convention"])):B("",!0),ge.value?(v(),I(P,{key:1},[ye.value?(v(),N(Qt,{key:0,modelValue:ye.value,"onUpdate:modelValue":E[18]||(E[18]=b=>ye.value=b),registration:ge.value,"onUpdate:registration":E[19]||(E[19]=b=>ge.value=b),accommodations:ne.value,convention:i.value,extras:we.value,forms:r.value,interests:Pe.value,tickets:Fe.value,title:`Registration Controls (#${ge.value.Reference} ${ge.value.User.DisplayName})`,"use-dialog":!0,venues:$e.value},null,8,["modelValue","registration","accommodations","convention","extras","forms","interests","tickets","title","venues"])):B("",!0)],64)):B("",!0),xe.value&&dt.value&&at.value?(v(),N(st,{key:2,modelValue:xe.value,"onUpdate:modelValue":E[23]||(E[23]=b=>xe.value=b),scrollable:!0,fullscreen:!0,persistent:!0},{default:a(()=>[t(he,{class:"bg-red-darken-4"},{default:a(()=>[t(Tt,{color:"error"},{default:a(()=>[t(fa,null,{default:a(()=>[V("Submission Editor - Admin Mode")]),_:1}),t(Ne),t(Ll,null,{default:a(()=>[t(j,{icon:"mdi:mdi-window-close",onClick:E[20]||(E[20]=b=>xe.value=!1)})]),_:1})]),_:1}),t(Le,null,{default:a(()=>[t(Ka,{modelValue:at.value,"onUpdate:modelValue":E[21]||(E[21]=b=>at.value=b),admin:!0,convention:i.value,data:dt.value,editable:!0,"registration-group":Ot.value,onClose:E[22]||(E[22]=b=>{xe.value=!1,mt({page:D.value,itemsPerPage:h.value,sortBy:L.value})})},null,8,["modelValue","convention","data","registration-group"])]),_:1})]),_:1})]),_:1},8,["modelValue"])):B("",!0)]),_:1}))}});export{Di as default};
