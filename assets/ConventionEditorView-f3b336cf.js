import{s as O}from"./index-26b71cef.js";import{I as x,r as _,L as c,M as C,N as l,v as e,O as b,V as I,a0 as Y,a2 as P,a3 as M,e as Q,w as H,U as E,H as $,J as j,R as S,$ as K,P as R,W as h,Q as re,x as Ee,a5 as be,E as ye,a6 as he,a7 as _e,a8 as Re,a4 as Be,s as ie,a9 as ze}from"./index-46ae011d.js";import{V as Pe,m as Ne,a as Ae,s as Oe,T as L,b as He,F as xe,c as J,_ as we,d as Je}from"./FormRenderer.vue_vue_type_style_index_0_lang-59e15e78.js";import{v as q}from"./v4-a960c1f4.js";import{u as me,a as ue,V as ne}from"./VToolbar-b4e51521.js";import{V as N}from"./VBtn-457dcd6e.js";import{V as z,j as B}from"./VContainer-c5645db9.js";import{V as ee}from"./VSpacer-c7a99211.js";import{V as ve}from"./VToolbarItems-437eb42f.js";import{a as A,V as g}from"./VRow-82a84da7.js";import{V as F,a as Xe}from"./VTextField-c09ca43d.js";import{c as ce,e as de}from"./VCard-0107bf1d.js";import{V as pe}from"./VDialog-c9df337b.js";import{a as te,V as ke,c as le,b as $e}from"./VList-fe805c0f.js";import{V as Fe}from"./VDivider-242a7218.js";import{_ as Z,V as qe,a as Me}from"./VChip-ace0b4af.js";import{_ as Le,V as fe,a as Ve,b as Ue,c as Te,d as Ke,e as Ye,f as We,g as Qe,h as Ze,i as el}from"./VWindowItem-10934b5e.js";import{V as Ie}from"./VTextarea-0ecebd17.js";import{V as se}from"./copyToClipboard-486997d8.js";import{V as X,u as De}from"./VCheckbox-4eb16469.js";import{V as ll,a as ae}from"./VTable-61329809.js";import{_ as Ge}from"./DeleteDialog.vue_vue_type_script_setup_true_lang-e6c6a987.js";import{_ as Se}from"./ModelDialog.vue_vue_type_script_setup_true_lang-07623664.js";import{a as tl,F as al}from"./form-29fd1dbb.js";import"./submission-830079be.js";import"./VAvatar-e44c7487.js";import"./userData-2d13cd96.js";import"./VForm-e0389ba0.js";import"./scopeId-85721857.js";var Ce=(f=>(f.PER_ROOM="PER_ROOM",f.PER_PERSON="PER_PERSON",f))(Ce||{});const ol=x({__name:"AddTag",props:{convention:{},organisation:{}},emits:["save","close"],setup(f,{emit:r}){const a=_(""),d=_("");typeof f.convention=="object"?(a.value=f.convention.ConventionUUID,d.value=f.convention.OrganisationUUID):a.value=f.convention||"",typeof f.organisation=="object"?d.value=f.organisation.OrganisationUUID:d.value.length===0&&(d.value=f.organisation||"");const i=_({ID:0,TagUUID:q(),ConventionID:0,ConventionUUID:a.value||me,OrganisationID:0,OrganisationUUID:d.value||me,Title:"",Key:""}),n=Y(),u=()=>{n.saveTag(i.value).then(t=>{t&&(i.value=t,r("save",t),r("close"))})};return(t,o)=>(c(),C(de,null,{default:l(()=>[e(ne,{dark:"",color:"primary"},{default:l(()=>[e(N,{icon:"",dark:"",onClick:o[0]||(o[0]=v=>r("close"))},{default:l(()=>[e(z,null,{default:l(()=>[b("mdi:mdi-close")]),_:1})]),_:1}),e(ue,null,{default:l(()=>[b("Add Tag")]),_:1}),e(ee),e(ve,null,{default:l(()=>[e(N,{variant:"text",onClick:u},{default:l(()=>[b(" Save ")]),_:1})]),_:1})]),_:1}),e(ce,null,{default:l(()=>[e(B,{fluid:!0},{default:l(()=>[e(A,null,{default:l(()=>[e(g,{cols:"12"},{default:l(()=>[e(F,{label:I(O).formLabelDisplayName,type:"text",variant:"outlined",modelValue:i.value.Title,"onUpdate:modelValue":o[1]||(o[1]=v=>i.value.Title=v)},null,8,["label","modelValue"])]),_:1}),e(g,{cols:"12"},{default:l(()=>[e(F,{label:I(O).formLabelTagKey,type:"text",variant:"outlined",modelValue:i.value.Key,"onUpdate:modelValue":o[2]||(o[2]=v=>i.value.Key=v)},null,8,["label","modelValue"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}))}}),oe=x({__name:"SelectTags",props:P({convention:{},organisation:{},chips:{type:Boolean,default:!1},clearable:{type:Boolean,default:!1},hint:{default:""},label:{},variant:{}},{modelValue:{required:!0}}),emits:P(["change"],["update:modelValue"]),setup(f,{emit:r}){const a=M(f,"modelValue"),d=_([]),i=Y(),n=_([]),u=_([]),t=_(""),o=_(""),v=_(0),m=Q(()=>[...n.value,...u.value].map(D=>({title:D.Title,value:d.value.find(y=>y.TagUUID===D.TagUUID)||D})));typeof f.convention=="object"?(t.value=f.convention.ConventionUUID,o.value=f.convention.OrganisationUUID):t.value=f.convention||"",typeof f.organisation=="object"?o.value=f.organisation.OrganisationUUID:o.value.length===0&&(o.value=f.organisation||""),(async()=>{const T=[];t.value&&T.push(i.getConventionTags(t.value)),o.value&&T.push(i.getOrganisationTags(o.value));const D=await Promise.all(T);if(t.value&&o.value?(u.value=D[0].sort((y,k)=>y.Title.localeCompare(k.Title)),n.value=D[1].sort((y,k)=>y.Title.localeCompare(k.Title))):t.value&&D.length==1?u.value=D[0].sort((y,k)=>y.Title.localeCompare(k.Title)):o.value&&D.length==1&&(n.value=D[0].sort((y,k)=>y.Title.localeCompare(k.Title))),Array.isArray(a.value))v.value=2,m.value.forEach(y=>{Array.isArray(a.value)&&a.value.find(w=>w.TagUUID===y.value.TagUUID)&&d.value.push(y.value)});else if(typeof a.value=="string"){v.value=1;try{const y=JSON.parse(a.value);m.value.forEach(k=>{y.find(G=>G.TagUUID===k.value.TagUUID)&&d.value.push(k.value)})}catch{}}})();const s=_(!1),p=()=>{s.value=!0},V=T=>{T.ConventionUUID.length>0?u.value.push(T):T.OrganisationUUID.length>0&&n.value.push(T),d.value.push(T),U()},U=()=>{switch(v.value){default:case 2:{a.value=d.value,r("change");break}case 1:{a.value=JSON.stringify(d.value),r("change");break}}};return H(d,U),(T,D)=>(c(),E($,null,[e(Pe,{modelValue:d.value,"onUpdate:modelValue":D[1]||(D[1]=y=>d.value=y),chips:T.chips,multiple:"",label:T.label||"Tags",variant:T.variant||"solo",hint:T.hint,"persistent-hint":!0,clearable:T.clearable,items:m.value,"item-title":"title","item-value":"value"},{"prepend-item":l(()=>[e(te,{title:"New Tag",onClick:D[0]||(D[0]=y=>p())},{prepend:l(()=>[e(z,{icon:"mdi:mdi-plus"})]),_:1}),e(Fe,{class:"mt-2"})]),_:1},8,["modelValue","chips","label","variant","hint","clearable","items"]),e(pe,{modelValue:s.value,"onUpdate:modelValue":D[3]||(D[3]=y=>s.value=y),scrollable:!0},{default:l(()=>[e(ol,{convention:T.convention,organisation:T.organisation,onClose:D[2]||(D[2]=y=>s.value=!1),onSave:V},null,8,["convention","organisation"])]),_:1},8,["modelValue"])],64))}}),nl=x({__name:"EditConventionExtraOptions",props:P({convention:{}},{modelValue:{}}),emits:P(["close"],["update:modelValue"]),setup(f,{emit:r}){const a=M(f,"modelValue"),d=_(j(a.value)),i=()=>{a.value=d.value,r("close")};return(n,u)=>(c(),C(de,null,{default:l(()=>[e(ne,{dark:"",color:"primary"},{default:l(()=>[e(N,{icon:"",dark:"",onClick:u[0]||(u[0]=t=>r("close"))},{default:l(()=>[e(z,null,{default:l(()=>[b("mdi:mdi-close")]),_:1})]),_:1}),e(ue,null,{default:l(()=>[b("Edit Option Choice")]),_:1}),e(ee),e(ve,null,{default:l(()=>[e(N,{variant:"text",onClick:i},{default:l(()=>[b(" Apply ")]),_:1})]),_:1})]),_:1}),e(ce,{class:"pa-0"},{default:l(()=>[e(B,null,{default:l(()=>[e(F,{label:I(O).formLabelName,type:"text",variant:"outlined",modelValue:d.value.Name,"onUpdate:modelValue":u[1]||(u[1]=t=>d.value.Name=t)},null,8,["label","modelValue"]),e(F,{label:I(O).formLabelDescription,type:"text",variant:"outlined",modelValue:d.value.Description,"onUpdate:modelValue":u[2]||(u[2]=t=>d.value.Description=t)},null,8,["label","modelValue"]),e(F,{label:I(O).formLabelPrice,type:"text",variant:"outlined","prepend-icon":I(O).currencyIcon,modelValue:d.value.Price,"onUpdate:modelValue":u[3]||(u[3]=t=>d.value.Price=t),modelModifiers:{number:!0},hint:"Adds additional charges for selecting this option"},null,8,["label","prepend-icon","modelValue"]),d.value.Choices?(c(),C(oe,{key:0,modelValue:d.value.Choices,"onUpdate:modelValue":u[4]||(u[4]=t=>d.value.Choices=t),convention:n.convention,hint:"Sub-options (tags) that a user may choose from."},null,8,["modelValue","convention"])):S("",!0)]),_:1})]),_:1})]),_:1}))}}),ul=h("h3",null,"Options",-1),il=x({__name:"EditConventionExtra",props:P({convention:{}},{modelValue:{required:!0}}),emits:["update:modelValue"],setup(f){const r=M(f,"modelValue"),a=_(j(r.value)),d=_(!1),i=_(0),n=Y(),u=_([""]),t=_([]),o=_([]);f.convention&&(n.getConventionTags(f.convention.ConventionUUID).then(U=>{o.value=U.sort((T,D)=>T.Title.localeCompare(D.Title))}),n.getOrganisationTags(f.convention.OrganisationUUID).then(U=>{t.value=U.sort((T,D)=>T.Title.localeCompare(D.Title))}));const v=Q(()=>[...t.value,...o.value]),m=({callback:U})=>{n.saveExtra(a.value).then(T=>{T?(r.value=T,U&&U("Extra Saved")):U&&U("Failed to Save Extra")}).catch(()=>{U&&U("Failed to Save Extra")})},s=U=>{var T;U.Options||(U.Options=[]),U.Options.push({ID:0,OptionUUID:q(),ExtraID:U.ID,ExtraUUID:U.ExtraUUID,Order:((T=U.Options)==null?void 0:T.length)+1,Name:"",Description:"",Price:0,Choices:[]})},p=(U,T)=>{U.Options&&U.Options.splice(T,1)},V=U=>{if(U.Choices&&U.Choices.length>0)return U.Choices.map(T=>{const D=v.value.find(y=>y.TagUUID===T.TagUUID);if(D)return D.Title}).join(", ")};return(U,T)=>(c(),E($,null,[e(B,{class:"px-0"},{default:l(()=>[e(F,{label:I(O).formLabelName,type:"text",variant:"outlined",modelValue:a.value.Name,"onUpdate:modelValue":T[0]||(T[0]=D=>a.value.Name=D)},null,8,["label","modelValue"]),e(F,{label:I(O).formLabelDescription,type:"text",variant:"outlined",modelValue:a.value.Description,"onUpdate:modelValue":T[1]||(T[1]=D=>a.value.Description=D)},null,8,["label","modelValue"]),e(oe,{modelValue:a.value.AppliesTags,"onUpdate:modelValue":T[2]||(T[2]=D=>a.value.AppliesTags=D),convention:U.convention,organisation:U.convention.OrganisationUUID,hint:"Tags a user acquires by selecting any option within this addon purchase."},null,8,["modelValue","convention","organisation"]),e(oe,{label:"Required Tags",variant:"outlined",modelValue:a.value.RequiredTags,"onUpdate:modelValue":T[3]||(T[3]=D=>a.value.RequiredTags=D),convention:U.convention,organisation:U.convention.OrganisationUUID,chips:"",clearable:"",hint:"Tags that a user must have to see this form. (Any one)"},null,8,["modelValue","convention","organisation"]),e(Le,{label:"Required Groups",variant:"outlined",modelValue:a.value.RequiredGroupMemberships,"onUpdate:modelValue":T[4]||(T[4]=D=>a.value.RequiredGroupMemberships=D),convention:U.convention,organisation:U.convention.OrganisationUUID,chips:"",clearable:"",hint:"Groups that a user must be in to see this form. (Any one)"},null,8,["modelValue","convention","organisation"]),ul,e(ke,{opened:u.value,"onUpdate:opened":T[5]||(T[5]=D=>u.value=D)},{default:l(()=>[(c(!0),E($,null,K(a.value.Options,(D,y)=>(c(),E($,{key:D.ID},[D?(c(),C(te,{key:0,"prepend-icon":"mdi:mdi-ticket-percent",title:`${D.Name} ${D.Price&&D.Price>0?`(${I(O).currencySymbol}${D.Price})`:""}`},{append:l(()=>[e(N,{color:"red",icon:"mdi:mdi-close",size:"x-small",class:"mr-1",onClick:k=>p(a.value,y)},null,8,["onClick"]),e(N,{color:"primary",icon:"mdi:mdi-pencil",size:"x-small",onClick:k=>{d.value=!0,i.value=y}},null,8,["onClick"])]),default:l(()=>[D.Choices&&D.Choices.length>0?(c(),C(le,{key:0},{default:l(()=>[b(" Options: "+R(V(D)),1)]),_:2},1024)):S("",!0)]),_:2},1032,["title"])):S("",!0)],64))),128))]),_:1},8,["opened"]),e(N,{color:"primary",onClick:T[6]||(T[6]=D=>s(a.value))},{default:l(()=>[b("Add Option")]),_:1}),e(A,null,{default:l(()=>[e(g,{class:"text-right"},{default:l(()=>[e(Z,{onClick:m})]),_:1})]),_:1})]),_:1}),e(pe,{modelValue:d.value,"onUpdate:modelValue":T[9]||(T[9]=D=>d.value=D),scrollable:""},{default:l(()=>[e(nl,{modelValue:a.value.Options[i.value],"onUpdate:modelValue":T[7]||(T[7]=D=>a.value.Options[i.value]=D),convention:U.convention,onClose:T[8]||(T[8]=D=>d.value=!1)},null,8,["modelValue","convention"])]),_:1},8,["modelValue"])],64))}}),dl=x({__name:"EditConventionExtras",props:P({convention:{}},{modelValue:{required:!0}}),emits:P(["close"],["update:modelValue"]),setup(f,{emit:r}){const a=M(f,"modelValue"),d=Y(),i=()=>{const t={ID:0,ExtraUUID:q(),ConventionID:f.convention.ID,ConventionUUID:f.convention.ConventionUUID,Order:a.value.length+1,Name:"New Extra",Description:"",AppliesTags:[],RequiredTags:[],RequiredGroupMemberships:[],Options:[]};d.saveExtra(t).then(o=>{o&&a.value.push(o)})},n=t=>{d.deleteExtra(a.value[t].ExtraUUID).then(o=>{o&&a.value.splice(t,1)})},u=(...t)=>{t.forEach(o=>{o>=0&&o<a.value.length&&d.saveExtra(a.value[o])})};return(t,o)=>(c(),C(de,null,{default:l(()=>[e(ne,{dark:"",color:"primary"},{default:l(()=>[e(N,{icon:"",dark:"",onClick:o[0]||(o[0]=v=>r("close"))},{default:l(()=>[e(z,null,{default:l(()=>[b("mdi:mdi-close")]),_:1})]),_:1}),e(ue,null,{default:l(()=>[b("Edit Extras")]),_:1}),e(ee),e(ve,null,{default:l(()=>[e(N,{variant:"text",onClick:i},{default:l(()=>[b(" Add ")]),_:1})]),_:1})]),_:1}),e(ce,{class:"pa-0"},{default:l(()=>[e(fe,null,{default:l(()=>[(c(!0),E($,null,K(a.value,(v,m)=>(c(),C(Ve,{key:v.ID,class:"mt-0"},{default:l(()=>[e(Ue,null,{actions:l(({expanded:s})=>[e(N,{icon:"mdi:mdi-close",size:"x-small",color:"red",class:"mr-1",onClick:p=>n(m)},null,8,["onClick"]),e(z,{class:"align-self-center text-h5",icon:s?"mdi:mdi-chevron-up":"mdi:mdi-chevron-down",variant:"flat",size:"x-small"},null,8,["icon"])]),default:l(()=>[e(N,{icon:"mdi:mdi-menu-up",size:"x-small",color:"primary",class:"mr-1",onClick:re(s=>{I(Ne)(v,a.value),u(m,m-1)},["stop"])},null,8,["onClick"]),e(N,{icon:"mdi:mdi-menu-down",size:"x-small",color:"secondary",class:"mr-4",onClick:re(s=>{I(Ae)(v,a.value),u(m,m+1)},["stop"])},null,8,["onClick"]),b(" "+R(v.Name)+" ",1)]),_:2},1024),e(Te,{class:"px-0"},{default:l(()=>[e(il,{convention:t.convention,modelValue:a.value[m],"onUpdate:modelValue":s=>a.value[m]=s},null,8,["convention","modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1}))}}),sl=h("h3",null,"Additional Purchases",-1),rl=h("p",null,"These are global ticket addons that are not tied to any particular ticket type.",-1),ml=x({__name:"Extras",props:{modelValue:{required:!0}},emits:["update:modelValue"],setup(f){const r=M(f,"modelValue"),a=_([]),d=Y(),i=_([""]),n=_(!1),u=o=>{if(o.Choices&&o.Choices.length>0)return o.Choices.map(v=>v.Title).join(", ")},t=()=>{n.value=!1};return d==null||d.getConventionExtras(r.value.ConventionUUID||"").then(o=>{o&&(a.value=o)}),(o,v)=>(c(),E($,null,[e(B,{fluid:!0,class:"px-0"},{default:l(()=>[e(A,null,{default:l(()=>[e(g,null,{default:l(()=>[sl]),_:1}),e(g,{class:"text-right"},{default:l(()=>[e(N,{color:"primary",onClick:v[0]||(v[0]=m=>n.value=!0)},{default:l(()=>[b("Edit")]),_:1})]),_:1})]),_:1})]),_:1}),rl,e(ke,{opened:i.value,"onUpdate:opened":v[1]||(v[1]=m=>i.value=m)},{default:l(()=>[(c(!0),E($,null,K(a.value,m=>(c(),C($e,{key:m.ID,value:m.ID},{activator:l(({props:s})=>[e(te,Ee(s,{"prepend-icon":"mdi:mdi-group",title:m.Name}),null,16,["title"])]),default:l(()=>[m.Options?(c(!0),E($,{key:0},K(m.Options,s=>(c(),C(te,{key:s.ID,"prepend-icon":"mdi:mdi-ticket-percent",title:`${s.Name} ${s.Price&&s.Price>0?`(${I(O).currencySymbol}${s.Price})`:""}`},{default:l(()=>[s.Choices&&s.Choices.length>0?(c(),C(le,{key:0},{default:l(()=>[b(" Options: "+R(u(s)),1)]),_:2},1024)):S("",!0)]),_:2},1032,["title"]))),128)):S("",!0)]),_:2},1032,["value"]))),128))]),_:1},8,["opened"]),e(pe,{modelValue:n.value,"onUpdate:modelValue":v[3]||(v[3]=m=>n.value=m),scrollable:!0},{default:l(()=>[e(dl,{modelValue:a.value,"onUpdate:modelValue":v[2]||(v[2]=m=>a.value=m),convention:r.value,onClose:t},null,8,["modelValue","convention"])]),_:1},8,["modelValue"])],64))}}),vl=x({__name:"EditConventionInterest",props:P({convention:{}},{modelValue:{required:!0}}),emits:["update:modelValue"],setup(f){const r=M(f,"modelValue"),a=_(j(r.value)),d=Y(),i=({callback:n})=>{d.saveInterest(a.value).then(u=>{u?(r.value=u,n&&n("Interest Saved")):n&&n("Failed to Save Interest")}).catch(()=>{n&&n("Failed to Save Interest")})};return(n,u)=>(c(),C(B,{class:"px-0"},{default:l(()=>[e(F,{label:I(O).formLabelName,type:"text",variant:"outlined",modelValue:a.value.Name,"onUpdate:modelValue":u[0]||(u[0]=t=>a.value.Name=t)},null,8,["label","modelValue"]),e(Ie,{label:I(O).formLabelDescription,type:"text",variant:"outlined",modelValue:a.value.Description,"onUpdate:modelValue":u[1]||(u[1]=t=>a.value.Description=t)},null,8,["label","modelValue"]),S("",!0),e(oe,{modelValue:a.value.AppliesTags,"onUpdate:modelValue":u[3]||(u[3]=t=>a.value.AppliesTags=t),convention:n.convention,organisation:n.convention.OrganisationUUID,hint:"Tags that a user acquires by selecting this interest."},null,8,["modelValue","convention","organisation"]),e(A,null,{default:l(()=>[e(g,{class:"text-right"},{default:l(()=>[e(Z,{onClick:i})]),_:1})]),_:1})]),_:1}))}}),cl=x({__name:"EditConventionInterests",props:P({convention:{}},{modelValue:{required:!0}}),emits:P(["close"],["update:modelValue"]),setup(f,{emit:r}){const a=M(f,"modelValue"),d=Y(),i=()=>{const t={ID:0,InterestUUID:q(),ConventionID:f.convention.ID,ConventionUUID:f.convention.ConventionUUID,Order:a.value.length+1,Name:"New Interest",Description:"",Price:0,AppliesTags:[]};d.saveInterest(t).then(o=>{o&&a.value.push(o)})},n=t=>{d.deleteInterest(a.value[t].InterestUUID).then(o=>{o&&a.value.splice(t,1)})},u=(...t)=>{t.forEach(o=>{o>=0&&o<a.value.length&&d.saveInterest(a.value[o])})};return(t,o)=>(c(),C(de,null,{default:l(()=>[e(ne,{dark:"",color:"primary"},{default:l(()=>[e(N,{icon:"",dark:"",onClick:o[0]||(o[0]=v=>r("close"))},{default:l(()=>[e(z,null,{default:l(()=>[b("mdi:mdi-close")]),_:1})]),_:1}),e(ue,null,{default:l(()=>[b("Edit Interests")]),_:1}),e(ee),e(ve,null,{default:l(()=>[e(N,{variant:"text",onClick:i},{default:l(()=>[b(" Add ")]),_:1})]),_:1})]),_:1}),e(ce,{class:"pa-0"},{default:l(()=>[e(fe,null,{default:l(()=>[(c(!0),E($,null,K(a.value,(v,m)=>(c(),C(Ve,{key:v.ID,class:"mt-0"},{default:l(()=>[e(Ue,null,{actions:l(({expanded:s})=>[e(Z,{class:"mr-1",color:"red",icon:"mdi:mdi-close",size:"x-small",onClick:p=>n(m)},null,8,["onClick"]),e(z,{class:"align-self-center text-h5",icon:s?"mdi:mdi-chevron-up":"mdi:mdi-chevron-down",variant:"flat",size:"x-small"},null,8,["icon"])]),default:l(()=>[e(N,{icon:"mdi:mdi-menu-up",size:"x-small",color:"primary",class:"mr-1",onClick:re(s=>{I(Ne)(v,a.value),u(m,m-1)},["stop"])},null,8,["onClick"]),e(N,{icon:"mdi:mdi-menu-down",size:"x-small",color:"secondary",class:"mr-4",onClick:re(s=>{I(Ae)(v,a.value),u(m,m+1)},["stop"])},null,8,["onClick"]),b(" "+R(v.Name)+" ",1)]),_:2},1024),e(Te,{class:"px-0"},{default:l(()=>[e(vl,{convention:t.convention,modelValue:a.value[m],"onUpdate:modelValue":s=>a.value[m]=s},null,8,["convention","modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1}))}}),pl=h("h3",null,"Interests",-1),fl=h("p",null,"Attendees can tag themselves for particular things.",-1),Vl=x({__name:"Interests",props:{modelValue:{required:!0}},emits:P(["refresh"],["update:modelValue"]),setup(f){const r=M(f,"modelValue"),a=Y(),d=_([]);a.getConventionInterests(r.value.ConventionUUID).then(u=>{Oe(u),d.value=u});const i=_([""]),n=_(!1);return(u,t)=>(c(),E($,null,[e(B,{fluid:!0,class:"px-0"},{default:l(()=>[e(A,null,{default:l(()=>[e(g,null,{default:l(()=>[pl]),_:1}),e(g,{class:"text-right"},{default:l(()=>[e(N,{color:"primary",onClick:t[0]||(t[0]=o=>n.value=!0)},{default:l(()=>[b("Edit")]),_:1})]),_:1})]),_:1})]),_:1}),fl,e(ke,{opened:i.value,"onUpdate:opened":t[1]||(t[1]=o=>i.value=o)},{default:l(()=>[(c(!0),E($,null,K(d.value,o=>(c(),C(te,{key:o.ID,"prepend-icon":"mdi:mdi-checkbox-marked-outline",title:`${o.Name} ${o.Price&&o.Price>0?`(${I(O).currencySymbol}${o.Price})`:""}`},{default:l(()=>[o.Description?(c(),C(le,{key:0},{default:l(()=>[b(R(o.Description),1)]),_:2},1024)):S("",!0)]),_:2},1032,["title"]))),128))]),_:1},8,["opened"]),e(pe,{modelValue:n.value,"onUpdate:modelValue":t[4]||(t[4]=o=>n.value=o),scrollable:!0},{default:l(()=>[e(cl,{onClose:t[2]||(t[2]=o=>n.value=!1),convention:r.value,modelValue:d.value,"onUpdate:modelValue":t[3]||(t[3]=o=>d.value=o)},null,8,["convention","modelValue"])]),_:1},8,["modelValue"])],64))}}),ge=x({__name:"SelectTickets",props:P({chips:{type:Boolean,default:!1},clearable:{type:Boolean,default:!1},hint:{default:"Tickets that belong to this group."},label:{default:"Tickets"},persistentHint:{type:Boolean,default:!1},tickets:{default:()=>[]},variant:{}},{modelValue:{required:!0}}),emits:["update:modelValue"],setup(f){const r=M(f,"modelValue"),a=i=>i.Type===L.TICKET_TYPE_GROUP?"mdi:mdi-group":i.Type===L.TICKET_TYPE_TICKET?i.RequiresAccommodation?"mdi:mdi-home":i.ComponentsRequired>0?"mdi:mdi-ticket-confirmation":"mdi:mdi-ticket":i.Type===L.TICKET_TYPE_TICKET_COMPONENT?"mdi:mdi-cog-outline":i.Type===L.TICKET_TYPE_ADD_ON?"mdi:mdi-home-plus":"mdi:mdi-help",d=Q(()=>f.tickets.map(i=>({title:i.Name,value:r.value.find(n=>n&&n.TicketUUID===i.TicketUUID)||i,props:{appendIcon:a(i)}})));return(i,n)=>(c(),E("div",null,[e(Pe,{label:i.label,variant:i.variant||"filled",items:d.value,"item-title":"title","item-value":"value","item-props":"props",modelValue:r.value,"onUpdate:modelValue":n[0]||(n[0]=u=>r.value=u),hint:i.hint,chips:i.chips,clearable:i.clearable,multiple:"","persistent-hint":i.persistentHint},null,8,["label","variant","items","modelValue","hint","chips","clearable","persistent-hint"])]))}}),Ul=h("p",{title:"Automatically calculated",class:"text-grey-lighten-1"},"Applicable Accommodation:",-1),Tl=x({__name:"EditConventionTicket",props:P({accommodation:{default:()=>[]},convention:{},tickets:{default:()=>[]}},{modelValue:{required:!0}}),emits:["update:modelValue"],setup(f){const r=M(f,"modelValue"),a=_(j(r.value)),d=Y(),i=Q(()=>f.tickets.filter(v=>v.Type===L.TICKET_TYPE_TICKET)),n=Q(()=>f.tickets.filter(v=>v.Type===L.TICKET_TYPE_ADD_ON)),u=Q(()=>f.tickets.filter(v=>v.Type===L.TICKET_TYPE_TICKET_COMPONENT)),t=v=>f.accommodation.filter(m=>m.Costs.find(s=>s.DateStart===v.DateStart&&s.DateEnd===v.DateEnd)),o=({callback:v})=>{d.saveTicket(a.value).then(m=>{m?(a.value.ID=m.ID,a.value.TicketUUID=m.TicketUUID,r.value=a.value,v&&v("Ticket Saved")):v&&v("Failed to Save Ticket")}).catch(()=>{v&&v("Failed to Save Ticket")})};return(v,m)=>(c(),C(B,{class:"px-0",fluid:""},{default:l(()=>[e(A,null,{default:l(()=>[e(g,{cols:"12"},{default:l(()=>[e(se,{label:"Ticket Type",variant:"outlined",modelValue:a.value.Type,"onUpdate:modelValue":m[0]||(m[0]=s=>a.value.Type=s),items:I(He),"item-title":"title","item-value":"value","hide-details":""},null,8,["modelValue","items"])]),_:1}),e(g,{cols:"12"},{default:l(()=>[e(F,{label:I(O).formLabelName,type:"text",variant:"outlined",modelValue:a.value.Name,"onUpdate:modelValue":m[1]||(m[1]=s=>a.value.Name=s),"hide-details":""},null,8,["label","modelValue"])]),_:1}),e(g,{cols:"12"},{default:l(()=>[e(F,{label:I(O).formLabelDescription,type:"text",variant:"outlined",modelValue:a.value.Description,"onUpdate:modelValue":m[2]||(m[2]=s=>a.value.Description=s),"hide-details":""},null,8,["label","modelValue"])]),_:1}),a.value.Type!==I(L).TICKET_TYPE_GROUP?(c(),E($,{key:0},[e(g,{cols:"12"},{default:l(()=>[e(X,{label:I(O).formLabelRequiresAccommodation,modelValue:a.value.RequiresAccommodation,"onUpdate:modelValue":m[3]||(m[3]=s=>a.value.RequiresAccommodation=s),"hide-details":""},null,8,["label","modelValue"])]),_:1}),e(g,{cols:"12"},{default:l(()=>[e(F,{label:I(O).formLabelDateStart,type:"date",variant:"outlined",modelValue:a.value.DateStart,"onUpdate:modelValue":m[4]||(m[4]=s=>a.value.DateStart=s),"hide-details":""},null,8,["label","modelValue"])]),_:1}),e(g,{cols:"12"},{default:l(()=>[e(F,{label:I(O).formLabelDateEnd,type:"date",variant:"outlined",modelValue:a.value.DateEnd,"onUpdate:modelValue":m[5]||(m[5]=s=>a.value.DateEnd=s),"hide-details":""},null,8,["label","modelValue"])]),_:1}),e(g,{cols:"12"},{default:l(()=>[e(F,{label:I(O).formLabelPrice,type:"text",variant:"outlined","prepend-inner-icon":I(O).currencyIcon,modelValue:a.value.Price,"onUpdate:modelValue":m[6]||(m[6]=s=>a.value.Price=s),modelModifiers:{number:!0},"persistent-hint":"",hint:"Adds additional charges for selecting this ticket"},null,8,["label","prepend-inner-icon","modelValue"])]),_:1})],64)):(c(),C(g,{key:1,cols:"12"},{default:l(()=>[e(ge,{label:"Tickets",variant:"outlined",tickets:i.value,modelValue:a.value.Tickets,"onUpdate:modelValue":m[7]||(m[7]=s=>a.value.Tickets=s),chips:"",clearable:"",multiple:"","persistent-hint":"",hint:"Tickets that belong to this group."},null,8,["tickets","modelValue"])]),_:1})),e(g,{cols:"12"},{default:l(()=>[e(oe,{label:"Applied Tags",variant:"outlined",modelValue:a.value.AppliesTags,"onUpdate:modelValue":m[8]||(m[8]=s=>a.value.AppliesTags=s),convention:v.convention,organisation:v.convention.OrganisationUUID,chips:"",clearable:"",hint:"Tags that a user acquires by selecting this ticket."},null,8,["modelValue","convention","organisation"])]),_:1}),e(g,{cols:"12"},{default:l(()=>[e(oe,{label:"Required Tags",variant:"outlined",modelValue:a.value.RequiredTags,"onUpdate:modelValue":m[9]||(m[9]=s=>a.value.RequiredTags=s),convention:v.convention,organisation:v.convention.OrganisationUUID,chips:"",clearable:"",hint:"Tags that a user must have to see this ticket."},null,8,["modelValue","convention","organisation"])]),_:1}),a.value.Type===I(L).TICKET_TYPE_TICKET?(c(),E($,{key:2},[e(g,{cols:"12"},{default:l(()=>[e(F,{label:"Components Required",type:"number",variant:"outlined",modelValue:a.value.ComponentsRequired,"onUpdate:modelValue":m[10]||(m[10]=s=>a.value.ComponentsRequired=s),modelModifiers:{number:!0},"persistent-hint":"",hint:"How many components must be selected."},null,8,["modelValue"])]),_:1}),e(g,{cols:"12"},{default:l(()=>[e(ge,{label:"Components",variant:"outlined",tickets:u.value,modelValue:a.value.TicketComponents,"onUpdate:modelValue":m[11]||(m[11]=s=>a.value.TicketComponents=s),chips:"",clearable:"",multiple:"","persistent-hint":"",hint:"Components that are part of this ticket (and others)."},null,8,["tickets","modelValue"])]),_:1}),e(g,{cols:"12"},{default:l(()=>[e(ge,{label:"Addons",variant:"outlined",tickets:n.value,modelValue:a.value.AddonTickets,"onUpdate:modelValue":m[12]||(m[12]=s=>a.value.AddonTickets=s),chips:"",clearable:"",multiple:"","persistent-hint":"",hint:"Optional ticket addons that apply for this ticket."},null,8,["tickets","modelValue"])]),_:1})],64)):S("",!0),e(g,{cols:"12"},{default:l(()=>[e(ge,{label:"Disables Tickets",variant:"outlined",tickets:v.tickets,modelValue:a.value.DisablesTickets,"onUpdate:modelValue":m[13]||(m[13]=s=>a.value.DisablesTickets=s),chips:"",clearable:"",multiple:"","persistent-hint":"",hint:"Tickets that are mutually exclusive and can't be selected if this one is."},null,8,["tickets","modelValue"])]),_:1})]),_:1}),t(a.value).length?(c(),C(A,{key:0,class:"align-center",dense:!0},{default:l(()=>[e(g,{class:"flex-grow-0 flex-shrink-1 text-no-wrap font-italic"},{default:l(()=>[Ul]),_:1}),e(g,{class:"flex-grow-1"},{default:l(()=>[e(qe,null,{default:l(()=>[(c(!0),E($,null,K(t(a.value),s=>(c(),C(Me,{key:s.ID,title:"Automatically calculated",disabled:!0},{default:l(()=>[b(R(s.Name),1)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})):S("",!0),e(A,null,{default:l(()=>[e(g,{class:"text-right"},{default:l(()=>[e(Z,{onClick:o})]),_:1})]),_:1})]),_:1}))}}),Dl={class:"pr-2"},Il={class:"mb-2"},gl={key:0,class:"text-grey-darken-1 font-italic"},_l={key:1,class:"text-red"},yl={key:0,class:"text-grey-darken-1 font-italic"},Cl={key:1,class:"text-red"},bl={key:0,class:"text-grey-darken-1 font-italic"},kl={key:1,class:"text-red"},El={class:"text-grey-darken-1"},hl=x({__name:"EditConventionTickets",props:P({accommodation:{default:()=>[]},convention:{}},{modelValue:{default:[]}}),emits:P(["close"],["update:modelValue"]),setup(f,{emit:r}){const a=M(f,"modelValue"),d=Y(),i=()=>{a.value.push({ID:0,TicketUUID:q(),ConventionID:f.convention.ID,ConventionUUID:f.convention.ConventionUUID,Order:a.value.length+1,Name:"New Ticket",Type:L.TICKET_TYPE_GROUP,Description:"",DateStart:"",DateEnd:"",Price:0,Tickets:[],RequiresAccommodation:!1,AppliesTags:[],RequiredTags:[],RequiredGroupMemberships:[],TicketComponents:[],ComponentsRequired:0,AddonTickets:[],DisablesTickets:[]})},n=t=>{d.deleteTicket(a.value[t].TicketUUID).then(o=>{o&&a.value.splice(t,1)})},u=t=>t.Type===L.TICKET_TYPE_GROUP?"mdi:mdi-group":t.Type===L.TICKET_TYPE_TICKET?t.RequiresAccommodation?"mdi:mdi-home":t.ComponentsRequired>0?"mdi:mdi-ticket-confirmation":"mdi:mdi-ticket":t.Type===L.TICKET_TYPE_TICKET_COMPONENT?"mdi:mdi-cog-outline":t.Type===L.TICKET_TYPE_ADD_ON?"mdi:mdi-home-plus":"mdi:mdi-help";return(t,o)=>(c(),C(de,null,{default:l(()=>[e(ne,{dark:"",color:"primary"},{default:l(()=>[e(N,{icon:"",dark:"",onClick:o[0]||(o[0]=v=>r("close"))},{default:l(()=>[e(z,null,{default:l(()=>[b("mdi:mdi-close")]),_:1})]),_:1}),e(ue,null,{default:l(()=>[b("Edit Tickets")]),_:1}),e(ee),e(ve,null,{default:l(()=>[e(N,{variant:"text",onClick:i},{default:l(()=>[b(" Add Ticket ")]),_:1})]),_:1})]),_:1}),e(ce,{class:"pa-0"},{default:l(()=>[e(fe,null,{default:l(()=>[(c(!0),E($,null,K(a.value,(v,m)=>(c(),C(Ve,{key:v.ID,class:"mt-0"},{default:l(()=>[e(Ue,{class:"py-2"},{actions:l(({expanded:s})=>[e(Z,{class:"mr-1",color:"red",icon:"mdi:mdi-close",size:"x-small",onClick:p=>n(m)},null,8,["onClick"]),e(z,{class:"align-self-center text-h5",icon:s?"mdi:mdi-chevron-up":"mdi:mdi-chevron-down",variant:"flat",size:"x-small"},null,8,["icon"])]),default:l(()=>[e(N,{icon:"mdi:mdi-menu-up",size:"x-small",color:"primary",class:"mr-1",onClick:re(s=>I(Ne)(v,a.value),["stop"])},null,8,["onClick"]),e(N,{icon:"mdi:mdi-menu-down",size:"x-small",color:"secondary",class:"mr-4",onClick:re(s=>I(Ae)(v,a.value),["stop"])},null,8,["onClick"]),h("div",Dl,[e(z,{icon:u(v)},null,8,["icon"])]),h("div",null,[h("p",Il,[b(R(v.Name)+" ",1),v.Type===I(L).TICKET_TYPE_TICKET?(c(),E($,{key:0},[a.value.find(s=>s.Type===I(L).TICKET_TYPE_GROUP&&s.Tickets.find(p=>p&&p.TicketUUID===v.TicketUUID))?(c(),E("span",gl," ("+R(a.value.filter(s=>s.Type===I(L).TICKET_TYPE_GROUP&&s.Tickets.find(p=>p&&p.TicketUUID===v.TicketUUID)).map(s=>s.Name).join(", "))+") ",1)):(c(),E("span",_l," (Ticket does not belong to any categories.) "))],64)):S("",!0),v.Type===I(L).TICKET_TYPE_ADD_ON?(c(),E($,{key:1},[a.value.find(s=>s.Type===I(L).TICKET_TYPE_TICKET&&s.AddonTickets.find(p=>p&&p.TicketUUID===v.TicketUUID))?(c(),E("span",yl," ("+R(a.value.filter(s=>s.Type===I(L).TICKET_TYPE_TICKET&&s.AddonTickets.find(p=>p&&p.TicketUUID===v.TicketUUID)).map(s=>s.Name).join(", "))+") ",1)):(c(),E("span",Cl," (Ticket addon must be associated to at least one ticket.) "))],64)):S("",!0),v.Type===I(L).TICKET_TYPE_TICKET_COMPONENT?(c(),E($,{key:2},[a.value.find(s=>s.Type===I(L).TICKET_TYPE_TICKET&&s.TicketComponents.find(p=>p&&p.TicketUUID===v.TicketUUID))?(c(),E("span",bl," ("+R(a.value.filter(s=>s.Type===I(L).TICKET_TYPE_TICKET&&s.TicketComponents.find(p=>p&&p.TicketUUID===v.TicketUUID)).map(s=>s.Name).join(", "))+") ",1)):(c(),E("span",kl," (Component has not been assigned to any tickets.) "))],64)):S("",!0)]),h("p",El,[v.Type===I(L).TICKET_TYPE_GROUP?(c(),E($,{key:0},[b("Category")],64)):v.Type===I(L).TICKET_TYPE_TICKET?(c(),E($,{key:1},[b(" Ticket "),v.ComponentsRequired>0?(c(),E($,{key:0},[b(" ("+R(v.ComponentsRequired)+" component"+R(v.ComponentsRequired>1?"s":"")+" required) ",1)],64)):S("",!0)],64)):S("",!0),v.Type===I(L).TICKET_TYPE_TICKET_COMPONENT?(c(),E($,{key:2},[b("Component")],64)):S("",!0),v.Type===I(L).TICKET_TYPE_ADD_ON?(c(),E($,{key:3},[b("Addon")],64)):S("",!0)])])]),_:2},1024),e(Te,{class:"px-0"},{default:l(()=>[e(Tl,{accommodation:t.accommodation,convention:t.convention,tickets:a.value,modelValue:a.value[m],"onUpdate:modelValue":s=>a.value[m]=s},null,8,["accommodation","convention","tickets","modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1}))}}),$l=h("h3",null,"Tickets",-1),Nl=h("p",null,"Ticket options, along with all sub-types and options applicable to them.",-1),Al=x({__name:"Tickets",props:{modelValue:{required:!0}},emits:P(["refresh"],["update:modelValue"]),setup(f){var s;const r=M(f,"modelValue"),a=Y(),d=_([]),i=_([]);a.getConventionTickets(((s=r.value)==null?void 0:s.ConventionUUID)||"").then(p=>{Oe(p),d.value=p});const n=_([""]),u=_(!1),t=p=>p.AddonTickets&&p.AddonTickets.map(V=>d.value&&d.value.find(U=>U.ID===V.ID)),o=p=>p.TicketComponents&&p.TicketComponents.map(V=>d.value&&d.value.find(U=>U.ID===V.ID)),v=p=>"",m=p=>i.value.filter(V=>V.Costs.find(U=>U.DateStart===p.DateStart&&U.DateEnd===p.DateEnd)).map(V=>V.Name).join(", ");return(p,V)=>(c(),E($,null,[e(B,{fluid:!0,class:"px-0"},{default:l(()=>[e(A,null,{default:l(()=>[e(g,null,{default:l(()=>[$l]),_:1}),e(g,{class:"text-right"},{default:l(()=>[e(N,{color:"primary",onClick:V[0]||(V[0]=U=>u.value=!0)},{default:l(()=>[b("Edit")]),_:1})]),_:1})]),_:1})]),_:1}),Nl,e(ke,{opened:n.value,"onUpdate:opened":V[1]||(V[1]=U=>n.value=U)},{default:l(()=>[(c(!0),E($,null,K(d.value.filter(U=>U.Type===I(L).TICKET_TYPE_GROUP),U=>(c(),C($e,{key:U.ID,value:U.ID},{activator:l(({props:T})=>[e(te,Ee(T,{"prepend-icon":"mdi:mdi-group",title:U.Name}),null,16,["title"])]),default:l(()=>[(c(!0),E($,null,K(d.value.filter(T=>U.Tickets.find(D=>D&&T&&D.TicketUUID===T.TicketUUID)),T=>(c(),E($,{key:T.ID},[T.AddonTickets&&T.AddonTickets.length?(c(),C($e,{key:0,value:T.ID},{activator:l(({props:D})=>[e(te,Ee(D,{"prepend-icon":T.RequiresAccommodation?"mdi:mdi-home":T.ComponentsRequired>0?"mdi:mdi-ticket-confirmation":"mdi:mdi-ticket",title:`${T.Name} ${T.Price>0?`(${I(O).currencySymbol}${T.Price})`:""}`}),{default:l(()=>[T.ComponentsRequired>0?(c(),C(le,{key:0},{default:l(()=>[b(" Options: "+R(o(T).map(y=>y&&y.Name).join(", ")),1)]),_:2},1024)):S("",!0),T.RequiresAccommodation&&m(T)?(c(),C(le,{key:1},{default:l(()=>[b(" Accommodation: "+R(m(T)),1)]),_:2},1024)):S("",!0)]),_:2},1040,["prepend-icon","title"])]),default:l(()=>[(c(!0),E($,null,K(t(T),D=>(c(),E($,{key:D},[D?(c(),C(te,{key:0,title:`${D.Name} ${D.Price>0?`(${I(O).currencySymbol}${D.Price})`:""}`,"prepend-icon":"mdi:mdi-home-plus"},{default:l(()=>[D.RequiredTags&&D.RequiredTags.length>0?(c(),C(le,{key:0},{default:l(()=>[b(" Required Tags: "+R(D.RequiredTags.join(", ")),1)]),_:2},1024)):S("",!0),D.RequiredGroupMemberships&&D.RequiredGroupMemberships.length>0?(c(),C(le,{key:1},{default:l(()=>[b(" Required Groups: "+R(v(D.RequiredGroupMemberships)),1)]),_:2},1024)):S("",!0),m(D)?(c(),C(le,{key:2},{default:l(()=>[b(" Accommodation: "+R(m(D)),1)]),_:2},1024)):S("",!0)]),_:2},1032,["title"])):S("",!0)],64))),128))]),_:2},1032,["value"])):(c(),C(te,{key:1,"prepend-icon":T.RequiresAccommodation?"mdi:mdi-home":T.ComponentsRequired>0?"mdi:mdi-ticket-confirmation":"mdi:mdi-ticket",title:`${T.Name} ${T.Price>0?`(${I(O).currencySymbol}${T.Price})`:""}`},{default:l(()=>[T.ComponentsRequired>0?(c(),C(le,{key:0},{default:l(()=>[b(" Options: "+R(o(T).map(D=>D&&D.Name).join(", ")),1)]),_:2},1024)):S("",!0)]),_:2},1032,["prepend-icon","title"]))],64))),128))]),_:2},1032,["value"]))),128))]),_:1},8,["opened"]),e(pe,{modelValue:u.value,"onUpdate:modelValue":V[4]||(V[4]=U=>u.value=U),scrollable:!0},{default:l(()=>[e(hl,{onClose:V[2]||(V[2]=U=>u.value=!1),modelValue:d.value,"onUpdate:modelValue":V[3]||(V[3]=U=>d.value=U),accommodation:i.value,convention:r.value},null,8,["modelValue","accommodation","convention"])]),_:1},8,["modelValue"])],64))}}),Fl=x({__name:"VenueRoomCost",props:{modelValue:{required:!0}},emits:P(["deleted"],["update:modelValue"]),setup(f,{emit:r}){const a=M(f,"modelValue"),d=[{title:"Per Room",value:"PER_ROOM"},{title:"Per Person",value:"PER_PERSON"}],i=()=>{r("deleted")};return(n,u)=>(c(),C(A,{dense:""},{default:l(()=>[e(g,{cols:"12",sm:"4",md:"2",lg:"2"},{default:l(()=>[e(F,{label:I(O).formLabelDateStart,type:"date",variant:"outlined",modelValue:a.value.DateStart,"onUpdate:modelValue":u[0]||(u[0]=t=>a.value.DateStart=t)},null,8,["label","modelValue"])]),_:1}),e(g,{cols:"12",sm:"4",md:"2",lg:"2"},{default:l(()=>[e(F,{label:I(O).formLabelDateEnd,type:"date",variant:"outlined",modelValue:a.value.DateEnd,"onUpdate:modelValue":u[1]||(u[1]=t=>a.value.DateEnd=t)},null,8,["label","modelValue"])]),_:1}),e(g,{cols:"6",sm:"4",md:"2",lg:"2"},{default:l(()=>[e(F,{label:I(O).formLabelAvailability,type:"number",variant:"outlined",modelValue:a.value.Availability,"onUpdate:modelValue":u[2]||(u[2]=t=>a.value.Availability=t),modelModifiers:{number:!0}},null,8,["label","modelValue"])]),_:1}),e(g,{cols:"6",sm:"4",md:"2",lg:"2"},{default:l(()=>[e(F,{label:I(O).formLabelPrice,type:"number","prepend-inner-icon":"mdi:mdi-currency-gbp",variant:"outlined",modelValue:a.value.Price,"onUpdate:modelValue":u[3]||(u[3]=t=>a.value.Price=t),modelModifiers:{number:!0}},null,8,["label","modelValue"])]),_:1}),e(g,{cols:"6",sm:"4",md:"3",lg:"3"},{default:l(()=>[e(se,{label:I(O).formLabelPriceType,variant:"outlined",modelValue:a.value.Type,"onUpdate:modelValue":u[4]||(u[4]=t=>a.value.Type=t),items:d,"item-value":"value","item-title":"title"},null,8,["label","modelValue"])]),_:1}),e(g,{cols:"6",sm:"4",md:"1",class:"text-right"},{default:l(()=>[e(N,{color:"red",icon:"mdi:mdi-minus",onClick:i})]),_:1})]),_:1}))}}),Sl=h("strong",null,"Capacity:",-1),Rl=h("thead",null,[h("tr",null,[h("th",null,"Date"),h("th",null,"Price"),h("th",null,"Availability")])],-1),Pl={class:"d-flex flex-wrap justify-space-between",style:{gap:"1rem"}},Ol=h("h4",null," Availability & Costs (To Organisation) ",-1),xl=x({__name:"VenueRoom",props:{modelValue:{required:!0}},emits:P(["deleted"],["update:modelValue"]),setup(f,{emit:r}){const a=Y(),d=_(O),i=M(f,"modelValue"),n=_(j(i.value)),u=_(!1),t=p=>{switch(p.Type){case Ce.PER_PERSON:return d.value.enumPER_PERSON;case Ce.PER_ROOM:return d.value.enumPER_ROOM}return"Unknown"},o=()=>{n.value.Costs||(n.value.Costs=[]),n.value.Costs.push({ID:0,CostUUID:q(),Availability:0,DateStart:"",DateEnd:"",Price:0,Type:"PER_ROOM"})},v=p=>{n.value.Costs.splice(p,1)},m=({callback:p})=>{const V=()=>{p&&p("Failed to Delete Room")},U=()=>{p&&p("Room Deleted")};a.deleteRoom(n.value.RoomUUID).then(T=>{T?(U(),r("deleted",n.value)):V()}).catch(()=>{V()})},s=()=>{a.saveRoom(n.value).then(()=>{i.value=n.value,u.value=!1})};return(p,V)=>(c(),E($,null,[e(B,{fluid:"",class:"pa-1 pa-sm-2"},{default:l(()=>[h("h4",null,R(n.value.Name),1),h("p",null,R(n.value.Notes),1),h("p",null,[Sl,b(" "+R(n.value.MinimumCapacity)+" ",1),n.value.MinimumCapacity!=n.value.MaximumCapacity?(c(),E($,{key:0},[b(" - "+R(n.value.MaximumCapacity),1)],64)):S("",!0)]),e(ll,{density:"compact"},{default:l(()=>[Rl,h("tbody",null,[(c(!0),E($,null,K(n.value.Costs,U=>(c(),E("tr",{key:`venue-room-${n.value.ID}-cost-${U.ID}`},[h("td",null,R(U.DateStart)+" - "+R(U.DateEnd),1),h("td",null,R(d.value.currencySymbol)+R(U.Price)+" "+R(t(U)),1),h("td",null,R(U.Availability),1)]))),128))])]),_:1}),h("div",Pl,[e(N,{color:"primary","prepend-icon":"mdi:mdi-playlist-edit",onClick:V[0]||(V[0]=U=>u.value=!0)},{default:l(()=>[b("Edit Room")]),_:1}),e(Z,{color:"red-darken-3","prepend-icon":"mdi:mdi-minus",onClick:m},{default:l(()=>[b("Delete Room")]),_:1})])]),_:1}),e(pe,{scrollable:"",modelValue:u.value,"onUpdate:modelValue":V[6]||(V[6]=U=>u.value=U),width:"auto"},{default:l(()=>[e(de,null,{default:l(()=>[e(ne,{dark:"",color:"primary"},{default:l(()=>[e(N,{icon:"",dark:"",onClick:V[1]||(V[1]=U=>u.value=!1)},{default:l(()=>[e(z,null,{default:l(()=>[b("mdi:mdi-close")]),_:1})]),_:1}),e(ue,null,{default:l(()=>[b("Room Details ("+R(n.value.Name)+")",1)]),_:1}),e(ee),e(ve,null,{default:l(()=>[e(N,{variant:"text",onClick:s},{default:l(()=>[b(" Save ")]),_:1})]),_:1})]),_:1}),e(ce,null,{default:l(()=>[e(ae,null,{default:l(()=>[e(A,null,{default:l(()=>[e(g,{cols:"12"},{default:l(()=>[e(F,{label:d.value.formLabelName,type:"text",variant:"outlined",modelValue:n.value.Name,"onUpdate:modelValue":V[2]||(V[2]=U=>n.value.Name=U)},null,8,["label","modelValue"])]),_:1})]),_:1}),e(A,null,{default:l(()=>[e(g,null,{default:l(()=>[e(Ie,{label:d.value.formLabelNotes,variant:"outlined",modelValue:n.value.Notes,"onUpdate:modelValue":V[3]||(V[3]=U=>n.value.Notes=U)},null,8,["label","modelValue"])]),_:1})]),_:1}),e(A,null,{default:l(()=>[e(g,{cols:"12",sm:"6"},{default:l(()=>[e(F,{type:"number",label:d.value.formLabelMinimumCapacity,variant:"outlined",modelValue:n.value.MinimumCapacity,"onUpdate:modelValue":V[4]||(V[4]=U=>n.value.MinimumCapacity=U),modelModifiers:{number:!0}},null,8,["label","modelValue"])]),_:1}),e(g,{cols:"12",sm:"6"},{default:l(()=>[e(F,{type:"number",label:d.value.formLabelMaximumCapacity,variant:"outlined",modelValue:n.value.MaximumCapacity,"onUpdate:modelValue":V[5]||(V[5]=U=>n.value.MaximumCapacity=U),modelModifiers:{number:!0}},null,8,["label","modelValue"])]),_:1})]),_:1}),e(A,null,{default:l(()=>[e(g,null,{default:l(()=>[Ol]),_:1})]),_:1}),(c(!0),E($,null,K(n.value.Costs,(U,T)=>(c(),E($,{key:`venue-room-${n.value.ID}-cost-${U.ID}`},[n.value.Costs&&n.value.Costs[T]?(c(),C(Fl,{key:0,modelValue:n.value.Costs[T],"onUpdate:modelValue":D=>n.value.Costs[T]=D,onDeleted:D=>v(T)},null,8,["modelValue","onUpdate:modelValue","onDeleted"])):S("",!0)],64))),128)),e(N,{color:"primary","prepend-icon":"mdi:mdi-plus",onClick:o},{default:l(()=>[b("Add Row")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}}),wl=h("h3",null,"Rooms",-1),ql=x({__name:"Venue",props:{modelValue:{required:!0}},emits:P(["deleted"],["update:modelValue"]),setup(f,{emit:r}){const a=Y(),d=M(f,"modelValue"),i=_(j(d.value)),n=_([]),u=_(!1),t=_(!1);a.getVenueRooms(i.value.VenueUUID).then(p=>{n.value=p}),H(i.value,()=>{t.value=!0});const o=({callback:p})=>{u.value=!0,a.saveVenue(i.value).then(()=>{u.value=!1,t.value=!1,d.value=i.value,p&&p("Venue Saved")}).catch(()=>{u.value=!1,p&&p("Failed to Saved Venue")})},v=({callback:p})=>{u.value=!0,a.deleteVenue(i.value.VenueUUID).then(V=>{u.value=!1,V?p&&(p("Venue Deleted"),r("deleted")):p&&p("Failed to Delete Venue")}).catch(()=>{p&&(p("Failed to Delete Venue"),u.value=!1)})},m=()=>{const p={ID:0,RoomUUID:q(),VenueID:i.value.ID,VenueUUID:i.value.VenueUUID,Order:n.value.length+1,Name:"New Room",Notes:"",MaximumCapacity:1,MinimumCapacity:1,Costs:[]};a.saveRoom(p).then(V=>{V&&n.value.push(V)})},s=(p,V)=>{a.deleteRoom(n.value[V].RoomUUID).then(U=>{U&&n.value.splice(V,1)})};return(p,V)=>(c(),C(Ve,null,{default:l(()=>[e(Ue,null,{default:l(()=>[b(R(i.value.Name),1)]),_:1}),e(Te,null,{default:l(()=>[e(A,{"no-gutters":""},{default:l(()=>[e(g,{cols:"12"},{default:l(()=>[e(F,{label:I(O).formLabelName,name:"name",variant:"outlined",modelValue:i.value.Name,"onUpdate:modelValue":V[0]||(V[0]=U=>i.value.Name=U)},null,8,["label","modelValue"])]),_:1}),e(g,{cols:"12"},{default:l(()=>[e(Ie,{label:I(O).formLabelDescription,name:"description",variant:"outlined",modelValue:i.value.Description,"onUpdate:modelValue":V[1]||(V[1]=U=>i.value.Description=U)},null,8,["label","modelValue"])]),_:1}),e(g,{class:"text-right",cols:"12"},{default:l(()=>[e(Z,{class:"mr-2",color:"red-darken-3",label:"Delete",onClick:v}),e(Z,{enabled:t.value,timeout:"7",onClick:o},null,8,["enabled"])]),_:1})]),_:1}),wl,(c(!0),E($,null,K(n.value,(U,T)=>(c(),C(ae,{variant:"elevation",elevation:"6",key:`venue-room-${U.ID}`},{default:l(()=>[n.value&&n.value[T]?(c(),C(xl,{key:0,modelValue:n.value[T],"onUpdate:modelValue":D=>n.value[T]=D,onDeleted:D=>s(D,T)},null,8,["modelValue","onUpdate:modelValue","onDeleted"])):S("",!0)]),_:2},1024))),128)),e(ae,{class:"ma-2"},{default:l(()=>[e(N,{color:"primary","prepend-icon":"mdi:mdi-plus",onClick:m},{default:l(()=>[b("Add Room")]),_:1})]),_:1})]),_:1})]),_:1}))}}),Ml=h("h3",null,"Venues",-1),Ll=h("p",null," Venues and the rooms they supply to the organisation, this is internal data not seen by attendees. ",-1),Kl=h("p",null," Attendee options are configured via the accommodation tab. ",-1),Yl=x({__name:"VenuesEditorView",props:{modelValue:{required:!0}},emits:P(["close","pageTitle","refresh"],["update:modelValue"]),setup(f,{emit:r}){const a=Y(),d=M(f,"modelValue");r("pageTitle","Venues");const i=_([]);a.getConventionVenues(d.value.ConventionUUID).then(t=>{i.value=t});const n=()=>{const t={ID:0,VenueUUID:q(),ConventionID:d.value.ID,ConventionUUID:d.value.ConventionUUID,Order:i.value.length+1,Name:"New Venue",Description:"",Rooms:[]};a.saveVenue(t).then(o=>{o&&i.value.push(o)})},u=t=>{i.value.splice(t,1)};return(t,o)=>(c(),E($,null,[e(B,{fluid:"",class:"px-0"},{default:l(()=>[e(A,null,{default:l(()=>[e(g,null,{default:l(()=>[Ml]),_:1})]),_:1})]),_:1}),Ll,Kl,e(ae,null,{default:l(()=>[e(fe,{variant:"accordion"},{default:l(()=>[(c(!0),E($,null,K(i.value,(v,m)=>(c(),C(ql,{key:`venues-${v.ID}`,modelValue:i.value[m],"onUpdate:modelValue":s=>i.value[m]=s,onDeleted:s=>u(m)},null,8,["modelValue","onUpdate:modelValue","onDeleted"]))),128))]),_:1}),e(ae,{class:"pa-2"},{default:l(()=>[e(N,{color:"primary",onClick:n},{default:l(()=>[b("Add Venue")]),_:1})]),_:1})]),_:1})],64))}}),Gl=h("p",{title:"Automatically calculated",class:"text-grey-lighten-1"},"Applicable Tickets:",-1),jl=x({__name:"AccommodationCost",props:P({convention:{}},{modelValue:{required:!0}}),emits:P(["deleted"],["update:modelValue"]),setup(f,{emit:r}){const a=M(f,"modelValue"),d=_([]);Y().getConventionTickets(f.convention.ConventionUUID).then(o=>{o&&(d.value=o)});const n=[{title:"Per Room",value:"PER_ROOM"},{title:"Per Person",value:"PER_PERSON"}],u=()=>{r("deleted")},t=Q(()=>d.value.filter(o=>(o.Type===L.TICKET_TYPE_TICKET||o.Type===L.TICKET_TYPE_ADD_ON)&&o.RequiresAccommodation&&o.DateStart===a.value.DateStart&&o.DateEnd===a.value.DateEnd));return(o,v)=>(c(),E($,null,[e(A,{class:"align-center",dense:""},{default:l(()=>[e(g,{class:"flex-grow-0 flex-shrink-1 text-no-wrap font-italic"},{default:l(()=>[Gl]),_:1}),e(g,{class:"flex-grow-1"},{default:l(()=>[e(qe,null,{default:l(()=>[(c(!0),E($,null,K(t.value,m=>(c(),C(Me,{key:m.ID,title:"Automatically calculated",disabled:""},{default:l(()=>[b(R(m.Name),1)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1}),e(A,{dense:""},{default:l(()=>[e(g,{cols:"12",sm:"6",md:"3"},{default:l(()=>[e(F,{label:I(O).formLabelDateStart,type:"date",variant:"outlined",modelValue:a.value.DateStart,"onUpdate:modelValue":v[0]||(v[0]=m=>a.value.DateStart=m)},null,8,["label","modelValue"])]),_:1}),e(g,{cols:"12",sm:"6",md:"3"},{default:l(()=>[e(F,{label:I(O).formLabelDateEnd,type:"date",variant:"outlined",modelValue:a.value.DateEnd,"onUpdate:modelValue":v[1]||(v[1]=m=>a.value.DateEnd=m)},null,8,["label","modelValue"])]),_:1}),e(g,{cols:"5",sm:"6",md:"3"},{default:l(()=>[e(F,{label:I(O).formLabelPrice,type:"number","prepend-inner-icon":"mdi:mdi-currency-gbp",variant:"outlined",modelValue:a.value.Price,"onUpdate:modelValue":v[2]||(v[2]=m=>a.value.Price=m),modelModifiers:{number:!0}},null,8,["label","modelValue"])]),_:1}),e(g,{cols:"5",sm:"4",md:"2"},{default:l(()=>[e(se,{label:I(O).formLabelPriceType,variant:"outlined",modelValue:a.value.Type,"onUpdate:modelValue":v[3]||(v[3]=m=>a.value.Type=m),items:n,"item-value":"value","item-title":"title"},null,8,["label","modelValue"])]),_:1}),e(g,{cols:"2",sm:"2",md:"1",class:"text-right"},{default:l(()=>[e(N,{color:"red",icon:"mdi:mdi-minus",onClick:u})]),_:1})]),_:1})],64))}}),Bl=h("h4",null," Room Pool ",-1),zl=h("p",{class:"mb-4"}," Hotel rooms that can be used for this accommodation option. ",-1),Hl=h("p",null," Pool total: ",-1),Jl=h("h4",null," Accommodation Costs ",-1),Xl=h("p",{class:"mb-4"}," How much the attendee is charged by the convention for the accommodation. ",-1),Wl=x({__name:"Accommodation",props:P({convention:{},venues:{}},{modelValue:{required:!0}}),emits:P(["deleted"],["update:modelValue"]),setup(f,{emit:r}){const a=Y(),d=M(f,"modelValue"),i=_(j(d.value)),n=Q(()=>f.venues.map(m=>m.Rooms.map(s=>({title:` ${m.Name} - ${s.Name}`,value:s}))).flat()),u=()=>{i.value.Costs||(i.value.Costs=[]),i.value.Costs.push({ID:0,CostUUID:q(),Availability:0,DateStart:"",DateEnd:"",Price:0,Type:Ce.PER_ROOM})},t=m=>{i.value.Costs.splice(m,1)},o=({callback:m})=>{a.deleteAccommodation(i.value.AccommodationUUID).then(s=>{s?m&&(m("Accommodation Deleted"),r("deleted")):m&&m("Failed to Delete Accommodation")}).catch(()=>{m&&m("Failed to Delete Accommodation")})},v=({callback:m})=>{a.saveAccommodation(i.value).then(s=>{s?(i.value.ID=s.ID,d.value=s,m&&m("Accommodation Saved")):m&&m("Failed to Save Accommodation")}).catch(()=>{m&&m("Failed to Save Accommodation")})};return(m,s)=>(c(),C(Ve,null,{default:l(()=>[e(Ue,null,{default:l(()=>[b(R(i.value.Name),1)]),_:1}),e(Te,null,{default:l(()=>[e(ae,null,{default:l(()=>[e(A,null,{default:l(()=>[e(g,null,{default:l(()=>[e(F,{modelValue:i.value.Name,"onUpdate:modelValue":s[0]||(s[0]=p=>i.value.Name=p),label:"Name",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1})]),_:1}),e(A,null,{default:l(()=>[e(g,null,{default:l(()=>[Bl,zl,e(se,{clearable:!0,modelValue:i.value.Pool,"onUpdate:modelValue":s[1]||(s[1]=p=>i.value.Pool=p),items:n.value,label:"Select",multiple:"",hint:"Pick appropriate rooms","persistent-hint":"",variant:"outlined","item-title":"title","item-value":"value",eager:!0},null,8,["modelValue","items"]),Hl,h("p",null,[e(oe,{label:"Required Tags",variant:"outlined",modelValue:i.value.RequiredTags,"onUpdate:modelValue":s[2]||(s[2]=p=>i.value.RequiredTags=p),convention:m.convention,organisation:m.convention.OrganisationUUID,chips:!0,clearable:!0,hint:"Tags that a user must have to select this accommodation."},null,8,["modelValue","convention","organisation"])]),Jl,Xl,i.value.Costs?(c(!0),E($,{key:0},K(i.value.Costs,(p,V)=>(c(),C(jl,{key:`venue-room-${i.value.ID}-cost-${p.ID}`,convention:m.convention,modelValue:i.value.Costs[V],"onUpdate:modelValue":U=>i.value.Costs[V]=U,onDeleted:U=>t(V)},null,8,["convention","modelValue","onUpdate:modelValue","onDeleted"]))),128)):S("",!0)]),_:1})]),_:1}),e(A,{"no-gutters":""},{default:l(()=>[e(g,{class:"text-left"},{default:l(()=>[e(N,{color:"primary","prepend-icon":"mdi:mdi-plus",onClick:u},{default:l(()=>[b("Add Row")]),_:1})]),_:1}),e(g,{class:"text-right"},{default:l(()=>[e(Z,{class:"mr-2",color:"red-darken-3",label:"Delete",onClick:o}),e(Z,{onClick:v})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}))}}),Ql=h("h3",null,"Accommodation",-1),Zl=h("p",null," Accommodation options presented to attendees, these are effectively virtual room types which are linked to the available room pools created in the venues tab. ",-1),et=h("p",null," Use the venues tab to configure internal data about the venues and room supply. ",-1),lt=x({__name:"AccommodationEditorView",props:{modelValue:{required:!0}},emits:["update:modelValue"],setup(f){const r=Y(),a=M(f,"modelValue"),d=_([]),i=_([]);r.getConventionAccommodation(a.value.ConventionUUID).then(t=>{t&&(d.value=t)}),r.getConventionVenues(a.value.ConventionUUID).then(t=>{t&&(i.value=t)});const n=()=>{const t={ID:0,AccommodationUUID:q(),ConventionID:a.value.ID,ConventionUUID:a.value.ConventionUUID,Order:d.value.length+1,Name:"New Accommodation Option",Pool:[],Costs:[],RequiredTags:[]};r.saveAccommodation(t).then(o=>{o&&d.value.push(o)})},u=t=>{d.value.splice(t,1)};return(t,o)=>(c(),E($,null,[e(B,{fluid:!0,class:"px-0"},{default:l(()=>[e(A,null,{default:l(()=>[e(g,null,{default:l(()=>[Ql]),_:1})]),_:1})]),_:1}),Zl,et,e(ae,null,{default:l(()=>[e(fe,{variant:"accordion"},{default:l(()=>[(c(!0),E($,null,K(d.value,(v,m)=>(c(),C(Wl,{key:v.AccommodationUUID,convention:a.value,venues:i.value,modelValue:d.value[m],"onUpdate:modelValue":s=>d.value[m]=s,onDeleted:s=>u(m)},null,8,["convention","venues","modelValue","onUpdate:modelValue","onDeleted"]))),128))]),_:1}),e(ae,{class:"pa-2"},{default:l(()=>[e(N,{color:"primary",onClick:n},{default:l(()=>[b("Add Accommodation")]),_:1})]),_:1})]),_:1})],64))}}),tt=x({__name:"EditFieldDialogExtras",props:{modelValue:{required:!0}},emits:["update:modelValue"],setup(f){const r=M(f,"modelValue"),a=be.getInstance(),d=_([]),i=_([]);return a==null||a.getConventionExtras(r.value.ConventionUUID).then(n=>{d.value=n;const u=r.value.Values.find(t=>t.Title==="SelectedExtras");if(u)try{i.value=JSON.parse(u.Value)}catch{}}),H(i,()=>{const n=r.value.Values.find(u=>u.Title==="SelectedExtras");if(n)n.Value=JSON.stringify(i.value);else{const u={ID:0,FieldValueUUID:q(),FieldID:r.value.ID,FieldUUID:r.value.FieldUUID,Title:"SelectedExtras",Value:JSON.stringify(i.value)};r.value.Values.push(u)}}),(n,u)=>(c(!0),E($,null,K(d.value,t=>(c(),C(X,{key:t.ExtraUUID,modelValue:i.value,"onUpdate:modelValue":u[0]||(u[0]=o=>i.value=o),label:t.Name,value:t.ExtraUUID,name:r.value.Name,"hide-details":""},null,8,["modelValue","label","value","name"]))),128))}}),at=x({__name:"EditFieldDialogInterests",props:{modelValue:{required:!0}},emits:["update:modelValue"],setup(f){const r=M(f,"modelValue"),a=be.getInstance(),d=_([]),i=_([]);return a==null||a.getConventionInterests(r.value.ConventionUUID).then(n=>{d.value=n;const u=r.value.Values.find(t=>t.Title==="SelectedInterests");if(u)try{i.value=JSON.parse(u.Value)}catch{}}),H(i,()=>{const n=r.value.Values.find(u=>u.Title==="SelectedInterests");if(n)n.Value=JSON.stringify(i.value);else{const u={ID:0,FieldValueUUID:q(),FieldID:r.value.ID,FieldUUID:r.value.FieldUUID,Title:"SelectedInterests",Value:JSON.stringify(i.value)};r.value.Values.push(u)}}),(n,u)=>(c(!0),E($,null,K(d.value,t=>(c(),C(X,{key:t.InterestUUID,modelValue:i.value,"onUpdate:modelValue":u[0]||(u[0]=o=>i.value=o),label:t.Name,value:t.InterestUUID,name:r.value.Name,"hide-details":""},null,8,["modelValue","label","value","name"]))),128))}}),ot=x({__name:"EditFieldDialogTickets",props:{modelValue:{required:!0}},emits:["update:modelValue"],setup(f){const r=M(f,"modelValue"),a=be.getInstance(),d=_([]),i=_([]);return a==null||a.getConventionTickets(r.value.ConventionUUID).then(n=>{d.value=n;const u=r.value.Values.find(t=>t.Title==="SelectedTickets");if(u)try{i.value=JSON.parse(u.Value)}catch{}}),H(i,()=>{const n=r.value.Values.find(u=>u.Title==="SelectedTickets");if(n)n.Value=JSON.stringify(i.value);else{const u={ID:0,FieldValueUUID:q(),FieldID:r.value.ID,FieldUUID:r.value.FieldUUID,Title:"SelectedTickets",Value:JSON.stringify(i.value)};r.value.Values.push(u)}}),(n,u)=>(c(!0),E($,null,K(d.value.filter(t=>t&&t.Type===I(L).TICKET_TYPE_GROUP),t=>(c(),C(X,{key:t.TicketUUID,modelValue:i.value,"onUpdate:modelValue":u[0]||(u[0]=o=>i.value=o),label:t.Name,value:t.TicketUUID,name:r.value.Name,"hide-details":""},null,8,["modelValue","label","value","name"]))),128))}}),nt=h("h5",null,"Display Options",-1),ut=h("h5",null,"Accommodation Choices",-1),it=x({__name:"EditFieldDialogAccommodation",props:{modelValue:{required:!0}},emits:["update:modelValue"],setup(f){const r=M(f,"modelValue"),a=be.getInstance(),d=_([]),i=_(r.value.Values.map(t=>t.Value)),n=_({sharing:!1});try{const t=JSON.parse(r.value.Data);t&&(n.value=t)}catch{}const u=()=>{r.value.Data=JSON.stringify(n.value),r.value.Values=i.value.map(t=>{var o,v,m;return{ID:0,FieldValueUUID:q(),FieldID:((o=r.value)==null?void 0:o.ID)||0,FieldUUID:((v=r.value)==null?void 0:v.FieldUUID)||"",Title:((m=d.value.find(s=>s.AccommodationUUID==t))==null?void 0:m.Name)||"",Value:t}})};return a==null||a.getConventionAccommodation(r.value.ConventionUUID).then(t=>{t&&(d.value=t)}),(t,o)=>(c(),E($,null,[nt,e(X,{label:"Show Sharing Options",modelValue:n.value.sharing,"onUpdate:modelValue":o[0]||(o[0]=v=>n.value.sharing=v),"hide-details":"",onChange:u},null,8,["modelValue"]),ut,(c(!0),E($,null,K(d.value,v=>(c(),C(X,{key:v.ID,modelValue:i.value,"onUpdate:modelValue":o[1]||(o[1]=m=>i.value=m),label:v.Name,value:v.AccommodationUUID,"hide-details":"",onChange:u},null,8,["modelValue","label","value"]))),128))],64))}}),dt=x({__name:"EditFieldDialogAge",props:P({convention:{}},{modelValue:{required:!0}}),emits:["update:modelValue"],setup(f){var m,s,p;const r=M(f,"modelValue"),a=new Date,d=a.getFullYear(),i=(a.getMonth()+1).toLocaleString(navigator.language,{minimumIntegerDigits:2}),n=a.getDate().toLocaleString(navigator.language,{minimumIntegerDigits:2}),u=_(parseInt(((m=r.value.Values.find(V=>V.Title==="MIN_AGE"))==null?void 0:m.Value)||"18")),t=_(((s=r.value.Values.find(V=>V.Title==="BEFORE_DATE"))==null?void 0:s.Value)||`${d}-${i}-${n}`),o=_(((p=r.value.Values.find(V=>V.Title==="UNDER_AGE_APPLY_TAG"))==null?void 0:p.Value)||""),v=()=>{var V,U,T,D,y,k;r.value.Values=[{ID:0,FieldValueUUID:q(),FieldID:((V=r.value)==null?void 0:V.ID)||0,FieldUUID:((U=r.value)==null?void 0:U.FieldUUID)||"",Title:"MIN_AGE",Value:u.value.toString()},{ID:0,FieldValueUUID:q(),FieldID:((T=r.value)==null?void 0:T.ID)||0,FieldUUID:((D=r.value)==null?void 0:D.FieldUUID)||"",Title:"BEFORE_DATE",Value:t.value},{ID:0,FieldValueUUID:q(),FieldID:((y=r.value)==null?void 0:y.ID)||0,FieldUUID:((k=r.value)==null?void 0:k.FieldUUID)||"",Title:"UNDER_AGE_APPLY_TAG",Value:o.value}]};return v(),(V,U)=>(c(),C(B,{class:"pl-0 pr-0",fluid:!0},{default:l(()=>[e(A,null,{default:l(()=>[e(g,{cols:"12",sm:"6"},{default:l(()=>[e(F,{modelValue:u.value,"onUpdate:modelValue":U[0]||(U[0]=T=>u.value=T),modelModifiers:{number:!0},type:"number",label:"Minimum Age",variant:"outlined",onChange:v},null,8,["modelValue"])]),_:1}),e(g,{cols:"12",sm:"6"},{default:l(()=>[e(F,{modelValue:t.value,"onUpdate:modelValue":U[1]||(U[1]=T=>t.value=T),type:"date",label:"Date to attain minimum age by",variant:"outlined",onChange:v},null,8,["modelValue"])]),_:1})]),_:1}),e(A,null,{default:l(()=>[e(g,null,{default:l(()=>[e(oe,{modelValue:o.value,"onUpdate:modelValue":U[2]||(U[2]=T=>o.value=T),convention:V.convention,chips:!0,clearable:!0,variant:"outlined",label:`Tags applied to users under ${u.value} at time of data entry`,onChange:v},null,8,["modelValue","convention","label"])]),_:1})]),_:1})]),_:1}))}}),st=h("h4",null,"Values",-1),rt=h("h4",null,"Accommodation",-1),mt=h("h4",null,"Age",-1),vt=h("h4",null,"Additional Purchases",-1),ct=h("h4",null,"Available Interests",-1),pt=h("h4",null,"Tickets",-1),ft=h("h4",{class:"mb-3"},"Field Preview",-1),Vt=x({__name:"EditFieldDialog",props:P({convention:{},field:{},title:{}},{modelValue:{type:Boolean,required:!0}}),emits:P(["update:field"],["update:modelValue"]),setup(f,{emit:r}){const a=f,{convention:d,title:i=""}=a,n=M(f,"modelValue"),u=De(a,r,void 0,void 0,"field"),t=_(j(u.value)),o=_(""),v=_(t.value.Type);H(u,()=>{t.value=j(u.value)});const m=()=>{n.value=!1},s=()=>{t.value=j(u.value)},p=()=>{u.value=t.value},V=()=>{t.value.Values.push({ID:0,FieldValueUUID:q(),FieldID:t.value.ID,FieldUUID:t.value.FieldUUID,Title:"",Value:""})},U=D=>{t.value.Values.splice(D,1)},T=()=>{o.value="",t.value.Values=[]};return H(v,(D,y)=>{D!==y&&(t.value.Type=D,T())}),(D,y)=>(c(),C(Se,{modelValue:n.value,"onUpdate:modelValue":y[13]||(y[13]=k=>n.value=k),onReset:s,onSave:p,title:I(i),color:"primary"},{default:l(()=>[e(B,{class:"pa-0",fluid:!0},{default:l(()=>[e(A,null,{default:l(()=>[e(g,{cols:"12"},{default:l(()=>[e(B,{class:"pa-0",fluid:!0},{default:l(()=>[e(A,null,{default:l(()=>[e(g,{cols:"12",sm:"6",md:"4"},{default:l(()=>[e(F,{modelValue:t.value.Name,"onUpdate:modelValue":y[0]||(y[0]=k=>t.value.Name=k),label:"Internal name",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),e(g,{cols:"12",sm:"6",md:"4"},{default:l(()=>[e(F,{modelValue:t.value.Label,"onUpdate:modelValue":y[1]||(y[1]=k=>t.value.Label=k),label:"Label",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),e(g,{cols:"12",sm:"6",md:"4"},{default:l(()=>[e(F,{modelValue:t.value.Hint,"onUpdate:modelValue":y[2]||(y[2]=k=>t.value.Hint=k),label:"Hint",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),e(g,{cols:"12",sm:"6",md:"4"},{default:l(()=>[e(F,{modelValue:t.value.Placeholder,"onUpdate:modelValue":y[3]||(y[3]=k=>t.value.Placeholder=k),label:"Placeholder",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),e(g,{cols:"12",sm:"6",md:"4"},{default:l(()=>[e(se,{modelValue:v.value,"onUpdate:modelValue":y[4]||(y[4]=k=>v.value=k),label:"Type",variant:"outlined",items:I(xe),"hide-details":""},null,8,["modelValue","items"])]),_:1}),t.value.Type===I(J).SELECT||t.value.Type===I(J).CHECKBOX?(c(),C(g,{key:0,cols:"12",sm:"6",md:"4",class:"py-0"},{default:l(()=>[e(X,{modelValue:t.value.Multiple,"onUpdate:modelValue":y[5]||(y[5]=k=>t.value.Multiple=k),label:"Multiple Items",hint:"Can select multiple items from list","hide-details":"",density:"compact"},null,8,["modelValue"]),t.value.Type===I(J).SELECT?(c(),C(X,{key:0,modelValue:t.value.Autofill,"onUpdate:modelValue":y[6]||(y[6]=k=>t.value.Autofill=k),label:"Searchable List","hide-details":"",density:"compact"},null,8,["modelValue"])):S("",!0)]),_:1})):S("",!0)]),_:1}),t.value.Type===I(J).SELECT||t.value.Type===I(J).CHECKBOX&&t.value.Multiple||t.value.Type===I(J).RADIO?(c(),C(A,{key:0},{default:l(()=>[e(g,null,{default:l(()=>[st,e(B,{fluid:!0,class:"px-0"},{default:l(()=>[(c(!0),E($,null,K(t.value.Values,(k,w)=>(c(),C(A,{key:k.ID},{default:l(()=>[e(g,{cols:"12",sm:"5",md:"6"},{default:l(()=>[e(F,{modelValue:k.Title,"onUpdate:modelValue":G=>k.Title=G,label:"Display",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(g,{cols:"9",sm:"5",md:"5"},{default:l(()=>[e(F,{modelValue:k.Value,"onUpdate:modelValue":G=>k.Value=G,label:"Internal Value",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(g,{cols:"3",sm:"2",md:"1",class:"d-flex align-center"},{default:l(()=>[e(N,{icon:"mdi:mdi-window-close",size:"small",color:"red",onClick:G=>U(w)},null,8,["onClick"])]),_:2},1024)]),_:2},1024))),128)),e(A,null,{default:l(()=>[e(g,null,{default:l(()=>[e(N,{"prepend-icon":"mdi:mdi-plus",color:"primary",onClick:V},{default:l(()=>[b("Add Item")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})):t.value.Type===I(J).ACCOMMODATION?(c(),C(A,{key:1},{default:l(()=>[e(g,null,{default:l(()=>[rt,e(it,{modelValue:t.value,"onUpdate:modelValue":y[7]||(y[7]=k=>t.value=k)},null,8,["modelValue"])]),_:1})]),_:1})):t.value.Type===I(J).AGE?(c(),C(A,{key:2},{default:l(()=>[e(g,null,{default:l(()=>[mt,e(dt,{modelValue:t.value,"onUpdate:modelValue":y[8]||(y[8]=k=>t.value=k),convention:I(d)},null,8,["modelValue","convention"])]),_:1})]),_:1})):t.value.Type===I(J).EXTRAS?(c(),C(A,{key:3},{default:l(()=>[e(g,null,{default:l(()=>[vt,e(tt,{modelValue:t.value,"onUpdate:modelValue":y[9]||(y[9]=k=>t.value=k)},null,8,["modelValue"])]),_:1})]),_:1})):t.value.Type===I(J).INTERESTS?(c(),C(A,{key:4},{default:l(()=>[e(g,null,{default:l(()=>[ct,e(at,{modelValue:t.value,"onUpdate:modelValue":y[10]||(y[10]=k=>t.value=k)},null,8,["modelValue"])]),_:1})]),_:1})):t.value.Type===I(J).TICKET?(c(),C(A,{key:5},{default:l(()=>[e(g,null,{default:l(()=>[pt,e(ot,{modelValue:t.value,"onUpdate:modelValue":y[11]||(y[11]=k=>t.value=k)},null,8,["modelValue"])]),_:1})]),_:1})):S("",!0)]),_:1})]),_:1}),e(g,{cols:"12"},{default:l(()=>[e(ae,{elevation:"5",class:"pa-2",color:"text-center"},{default:l(()=>[ft,e(we,{admin:!0,field:t.value,convention:I(d),modelValue:o.value,"onUpdate:modelValue":y[12]||(y[12]=k=>o.value=k)},null,8,["field","convention","modelValue"])]),_:1})]),_:1})]),_:1})]),_:1})]),actions:l(()=>[e(N,{color:"blue-darken-1",variant:"text",onClick:m},{default:l(()=>[b(" Cancel ")]),_:1}),e(N,{color:"blue-darken-1",variant:"text",onClick:s},{default:l(()=>[b(" Reset ")]),_:1}),e(ee),e(N,{color:"blue-darken-1",variant:"text",onClick:p},{default:l(()=>[b(" Save ")]),_:1})]),_:1},8,["modelValue","title"]))}}),Ut=x({__name:"FieldEditor",props:{modelValue:{required:!0}},emits:P(["refresh"],["update:modelValue"]),setup(f){const r=M(f,"modelValue"),a=Y(),d=_(!1),i=_(!1),n=_([{key:"Label",title:"Label",align:"start",sortable:!0},{key:"Name",title:"Internal Name",align:"start",sortable:!0},{key:"Type",title:"Type",align:"start",sortable:!0},{key:"actions",title:"Actions",sortable:!1}]),u=_([]);a.getConventionFields(r.value.ConventionUUID).then(w=>{w&&(u.value=w)});const t=_(-1),o=_({ID:0,FieldUUID:q(),ConventionID:r.value.ID,ConventionUUID:r.value.ConventionUUID,Autofill:!1,Hint:"",Label:"",Multiple:!1,Name:"",Placeholder:"",Type:"TEXT",Values:[],Data:""}),v=Q(()=>t.value===-1?"New Field":"Edit Field"),m=()=>({ID:0,FieldUUID:q(),ConventionID:r.value.ID,ConventionUUID:r.value.ConventionUUID,Autofill:!1,Hint:"",Label:"",Multiple:!1,Name:"",Placeholder:"",Type:"TEXT",Values:[],Data:""}),s=_(m()),p=()=>{s.value.FieldUUID=q(),o.value=Object.assign({},m()),t.value=-1,d.value=!0},V=w=>{t.value=u.value.indexOf(w),o.value=Object.assign({},w),d.value=!0},U=w=>{t.value=u.value.indexOf(w),o.value=Object.assign({},w),i.value=!0},T=()=>{a.deleteField(o.value.FieldUUID).then(w=>{w&&(u.value.splice(t.value,1),y())})},D=()=>{d.value=!1,ye(()=>{o.value=Object.assign({},s.value),t.value=-1})},y=()=>{i.value=!1,ye(()=>{o.value=Object.assign({},s.value),t.value=-1})},k=()=>{a.saveField(o.value).then(w=>{w&&(t.value>-1?Object.assign(u.value[t.value],w):u.value.push(w),D())})};return(w,G)=>(c(),C(I(Ke),{headers:n.value,items:u.value,"sort-by":[{key:"calories",order:"asc"}],class:"elevation-1"},{top:l(()=>[e(ne,{color:"primary"},{default:l(()=>[e(ue,null,{default:l(()=>[b("Field Editor")]),_:1}),e(Fe,{class:"mx-4",inset:!0,vertical:!0}),e(ee),e(N,{dark:"",class:"mb-2","prepend-icon":"mdi:mdi-pencil",onClick:p},{default:l(()=>[b(" New Item ")]),_:1}),e(Ge,{modelValue:i.value,"onUpdate:modelValue":G[0]||(G[0]=W=>i.value=W),onDelete:T},null,8,["modelValue"])]),_:1}),d.value?(c(),C(Vt,{key:0,modelValue:d.value,"onUpdate:modelValue":G[1]||(G[1]=W=>d.value=W),field:o.value,"onUpdate:field":[G[2]||(G[2]=W=>o.value=W),k],title:v.value,convention:r.value},null,8,["modelValue","field","title","convention"])):S("",!0)]),"item.actions":l(({item:W})=>[e(z,{size:"small",class:"me-2",onClick:je=>V(W.raw)},{default:l(()=>[b(" mdi:mdi-pencil ")]),_:2},1032,["onClick"]),e(z,{size:"small",onClick:je=>U(W.raw)},{default:l(()=>[b(" mdi:mdi-delete ")]),_:2},1032,["onClick"])]),_:1},8,["headers","items"]))}}),Tt=(f,r)=>{const a=De(f,r),d=De(f,r,void 0,void 0,"item"),i=_(j(d.value));return H(d,()=>{i.value=j(d.value)}),{state:a,model:d,close:()=>{a.value=!1},reset:()=>{d.value=j(i.value)},save:()=>{r("save")}}},Dt=x({__name:"EditItemDialog",props:{item:{},modelValue:{type:Boolean},title:{},cardClass:{}},emits:["update:modelValue","update:item","save"],setup(f,{emit:r}){const a=f,{state:d,model:i,close:n,reset:u,save:t}=Tt(a,r);return(o,v)=>(c(),C(Se,{modelValue:I(d),"onUpdate:modelValue":v[0]||(v[0]=m=>_e(d)?d.value=m:null),onReset:I(u),onSave:I(t),title:o.title,color:"primary","card-class":o.cardClass},{toolbarButtons:l(()=>[he(o.$slots,"toolbarButtons")]),actions:l(()=>[e(N,{color:"blue-darken-1",variant:"text",onClick:I(n)},{default:l(()=>[b(" Cancel ")]),_:1},8,["onClick"]),e(N,{color:"blue-darken-1",variant:"text",onClick:I(u)},{default:l(()=>[b(" Reset ")]),_:1},8,["onClick"]),e(ee),e(N,{color:"blue-darken-1",variant:"text",onClick:I(t)},{default:l(()=>[b(" Save ")]),_:1},8,["onClick"])]),default:l(()=>[he(o.$slots,"default")]),_:3},8,["modelValue","onReset","onSave","title","card-class"]))}}),It={class:"pa-0 border-0 ma-0"},gt=h("legend",{class:"mb-2"},"Field Settings",-1),_t={class:"pa-0 border-0 ma-0"},yt=h("legend",{class:"text-blue-accent-2 mb-2"},"Field Preview",-1),Ct=x({__name:"EditFormField",props:P({convention:{}},{modelValue:{required:!0}}),emits:["update:modelValue"],setup(f){const r=M(f,"modelValue"),a=Y(),d=_([]),i=_([]),n=_(""),u=t=>{var o;r.value.Field=(o=i.value.find(v=>v.value===t))==null?void 0:o.field};return a.getConventionFields(f.convention.ConventionUUID).then(t=>{t&&(d.value=t,i.value=t.map(o=>({title:`${o.Label} (${(xe.find(v=>v.value===o.Type)||{title:""}).title})`,value:o.FieldUUID,field:o})),u(r.value.FieldUUID))}),(t,o)=>(c(),C(A,null,{default:l(()=>[e(g,{cols:"12",md:"6"},{default:l(()=>[h("fieldset",It,[gt,e(A,null,{default:l(()=>[e(g,{cols:"12"},{default:l(()=>[e(se,{modelValue:r.value.FieldUUID,"onUpdate:modelValue":[o[0]||(o[0]=v=>r.value.FieldUUID=v),u],items:i.value,"item-title":"title","item-value":"value",label:"Field",variant:"outlined","hide-details":""},null,8,["modelValue","items"])]),_:1}),e(g,{cols:"6",sm:"4"},{default:l(()=>[e(F,{modelValue:r.value.MinLength,"onUpdate:modelValue":o[1]||(o[1]=v=>r.value.MinLength=v),modelModifiers:{number:!0},label:"Min Length",type:"number",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),e(g,{cols:"6",sm:"4"},{default:l(()=>[e(F,{modelValue:r.value.MaxLength,"onUpdate:modelValue":o[2]||(o[2]=v=>r.value.MaxLength=v),modelModifiers:{number:!0},label:"Max Length",type:"number",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),e(g,{cols:"12",sm:"4"},{default:l(()=>[e(X,{modelValue:r.value.Required,"onUpdate:modelValue":o[3]||(o[3]=v=>r.value.Required=v),modelModifiers:{boolean:!0},label:"Required","hide-details":""},null,8,["modelValue"])]),_:1})]),_:1})])]),_:1}),r.value.FieldUUID&&r.value.Field?(c(),C(g,{key:0,cols:"12",md:"6"},{default:l(()=>[h("fieldset",_t,[yt,r.value.Field?(c(),C(we,{key:0,admin:!0,field:r.value.Field,"persistent-hint":!0,required:r.value.Required,convention:t.convention,modelValue:n.value,"onUpdate:modelValue":o[4]||(o[4]=v=>n.value=v)},null,8,["field","required","convention","modelValue"])):S("",!0)])]),_:1})):S("",!0)]),_:1}))}}),bt={class:"d-none d-sm-block"},kt=x({__name:"EditFormSectionFields",props:P({convention:{}},{modelValue:{required:!0}}),emits:["update:modelValue"],setup(f){const r=M(f,"modelValue"),a=()=>{var d;return{ID:0,SectionFieldUUID:q(),SectionID:r.value.ID,SectionUUID:r.value.SectionUUID,FieldID:0,FieldUUID:"",Order:(((d=r.value.Fields)==null?void 0:d.length)||0)+1,MinLength:0,MaxLength:0,Required:!1,Value:""}};return(d,i)=>r.value.Fields!==void 0?(c(),C(Ye,{key:0,modelValue:r.value.Fields,"onUpdate:modelValue":i[0]||(i[0]=n=>r.value.Fields=n),closeable:!1,title:"Fields","new-item":a,class:"mt-4",label:"name","label-parent":"Field","slot-name-prefix":"field"},Re({_:2},[K(r.value.Fields,(n,u)=>({name:`field_${u}_title`,fn:l(()=>[n.Field?(c(),E($,{key:0},[b(R(n.Field.Label)+" ("+R(n.Field.Name)+") ",1),h("template",bt,[b("  ["+R(n.Field.Type)+"] ",1)])],64)):(c(),E($,{key:1},[b("New Field")],64))])})),K(r.value.Fields,(n,u)=>({name:`field_${u}`,fn:l(()=>[e(Ct,{modelValue:r.value.Fields[u],"onUpdate:modelValue":t=>r.value.Fields[u]=t,convention:d.convention,style:{margin:"0 -24px"}},null,8,["modelValue","onUpdate:modelValue","convention"])])}))]),1032,["modelValue"])):S("",!0)}}),Et=x({__name:"EditFormSections",props:P({convention:{}},{modelValue:{required:!0}}),emits:["update:modelValue"],setup(f){const r=M(f,"modelValue"),a=()=>{const d={ID:0,SectionUUID:q(),FormID:r.value.ID,FormUUID:r.value.FormUUID,Order:0,Name:"New Section",Heading:"",Description:"",Fields:[],DefaultValue:"",State:{ID:0,SectionStateUUID:q(),SectionID:0,SectionUUID:"",Edit:!0}};return d.State.SectionID=d.ID,d.State.SectionUUID=d.SectionUUID,d};return(d,i)=>(c(),C(Ye,{modelValue:r.value.Sections,"onUpdate:modelValue":i[0]||(i[0]=n=>r.value.Sections=n),"new-item":a,closeable:!1,title:"Sections","slot-name-prefix":"section"},Re({_:2},[K(r.value.Sections,(n,u)=>({name:`section_${u}`,fn:l(()=>[e(A,null,{default:l(()=>[e(g,{cols:"12",sm:"6"},{default:l(()=>[e(F,{modelValue:n.Name,"onUpdate:modelValue":t=>n.Name=t,label:"Internal Name",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(g,{cols:"12",sm:"6"},{default:l(()=>[e(F,{modelValue:n.Heading,"onUpdate:modelValue":t=>n.Heading=t,label:"Section Heading",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024),e(A,null,{default:l(()=>[e(g,{cols:"12"},{default:l(()=>[e(Ie,{modelValue:n.Description,"onUpdate:modelValue":t=>n.Description=t,label:"Section Text",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024),n.Fields?(c(),C(kt,{key:0,modelValue:r.value.Sections[u],"onUpdate:modelValue":t=>r.value.Sections[u]=t,convention:d.convention},null,8,["modelValue","onUpdate:modelValue","convention"])):S("",!0)])}))]),1032,["modelValue"]))}}),ht=x({__name:"FormRendererPopup",props:P({admin:{type:Boolean},convention:{},form:{},title:{},cardClass:{},preview:{type:Boolean}},{modelValue:{type:Boolean,required:!0}}),emits:P(["update:form"],["update:modelValue"]),setup(f,{emit:r}){const a=f,{admin:d=!1,convention:i,title:n="",cardClass:u=""}=a,t=M(f,"modelValue"),o=De(a,r,void 0,void 0,"form"),v=_(j(o.value));H(o,()=>{v.value=j(o.value)});const m=()=>{t.value=!1};return(s,p)=>(c(),C(Se,{modelValue:t.value,"onUpdate:modelValue":p[1]||(p[1]=V=>t.value=V),title:I(n),color:"primary","card-class":I(u)},{toolbarButtons:l(()=>[he(s.$slots,"toolbarButtons")]),actions:l(()=>[e(N,{color:"blue-darken-1",variant:"text",onClick:m},{default:l(()=>[b(" Close ")]),_:1})]),default:l(()=>[e(Je,{modelValue:v.value,"onUpdate:modelValue":p[0]||(p[0]=V=>v.value=V),admin:I(d),convention:I(i),preview:s.preview},null,8,["modelValue","admin","convention","preview"])]),_:3},8,["modelValue","title","card-class"]))}}),$t=h("template",{class:"d-none d-sm-inline"},[b("Preview")],-1),Nt=x({__name:"EditFormDialog",props:P({convention:{},form:{}},{modelValue:{type:Boolean,required:!0}}),emits:P(["update:form"],["update:modelValue"]),setup(f,{emit:r}){const a=f,{convention:d}=a,i=M(f,"modelValue"),n=Y(),u=De(a,r,void 0,void 0,"form"),t=_(!1),o=_(j(u.value));H(u,()=>{o.value=j(u.value)});const v=()=>{n.saveForm(o.value).then(s=>{s&&(u.value=s,i.value=!1)})},m=()=>{t.value=!0};return(s,p)=>(c(),C(Dt,{modelValue:i.value,"onUpdate:modelValue":p[13]||(p[13]=V=>i.value=V),item:o.value,"onUpdate:item":p[14]||(p[14]=V=>o.value=V),onSave:v,"card-class":"pa-0"},{toolbarButtons:l(()=>[e(Xe,null,{default:l(()=>[e(N,{"prepend-icon":"mdi:mdi-developer-board",onClick:m},{default:l(()=>[$t]),_:1})]),_:1})]),default:l(()=>[e(fe,null,{default:l(()=>[e(Ve,{class:"mt-0"},{default:l(()=>[e(Ue,null,{default:l(()=>[b("General Settings")]),_:1}),e(Te,null,{default:l(()=>[e(A,null,{default:l(()=>[e(g,{cols:"12"},{default:l(()=>[e(B,{class:"pa-0",fluid:!0},{default:l(()=>[e(A,null,{default:l(()=>[e(g,{cols:"12",sm:"6"},{default:l(()=>[e(F,{modelValue:o.value.Name,"onUpdate:modelValue":p[0]||(p[0]=V=>o.value.Name=V),label:"Internal name",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),e(g,{cols:"12",sm:"6"},{default:l(()=>[e(F,{modelValue:o.value.Heading,"onUpdate:modelValue":p[1]||(p[1]=V=>o.value.Heading=V),label:"Form Heading",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),e(g,{cols:"12"},{default:l(()=>[e(Ie,{modelValue:o.value.Description,"onUpdate:modelValue":p[2]||(p[2]=V=>o.value.Description=V),label:"Pre-form Text",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),e(g,{cols:"12",sm:"6"},{default:l(()=>[e(se,{modelValue:o.value.Type,"onUpdate:modelValue":p[3]||(p[3]=V=>o.value.Type=V),label:"Type",variant:"outlined",items:I(tl),"hide-details":""},null,8,["modelValue","items"])]),_:1}),e(g,{cols:"12",sm:"6"},{default:l(()=>[e(F,{modelValue:o.value.NotificationEmail,"onUpdate:modelValue":p[4]||(p[4]=V=>o.value.NotificationEmail=V),label:"Notification Email",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),e(g,{cols:"12",sm:"6",class:"d-none"},{default:l(()=>[e(F,{modelValue:o.value.State.Stage,"onUpdate:modelValue":p[5]||(p[5]=V=>o.value.State.Stage=V),modelModifiers:{number:!0},label:"Stage",variant:"outlined","hide-details":"",type:"number"},null,8,["modelValue"])]),_:1}),e(g,{cols:"6"},{default:l(()=>[e(X,{modelValue:o.value.State.New,"onUpdate:modelValue":p[6]||(p[6]=V=>o.value.State.New=V),label:"Allow New Entries"},null,8,["modelValue"])]),_:1}),e(g,{cols:"6"},{default:l(()=>[e(X,{modelValue:o.value.State.Edit,"onUpdate:modelValue":p[7]||(p[7]=V=>o.value.State.Edit=V),label:"Allow Editing Submissions"},null,8,["modelValue"])]),_:1})]),_:1}),e(A,null,{default:l(()=>[e(g,{cols:"12"},{default:l(()=>[e(oe,{label:"Required Tags",variant:"outlined",modelValue:o.value.RequiredTags,"onUpdate:modelValue":p[8]||(p[8]=V=>o.value.RequiredTags=V),convention:I(d),organisation:I(d).OrganisationUUID,chips:"",clearable:"",hint:"Tags that a user must have to see this form. (Any one)"},null,8,["modelValue","convention","organisation"])]),_:1})]),_:1}),e(A,null,{default:l(()=>[e(g,{cols:"12"},{default:l(()=>[e(Le,{label:"Required Groups",variant:"outlined",modelValue:o.value.RequiredGroupMemberships,"onUpdate:modelValue":p[9]||(p[9]=V=>o.value.RequiredGroupMemberships=V),convention:I(d),organisation:I(d).OrganisationUUID,chips:"",clearable:"",hint:"Groups that a user must be in to see this form. (Any one)"},null,8,["modelValue","convention","organisation"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),o.value?(c(),C(Et,{key:0,modelValue:o.value,"onUpdate:modelValue":p[10]||(p[10]=V=>o.value=V),convention:I(d),style:{"border-radius":"0"}},null,8,["modelValue","convention"])):S("",!0),t.value?(c(),C(ht,{key:1,modelValue:t.value,"onUpdate:modelValue":p[11]||(p[11]=V=>t.value=V),form:o.value,"onUpdate:form":p[12]||(p[12]=V=>o.value=V),admin:!0,convention:I(d),title:"Form Preview",preview:!0,"card-class":"pa-0"},null,8,["modelValue","form","convention"])):S("",!0)]),_:1},8,["modelValue","item"]))}}),At=(f,r)=>{const a=_(!1),d=_(!1),i=_(f),n=_(-1),u=_(r),t=_(r),o=Q(()=>n.value===-1?"New Form":"Edit Form"),v=()=>{i.value=f},m=D=>{n.value=i.value.indexOf(D),u.value=Object.assign({},D),a.value=!0},s=D=>{n.value=i.value.indexOf(D),u.value=Object.assign({},D),d.value=!0},p=()=>{d.value=!1,ye(()=>{u.value=Object.assign({},t.value),n.value=-1}).then()},V=()=>{i.value.splice(n.value,1),p()},U=()=>{a.value=!1,ye(()=>{u.value=Object.assign({},t.value),n.value=-1}).then()},T=()=>{n.value>-1?Object.assign(i.value[n.value],u.value):i.value.push(u.value),U()};return H(a,D=>{D||U()}),H(d,D=>{D||p()}),{collection:i,defaultItem:t,dialog:a,dialogDelete:d,editedItem:u,formTitle:o,reset:v,editItem:m,deleteItem:s,deleteItemConfirm:V,close:U,save:T}},Ft=x({__name:"FormEditor",props:{modelValue:{required:!0}},emits:P(["refresh"],["update:modelValue"]),setup(f){const r=M(f,"modelValue"),a=Y(),d=_([{key:"Name",title:"Form Name",align:"start",sortable:!0},{key:"Type",title:"Type",align:"start",sortable:!0},{key:"actions",title:"Actions",sortable:!1}]),i=_([]),n=_([]);a.getConventionFields(r.value.ConventionUUID).then(y=>{i.value=y}),a.getConventionForms(r.value.ConventionUUID).then(y=>{n.value=y});const u={ID:0,FormUUID:q(),ConventionID:r.value.ID,ConventionUUID:r.value.ConventionUUID,ParentID:0,ParentUUID:me,Name:"",Heading:"",Description:"",Type:al.FORM_TYPE_ADDITIONAL,Sections:[],State:{ID:0,FormStateUUID:q(),FormID:0,FormUUID:me,New:!1,Edit:!1,Stage:0},RequiredGroupMemberships:[],RequiredTags:[],NotificationEmail:""};u.State.FormUUID=u.FormUUID;const{collection:t,defaultItem:o,dialog:v,dialogDelete:m,editedItem:s,editItem:p,deleteItem:V,deleteItemConfirm:U,save:T}=At(n,u);t.value.forEach(y=>{y.Sections.forEach(k=>{var w;(w=k.Fields)==null||w.forEach(G=>{G.Field=i.value.find(W=>W.ID===G.FieldID)})})});const D=y=>{a.deleteForm(y.FormUUID).then(k=>{k&&V(y)})};return(y,k)=>(c(),C(I(Ke),{headers:d.value,items:I(t),"sort-by":[{key:"calories",order:"asc"}],class:"elevation-1"},{top:l(()=>[e(ne,{color:"primary"},{default:l(()=>[e(ue,null,{default:l(()=>[b("Form Editor")]),_:1}),e(Fe,{class:"mx-4",inset:!0,vertical:!0}),e(ee),e(N,{dark:"",class:"mb-2","prepend-icon":"mdi:mdi-pencil",onClick:k[0]||(k[0]=w=>{s.value=Object.assign({},I(o)),v.value=!0})},{default:l(()=>[b(" New Item ")]),_:1}),e(Ge,{modelValue:I(m),"onUpdate:modelValue":k[1]||(k[1]=w=>_e(m)?m.value=w:null),onDelete:I(U)},null,8,["modelValue","onDelete"])]),_:1}),I(v)?(c(),C(Nt,{key:0,modelValue:I(v),"onUpdate:modelValue":k[2]||(k[2]=w=>_e(v)?v.value=w:null),form:I(s),"onUpdate:form":[k[3]||(k[3]=w=>_e(s)?s.value=w:null),I(T)],convention:r.value},null,8,["modelValue","form","onUpdate:form","convention"])):S("",!0)]),"item.actions":l(({item:w})=>[e(z,{size:"small",class:"me-2",onClick:G=>I(p)(w.raw)},{default:l(()=>[b(" mdi:mdi-pencil ")]),_:2},1032,["onClick"]),e(z,{size:"small",onClick:G=>D(w.raw)},{default:l(()=>[b(" mdi:mdi-delete ")]),_:2},1032,["onClick"])]),_:1},8,["headers","items"]))}}),da=x({__name:"ConventionEditorView",emits:["pageTitle","refresh"],setup(f,{emit:r}){const a=Be(),d=Y(),n=_({ID:0,ConventionUUID:me,Accommodation:[],Description:"",DetailLink:"",Extras:[],Interests:[],Logo:"",Name:"",OrganisationID:0,OrganisationUUID:"",Slug:"",Tickets:[],Visible:!1}),u=_();H(u,()=>{o.value.find(m=>m.id===u.value&&m.title==="General")&&t()});const t=()=>{d.getConvention(a.params.convention.toString()).then(v=>{v?(n.value=v,r("pageTitle",`Convention Editor - ${n.value.Name}`)):r("pageTitle","Convention Editor - New Convention")})},o=_([{id:q(),title:"Accommodation",component:ie(lt),model:n},{id:q(),title:"Additional Purchases",component:ie(ml),model:n},{id:q(),title:"Fields",component:ie(Ut),model:n},{id:q(),title:"Forms",component:ie(Ft),model:n},{id:q(),title:"Interests",component:ie(Vl),model:n},{id:q(),title:"Tickets",component:ie(Al),model:n},{id:q(),title:"Venues",component:ie(Yl),model:n}]);return r("pageTitle","Convention Editor"),t(),(v,m)=>n.value&&n.value.ConventionUUID!==I(me)?(c(),E($,{key:0},[e(ne,{color:"blue-darken-4"},{default:l(()=>[e(We,{modelValue:u.value,"onUpdate:modelValue":m[0]||(m[0]=s=>u.value=s),"show-arrows":""},{default:l(()=>[(c(!0),E($,null,K(o.value,s=>(c(),C(Qe,{key:s.id,value:s.id},{default:l(()=>[b(R(s.title),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(el,{modelValue:u.value,"onUpdate:modelValue":m[1]||(m[1]=s=>u.value=s),disabled:!0},{default:l(()=>[(c(!0),E($,null,K(o.value,s=>(c(),C(Ze,{key:s.id,value:s.id},{default:l(()=>[s.id===u.value?(c(),C(de,{key:0,class:"pa-2"},{default:l(()=>[(c(),C(ze(s.component),{modelValue:s.model,"onUpdate:modelValue":p=>s.model=p},null,8,["modelValue","onUpdate:modelValue"]))]),_:2},1024)):S("",!0)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])],64)):S("",!0)}});export{da as default};
