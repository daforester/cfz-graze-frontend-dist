import{s as x}from"./index-71069b21.js";import{I as R,r as y,K as c,L as _,M as l,v as e,N as C,S as I,$ as Y,a0 as P,a1 as M,e as W,w as H,R as E,H as $,a2 as B,Q as S,Z as K,O,U as h,P as re,x as he,a4 as be,E as _e,a5 as $e,a6 as ye,a7 as Re,a3 as Be,s as ie,a8 as je}from"./index-839cb292.js";import{m as Ae,a as Fe,s as xe,T as L,b as ze}from"./filter-f313da07.js";import{v as q}from"./v4-a960c1f4.js";import{u as me,a as ue,V as oe}from"./VToolbar-5b16c612.js";import{V as N,l as z,n as j}from"./VContainer-d782aef4.js";import{V as ee}from"./VSpacer-d400ff92.js";import{V as ve}from"./VToolbarItems-ca7b8932.js";import{a as A,V as g}from"./VRow-328dda39.js";import{V as F,a as He}from"./VTextField-d65b4c0c.js";import{c as ce,e as de}from"./VCard-d9f49962.js";import{V as Se,a as Ie,F as we,b as X,_ as qe,c as Je}from"./FormRenderer.vue_vue_type_script_setup_true_lang-8e2f91cc.js";import{V as pe}from"./VDialog-be08cb13.js";import{a as te,b as Pe,V as ke,d as le,c as Ne}from"./VList-1042f362.js";import{_ as Q,V as Me,a as Le}from"./VChip-21c7975b.js";import{V as fe,a as Ve,b as Ue,c as Te,d as ae,e as Ke,_ as Ge,f as Xe,g as We,h as Qe,i as Ze}from"./VWindowItem-66fe03a9.js";import{V as se}from"./VSelect-262ce05c.js";import{V as Z,u as De}from"./VCheckbox-6dcd38a4.js";import{V as el}from"./VTable-a3b392e4.js";import{_ as Ye}from"./DeleteDialog.vue_vue_type_script_setup_true_lang-486c5796.js";import{_ as Oe}from"./ModelDialog.vue_vue_type_script_setup_true_lang-a8ed6654.js";import{a as ll,F as tl}from"./form-aee596e2.js";import"./VAvatar-941ae123.js";import"./index-6e7f979e.js";import"./VCheckboxBtn-05422de0.js";import"./userData-d01c2035.js";import"./VForm-1c0c31d3.js";import"./scopeId-f5c5f613.js";var Ce=(U=>(U.PER_ROOM="PER_ROOM",U.PER_PERSON="PER_PERSON",U))(Ce||{});const al=R({__name:"AddTag",props:{convention:{},organisation:{}},emits:["save","close"],setup(U,{emit:s}){const a=y(""),i=y("");typeof U.convention=="object"?(a.value=U.convention.ConventionUUID,i.value=U.convention.OrganisationUUID):a.value=U.convention||"",typeof U.organisation=="object"?i.value=U.organisation.OrganisationUUID:i.value.length===0&&(i.value=U.organisation||"");const d=y({ID:0,TagUUID:q(),ConventionID:0,ConventionUUID:a.value||me,OrganisationID:0,OrganisationUUID:i.value||me,Title:"",Key:""}),u=Y(),n=()=>{u.saveTag(d.value).then(t=>{t&&(d.value=t,s("save",t),s("close"))})};return(t,o)=>(c(),_(de,null,{default:l(()=>[e(oe,{dark:"",color:"primary"},{default:l(()=>[e(N,{icon:"",dark:"",onClick:o[0]||(o[0]=v=>s("close"))},{default:l(()=>[e(z,null,{default:l(()=>[C("mdi:mdi-close")]),_:1})]),_:1}),e(ue,null,{default:l(()=>[C("Add Tag")]),_:1}),e(ee),e(ve,null,{default:l(()=>[e(N,{variant:"text",onClick:n},{default:l(()=>[C(" Save ")]),_:1})]),_:1})]),_:1}),e(ce,null,{default:l(()=>[e(j,{fluid:!0},{default:l(()=>[e(A,null,{default:l(()=>[e(g,{cols:"12"},{default:l(()=>[e(F,{label:I(x).formLabelDisplayName,type:"text",variant:"outlined",modelValue:d.value.Title,"onUpdate:modelValue":o[1]||(o[1]=v=>d.value.Title=v)},null,8,["label","modelValue"])]),_:1}),e(g,{cols:"12"},{default:l(()=>[e(F,{label:I(x).formLabelTagKey,type:"text",variant:"outlined",modelValue:d.value.Key,"onUpdate:modelValue":o[2]||(o[2]=v=>d.value.Key=v)},null,8,["label","modelValue"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}))}}),ne=R({__name:"SelectTags",props:P({convention:{},organisation:{},chips:{type:Boolean,default:!1},clearable:{type:Boolean,default:!1},hint:{default:""},label:{},variant:{}},{modelValue:{required:!0}}),emits:P(["change"],["update:modelValue"]),setup(U,{emit:s}){const a=M(U,"modelValue"),i=y([]),d=Y(),u=y([]),n=y([]),t=y(""),o=y(""),v=y(0),m=W(()=>[...u.value,...n.value].map(D=>({title:D.Title,value:i.value.find(b=>b.TagUUID===D.TagUUID)||D})));typeof U.convention=="object"?(t.value=U.convention.ConventionUUID,o.value=U.convention.OrganisationUUID):t.value=U.convention||"",typeof U.organisation=="object"?o.value=U.organisation.OrganisationUUID:o.value.length===0&&(o.value=U.organisation||""),(async()=>{const T=[];t.value&&T.push(d.getConventionTags(t.value)),o.value&&T.push(d.getOrganisationTags(o.value));const D=await Promise.all(T);if(t.value&&o.value?(n.value=D[0].sort((b,k)=>b.Title.localeCompare(k.Title)),u.value=D[1].sort((b,k)=>b.Title.localeCompare(k.Title))):t.value&&D.length==1?n.value=D[0].sort((b,k)=>b.Title.localeCompare(k.Title)):o.value&&D.length==1&&(u.value=D[0].sort((b,k)=>b.Title.localeCompare(k.Title))),Array.isArray(a.value))v.value=2,m.value.forEach(b=>{Array.isArray(a.value)&&a.value.find(w=>w.TagUUID===b.value.TagUUID)&&i.value.push(b.value)});else if(typeof a.value=="string"){v.value=1;try{const b=JSON.parse(a.value);m.value.forEach(k=>{b.find(G=>G.TagUUID===k.value.TagUUID)&&i.value.push(k.value)})}catch{}}})();const r=y(!1),p=()=>{r.value=!0},V=T=>{T.ConventionUUID.length>0?n.value.push(T):T.OrganisationUUID.length>0&&u.value.push(T),i.value.push(T),f()},f=()=>{switch(v.value){default:case 2:{a.value=i.value,s("change");break}case 1:{a.value=JSON.stringify(i.value),s("change");break}}};return H(i,f),(T,D)=>(c(),E($,null,[e(Se,{modelValue:i.value,"onUpdate:modelValue":D[1]||(D[1]=b=>i.value=b),chips:T.chips,multiple:"",label:T.label||"Tags",variant:T.variant||"solo",hint:T.hint,"persistent-hint":!0,clearable:T.clearable,items:m.value,"item-title":"title","item-value":"value"},{"prepend-item":l(()=>[e(te,{title:"New Tag",onClick:D[0]||(D[0]=b=>p())},{prepend:l(()=>[e(z,{icon:"mdi:mdi-plus"})]),_:1}),e(Pe,{class:"mt-2"})]),_:1},8,["modelValue","chips","label","variant","hint","clearable","items"]),e(pe,{modelValue:r.value,"onUpdate:modelValue":D[3]||(D[3]=b=>r.value=b),scrollable:!0},{default:l(()=>[e(al,{convention:T.convention,organisation:T.organisation,onClose:D[2]||(D[2]=b=>r.value=!1),onSave:V},null,8,["convention","organisation"])]),_:1},8,["modelValue"])],64))}}),ol=R({__name:"EditConventionExtraOptions",props:P({convention:{}},{modelValue:{}}),emits:P(["close"],["update:modelValue"]),setup(U,{emit:s}){const a=M(U,"modelValue"),i=y(B(a.value)),d=()=>{a.value=i.value,s("close")};return(u,n)=>(c(),_(de,null,{default:l(()=>[e(oe,{dark:"",color:"primary"},{default:l(()=>[e(N,{icon:"",dark:"",onClick:n[0]||(n[0]=t=>s("close"))},{default:l(()=>[e(z,null,{default:l(()=>[C("mdi:mdi-close")]),_:1})]),_:1}),e(ue,null,{default:l(()=>[C("Edit Option Choice")]),_:1}),e(ee),e(ve,null,{default:l(()=>[e(N,{variant:"text",onClick:d},{default:l(()=>[C(" Apply ")]),_:1})]),_:1})]),_:1}),e(ce,{class:"pa-0"},{default:l(()=>[e(j,null,{default:l(()=>[e(F,{label:I(x).formLabelName,type:"text",variant:"outlined",modelValue:i.value.Name,"onUpdate:modelValue":n[1]||(n[1]=t=>i.value.Name=t)},null,8,["label","modelValue"]),e(F,{label:I(x).formLabelDescription,type:"text",variant:"outlined",modelValue:i.value.Description,"onUpdate:modelValue":n[2]||(n[2]=t=>i.value.Description=t)},null,8,["label","modelValue"]),e(F,{label:I(x).formLabelPrice,type:"text",variant:"outlined","prepend-icon":I(x).currencyIcon,modelValue:i.value.Price,"onUpdate:modelValue":n[3]||(n[3]=t=>i.value.Price=t),modelModifiers:{number:!0},hint:"Adds additional charges for selecting this option"},null,8,["label","prepend-icon","modelValue"]),i.value.Choices?(c(),_(ne,{key:0,modelValue:i.value.Choices,"onUpdate:modelValue":n[4]||(n[4]=t=>i.value.Choices=t),convention:u.convention,hint:"Sub-options (tags) that a user may choose from."},null,8,["modelValue","convention"])):S("",!0)]),_:1})]),_:1})]),_:1}))}}),nl=h("h3",null,"Options",-1),ul=R({__name:"EditConventionExtra",props:P({convention:{}},{modelValue:{required:!0}}),emits:["update:modelValue"],setup(U){const s=M(U,"modelValue"),a=y(B(s.value)),i=y(!1),d=y(0),u=Y(),n=y([""]),t=y([]),o=y([]);U.convention&&(u.getConventionTags(U.convention.ConventionUUID).then(f=>{o.value=f.sort((T,D)=>T.Title.localeCompare(D.Title))}),u.getOrganisationTags(U.convention.OrganisationUUID).then(f=>{t.value=f.sort((T,D)=>T.Title.localeCompare(D.Title))}));const v=W(()=>[...t.value,...o.value]),m=({callback:f})=>{u.saveExtra(a.value).then(T=>{T?(s.value=T,f&&f("Extra Saved")):f&&f("Failed to Save Extra")}).catch(()=>{f&&f("Failed to Save Extra")})},r=f=>{var T;f.Options||(f.Options=[]),f.Options.push({ID:0,OptionUUID:q(),ExtraID:f.ID,ExtraUUID:f.ExtraUUID,Order:((T=f.Options)==null?void 0:T.length)+1,Name:"",Description:"",Price:0,Choices:[]})},p=(f,T)=>{f.Options&&f.Options.splice(T,1)},V=f=>{if(f.Choices&&f.Choices.length>0)return f.Choices.map(T=>{const D=v.value.find(b=>b.TagUUID===T.TagUUID);if(D)return D.Title}).join(", ")};return(f,T)=>(c(),E($,null,[e(j,{class:"px-0"},{default:l(()=>[e(F,{label:I(x).formLabelName,type:"text",variant:"outlined",modelValue:a.value.Name,"onUpdate:modelValue":T[0]||(T[0]=D=>a.value.Name=D)},null,8,["label","modelValue"]),e(F,{label:I(x).formLabelDescription,type:"text",variant:"outlined",modelValue:a.value.Description,"onUpdate:modelValue":T[1]||(T[1]=D=>a.value.Description=D)},null,8,["label","modelValue"]),e(ne,{modelValue:a.value.AppliesTags,"onUpdate:modelValue":T[2]||(T[2]=D=>a.value.AppliesTags=D),convention:f.convention,organisation:f.convention.OrganisationUUID,hint:"Tags a user acquires by selecting any option within this addon purchase."},null,8,["modelValue","convention","organisation"]),nl,e(ke,{opened:n.value,"onUpdate:opened":T[3]||(T[3]=D=>n.value=D)},{default:l(()=>[(c(!0),E($,null,K(a.value.Options,(D,b)=>(c(),E($,{key:D.ID},[D?(c(),_(te,{key:0,"prepend-icon":"mdi:mdi-ticket-percent",title:`${D.Name} ${D.Price&&D.Price>0?`(${I(x).currencySymbol}${D.Price})`:""}`},{append:l(()=>[e(N,{color:"red",icon:"mdi:mdi-close",size:"x-small",class:"mr-1",onClick:k=>p(a.value,b)},null,8,["onClick"]),e(N,{color:"primary",icon:"mdi:mdi-pencil",size:"x-small",onClick:k=>{i.value=!0,d.value=b}},null,8,["onClick"])]),default:l(()=>[D.Choices&&D.Choices.length>0?(c(),_(le,{key:0},{default:l(()=>[C(" Options: "+O(V(D)),1)]),_:2},1024)):S("",!0)]),_:2},1032,["title"])):S("",!0)],64))),128))]),_:1},8,["opened"]),e(N,{color:"primary",onClick:T[4]||(T[4]=D=>r(a.value))},{default:l(()=>[C("Add Option")]),_:1}),e(A,null,{default:l(()=>[e(g,{class:"text-right"},{default:l(()=>[e(Q,{onClick:m})]),_:1})]),_:1})]),_:1}),e(pe,{modelValue:i.value,"onUpdate:modelValue":T[7]||(T[7]=D=>i.value=D),scrollable:""},{default:l(()=>[e(ol,{modelValue:a.value.Options[d.value],"onUpdate:modelValue":T[5]||(T[5]=D=>a.value.Options[d.value]=D),convention:f.convention,onClose:T[6]||(T[6]=D=>i.value=!1)},null,8,["modelValue","convention"])]),_:1},8,["modelValue"])],64))}}),il=R({__name:"EditConventionExtras",props:P({convention:{}},{modelValue:{required:!0}}),emits:P(["close"],["update:modelValue"]),setup(U,{emit:s}){const a=M(U,"modelValue"),i=Y(),d=()=>{const t={ID:0,ExtraUUID:q(),ConventionID:U.convention.ID,ConventionUUID:U.convention.ConventionUUID,Order:a.value.length+1,Name:"New Extra",Description:"",AppliesTags:[],Options:[]};i.saveExtra(t).then(o=>{o&&a.value.push(o)})},u=t=>{i.deleteExtra(a.value[t].ExtraUUID).then(o=>{o&&a.value.splice(t,1)})},n=(...t)=>{t.forEach(o=>{o>=0&&o<a.value.length&&i.saveExtra(a.value[o])})};return(t,o)=>(c(),_(de,null,{default:l(()=>[e(oe,{dark:"",color:"primary"},{default:l(()=>[e(N,{icon:"",dark:"",onClick:o[0]||(o[0]=v=>s("close"))},{default:l(()=>[e(z,null,{default:l(()=>[C("mdi:mdi-close")]),_:1})]),_:1}),e(ue,null,{default:l(()=>[C("Edit Extras")]),_:1}),e(ee),e(ve,null,{default:l(()=>[e(N,{variant:"text",onClick:d},{default:l(()=>[C(" Add ")]),_:1})]),_:1})]),_:1}),e(ce,{class:"pa-0"},{default:l(()=>[e(fe,null,{default:l(()=>[(c(!0),E($,null,K(a.value,(v,m)=>(c(),_(Ve,{key:v.ID,class:"mt-0"},{default:l(()=>[e(Ue,null,{actions:l(({expanded:r})=>[e(N,{icon:"mdi:mdi-close",size:"x-small",color:"red",class:"mr-1",onClick:p=>u(m)},null,8,["onClick"]),e(z,{class:"align-self-center text-h5",icon:r?"mdi:mdi-chevron-up":"mdi:mdi-chevron-down",variant:"flat",size:"x-small"},null,8,["icon"])]),default:l(()=>[e(N,{icon:"mdi:mdi-menu-up",size:"x-small",color:"primary",class:"mr-1",onClick:re(r=>{I(Ae)(v,a.value),n(m,m-1)},["stop"])},null,8,["onClick"]),e(N,{icon:"mdi:mdi-menu-down",size:"x-small",color:"secondary",class:"mr-4",onClick:re(r=>{I(Fe)(v,a.value),n(m,m+1)},["stop"])},null,8,["onClick"]),C(" "+O(v.Name)+" ",1)]),_:2},1024),e(Te,{class:"px-0"},{default:l(()=>[e(ul,{convention:t.convention,modelValue:a.value[m],"onUpdate:modelValue":r=>a.value[m]=r},null,8,["convention","modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1}))}}),dl=h("h3",null,"Additional Purchases",-1),sl=h("p",null,"These are global ticket addons that are not tied to any particular ticket type.",-1),rl=R({__name:"Extras",props:{modelValue:{required:!0}},emits:["update:modelValue"],setup(U){const s=M(U,"modelValue"),a=y([]),i=Y(),d=y([""]),u=y(!1),n=o=>{if(o.Choices&&o.Choices.length>0)return o.Choices.map(v=>v.Title).join(", ")},t=()=>{u.value=!1};return i==null||i.getConventionExtras(s.value.ConventionUUID||"").then(o=>{o&&(a.value=o)}),(o,v)=>(c(),E($,null,[e(j,{fluid:!0,class:"px-0"},{default:l(()=>[e(A,null,{default:l(()=>[e(g,null,{default:l(()=>[dl]),_:1}),e(g,{class:"text-right"},{default:l(()=>[e(N,{color:"primary",onClick:v[0]||(v[0]=m=>u.value=!0)},{default:l(()=>[C("Edit")]),_:1})]),_:1})]),_:1})]),_:1}),sl,e(ke,{opened:d.value,"onUpdate:opened":v[1]||(v[1]=m=>d.value=m)},{default:l(()=>[(c(!0),E($,null,K(a.value,m=>(c(),_(Ne,{key:m.ID,value:m.ID},{activator:l(({props:r})=>[e(te,he(r,{"prepend-icon":"mdi:mdi-group",title:m.Name}),null,16,["title"])]),default:l(()=>[m.Options?(c(!0),E($,{key:0},K(m.Options,r=>(c(),_(te,{key:r.ID,"prepend-icon":"mdi:mdi-ticket-percent",title:`${r.Name} ${r.Price&&r.Price>0?`(${I(x).currencySymbol}${r.Price})`:""}`},{default:l(()=>[r.Choices&&r.Choices.length>0?(c(),_(le,{key:0},{default:l(()=>[C(" Options: "+O(n(r)),1)]),_:2},1024)):S("",!0)]),_:2},1032,["title"]))),128)):S("",!0)]),_:2},1032,["value"]))),128))]),_:1},8,["opened"]),e(pe,{modelValue:u.value,"onUpdate:modelValue":v[3]||(v[3]=m=>u.value=m),scrollable:!0},{default:l(()=>[e(il,{modelValue:a.value,"onUpdate:modelValue":v[2]||(v[2]=m=>a.value=m),convention:s.value,onClose:t},null,8,["modelValue","convention"])]),_:1},8,["modelValue"])],64))}}),ml=R({__name:"EditConventionInterest",props:P({convention:{}},{modelValue:{required:!0}}),emits:["update:modelValue"],setup(U){const s=M(U,"modelValue"),a=y(B(s.value)),i=Y(),d=({callback:u})=>{i.saveInterest(a.value).then(n=>{n?(s.value=n,u&&u("Interest Saved")):u&&u("Failed to Save Interest")}).catch(()=>{u&&u("Failed to Save Interest")})};return(u,n)=>(c(),_(j,{class:"px-0"},{default:l(()=>[e(F,{label:I(x).formLabelName,type:"text",variant:"outlined",modelValue:a.value.Name,"onUpdate:modelValue":n[0]||(n[0]=t=>a.value.Name=t)},null,8,["label","modelValue"]),e(Ie,{label:I(x).formLabelDescription,type:"text",variant:"outlined",modelValue:a.value.Description,"onUpdate:modelValue":n[1]||(n[1]=t=>a.value.Description=t)},null,8,["label","modelValue"]),S("",!0),e(ne,{modelValue:a.value.AppliesTags,"onUpdate:modelValue":n[3]||(n[3]=t=>a.value.AppliesTags=t),convention:u.convention,organisation:u.convention.OrganisationUUID,hint:"Tags that a user acquires by selecting this interest."},null,8,["modelValue","convention","organisation"]),e(A,null,{default:l(()=>[e(g,{class:"text-right"},{default:l(()=>[e(Q,{onClick:d})]),_:1})]),_:1})]),_:1}))}}),vl=R({__name:"EditConventionInterests",props:P({convention:{}},{modelValue:{required:!0}}),emits:P(["close"],["update:modelValue"]),setup(U,{emit:s}){const a=M(U,"modelValue"),i=Y(),d=()=>{const t={ID:0,InterestUUID:q(),ConventionID:U.convention.ID,ConventionUUID:U.convention.ConventionUUID,Order:a.value.length+1,Name:"New Interest",Description:"",Price:0,AppliesTags:[]};i.saveInterest(t).then(o=>{o&&a.value.push(o)})},u=t=>{i.deleteInterest(a.value[t].InterestUUID).then(o=>{o&&a.value.splice(t,1)})},n=(...t)=>{t.forEach(o=>{o>=0&&o<a.value.length&&i.saveInterest(a.value[o])})};return(t,o)=>(c(),_(de,null,{default:l(()=>[e(oe,{dark:"",color:"primary"},{default:l(()=>[e(N,{icon:"",dark:"",onClick:o[0]||(o[0]=v=>s("close"))},{default:l(()=>[e(z,null,{default:l(()=>[C("mdi:mdi-close")]),_:1})]),_:1}),e(ue,null,{default:l(()=>[C("Edit Interests")]),_:1}),e(ee),e(ve,null,{default:l(()=>[e(N,{variant:"text",onClick:d},{default:l(()=>[C(" Add ")]),_:1})]),_:1})]),_:1}),e(ce,{class:"pa-0"},{default:l(()=>[e(fe,null,{default:l(()=>[(c(!0),E($,null,K(a.value,(v,m)=>(c(),_(Ve,{key:v.ID,class:"mt-0"},{default:l(()=>[e(Ue,null,{actions:l(({expanded:r})=>[e(Q,{class:"mr-1",color:"red",icon:"mdi:mdi-close",size:"x-small",onClick:p=>u(m)},null,8,["onClick"]),e(z,{class:"align-self-center text-h5",icon:r?"mdi:mdi-chevron-up":"mdi:mdi-chevron-down",variant:"flat",size:"x-small"},null,8,["icon"])]),default:l(()=>[e(N,{icon:"mdi:mdi-menu-up",size:"x-small",color:"primary",class:"mr-1",onClick:re(r=>{I(Ae)(v,a.value),n(m,m-1)},["stop"])},null,8,["onClick"]),e(N,{icon:"mdi:mdi-menu-down",size:"x-small",color:"secondary",class:"mr-4",onClick:re(r=>{I(Fe)(v,a.value),n(m,m+1)},["stop"])},null,8,["onClick"]),C(" "+O(v.Name)+" ",1)]),_:2},1024),e(Te,{class:"px-0"},{default:l(()=>[e(ml,{convention:t.convention,modelValue:a.value[m],"onUpdate:modelValue":r=>a.value[m]=r},null,8,["convention","modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1}))}}),cl=h("h3",null,"Interests",-1),pl=h("p",null,"Attendees can tag themselves for particular things.",-1),fl=R({__name:"Interests",props:{modelValue:{required:!0}},emits:P(["refresh"],["update:modelValue"]),setup(U){const s=M(U,"modelValue"),a=Y(),i=y([]);a.getConventionInterests(s.value.ConventionUUID).then(n=>{xe(n),i.value=n});const d=y([""]),u=y(!1);return(n,t)=>(c(),E($,null,[e(j,{fluid:!0,class:"px-0"},{default:l(()=>[e(A,null,{default:l(()=>[e(g,null,{default:l(()=>[cl]),_:1}),e(g,{class:"text-right"},{default:l(()=>[e(N,{color:"primary",onClick:t[0]||(t[0]=o=>u.value=!0)},{default:l(()=>[C("Edit")]),_:1})]),_:1})]),_:1})]),_:1}),pl,e(ke,{opened:d.value,"onUpdate:opened":t[1]||(t[1]=o=>d.value=o)},{default:l(()=>[(c(!0),E($,null,K(i.value,o=>(c(),_(te,{key:o.ID,"prepend-icon":"mdi:mdi-checkbox-marked-outline",title:`${o.Name} ${o.Price&&o.Price>0?`(${I(x).currencySymbol}${o.Price})`:""}`},{default:l(()=>[o.Description?(c(),_(le,{key:0},{default:l(()=>[C(O(o.Description),1)]),_:2},1024)):S("",!0)]),_:2},1032,["title"]))),128))]),_:1},8,["opened"]),e(pe,{modelValue:u.value,"onUpdate:modelValue":t[4]||(t[4]=o=>u.value=o),scrollable:!0},{default:l(()=>[e(vl,{onClose:t[2]||(t[2]=o=>u.value=!1),convention:s.value,modelValue:i.value,"onUpdate:modelValue":t[3]||(t[3]=o=>i.value=o)},null,8,["convention","modelValue"])]),_:1},8,["modelValue"])],64))}}),ge=R({__name:"SelectTickets",props:P({chips:{type:Boolean,default:!1},clearable:{type:Boolean,default:!1},hint:{default:"Tickets that belong to this group."},label:{default:"Tickets"},persistentHint:{type:Boolean,default:!1},tickets:{default:()=>[]},variant:{}},{modelValue:{required:!0}}),emits:["update:modelValue"],setup(U){const s=M(U,"modelValue"),a=d=>d.Type===L.TICKET_TYPE_GROUP?"mdi:mdi-group":d.Type===L.TICKET_TYPE_TICKET?d.RequiresAccommodation?"mdi:mdi-home":d.ComponentsRequired>0?"mdi:mdi-ticket-confirmation":"mdi:mdi-ticket":d.Type===L.TICKET_TYPE_TICKET_COMPONENT?"mdi:mdi-cog-outline":d.Type===L.TICKET_TYPE_ADD_ON?"mdi:mdi-home-plus":"mdi:mdi-help",i=W(()=>U.tickets.map(d=>({title:d.Name,value:s.value.find(u=>u&&u.TicketUUID===d.TicketUUID)||d,props:{appendIcon:a(d)}})));return(d,u)=>(c(),E("div",null,[e(Se,{label:d.label,variant:d.variant||"filled",items:i.value,"item-title":"title","item-value":"value","item-props":"props",modelValue:s.value,"onUpdate:modelValue":u[0]||(u[0]=n=>s.value=n),hint:d.hint,chips:d.chips,clearable:d.clearable,multiple:"","persistent-hint":d.persistentHint},null,8,["label","variant","items","modelValue","hint","chips","clearable","persistent-hint"])]))}}),Vl=h("p",{title:"Automatically calculated",class:"text-grey-lighten-1"},"Applicable Accommodation:",-1),Ul=R({__name:"EditConventionTicket",props:P({accommodation:{default:()=>[]},convention:{},tickets:{default:()=>[]}},{modelValue:{required:!0}}),emits:["update:modelValue"],setup(U){const s=M(U,"modelValue"),a=y(B(s.value)),i=Y(),d=W(()=>U.tickets.filter(v=>v.Type===L.TICKET_TYPE_TICKET)),u=W(()=>U.tickets.filter(v=>v.Type===L.TICKET_TYPE_ADD_ON)),n=W(()=>U.tickets.filter(v=>v.Type===L.TICKET_TYPE_TICKET_COMPONENT)),t=v=>U.accommodation.filter(m=>m.Costs.find(r=>r.DateStart===v.DateStart&&r.DateEnd===v.DateEnd)),o=({callback:v})=>{i.saveTicket(a.value).then(m=>{m?(a.value.ID=m.ID,a.value.TicketUUID=m.TicketUUID,s.value=a.value,v&&v("Ticket Saved")):v&&v("Failed to Save Ticket")}).catch(()=>{v&&v("Failed to Save Ticket")})};return(v,m)=>(c(),_(j,{class:"px-0",fluid:""},{default:l(()=>[e(A,null,{default:l(()=>[e(g,{cols:"12"},{default:l(()=>[e(se,{label:"Ticket Type",variant:"outlined",modelValue:a.value.Type,"onUpdate:modelValue":m[0]||(m[0]=r=>a.value.Type=r),items:I(ze),"item-title":"title","item-value":"value","hide-details":""},null,8,["modelValue","items"])]),_:1}),e(g,{cols:"12"},{default:l(()=>[e(F,{label:I(x).formLabelName,type:"text",variant:"outlined",modelValue:a.value.Name,"onUpdate:modelValue":m[1]||(m[1]=r=>a.value.Name=r),"hide-details":""},null,8,["label","modelValue"])]),_:1}),e(g,{cols:"12"},{default:l(()=>[e(F,{label:I(x).formLabelDescription,type:"text",variant:"outlined",modelValue:a.value.Description,"onUpdate:modelValue":m[2]||(m[2]=r=>a.value.Description=r),"hide-details":""},null,8,["label","modelValue"])]),_:1}),a.value.Type!==I(L).TICKET_TYPE_GROUP?(c(),E($,{key:0},[e(g,{cols:"12"},{default:l(()=>[e(Z,{label:I(x).formLabelRequiresAccommodation,modelValue:a.value.RequiresAccommodation,"onUpdate:modelValue":m[3]||(m[3]=r=>a.value.RequiresAccommodation=r),"hide-details":""},null,8,["label","modelValue"])]),_:1}),e(g,{cols:"12"},{default:l(()=>[e(F,{label:I(x).formLabelDateStart,type:"date",variant:"outlined",modelValue:a.value.DateStart,"onUpdate:modelValue":m[4]||(m[4]=r=>a.value.DateStart=r),"hide-details":""},null,8,["label","modelValue"])]),_:1}),e(g,{cols:"12"},{default:l(()=>[e(F,{label:I(x).formLabelDateEnd,type:"date",variant:"outlined",modelValue:a.value.DateEnd,"onUpdate:modelValue":m[5]||(m[5]=r=>a.value.DateEnd=r),"hide-details":""},null,8,["label","modelValue"])]),_:1}),e(g,{cols:"12"},{default:l(()=>[e(F,{label:I(x).formLabelPrice,type:"text",variant:"outlined","prepend-inner-icon":I(x).currencyIcon,modelValue:a.value.Price,"onUpdate:modelValue":m[6]||(m[6]=r=>a.value.Price=r),"persistent-hint":"",hint:"Adds additional charges for selecting this ticket"},null,8,["label","prepend-inner-icon","modelValue"])]),_:1})],64)):(c(),_(g,{key:1,cols:"12"},{default:l(()=>[e(ge,{label:"Tickets",variant:"outlined",tickets:d.value,modelValue:a.value.Tickets,"onUpdate:modelValue":m[7]||(m[7]=r=>a.value.Tickets=r),chips:"",clearable:"",multiple:"","persistent-hint":"",hint:"Tickets that belong to this group."},null,8,["tickets","modelValue"])]),_:1})),e(g,{cols:"12"},{default:l(()=>[e(ne,{label:"Applied Tags",variant:"outlined",modelValue:a.value.AppliesTags,"onUpdate:modelValue":m[8]||(m[8]=r=>a.value.AppliesTags=r),convention:v.convention,organisation:v.convention.OrganisationUUID,chips:"",clearable:"",hint:"Tags that a user acquires by selecting this ticket."},null,8,["modelValue","convention","organisation"])]),_:1}),e(g,{cols:"12"},{default:l(()=>[e(ne,{label:"Required Tags",variant:"outlined",modelValue:a.value.RequiredTags,"onUpdate:modelValue":m[9]||(m[9]=r=>a.value.RequiredTags=r),convention:v.convention,organisation:v.convention.OrganisationUUID,chips:"",clearable:"",hint:"Tags that a user must have to see this ticket."},null,8,["modelValue","convention","organisation"])]),_:1}),a.value.Type===I(L).TICKET_TYPE_TICKET?(c(),E($,{key:2},[e(g,{cols:"12"},{default:l(()=>[e(F,{label:"Components Required",type:"number",variant:"outlined",modelValue:a.value.ComponentsRequired,"onUpdate:modelValue":m[10]||(m[10]=r=>a.value.ComponentsRequired=r),modelModifiers:{number:!0},"persistent-hint":"",hint:"How many components must be selected."},null,8,["modelValue"])]),_:1}),e(g,{cols:"12"},{default:l(()=>[e(ge,{label:"Components",variant:"outlined",tickets:n.value,modelValue:a.value.TicketComponents,"onUpdate:modelValue":m[11]||(m[11]=r=>a.value.TicketComponents=r),chips:"",clearable:"",multiple:"","persistent-hint":"",hint:"Components that are part of this ticket (and others)."},null,8,["tickets","modelValue"])]),_:1}),e(g,{cols:"12"},{default:l(()=>[e(ge,{label:"Addons",variant:"outlined",tickets:u.value,modelValue:a.value.AddonTickets,"onUpdate:modelValue":m[12]||(m[12]=r=>a.value.AddonTickets=r),chips:"",clearable:"",multiple:"","persistent-hint":"",hint:"Optional ticket addons that apply for this ticket."},null,8,["tickets","modelValue"])]),_:1})],64)):S("",!0),e(g,{cols:"12"},{default:l(()=>[e(ge,{label:"Disables Tickets",variant:"outlined",tickets:v.tickets,modelValue:a.value.DisablesTickets,"onUpdate:modelValue":m[13]||(m[13]=r=>a.value.DisablesTickets=r),chips:"",clearable:"",multiple:"","persistent-hint":"",hint:"Tickets that are mutually exclusive and can't be selected if this one is."},null,8,["tickets","modelValue"])]),_:1})]),_:1}),t(a.value).length?(c(),_(A,{key:0,class:"align-center",dense:!0},{default:l(()=>[e(g,{class:"flex-grow-0 flex-shrink-1 text-no-wrap font-italic"},{default:l(()=>[Vl]),_:1}),e(g,{class:"flex-grow-1"},{default:l(()=>[e(Me,null,{default:l(()=>[(c(!0),E($,null,K(t(a.value),r=>(c(),_(Le,{key:r.ID,title:"Automatically calculated",disabled:!0},{default:l(()=>[C(O(r.Name),1)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})):S("",!0),e(A,null,{default:l(()=>[e(g,{class:"text-right"},{default:l(()=>[e(Q,{onClick:o})]),_:1})]),_:1})]),_:1}))}}),Tl={class:"pr-2"},Dl={class:"mb-2"},Il={key:0,class:"text-grey-darken-1 font-italic"},gl={key:1,class:"text-red"},yl={key:0,class:"text-grey-darken-1 font-italic"},_l={key:1,class:"text-red"},Cl={key:0,class:"text-grey-darken-1 font-italic"},bl={key:1,class:"text-red"},kl={class:"text-grey-darken-1"},El=R({__name:"EditConventionTickets",props:P({accommodation:{default:()=>[]},convention:{}},{modelValue:{default:[]}}),emits:P(["close"],["update:modelValue"]),setup(U,{emit:s}){const a=M(U,"modelValue"),i=Y(),d=()=>{a.value.push({ID:0,TicketUUID:q(),ConventionID:U.convention.ID,ConventionUUID:U.convention.ConventionUUID,Order:a.value.length+1,Name:"New Ticket",Type:L.TICKET_TYPE_GROUP,Description:"",DateStart:"",DateEnd:"",Price:0,Tickets:[],RequiresAccommodation:!1,AppliesTags:[],RequiredTags:[],RequiredGroupMemberships:[],TicketComponents:[],ComponentsRequired:0,AddonTickets:[],DisablesTickets:[]})},u=t=>{i.deleteTicket(a.value[t].TicketUUID).then(o=>{o&&a.value.splice(t,1)})},n=t=>t.Type===L.TICKET_TYPE_GROUP?"mdi:mdi-group":t.Type===L.TICKET_TYPE_TICKET?t.RequiresAccommodation?"mdi:mdi-home":t.ComponentsRequired>0?"mdi:mdi-ticket-confirmation":"mdi:mdi-ticket":t.Type===L.TICKET_TYPE_TICKET_COMPONENT?"mdi:mdi-cog-outline":t.Type===L.TICKET_TYPE_ADD_ON?"mdi:mdi-home-plus":"mdi:mdi-help";return(t,o)=>(c(),_(de,null,{default:l(()=>[e(oe,{dark:"",color:"primary"},{default:l(()=>[e(N,{icon:"",dark:"",onClick:o[0]||(o[0]=v=>s("close"))},{default:l(()=>[e(z,null,{default:l(()=>[C("mdi:mdi-close")]),_:1})]),_:1}),e(ue,null,{default:l(()=>[C("Edit Tickets")]),_:1}),e(ee),e(ve,null,{default:l(()=>[e(N,{variant:"text",onClick:d},{default:l(()=>[C(" Add Ticket ")]),_:1})]),_:1})]),_:1}),e(ce,{class:"pa-0"},{default:l(()=>[e(fe,null,{default:l(()=>[(c(!0),E($,null,K(a.value,(v,m)=>(c(),_(Ve,{key:v.ID,class:"mt-0"},{default:l(()=>[e(Ue,{class:"py-2"},{actions:l(({expanded:r})=>[e(Q,{class:"mr-1",color:"red",icon:"mdi:mdi-close",size:"x-small",onClick:p=>u(m)},null,8,["onClick"]),e(z,{class:"align-self-center text-h5",icon:r?"mdi:mdi-chevron-up":"mdi:mdi-chevron-down",variant:"flat",size:"x-small"},null,8,["icon"])]),default:l(()=>[e(N,{icon:"mdi:mdi-menu-up",size:"x-small",color:"primary",class:"mr-1",onClick:re(r=>I(Ae)(v,a.value),["stop"])},null,8,["onClick"]),e(N,{icon:"mdi:mdi-menu-down",size:"x-small",color:"secondary",class:"mr-4",onClick:re(r=>I(Fe)(v,a.value),["stop"])},null,8,["onClick"]),h("div",Tl,[e(z,{icon:n(v)},null,8,["icon"])]),h("div",null,[h("p",Dl,[C(O(v.Name)+" ",1),v.Type===I(L).TICKET_TYPE_TICKET?(c(),E($,{key:0},[a.value.find(r=>r.Type===I(L).TICKET_TYPE_GROUP&&r.Tickets.find(p=>p&&p.TicketUUID===v.TicketUUID))?(c(),E("span",Il," ("+O(a.value.filter(r=>r.Type===I(L).TICKET_TYPE_GROUP&&r.Tickets.find(p=>p&&p.TicketUUID===v.TicketUUID)).map(r=>r.Name).join(", "))+") ",1)):(c(),E("span",gl," (Ticket does not belong to any categories.) "))],64)):S("",!0),v.Type===I(L).TICKET_TYPE_ADD_ON?(c(),E($,{key:1},[a.value.find(r=>r.Type===I(L).TICKET_TYPE_TICKET&&r.AddonTickets.find(p=>p&&p.TicketUUID===v.TicketUUID))?(c(),E("span",yl," ("+O(a.value.filter(r=>r.Type===I(L).TICKET_TYPE_TICKET&&r.AddonTickets.find(p=>p&&p.TicketUUID===v.TicketUUID)).map(r=>r.Name).join(", "))+") ",1)):(c(),E("span",_l," (Ticket addon must be associated to at least one ticket.) "))],64)):S("",!0),v.Type===I(L).TICKET_TYPE_TICKET_COMPONENT?(c(),E($,{key:2},[a.value.find(r=>r.Type===I(L).TICKET_TYPE_TICKET&&r.TicketComponents.find(p=>p&&p.TicketUUID===v.TicketUUID))?(c(),E("span",Cl," ("+O(a.value.filter(r=>r.Type===I(L).TICKET_TYPE_TICKET&&r.TicketComponents.find(p=>p&&p.TicketUUID===v.TicketUUID)).map(r=>r.Name).join(", "))+") ",1)):(c(),E("span",bl," (Component has not been assigned to any tickets.) "))],64)):S("",!0)]),h("p",kl,[v.Type===I(L).TICKET_TYPE_GROUP?(c(),E($,{key:0},[C("Category")],64)):v.Type===I(L).TICKET_TYPE_TICKET?(c(),E($,{key:1},[C(" Ticket "),v.ComponentsRequired>0?(c(),E($,{key:0},[C(" ("+O(v.ComponentsRequired)+" component"+O(v.ComponentsRequired>1?"s":"")+" required) ",1)],64)):S("",!0)],64)):S("",!0),v.Type===I(L).TICKET_TYPE_TICKET_COMPONENT?(c(),E($,{key:2},[C("Component")],64)):S("",!0),v.Type===I(L).TICKET_TYPE_ADD_ON?(c(),E($,{key:3},[C("Addon")],64)):S("",!0)])])]),_:2},1024),e(Te,{class:"px-0"},{default:l(()=>[e(Ul,{accommodation:t.accommodation,convention:t.convention,tickets:a.value,modelValue:a.value[m],"onUpdate:modelValue":r=>a.value[m]=r},null,8,["accommodation","convention","tickets","modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1}))}}),hl=h("h3",null,"Tickets",-1),$l=h("p",null,"Ticket options, along with all sub-types and options applicable to them.",-1),Nl=R({__name:"Tickets",props:{modelValue:{required:!0}},emits:P(["refresh"],["update:modelValue"]),setup(U){var r;const s=M(U,"modelValue"),a=Y(),i=y([]),d=y([]);a.getConventionTickets(((r=s.value)==null?void 0:r.ConventionUUID)||"").then(p=>{xe(p),i.value=p});const u=y([""]),n=y(!1),t=p=>p.AddonTickets&&p.AddonTickets.map(V=>i.value&&i.value.find(f=>f.ID===V.ID)),o=p=>p.TicketComponents&&p.TicketComponents.map(V=>i.value&&i.value.find(f=>f.ID===V.ID)),v=p=>"",m=p=>d.value.filter(V=>V.Costs.find(f=>f.DateStart===p.DateStart&&f.DateEnd===p.DateEnd)).map(V=>V.Name).join(", ");return(p,V)=>(c(),E($,null,[e(j,{fluid:!0,class:"px-0"},{default:l(()=>[e(A,null,{default:l(()=>[e(g,null,{default:l(()=>[hl]),_:1}),e(g,{class:"text-right"},{default:l(()=>[e(N,{color:"primary",onClick:V[0]||(V[0]=f=>n.value=!0)},{default:l(()=>[C("Edit")]),_:1})]),_:1})]),_:1})]),_:1}),$l,e(ke,{opened:u.value,"onUpdate:opened":V[1]||(V[1]=f=>u.value=f)},{default:l(()=>[(c(!0),E($,null,K(i.value.filter(f=>f.Type===I(L).TICKET_TYPE_GROUP),f=>(c(),_(Ne,{key:f.ID,value:f.ID},{activator:l(({props:T})=>[e(te,he(T,{"prepend-icon":"mdi:mdi-group",title:f.Name}),null,16,["title"])]),default:l(()=>[(c(!0),E($,null,K(i.value.filter(T=>f.Tickets.find(D=>D&&T&&D.TicketUUID===T.TicketUUID)),T=>(c(),E($,{key:T.ID},[T.AddonTickets&&T.AddonTickets.length?(c(),_(Ne,{key:0,value:T.ID},{activator:l(({props:D})=>[e(te,he(D,{"prepend-icon":T.RequiresAccommodation?"mdi:mdi-home":T.ComponentsRequired>0?"mdi:mdi-ticket-confirmation":"mdi:mdi-ticket",title:`${T.Name} ${T.Price>0?`(${I(x).currencySymbol}${T.Price})`:""}`}),{default:l(()=>[T.ComponentsRequired>0?(c(),_(le,{key:0},{default:l(()=>[C(" Options: "+O(o(T).map(b=>b&&b.Name).join(", ")),1)]),_:2},1024)):S("",!0),T.RequiresAccommodation&&m(T)?(c(),_(le,{key:1},{default:l(()=>[C(" Accommodation: "+O(m(T)),1)]),_:2},1024)):S("",!0)]),_:2},1040,["prepend-icon","title"])]),default:l(()=>[(c(!0),E($,null,K(t(T),D=>(c(),E($,{key:D},[D?(c(),_(te,{key:0,title:`${D.Name} ${D.Price>0?`(${I(x).currencySymbol}${D.Price})`:""}`,"prepend-icon":"mdi:mdi-home-plus"},{default:l(()=>[D.RequiredTags&&D.RequiredTags.length>0?(c(),_(le,{key:0},{default:l(()=>[C(" Required Tags: "+O(D.RequiredTags.join(", ")),1)]),_:2},1024)):S("",!0),D.RequiredGroupMemberships&&D.RequiredGroupMemberships.length>0?(c(),_(le,{key:1},{default:l(()=>[C(" Required Groups: "+O(v(D.RequiredGroupMemberships)),1)]),_:2},1024)):S("",!0),m(D)?(c(),_(le,{key:2},{default:l(()=>[C(" Accommodation: "+O(m(D)),1)]),_:2},1024)):S("",!0)]),_:2},1032,["title"])):S("",!0)],64))),128))]),_:2},1032,["value"])):(c(),_(te,{key:1,"prepend-icon":T.RequiresAccommodation?"mdi:mdi-home":T.ComponentsRequired>0?"mdi:mdi-ticket-confirmation":"mdi:mdi-ticket",title:`${T.Name} ${T.Price>0?`(${I(x).currencySymbol}${T.Price})`:""}`},{default:l(()=>[T.ComponentsRequired>0?(c(),_(le,{key:0},{default:l(()=>[C(" Options: "+O(o(T).map(D=>D&&D.Name).join(", ")),1)]),_:2},1024)):S("",!0)]),_:2},1032,["prepend-icon","title"]))],64))),128))]),_:2},1032,["value"]))),128))]),_:1},8,["opened"]),e(pe,{modelValue:n.value,"onUpdate:modelValue":V[4]||(V[4]=f=>n.value=f),scrollable:!0},{default:l(()=>[e(El,{onClose:V[2]||(V[2]=f=>n.value=!1),modelValue:i.value,"onUpdate:modelValue":V[3]||(V[3]=f=>i.value=f),accommodation:d.value,convention:s.value},null,8,["modelValue","accommodation","convention"])]),_:1},8,["modelValue"])],64))}}),Al=R({__name:"VenueRoomCost",props:{modelValue:{required:!0}},emits:P(["deleted"],["update:modelValue"]),setup(U,{emit:s}){const a=M(U,"modelValue"),i=[{title:"Per Room",value:"PER_ROOM"},{title:"Per Person",value:"PER_PERSON"}],d=()=>{s("deleted")};return(u,n)=>(c(),_(A,{dense:""},{default:l(()=>[e(g,{cols:"12",sm:"4",md:"2",lg:"2"},{default:l(()=>[e(F,{label:I(x).formLabelDateStart,type:"date",variant:"outlined",modelValue:a.value.DateStart,"onUpdate:modelValue":n[0]||(n[0]=t=>a.value.DateStart=t)},null,8,["label","modelValue"])]),_:1}),e(g,{cols:"12",sm:"4",md:"2",lg:"2"},{default:l(()=>[e(F,{label:I(x).formLabelDateEnd,type:"date",variant:"outlined",modelValue:a.value.DateEnd,"onUpdate:modelValue":n[1]||(n[1]=t=>a.value.DateEnd=t)},null,8,["label","modelValue"])]),_:1}),e(g,{cols:"6",sm:"4",md:"2",lg:"2"},{default:l(()=>[e(F,{label:I(x).formLabelAvailability,type:"number",variant:"outlined",modelValue:a.value.Availability,"onUpdate:modelValue":n[2]||(n[2]=t=>a.value.Availability=t),modelModifiers:{number:!0}},null,8,["label","modelValue"])]),_:1}),e(g,{cols:"6",sm:"4",md:"2",lg:"2"},{default:l(()=>[e(F,{label:I(x).formLabelPrice,type:"number","prepend-inner-icon":"mdi:mdi-currency-gbp",variant:"outlined",modelValue:a.value.Price,"onUpdate:modelValue":n[3]||(n[3]=t=>a.value.Price=t),modelModifiers:{number:!0}},null,8,["label","modelValue"])]),_:1}),e(g,{cols:"6",sm:"4",md:"3",lg:"3"},{default:l(()=>[e(se,{label:I(x).formLabelPriceType,variant:"outlined",modelValue:a.value.Type,"onUpdate:modelValue":n[4]||(n[4]=t=>a.value.Type=t),items:i,"item-value":"value","item-title":"title"},null,8,["label","modelValue"])]),_:1}),e(g,{cols:"6",sm:"4",md:"1",class:"text-right"},{default:l(()=>[e(N,{color:"red",icon:"mdi:mdi-minus",onClick:d})]),_:1})]),_:1}))}}),Fl=h("strong",null,"Capacity:",-1),Sl=h("thead",null,[h("tr",null,[h("th",null,"Date"),h("th",null,"Price"),h("th",null,"Availability")])],-1),Pl={class:"d-flex flex-wrap justify-space-between",style:{gap:"1rem"}},Ol=h("h4",null," Availability & Costs (To Organisation) ",-1),Rl=R({__name:"VenueRoom",props:{modelValue:{required:!0}},emits:P(["deleted"],["update:modelValue"]),setup(U,{emit:s}){const a=Y(),i=y(x),d=M(U,"modelValue"),u=y(B(d.value)),n=y(!1),t=p=>{switch(p.Type){case Ce.PER_PERSON:return i.value.enumPER_PERSON;case Ce.PER_ROOM:return i.value.enumPER_ROOM}return"Unknown"},o=()=>{u.value.Costs||(u.value.Costs=[]),u.value.Costs.push({ID:0,CostUUID:q(),Availability:0,DateStart:"",DateEnd:"",Price:0,Type:"PER_ROOM"})},v=p=>{u.value.Costs.splice(p,1)},m=({callback:p})=>{const V=()=>{p&&p("Failed to Delete Room")},f=()=>{p&&p("Room Deleted")};a.deleteRoom(u.value.RoomUUID).then(T=>{T?(f(),s("deleted",u.value)):V()}).catch(()=>{V()})},r=()=>{a.saveRoom(u.value).then(()=>{d.value=u.value,n.value=!1})};return(p,V)=>(c(),E($,null,[e(j,{fluid:"",class:"pa-1 pa-sm-2"},{default:l(()=>[h("h4",null,O(u.value.Name),1),h("p",null,O(u.value.Notes),1),h("p",null,[Fl,C(" "+O(u.value.MinimumCapacity)+" ",1),u.value.MinimumCapacity!=u.value.MaximumCapacity?(c(),E($,{key:0},[C(" - "+O(u.value.MaximumCapacity),1)],64)):S("",!0)]),e(el,{density:"compact"},{default:l(()=>[Sl,h("tbody",null,[(c(!0),E($,null,K(u.value.Costs,f=>(c(),E("tr",{key:`venue-room-${u.value.ID}-cost-${f.ID}`},[h("td",null,O(f.DateStart)+" - "+O(f.DateEnd),1),h("td",null,O(i.value.currencySymbol)+O(f.Price)+" "+O(t(f)),1),h("td",null,O(f.Availability),1)]))),128))])]),_:1}),h("div",Pl,[e(N,{color:"primary","prepend-icon":"mdi:mdi-playlist-edit",onClick:V[0]||(V[0]=f=>n.value=!0)},{default:l(()=>[C("Edit Room")]),_:1}),e(Q,{color:"red-darken-3","prepend-icon":"mdi:mdi-minus",onClick:m},{default:l(()=>[C("Delete Room")]),_:1})])]),_:1}),e(pe,{scrollable:"",modelValue:n.value,"onUpdate:modelValue":V[6]||(V[6]=f=>n.value=f),width:"auto"},{default:l(()=>[e(de,null,{default:l(()=>[e(oe,{dark:"",color:"primary"},{default:l(()=>[e(N,{icon:"",dark:"",onClick:V[1]||(V[1]=f=>n.value=!1)},{default:l(()=>[e(z,null,{default:l(()=>[C("mdi:mdi-close")]),_:1})]),_:1}),e(ue,null,{default:l(()=>[C("Room Details ("+O(u.value.Name)+")",1)]),_:1}),e(ee),e(ve,null,{default:l(()=>[e(N,{variant:"text",onClick:r},{default:l(()=>[C(" Save ")]),_:1})]),_:1})]),_:1}),e(ce,null,{default:l(()=>[e(ae,null,{default:l(()=>[e(A,null,{default:l(()=>[e(g,{cols:"12"},{default:l(()=>[e(F,{label:i.value.formLabelName,type:"text",variant:"outlined",modelValue:u.value.Name,"onUpdate:modelValue":V[2]||(V[2]=f=>u.value.Name=f)},null,8,["label","modelValue"])]),_:1})]),_:1}),e(A,null,{default:l(()=>[e(g,null,{default:l(()=>[e(Ie,{label:i.value.formLabelNotes,variant:"outlined",modelValue:u.value.Notes,"onUpdate:modelValue":V[3]||(V[3]=f=>u.value.Notes=f)},null,8,["label","modelValue"])]),_:1})]),_:1}),e(A,null,{default:l(()=>[e(g,{cols:"12",sm:"6"},{default:l(()=>[e(F,{type:"number",label:i.value.formLabelMinimumCapacity,variant:"outlined",modelValue:u.value.MinimumCapacity,"onUpdate:modelValue":V[4]||(V[4]=f=>u.value.MinimumCapacity=f),modelModifiers:{number:!0}},null,8,["label","modelValue"])]),_:1}),e(g,{cols:"12",sm:"6"},{default:l(()=>[e(F,{type:"number",label:i.value.formLabelMaximumCapacity,variant:"outlined",modelValue:u.value.MaximumCapacity,"onUpdate:modelValue":V[5]||(V[5]=f=>u.value.MaximumCapacity=f),modelModifiers:{number:!0}},null,8,["label","modelValue"])]),_:1})]),_:1}),e(A,null,{default:l(()=>[e(g,null,{default:l(()=>[Ol]),_:1})]),_:1}),(c(!0),E($,null,K(u.value.Costs,(f,T)=>(c(),E($,{key:`venue-room-${u.value.ID}-cost-${f.ID}`},[u.value.Costs&&u.value.Costs[T]?(c(),_(Al,{key:0,modelValue:u.value.Costs[T],"onUpdate:modelValue":D=>u.value.Costs[T]=D,onDeleted:D=>v(T)},null,8,["modelValue","onUpdate:modelValue","onDeleted"])):S("",!0)],64))),128)),e(N,{color:"primary","prepend-icon":"mdi:mdi-plus",onClick:o},{default:l(()=>[C("Add Row")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}}),xl=h("h3",null,"Rooms",-1),wl=R({__name:"Venue",props:{modelValue:{required:!0}},emits:P(["deleted"],["update:modelValue"]),setup(U,{emit:s}){const a=Y(),i=M(U,"modelValue"),d=y(B(i.value)),u=y([]),n=y(!1),t=y(!1);a.getVenueRooms(d.value.VenueUUID).then(p=>{u.value=p}),H(d.value,()=>{t.value=!0});const o=({callback:p})=>{n.value=!0,a.saveVenue(d.value).then(()=>{n.value=!1,t.value=!1,i.value=d.value,p&&p("Venue Saved")}).catch(()=>{n.value=!1,p&&p("Failed to Saved Venue")})},v=({callback:p})=>{n.value=!0,a.deleteVenue(d.value.VenueUUID).then(V=>{n.value=!1,V?p&&(p("Venue Deleted"),s("deleted")):p&&p("Failed to Delete Venue")}).catch(()=>{p&&(p("Failed to Delete Venue"),n.value=!1)})},m=()=>{const p={ID:0,RoomUUID:q(),VenueID:d.value.ID,VenueUUID:d.value.VenueUUID,Order:u.value.length+1,Name:"New Room",Notes:"",MaximumCapacity:1,MinimumCapacity:1,Costs:[]};a.saveRoom(p).then(V=>{V&&u.value.push(V)})},r=(p,V)=>{a.deleteRoom(u.value[V].RoomUUID).then(f=>{f&&u.value.splice(V,1)})};return(p,V)=>(c(),_(Ve,null,{default:l(()=>[e(Ue,null,{default:l(()=>[C(O(d.value.Name),1)]),_:1}),e(Te,null,{default:l(()=>[e(A,{"no-gutters":""},{default:l(()=>[e(g,{cols:"12"},{default:l(()=>[e(F,{label:I(x).formLabelName,name:"name",variant:"outlined",modelValue:d.value.Name,"onUpdate:modelValue":V[0]||(V[0]=f=>d.value.Name=f)},null,8,["label","modelValue"])]),_:1}),e(g,{cols:"12"},{default:l(()=>[e(Ie,{label:I(x).formLabelDescription,name:"description",variant:"outlined",modelValue:d.value.Description,"onUpdate:modelValue":V[1]||(V[1]=f=>d.value.Description=f)},null,8,["label","modelValue"])]),_:1}),e(g,{class:"text-right",cols:"12"},{default:l(()=>[e(Q,{class:"mr-2",color:"red-darken-3",label:"Delete",onClick:v}),e(Q,{enabled:t.value,timeout:"7",onClick:o},null,8,["enabled"])]),_:1})]),_:1}),xl,(c(!0),E($,null,K(u.value,(f,T)=>(c(),_(ae,{variant:"elevation",elevation:"6",key:`venue-room-${f.ID}`},{default:l(()=>[u.value&&u.value[T]?(c(),_(Rl,{key:0,modelValue:u.value[T],"onUpdate:modelValue":D=>u.value[T]=D,onDeleted:D=>r(D,T)},null,8,["modelValue","onUpdate:modelValue","onDeleted"])):S("",!0)]),_:2},1024))),128)),e(ae,{class:"ma-2"},{default:l(()=>[e(N,{color:"primary","prepend-icon":"mdi:mdi-plus",onClick:m},{default:l(()=>[C("Add Room")]),_:1})]),_:1})]),_:1})]),_:1}))}}),ql=h("h3",null,"Venues",-1),Ml=h("p",null," Venues and the rooms they supply to the organisation, this is internal data not seen by attendees. ",-1),Ll=h("p",null," Attendee options are configured via the accommodation tab. ",-1),Kl=R({__name:"VenuesEditorView",props:{modelValue:{required:!0}},emits:P(["close","pageTitle","refresh"],["update:modelValue"]),setup(U,{emit:s}){const a=Y(),i=M(U,"modelValue");s("pageTitle","Venues");const d=y([]);a.getConventionVenues(i.value.ConventionUUID).then(t=>{d.value=t});const u=()=>{const t={ID:0,VenueUUID:q(),ConventionID:i.value.ID,ConventionUUID:i.value.ConventionUUID,Order:d.value.length+1,Name:"New Venue",Description:"",Rooms:[]};a.saveVenue(t).then(o=>{o&&d.value.push(o)})},n=t=>{d.value.splice(t,1)};return(t,o)=>(c(),E($,null,[e(j,{fluid:"",class:"px-0"},{default:l(()=>[e(A,null,{default:l(()=>[e(g,null,{default:l(()=>[ql]),_:1})]),_:1})]),_:1}),Ml,Ll,e(ae,null,{default:l(()=>[e(fe,{variant:"accordion"},{default:l(()=>[(c(!0),E($,null,K(d.value,(v,m)=>(c(),_(wl,{key:`venues-${v.ID}`,modelValue:d.value[m],"onUpdate:modelValue":r=>d.value[m]=r,onDeleted:r=>n(m)},null,8,["modelValue","onUpdate:modelValue","onDeleted"]))),128))]),_:1}),e(ae,{class:"pa-2"},{default:l(()=>[e(N,{color:"primary",onClick:u},{default:l(()=>[C("Add Venue")]),_:1})]),_:1})]),_:1})],64))}}),Gl=h("p",{title:"Automatically calculated",class:"text-grey-lighten-1"},"Applicable Tickets:",-1),Yl=R({__name:"AccommodationCost",props:P({convention:{}},{modelValue:{required:!0}}),emits:P(["deleted"],["update:modelValue"]),setup(U,{emit:s}){const a=M(U,"modelValue"),i=y([]);Y().getConventionTickets(U.convention.ConventionUUID).then(o=>{o&&(i.value=o)});const u=[{title:"Per Room",value:"PER_ROOM"},{title:"Per Person",value:"PER_PERSON"}],n=()=>{s("deleted")},t=W(()=>i.value.filter(o=>(o.Type===L.TICKET_TYPE_TICKET||o.Type===L.TICKET_TYPE_ADD_ON)&&o.RequiresAccommodation&&o.DateStart===a.value.DateStart&&o.DateEnd===a.value.DateEnd));return(o,v)=>(c(),E($,null,[e(A,{class:"align-center",dense:""},{default:l(()=>[e(g,{class:"flex-grow-0 flex-shrink-1 text-no-wrap font-italic"},{default:l(()=>[Gl]),_:1}),e(g,{class:"flex-grow-1"},{default:l(()=>[e(Me,null,{default:l(()=>[(c(!0),E($,null,K(t.value,m=>(c(),_(Le,{key:m.ID,title:"Automatically calculated",disabled:""},{default:l(()=>[C(O(m.Name),1)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1}),e(A,{dense:""},{default:l(()=>[e(g,{cols:"12",sm:"6",md:"3"},{default:l(()=>[e(F,{label:I(x).formLabelDateStart,type:"date",variant:"outlined",modelValue:a.value.DateStart,"onUpdate:modelValue":v[0]||(v[0]=m=>a.value.DateStart=m)},null,8,["label","modelValue"])]),_:1}),e(g,{cols:"12",sm:"6",md:"3"},{default:l(()=>[e(F,{label:I(x).formLabelDateEnd,type:"date",variant:"outlined",modelValue:a.value.DateEnd,"onUpdate:modelValue":v[1]||(v[1]=m=>a.value.DateEnd=m)},null,8,["label","modelValue"])]),_:1}),e(g,{cols:"5",sm:"6",md:"3"},{default:l(()=>[e(F,{label:I(x).formLabelPrice,type:"number","prepend-inner-icon":"mdi:mdi-currency-gbp",variant:"outlined",modelValue:a.value.Price,"onUpdate:modelValue":v[2]||(v[2]=m=>a.value.Price=m),modelModifiers:{number:!0}},null,8,["label","modelValue"])]),_:1}),e(g,{cols:"5",sm:"4",md:"2"},{default:l(()=>[e(se,{label:I(x).formLabelPriceType,variant:"outlined",modelValue:a.value.Type,"onUpdate:modelValue":v[3]||(v[3]=m=>a.value.Type=m),items:u,"item-value":"value","item-title":"title"},null,8,["label","modelValue"])]),_:1}),e(g,{cols:"2",sm:"2",md:"1",class:"text-right"},{default:l(()=>[e(N,{color:"red",icon:"mdi:mdi-minus",onClick:n})]),_:1})]),_:1})],64))}}),Bl=h("h4",null," Room Pool ",-1),jl=h("p",{class:"mb-4"}," Hotel rooms that can be used for this accommodation option. ",-1),zl=h("p",null," Pool total: ",-1),Hl=h("h4",null," Accommodation Costs ",-1),Jl=h("p",{class:"mb-4"}," How much the attendee is charged by the convention for the accommodation. ",-1),Xl=R({__name:"Accommodation",props:P({convention:{},venues:{}},{modelValue:{required:!0}}),emits:P(["deleted"],["update:modelValue"]),setup(U,{emit:s}){const a=Y(),i=M(U,"modelValue"),d=y(B(i.value)),u=W(()=>U.venues.map(m=>m.Rooms.map(r=>({title:` ${m.Name} - ${r.Name}`,value:r}))).flat()),n=()=>{d.value.Costs||(d.value.Costs=[]),d.value.Costs.push({ID:0,CostUUID:q(),Availability:0,DateStart:"",DateEnd:"",Price:0,Type:Ce.PER_ROOM})},t=m=>{d.value.Costs.splice(m,1)},o=({callback:m})=>{a.deleteAccommodation(d.value.AccommodationUUID).then(r=>{r?m&&(m("Accommodation Deleted"),s("deleted")):m&&m("Failed to Delete Accommodation")}).catch(()=>{m&&m("Failed to Delete Accommodation")})},v=({callback:m})=>{a.saveAccommodation(d.value).then(r=>{r?(d.value.ID=r.ID,i.value=r,m&&m("Accommodation Saved")):m&&m("Failed to Save Accommodation")}).catch(()=>{m&&m("Failed to Save Accommodation")})};return(m,r)=>(c(),_(Ve,null,{default:l(()=>[e(Ue,null,{default:l(()=>[C(O(d.value.Name),1)]),_:1}),e(Te,null,{default:l(()=>[e(ae,null,{default:l(()=>[e(A,null,{default:l(()=>[e(g,null,{default:l(()=>[e(F,{modelValue:d.value.Name,"onUpdate:modelValue":r[0]||(r[0]=p=>d.value.Name=p),label:"Name",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1})]),_:1}),e(A,null,{default:l(()=>[e(g,null,{default:l(()=>[Bl,jl,e(se,{clearable:!0,modelValue:d.value.Pool,"onUpdate:modelValue":r[1]||(r[1]=p=>d.value.Pool=p),items:u.value,label:"Select",multiple:"",hint:"Pick appropriate rooms","persistent-hint":"",variant:"outlined","item-title":"title","item-value":"value",eager:!0},null,8,["modelValue","items"]),zl,h("p",null,[e(ne,{label:"Required Tags",variant:"outlined",modelValue:d.value.RequiredTags,"onUpdate:modelValue":r[2]||(r[2]=p=>d.value.RequiredTags=p),convention:m.convention,organisation:m.convention.OrganisationUUID,chips:!0,clearable:!0,hint:"Tags that a user must have to select this accommodation."},null,8,["modelValue","convention","organisation"])]),Hl,Jl,d.value.Costs?(c(!0),E($,{key:0},K(d.value.Costs,(p,V)=>(c(),_(Yl,{key:`venue-room-${d.value.ID}-cost-${p.ID}`,convention:m.convention,modelValue:d.value.Costs[V],"onUpdate:modelValue":f=>d.value.Costs[V]=f,onDeleted:f=>t(V)},null,8,["convention","modelValue","onUpdate:modelValue","onDeleted"]))),128)):S("",!0)]),_:1})]),_:1}),e(A,{"no-gutters":""},{default:l(()=>[e(g,{class:"text-left"},{default:l(()=>[e(N,{color:"primary","prepend-icon":"mdi:mdi-plus",onClick:n},{default:l(()=>[C("Add Row")]),_:1})]),_:1}),e(g,{class:"text-right"},{default:l(()=>[e(Q,{class:"mr-2",color:"red-darken-3",label:"Delete",onClick:o}),e(Q,{onClick:v})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}))}}),Wl=h("h3",null,"Accommodation",-1),Ql=h("p",null," Accommodation options presented to attendees, these are effectively virtual room types which are linked to the available room pools created in the venues tab. ",-1),Zl=h("p",null," Use the venues tab to configure internal data about the venues and room supply. ",-1),et=R({__name:"AccommodationEditorView",props:{modelValue:{required:!0}},emits:["update:modelValue"],setup(U){const s=Y(),a=M(U,"modelValue"),i=y([]),d=y([]);s.getConventionAccommodation(a.value.ConventionUUID).then(t=>{t&&(i.value=t)}),s.getConventionVenues(a.value.ConventionUUID).then(t=>{t&&(d.value=t)});const u=()=>{const t={ID:0,AccommodationUUID:q(),ConventionID:a.value.ID,ConventionUUID:a.value.ConventionUUID,Order:i.value.length+1,Name:"New Accommodation Option",Pool:[],Costs:[],RequiredTags:[]};s.saveAccommodation(t).then(o=>{o&&i.value.push(o)})},n=t=>{i.value.splice(t,1)};return(t,o)=>(c(),E($,null,[e(j,{fluid:!0,class:"px-0"},{default:l(()=>[e(A,null,{default:l(()=>[e(g,null,{default:l(()=>[Wl]),_:1})]),_:1})]),_:1}),Ql,Zl,e(ae,null,{default:l(()=>[e(fe,{variant:"accordion"},{default:l(()=>[(c(!0),E($,null,K(i.value,(v,m)=>(c(),_(Xl,{key:v.AccommodationUUID,convention:a.value,venues:d.value,modelValue:i.value[m],"onUpdate:modelValue":r=>i.value[m]=r,onDeleted:r=>n(m)},null,8,["convention","venues","modelValue","onUpdate:modelValue","onDeleted"]))),128))]),_:1}),e(ae,{class:"pa-2"},{default:l(()=>[e(N,{color:"primary",onClick:u},{default:l(()=>[C("Add Accommodation")]),_:1})]),_:1})]),_:1})],64))}}),lt=R({__name:"EditFieldDialogExtras",props:{modelValue:{required:!0}},emits:["update:modelValue"],setup(U){const s=M(U,"modelValue"),a=be.getInstance(),i=y([]),d=y([]);return a==null||a.getConventionExtras(s.value.ConventionUUID).then(u=>{i.value=u;const n=s.value.Values.find(t=>t.Title==="SelectedExtras");if(n)try{d.value=JSON.parse(n.Value)}catch{}}),H(d,()=>{const u=s.value.Values.find(n=>n.Title==="SelectedExtras");if(u)u.Value=JSON.stringify(d.value);else{const n={ID:0,FieldValueUUID:q(),FieldID:s.value.ID,FieldUUID:s.value.FieldUUID,Title:"SelectedExtras",Value:JSON.stringify(d.value)};s.value.Values.push(n)}}),(u,n)=>(c(!0),E($,null,K(i.value,t=>(c(),_(Z,{key:t.ExtraUUID,modelValue:d.value,"onUpdate:modelValue":n[0]||(n[0]=o=>d.value=o),label:t.Name,value:t.ExtraUUID,name:s.value.Name,"hide-details":""},null,8,["modelValue","label","value","name"]))),128))}}),tt=R({__name:"EditFieldDialogInterests",props:{modelValue:{required:!0}},emits:["update:modelValue"],setup(U){const s=M(U,"modelValue"),a=be.getInstance(),i=y([]),d=y([]);return a==null||a.getConventionInterests(s.value.ConventionUUID).then(u=>{i.value=u;const n=s.value.Values.find(t=>t.Title==="SelectedInterests");if(n)try{d.value=JSON.parse(n.Value)}catch{}}),H(d,()=>{const u=s.value.Values.find(n=>n.Title==="SelectedInterests");if(u)u.Value=JSON.stringify(d.value);else{const n={ID:0,FieldValueUUID:q(),FieldID:s.value.ID,FieldUUID:s.value.FieldUUID,Title:"SelectedInterests",Value:JSON.stringify(d.value)};s.value.Values.push(n)}}),(u,n)=>(c(!0),E($,null,K(i.value,t=>(c(),_(Z,{key:t.InterestUUID,modelValue:d.value,"onUpdate:modelValue":n[0]||(n[0]=o=>d.value=o),label:t.Name,value:t.InterestUUID,name:s.value.Name,"hide-details":""},null,8,["modelValue","label","value","name"]))),128))}}),at=R({__name:"EditFieldDialogTickets",props:{modelValue:{required:!0}},emits:["update:modelValue"],setup(U){const s=M(U,"modelValue"),a=be.getInstance(),i=y([]),d=y([]);return a==null||a.getConventionTickets(s.value.ConventionUUID).then(u=>{i.value=u;const n=s.value.Values.find(t=>t.Title==="SelectedTickets");if(n)try{d.value=JSON.parse(n.Value)}catch{}}),H(d,()=>{const u=s.value.Values.find(n=>n.Title==="SelectedTickets");if(u)u.Value=JSON.stringify(d.value);else{const n={ID:0,FieldValueUUID:q(),FieldID:s.value.ID,FieldUUID:s.value.FieldUUID,Title:"SelectedTickets",Value:JSON.stringify(d.value)};s.value.Values.push(n)}}),(u,n)=>(c(!0),E($,null,K(i.value.filter(t=>t&&t.Type===I(L).TICKET_TYPE_GROUP),t=>(c(),_(Z,{key:t.TicketUUID,modelValue:d.value,"onUpdate:modelValue":n[0]||(n[0]=o=>d.value=o),label:t.Name,value:t.TicketUUID,name:s.value.Name,"hide-details":""},null,8,["modelValue","label","value","name"]))),128))}}),ot=R({__name:"EditFieldDialogAccommodation",props:{modelValue:{required:!0}},emits:["update:modelValue"],setup(U){const s=M(U,"modelValue"),a=be.getInstance(),i=y([]),d=y(s.value.Values.map(n=>n.Value)),u=()=>{s.value.Values=d.value.map(n=>{var t,o,v;return{ID:0,FieldValueUUID:q(),FieldID:((t=s.value)==null?void 0:t.ID)||0,FieldUUID:((o=s.value)==null?void 0:o.FieldUUID)||"",Title:((v=i.value.find(m=>m.AccommodationUUID==n))==null?void 0:v.Name)||"",Value:n}})};return a==null||a.getConventionAccommodation(s.value.ConventionUUID).then(n=>{n&&(i.value=n)}),(n,t)=>(c(!0),E($,null,K(i.value,o=>(c(),_(Z,{key:o.ID,modelValue:d.value,"onUpdate:modelValue":t[0]||(t[0]=v=>d.value=v),label:o.Name,value:o.AccommodationUUID,"hide-details":"",onChange:u},null,8,["modelValue","label","value"]))),128))}}),nt=R({__name:"EditFieldDialogAge",props:P({convention:{}},{modelValue:{required:!0}}),emits:["update:modelValue"],setup(U){var m,r,p;const s=M(U,"modelValue"),a=new Date,i=a.getFullYear(),d=(a.getMonth()+1).toLocaleString(navigator.language,{minimumIntegerDigits:2}),u=a.getDate().toLocaleString(navigator.language,{minimumIntegerDigits:2}),n=y(parseInt(((m=s.value.Values.find(V=>V.Title==="MIN_AGE"))==null?void 0:m.Value)||"18")),t=y(((r=s.value.Values.find(V=>V.Title==="BEFORE_DATE"))==null?void 0:r.Value)||`${i}-${d}-${u}`),o=y(((p=s.value.Values.find(V=>V.Title==="UNDER_AGE_APPLY_TAG"))==null?void 0:p.Value)||""),v=()=>{var V,f,T,D,b,k;s.value.Values=[{ID:0,FieldValueUUID:q(),FieldID:((V=s.value)==null?void 0:V.ID)||0,FieldUUID:((f=s.value)==null?void 0:f.FieldUUID)||"",Title:"MIN_AGE",Value:n.value.toString()},{ID:0,FieldValueUUID:q(),FieldID:((T=s.value)==null?void 0:T.ID)||0,FieldUUID:((D=s.value)==null?void 0:D.FieldUUID)||"",Title:"BEFORE_DATE",Value:t.value},{ID:0,FieldValueUUID:q(),FieldID:((b=s.value)==null?void 0:b.ID)||0,FieldUUID:((k=s.value)==null?void 0:k.FieldUUID)||"",Title:"UNDER_AGE_APPLY_TAG",Value:o.value}]};return v(),(V,f)=>(c(),_(j,{class:"pl-0 pr-0",fluid:!0},{default:l(()=>[e(A,null,{default:l(()=>[e(g,{cols:"12",sm:"6"},{default:l(()=>[e(F,{modelValue:n.value,"onUpdate:modelValue":f[0]||(f[0]=T=>n.value=T),modelModifiers:{number:!0},type:"number",label:"Minimum Age",variant:"outlined",onChange:v},null,8,["modelValue"])]),_:1}),e(g,{cols:"12",sm:"6"},{default:l(()=>[e(F,{modelValue:t.value,"onUpdate:modelValue":f[1]||(f[1]=T=>t.value=T),type:"date",label:"Date to attain minimum age by",variant:"outlined",onChange:v},null,8,["modelValue"])]),_:1})]),_:1}),e(A,null,{default:l(()=>[e(g,null,{default:l(()=>[e(ne,{modelValue:o.value,"onUpdate:modelValue":f[2]||(f[2]=T=>o.value=T),convention:V.convention,chips:!0,clearable:!0,variant:"outlined",label:`Tags applied to users under ${n.value} at time of data entry`,onChange:v},null,8,["modelValue","convention","label"])]),_:1})]),_:1})]),_:1}))}}),ut=h("h4",null,"Values",-1),it=h("h4",null,"Accommodation",-1),dt=h("h4",null,"Age",-1),st=h("h4",null,"Additional Purchases",-1),rt=h("h4",null,"Available Interests",-1),mt=h("h4",null,"Tickets",-1),vt=h("h4",{class:"mb-3"},"Field Preview",-1),ct=R({__name:"EditFieldDialog",props:P({convention:{},field:{},title:{}},{modelValue:{type:Boolean,required:!0}}),emits:P(["update:field"],["update:modelValue"]),setup(U,{emit:s}){const a=U,{convention:i,title:d=""}=a,u=M(U,"modelValue"),n=De(a,s,void 0,void 0,"field"),t=y(B(n.value)),o=y(""),v=y(t.value.Type);H(n,()=>{t.value=B(n.value)});const m=()=>{u.value=!1},r=()=>{t.value=B(n.value)},p=()=>{n.value=t.value},V=()=>{t.value.Values.push({ID:0,FieldValueUUID:q(),FieldID:t.value.ID,FieldUUID:t.value.FieldUUID,Title:"",Value:""})},f=D=>{t.value.Values.splice(D,1)},T=()=>{o.value="",t.value.Values=[]};return H(v,(D,b)=>{D!==b&&(t.value.Type=D,T())}),(D,b)=>(c(),_(Oe,{modelValue:u.value,"onUpdate:modelValue":b[13]||(b[13]=k=>u.value=k),onReset:r,onSave:p,title:I(d),color:"primary"},{default:l(()=>[e(j,{class:"pa-0",fluid:!0},{default:l(()=>[e(A,null,{default:l(()=>[e(g,{cols:"12"},{default:l(()=>[e(j,{class:"pa-0",fluid:!0},{default:l(()=>[e(A,null,{default:l(()=>[e(g,{cols:"12",sm:"6",md:"4"},{default:l(()=>[e(F,{modelValue:t.value.Name,"onUpdate:modelValue":b[0]||(b[0]=k=>t.value.Name=k),label:"Internal name",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),e(g,{cols:"12",sm:"6",md:"4"},{default:l(()=>[e(F,{modelValue:t.value.Label,"onUpdate:modelValue":b[1]||(b[1]=k=>t.value.Label=k),label:"Label",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),e(g,{cols:"12",sm:"6",md:"4"},{default:l(()=>[e(F,{modelValue:t.value.Hint,"onUpdate:modelValue":b[2]||(b[2]=k=>t.value.Hint=k),label:"Hint",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),e(g,{cols:"12",sm:"6",md:"4"},{default:l(()=>[e(F,{modelValue:t.value.Placeholder,"onUpdate:modelValue":b[3]||(b[3]=k=>t.value.Placeholder=k),label:"Placeholder",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),e(g,{cols:"12",sm:"6",md:"4"},{default:l(()=>[e(se,{modelValue:v.value,"onUpdate:modelValue":b[4]||(b[4]=k=>v.value=k),label:"Type",variant:"outlined",items:I(we),"hide-details":""},null,8,["modelValue","items"])]),_:1}),t.value.Type===I(X).SELECT||t.value.Type===I(X).CHECKBOX?(c(),_(g,{key:0,cols:"12",sm:"6",md:"4",class:"py-0"},{default:l(()=>[e(Z,{modelValue:t.value.Multiple,"onUpdate:modelValue":b[5]||(b[5]=k=>t.value.Multiple=k),label:"Multiple Items",hint:"Can select multiple items from list","hide-details":"",density:"compact"},null,8,["modelValue"]),t.value.Type===I(X).SELECT?(c(),_(Z,{key:0,modelValue:t.value.Autofill,"onUpdate:modelValue":b[6]||(b[6]=k=>t.value.Autofill=k),label:"Searchable List","hide-details":"",density:"compact"},null,8,["modelValue"])):S("",!0)]),_:1})):S("",!0)]),_:1}),t.value.Type===I(X).SELECT||t.value.Type===I(X).CHECKBOX&&t.value.Multiple||t.value.Type===I(X).RADIO?(c(),_(A,{key:0},{default:l(()=>[e(g,null,{default:l(()=>[ut,e(j,{fluid:!0,class:"px-0"},{default:l(()=>[(c(!0),E($,null,K(t.value.Values,(k,w)=>(c(),_(A,{key:k.ID},{default:l(()=>[e(g,{cols:"12",sm:"5",md:"6"},{default:l(()=>[e(F,{modelValue:k.Title,"onUpdate:modelValue":G=>k.Title=G,label:"Display",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(g,{cols:"9",sm:"5",md:"5"},{default:l(()=>[e(F,{modelValue:k.Value,"onUpdate:modelValue":G=>k.Value=G,label:"Internal Value",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(g,{cols:"3",sm:"2",md:"1",class:"d-flex align-center"},{default:l(()=>[e(N,{icon:"mdi:mdi-window-close",size:"small",color:"red",onClick:G=>f(w)},null,8,["onClick"])]),_:2},1024)]),_:2},1024))),128)),e(A,null,{default:l(()=>[e(g,null,{default:l(()=>[e(N,{"prepend-icon":"mdi:mdi-plus",color:"primary",onClick:V},{default:l(()=>[C("Add Item")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})):t.value.Type===I(X).ACCOMMODATION?(c(),_(A,{key:1},{default:l(()=>[e(g,null,{default:l(()=>[it,e(ot,{modelValue:t.value,"onUpdate:modelValue":b[7]||(b[7]=k=>t.value=k)},null,8,["modelValue"])]),_:1})]),_:1})):t.value.Type===I(X).AGE?(c(),_(A,{key:2},{default:l(()=>[e(g,null,{default:l(()=>[dt,e(nt,{modelValue:t.value,"onUpdate:modelValue":b[8]||(b[8]=k=>t.value=k),convention:I(i)},null,8,["modelValue","convention"])]),_:1})]),_:1})):t.value.Type===I(X).EXTRAS?(c(),_(A,{key:3},{default:l(()=>[e(g,null,{default:l(()=>[st,e(lt,{modelValue:t.value,"onUpdate:modelValue":b[9]||(b[9]=k=>t.value=k)},null,8,["modelValue"])]),_:1})]),_:1})):t.value.Type===I(X).INTERESTS?(c(),_(A,{key:4},{default:l(()=>[e(g,null,{default:l(()=>[rt,e(tt,{modelValue:t.value,"onUpdate:modelValue":b[10]||(b[10]=k=>t.value=k)},null,8,["modelValue"])]),_:1})]),_:1})):t.value.Type===I(X).TICKET?(c(),_(A,{key:5},{default:l(()=>[e(g,null,{default:l(()=>[mt,e(at,{modelValue:t.value,"onUpdate:modelValue":b[11]||(b[11]=k=>t.value=k)},null,8,["modelValue"])]),_:1})]),_:1})):S("",!0)]),_:1})]),_:1}),e(g,{cols:"12"},{default:l(()=>[e(ae,{elevation:"5",class:"pa-2",color:"text-center"},{default:l(()=>[vt,e(qe,{admin:!0,field:t.value,convention:I(i),modelValue:o.value,"onUpdate:modelValue":b[12]||(b[12]=k=>o.value=k)},null,8,["field","convention","modelValue"])]),_:1})]),_:1})]),_:1})]),_:1})]),actions:l(()=>[e(N,{color:"blue-darken-1",variant:"text",onClick:m},{default:l(()=>[C(" Cancel ")]),_:1}),e(N,{color:"blue-darken-1",variant:"text",onClick:r},{default:l(()=>[C(" Reset ")]),_:1}),e(ee),e(N,{color:"blue-darken-1",variant:"text",onClick:p},{default:l(()=>[C(" Save ")]),_:1})]),_:1},8,["modelValue","title"]))}}),pt=R({__name:"FieldEditor",props:{modelValue:{required:!0}},emits:P(["refresh"],["update:modelValue"]),setup(U){const s=M(U,"modelValue"),a=Y(),i=y(!1),d=y(!1),u=y([{key:"Label",title:"Label",align:"start",sortable:!0},{key:"Name",title:"Internal Name",align:"start",sortable:!0},{key:"Type",title:"Type",align:"start",sortable:!0},{key:"actions",title:"Actions",sortable:!1}]),n=y([]);a.getConventionFields(s.value.ConventionUUID).then(w=>{w&&(n.value=w)});const t=y(-1),o=y({ID:0,FieldUUID:q(),ConventionID:s.value.ID,ConventionUUID:s.value.ConventionUUID,Autofill:!1,Hint:"",Label:"",Multiple:!1,Name:"",Placeholder:"",Type:"TEXT",Values:[]}),v=W(()=>t.value===-1?"New Field":"Edit Field"),m=()=>({ID:0,FieldUUID:q(),ConventionID:s.value.ID,ConventionUUID:s.value.ConventionUUID,Autofill:!1,Hint:"",Label:"",Multiple:!1,Name:"",Placeholder:"",Type:"TEXT",Values:[]}),r=y(m()),p=()=>{r.value.FieldUUID=q(),o.value=Object.assign({},m()),t.value=-1,i.value=!0},V=w=>{t.value=n.value.indexOf(w),o.value=Object.assign({},w),i.value=!0},f=w=>{t.value=n.value.indexOf(w),o.value=Object.assign({},w),d.value=!0},T=()=>{a.deleteField(o.value.FieldUUID).then(w=>{w&&(n.value.splice(t.value,1),b())})},D=()=>{i.value=!1,_e(()=>{o.value=Object.assign({},r.value),t.value=-1})},b=()=>{d.value=!1,_e(()=>{o.value=Object.assign({},r.value),t.value=-1})},k=()=>{a.saveField(o.value).then(w=>{w&&(t.value>-1?Object.assign(n.value[t.value],w):n.value.push(w),D())})};return(w,G)=>(c(),_(I(Ke),{headers:u.value,items:n.value,"sort-by":[{key:"calories",order:"asc"}],class:"elevation-1"},{top:l(()=>[e(oe,{color:"primary"},{default:l(()=>[e(ue,null,{default:l(()=>[C("Field Editor")]),_:1}),e(Pe,{class:"mx-4",inset:!0,vertical:!0}),e(ee),e(N,{dark:"",class:"mb-2","prepend-icon":"mdi:mdi-pencil",onClick:p},{default:l(()=>[C(" New Item ")]),_:1}),e(Ye,{modelValue:d.value,"onUpdate:modelValue":G[0]||(G[0]=J=>d.value=J),onDelete:T},null,8,["modelValue"])]),_:1}),i.value?(c(),_(ct,{key:0,modelValue:i.value,"onUpdate:modelValue":G[1]||(G[1]=J=>i.value=J),field:o.value,"onUpdate:field":[G[2]||(G[2]=J=>o.value=J),k],title:v.value,convention:s.value},null,8,["modelValue","field","title","convention"])):S("",!0)]),"item.actions":l(({item:J})=>[e(z,{size:"small",class:"me-2",onClick:Ee=>V(J.raw)},{default:l(()=>[C(" mdi:mdi-pencil ")]),_:2},1032,["onClick"]),e(z,{size:"small",onClick:Ee=>f(J.raw)},{default:l(()=>[C(" mdi:mdi-delete ")]),_:2},1032,["onClick"])]),_:1},8,["headers","items"]))}}),ft=(U,s)=>{const a=De(U,s),i=De(U,s,void 0,void 0,"item"),d=y(B(i.value));return H(i,()=>{d.value=B(i.value)}),{state:a,model:i,close:()=>{a.value=!1},reset:()=>{i.value=B(d.value)},save:()=>{s("save")}}},Vt=R({__name:"EditItemDialog",props:{item:{},modelValue:{type:Boolean},title:{},cardClass:{}},emits:["update:modelValue","update:item","save"],setup(U,{emit:s}){const a=U,{state:i,model:d,close:u,reset:n,save:t}=ft(a,s);return(o,v)=>(c(),_(Oe,{modelValue:I(i),"onUpdate:modelValue":v[0]||(v[0]=m=>ye(i)?i.value=m:null),onReset:I(n),onSave:I(t),title:o.title,color:"primary","card-class":o.cardClass},{toolbarButtons:l(()=>[$e(o.$slots,"toolbarButtons")]),actions:l(()=>[e(N,{color:"blue-darken-1",variant:"text",onClick:I(u)},{default:l(()=>[C(" Cancel ")]),_:1},8,["onClick"]),e(N,{color:"blue-darken-1",variant:"text",onClick:I(n)},{default:l(()=>[C(" Reset ")]),_:1},8,["onClick"]),e(ee),e(N,{color:"blue-darken-1",variant:"text",onClick:I(t)},{default:l(()=>[C(" Save ")]),_:1},8,["onClick"])]),default:l(()=>[$e(o.$slots,"default")]),_:3},8,["modelValue","onReset","onSave","title","card-class"]))}}),Ut={class:"pa-0 border-0 ma-0"},Tt=h("legend",{class:"mb-2"},"Field Settings",-1),Dt={class:"pa-0 border-0 ma-0"},It=h("legend",{class:"text-blue-accent-2 mb-2"},"Field Preview",-1),gt=R({__name:"EditFormField",props:P({convention:{}},{modelValue:{required:!0}}),emits:["update:modelValue"],setup(U){const s=M(U,"modelValue"),a=Y(),i=y([]),d=y([]),u=y(""),n=t=>{var o;s.value.Field=(o=d.value.find(v=>v.value===t))==null?void 0:o.field};return a.getConventionFields(U.convention.ConventionUUID).then(t=>{t&&(i.value=t,d.value=t.map(o=>({title:`${o.Label} (${(we.find(v=>v.value===o.Type)||{title:""}).title})`,value:o.FieldUUID,field:o})),n(s.value.FieldUUID))}),(t,o)=>(c(),_(A,null,{default:l(()=>[e(g,{cols:"12",md:"6"},{default:l(()=>[h("fieldset",Ut,[Tt,e(A,null,{default:l(()=>[e(g,{cols:"12"},{default:l(()=>[e(se,{modelValue:s.value.FieldUUID,"onUpdate:modelValue":[o[0]||(o[0]=v=>s.value.FieldUUID=v),n],items:d.value,"item-title":"title","item-value":"value",label:"Field",variant:"outlined","hide-details":""},null,8,["modelValue","items"])]),_:1}),e(g,{cols:"6",sm:"4"},{default:l(()=>[e(F,{modelValue:s.value.MinLength,"onUpdate:modelValue":o[1]||(o[1]=v=>s.value.MinLength=v),modelModifiers:{number:!0},label:"Min Length",type:"number",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),e(g,{cols:"6",sm:"4"},{default:l(()=>[e(F,{modelValue:s.value.MaxLength,"onUpdate:modelValue":o[2]||(o[2]=v=>s.value.MaxLength=v),modelModifiers:{number:!0},label:"Max Length",type:"number",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),e(g,{cols:"12",sm:"4"},{default:l(()=>[e(Z,{modelValue:s.value.Required,"onUpdate:modelValue":o[3]||(o[3]=v=>s.value.Required=v),modelModifiers:{boolean:!0},label:"Required","hide-details":""},null,8,["modelValue"])]),_:1})]),_:1})])]),_:1}),s.value.FieldUUID&&s.value.Field?(c(),_(g,{key:0,cols:"12",md:"6"},{default:l(()=>[h("fieldset",Dt,[It,s.value.Field?(c(),_(qe,{key:0,admin:!0,field:s.value.Field,"persistent-hint":!0,required:s.value.Required,convention:t.convention,modelValue:u.value,"onUpdate:modelValue":o[4]||(o[4]=v=>u.value=v)},null,8,["field","required","convention","modelValue"])):S("",!0)])]),_:1})):S("",!0)]),_:1}))}}),yt={class:"d-none d-sm-block"},_t=R({__name:"EditFormSectionFields",props:P({convention:{}},{modelValue:{required:!0}}),emits:["update:modelValue"],setup(U){const s=M(U,"modelValue"),a=()=>{var i;return{ID:0,SectionFieldUUID:q(),SectionID:s.value.ID,SectionUUID:s.value.SectionUUID,FieldID:0,FieldUUID:"",Order:(((i=s.value.Fields)==null?void 0:i.length)||0)+1,MinLength:0,MaxLength:0,Required:!1,Value:""}};return(i,d)=>s.value.Fields!==void 0?(c(),_(Ge,{key:0,modelValue:s.value.Fields,"onUpdate:modelValue":d[0]||(d[0]=u=>s.value.Fields=u),closeable:!1,title:"Fields","new-item":a,class:"mt-4",label:"name","label-parent":"Field","slot-name-prefix":"field"},Re({_:2},[K(s.value.Fields,(u,n)=>({name:`field_${n}_title`,fn:l(()=>[u.Field?(c(),E($,{key:0},[C(O(u.Field.Label)+" ("+O(u.Field.Name)+") ",1),h("template",yt,[C(" ["+O(u.Field.Type)+"] ",1)])],64)):(c(),E($,{key:1},[C("New Field")],64))])})),K(s.value.Fields,(u,n)=>({name:`field_${n}`,fn:l(()=>[e(gt,{modelValue:s.value.Fields[n],"onUpdate:modelValue":t=>s.value.Fields[n]=t,convention:i.convention,style:{margin:"0 -24px"}},null,8,["modelValue","onUpdate:modelValue","convention"])])}))]),1032,["modelValue"])):S("",!0)}}),Ct=R({__name:"EditFormSections",props:P({convention:{}},{modelValue:{required:!0}}),emits:["update:modelValue"],setup(U){const s=M(U,"modelValue"),a=()=>{const i={ID:0,SectionUUID:q(),FormID:s.value.ID,FormUUID:s.value.FormUUID,Order:0,Name:"New Section",Heading:"",Description:"",Fields:[],DefaultValue:"",State:{ID:0,SectionStateUUID:q(),SectionID:0,SectionUUID:"",Edit:!0}};return i.State.SectionID=i.ID,i.State.SectionUUID=i.SectionUUID,i};return(i,d)=>(c(),_(Ge,{modelValue:s.value.Sections,"onUpdate:modelValue":d[0]||(d[0]=u=>s.value.Sections=u),"new-item":a,closeable:!1,title:"Sections","slot-name-prefix":"section"},Re({_:2},[K(s.value.Sections,(u,n)=>({name:`section_${n}`,fn:l(()=>[e(A,null,{default:l(()=>[e(g,{cols:"12",sm:"6"},{default:l(()=>[e(F,{modelValue:u.Name,"onUpdate:modelValue":t=>u.Name=t,label:"Internal Name",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(g,{cols:"12",sm:"6"},{default:l(()=>[e(F,{modelValue:u.Heading,"onUpdate:modelValue":t=>u.Heading=t,label:"Section Heading",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024),e(A,null,{default:l(()=>[e(g,{cols:"12"},{default:l(()=>[e(Ie,{modelValue:u.Description,"onUpdate:modelValue":t=>u.Description=t,label:"Section Text",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024),u.Fields?(c(),_(_t,{key:0,modelValue:s.value.Sections[n],"onUpdate:modelValue":t=>s.value.Sections[n]=t,convention:i.convention},null,8,["modelValue","onUpdate:modelValue","convention"])):S("",!0)])}))]),1032,["modelValue"]))}}),bt=R({__name:"FormRendererPopup",props:P({admin:{type:Boolean},convention:{},form:{},title:{},cardClass:{},preview:{type:Boolean}},{modelValue:{type:Boolean,required:!0}}),emits:P(["update:form"],["update:modelValue"]),setup(U,{emit:s}){const a=U,{admin:i=!1,convention:d,title:u="",cardClass:n=""}=a,t=M(U,"modelValue"),o=De(a,s,void 0,void 0,"form"),v=y(B(o.value));H(o,()=>{v.value=B(o.value)});const m=()=>{t.value=!1};return(r,p)=>(c(),_(Oe,{modelValue:t.value,"onUpdate:modelValue":p[1]||(p[1]=V=>t.value=V),title:I(u),color:"primary","card-class":I(n)},{toolbarButtons:l(()=>[$e(r.$slots,"toolbarButtons")]),actions:l(()=>[e(N,{color:"blue-darken-1",variant:"text",onClick:m},{default:l(()=>[C(" Close ")]),_:1})]),default:l(()=>[e(Je,{modelValue:v.value,"onUpdate:modelValue":p[0]||(p[0]=V=>v.value=V),admin:I(i),convention:I(d),preview:r.preview},null,8,["modelValue","admin","convention","preview"])]),_:3},8,["modelValue","title","card-class"]))}}),kt=R({__name:"SelectGroups",props:P({convention:{},organisation:{},chips:{type:Boolean,default:!1},clearable:{type:Boolean,default:!1},hint:{default:""},label:{},variant:{}},{modelValue:{required:!0}}),emits:P(["change"],["update:modelValue"]),setup(U,{emit:s}){const a=M(U,"modelValue"),i=y([]),d=Y(),u=y([]),n=y([]),t=y(""),o=y(""),v=y(0),m=W(()=>[...u.value,...n.value].map(V=>({title:V.Name,value:i.value.find(f=>f.GroupUUID===V.GroupUUID)||V})));return typeof U.convention=="object"?(t.value=U.convention.ConventionUUID,o.value=U.convention.OrganisationUUID):t.value=U.convention||"",typeof U.organisation=="object"?o.value=U.organisation.OrganisationUUID:o.value.length===0&&(o.value=U.organisation||""),(async()=>{const p=[];t.value&&p.push(d.getConventionGroups(t.value)),o.value&&p.push(d.getOrganisationGroups(o.value));const V=await Promise.all(p);if(t.value&&o.value?(n.value=V[0].sort((f,T)=>f.Name.localeCompare(T.Name)),u.value=V[1].sort((f,T)=>f.Name.localeCompare(T.Name))):t.value&&V.length==1?n.value=V[0].sort((f,T)=>f.Name.localeCompare(T.Name)):o.value&&V.length==1&&(u.value=V[0].sort((f,T)=>f.Name.localeCompare(T.Name))),Array.isArray(a.value))v.value=2,m.value.forEach(f=>{Array.isArray(a.value)&&a.value.find(D=>D.GroupUUID===f.value.GroupUUID)&&i.value.push(f.value)});else if(typeof a.value=="string"){v.value=1;try{const f=JSON.parse(a.value);m.value.forEach(T=>{f.find(b=>b.GroupUUID===T.value.GroupUUID)&&i.value.push(T.value)})}catch{}}})(),H(i,()=>{switch(v.value){default:case 2:{a.value=i.value,s("change");break}case 1:{a.value=JSON.stringify(i.value),s("change");break}}}),(p,V)=>(c(),_(Se,{modelValue:i.value,"onUpdate:modelValue":V[0]||(V[0]=f=>i.value=f),chips:p.chips,multiple:"",label:p.label||"Tags",variant:p.variant||"solo",hint:p.hint,"persistent-hint":!0,clearable:p.clearable,items:m.value,"item-title":"title","item-value":"value"},null,8,["modelValue","chips","label","variant","hint","clearable","items"]))}}),Et=h("template",{class:"d-none d-sm-inline"},[C("Preview")],-1),ht=R({__name:"EditFormDialog",props:P({convention:{},form:{}},{modelValue:{type:Boolean,required:!0}}),emits:P(["update:form"],["update:modelValue"]),setup(U,{emit:s}){const a=U,{convention:i}=a,d=M(U,"modelValue"),u=Y(),n=De(a,s,void 0,void 0,"form"),t=y(!1),o=y(B(n.value));H(n,()=>{o.value=B(n.value)});const v=()=>{u.saveForm(o.value).then(r=>{r&&(n.value=r,d.value=!1)})},m=()=>{t.value=!0};return(r,p)=>(c(),_(Vt,{modelValue:d.value,"onUpdate:modelValue":p[12]||(p[12]=V=>d.value=V),item:o.value,"onUpdate:item":p[13]||(p[13]=V=>o.value=V),onSave:v,"card-class":"pa-0"},{toolbarButtons:l(()=>[e(He,null,{default:l(()=>[e(N,{"prepend-icon":"mdi:mdi-developer-board",onClick:m},{default:l(()=>[Et]),_:1})]),_:1})]),default:l(()=>[e(fe,null,{default:l(()=>[e(Ve,{class:"mt-0"},{default:l(()=>[e(Ue,null,{default:l(()=>[C("General Settings")]),_:1}),e(Te,null,{default:l(()=>[e(A,null,{default:l(()=>[e(g,{cols:"12"},{default:l(()=>[e(j,{class:"pa-0",fluid:!0},{default:l(()=>[e(A,null,{default:l(()=>[e(g,{cols:"12",sm:"6"},{default:l(()=>[e(F,{modelValue:o.value.Name,"onUpdate:modelValue":p[0]||(p[0]=V=>o.value.Name=V),label:"Internal name",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),e(g,{cols:"12",sm:"6"},{default:l(()=>[e(F,{modelValue:o.value.Heading,"onUpdate:modelValue":p[1]||(p[1]=V=>o.value.Heading=V),label:"Form Heading",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),e(g,{cols:"12"},{default:l(()=>[e(Ie,{modelValue:o.value.Description,"onUpdate:modelValue":p[2]||(p[2]=V=>o.value.Description=V),label:"Pre-form Text",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),e(g,{cols:"12",sm:"6"},{default:l(()=>[e(se,{modelValue:o.value.Type,"onUpdate:modelValue":p[3]||(p[3]=V=>o.value.Type=V),label:"Type",variant:"outlined",items:I(ll),"hide-details":""},null,8,["modelValue","items"])]),_:1}),e(g,{cols:"12",sm:"6"},{default:l(()=>[e(F,{modelValue:o.value.State.Stage,"onUpdate:modelValue":p[4]||(p[4]=V=>o.value.State.Stage=V),modelModifiers:{number:!0},label:"Stage",variant:"outlined","hide-details":"",type:"number"},null,8,["modelValue"])]),_:1}),e(g,{cols:"6"},{default:l(()=>[e(Z,{modelValue:o.value.State.New,"onUpdate:modelValue":p[5]||(p[5]=V=>o.value.State.New=V),label:"Allow New Entries"},null,8,["modelValue"])]),_:1}),e(g,{cols:"6"},{default:l(()=>[e(Z,{modelValue:o.value.State.Edit,"onUpdate:modelValue":p[6]||(p[6]=V=>o.value.State.Edit=V),label:"Allow Editing Submissions"},null,8,["modelValue"])]),_:1})]),_:1}),e(A,null,{default:l(()=>[e(g,{cols:"12"},{default:l(()=>[e(ne,{label:"Required Tags",variant:"outlined",modelValue:o.value.RequiredTags,"onUpdate:modelValue":p[7]||(p[7]=V=>o.value.RequiredTags=V),convention:I(i),organisation:I(i).OrganisationUUID,chips:"",clearable:"",hint:"Tags that a user must have to see this form. (Any one)"},null,8,["modelValue","convention","organisation"])]),_:1})]),_:1}),e(A,null,{default:l(()=>[e(g,{cols:"12"},{default:l(()=>[e(kt,{label:"Required Groups",variant:"outlined",modelValue:o.value.RequiredGroupMemberships,"onUpdate:modelValue":p[8]||(p[8]=V=>o.value.RequiredGroupMemberships=V),convention:I(i),organisation:I(i).OrganisationUUID,chips:"",clearable:"",hint:"Groups that a user must be in to see this form. (Any one)"},null,8,["modelValue","convention","organisation"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),o.value?(c(),_(Ct,{key:0,modelValue:o.value,"onUpdate:modelValue":p[9]||(p[9]=V=>o.value=V),convention:I(i),style:{"border-radius":"0"}},null,8,["modelValue","convention"])):S("",!0),t.value?(c(),_(bt,{key:1,modelValue:t.value,"onUpdate:modelValue":p[10]||(p[10]=V=>t.value=V),form:o.value,"onUpdate:form":p[11]||(p[11]=V=>o.value=V),admin:!0,convention:I(i),title:"Form Preview",preview:!0,"card-class":"pa-0"},null,8,["modelValue","form","convention"])):S("",!0)]),_:1},8,["modelValue","item"]))}}),$t=(U,s)=>{const a=y(!1),i=y(!1),d=y(U),u=y(-1),n=y(s),t=y(s),o=W(()=>u.value===-1?"New Form":"Edit Form"),v=()=>{d.value=U},m=D=>{u.value=d.value.indexOf(D),n.value=Object.assign({},D),a.value=!0},r=D=>{u.value=d.value.indexOf(D),n.value=Object.assign({},D),i.value=!0},p=()=>{i.value=!1,_e(()=>{n.value=Object.assign({},t.value),u.value=-1}).then()},V=()=>{d.value.splice(u.value,1),p()},f=()=>{a.value=!1,_e(()=>{n.value=Object.assign({},t.value),u.value=-1}).then()},T=()=>{u.value>-1?Object.assign(d.value[u.value],n.value):d.value.push(n.value),f()};return H(a,D=>{D||f()}),H(i,D=>{D||p()}),{collection:d,defaultItem:t,dialog:a,dialogDelete:i,editedItem:n,formTitle:o,reset:v,editItem:m,deleteItem:r,deleteItemConfirm:V,close:f,save:T}},Nt=R({__name:"FormEditor",props:{modelValue:{required:!0}},emits:P(["refresh"],["update:modelValue"]),setup(U){const s=M(U,"modelValue"),a=Y(),i=y([{key:"Name",title:"Form Name",align:"start",sortable:!0},{key:"Type",title:"Type",align:"start",sortable:!0},{key:"actions",title:"Actions",sortable:!1}]),d=y([]),u=y([]);a.getConventionFields(s.value.ConventionUUID).then(k=>{d.value=k}),a.getConventionForms(s.value.ConventionUUID).then(k=>{u.value=k});const n={ID:0,FormUUID:q(),ConventionID:s.value.ID,ConventionUUID:s.value.ConventionUUID,ParentID:0,ParentUUID:me,Name:"",Heading:"",Description:"",Type:tl.FORM_TYPE_UNSPECIFIED,Sections:[],State:{ID:0,FormStateUUID:q(),FormID:0,FormUUID:me,New:!1,Edit:!1,Stage:0},RequiredGroupMemberships:[],RequiredTags:[]};n.State.FormUUID=n.FormUUID;const{collection:t,defaultItem:o,dialog:v,dialogDelete:m,editedItem:r,formTitle:p,editItem:V,deleteItem:f,deleteItemConfirm:T,save:D}=$t(u,n);t.value.forEach(k=>{k.Sections.forEach(w=>{var G;(G=w.Fields)==null||G.forEach(J=>{J.Field=d.value.find(Ee=>Ee.ID===J.FieldID)})})});const b=k=>{a.deleteForm(k.FormUUID).then(w=>{w&&f(k)})};return(k,w)=>(c(),_(I(Ke),{headers:i.value,items:I(t),"sort-by":[{key:"calories",order:"asc"}],class:"elevation-1"},{top:l(()=>[e(oe,{color:"primary"},{default:l(()=>[e(ue,null,{default:l(()=>[C("Form Editor")]),_:1}),e(Pe,{class:"mx-4",inset:!0,vertical:!0}),e(ee),e(N,{dark:"",class:"mb-2","prepend-icon":"mdi:mdi-pencil",onClick:w[0]||(w[0]=G=>{r.value=Object.assign({},I(o)),v.value=!0})},{default:l(()=>[C(" New Item ")]),_:1}),e(Ye,{modelValue:I(m),"onUpdate:modelValue":w[1]||(w[1]=G=>ye(m)?m.value=G:null),onDelete:I(T)},null,8,["modelValue","onDelete"])]),_:1}),I(v)?(c(),_(ht,{key:0,modelValue:I(v),"onUpdate:modelValue":w[2]||(w[2]=G=>ye(v)?v.value=G:null),form:I(r),"onUpdate:form":[w[3]||(w[3]=G=>ye(r)?r.value=G:null),I(D)],convention:s.value},null,8,["modelValue","form","onUpdate:form","convention"])):S("",!0)]),"item.actions":l(({item:G})=>[e(z,{size:"small",class:"me-2",onClick:J=>I(V)(G.raw)},{default:l(()=>[C(" mdi:mdi-pencil ")]),_:2},1032,["onClick"]),e(z,{size:"small",onClick:J=>b(G.raw)},{default:l(()=>[C(" mdi:mdi-delete ")]),_:2},1032,["onClick"])]),_:1},8,["headers","items"]))}}),na=R({__name:"ConventionEditorView",emits:["pageTitle","refresh"],setup(U,{emit:s}){const a=Be(),i=Y(),u=y({ID:0,ConventionUUID:me,Accommodation:[],Description:"",DetailLink:"",Extras:[],Interests:[],Logo:"",Name:"",OrganisationID:0,OrganisationUUID:"",Slug:"",Tickets:[],Visible:!1}),n=y();H(n,()=>{o.value.find(m=>m.id===n.value&&m.title==="General")&&t()});const t=()=>{i.getConvention(a.params.convention.toString()).then(v=>{v?(u.value=v,s("pageTitle",`Convention Editor - ${u.value.Name}`)):s("pageTitle","Convention Editor - New Convention")})},o=y([{id:q(),title:"Accommodation",component:ie(et),model:u},{id:q(),title:"Additional Purchases",component:ie(rl),model:u},{id:q(),title:"Fields",component:ie(pt),model:u},{id:q(),title:"Forms",component:ie(Nt),model:u},{id:q(),title:"Interests",component:ie(fl),model:u},{id:q(),title:"Tickets",component:ie(Nl),model:u},{id:q(),title:"Venues",component:ie(Kl),model:u}]);return s("pageTitle","Convention Editor"),t(),(v,m)=>u.value&&u.value.ConventionUUID!==I(me)?(c(),E($,{key:0},[e(oe,{color:"blue-darken-4"},{default:l(()=>[e(Xe,{modelValue:n.value,"onUpdate:modelValue":m[0]||(m[0]=r=>n.value=r),"show-arrows":""},{default:l(()=>[(c(!0),E($,null,K(o.value,r=>(c(),_(We,{key:r.id,value:r.id},{default:l(()=>[C(O(r.title),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(Ze,{modelValue:n.value,"onUpdate:modelValue":m[1]||(m[1]=r=>n.value=r)},{default:l(()=>[(c(!0),E($,null,K(o.value,r=>(c(),_(Qe,{key:r.id,value:r.id},{default:l(()=>[r.id===n.value?(c(),_(de,{key:0,class:"pa-2"},{default:l(()=>[(c(),_(je(r.component),{modelValue:r.model,"onUpdate:modelValue":p=>r.model=p},null,8,["modelValue","onUpdate:modelValue"]))]),_:2},1024)):S("",!0)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])],64)):S("",!0)}});export{na as default};
