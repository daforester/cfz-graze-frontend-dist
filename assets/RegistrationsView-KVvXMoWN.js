import{p as tl,d as al,c as ue,t as qe,a0 as ll,a1 as ol,f as t,F as h,m as ft,i as j,M as J,N as te,r as E,k as Ee,w as fe,n,q as D,v as l,y,D as w,x as R,B as _,Q as W,C as p,A as N,P as Ae,G as Gt,H as xt,_ as dt,a2 as nl,a3 as Qe,O as Je,a4 as il,X as Ut,o as sl,b as ul,a5 as rl,a6 as dl,a7 as aa,z as Lt,a8 as ml,a9 as la,Z as ut,V as cl,U as vl,E as fl}from"./index-ZOTpC5bv.js";import{T as Ul,V as Ta,e as Al,c as _a,d as Tl}from"./FormRenderer.vue_vue_type_style_index_0_lang-IuBBj_df.js";import{F as _e,a as _l}from"./form-0fJbSFPv.js";import{u as mt,V as wt}from"./VCheckbox-280V2LU_.js";import{_ as Fe}from"./ModelDialog.vue_vue_type_script_setup_true_lang-Lbmmtwd5.js";import{h as Oe,b as At,a as El,c as gl,d as oa,P as Ft,u as Ea}from"./useDisplayTransactions-fdqHcCUo.js";import{u as pl,a as me,V as Me}from"./VContainer-EfENUwVj.js";import{V as Q,a as M}from"./VRow-K4u8q0kp.js";import{V as we,a as be,c as Tt,d as Sl}from"./VList-MabKhUTY.js";import{V as ve}from"./copyToClipboard-uuLEeMwr.js";import{G as Xe}from"./userData-YpwemgsG.js";import{C as Ht}from"./canEditRegistrations-A1ez9bSf.js";import{V as q,a as ga}from"./VBtn-_jEsfbA4.js";import{b as pa,c as qt,S as Sa,d as na}from"./submission-40fey8Hx.js";import{G as Et}from"./group-7fhbY6WJ.js";import{C as gt}from"./canDo-yWCfI_4r.js";import{a as pt,V as Pe}from"./scopeId-yUTvcPCv.js";import{b as Dl,_ as rt,V as Da}from"./SaveButton.vue_vue_type_script_setup_true_lang-8GmtN8jb.js";import{V as ot,a as We,c as Ze,d as Kt,e as $e}from"./VCard-nJpFRVbn.js";import{V as jt}from"./VAvatar--skPFYKy.js";import{V as oe}from"./VTextField-66fuY14f.js";import{v as ye}from"./v4-yQnnJER4.js";import{m as yl,k as Il,l as Cl,n as Rl,o as Vl,p as Ol,q as Ml,u as hl,r as kl,s as Nl,t as bl,v as Ll,w as wl,x as Fl,y as Pl,z as ia,A as sa,B as ua,c as St,d as Dt,e as zt,b as yt,V as It,a as ya,h as Ia,i as Ca,_ as Ra,j as ze,g as Va,f as Pt,C as $l}from"./VWindowItem-LQ4eCt2N.js";import{_ as Oa}from"./DeleteDialog.vue_vue_type_script_setup_true_lang-QlnY9G4g.js";import{a as Ma,V as $t}from"./VToolbar-XwWQKE41.js";import{V as Bl}from"./VDivider-uCyXKAaN.js";import{V as ha}from"./VTextarea-_6avGkXH.js";import{V as _t}from"./VDialog-GfkDVOV4.js";import{V as ka,a as Bt}from"./VChip-gyuR0BrM.js";import{V as Yl}from"./VForm-lLkAfh6b.js";import{V as Gl,b as xl}from"./VNavigationDrawer-T4SXDVJi.js";import{s as Hl}from"./sortSubmissions-NKScr9xj.js";import{V as ql,a as Kl}from"./VAlert-Oz9gjg2d.js";import{S as jl}from"./setupLogin-J8xLxvla.js";import{V as zl}from"./forwardRefs-4ioGoaqw.js";import{u as Nt}from"./nil-rxyd0N8M.js";import{V as ra,a as Ql}from"./VTable-2ti3cAWF.js";import"./index-OKsbKlsK.js";import"./VFileInput-Ibb2Cm-6.js";import"./createSimpleFunctional-4CdSQfhB.js";import"./VToolbarItems-R-txMg8Q.js";var Ne=(e=>(e.ADMIN_LAYOUT_PANELS="ADMIN_LAYOUT_PANELS",e.ADMIN_LAYOUT_TABLE="ADMIN_LAYOUT_TABLE",e))(Ne||{});const Jl=[{title:"Panel Layout",value:"ADMIN_LAYOUT_PANELS"},{title:"Table Layout",value:"ADMIN_LAYOUT_TABLE"}];var Le=(e=>(e.LAYOUT_ITEM_SOURCE_FORM="LAYOUT_ITEM_SOURCE_FORM",e.LAYOUT_ITEM_SOURCE_META="LAYOUT_ITEM_SOURCE_META",e.LAYOUT_ITEM_SOURCE_USER="LAYOUT_ITEM_SOURCE_USER",e))(Le||{});const Xl=[{title:"Form Field Submission Data",value:"LAYOUT_ITEM_SOURCE_FORM"},{title:"Miscellaneous Data",value:"LAYOUT_ITEM_SOURCE_META"},{title:"User Profile Data",value:"LAYOUT_ITEM_SOURCE_USER"}];var G=(e=>(e.META_DATA_SOURCE_NULL="",e.META_DATA_SOURCE_ACCOMMODATION_ALLOCATION="META_DATA_SOURCE_ACCOMMODATION_ALLOCATION",e.META_DATA_SOURCE_ACCOMMODATION_FORM="META_DATA_SOURCE_ACCOMMODATION_FORM",e.META_DATA_SOURCE_ADMIN_FORM="META_DATA_SOURCE_ADMIN_FORM",e.META_DATA_SOURCE_BADGE_DISPLAY="META_DATA_SOURCE_BADGE_DISPLAY",e.META_DATA_SOURCE_BADGE_FORM="META_DATA_SOURCE_BADGE_FORM",e.META_DATA_SOURCE_CHECKIN_CONTROL="META_DATA_SOURCE_CHECKIN_CONTROL",e.META_DATA_SOURCE_CHECKIN_STATUS="META_DATA_SOURCE_CHECKIN_STATUS",e.META_DATA_SOURCE_DATA_LAYOUT="META_DATA_SOURCE_DATA_LAYOUT",e.META_DATA_SOURCE_DEALER_FORM="META_DATA_SOURCE_DEALER_FORM",e.META_DATA_SOURCE_EMAILS="META_DATA_SOURCE_EMAILS",e.META_DATA_SOURCE_NOTES="META_DATA_SOURCE_NOTES",e.META_DATA_SOURCE_PAYMENT_STATUS="META_DATA_SOURCE_PAYMENT_STATUS",e.META_DATA_SOURCE_PAYMENTS="META_DATA_SOURCE_PAYMENTS",e.META_DATA_SOURCE_REGISTRATION_ACTIONS="META_DATA_SOURCE_REGISTRATION_ACTIONS",e.META_DATA_SOURCE_REGISTRATION_FORM="META_DATA_SOURCE_REGISTRATION_FORM",e.META_DATA_SOURCE_REGISTRATION_GROUP="META_DATA_SOURCE_REGISTRATION_GROUP",e.META_DATA_SOURCE_REGISTRATION_REFERENCE="META_DATA_SOURCE_REGISTRATION_REFERENCE",e.META_DATA_SOURCE_SUBMISSION_DATE="META_DATA_SOURCE_SUBMISSION_DATE",e.META_DATA_SOURCE_SUBMISSION_STATUS="META_DATA_SOURCE_SUBMISSION_STATUS",e.META_DATA_SOURCE_TAGS="META_DATA_SOURCE_TAGS",e))(G||{});const Wl=[{title:"Accommodation Allocation",value:"META_DATA_SOURCE_ACCOMMODATION_ALLOCATION"},{title:"Accommodation Form",value:"META_DATA_SOURCE_ACCOMMODATION_FORM"},{title:"Actions",value:"META_DATA_SOURCE_REGISTRATION_ACTIONS"},{title:"Badge Display",value:"META_DATA_SOURCE_BADGE_DISPLAY"},{title:"Badge Form",value:"META_DATA_SOURCE_BADGE_FORM"},{title:"Check In Control",value:"META_DATA_SOURCE_CHECKIN_CONTROL"},{title:"Check In Status",value:"META_DATA_SOURCE_CHECKIN_STATUS"},{title:"Data Display",value:"META_DATA_SOURCE_DATA_LAYOUT"},{title:"Dealer Form",value:"META_DATA_SOURCE_DEALER_FORM"},{title:"Emails",value:"META_DATA_SOURCE_EMAILS"},{title:"Notes",value:"META_DATA_SOURCE_NOTES"},{title:"Payment Status",value:"META_DATA_SOURCE_PAYMENT_STATUS"},{title:"Payments",value:"META_DATA_SOURCE_PAYMENTS"},{title:"Registration Group",value:"META_DATA_SOURCE_REGISTRATION_GROUP"},{title:"Registration Reference",value:"META_DATA_SOURCE_REGISTRATION_REFERENCE"},{title:"Registration Form",value:"META_DATA_SOURCE_REGISTRATION_FORM"},{title:"Submission Date",value:"META_DATA_SOURCE_SUBMISSION_DATE"},{title:"Submission Status",value:"META_DATA_SOURCE_SUBMISSION_STATUS"},{title:"Tags",value:"META_DATA_SOURCE_TAGS"}];var De=(e=>(e.PANEL_STYLE_FLEX="PANEL_STYLE_FLEX",e.PANEL_STYLE_NAV_BOTTOM="PANEL_STYLE_NAV_BOTTOM",e.PANEL_STYLE_NAV_LEFT="PANEL_STYLE_NAV_LEFT",e.PANEL_STYLE_NAV_RIGHT="PANEL_STYLE_NAV_RIGHT",e.PANEL_STYLE_NAV_TOP="PANEL_STYLE_NAV_TOP",e))(De||{});const Zl=[{title:"Body Flexible",value:"PANEL_STYLE_FLEX"},{title:"Fixed Bottom",value:"PANEL_STYLE_NAV_BOTTOM"},{title:"Fixed Left",value:"PANEL_STYLE_NAV_LEFT"},{title:"Fixed Right",value:"PANEL_STYLE_NAV_RIGHT"},{title:"Fixed Top",value:"PANEL_STYLE_NAV_TOP"}];var ie=(e=>(e.USER_DATA_SOURCE_NULL="",e.USER_DATA_SOURCE_DISPLAY_NAME="USER_DATA_SOURCE_DISPLAY_NAME",e.USER_DATA_SOURCE_HANDLE="USER_DATA_SOURCE_HANDLE",e.USER_DATA_SOURCE_AVATAR="USER_DATA_SOURCE_AVATAR",e.USER_DATA_SOURCE_FIRST_NAME="USER_DATA_SOURCE_FIRST_NAME",e.USER_DATA_SOURCE_LAST_NAME="USER_DATA_SOURCE_LAST_NAME",e.USER_DATA_SOURCE_DATE_OF_BIRTH="USER_DATA_SOURCE_DATE_OF_BIRTH",e.USER_DATA_SOURCE_EMAIL="USER_DATA_SOURCE_EMAIL",e.USER_DATA_SOURCE_TELEGRAM="USER_DATA_SOURCE_TELEGRAM",e))(ie||{});const eo=[{title:"Display Name",value:"USER_DATA_SOURCE_DISPLAY_NAME"},{title:"Handle",value:"USER_DATA_SOURCE_HANDLE"},{title:"Avatar",value:"USER_DATA_SOURCE_AVATAR"},{title:"First Name",value:"USER_DATA_SOURCE_FIRST_NAME"},{title:"Last Name",value:"USER_DATA_SOURCE_LAST_NAME"},{title:"Date of Birth",value:"USER_DATA_SOURCE_DATE_OF_BIRTH"},{title:"Email Address",value:"USER_DATA_SOURCE_EMAIL"},{title:"Telegram Username",value:"USER_DATA_SOURCE_TELEGRAM"}],to=e=>{switch(e){case"EMAIL_STATUS_QUEUED":return"Queued";case"EMAIL_STATUS_QUEUE_ERROR":return"Processing";case"EMAIL_STATUS_QUEUE_FAILURE":return"Internal Error";case"EMAIL_STATUS_SENDING":return"Sending";case"EMAIL_STATUS_SENT":return"Sent";case"EMAIL_STATUS_SEND_ERROR":return"Failed to Send"}return"Unknown"},ao=e=>e===void 0?!1:gt(e,Et.GROUP_TYPE_SYSTEM).ManageUsers,lo=tl({itemsLength:{type:[Number,String],required:!0},...yl(),...Il(),...Cl()},"VDataTableServer"),oo=al()({name:"VDataTableServer",props:lo(),emits:{"update:modelValue":e=>!0,"update:page":e=>!0,"update:itemsPerPage":e=>!0,"update:sortBy":e=>!0,"update:options":e=>!0,"update:expanded":e=>!0,"update:groupBy":e=>!0},setup(e,c){let{attrs:o,slots:i}=c;const{groupBy:r}=Rl(e),{sortBy:f,multiSort:A,mustSort:u}=Vl(e),{page:a,itemsPerPage:s}=Ol(e),d=ue(()=>parseInt(e.itemsLength,10)),{columns:U,headers:v}=Ml(e,{groupBy:r,showSelect:qe(e,"showSelect"),showExpand:qe(e,"showExpand")}),{items:m}=hl(e,U),{toggleSort:g}=kl({sortBy:f,multiSort:A,mustSort:u,page:a}),{opened:S,isGroupOpen:O,toggleGroup:I,extractRows:k}=Nl({groupBy:r,sortBy:f}),{pageCount:T,setItemsPerPage:B}=bl({page:a,itemsPerPage:s,itemsLength:d}),{flatItems:se}=Ll(m,r,S),{isSelected:z,select:x,selectAll:le,toggleSelect:Y,someSelected:$,allSelected:F}=wl(e,{allItems:m,currentPage:m}),{isExpanded:b,toggleExpand:Z}=Fl(e),ce=ue(()=>k(m.value));Pl({page:a,itemsPerPage:s,sortBy:f,groupBy:r,search:qe(e,"search")}),ll("v-data-table",{toggleSort:g,sortBy:f}),ol({VDataTableRows:{hideNoData:qe(e,"hideNoData"),noDataText:qe(e,"noDataText"),loading:qe(e,"loading"),loadingText:qe(e,"loadingText")}});const ne=ue(()=>({page:a.value,itemsPerPage:s.value,sortBy:f.value,pageCount:T.value,toggleSort:g,setItemsPerPage:B,someSelected:$.value,allSelected:F.value,isSelected:z,select:x,selectAll:le,toggleSelect:Y,isExpanded:b,toggleExpand:Z,isGroupOpen:O,toggleGroup:I,items:ce.value.map(pe=>pe.raw),internalItems:ce.value,groupedItems:se.value,columns:U.value,headers:v.value}));pl(()=>{const pe=ia.filterProps(e),et=sa.filterProps(e),tt=ua.filterProps(e),nt=ra.filterProps(e);return t(ra,ft({class:["v-data-table",{"v-data-table--loading":e.loading},e.class],style:e.style},nt),{top:()=>{var Ce;return(Ce=i.top)==null?void 0:Ce.call(i,ne.value)},default:()=>{var Ce,Be,Ye,Ge,xe,Se;return i.default?i.default(ne.value):t(h,null,[(Ce=i.colgroup)==null?void 0:Ce.call(i,ne.value),t("thead",{class:"v-data-table__thead",role:"rowgroup"},[t(sa,ft(et,{sticky:e.fixedHeader}),i)]),(Be=i.thead)==null?void 0:Be.call(i,ne.value),t("tbody",{class:"v-data-table__tbody",role:"rowgroup"},[(Ye=i["body.prepend"])==null?void 0:Ye.call(i,ne.value),i.body?i.body(ne.value):t(ua,ft(o,tt,{items:se.value}),i),(Ge=i["body.append"])==null?void 0:Ge.call(i,ne.value)]),(xe=i.tbody)==null?void 0:xe.call(i,ne.value),(Se=i.tfoot)==null?void 0:Se.call(i,ne.value)])},bottom:()=>i.bottom?i.bottom(ne.value):t(ia,pe,{prepend:i["footer.prepend"]})})})}}),no=w("br",null,null,-1),io=w("h3",null,"Assigned Accommodation",-1),so=w("br",null,null,-1),uo=w("br",null,null,-1),ro=w("h3",null,"Accommodation Preferences",-1),mo=w("h3",null,"Selected Tickets",-1),co=w("br",null,null,-1),vo=j({__name:"EditAccommodationAssignmentDialog",props:J({convention:{},registration:{},selectedAccommodation:{},title:{}},{modelValue:{type:Boolean,required:!0},modelModifiers:{}}),emits:J(["update:field"],["update:modelValue"]),setup(e,{emit:c}){const o=e,{convention:i,registration:r,title:f=""}=o,A=c,u=Ae(),a=te(e,"modelValue"),s=E({capacity:{max:Y=>{var b;const $=B.value.find(Z=>Z.room.RoomUUID===Y);return!$||$.room.MaximumCapacity===0?!0:(((b=m.value)==null?void 0:b.Members.length)||0)<=$.room.MaximumCapacity||"Too many people in the group for this room"},min:Y=>{var b;const $=B.value.find(Z=>Z.room.RoomUUID===Y);return!$||$.room.MinimumCapacity===0?!0:(((b=m.value)==null?void 0:b.Members.length)||0)>=$.room.MinimumCapacity||"Not enough people in the group for this room"}}}),d=E([]),U=mt(o,A,void 0,void 0,"field"),v=E(Ee(U.value));fe(U,()=>{v.value=Ee(U.value)});const m=E(),g=E(""),S=E(""),O=E([]),I=E({Ticket:[],AddonsChecked:[],ComponentsChecked:[]}),k=async()=>{var b;const Y=await u.getConventionAvailableAccommodation(i.ConventionUUID);Y&&(d.value=Y);const $=await u.getRegistrationGroup(r.RegistrationUUID||"");$&&(m.value=$);const F=await u.getConventionTickets(i.ConventionUUID);F&&(O.value=F);try{I.value=JSON.parse(((b=m.value)==null?void 0:b.TicketData)||"")}catch{}};fe(g,()=>{S.value=B.value.length>0?B.value[0].value:""});const T=ue(()=>{const Y=se.value;return d.value.map($=>{let F;return Y.forEach(b=>{$.Costs.forEach(Z=>{Z.DateStart===(b==null?void 0:b.DateStart)&&Z.DateEnd===b.DateEnd&&(F===void 0||F>Z.Availability)&&(F=Z.Availability)})}),{label:`${$.Name}`,title:`${$.Name} (${F} Available)`,value:$.AccommodationUUID}})}),B=ue(()=>{const Y=se.value,$=d.value.find(F=>F.AccommodationUUID===g.value);return($==null?void 0:$.Pool.map(F=>{var Z,ce;let b;return Y.forEach(ne=>{F.Costs.forEach(pe=>{pe.DateStart===(ne==null?void 0:ne.DateStart)&&pe.DateEnd===ne.DateEnd&&(b===void 0||b>pe.Availability)&&(b=pe.Availability)})}),{label:`${(Z=F.Venue)==null?void 0:Z.Name} - ${F.Name}`,title:`${(ce=F.Venue)==null?void 0:ce.Name} - ${F.Name} (${b} Available)`,value:F.RoomUUID,room:F}}))||[]}),se=ue(()=>[...I.value.Ticket,...I.value.AddonsChecked,...I.value.ComponentsChecked].map(Y=>O.value.find($=>$.TicketUUID===Y)).filter(Y=>Y!==void 0&&Y.RequiresAccommodation)),z=Y=>{var $;u.assignAccommodation((($=m.value)==null?void 0:$.Registration.RegistrationUUID)||"",g.value,S.value,!1).then(F=>{F?(k(),Y&&Y("Room Assigned")):Y&&Y("Room not assigned")}).catch(()=>{Y&&Y("Room not assigned")})},x=Y=>{var $,F;($=m.value)!=null&&$.Registration.AllocationUUID?u.deleteAllocation(((F=m.value)==null?void 0:F.Registration.AllocationUUID)||"").then(b=>{b?(k(),Y&&Y("Allocation Deleted")):Y&&Y("Allocation not deleted")}).catch(()=>{Y&&Y("Allocation not deleted")}):Y&&Y("Nothing to Delete")},le=Y=>{var F,b;const $=(F=d.value.find(Z=>Z.AccommodationUUID===Y.AccommodationUUID))==null?void 0:F.Pool;if($){const Z=$.find(ce=>ce.RoomUUID===Y.RoomUUID);if(Z)return`${(b=Z.Venue)==null?void 0:b.Name} - ${Z.Name}`}return""};return k(),(Y,$)=>{var F;return n(),D(Fe,{modelValue:a.value,"onUpdate:modelValue":$[2]||($[2]=b=>a.value=b),title:p(f),color:"primary","show-close-action":!0,"show-delete-action":!!((F=m.value)!=null&&F.Registration.Allocation),"show-save-action":!!S.value,"save-button-label":"Assign Room",onDelete:x,onSave:z,fullscreen:!0,persistent:!0},{default:l(()=>[t(me,{class:"pa-0",fluid:!0},{default:l(()=>[t(Q,null,{default:l(()=>{var b;return[t(M,{cols:"12",md:"6"},{default:l(()=>{var Z,ce;return[w("h3",null,"Group Members ("+y((Z=m.value)==null?void 0:Z.Members.length)+")",1),(n(!0),_(h,null,W((ce=m.value)==null?void 0:ce.Members,ne=>(n(),_(h,{key:ne.UUID},[R(" #"+y(ne.Reference)+" "+y(ne.Name),1),no],64))),128))]}),_:1}),(b=m.value)!=null&&b.Registration.Allocation?(n(),D(M,{key:0,cols:"12",md:"6"},{default:l(()=>[io,t(we,null,{default:l(()=>{var Z;return[(n(!0),_(h,null,W((Z=m.value)==null?void 0:Z.Registration.Allocation.Periods,ce=>(n(),D(be,{key:ce.AllocationPeriodUUID},{default:l(()=>{var ne;return[R(y((ne=d.value.find(pe=>pe.AccommodationUUID===ce.AccommodationUUID))==null?void 0:ne.Name)+" ",1),so,R(" "+y(le(ce))+" ",1),uo,w("small",null,"("+y(p(Oe)(ce.DateStart))+" - "+y(p(Oe)(ce.DateEnd))+")",1)]}),_:2},1024))),128))]}),_:1})]),_:1})):N("",!0)]}),_:1}),t(Q,null,{default:l(()=>[t(M,{cols:"12",md:"6"},{default:l(()=>[Y.selectedAccommodation.length?(n(),_(h,{key:0},[ro,t(we,null,{default:l(()=>[(n(!0),_(h,null,W(Y.selectedAccommodation,(b,Z)=>(n(),D(be,{key:b.AccommodationUUID},{default:l(()=>[R(y(Z+1)+". "+y(b.Name),1)]),_:2},1024))),128))]),_:1})],64)):N("",!0)]),_:1}),t(M,{cosl:"12",md:"6"},{default:l(()=>[mo,t(we,null,{default:l(()=>[(n(!0),_(h,null,W(se.value,b=>(n(),D(be,{key:b==null?void 0:b.TicketUUID},{default:l(()=>[R(y(b.Name)+" ",1),co,w("small",null,"("+y(p(Oe)(b.DateStart))+" - "+y(p(Oe)(b.DateEnd))+")",1)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1}),t(Q,null,{default:l(()=>[t(M,{cols:"12",md:"6"},{default:l(()=>[t(ve,{modelValue:g.value,"onUpdate:modelValue":$[0]||($[0]=b=>g.value=b),items:T.value,"item-title":"title","item-value":"value",label:"Accommodation"},null,8,["modelValue","items"])]),_:1}),t(M,{cols:"12",md:"6"},{default:l(()=>[t(ve,{modelValue:S.value,"onUpdate:modelValue":$[1]||($[1]=b=>S.value=b),items:B.value,"item-title":"title","item-value":"value",label:"Room Pool",rules:[s.value.capacity.min,s.value.capacity.max]},null,8,["modelValue","items","rules"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue","title","show-delete-action","show-save-action"])}}}),fo=e=>(Gt("data-v-33548a38"),e=e(),xt(),e),Uo={key:0,class:"accommodationList"},Ao={key:0,class:"text-orange-darken-2"},To={key:1,class:"accommodationList"},_o=fo(()=>w("br",null,null,-1)),Eo=j({__name:"DataTableItemAccommodation",props:{accommodations:{default:()=>[]},convention:{},forms:{},registration:{},tickets:{default:()=>[]},value:{default:""},venues:{}},setup(e){const c=Xe(),o=Ht(c,e.convention),i=E(!1),r=ue(()=>e.registration.Allocation.Periods.map(u=>{var a;return{DateStart:u.DateStart,DateEnd:u.DateEnd,Accommodation:u.Accommodation||((a=e.accommodations)==null?void 0:a.find(s=>s.AccommodationUUID==u.AccommodationUUID))}}).sort((u,a)=>u.DateStart>a.DateStart?1:u.DateStart==a.DateStart?0:-1));e.registration&&e.registration.Allocation&&e.registration.Allocation.Periods&&e.registration.Allocation.Periods.forEach(u=>{var s;if(u.Accommodation)return;const a=(s=e.accommodations)==null?void 0:s.find(d=>d.AccommodationUUID==u.AccommodationUUID);a&&(u.Accommodation=a)});const f=ue(()=>{if(!e.value)return[];const u=JSON.parse(e.value),a=e.accommodations.filter(s=>u.includes(s.AccommodationUUID)).sort((s,d)=>{const U=u.findIndex(m=>m===s.AccommodationUUID),v=u.findIndex(m=>m===d.AccommodationUUID);return U>v?1:-1});return Ee(a)}),A=ue(()=>{let u;const a=e.forms.find(s=>!!s.Sections.find(d=>{var U;return d.Fields?!!((U=d.Fields)!=null&&U.find(v=>{var m;return((m=v.Field)==null?void 0:m.Type)==="TICKET"?(u=v,!0):!1})):!1}));return u?!!e.registration.Submissions.find(s=>{if(s.FormUUID==(a==null?void 0:a.FormUUID))return!!s.Data.find(d=>{if(d.SectionFieldUUID==(u==null?void 0:u.SectionFieldUUID)){const U=JSON.parse(d.Data);return e.tickets.filter(v=>v.RequiresAccommodation).find(v=>U.Ticket.includes(v.TicketUUID)||U.AddonsChecked.includes(v.TicketUUID)||U.ComponentsChecked.includes(v.TicketUUID))}})}):!1});return(u,a)=>A.value?(n(),_(h,{key:0},[u.value?(n(),_("ol",Uo,[(n(!0),_(h,null,W(f.value,s=>(n(),_("li",{key:s.AccommodationUUID},[u.registration&&u.registration.Allocation&&u.registration.Allocation.Periods.find(d=>d.AccommodationUUID===s.AccommodationUUID)?(n(),_("strong",Ao,y(s.Name),1)):(n(),_(h,{key:1},[R(y(s.Name),1)],64))]))),128))])):(n(),_("ul",To,[(n(!0),_(h,null,W(r.value,s=>{var d;return n(),_("li",{key:s.DateStart},[R(y((d=s.Accommodation)==null?void 0:d.Name)+" ("+y(p(Oe)(s.DateStart))+" - "+y(p(Oe)(s.DateEnd))+")",1),_o])}),128))])),p(o)?(n(),D(q,{key:2,onClick:a[0]||(a[0]=s=>i.value=!0),variant:"flat",color:"success"},{default:l(()=>[R("Assign Accommodation")]),_:1})):N("",!0),u.convention&&i.value?(n(),D(vo,{key:3,modelValue:i.value,"onUpdate:modelValue":a[1]||(a[1]=s=>i.value=s),title:"Accommodation Allocation",convention:u.convention,registration:u.registration,tickets:u.tickets,"selected-accommodation":f.value},null,8,["modelValue","convention","registration","tickets","selected-accommodation"])):N("",!0)],64)):N("",!0)}}),Na=dt(Eo,[["__scopeId","data-v-33548a38"]]),go={key:0,class:"addonList"},po={key:0},So={key:0},Do=j({__name:"DataTableItemExtras",props:{extras:{default:()=>[]},value:{default:""}},setup(e){const c=ue(()=>{if(!e.value)return;const o=JSON.parse(e.value),i=Object.keys(o),r=Ee(e.extras);return r.forEach(f=>{f.Options=f.Options.filter(A=>i.includes(A.OptionUUID)?(A.Choices=A.Choices.filter(u=>u.TagUUID===o[A.OptionUUID].choiceId),o[A.OptionUUID].checked):!1)}),r.filter(f=>f.Options.length>0),r});return(o,i)=>o.value?(n(),_("ul",go,[(n(!0),_(h,null,W(c.value,r=>(n(),_(h,{key:r.ExtraUUID},[r.Options.length?(n(),_("li",po,[w("strong",null,y(r.Name),1),w("ul",null,[(n(!0),_(h,null,W(r.Options,f=>(n(),_("li",{key:f.OptionUUID},[R(y(f.Name)+" ",1),f.Choices.length==1?(n(),_("small",So,"("+y(f.Choices[0].Title)+")",1)):N("",!0)]))),128))])])):N("",!0)],64))),128))])):N("",!0)}}),ba=dt(Do,[["__scopeId","data-v-55786e01"]]),yo={key:0},La=j({__name:"DataTableItemInterests",props:{interests:{default:()=>[]},value:{default:""}},setup(e){const c=ue(()=>{if(!e.value)return;const o=JSON.parse(e.value);return Object.entries(o).filter(([,i])=>i).map(([i,r])=>e.interests.find(f=>f.InterestUUID===i)).filter(i=>i!==void 0)});return(o,i)=>o.value?(n(),_("ul",yo,[(n(!0),_(h,null,W(c.value,r=>(n(),_("li",{key:r.InterestUUID},y(r.Name),1))),128))])):N("",!0)}}),Io=w("br",null,null,-1),Co=w("small",null,"Options:",-1),Ro=w("br",null,null,-1),Vo=w("small",null,"Addons:",-1),wa=j({__name:"DataTableItemTicket",props:{tickets:{default:()=>[]},value:{default:""}},setup(e){const c=ue(()=>{if(!e.value)return;let o={Ticket:[],AddonsChecked:[],ComponentsChecked:[]};try{o=JSON.parse(e.value),"ticket"in o&&(o.Ticket=o.ticket),"addonsChecked"in o&&(o.AddonsChecked=o.addonsChecked),"componentsChecked"in o&&(o.ComponentsChecked=o.componentsChecked)}catch{}return o.Ticket.filter(i=>{const r=e.tickets.find(f=>f.TicketUUID===i);return!(!r||r.Type!==Ul.TICKET_TYPE_TICKET)}).map(i=>{const r=e.tickets.find(A=>A.TicketUUID===i),f=Ee(r);return f.TicketComponents=r.TicketComponents.filter(A=>o.ComponentsChecked.includes(A.TicketUUID)),f.AddonTickets=r.AddonTickets.filter(A=>o.AddonsChecked.includes(A.TicketUUID)),f})});return(o,i)=>o.value?(n(!0),_(h,{key:0},W(c.value,r=>(n(),_("div",{key:r.TicketUUID},[w("strong",null,y(r.Name),1),r.TicketComponents.length>0?(n(),_(h,{key:0},[Io,Co,R("  "),(n(!0),_(h,null,W(r.TicketComponents,f=>(n(),_(h,{key:f.TicketUUID},[w("small",null,y(f.Name),1),R("  ")],64))),128))],64)):N("",!0),r.AddonTickets.length>0?(n(),_(h,{key:1},[Ro,Vo,R("  "),(n(!0),_(h,null,W(r.AddonTickets,f=>(n(),_("small",{key:f.TicketUUID},[R("("),w("em",null,y(f.Name),1),R(")")]))),128))],64)):N("",!0)]))),128)):N("",!0)}}),Fa=j({__name:"DataPanelAccommodation",props:J({accommodations:{},convention:{},data:{},forms:{},tickets:{},venues:{},registration:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(e){return te(e,"modelValue"),(c,o)=>(n(),_("div",null,[t(Na,{value:c.data,accommodations:c.accommodations,convention:c.convention,forms:c.forms,registration:c.registration,tickets:c.tickets,venues:c.venues},null,8,["value","accommodations","convention","forms","registration","tickets","venues"])]))}}),Oo={key:0,class:"text-red-darken-4 font-weight-bold"},Mo={key:1,class:"text-orange-darken-2 font-weight-bold"},ho=j({__name:"DataPanelAge",props:J({data:{},forms:{},registration:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(e){const c=te(e,"modelValue"),o=new Date,i=o.getFullYear(),r=(o.getMonth()+1).toLocaleString("en-US",{minimumIntegerDigits:2}),f=o.getDate().toLocaleString("en-US",{minimumIntegerDigits:2}),A=E(!1),u=E(`${i}-${r}-${f}`),a=E(18);e.forms.find(v=>v.Sections.find(m=>m.Fields?m.Fields.find(g=>{var S;return g.SectionFieldUUID===c.value.SectionFieldUUID?(c.value.SectionField=g,(S=g.Field)==null||S.Values.forEach(O=>{switch(O.Title){case"UNDER_AGE_APPLY_TAG":O.Value.length>0&&(A.value=!0);break;case"BEFORE_DATE":u.value=O.Value;break;case"MIN_AGE":a.value=parseInt(O.Value);break}}),!0):!1}):!1));const s=v=>({registration:d(v,e.registration.CreatedAt||"",a.value),convention:d(v,u.value,a.value)}),d=(v,m,g)=>{if(v>=m)return!1;const S=U(v),I=U(m).getTime()-S.getTime(),k=1e3*60*60*24*365.25;return I/k>=g},U=v=>{const[m,g,S]=v.split("-");return new Date(parseInt(m),parseInt(g)-1,parseInt(S))};return(v,m)=>(n(),_("div",null,[w("p",null,[R(y(p(Oe)(v.data,{withDay:!1,withYear:!0}))+" ",1),A.value&&s(v.data).convention&&s(v.data).registration?(n(),D(Me,{key:0,icon:"mdi:mdi-check",color:"success"})):A.value&&!s(v.data).convention?(n(),D(Me,{key:1,icon:"mdi:mdi-alert",color:"error"})):A.value&&s(v.data).convention&&!s(v.data).registration?(n(),D(Me,{key:2,icon:"mdi:mdi-alert",color:"warning"})):N("",!0)]),A.value?(n(),_(h,{key:0},[s(v.data).convention?s(v.data).registration?N("",!0):(n(),_("p",Mo," Attendee was under "+y(a.value)+" at time of registration ",1)):(n(),_("p",Oo," Attendee is under "+y(a.value),1))],64)):N("",!0)]))}}),ko={key:0},Qt=j({__name:"Badges",props:{cardClass:{default:""},convention:{},registration:{},showTitle:{type:Boolean,default:!0}},setup(e){const c=Ae(),o=pt(),i=E([]);let r;const f=nl();f&&"$NDEFReader"in f.appContext.config.globalProperties&&(r=f.appContext.config.globalProperties.$NDEFReader);const A=E(!!r),u=E(e.registration.BadgeSerialNumber),a=E(""),s=E(!1),d=E(2),U=g=>{var O;const S=document.createElement("a");S.download=`${((O=e.convention)==null?void 0:O.Name)||""} Badge Image - ${e.registration.Reference} - ${e.registration.User.DisplayName}.jpg`,S.href=g,document.body.appendChild(S),S.click(),document.body.removeChild(S)},v=async g=>o.GetConBadgeImageURL(e.registration.RegistrationUUID,g),m=()=>{if(A.value)try{const g=new r;g.addEventListener("readingerror",()=>{a.value="Error Reading Card",s.value=!0}),g.addEventListener("reading",S=>{if(S.serialNumber){const O=S.serialNumber;a.value="Obtained Card Details",s.value=!0,u.value=O,c.setBadgeSerial(e.registration.RegistrationUUID,u.value).then(I=>{I?(a.value="Badge Serial Saved",s.value=!0):(a.value="Failed to Save Badge Serial",s.value=!0)})}else a.value="Serial Number not Found",s.value=!0}),g.scan&&g.scan()}catch{}};return c.getConBadgeList(e.registration.RegistrationUUID).then(g=>{g.forEach(S=>{v(S).then(O=>{i.value.push({template:S,url:O})})})}).catch(()=>{}),(g,S)=>(n(!0),_(h,null,W(i.value,O=>(n(),D($e,{key:O.template,class:Qe(g.cardClass)},{default:l(()=>[t(ot,null,{default:l(()=>[g.showTitle?(n(),D(We,{key:0},{default:l(()=>[t(Q,{class:"flex-row-reverse"},{default:l(()=>[t(M,{class:"text-wrap flex-grow-1"},{default:l(()=>[R(" Badges (#"+y(g.registration.Reference)+" "+y(g.registration.User.DisplayName)+") ",1)]),_:1})]),_:1})]),_:1})):N("",!0)]),_:1}),t(Ze,null,{default:l(()=>[t(jt,{src:O.url,height:"280",width:"280"},null,8,["src"]),u.value?(n(),_("p",ko,y(u.value),1)):N("",!0)]),_:2},1024),t(Kt,null,{default:l(()=>[A.value?(n(),D(q,{key:0,onClick:m},{default:l(()=>[R("Link Card")]),_:1})):N("",!0),t(q,{color:"primary","prepend-icon":"mdi:mdi-download",variant:"flat",onClick:I=>U(O.url)},{default:l(()=>[R("Download")]),_:2},1032,["onClick"])]),_:2},1024),t(Dl,{modelValue:s.value,"onUpdate:modelValue":S[0]||(S[0]=I=>s.value=I),message:a.value,timeout:d.value*1e3},null,8,["modelValue","message","timeout"])]),_:2},1032,["class"]))),128))}}),No=j({__name:"DataPanelText",props:J({convention:{},data:{},forms:{}},{modelValue:{required:!0},modelModifiers:{},registration:{required:!0},registrationModifiers:{}}),emits:["update:modelValue","update:registration"],setup(e){const c=te(e,"modelValue"),o=te(e,"registration"),i=E(e.data),r=ue(()=>a.value?"":i.value!==e.data?"mdi:mdi-content-save":""),f=Xe(),A=Ae(),u=E(Ht(f,e.convention)),a=E(!1),s=()=>{a.value=!0,A.directEditFieldData(o.value.RegistrationUUID,c.value.LayoutItemUUID,i.value).then(d=>{d&&o.value.Submissions.find(U=>!!U.Data.find(v=>{if(v.SectionFieldUUID===c.value.SectionFieldUUID)return v.Data=d,!0})),a.value=!1}).catch(()=>{})};return(d,U)=>c.value.Meta.DirectEdit&&(u.value||c.value.Meta.DirectEditPermission==="View")?(n(),D(oe,{key:0,modelValue:i.value,"onUpdate:modelValue":U[0]||(U[0]=v=>i.value=v),"append-inner-icon":r.value,"onClick:appendInner":s},Je({_:2},[a.value?{name:"append-inner",fn:l(()=>[t(ga,{color:"primary",indeterminate:"",size:30})]),key:"0"}:void 0]),1032,["modelValue","append-inner-icon"])):(n(),_(h,{key:1},[R(y(d.data),1)],64))}}),bo={key:4},Lo={key:8},wo=j({__name:"FormDataItem",props:J({accommodations:{},convention:{},extras:{},forms:{},interests:{},itemClass:{},tickets:{},venues:{}},{modelValue:{required:!0},modelModifiers:{},registration:{required:!0},registrationModifiers:{}}),emits:["update:modelValue","update:registration"],setup(e){const c=te(e,"modelValue"),o=te(e,"registration"),i=ue(()=>{var U,v,m,g;const s=c.value,d=()=>{var S;for(let O=0;O<e.forms.length;O+=1)for(let I=0;I<e.forms[O].Sections.length;I+=1)if(e.forms[O].Sections[I].Fields){const k=(S=e.forms[O].Sections[I].Fields)==null?void 0:S.find(T=>T.SectionFieldUUID===s.SectionFieldUUID);if(k)return k}};return((v=(U=s.SectionField)==null?void 0:U.Field)==null?void 0:v.Type)||((g=(m=d())==null?void 0:m.Field)==null?void 0:g.Type)}),r=ue(()=>{for(let s=0;s<o.value.Submissions.length;s+=1){const U=o.value.Submissions[s].Data.find(v=>v.SectionFieldUUID===c.value.SectionFieldUUID);if(U)return U.Data}return""}),f=Ae(),A=pt(),u=E(""),a=E("");if(i.value==="BADGE_IMAGE")try{const s=JSON.parse(r.value||"{}");s.fileUUID&&(a.value=A.GetBadgeImageURL(s.fileUUID)),o.value&&f.getConBadgeDisplayName(o.value.RegistrationUUID).then(d=>{d&&(u.value=d)}).catch(()=>{})}catch{}return(s,d)=>i.value==="ACCOMMODATION"?(n(),D(Fa,{key:0,convention:s.convention,tickets:s.tickets,accommodations:s.accommodations,venues:s.venues,registration:o.value,forms:s.forms,modelValue:c.value,"onUpdate:modelValue":d[0]||(d[0]=U=>c.value=U),data:r.value},null,8,["convention","tickets","accommodations","venues","registration","forms","modelValue","data"])):i.value==="EXTRAS"?(n(),D(ba,{key:1,value:r.value,extras:s.extras},null,8,["value","extras"])):i.value==="TICKET"?(n(),D(wa,{key:2,value:r.value,tickets:s.tickets},null,8,["value","tickets"])):i.value==="INTERESTS"?(n(),D(La,{key:3,value:r.value,interests:s.interests},null,8,["value","interests"])):i.value==="CHECKBOX"?(n(),_("div",bo,[r.value?(n(),D(Me,{key:0,icon:"mdi:mdi-check",color:"success"})):(n(),D(Me,{key:1,icon:"mdi:mdi-close",color:"error"}))])):i.value==="AGE"?(n(),D(ho,{key:5,data:r.value,forms:s.forms,registration:o.value,modelValue:c.value,"onUpdate:modelValue":d[1]||(d[1]=U=>c.value=U)},null,8,["data","forms","registration","modelValue"])):i.value==="BADGE_IMAGE"?(n(),D(Qt,{key:6,convention:s.convention,registration:o.value,"show-title":!1,"card-class":s.itemClass},null,8,["convention","registration","card-class"])):i.value==="TEXT"?(n(),D(No,{key:7,convention:s.convention,data:r.value,forms:s.forms,modelValue:c.value,"onUpdate:modelValue":d[2]||(d[2]=U=>c.value=U),registration:o.value,"onUpdate:registration":d[3]||(d[3]=U=>o.value=U)},null,8,["convention","data","forms","modelValue","registration"])):(n(),_("div",Lo,y(r.value),1))}}),Fo={key:0},Po={key:0},$o=w("strong",null,"Total:",-1),Bo=j({__name:"DataPanelRegistrationGroup",props:{registration:{}},setup(e){const c=ue(()=>{const o=[];let i;return e.registration.Leader?i=e.registration:i=e.registration.Primary,o.push({Name:i.User.DisplayName,UUID:i.UserUUID,UserUUID:i.User.UserUUID,IsLeader:!0,Reference:i.Reference,Paid:i.Paid,Total:i.Total}),o.push(...i.Members.map(r=>({Name:r.User.DisplayName,UUID:r.UserUUID,UserUUID:r.User.UserUUID,IsLeader:!1,Reference:r.Reference,Paid:r.Paid,Total:r.Total}))),o});return(o,i)=>o.registration.Members.length===0&&!o.registration.Primary?(n(),_("em",Fo," Not in a group ")):(n(),_(h,{key:1},[w("ul",null,[(n(!0),_(h,null,W(c.value,r=>(n(),_("li",{key:r.UUID,class:"ml-0"},[R(" #"+y(r.Reference)+" : "+y(r.Name)+" ",1),r.IsLeader?(n(),_("strong",Po,"(Leader)")):N("",!0)]))),128))]),$o,R(" "+y(c.value.length),1)],64))}}),Yo=j({__name:"DataPanelSubmissionDate",props:{registration:{}},setup(e){const c=ue(()=>{const o=e.registration.Submissions.find(i=>{var r;return((r=i.Form)==null?void 0:r.Type)===_e.FORM_TYPE_REGISTRATION});return o?o.CreatedAt||"":e.registration.CreatedAt||""});return(o,i)=>(n(),_("div",null,y(p(Oe)(c.value,{withDay:!1,withYear:!0})),1))}}),Go={class:"text-grey-lighten-1"},xo=j({__name:"DataPanelSubmissionStatus",props:{convention:{},forms:{},registration:{}},emits:["showForm"],setup(e,{emit:c}){const o=c,i=Xe(),r=Ht(i,e.convention),f=ue(()=>e.registration.Submissions.map(a=>{const s=e.forms.find(d=>d.FormUUID===a.FormUUID);if(s)return{Heading:s.Heading,Form:s,Submission:a,Registration:e.registration}}).filter(a=>!!a)),A=(a,s,d)=>{o("showForm",a,s,d)},u=a=>({ID:0,SubmissionUUID:ye(),FormID:a.ID,FormUUID:a.FormUUID,Form:a,UserID:e.registration.UserID,UserUUID:e.registration.UserUUID,RegistrationID:e.registration.ID,RegistrationUUID:e.registration.RegistrationUUID,Registration:e.registration,Data:[],Status:Sa.SUBMISSION_STATUS_NULL});return(a,s)=>(n(),_(h,null,[w("ul",null,[(n(!0),_(h,null,W(a.forms.filter(d=>d.Type===p(_e).FORM_TYPE_ADMIN&&f.value.findIndex(U=>U.Form.ID===d.ID)<0),d=>(n(),_("li",{key:d.Heading},[w("strong",Go,y(d.Heading),1),p(r)?(n(),D(q,{key:0,class:"text-grey-lighten-1",icon:"mdi:mdi-form-select",title:"Edit Submitted Data",variant:"flat",onClick:U=>A(a.registration,d,u(d))},null,8,["onClick"])):N("",!0)]))),128))]),w("ul",null,[(n(!0),_(h,null,W(f.value,d=>(n(),_("li",{key:d.Heading},[w("strong",null,[R(y(d.Heading),1),d.Form.Type!==p(_e).FORM_TYPE_ADMIN?(n(),_(h,{key:0},[R(": ")],64)):N("",!0)]),d.Form.Type!==p(_e).FORM_TYPE_ADMIN?(n(),_("span",{key:0,class:Qe(p(pa)(d.Submission.Status))},y(p(qt)(d.Submission.Status)),3)):N("",!0),p(r)?(n(),D(q,{key:1,icon:"mdi:mdi-form-select",title:"Edit Submitted Data",variant:"flat",onClick:U=>A(d.Registration,d.Form,d.Submission)},null,8,["onClick"])):N("",!0)]))),128))])],64))}}),Ho={key:0,class:"text-blue"},qo={key:1,class:"text-red"},Ko={key:2,class:"text-orange"},jo={key:3,class:"text-orange"},zo={key:4,class:"text-orange"},Qo={key:5,class:"text-orange"},Jo={key:6,class:"text-green"},Xo=j({__name:"DataPanelPaymentStatus",props:{registration:{}},setup(e){const c=ue(()=>{if(e.registration.Paid===0&&e.registration.Total)return"REQUIRED";if(e.registration.Total>e.registration.Paid)return"ADDITIONAL_REQUIRED";const o=e.registration.Members.find(i=>i.Paid===0&&(i.Total||0)>0);return o?e.registration.Total===0&&o.Total===0?"NOT_REQUIRED":e.registration.Total===0&&o.Total||e.registration.Total>0&&o.Total===0?"MISSING_REQUIRED":e.registration.Paid>=e.registration.Total?"AWAITING_PARTNER":"ALL_REQUIRED":e.registration.Total===0?"NOT_REQUIRED":"COMPLETE"});return(o,i)=>c.value=="NOT_REQUIRED"?(n(),_("div",Ho,"No Payment Requested")):c.value=="MISSING_REQUIRED"?(n(),_("div",qo,"Partner Payment Not Requested")):c.value=="AWAITING_PARTNER"?(n(),_("div",Ko,"Awaiting Partner Payment")):c.value=="ALL_REQUIRED"?(n(),_("div",jo,"Awaiting Payments")):c.value=="REQUIRED"?(n(),_("div",zo,"Awaiting Payment")):c.value=="ADDITIONAL_REQUIRED"?(n(),_("div",Qo,"Awaiting Additional Payments")):(n(),_("div",Jo,"Completed"))}});var Wo=["onActivate","onAddUndo","onBeforeAddUndo","onBeforeExecCommand","onBeforeGetContent","onBeforeRenderUI","onBeforeSetContent","onBeforePaste","onBlur","onChange","onClearUndos","onClick","onContextMenu","onCopy","onCut","onDblclick","onDeactivate","onDirty","onDrag","onDragDrop","onDragEnd","onDragGesture","onDragOver","onDrop","onExecCommand","onFocus","onFocusIn","onFocusOut","onGetContent","onHide","onInit","onKeyDown","onKeyPress","onKeyUp","onLoadContent","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp","onNodeChange","onObjectResizeStart","onObjectResized","onObjectSelected","onPaste","onPostProcess","onPostRender","onPreProcess","onProgressState","onRedo","onRemove","onReset","onSaveContent","onSelectionChange","onSetAttrib","onSetContent","onShow","onSubmit","onUndo","onVisualAid"],Zo=function(e){return Wo.map(function(c){return c.toLowerCase()}).indexOf(e.toLowerCase())!==-1},en=function(e,c,o){Object.keys(c).filter(Zo).forEach(function(i){var r=c[i];typeof r=="function"&&(i==="onInit"?r(e,o):o.on(i.substring(2),function(f){return r(f,o)}))})},tn=function(e,c,o,i){var r=e.modelEvents?e.modelEvents:null,f=Array.isArray(r)?r.join(" "):r;fe(i,function(A,u){o&&typeof A=="string"&&A!==u&&A!==o.getContent({format:e.outputFormat})&&o.setContent(A)}),o.on(f||"change input undo redo",function(){c.emit("update:modelValue",o.getContent({format:e.outputFormat}))})},an=function(e,c,o,i,r,f){i.setContent(f()),o.attrs["onUpdate:modelValue"]&&tn(c,o,i,r),en(e,o.attrs,i)},da=0,Pa=function(e){var c=Date.now(),o=Math.floor(Math.random()*1e9);return da++,e+"_"+o+da+String(c)},ln=function(e){return e!==null&&e.tagName.toLowerCase()==="textarea"},ma=function(e){return typeof e>"u"||e===""?[]:Array.isArray(e)?e:e.split(" ")},on=function(e,c){return ma(e).concat(ma(c))},nn=function(e){return e==null},ca=function(){return{listeners:[],scriptId:Pa("tiny-script"),scriptLoaded:!1}},sn=function(){var e=ca(),c=function(r,f,A,u){var a=f.createElement("script");a.referrerPolicy="origin",a.type="application/javascript",a.id=r,a.src=A;var s=function(){a.removeEventListener("load",s),u()};a.addEventListener("load",s),f.head&&f.head.appendChild(a)},o=function(r,f,A){e.scriptLoaded?A():(e.listeners.push(A),r.getElementById(e.scriptId)||c(e.scriptId,r,f,function(){e.listeners.forEach(function(u){return u()}),e.scriptLoaded=!0}))},i=function(){e=ca()};return{load:o,reinitialize:i}},un=sn(),rn=function(){return typeof window<"u"?window:global},Ke=function(){var e=rn();return e&&e.tinymce?e.tinymce:null},dn={apiKey:String,cloudChannel:String,id:String,init:Object,initialValue:String,inline:Boolean,modelEvents:[String,Array],plugins:[String,Array],tagName:String,toolbar:[String,Array],modelValue:String,disabled:Boolean,tinymceScriptSrc:String,outputFormat:{type:String,validator:function(e){return e==="html"||e==="text"}}},Ve=function(){return Ve=Object.assign||function(e){for(var c,o=1,i=arguments.length;o<i;o++){c=arguments[o];for(var r in c)Object.prototype.hasOwnProperty.call(c,r)&&(e[r]=c[r])}return e},Ve.apply(this,arguments)},mn=function(e,c,o,i){return e(i||"div",{id:c,ref:o})},cn=function(e,c,o){return e("textarea",{id:c,visibility:"hidden",ref:o})},bt={selector:void 0,target:void 0},vn=j({props:dn,setup:function(e,c){var o=e.init?Ve(Ve({},e.init),bt):Ve({},bt),i=il(e),r=i.disabled,f=i.modelValue,A=i.tagName,u=E(null),a=null,s=e.id||Pa("tiny-vue"),d=e.init&&e.init.inline||e.inline,U=!!c.attrs["onUpdate:modelValue"],v=!0,m=e.initialValue?e.initialValue:"",g="",S=function(k){return U?function(){return f!=null&&f.value?f.value:""}:function(){return k?m:g}},O=function(){var k=S(v),T=Ve(Ve({},o),{readonly:e.disabled,target:u.value,plugins:on(o.plugins,e.plugins),toolbar:e.toolbar||o.toolbar,inline:d,setup:function(B){a=B,B.on("init",function(se){return an(se,e,c,B,f,k)}),typeof o.setup=="function"&&o.setup(B)}});ln(u.value)&&(u.value.style.visibility=""),Ke().init(T),v=!1};fe(r,function(k){var T;a!==null&&(typeof((T=a.mode)===null||T===void 0?void 0:T.set)=="function"?a.mode.set(k?"readonly":"design"):a.setMode(k?"readonly":"design"))}),fe(A,function(k){var T;U||(g=a.getContent()),(T=Ke())===null||T===void 0||T.remove(a),Ut(function(){return O()})}),sl(function(){if(Ke()!==null)O();else if(u.value&&u.value.ownerDocument){var k=e.cloudChannel?e.cloudChannel:"6",T=e.apiKey?e.apiKey:"no-api-key",B=nn(e.tinymceScriptSrc)?"https://cdn.tiny.cloud/1/".concat(T,"/tinymce/").concat(k,"/tinymce.min.js"):e.tinymceScriptSrc;un.load(u.value.ownerDocument,B,O)}}),ul(function(){Ke()!==null&&Ke().remove(a)}),d||(rl(function(){v||O()}),dl(function(){var k;U||(g=a.getContent()),(k=Ke())===null||k===void 0||k.remove(a)}));var I=function(k){var T;g=a.getContent(),(T=Ke())===null||T===void 0||T.remove(a),o=Ve(Ve(Ve({},o),k),bt),Ut(function(){return O()})};return c.expose({rerender:I,getEditor:function(){return a}}),function(){return d?mn(aa,s,u,e.tagName):cn(aa,s,u)}}});const fn=["colspan"],Un=w("strong",null,"E-Mail Content",-1),An=["innerHTML"],Tn=j({__name:"Communications",props:{expanded:{type:Boolean,default:!0},hideHistory:{type:Boolean,default:!1},registration:{},showEditor:{type:Boolean}},emits:["close-editor"],setup(e,{emit:c}){const o=Ae(),i=E([]),r=E({From:"",Subject:"",HTML:""}),f=E(""),A=E(""),u=E(""),a=E(!1),s=E(e.expanded?["1"]:[]),d=E([]),U=E([]),v=E([{key:"CreatedAt",title:"Date"},{key:"Subject",title:"Subject"},{key:"User.DisplayName",title:"Sender"},{key:"Status",title:"Status"}]),m=E([{key:"CreatedAt",order:"asc"}]);fe(r,k=>{u.value=k.From||u.value||"",A.value=k.Subject||A.value||"",f.value=k.HTML||f.value||""});const g=c,S=()=>{o.getRegistrationEmails(e.registration.RegistrationUUID).then(k=>{k&&(k.forEach(T=>{T.CreatedAt=At(new Date(T.CreatedAt||"")),T.Status=to(T.Status),T.User||(T.User={ID:0,UserUUID:"",DisplayName:"System",Handle:"",Credentials:[],Additional:{FirstName:"",LastName:"",DOB:"",Email:""},Data:"",Groups:[],Tags:[]})}),U.value=k)})};S(),(()=>{o.getRegistrationEmailTemplates(e.registration.RegistrationUUID).then(k=>{k&&(i.value=k)})})();const I=({callback:k})=>{o.sendRegistrationEmail(e.registration.RegistrationUUID,u.value,A.value,f.value).then(T=>{T?k&&(k("Email Sent"),S(),setTimeout(()=>{a.value=!1},2e3)):k&&k("Not sent")}).catch(()=>{k&&k("Not sent")})};return(k,T)=>(n(),_(h,null,[k.showEditor?(n(),D(me,{key:0,class:"px-0",style:{"max-width":"calc(100vw - 64px)"}},{default:l(()=>[t(Q,null,{default:l(()=>[t(M,null,{default:l(()=>[t(Ta,{items:i.value,"item-title":"Subject","return-object":"",label:"Template","hide-details":"",modelValue:r.value,"onUpdate:modelValue":T[0]||(T[0]=B=>r.value=B),variant:"outlined"},null,8,["items","modelValue"])]),_:1})]),_:1}),t(Q,null,{default:l(()=>[t(M,{cols:"12"},{default:l(()=>[t(oe,{modelValue:u.value,"onUpdate:modelValue":T[1]||(T[1]=B=>u.value=B),label:"From",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),t(M,{cols:"12"},{default:l(()=>[t(oe,{modelValue:A.value,"onUpdate:modelValue":T[2]||(T[2]=B=>A.value=B),label:"Subject",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),t(M,{cols:"12"},{default:l(()=>[t(p(vn),{modelValue:f.value,"onUpdate:modelValue":T[3]||(T[3]=B=>f.value=B),"api-key":"g9sce3fktcgvk0i7sp96cahgyk4cos7q27es3ubnlal3xf3z"},null,8,["modelValue"])]),_:1})]),_:1}),t(Q,null,{default:l(()=>[t(M,null,{default:l(()=>[t(rt,{onClick:T[4]||(T[4]=B=>g("close-editor")),label:"Close E-mail Editor",color:"secondary","prepend-icon":"mdi:mdi-window-close"})]),_:1}),t(M,{class:"text-right"},{default:l(()=>[t(rt,{onClick:I,label:"Send",color:"error"})]),_:1})]),_:1})]),_:1})):N("",!0),U.value.length&&!k.hideHistory?(n(),D(It,{key:1,class:"my-2",multiple:!0,modelValue:s.value,"onUpdate:modelValue":T[7]||(T[7]=B=>s.value=B)},{default:l(()=>[t(yt,{value:"1"},{default:l(()=>[t(St,null,{default:l(()=>[R(" Email History ")]),_:1}),t(Dt,null,{default:l(()=>[t(zt,{items:U.value,headers:v.value,"show-expand":!0,"item-value":"EmailUUID",expanded:d.value,"onUpdate:expanded":T[5]||(T[5]=B=>d.value=B),"sort-by":m.value,"onUpdate:sortBy":T[6]||(T[6]=B=>m.value=B)},{"expanded-row":l(({columns:B,item:se})=>[w("tr",null,[w("td",{colspan:B.length},[Un,w("div",{class:"communicationsViewEmailPreview",innerHTML:se.HTML},null,8,An)],8,fn)])]),"footer.prepend":l(()=>[t(q,{"prepend-icon":"mdi:mdi-refresh",color:"primary",class:"mr-4",onClick:S},{default:l(()=>[R("Refresh")]),_:1})]),_:1},8,["items","headers","expanded","sort-by"])]),_:1})]),_:1})]),_:1},8,["modelValue"])):N("",!0)],64))}}),$a=j({__name:"Emails",props:{allowSending:{type:Boolean,default:!0},expanded:{type:Boolean,default:!0},hideHistory:{type:Boolean,default:!1},showTitle:{type:Boolean,default:!0},registration:{},textClass:{default:""}},setup(e){const c=E(!1);return(o,i)=>(n(),_(h,null,[t($e,null,{default:l(()=>[o.showTitle?(n(),D(ot,{key:0},{default:l(()=>[t(We,null,{default:l(()=>[R(" E-Mails (#"+y(o.registration.Reference)+" "+y(o.registration.User.DisplayName)+") ",1)]),_:1})]),_:1})):N("",!0),t(Ze,{class:Qe(o.textClass)},{default:l(()=>[o.allowSending?(n(),D(Q,{key:0},{default:l(()=>[t(M,{cols:"12"},{default:l(()=>[t(q,{"prepend-icon":"mdi:mdi-email",color:"primary",onClick:i[0]||(i[0]=r=>c.value=!0)},{default:l(()=>[R(" Prepare Email ")]),_:1})]),_:1})]),_:1})):N("",!0)]),_:1},8,["class"])]),_:1}),t(Tn,{registration:o.registration,expanded:o.expanded,"hide-history":o.hideHistory,"show-editor":c.value,onCloseEditor:i[1]||(i[1]=r=>c.value=!1)},null,8,["registration","expanded","hide-history","show-editor"])],64))}}),_n=j({__name:"EditNoteCategoryDialog",props:J({convention:{},noteCategory:{},title:{}},{modelValue:{type:Boolean,required:!0},modelModifiers:{}}),emits:J(["update:noteCategory"],["update:modelValue"]),setup(e,{emit:c}){const o=e,{title:i=""}=o,r=c,f=te(e,"modelValue"),A=mt(o,r,void 0,void 0,"noteCategory"),u=E(Ee(A.value));fe(A,()=>{u.value=Ee(A.value)});const a=()=>{f.value=!1},s=()=>{u.value=Ee(A.value)},d=()=>{A.value=u.value};return(U,v)=>(n(),D(Fe,{modelValue:f.value,"onUpdate:modelValue":v[2]||(v[2]=m=>f.value=m),onReset:s,onSave:d,title:p(i),color:"primary",persistent:!0,fullscreen:!1,"hide-extension":!0},{default:l(()=>[t(me,{class:"pa-0",fluid:!0},{default:l(()=>[t(Q,null,{default:l(()=>[t(M,{cols:"12",sm:"6",md:"4"},{default:l(()=>[t(oe,{modelValue:u.value.Name,"onUpdate:modelValue":v[0]||(v[0]=m=>u.value.Name=m),label:"Internal name",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),t(M,{cols:"12",sm:"6",md:"4"},{default:l(()=>[t(ya,{modelValue:u.value.Groups,"onUpdate:modelValue":v[1]||(v[1]=m=>u.value.Groups=m),convention:U.convention,label:"Groups",variant:"outlined","hide-details":""},null,8,["modelValue","convention"])]),_:1})]),_:1})]),_:1})]),actions:l(()=>[t(q,{color:"blue-darken-1",variant:"text",onClick:a},{default:l(()=>[R(" Cancel ")]),_:1}),t(q,{color:"blue-darken-1",variant:"text",onClick:s},{default:l(()=>[R(" Reset ")]),_:1}),t(Pe),t(q,{color:"blue-darken-1",variant:"text",onClick:d},{default:l(()=>[R(" Save ")]),_:1})]),_:1},8,["modelValue","title"]))}}),En=()=>{const e=E(""),c=()=>{const o={x:window.innerWidth,y:window.innerHeight};o.x<600?e.value="xs":o.x>=600&&o.x<960?e.value="sm":o.x>=960&&o.x<1280?e.value="md":o.x>=1280&&o.x<1920?e.value="lg":o.x>=1920&&o.x<2560?e.value="xl":o.x>=2560&&(e.value="xxl")};return window.addEventListener("resize",c),c(),e},gn={style:{"list-style":"none"}},pn=j({__name:"NoteCategories",props:{hideHistory:{type:Boolean},convention:{},showEditor:{type:Boolean}},emits:["close"],setup(e,{emit:c}){const o=Ae(),i=c,r=E(!1),f=E(!1),A=E(""),u=E([]),a=E([{key:"Name",title:"Name"},{key:"Groups",title:"Groups"},{key:"actions",title:"",sortable:!1}]),s=En();E([{key:"CreatedAt",order:"asc"}]);const d=()=>({ID:0,NoteCategoryUUID:ye(),ConventionID:e.convention.ID,ConventionUUID:e.convention.ConventionUUID,Name:"",Groups:[],Notes:[]}),U=E(-1),v=E(d()),m=E(d()),g=()=>{m.value.NoteCategoryUUID=ye(),v.value=Object.assign({},d()),U.value=-1,r.value=!0},S=z=>{U.value=u.value.indexOf(z),v.value=Object.assign({},z),r.value=!0},O=z=>{U.value=u.value.indexOf(z),v.value=Object.assign({},z),f.value=!0},I=()=>{o.deleteNoteCategory(v.value.NoteCategoryUUID).then(z=>{z&&(u.value.splice(U.value,1),T())})},k=()=>{r.value=!1,Ut(()=>{v.value=Object.assign({},m.value),U.value=-1})},T=()=>{f.value=!1,Ut(()=>{v.value=Object.assign({},m.value),U.value=-1})},B=()=>{o.saveNoteCategory(v.value).then(z=>{z&&(U.value>-1?Object.assign(u.value[U.value],z):u.value.push(z),k())})};return(()=>{o.getNoteCategories(e.convention.ConventionUUID).then(z=>{z&&(u.value=z)})})(),(z,x)=>(n(),D(zt,{headers:a.value,items:u.value,"sort-by":[{key:"calories",order:"asc"}],class:"elevation-1"},{top:l(()=>[t($t,{color:"primary"},Je({default:l(()=>[t(Ma,null,{default:l(()=>[R("Note Categories")]),_:1}),t(Bl,{class:"mx-4 d-none d-sm-inline-flex",inset:!0,vertical:!0}),t(Pe,{class:"d-none d-sm-inline-flex"}),p(s)!="xs"?(n(),D(q,{key:0,dark:"",class:"mb-2","prepend-icon":"mdi:mdi-pencil",onClick:g},{default:l(()=>[R(" New Item ")]),_:1})):N("",!0),t(q,{dark:"",class:"mb-2",icon:"mdi:mdi-window-close",onClick:x[0]||(x[0]=le=>i("close"))}),t(Oa,{modelValue:f.value,"onUpdate:modelValue":x[1]||(x[1]=le=>f.value=le),onDelete:I},null,8,["modelValue"])]),_:2},[p(s)=="xs"?{name:"extension",fn:l(()=>[t(Pe),t(q,{dark:"",class:"mb-2","prepend-icon":"mdi:mdi-pencil",onClick:g},{default:l(()=>[R(" New Item ")]),_:1})]),key:"0"}:void 0]),1024),r.value?(n(),D(_n,{key:0,modelValue:r.value,"onUpdate:modelValue":x[2]||(x[2]=le=>r.value=le),"note-category":v.value,"onUpdate:noteCategory":[x[3]||(x[3]=le=>v.value=le),B],title:A.value,convention:z.convention},null,8,["modelValue","note-category","title","convention"])):N("",!0)]),"item.Groups":l(({item:le})=>[w("ul",gn,[(n(!0),_(h,null,W(le.Groups,Y=>(n(),_("li",{key:Y.GroupUUID,class:"py-1"},y(Y.Name),1))),128))])]),"item.actions":l(({item:le})=>[t(Me,{size:"small",class:"me-2",onClick:Y=>S(le)},{default:l(()=>[R(" mdi:mdi-pencil ")]),_:2},1032,["onClick"]),t(Me,{size:"small",onClick:Y=>O(le)},{default:l(()=>[R(" mdi:mdi-delete ")]),_:2},1032,["onClick"])]),_:1},8,["headers","items"]))}}),Sn=j({__name:"SelectNoteCategories",props:J({convention:{},chips:{type:Boolean,default:!1},clearable:{type:Boolean,default:!1},hint:{default:""},label:{},variant:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:J(["change"],["update:modelValue"]),setup(e,{emit:c}){const o=te(e,"modelValue"),i=c,r=E([]),f=Ae(),A=E([]),u=E(""),a=E(0),s=ue(()=>[...A.value].map(v=>({title:v.Name,value:r.value.find(m=>m.NoteCategoryUUID===v.NoteCategoryUUID)||v})));return typeof e.convention=="object"?u.value=e.convention.ConventionUUID:u.value=e.convention||"",(async()=>{const U=[];u.value&&U.push(f.getNoteCategories(u.value));const v=await Promise.all(U);if(u.value&&v.length==1&&(A.value=v[0].sort((m,g)=>m.Name.localeCompare(g.Name))),Array.isArray(o.value))a.value=2,s.value.forEach(m=>{Array.isArray(o.value)&&o.value.find(S=>S.NoteCategoryUUID===m.value.NoteCategoryUUID)&&r.value.push(m.value)});else if(typeof o.value=="string"){a.value=1;try{const m=JSON.parse(o.value);s.value.forEach(g=>{m.find(O=>O.NoteCategoryUUID===g.value.NoteCategoryUUID)&&r.value.push(g.value)})}catch{}}})(),fe(r,()=>{switch(a.value){default:case 2:{o.value=r.value,i("change");break}case 1:{o.value=JSON.stringify(r.value),i("change");break}}}),(U,v)=>(n(),D(Ta,{modelValue:r.value,"onUpdate:modelValue":v[0]||(v[0]=m=>r.value=m),chips:U.chips,multiple:"",label:U.label||"Tags",variant:U.variant||"solo",hint:U.hint,"persistent-hint":!0,clearable:U.clearable,items:s.value,"item-title":"title","item-value":"value"},null,8,["modelValue","chips","label","variant","hint","clearable","items"]))}}),Dn=j({__name:"EditNoteDialog",props:J({convention:{},note:{},title:{}},{modelValue:{type:Boolean,required:!0},modelModifiers:{}}),emits:J(["update:note","saved"],["update:modelValue"]),setup(e,{emit:c}){const o=e,{title:i=""}=o,r=Ae(),f=c,A=te(e,"modelValue"),u=mt(o,f,void 0,void 0,"note"),a=E(Ee(u.value));fe(u,()=>{a.value=Ee(u.value)});const s=()=>{a.value=Ee(u.value)},d=U=>{a.value.NoteCategories===null&&(a.value.NoteCategories=[]),a.value.CreatedAt=void 0,a.value.DeletedAt=void 0,a.value.UpdatedAt=void 0,a.value.Admin=void 0,a.value.AdminID=void 0,a.value.AdminUUID=void 0,r.saveNote(a.value).then(v=>{v?(a.value=Ee(v),U&&U("Note Saved"),u.value=a.value,f("saved",u.value)):U&&U("Internal Error Saving Note")}).catch(v=>{U&&U("Error Saving Note:"+v.ErrorMessage)})};return(U,v)=>a.value?(n(),D(Fe,{key:0,"card-class":"pa-4",modelValue:A.value,"onUpdate:modelValue":v[3]||(v[3]=m=>A.value=m),onReset:s,onSave:d,title:p(i),color:"primary",persistent:!0,fullscreen:!1,"hide-extension":!0,"show-close-action":!0,"show-reset-action":!0,"show-save-action":!0},{default:l(()=>[t(me,{class:"pa-0",fluid:!0},{default:l(()=>[t(Q,null,{default:l(()=>[t(M,{cols:"12"},{default:l(()=>[t(Sn,{modelValue:a.value.NoteCategories,"onUpdate:modelValue":v[0]||(v[0]=m=>a.value.NoteCategories=m),convention:U.convention,label:"Categories",variant:"outlined","hide-details":"",chips:!0},null,8,["modelValue","convention"])]),_:1})]),_:1}),t(Q,null,{default:l(()=>[t(M,{cols:"12"},{default:l(()=>[t(oe,{modelValue:a.value.Subject,"onUpdate:modelValue":v[1]||(v[1]=m=>a.value.Subject=m),label:"Subject",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),t(M,{cols:"12"},{default:l(()=>[t(ha,{modelValue:a.value.Description,"onUpdate:modelValue":v[2]||(v[2]=m=>a.value.Description=m),label:"Note",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue","title"])):N("",!0)}}),Ba=j({__name:"Notes",props:{allowAdding:{type:Boolean,default:!0},cardClass:{default:""},convention:{},expanded:{type:Boolean,default:!0},hideHistory:{type:Boolean},registration:{},showControlPanel:{type:Boolean,default:!0},showEditor:{type:Boolean},showTitle:{type:Boolean,default:!0},textClass:{default:""}},setup(e){const c=Ae(),o=()=>({ID:0,NoteUUID:ye(),Description:"",NoteCategories:[],Registration:e.registration,RegistrationID:e.registration.ID,RegistrationUUID:e.registration.RegistrationUUID,Subject:""}),i=E(!1),r=E(!1),f=E([]),A=E([]),u=E(o()),a=()=>{u.value=o(),i.value=!0},s=v=>{u.value=v,i.value=!0},d=()=>{c.getRegistrationNotes(e.registration.RegistrationUUID).then(v=>{v&&(v.forEach(m=>{m.CreatedAt=At(new Date(m.CreatedAt||"")),m.Admin||(m.Admin={ID:0,UserUUID:"",DisplayName:"System",Handle:"",Credentials:[],Additional:{FirstName:"",LastName:"",DOB:"",Email:""},Data:"",Groups:[],Tags:[]})}),f.value=v,e.expanded&&(A.value=v.map(m=>m.NoteUUID)))})},U=()=>{d(),setTimeout(()=>{i.value=!1},2e3)};return d(),(v,m)=>(n(),_(h,null,[t($e,{class:Qe(v.cardClass)},{default:l(()=>[t(ot,null,{default:l(()=>[t(We,null,{default:l(()=>[t(Q,{class:"flex-row-reverse"},{default:l(()=>[v.showControlPanel?(n(),D(M,{key:0,class:"text-right flex-shrink-1 flex-grow-0",style:{"flex-grow":"0 !important"}},{default:l(()=>[t(q,{class:"d-sm-none",size:"xs",icon:"mdi:mdi-cog",variant:"text",color:"warning",onClick:m[0]||(m[0]=g=>r.value=!0)}),t(q,{class:"d-none d-sm-inline-flex","prepend-icon":"mdi:mdi-cog",variant:"text",color:"warning",onClick:m[1]||(m[1]=g=>r.value=!0)},{default:l(()=>[R("Categories")]),_:1})]),_:1})):N("",!0),v.showTitle?(n(),D(M,{key:1,class:"text-wrap flex-grow-1"},{default:l(()=>[R(" Notes (#"+y(v.registration.Reference)+" "+y(v.registration.User.DisplayName)+") ",1)]),_:1})):N("",!0)]),_:1})]),_:1})]),_:1}),t(Ze,{class:Qe(v.textClass)},{default:l(()=>[f.value.length===0?(n(),_(h,{key:0},[R(" No Notes Recorded ")],64)):(n(),D(It,{key:1,multiple:!0,variant:"accordion",modelValue:A.value,"onUpdate:modelValue":m[2]||(m[2]=g=>A.value=g)},{default:l(()=>[(n(!0),_(h,null,W(f.value,g=>(n(),D(yt,{key:`${g.NoteUUID}.${g.UpdatedAt}`,value:g.NoteUUID},{default:l(()=>[t(St,{class:"py-0"},{default:l(()=>[R(y(g.Subject)+" ",1),t(ka,{class:"ml-4"},{default:l(()=>[g.NoteCategories.length===0?(n(),D(Bt,{key:0},{default:l(()=>[R(" Global ")]),_:1})):N("",!0),(n(!0),_(h,null,W(g.NoteCategories,S=>(n(),D(Bt,{key:S.NoteCategoryUUID},{default:l(()=>[R(y(S.Name),1)]),_:2},1024))),128))]),_:2},1024)]),_:2},1024),t(Dt,null,{default:l(()=>[t(Q,null,{default:l(()=>[t(M,null,{default:l(()=>[R(y(g.Description),1)]),_:2},1024)]),_:2},1024),t(Q,null,{default:l(()=>[t(M,null,{default:l(()=>[R(y(p(Oe)(g.UpdatedAt||""))+" ",1),g&&g.Admin&&g.Admin.DisplayName?(n(),_(h,{key:0},[R(" - "+y(g.Admin.DisplayName),1)],64)):N("",!0)]),_:2},1024),t(M,{class:"text-right"},{default:l(()=>[t(q,{color:"primary","prepend-icon":"mdi:mdi-pencil",onClick:S=>s(g)},{default:l(()=>[R("Edit")]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"]))]),_:1},8,["class"]),v.allowAdding?(n(),D(Kt,{key:0},{default:l(()=>[t(q,{color:"primary",variant:"flat",onClick:a},{default:l(()=>[R("Add Note")]),_:1})]),_:1})):N("",!0)]),_:1},8,["class"]),t(_t,{modelValue:i.value,"onUpdate:modelValue":m[5]||(m[5]=g=>i.value=g),title:"Create Note"},{default:l(()=>[t(Dn,{modelValue:i.value,"onUpdate:modelValue":m[3]||(m[3]=g=>i.value=g),note:u.value,"onUpdate:note":m[4]||(m[4]=g=>u.value=g),convention:v.convention,title:"Create Note",onSaved:U},null,8,["modelValue","note","convention"])]),_:1},8,["modelValue"]),t(_t,{modelValue:r.value,"onUpdate:modelValue":m[7]||(m[7]=g=>r.value=g),title:"Note Configuration"},{default:l(()=>[t(pn,{convention:v.convention,onClose:m[6]||(m[6]=g=>r.value=!1)},null,8,["convention"])]),_:1},8,["modelValue"])],64))}}),yn=j({__name:"StripeRefundPayment",props:J({paymentTransaction:{}},{modelValue:{type:Boolean,required:!0},modelModifiers:{}}),emits:J(["refunded"],["update:modelValue"]),setup(e,{emit:c}){const o=te(e,"modelValue"),i=c,r=Ae(),f=E(!1),A=E("");let u=0;if(e.paymentTransaction.Data&&e.paymentTransaction.Data.PaymentIntent&&typeof e.paymentTransaction.Data.PaymentIntent=="object"){const m=e.paymentTransaction.Data.PaymentIntent;m&&(u=m.amount)}const a=E({Amount:u/100,Description:"",Reason:""}),s=E([{title:"Duplicate",value:"duplicate"},{title:"Fraudulent",value:"fraudulent"},{title:"Requested By Customer",value:"requested_by_customer"}]),d=E(!1);async function U(m){m.preventDefault(),d.value=!0,r.refundStripePayment(e.paymentTransaction.PaymentTransactionUUID,a.value).then(g=>{g?i("refunded",g):v("An unexpected error occurred.")}).catch(g=>{v("An error occurred processing the refund: "+g.toString())}),d.value=!1}const v=m=>{A.value=m,f.value=!0};return(m,g)=>(n(),D(Fe,{modelValue:o.value,"onUpdate:modelValue":g[7]||(g[7]=S=>o.value=S),title:"Refund a Stripe Payment",color:"blue-darken-4",persistent:""},{default:l(()=>[t(me,{class:"pa-0"},{default:l(()=>[t(Yl,{ref:"refundForm",id:"refund-form",onSubmit:g[4]||(g[4]=Lt(S=>U(S),["prevent"]))},{default:l(()=>[t(Q,null,{default:l(()=>[t(M,{cols:"12",sm:"6",md:"4",lg:"3",xl:"2"},{default:l(()=>[t(oe,{modelValue:a.value.Amount,"onUpdate:modelValue":g[0]||(g[0]=S=>a.value.Amount=S),modelModifiers:{number:!0},label:"Amount",prefix:"£",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),t(M,{cols:"12",sm:"6",md:"8",lg:"9",xl:"10"},{default:l(()=>[t(ve,{modelValue:a.value.Reason,"onUpdate:modelValue":g[1]||(g[1]=S=>a.value.Reason=S),modelModifiers:{number:!0},items:s.value,"item-title":"title","item-value":"value",label:"Stripe Refund Reason",variant:"outlined","hide-details":""},null,8,["modelValue","items"])]),_:1}),t(M,{cols:"12"},{default:l(()=>[t(oe,{modelValue:a.value.Description,"onUpdate:modelValue":g[2]||(g[2]=S=>a.value.Description=S),modelModifiers:{number:!0},label:"Refund Description",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1})]),_:1}),t(Q,null,{default:l(()=>[t(M,{class:"text-right",cols:"12",sm:"3",md:"2",lg:"2",xl:"1"},{default:l(()=>[t(q,{color:"error",class:"w-100",onClick:g[3]||(g[3]=S=>o.value=!1)},{default:l(()=>[R("Cancel")]),_:1})]),_:1}),t(Pe),t(M,{class:"text-left",cols:"12",sm:"3",md:"2",lg:"2",xl:"1"},{default:l(()=>[t(q,{type:"submit",color:"success",class:"w-100"},Je({default:l(()=>[R(" Issue Refund ")]),_:2},[d.value?{name:"prepend",fn:l(()=>[t(ga,{size:"20",indeterminate:""})]),key:"0"}:void 0]),1024)]),_:1})]),_:1})]),_:1},512)]),_:1}),t(Da,{modelValue:f.value,"onUpdate:modelValue":g[6]||(g[6]=S=>f.value=S)},{actions:l(()=>[t(q,{variant:"text",onClick:g[5]||(g[5]=S=>f.value=!1)},{default:l(()=>[R(" Close ")]),_:1})]),default:l(()=>[R(y(A.value)+" ",1)]),_:1},8,["modelValue"])]),_:1},8,["modelValue"]))}}),In=["colspan"],Cn=w("strong",null,"Details",-1),Rn=["innerHTML"],Ya=j({__name:"PaymentTransactions",props:{canEdit:{type:Boolean},expanded:{type:Boolean},hideHistory:{type:Boolean},updated:{},registration:{},showEditor:{type:Boolean}},emits:["close-editor","change"],setup(e,{emit:c}){const o=e;let{expanded:i=!0,hideHistory:r=!1,registration:f,showEditor:A}=o;const u=Ae(),a=E([]),s=E(i?["1"]:[]),d=E([]),U=E([{key:"CreatedAt",title:"Date"},{key:"Type",title:"Type"},{key:"Source",title:"Source"},{key:"Description",title:"Description"},{key:"Admin",title:"Admin"},{key:"Amount",title:"Amount"},{key:"Controls",title:""}]),v=E(!1),m=E(),g=E(!1),S=E(""),O=E([{key:"CreatedAt",order:"asc"}]),I=c,k=()=>({PaymentTransactionUUID:ye(),Amount:0,Data:{},Description:"",ID:0,RegistrationID:f.ID,RegistrationUUID:f.RegistrationUUID,Source:oa.PAYMENT_TRANSACTION_SOURCE_NULL,Type:Ft.PAYMENT_TRANSACTION_TYPE_NULL}),T=E(k()),{convertTransactions:B,getPaymentTransactionsDisplay:se}=Ea();fe(o,()=>{r=o.hideHistory,f=o.registration,A=o.showEditor,se(f.RegistrationUUID).then($=>{d.value=$})});const z=()=>{se(f.RegistrationUUID).then($=>{d.value=$})};z();const x=()=>{u.saveRegistrationPaymentTransaction(T.value).then($=>{$&&(B($.PaymentTransactions),T.value=k(),I("close-editor"),I("change"))})},le=$=>{const F=d.value.find(b=>b.PaymentTransactionUUID===$);F&&(m.value=F.PaymentTransaction,v.value=!0)},Y=$=>{if($)try{d.value=B($.PaymentTransactions),m.value=void 0,v.value=!1,S.value="Refund Processed",g.value=!0,I("change")}catch(F){console.error(F)}};return($,F)=>(n(),_(h,null,[p(A)?(n(),_(h,{key:0},[t(We,null,{default:l(()=>[R(" Add Transaction ")]),_:1}),t(Q,null,{default:l(()=>[t(M,{cols:"12",sm:"6"},{default:l(()=>[t(ve,{items:p(El),"item-title":"title","item-value":"value",label:"Transaction Type",clearable:!0,"hide-details":"",modelValue:T.value.Type,"onUpdate:modelValue":F[0]||(F[0]=b=>T.value.Type=b),variant:"outlined"},null,8,["items","modelValue"])]),_:1}),t(M,{cols:"12",sm:"6"},{default:l(()=>[t(ve,{items:p(gl),"item-title":"title","item-value":"value",label:"Source",clearable:!0,"hide-details":"",modelValue:T.value.Source,"onUpdate:modelValue":F[1]||(F[1]=b=>T.value.Source=b),variant:"outlined"},null,8,["items","modelValue"])]),_:1})]),_:1}),t(Q,null,{default:l(()=>[t(M,{cols:"12",sm:"8",md:"10"},{default:l(()=>[t(oe,{label:"Description","hide-details":"",modelValue:T.value.Description,"onUpdate:modelValue":F[2]||(F[2]=b=>T.value.Description=b),variant:"outlined"},null,8,["modelValue"])]),_:1}),t(M,{cols:"12",sm:"4",md:"2"},{default:l(()=>[t(oe,{label:"Amount","prepend-inner-icon":"mdi:mdi-currency-gbp","hide-details":"",modelValue:T.value.Amount,"onUpdate:modelValue":F[3]||(F[3]=b=>T.value.Amount=b),modelModifiers:{number:!0},variant:"outlined"},null,8,["modelValue"])]),_:1})]),_:1}),t(Q,null,{default:l(()=>[t(M,{cols:"12",sm:"3",md:"2",lg:"1"},{default:l(()=>[t(q,{class:"w-100",onClick:F[4]||(F[4]=b=>I("close-editor")),color:"warning"},{default:l(()=>[R("Cancel")]),_:1})]),_:1}),t(Pe),t(M,{cols:"12",sm:"6",md:"3",lg:"2",xl:"2"},{default:l(()=>[t(q,{class:"w-100",onClick:x,color:"primary"},{default:l(()=>[R("Submit Transaction")]),_:1})]),_:1})]),_:1})],64)):N("",!0),d.value.length&&!p(r)?(n(),D(It,{key:1,class:"my-2",modelValue:s.value,"onUpdate:modelValue":F[10]||(F[10]=b=>s.value=b)},{default:l(()=>[t(yt,{value:"1"},{default:l(()=>[t(St,null,{default:l(()=>[R(" Transaction History ")]),_:1}),t(Dt,null,{default:l(()=>[t(zt,{items:d.value,headers:U.value,"show-expand":!1,"item-value":"PaymentTransactionUUID",expanded:a.value,"onUpdate:expanded":F[5]||(F[5]=b=>a.value=b),"sort-by":O.value,"onUpdate:sortBy":F[6]||(F[6]=b=>O.value=b),class:"transactionTable"},{"item.Controls":l(({item:b})=>[$.canEdit&&b.PaymentTransaction&&b.PaymentTransaction.Source===p(oa).PAYMENT_TRANSACTION_SOURCE_STRIPE&&b.PaymentTransaction.Type===p(Ft).PAYMENT_TRANSACTION_TYPE_PAYMENT?(n(),D(q,{key:0,icon:"mdi:mdi-credit-card-refund",variant:"text",size:"xs",onClick:Z=>le(b.PaymentTransactionUUID)},null,8,["onClick"])):N("",!0)]),"expanded-row":l(({columns:b,item:Z})=>[w("tr",null,[w("td",{colspan:b.length},[Cn,w("div",{innerHTML:Z.Data},null,8,Rn)],8,In)])]),"footer.prepend":l(()=>[t(q,{"prepend-icon":"mdi:mdi-refresh",color:"primary",class:"mr-4",onClick:z},{default:l(()=>[R("Refresh")]),_:1})]),_:1},8,["items","headers","expanded","sort-by"]),v.value&&m.value?(n(),D(yn,{key:0,modelValue:v.value,"onUpdate:modelValue":F[7]||(F[7]=b=>v.value=b),"payment-transaction":m.value,onRefunded:Y},null,8,["modelValue","payment-transaction"])):N("",!0),t(Da,{modelValue:g.value,"onUpdate:modelValue":F[9]||(F[9]=b=>g.value=b)},{actions:l(()=>[t(q,{variant:"text",onClick:F[8]||(F[8]=b=>g.value=!1)},{default:l(()=>[R(" Close ")]),_:1})]),default:l(()=>[R(y(S.value)+" ",1)]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])):N("",!0)],64))}}),Vn=j({__name:"DataPanelRegistrationTags",props:J({registration:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(e){const c=te(e,"modelValue"),o=ue(()=>!c.value.Meta.Tags||!Array.isArray(c.value.Meta.Tags)||c.value.Meta.Tags.length===0?e.registration.Tags:e.registration.Tags.filter(i=>c.value.Meta.Tags.includes(i.TagUUID)));return(i,r)=>(n(),D(ka,null,{default:l(()=>[(n(!0),_(h,null,W(o.value,f=>(n(),D(Bt,{key:f.TagUUID},{default:l(()=>[R(y(f.Title),1)]),_:2},1024))),128))]),_:1}))}}),On=dt(Vn,[["__scopeId","data-v-8cc2c172"]]),Mn=(e,c)=>e===void 0?!1:gt(e,Et.GROUP_TYPE_CONVENTION,c.ConventionUUID,c).CheckIn;var ge=(e=>(e.CHECK_IN_STATUS_PENDING="CHECK_IN_STATUS_PENDING",e.CHECK_IN_STATUS_COMPLETED="CHECK_IN_STATUS_COMPLETED",e.CHECK_IN_STATUS_REJECTED="CHECK_IN_STATUS_REJECTED",e.CHECK_IN_STATUS_REVOKED="CHECK_IN_STATUS_REVOKED",e))(ge||{});const hn=[{title:"Pending",value:"CHECK_IN_STATUS_PENDING"},{title:"Completed",value:"CHECK_IN_STATUS_COMPLETED"},{title:"Rejected",value:"CHECK_IN_STATUS_REJECTED"},{title:"Revoked",value:"CHECK_IN_STATUS_REVOKED"}],je=e=>{var c;return((c=hn.find(o=>o.value===e))==null?void 0:c.title)||""},kn=w("span",{class:"font-weight-bold pr-2"},"Status:",-1),Nn={key:0,class:"text-green-darken-2"},bn={key:1,class:"text-yellow-darken-4"},Ln={key:2,class:"text-red-darken-4"},wn=w("br",null,null,-1),Fn=w("span",{class:"font-weight-bold pr-2"},"Status:",-1),Pn={key:0,class:"text-green-darken-2"},$n={key:1,class:"text-yellow-darken-4"},Bn={key:2,class:"text-red-darken-4"},Yn=w("span",null,"Not Checked In",-1),Yt=j({__name:"DataPanelCheckIn",props:J({convention:{},showControls:{type:Boolean,default:!1}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(e){const c=te(e,"modelValue"),o=Ae(),i=Xe(),r=Mn(i,e.convention),f=E([]),A=E(!1),u=E(!1),a=E(ge.CHECK_IN_STATUS_PENDING),s=E(""),d=S=>{A.value=!0,a.value=S},U=()=>{v()},v=()=>{o.getCheckInHistory(c.value.RegistrationUUID).then(S=>{S&&(f.value=S,u.value=!0,S.length&&(c.value.CheckIn=S[0]))}).catch(()=>{})},m=S=>{o.saveCheckIn(c.value.RegistrationUUID,a.value,s.value).then(O=>{O?(c.value.CheckIn=O,S&&(S("Check In Saved"),setTimeout(()=>{A.value=!1},500))):S&&S("Check In Failed")}).catch(()=>{S&&S("Check In Failed")})},g=ue(()=>{switch(a.value){case ge.CHECK_IN_STATUS_REVOKED:return"yellow-darken-4";case ge.CHECK_IN_STATUS_REJECTED:return"red-darken-4";case ge.CHECK_IN_STATUS_COMPLETED:return"green-darken-2"}return""});return(S,O)=>(n(),_(h,null,[S.showControls&&p(r)?(n(),D(me,{key:0,class:"px-0"},{default:l(()=>[t(Q,null,{default:l(()=>[t(M,null,{default:l(()=>[t(q,{color:"error",class:"w-100","prepend-icon":"mdi:mdi-window-close",onClick:O[0]||(O[0]=I=>d(p(ge).CHECK_IN_STATUS_REJECTED))},{default:l(()=>[R(" Reject ")]),_:1})]),_:1}),t(M,null,{default:l(()=>[t(q,{color:"warning",class:"w-100","prepend-icon":"mdi:mdi-window-close",onClick:O[1]||(O[1]=I=>d(p(ge).CHECK_IN_STATUS_REVOKED))},{default:l(()=>[R(" Revoke ")]),_:1})]),_:1}),t(M,null,{default:l(()=>[t(q,{color:"success",class:"w-100","prepend-icon":"mdi:mdi-check",onClick:O[2]||(O[2]=I=>d(p(ge).CHECK_IN_STATUS_COMPLETED))},{default:l(()=>[R(" Approve ")]),_:1})]),_:1})]),_:1}),t(Fe,{modelValue:A.value,"onUpdate:modelValue":O[4]||(O[4]=I=>A.value=I),color:g.value,fullscreen:!1,"hide-extension":!0,persistent:!1,scrollable:!1,"show-close-action":!0,"show-save-action":!0,"save-button-label":"Confirm",title:`${p(je)(a.value)} Check-In`,onSave:m},{default:l(()=>[t(ha,{modelValue:s.value,"onUpdate:modelValue":O[3]||(O[3]=I=>s.value=I),label:"Notes",variant:"outlined"},null,8,["modelValue"])]),_:1},8,["modelValue","color","title"])]),_:1})):N("",!0),c.value.CheckIn?(n(),D(me,{key:1,class:"px-0"},{default:l(()=>[t(Q,null,{default:l(()=>[t(M,null,{default:l(()=>[kn,c.value.CheckIn.Status===p(ge).CHECK_IN_STATUS_COMPLETED?(n(),_("span",Nn,y(p(je)(c.value.CheckIn.Status)),1)):c.value.CheckIn.Status===p(ge).CHECK_IN_STATUS_REVOKED?(n(),_("span",bn,y(p(je)(c.value.CheckIn.Status)),1)):c.value.CheckIn.Status===p(ge).CHECK_IN_STATUS_REJECTED?(n(),_("span",Ln,y(p(je)(c.value.CheckIn.Status)),1)):N("",!0),wn,t(q,{style:{"font-size":"0.75rem","text-transform":"none"},"append-icon":"mdi:mdi-chevron-down",size:"xs",variant:"text",onClick:U},{default:l(()=>[R("History")]),_:1})]),_:1}),t(M,{class:"text-right"},{default:l(()=>{var I;return[w("small",null,y((I=c.value.CheckIn.Admin)==null?void 0:I.DisplayName)+" "+y(p(At)(c.value.CheckIn.CreatedAt||"")),1)]}),_:1})]),_:1}),t(Fe,{modelValue:u.value,"onUpdate:modelValue":O[5]||(O[5]=I=>u.value=I),fullscreen:!1,"hide-extension":!0,persistent:!1,scrollable:!0,"show-close-action":!0,"show-save-action":!1,title:"Check-In History"},{default:l(()=>[t(we,null,{default:l(()=>[(n(!0),_(h,null,W(f.value,I=>(n(),D(be,{key:I.CheckInUUID},{default:l(()=>[t(Tt,null,{default:l(()=>[t(Q,null,{default:l(()=>[t(M,null,{default:l(()=>[Fn,I.Status===p(ge).CHECK_IN_STATUS_COMPLETED?(n(),_("span",Pn,y(p(je)(I.Status)),1)):I.Status===p(ge).CHECK_IN_STATUS_REVOKED?(n(),_("span",$n,y(p(je)(I.Status)),1)):I.Status===p(ge).CHECK_IN_STATUS_REJECTED?(n(),_("span",Bn,y(p(je)(I.Status)),1)):N("",!0)]),_:2},1024),t(M,{class:"text-right"},{default:l(()=>{var k;return[w("small",null,y((k=I.Admin)==null?void 0:k.DisplayName)+" "+y(p(At)(I.CreatedAt||"")),1)]}),_:2},1024)]),_:2},1024)]),_:2},1024),I.Details?(n(),D(Sl,{key:0},{default:l(()=>[R(y(I.Details),1)]),_:2},1024)):N("",!0)]),_:2},1024))),128))]),_:1})]),_:1},8,["modelValue"])]),_:1})):(n(),D(me,{key:2,class:"px-0"},{default:l(()=>[Yn]),_:1}))],64))}}),Gn=j({__name:"MetaDataItem",props:J({accommodations:{},convention:{},forms:{},interests:{},itemClass:{},tickets:{},venues:{}},{modelValue:{required:!0},modelModifiers:{},registration:{required:!0},registrationModifiers:{}}),emits:J(["openActions","showForm"],["update:modelValue","update:registration"]),setup(e,{emit:c}){const o=te(e,"modelValue"),i=te(e,"registration"),r=c,f=u=>{r("openActions",u)},A=(u,a,s)=>{r("showForm",u,a,s)};return(u,a)=>o.value.MetaField===p(G).META_DATA_SOURCE_ACCOMMODATION_ALLOCATION?(n(),D(Fa,{key:0,convention:u.convention,tickets:u.tickets,accommodations:u.accommodations,venues:u.venues,registration:i.value,forms:u.forms,modelValue:o.value,"onUpdate:modelValue":a[0]||(a[0]=s=>o.value=s),data:""},null,8,["convention","tickets","accommodations","venues","registration","forms","modelValue"])):o.value.MetaField===p(G).META_DATA_SOURCE_BADGE_DISPLAY?(n(),D(Qt,{key:1,"card-class":u.itemClass,registration:i.value,"show-title":!1},null,8,["card-class","registration"])):o.value.MetaField===p(G).META_DATA_SOURCE_EMAILS?(n(),D($a,{key:2,"allow-sending":!1,expanded:!1,"show-title":!1,registration:i.value,"text-class":"pa-0 ma-0"},null,8,["registration"])):o.value.MetaField===p(G).META_DATA_SOURCE_NOTES?(n(),D(Ba,{key:3,"allow-adding":!0,"card-class":u.itemClass,convention:u.convention,expanded:!1,registration:i.value,"show-control-panel":!1,"show-title":!1,"text-class":"pa-0 ma-0"},null,8,["card-class","convention","registration"])):o.value.MetaField===p(G).META_DATA_SOURCE_PAYMENT_STATUS?(n(),D(Xo,{key:4,registration:i.value},null,8,["registration"])):o.value.MetaField===p(G).META_DATA_SOURCE_PAYMENTS?(n(),D(Ya,{key:5,registration:i.value,expanded:!1},null,8,["registration"])):o.value.MetaField===p(G).META_DATA_SOURCE_REGISTRATION_ACTIONS?(n(),D(q,{key:6,icon:"mdi:mdi-briefcase",variant:"flat",onClick:a[1]||(a[1]=s=>f(i.value))})):o.value.MetaField===p(G).META_DATA_SOURCE_SUBMISSION_STATUS||o.value.MetaField===p(G).META_DATA_SOURCE_ACCOMMODATION_FORM||o.value.MetaField===p(G).META_DATA_SOURCE_ADMIN_FORM||o.value.MetaField===p(G).META_DATA_SOURCE_DEALER_FORM||o.value.MetaField===p(G).META_DATA_SOURCE_BADGE_FORM||o.value.MetaField===p(G).META_DATA_SOURCE_REGISTRATION_FORM?(n(),D(xo,{key:7,convention:u.convention,forms:u.forms,registration:i.value,onShowForm:A},null,8,["convention","forms","registration"])):o.value.MetaField===p(G).META_DATA_SOURCE_REGISTRATION_GROUP?(n(),D(Bo,{key:8,registration:i.value},null,8,["registration"])):o.value.MetaField===p(G).META_DATA_SOURCE_REGISTRATION_REFERENCE?(n(),_(h,{key:9},[R(y(i.value.Reference),1)],64)):o.value.MetaField===p(G).META_DATA_SOURCE_SUBMISSION_DATE?(n(),D(Yo,{key:10,registration:i.value},null,8,["registration"])):o.value.MetaField===p(G).META_DATA_SOURCE_TAGS?(n(),D(On,{key:11,registration:i.value,modelValue:o.value,"onUpdate:modelValue":a[2]||(a[2]=s=>o.value=s)},null,8,["registration","modelValue"])):o.value.MetaField===p(G).META_DATA_SOURCE_CHECKIN_CONTROL?(n(),D(Yt,{key:12,convention:u.convention,"show-controls":!0,modelValue:i.value,"onUpdate:modelValue":a[3]||(a[3]=s=>i.value=s)},null,8,["convention","modelValue"])):o.value.MetaField===p(G).META_DATA_SOURCE_CHECKIN_STATUS?(n(),D(Yt,{key:13,convention:u.convention,"show-controls":!1,modelValue:i.value,"onUpdate:modelValue":a[4]||(a[4]=s=>i.value=s)},null,8,["convention","modelValue"])):(n(),_(h,{key:14},[R(" Unhandled Meta Item "+y(o.value),1)],64))}}),xn=j({__name:"UserDataItem",props:J({accommodations:{},convention:{},forms:{},interests:{},itemClass:{},tickets:{},venues:{}},{modelValue:{required:!0},modelModifiers:{},registration:{required:!0},registrationModifiers:{}}),emits:["update:modelValue","update:registration"],setup(e){const c=te(e,"modelValue"),o=te(e,"registration"),i=pt(),r=ue(()=>i.GetProfileImageURL(o.value.UserUUID));return(f,A)=>c.value.UserField===p(ie).USER_DATA_SOURCE_TELEGRAM&&o.value.User.Handle?(n(),_(h,{key:0},[R(" @"+y(o.value.User.Handle),1)],64)):c.value.UserField===p(ie).USER_DATA_SOURCE_AVATAR?(n(),D(jt,{key:1,class:"rounded-circle",src:r.value,height:"32",width:"32"},null,8,["src"])):c.value.UserField===p(ie).USER_DATA_SOURCE_DATE_OF_BIRTH?(n(),_(h,{key:2},[R(y(p(Oe)(o.value.User.Additional.DOB,{withYear:!0,withDay:!1})),1)],64)):c.value.UserField===p(ie).USER_DATA_SOURCE_EMAIL?(n(),_(h,{key:3},[R(y(o.value.User.Additional.Email),1)],64)):c.value.UserField===p(ie).USER_DATA_SOURCE_FIRST_NAME?(n(),_(h,{key:4},[R(y(o.value.User.Additional.FirstName),1)],64)):c.value.UserField===p(ie).USER_DATA_SOURCE_LAST_NAME?(n(),_(h,{key:5},[R(y(o.value.User.Additional.LastName),1)],64)):(n(),_(h,{key:6},[R(" Unhandled User Field "+y(c.value),1)],64))}}),va=j({__name:"PanelItem",props:J({accommodations:{},convention:{},extras:{},forms:{},interests:{},itemClass:{},tickets:{},venues:{}},{modelValue:{required:!0},modelModifiers:{},registration:{required:!0},registrationModifiers:{}}),emits:J(["openActions","showForm"],["update:modelValue","update:registration"]),setup(e,{emit:c}){const o=te(e,"modelValue"),i=te(e,"registration"),r=c,f=u=>{r("openActions",u)},A=(u,a,s)=>{r("showForm",u,a,s)};return(u,a)=>o.value.SourceType===p(Le).LAYOUT_ITEM_SOURCE_FORM?(n(),D(wo,{key:0,accommodations:u.accommodations,convention:u.convention,extras:u.extras,forms:u.forms,interests:u.interests,"item-class":u.itemClass,tickets:u.tickets,venues:u.venues,modelValue:o.value,"onUpdate:modelValue":a[0]||(a[0]=s=>o.value=s),registration:i.value,"onUpdate:registration":a[1]||(a[1]=s=>i.value=s)},null,8,["accommodations","convention","extras","forms","interests","item-class","tickets","venues","modelValue","registration"])):o.value.SourceType===p(Le).LAYOUT_ITEM_SOURCE_META?(n(),D(Gn,{key:1,accommodations:u.accommodations,convention:u.convention,forms:u.forms,interests:u.interests,"item-class":u.itemClass,tickets:u.tickets,venues:u.venues,modelValue:o.value,"onUpdate:modelValue":a[2]||(a[2]=s=>o.value=s),registration:i.value,"onUpdate:registration":a[3]||(a[3]=s=>i.value=s),onOpenActions:f,onShowForm:A},null,8,["accommodations","convention","forms","interests","item-class","tickets","venues","modelValue","registration"])):o.value.SourceType===p(Le).LAYOUT_ITEM_SOURCE_USER?(n(),D(xn,{key:2,accommodations:u.accommodations,convention:u.convention,forms:u.forms,interests:u.interests,"item-class":u.itemClass,tickets:u.tickets,venues:u.venues,modelValue:o.value,"onUpdate:modelValue":a[4]||(a[4]=s=>o.value=s),registration:i.value,"onUpdate:registration":a[5]||(a[5]=s=>i.value=s)},null,8,["accommodations","convention","forms","interests","item-class","tickets","venues","modelValue","registration"])):N("",!0)}}),Hn=["onClick"],qn=["onClick"],Kn=j({__name:"PanelLayout",props:J({accommodations:{},convention:{},extras:{},forms:{},interests:{},tickets:{},venues:{}},{layout:{required:!0},layoutModifiers:{},modelValue:{required:!0},modelModifiers:{}}),emits:J(["openActions","showForm"],["update:layout","update:modelValue"]),setup(e,{emit:c}){const o=ml(),i=c,r=te(e,"layout"),f=te(e,"modelValue"),A=E({});r.value.Panels.forEach(U=>{A.value[U.LayoutPanelUUID]=!1});const u=U=>{i("openActions",U)},a=(U,v,m)=>{i("showForm",U,v,m)},s=U=>{switch(U.PanelStyle){case De.PANEL_STYLE_NAV_BOTTOM:return"bottom";case De.PANEL_STYLE_NAV_LEFT:return"left";case De.PANEL_STYLE_NAV_RIGHT:return"right";case De.PANEL_STYLE_NAV_TOP:return"top"}},d=(U,v=!1)=>{switch(U.PanelStyle){case De.PANEL_STYLE_NAV_BOTTOM:return v?"mdi:mdi-chevron-double-down":"mdi:mdi-chevron-double-up";case De.PANEL_STYLE_NAV_LEFT:return v?"mdi:mdi-chevron-double-left":"mdi:mdi-chevron-double-right";case De.PANEL_STYLE_NAV_RIGHT:return v?"mdi:mdi-chevron-double-right":"mdi:mdi-chevron-double-left";case De.PANEL_STYLE_NAV_TOP:return v?"mdi:mdi-chevron-double-up":"mdi:mdi-chevron-double-down"}};return(U,v)=>(n(),_(h,null,[(n(!0),_(h,null,W(r.value.Panels,m=>(n(),_(h,{key:m.LayoutPanelUUID},[s(m)!==void 0?(n(),D(Gl,{key:0,permanent:!0,location:s(m),border:p(o).smAndDown.value?1:0,rail:p(o).smAndDown.value&&!A.value[m.LayoutPanelUUID],"rail-width":"30",width:p(o).smAndDown.value?"100%":256},{default:l(()=>[p(o).smAndDown.value&&!A.value[m.LayoutPanelUUID]?(n(),_("h3",{key:0,class:Qe(`bg-secondary fill-height ${s(m)==="top"||s(m)==="bottom"?"px-3 text-right":"py-3 text-left"}`),style:{cursor:"pointer"},onClick:g=>A.value[m.LayoutPanelUUID]=!0},[t(Me,{icon:d(m,!1)},null,8,["icon"])],10,Hn)):(n(),_(h,{key:1},[w("h3",{class:"bg-secondary pa-3 d-flex",style:la(p(o).smAndDown.value?"cursor: pointer;":""),onClick:g=>A.value[m.LayoutPanelUUID]=!1},[R(y(m.Name)+" ",1),p(o).smAndDown.value?(n(),_(h,{key:0},[t(Pe),t(q,{icon:d(m,!0),variant:"plain",size:"sm"},null,8,["icon"])],64)):N("",!0)],12,qn),t(we,{class:"bg-panel",style:{height:"calc(100vh - 116px)"}},{default:l(()=>[(n(!0),_(h,null,W(m.Items,(g,S)=>(n(),D(be,{key:g.LayoutItemUUID},{default:l(()=>[m.Items.length>1?(n(),D(Tt,{key:0,class:"font-weight-bold"},{default:l(()=>[R(y(g.Label),1)]),_:2},1024)):N("",!0),t(va,{accommodations:U.accommodations,convention:U.convention,extras:U.extras,forms:U.forms,interests:U.interests,"item-class":"bg-panel border-0",tickets:U.tickets,venues:U.venues,modelValue:m.Items[S],"onUpdate:modelValue":O=>m.Items[S]=O,registration:f.value,onOpenActions:u,onShowForm:a},null,8,["accommodations","convention","extras","forms","interests","tickets","venues","modelValue","onUpdate:modelValue","registration"])]),_:2},1024))),128))]),_:2},1024)],64))]),_:2},1032,["location","border","rail","width"])):N("",!0)],64))),128)),t(xl,{class:"py-0"},{default:l(()=>[t(me,null,{default:l(()=>[t(Q,null,{default:l(()=>[(n(!0),_(h,null,W(r.value.Panels,m=>{var g,S,O,I,k,T;return n(),_(h,{key:m.LayoutPanelUUID},[m.PanelStyle===p(De).PANEL_STYLE_FLEX?(n(),D(M,{key:0,cols:((g=m.Meta.cols)==null?void 0:g.toString())||!1,xs:((S=m.Meta.cols_xs)==null?void 0:S.toString())||!1,sm:((O=m.Meta.cols_sm)==null?void 0:O.toString())||!1,md:((I=m.Meta.cols_md)==null?void 0:I.toString())||!1,lg:((k=m.Meta.cols_lg)==null?void 0:k.toString())||!1,xl:((T=m.Meta.cols_xl)==null?void 0:T.toString())||!1,class:"pa-0 pa-sm-2"},{default:l(()=>[t(me,{class:"bg-panel",style:la(p(o).smAndUp.value?"border-radius: 15px;":"")},{default:l(()=>[w("h3",null,y(m.Name),1),t(we,{class:"bg-panel"},{default:l(()=>[(n(!0),_(h,null,W(m.Items,(B,se)=>(n(),D(be,{key:B.LayoutItemUUID,class:"px-0"},{default:l(()=>[m.Items.length>1?(n(),D(Tt,{key:0,class:"font-weight-bold"},{default:l(()=>[R(y(B.Label),1)]),_:2},1024)):N("",!0),t(va,{accommodations:U.accommodations,convention:U.convention,extras:U.extras,forms:U.forms,interests:U.interests,"item-class":"bg-panel border-0",tickets:U.tickets,venues:U.venues,modelValue:m.Items[se],"onUpdate:modelValue":z=>m.Items[se]=z,registration:f.value,"onUpdate:registration":v[0]||(v[0]=z=>f.value=z),onOpenActions:u,onShowForm:a},null,8,["accommodations","convention","extras","forms","interests","tickets","venues","modelValue","onUpdate:modelValue","registration"])]),_:2},1024))),128))]),_:2},1024)]),_:2},1032,["style"])]),_:2},1032,["cols","xs","sm","md","lg","xl"])):N("",!0)],64)}),128))]),_:1})]),_:1})]),_:1})],64))}}),jn=j({__name:"DataTableItemPanel",props:J({accommodations:{},cardClass:{},convention:{},extras:{},forms:{},interests:{},tickets:{},venues:{},layouts:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:J(["openActions","showForm"],["update:modelValue"]),setup(e,{emit:c}){const o=E(),i=E(!1),r=s=>{o.value=s,i.value=!0},f=c,A=te(e,"modelValue"),u=s=>{f("openActions",s)},a=(s,d,U)=>{f("showForm",s,d,U)};return(s,d)=>(n(),_("div",null,[s.layouts?(n(),D(we,{key:0},{default:l(()=>[(n(!0),_(h,null,W(s.layouts,U=>(n(),D(be,{key:U.AdminLayoutUUID,class:"d-block pa-0 ma-0"},{default:l(()=>[t(Tt,{style:{"text-overflow":"inherit"},class:"overflow-visible text-wrap"},{default:l(()=>[t(q,{"prepend-icon":"mdi:mdi-page-layout-body",variant:"flat",onClick:v=>r(U)},{default:l(()=>[R(y(U.Name),1)]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024))),128))]),_:1})):N("",!0),i.value&&o.value?(n(),D(Fe,{key:1,modelValue:i.value,"onUpdate:modelValue":d[2]||(d[2]=U=>i.value=U),"hide-extension":!0,fullscreen:!0,title:`#${A.value.Reference} ${A.value.User.DisplayName} - ${o.value.Name} `,scrollable:!0,"card-class":"pa-0","card-style":"margin-bottom: -52px"},{default:l(()=>[t(Kn,{accommodations:s.accommodations,convention:s.convention,extras:s.extras,forms:s.forms,interests:s.interests,tickets:s.tickets,venues:s.venues,layout:o.value,"onUpdate:layout":d[0]||(d[0]=U=>o.value=U),modelValue:A.value,"onUpdate:modelValue":d[1]||(d[1]=U=>A.value=U),onOpenActions:u,onShowForm:a},null,8,["accommodations","convention","extras","forms","interests","tickets","venues","layout","modelValue"])]),_:1},8,["modelValue","title"])):N("",!0)]))}}),zn={class:"text-grey-lighten-1"},Qn={key:0,class:"text-blue text-center"},Jn={key:1,class:"text-red text-center"},Xn={key:2,class:"text-orange text-center"},Wn={key:3,class:"text-orange text-center"},Zn={key:4,class:"text-orange text-center"},ei={key:5,class:"text-orange text-center"},ti={key:6,class:"text-green text-center"},ai={key:0},li={key:0},oi=w("strong",null,"Total:",-1),ni=j({__name:"RegListRow",props:J({header:{},accommodations:{},convention:{},extras:{},forms:{},interests:{},item:{},tickets:{},user:{},venues:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:J(["openActions","openPayments","openTags","reload","showForm","switchUser"],["update:modelValue"]),setup(e,{emit:c}){const o=c,i=te(e,"modelValue"),r=(a,s,d)=>{o("showForm",{registration:a,form:s,submission:d})},f=a=>{o("openActions",a)},A=a=>{o("switchUser",a)},u=a=>{const s=i.value.registration;return{ID:0,SubmissionUUID:ye(),FormID:a.ID,FormUUID:a.FormUUID,Form:a,UserID:s.UserID,UserUUID:s.UserUUID,RegistrationID:s.ID,RegistrationUUID:s.RegistrationUUID,Registration:s,Data:[],Status:Sa.SUBMISSION_STATUS_NULL}};return(a,s)=>a.header.type==="ACCOMMODATION"&&a.accommodations.length>0&&a.item.raw[a.header.key]?(n(),D(Na,{key:0,value:a.item.raw[a.header.key].Data,accommodations:a.accommodations,convention:a.convention,forms:a.forms,tickets:a.tickets,venues:a.venues,registration:a.item.raw[a.header.key].Registration},null,8,["value","accommodations","convention","forms","tickets","venues","registration"])):a.header.type==="EXTRAS"&&a.extras.length>0?(n(),D(ba,{key:1,value:a.item.raw[a.header.key],extras:a.extras},null,8,["value","extras"])):a.header.type==="INTERESTS"&&a.interests.length>0?(n(),D(La,{key:2,value:a.item.raw[a.header.key],interests:a.interests},null,8,["value","interests"])):a.header.type==="TICKET"&&a.tickets.length>0?(n(),D(wa,{key:3,value:a.item.raw[a.header.key],tickets:a.tickets},null,8,["value","tickets"])):a.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_CHECKIN_STATUS"?(n(),D(Yt,{key:4,convention:a.convention,"show-controls":!1,modelValue:a.item.raw.registration,"onUpdate:modelValue":s[0]||(s[0]=d=>a.item.raw.registration=d)},null,8,["convention","modelValue"])):a.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_SUBMISSION_STATUS"||a.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_ACCOMMODATION_FORM"||a.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_ADMIN_FORM"||a.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_DEALER_FORM"||a.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_BADGE_FORM"||a.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_REGISTRATION_FORM"?(n(),_(h,{key:5},[w("ul",null,[(n(!0),_(h,null,W(a.forms.filter(d=>d.Type===p(_e).FORM_TYPE_ADMIN&&a.item.raw[a.header.key].findIndex(U=>U.Form.ID===d.ID)<0),d=>(n(),_("li",{key:d.Heading},[w("strong",zn,y(d.Heading),1),t(q,{class:"text-grey-lighten-1",icon:"mdi:mdi-form-select",title:"Edit Submitted Data",variant:"flat",onClick:U=>r(a.item.raw.registration,d,u(d))},null,8,["onClick"])]))),128))]),w("ul",null,[(n(!0),_(h,null,W(a.item.raw[a.header.key],d=>(n(),_("li",{key:d.Heading},[w("strong",null,[R(y(d.Heading),1),d.Form.Type!==p(_e).FORM_TYPE_ADMIN?(n(),_(h,{key:0},[R(": ")],64)):N("",!0)]),d.Form.Type!==p(_e).FORM_TYPE_ADMIN?(n(),_("span",{key:0,class:Qe(p(pa)(d.Submission.Status))},y(p(qt)(d.Submission.Status)),3)):N("",!0),t(q,{icon:"mdi:mdi-form-select",title:"Edit Submitted Data",variant:"flat",onClick:U=>r(d.Registration,d.Form,d.Submission)},null,8,["onClick"])]))),128))])],64)):a.header.type==="LAYOUT_ITEM_SOURCE_USER.USER_DATA_SOURCE_AVATAR"?(n(),D(jt,{key:6,class:"rounded-circle",src:a.item.raw[a.header.key],height:"32",width:"32"},null,8,["src"])):a.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_PAYMENT_STATUS"?(n(),_(h,{key:7},[a.item.raw[a.header.key]=="NOT_REQUIRED"?(n(),_("div",Qn,"No Payment Requested")):a.item.raw[a.header.key]=="MISSING_REQUIRED"?(n(),_("div",Jn,"Partner Payment Not Requested")):a.item.raw[a.header.key]=="AWAITING_PARTNER"?(n(),_("div",Xn,"Awaiting Partner Payment")):a.item.raw[a.header.key]=="ALL_REQUIRED"?(n(),_("div",Wn,"Awaiting Payments")):a.item.raw[a.header.key]=="REQUIRED"?(n(),_("div",Zn,"Awaiting Payment")):a.item.raw[a.header.key]=="ADDITIONAL_REQUIRED"?(n(),_("div",ei,"Awaiting Additional Payments")):(n(),_("div",ti,"Completed"))],64)):a.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_REGISTRATION_ACTIONS"?(n(),_(h,{key:8},[t(q,{icon:"mdi:mdi-briefcase",variant:"flat",onClick:s[1]||(s[1]=d=>f(a.item.raw[a.header.key]))}),p(ao)(a.user)?(n(),D(q,{key:0,icon:"mdi:mdi-account-switch-outline",variant:"flat",onClick:s[2]||(s[2]=d=>A(a.item.raw[a.header.key]))})):N("",!0)],64)):a.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_REGISTRATION_GROUP"?(n(),_(h,{key:9},[a.item.raw[a.header.key].length===1?(n(),_("em",ai," Not in a group ")):(n(),_(h,{key:1},[w("ul",null,[(n(!0),_(h,null,W(a.item.raw[a.header.key],d=>(n(),_("li",{key:d.UUID,class:"ml-0"},[R(" #"+y(d.Reference)+" : "+y(d.Name)+" ",1),d.IsLeader?(n(),_("strong",li,"(Leader)")):N("",!0)]))),128))]),oi,R(" "+y(a.item.raw[a.header.key].length),1)],64))],64)):a.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_DATA_LAYOUT"?(n(),_(h,{key:10},[i.value.registration?(n(),D(jn,{key:0,accommodations:a.accommodations,convention:a.convention,extras:a.extras,forms:a.forms,interests:a.interests,tickets:a.tickets,venues:a.venues,layouts:a.item.raw[a.header.key].Layouts,modelValue:i.value.registration,"onUpdate:modelValue":s[3]||(s[3]=d=>i.value.registration=d),onOpenActions:f,onShowForm:r},null,8,["accommodations","convention","extras","forms","interests","tickets","venues","layouts","modelValue"])):N("",!0)],64)):(n(),_(h,{key:11},[R(y(a.item.raw[a.header.key]),1)],64))}}),fa=j({__name:"RegistrationActionTabs",props:J({alignTabs:{},class:{},fixedTabs:{type:Boolean},showArrows:{type:[String,Boolean]},tabs:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(e){const c=e,o=te(e,"modelValue");return(i,r)=>(n(),D(Ia,ft({modelValue:o.value,"onUpdate:modelValue":r[0]||(r[0]=f=>o.value=f)},c),{default:l(()=>[(n(!0),_(h,null,W(i.tabs,f=>(n(),D(Ca,{value:f.value,key:f.value},{default:l(()=>[R(y(f.label),1)]),_:2},1032,["value"]))),128))]),_:1},16,["modelValue"]))}}),ii=(e=void 0,c)=>e===void 0?!1:gt(e,Et.GROUP_TYPE_CONVENTION,c.ConventionUUID,c).EditPaymentTransactions,Ct=e=>(Gt("data-v-861debd5"),e=e(),xt(),e),si={class:"mb-4"},ui={class:"v-row"},ri={key:0,class:"v-col v-col-10 py-1 v-row mx-0 pl-0"},di={class:"v-col v-col-12 v-col-sm-4 v-col-md-3 font-weight-bold pb-0 pr-0"},mi={class:"v-col v-col-12 v-col-sm-8 v-col-md-9 font-italic pt-0 pt-sm-3 pb-sm-0 pl-sm-0"},ci={class:"v-col v-col-2 align-self-end text-right py-1 text-no-wrap"},vi=Ct(()=>w("dt",{class:"v-col v-col-9 py-1 font-weight-bold totals"}," Total Charges ",-1)),fi={class:"v-col v-col-3 align-self-end text-right py-1 totals text-no-wrap"},Ui=Ct(()=>w("dt",{class:"v-col v-col-9 py-1 font-weight-bold"}," Applied Total ",-1)),Ai={class:"v-col v-col-3 align-self-end text-right py-1 text-no-wrap"},Ti=Ct(()=>w("dt",{class:"v-col v-col-9 py-1 font-weight-bold"}," Currently Paid ",-1)),_i={class:"v-col v-col-3 align-self-end text-right py-1 text-no-wrap"},Ei=Ct(()=>w("dt",{class:"v-col v-col-9 py-1 font-weight-bold totals"}," Balance ",-1)),gi={class:"v-col v-col-3 align-self-end text-right py-1 totals text-no-wrap"},pi=j({__name:"PaymentActions",props:J({forms:{},title:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(e){const c=E(!1),o=E(),i=E([]),r=E(new Date().getTime()),f=E(!1),A=te(e,"modelValue"),u=E(Ee(A.value));fe(A,()=>{u.value=Ee(A.value)});const a=Ae();a.getConvention(A.value.ConventionUUID).then(v=>{v&&(f.value=ii(Xe(),v))});const s=()=>{a.generateRegistrationCharges(A.value.RegistrationUUID,!1).then(v=>{v&&(i.value=v.PaymentTransactions,o.value=v.Registration,r.value=new Date().getTime())}).catch(()=>{})};s();const d=()=>{a.generateRegistrationCharges(A.value.RegistrationUUID,!0).then(v=>{v&&(i.value=v.PaymentTransactions,o.value=v.Registration,r.value=new Date().getTime())})},{totalCharges:U}=Ea();return(v,m)=>(n(),D($e,null,{default:l(()=>[t(ot,null,{default:l(()=>[t(We,null,{default:l(()=>[R(" Payments (#"+y(A.value.Reference)+" "+y(A.value.User.DisplayName)+") ",1)]),_:1})]),_:1}),t(Ze,null,{default:l(()=>[o.value?(n(),_(h,{key:0},[w("h3",si,"#"+y(o.value.Reference)+" "+y(o.value.User.DisplayName),1),w("dl",ui,[(n(!0),_(h,null,W(i.value,g=>(n(),_(h,{key:g.PaymentTransactionUUID},[g.Type===p(Ft).PAYMENT_TRANSACTION_TYPE_CHARGE?(n(),_("dt",ri,[w("div",di,y(g.Description.split(":")[0])+": ",1),w("div",mi,y(g.Description.split(":")[1]),1)])):N("",!0),w("dd",ci," £"+y(g.Amount),1)],64))),128)),vi,w("dd",fi," £"+y(p(U)(i.value)),1),Ui,w("dd",Ai," £"+y(o.value.Total),1),Ti,w("dd",_i," £"+y(o.value.Paid),1),Ei,w("dd",gi," £"+y(o.value.Total-o.value.Paid),1)]),t(Q,{class:"flex-row-reverse"},{default:l(()=>[t(M,{class:"text-right"},{default:l(()=>[t(q,{color:"primary",onClick:d},{default:l(()=>[R("Apply Charges")]),_:1})]),_:1}),!c.value&&f.value?(n(),D(M,{key:0},{default:l(()=>[t(q,{color:"secondary",onClick:m[0]||(m[0]=g=>c.value=!0)},{default:l(()=>[R("Transaction Entry")]),_:1})]),_:1})):N("",!0)]),_:1})],64)):N("",!0),t(Ya,{"can-edit":f.value,registration:A.value,"show-editor":c.value,onCloseEditor:m[1]||(m[1]=g=>c.value=!1),updated:r.value,onChange:s},null,8,["can-edit","registration","show-editor","updated"])]),_:1})]),_:1}))}}),Si=dt(pi,[["__scopeId","data-v-861debd5"]]),Di=j({__name:"RegistrationFormStatus",props:J({forms:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(e){const c=Ae(),o=te(e,"modelValue"),i=(r,f)=>{const A=o.value.Submissions.find(u=>u.SubmissionUUID==f);if(!A){r&&r("Submission not found");return}c.setSubmissionStatus(f,A.Status).then(u=>{u?(o.value.Submissions.forEach((a,s)=>{o.value.Submissions[s].Status=a.Status}),r&&r("Status Saved")):r&&r("Status not saved")}).catch(()=>{r&&r("Status not saved")})};return(r,f)=>(n(),D($e,null,{default:l(()=>[t(ot,null,{default:l(()=>[t(We,null,{default:l(()=>[R("Status (#"+y(o.value.Reference)+" "+y(o.value.User.DisplayName)+")",1)]),_:1})]),_:1}),t(Ze,null,{default:l(()=>[t(we,null,{default:l(()=>[(n(!0),_(h,null,W(o.value.Submissions,A=>(n(),D(be,{key:A.SubmissionUUID,class:"pa-0"},{default:l(()=>[t(Q,{class:"py-2 align-center"},{default:l(()=>[t(M,{cols:"9",sm:"10",md:"10",lg:"9"},{default:l(()=>{var u;return[t(ve,{modelValue:A.Status,"onUpdate:modelValue":a=>A.Status=a,items:p(na),"item-text":"title","item-value":"value",variant:"outlined","hide-details":"",label:((u=r.forms.find(a=>a.FormUUID==A.FormUUID))==null?void 0:u.Name)||""},{selection:l(()=>[t(Me,{class:"mr-4 d-none d-sm-inline"},{default:l(()=>{var a;return[R(y((a=p(na).find(s=>s.value===A.Status))==null?void 0:a.icon),1)]}),_:2},1024),R(" "+y(p(qt)(A.Status)),1)]),item:l(({item:a,props:{onClick:s}})=>[t(be,{title:a.title,"prepend-icon":a.raw.icon,onClick:s},null,8,["title","prepend-icon","onClick"])]),_:2},1032,["modelValue","onUpdate:modelValue","items","label"])]}),_:2},1024),t(M,{cols:"3",sm:"2",md:"2",lg:"1"},{default:l(()=>[t(rt,{class:"d-none d-sm-inline-flex",title:"Save","prepend-icon":"mdi:mdi-content-save",color:"warning",onClick:u=>i(u.callback,A.SubmissionUUID)},null,8,["onClick"]),t(rt,{class:"d-sm-none",size:"35",icon:"mdi:mdi-content-save",color:"warning",onClick:u=>i(u.callback,A.SubmissionUUID)},null,8,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1}))}}),yi=e=>(Gt("data-v-a4024c39"),e=e(),xt(),e),Ii=yi(()=>w("p",null,"Any tags controlled through registration form fields will be reset when the applicable form is saved. If you don't know what you're doing here, don't touch!",-1)),Ci={class:"mb-4"},Ri=j({__name:"RegistrationTags",props:J({title:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(e){const c=Ae(),o=te(e,"modelValue"),i=E(Ee(o.value)),r=E(!1),f=E(i.value.Tags);fe(o,()=>{i.value=Ee(o.value)});const A=({callback:u})=>{const a=[],s=[];i.value.Tags.forEach(d=>{f.value.find(v=>v.TagUUID===d.TagUUID)||a.push(d.TagUUID)}),f.value.forEach(d=>{i.value.Tags.find(v=>d.TagUUID===v.TagUUID)||s.push(d.TagUUID)}),c.updateRegistrationTags(a,s,i.value.RegistrationUUID).then(d=>{d?u&&(u("Tags Saved"),o.value.Tags=d.Tags):u&&u("Error Saving Tags")}).catch(()=>{u&&u("Error Saving Tags")})};return(u,a)=>(n(),D($e,null,{default:l(()=>[t(ot,null,{default:l(()=>[t(We,null,{default:l(()=>[R("Tags (#"+y(i.value.Reference)+" "+y(i.value.User.DisplayName)+")",1)]),_:1})]),_:1}),t(Ze,null,{default:l(()=>[t(ql,{class:"my-4"},{default:l(()=>[t(Kl,null,{default:l(()=>[R("Caution")]),_:1}),Ii]),_:1}),w("h3",Ci,"#"+y(i.value.Reference)+" "+y(i.value.User.DisplayName),1),t(Ra,{modelValue:i.value.Tags,"onUpdate:modelValue":a[0]||(a[0]=s=>i.value.Tags=s),convention:i.value.ConventionUUID,"show-key":!0,chips:!0,"show-uuid":r.value},null,8,["modelValue","convention","show-uuid"])]),_:1}),t(Kt,{class:"px-4 align-start"},{default:l(()=>[t(wt,{label:"Show UUID",modelValue:r.value,"onUpdate:modelValue":a[1]||(a[1]=s=>r.value=s)},null,8,["modelValue"]),t(rt,{onClick:A,variant:"flat"})]),_:1})]),_:1}))}}),Vi=dt(Ri,[["__scopeId","data-v-a4024c39"]]),Ua=j({__name:"RegistrationActionWindows",props:J({accommodations:{},convention:{},extras:{},forms:{},interests:{},registration:{},tickets:{},venues:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:J(["update:registration"],["update:modelValue"]),setup(e,{emit:c}){const o=e,i=te(e,"modelValue"),f=mt(o,c,void 0,void 0,"registration");return(A,u)=>(n(),D(Va,{modelValue:i.value,"onUpdate:modelValue":u[3]||(u[3]=a=>i.value=a)},{default:l(()=>[t(ze,{value:"badges"},{default:l(()=>[i.value=="badges"?(n(),D(me,{key:0,class:"pa-0 mx-0",fluid:!0},{default:l(()=>[t(Qt,{convention:A.convention,registration:p(f)},null,8,["convention","registration"])]),_:1})):N("",!0)]),_:1}),t(ze,{value:"emails"},{default:l(()=>[i.value=="emails"?(n(),D(me,{key:0,class:"pa-0 mx-0",fluid:!0},{default:l(()=>[t($a,{registration:p(f)},null,8,["registration"])]),_:1})):N("",!0)]),_:1}),t(ze,{value:"notes"},{default:l(()=>[i.value=="notes"?(n(),D(me,{key:0,class:"pa-0 mx-0",fluid:!0},{default:l(()=>[t(Ba,{convention:A.convention,expanded:!1,registration:p(f)},null,8,["convention","registration"])]),_:1})):N("",!0)]),_:1}),t(ze,{value:"payments"},{default:l(()=>[i.value=="payments"?(n(),D(me,{key:0,class:"pa-0 mx-0",fluid:!0},{default:l(()=>[t(Si,{modelValue:p(f),"onUpdate:modelValue":u[0]||(u[0]=a=>ut(f)?f.value=a:null),forms:A.forms,title:"Registration Payments"},null,8,["modelValue","forms"])]),_:1})):N("",!0)]),_:1}),t(ze,{value:"status"},{default:l(()=>[i.value=="status"?(n(),D(me,{key:0,class:"pa-0 mx-0",fluid:!0},{default:l(()=>[t(Di,{modelValue:p(f),"onUpdate:modelValue":u[1]||(u[1]=a=>ut(f)?f.value=a:null),forms:A.forms},null,8,["modelValue","forms"])]),_:1})):N("",!0)]),_:1}),t(ze,{value:"tags"},{default:l(()=>[i.value=="tags"?(n(),D(me,{key:0,class:"pa-0 mx-0",fluid:!0},{default:l(()=>[t(Vi,{modelValue:p(f),"onUpdate:modelValue":u[2]||(u[2]=a=>ut(f)?f.value=a:null),title:"Registration Tags"},null,8,["modelValue"])]),_:1})):N("",!0)]),_:1})]),_:1},8,["modelValue"]))}}),Oi=(e,c)=>e===void 0?!1:gt(e,Et.GROUP_TYPE_CONVENTION,c.ConventionUUID,c).ViewPaymentTransactions,Mi={key:0},hi={key:1},Aa=j({__name:"RegistrationActions",props:J({accommodations:{},convention:{},extras:{},forms:{},interests:{},registration:{},tickets:{},title:{},useDialog:{type:Boolean},venues:{}},{modelValue:{type:Boolean,required:!0},modelModifiers:{}}),emits:J(["update:registration"],["update:modelValue"]),setup(e,{emit:c}){const o=e,i=te(e,"modelValue"),f=mt(o,c,void 0,void 0,"registration"),A=E("notes"),u=Xe(),a=[{label:"Badge",value:"badges"},{label:"Emails",value:"emails"},{label:"Notes",value:"notes"},{label:"Status",value:"status"},{label:"Tags",value:"tags"}];return Oi(u,o.convention)&&a.splice(2,0,{label:"Payments",value:"payments"}),(s,d)=>s.useDialog?(n(),_("div",Mi,[t(Fe,{modelValue:i.value,"onUpdate:modelValue":d[3]||(d[3]=U=>i.value=U),title:s.title,"show-close-action":!0,color:"primary","close-action-label":"Close",persistent:!0,"retain-focus":!1,scrollable:!0,fullscreen:"","card-class":"ma-0 pa-0"},{extension:l(()=>[t(fa,{modelValue:A.value,"onUpdate:modelValue":d[0]||(d[0]=U=>A.value=U),tabs:a,"show-arrows":!0},null,8,["modelValue"])]),default:l(()=>[t(Ua,{modelValue:A.value,"onUpdate:modelValue":d[1]||(d[1]=U=>A.value=U),registration:p(f),"onUpdate:registration":d[2]||(d[2]=U=>ut(f)?f.value=U:null),accommodations:s.accommodations,convention:s.convention,extras:s.extras,forms:s.forms,interests:s.interests,tabs:a,tickets:s.tickets,venues:s.venues},null,8,["modelValue","registration","accommodations","convention","extras","forms","interests","tickets","venues"])]),_:1},8,["modelValue","title"])])):(n(),_("div",hi,[t(fa,{modelValue:A.value,"onUpdate:modelValue":d[4]||(d[4]=U=>A.value=U),tabs:a,"show-arrows":!0},null,8,["modelValue"]),t(Ua,{modelValue:A.value,"onUpdate:modelValue":d[5]||(d[5]=U=>A.value=U),registration:p(f),"onUpdate:registration":d[6]||(d[6]=U=>ut(f)?f.value=U:null),accommodations:s.accommodations,convention:s.convention,extras:s.extras,forms:s.forms,interests:s.interests,tabs:a,tickets:s.tickets,venues:s.venues},null,8,["modelValue","registration","accommodations","convention","extras","forms","interests","tickets","venues"])]))}}),ki=(e,c=500,o=!1)=>{let i;return(...r)=>{const A=function(){i=void 0,o||e.apply(void 0,r)},u=o&&!i;clearTimeout(i),i=setTimeout(A,c),u&&e.apply(void 0,r)}},Ga=(e,c)=>{e.forEach(o=>{o.Items.forEach(i=>{(i.SectionField==null||i.SectionField.Field==null)&&c.find(r=>{r.Sections.find(f=>{if(f.Fields){const A=f.Fields.find(u=>u.SectionFieldUUID===i.SectionFieldUUID);if(A)return i.SectionField=A,!0}})})})})},Ni=w("h4",null,"Grid Size (Max 12)",-1),bi={key:0,class:"text-warning text-right pl-1"},Li=j({__name:"EditAdminLayout",props:J({convention:{},layouts:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:J(["change","delete"],["update:modelValue"]),setup(e,{emit:c}){const o=te(e,"modelValue"),i=E([]),r=Ae(),f=c,A=E(Object.assign({},...e.layouts.map(S=>S.Panels.map(O=>O.Items.map(I=>{if(!I.Meta)return{};const k={};return Object.entries(I.Meta).forEach(T=>{Array.isArray(T[1])?(k[`${I.LayoutItemUUID}.${T[0]}`]=[],T[1].forEach(B=>{k[`${I.LayoutItemUUID}.${T[0]}`].push(B.toString())})):T[1]!==void 0&&T[1]!==null&&(k[`${I.LayoutItemUUID}.${T[0]}`]=[T[1].toString()])}),k}))).flat(2))),u=E(`
Are you sure you wish to delete this layout? All panels relating to it will be
removed and can not be recovered. This action can not be undone once saved.
You will have to create a new layout.
`),a=E(!1),s=E([]);r.getConventionTags(e.convention.ConventionUUID).then(S=>{S&&(s.value=S)}).catch(()=>{});const d=()=>({ID:0,LayoutPanelUUID:ye(),AdminLayoutID:o.value.ID,AdminLayoutUUID:o.value.AdminLayoutUUID,Name:"",Order:o.value.Panels.length+1,Items:[],PanelStyle:De.PANEL_STYLE_FLEX,RequiredFormType:_e.FORM_TYPE_NIL,RequiredGroupMemberships:[],RequiredRegistrationTags:[],Meta:{}}),U=S=>()=>({ID:0,LayoutItemUUID:ye(),LayoutPanelID:S.ID,LayoutPanelUUID:S.LayoutPanelUUID,Label:"",SourceType:Le.LAYOUT_ITEM_SOURCE_FORM,SectionFieldID:void 0,SectionFieldUUID:void 0,SectionField:void 0,MetaField:void 0,UserField:void 0,Align:"",Order:S.Items.length+1,DefaultSort:!1,Meta:{}}),v=(S,O)=>{S.Meta[O]=A.value[`${S.LayoutItemUUID}.${O}`]},m=S=>{const O=i.value.find(I=>I.value===S.SectionFieldUUID);O&&(S.SectionFieldID=O.object.ID,S.SectionField=O.object)};r.getConventionForms(o.value.ConventionUUID).then(S=>{S&&(S.forEach(O=>O.Sections.forEach(I=>I.Fields&&i.value.push(...I.Fields.map(k=>{var B;return{title:`${O.Name} - ${I.Name} - ${(B=k.Field)==null?void 0:B.Name}`,value:k.SectionFieldUUID,object:k}})))),i.value.sort(Al("title")),Ga(o.value.Panels,S))});const g=ue(()=>{switch(o.value.Type){case Ne.ADMIN_LAYOUT_PANELS:return"Panels";case Ne.ADMIN_LAYOUT_TABLE:return"Tabs"}return"Unknown"});return fe(o,()=>{f("change")},{deep:!0}),(S,O)=>(n(),D(me,{class:"px-0 mx-0",fluid:!0},{default:l(()=>[t(Q,null,{default:l(()=>[t(M,{cols:"12",sm:"6"},{default:l(()=>[t(oe,{modelValue:o.value.Name,"onUpdate:modelValue":O[0]||(O[0]=I=>o.value.Name=I),label:"Name",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),t(M,{cols:"12",sm:"6"},{default:l(()=>[t(ve,{modelValue:o.value.Type,"onUpdate:modelValue":O[1]||(O[1]=I=>o.value.Type=I),label:"Layout Type",items:p(Jl),"item-title":"title","item-value":"value",variant:"outlined","hide-details":""},null,8,["modelValue","items"])]),_:1})]),_:1}),t(Q,null,{default:l(()=>[t(M,null,{default:l(()=>[t(Pt,{modelValue:o.value.Panels,"onUpdate:modelValue":O[2]||(O[2]=I=>o.value.Panels=I),"new-item":d,closeable:!1,title:g.value,label:"Name","slot-name-prefix":"panel"},Je({_:2},[W(o.value.Panels,(I,k)=>({name:`panel_${k}`,fn:l(()=>[t(me,{class:"px-0 mx-0",fluid:!0},{default:l(()=>[t(Q,null,{default:l(()=>[t(M,{cols:"12",sm:"6"},{default:l(()=>[t(oe,{modelValue:I.Name,"onUpdate:modelValue":T=>I.Name=T,label:"Name",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),o.value.Type===p(Ne).ADMIN_LAYOUT_PANELS?(n(),D(M,{key:0,cols:"12",sm:"6"},{default:l(()=>[t(ve,{modelValue:I.PanelStyle,"onUpdate:modelValue":T=>I.PanelStyle=T,items:p(Zl),clearable:!0,label:"Panel Style",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"])]),_:2},1024)):N("",!0),t(M,{cols:"12",sm:"6"},{default:l(()=>[t(ve,{modelValue:I.RequiredFormType,"onUpdate:modelValue":T=>I.RequiredFormType=T,items:p(_l),clearable:!0,label:"Required Form",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"])]),_:2},1024),t(M,{cols:"12",sm:"6"},{default:l(()=>[t(ya,{label:"Required Groups",variant:"outlined",modelValue:I.RequiredGroupMemberships,"onUpdate:modelValue":T=>I.RequiredGroupMemberships=T,convention:o.value.ConventionUUID,chips:"",clearable:"",hint:"Groups that a user must be in to see this panel. (Any one)"},null,8,["modelValue","onUpdate:modelValue","convention"])]),_:2},1024),t(M,{cols:"12",sm:"6"},{default:l(()=>[t(Ra,{label:"Registration Tags",variant:"outlined",modelValue:I.RequiredRegistrationTags,"onUpdate:modelValue":T=>I.RequiredRegistrationTags=T,convention:o.value.ConventionUUID,chips:"",clearable:"",hint:"Tags that a registration must have to appear in results. (Any one)"},null,8,["modelValue","onUpdate:modelValue","convention"])]),_:2},1024)]),_:2},1024),o.value.Type===p(Ne).ADMIN_LAYOUT_PANELS&&I.PanelStyle===p(De).PANEL_STYLE_FLEX?(n(),D(Q,{key:0},{default:l(()=>[t(M,{cols:"12",class:"py-0 my-0"},{default:l(()=>[Ni]),_:1}),t(M,{cols:"6",sm:"4",lg:"2"},{default:l(()=>[t(oe,{modelValue:I.Meta.cols,"onUpdate:modelValue":T=>I.Meta.cols=T,modelModifiers:{number:!0},clearable:!0,"hide-details":"",label:"Default",type:"number",min:"1",max:"12"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),t(M,{cols:"6",sm:"4",lg:"2"},{default:l(()=>[t(oe,{modelValue:I.Meta.cols_xs,"onUpdate:modelValue":T=>I.Meta.cols_xs=T,modelModifiers:{number:!0},clearable:!0,"hide-details":"",label:"XS",type:"number",min:"1",max:"12"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),t(M,{cols:"6",sm:"4",lg:"2"},{default:l(()=>[t(oe,{modelValue:I.Meta.cols_sm,"onUpdate:modelValue":T=>I.Meta.cols_sm=T,modelModifiers:{number:!0},clearable:!0,"hide-details":"",label:"SM",type:"number",min:"1",max:"12"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),t(M,{cols:"6",sm:"4",lg:"2"},{default:l(()=>[t(oe,{modelValue:I.Meta.cols_md,"onUpdate:modelValue":T=>I.Meta.cols_md=T,modelModifiers:{number:!0},clearable:!0,"hide-details":"",label:"MD",type:"number",min:"1",max:"12"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),t(M,{cols:"6",sm:"4",lg:"2"},{default:l(()=>[t(oe,{modelValue:I.Meta.cols_lg,"onUpdate:modelValue":T=>I.Meta.cols_lg=T,modelModifiers:{number:!0},clearable:!0,"hide-details":"",label:"LG",type:"number",min:"1",max:"12"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),t(M,{cols:"6",sm:"4",lg:"2"},{default:l(()=>[t(oe,{modelValue:I.Meta.cols_xl,"onUpdate:modelValue":T=>I.Meta.cols_xl=T,modelModifiers:{number:!0},clearable:!0,"hide-details":"",label:"XL",type:"number",min:"1",max:"12"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)):N("",!0)]),_:2},1024),t(Pt,{modelValue:I.Items,"onUpdate:modelValue":T=>I.Items=T,"new-item":U(I),closeable:!1,title:"Items",label:"Label","slot-name-prefix":"item"},Je({_:2},[W(I.Items,(T,B)=>({name:`item_${B}`,fn:l(()=>[t(me,{class:"px-0 mx-0",fluid:!0},{default:l(()=>{var se,z;return[t(Q,null,{default:l(()=>[t(M,{cols:"12",sm:"6"},{default:l(()=>[t(oe,{modelValue:T.Label,"onUpdate:modelValue":x=>T.Label=x,label:"Name",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024),t(Q,null,{default:l(()=>[t(M,{cols:"12",sm:"6"},{default:l(()=>[t(ve,{modelValue:T.SourceType,"onUpdate:modelValue":x=>T.SourceType=x,label:"Source Type",items:p(Xl),"item-title":"title","item-value":"value",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"])]),_:2},1024),t(M,{cols:"12",sm:"6"},{default:l(()=>[T.SourceType==="LAYOUT_ITEM_SOURCE_FORM"?(n(),D(ve,{key:0,modelValue:T.SectionFieldUUID,"onUpdate:modelValue":x=>T.SectionFieldUUID=x,label:"Form Data",items:i.value,"item-title":"title","item-value":"value",variant:"outlined","hide-details":"",onBlur:x=>m(T)},null,8,["modelValue","onUpdate:modelValue","items","onBlur"])):T.SourceType==="LAYOUT_ITEM_SOURCE_META"?(n(),D(ve,{key:1,modelValue:T.MetaField,"onUpdate:modelValue":x=>T.MetaField=x,label:"Miscellaneous Data",items:p(Wl),"item-title":"title","item-value":"value",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"])):T.SourceType==="LAYOUT_ITEM_SOURCE_USER"?(n(),D(ve,{key:2,modelValue:T.UserField,"onUpdate:modelValue":x=>T.UserField=x,label:"User Profile Data",items:p(eo),"item-title":"title","item-value":"value",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"])):N("",!0)]),_:2},1024)]),_:2},1024),S.layouts&&T.SourceType==="LAYOUT_ITEM_SOURCE_FORM"&&((z=(se=T.SectionField)==null?void 0:se.Field)==null?void 0:z.Type)===p(_a).TEXT?(n(),D(Q,{key:0},{default:l(()=>[t(M,{cols:"12",xs:"6",sm:"6",lg:"3"},{default:l(()=>[t(wt,{modelValue:T.Meta.DirectEdit,"onUpdate:modelValue":x=>T.Meta.DirectEdit=x,label:"Direct Edit","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),t(M,{cols:"12",xs:"6",sm:"6",lg:"3"},{default:l(()=>[t(ve,{modelValue:T.Meta.DirectEditPermission,"onUpdate:modelValue":x=>T.Meta.DirectEditPermission=x,label:"Minimum Permission Required",items:["View","Edit"],"hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)):N("",!0),S.layouts&&T.SourceType==="LAYOUT_ITEM_SOURCE_META"&&T.MetaField===p(G).META_DATA_SOURCE_DATA_LAYOUT?(n(),D(Q,{key:1},{default:l(()=>[t(M,{cols:"6",sm:"4",lg:"2"},{default:l(()=>[t(ve,{modelValue:A.value[`${T.LayoutItemUUID}.LayoutUUID`],"onUpdate:modelValue":[x=>A.value[`${T.LayoutItemUUID}.LayoutUUID`]=x,x=>v(T,"LayoutUUID")],clearable:!0,items:S.layouts.filter(x=>x.Type===p(Ne).ADMIN_LAYOUT_PANELS)||[],multiple:!0,label:"Data Display","item-title":"Name","item-value":"AdminLayoutUUID",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"])]),_:2},1024)]),_:2},1024)):N("",!0),S.layouts&&T.SourceType==="LAYOUT_ITEM_SOURCE_META"&&T.MetaField===p(G).META_DATA_SOURCE_TAGS?(n(),D(Q,{key:2},{default:l(()=>[t(M,{cols:"6",sm:"4",lg:"2"},{default:l(()=>[t(ve,{modelValue:A.value[`${T.LayoutItemUUID}.Tags`],"onUpdate:modelValue":[x=>A.value[`${T.LayoutItemUUID}.Tags`]=x,x=>v(T,"Tags")],clearable:!0,items:s.value||[],multiple:!0,label:"Tags to Display","item-title":"Title","item-value":"TagUUID",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"]),!A.value[T.LayoutItemUUID]||A.value[T.LayoutItemUUID].length===0?(n(),_("small",bi," Will show all tags ")):N("",!0)]),_:2},1024)]),_:2},1024)):N("",!0),o.value.Type===p(Ne).ADMIN_LAYOUT_TABLE&&(T.SourceType!==p(Le).LAYOUT_ITEM_SOURCE_META||T.MetaField!==p(G).META_DATA_SOURCE_DATA_LAYOUT)?(n(),D(Q,{key:3},{default:l(()=>[t(M,null,{default:l(()=>[t(wt,{modelValue:T.DefaultSort,"onUpdate:modelValue":x=>T.DefaultSort=x,label:"Default Sort","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)):N("",!0)]}),_:2},1024)])}))]),1032,["modelValue","onUpdate:modelValue","new-item"])])}))]),1032,["modelValue","title"])]),_:1})]),_:1}),t(Q,null,{default:l(()=>[t(M,null,{default:l(()=>[t(q,{onClick:O[3]||(O[3]=I=>a.value=!0),"prepend-icon":"mdi:mdi-delete",color:"red-darken-4"},{default:l(()=>[R("Delete Layout")]),_:1})]),_:1})]),_:1}),a.value?(n(),D(Oa,{key:0,modelValue:a.value,"onUpdate:modelValue":O[4]||(O[4]=I=>a.value=I),message:u.value,title:"Delete Layout",subtitle:"Removes this layout and all it's panels",onDelete:O[5]||(O[5]=I=>f("delete"))},null,8,["modelValue","message"])):N("",!0)]),_:1}))}}),wi=j({__name:"EditAdminLayouts",props:J({title:{},convention:{}},{modelValue:{type:Boolean,required:!0},modelModifiers:{}}),emits:J(["save"],["update:modelValue"]),setup(e,{emit:c}){const o=te(e,"modelValue"),i=c,r=E([]),f=E([]),A=E([]),u=Ae(),a=()=>({ID:0,AdminLayoutUUID:ye(),ConventionID:e.convention.ID,ConventionUUID:e.convention.ConventionUUID,Name:"New Layout",Type:Ne.ADMIN_LAYOUT_PANELS,Panels:[]}),s=()=>{let U=!1;[...new Set(A.value)].forEach(m=>{const g=r.value.findIndex(S=>S.AdminLayoutUUID===m);g<0||g>=r.value.length||(u.saveAdminLayout(r.value[g]).then(S=>{S&&r.value.splice(g,1,S)}).catch(()=>{}),U=!0)}),f.value.forEach(m=>{u.deleteAdminLayout(m).catch(()=>{})}),f.value=[],A.value=[],U&&i("save")},d=U=>{const v=r.value.findIndex(m=>m.AdminLayoutUUID===U.AdminLayoutUUID);v<0||v>=r.value.length||(r.value[v].ID>0&&f.value.push(U.AdminLayoutUUID),r.value.splice(v,1))};return u.getConventionAdminLayouts(e.convention.ConventionUUID).then(U=>{U&&(r.value=U)}).catch(()=>[]),(U,v)=>(n(),D(_t,{modelValue:o.value,"onUpdate:modelValue":v[2]||(v[2]=m=>o.value=m),scrollable:!0,"retain-focus":!0,persistent:!0,fullscreen:!0},{default:l(()=>[t(Pt,{modelValue:r.value,"onUpdate:modelValue":v[0]||(v[0]=m=>r.value=m),"new-item":a,closeable:!0,"show-delete":!1,"show-save":!0,"has-order":!1,title:U.title,label:"Name","slot-name-prefix":"panel",onClose:v[1]||(v[1]=m=>o.value=!1),onSave:s},Je({_:2},[W(r.value,(m,g)=>({name:`panel_${g}`,fn:l(()=>[t(me,{class:"px-0 mx-0",fluid:!0},{default:l(()=>[t(Q,null,{default:l(()=>[t(M,{cols:"12"},{default:l(()=>[t(Li,{modelValue:r.value[g],"onUpdate:modelValue":S=>r.value[g]=S,convention:U.convention,layouts:r.value,onChange:S=>A.value.push(m.AdminLayoutUUID),onDelete:S=>d(m)},null,8,["modelValue","onUpdate:modelValue","convention","layouts","onChange","onDelete"])]),_:2},1024)]),_:2},1024)]),_:2},1024)])}))]),1032,["modelValue","title"])]),_:1},8,["modelValue"]))}}),Fi=["colspan"],Pi={style:{opacity:"var(--v-medium-emphasis-opacity)"}},Cs=j({__name:"RegistrationsView",emits:["pageTitle"],setup(e,{emit:c}){var Zt;const o=pt();c("pageTitle","Registration Manager");const r=cl(),f=vl(),A=E(!0);let u=((Zt=r.params.convention)==null?void 0:Zt.toString())||"";const a=E({ID:0,ConventionUUID:ye(),OrganisationID:0,OrganisationUUID:Nt,Name:"New Convention",Description:"",DetailLink:"",Logo:"",Slug:"",Accommodation:[],Tickets:[],Extras:[],Interests:[],Visible:!1}),s=Ae(),d=fl.getInstance(),U=E([]),v=E({ID:0,AdminLayoutUUID:ye(),ConventionID:a.value.ID,ConventionUUID:a.value.ConventionUUID,Name:"Registration Table",Type:Ne.ADMIN_LAYOUT_TABLE,Panels:[]}),m=E([]),g=E([]),S=E([]),O=E([]),I=E([]),k=E([]),T=E(1),B=E(10),se=E([]),z=E(0),x=E(!1),le=E(""),Y=E(""),$=E(""),F=E(""),b=E({FieldUUID:"591c9bca-c78c-4e97-8aef-bc596ef472fb",Value:""}),Z=E({FieldUUID:"50189b21-6c55-4c99-a38f-7740a01ec4a4",Value:""}),ce=E({FieldUUID:"1523ef15-f2c3-46b9-a687-dcd7bc2c0a50",Value:""}),ne=E({FieldUUID:"926d43c6-a743-4ab7-bef2-060d762d37a9",Value:""}),pe=E(new Map([["591c9bca-c78c-4e97-8aef-bc596ef472fb",b.value],["50189b21-6c55-4c99-a38f-7740a01ec4a4",Z.value],["1523ef15-f2c3-46b9-a687-dcd7bc2c0a50",ce.value],["926d43c6-a743-4ab7-bef2-060d762d37a9",ne.value]])),et=E(""),tt=E(""),nt=E([]),Ce=E([]),Be=E([]),Ye=E([]),Ge=E([]),xe=E([]),Se=E(0),Ie=E(),He=E(!1),Jt=E(!1),xa=E(!1),ct=E(),Xt=E(),Rt=E(),at=E(!1),Ha=Xe(),Ue=ki(()=>{Y.value=Date.now().toString()});fe(le,V=>{const C=k.value.find(P=>P.uuid===V);if(C){const P=C.headers.find(L=>L.defaultSort===!0);P&&(se.value=[{key:P.key,order:"asc"}],nt.value=[{key:P.key,order:"asc"}])}}),fe(Se,V=>{V===8&&Wt()}),fe(et,()=>{Ue()}),fe(tt,()=>{Ue()});const qa=()=>{m.value=[],S.value=[],O.value=[],k.value=[];try{s.getConventionAdminLayoutByName(a.value.ConventionUUID,"Registration Table").then(V=>{Se.value+=1,V?v.value=V:(v.value.ConventionID=a.value.ID,v.value.ConventionUUID=a.value.ConventionUUID)})}catch{v.value.ConventionID=a.value.ID,v.value.ConventionUUID=a.value.ConventionUUID}try{s.getConventionAdminLayouts(a.value.ConventionUUID).then(V=>{Se.value+=1,V&&(S.value=V)})}catch{}try{s.getConventionForms(a.value.ConventionUUID).then(V=>{Se.value+=1,V&&(m.value=V)})}catch{}try{s.getConventionAccommodation(a.value.ConventionUUID).then(V=>{Se.value+=1,V&&(Ce.value=V)})}catch{}try{s.getConventionVenues(a.value.ConventionUUID).then(V=>{Se.value+=1,V&&(xe.value=V)})}catch{}try{s.getConventionExtras(a.value.ConventionUUID).then(V=>{Se.value+=1,V&&(Be.value=V)})}catch{}try{s.getConventionInterests(a.value.ConventionUUID).then(V=>{Se.value+=1,V&&(Ye.value=V)})}catch{}try{s.getConventionTickets(a.value.ConventionUUID).then(V=>{Se.value+=1,V&&(Ge.value=V)})}catch{}try{s.getConventionGroups(a.value.ConventionUUID).then(V=>{V&&(g.value=V.sort((C,P)=>C.Name.localeCompare(P.Name)))})}catch{}try{s.getConventionTags(a.value.ConventionUUID).then(V=>{V&&(I.value=V.sort((C,P)=>C.Title.localeCompare(P.Title)).map(C=>(C.Title=`${C.Title} [${C.Key}]`,C)))})}catch{}},Vt=({page:V,itemsPerPage:C,sortBy:P})=>{A.value=!0,T.value=V,se.value=P;const L=k.value.find(de=>de.uuid==le.value),Te=L==null?void 0:L.layout.Items;let re="",it="";if(P&&Te&&P.length>=1){const de=Te.find(Mt=>Mt.LayoutItemUUID==P[0].key);switch(it=P[0].order||"asc",de==null?void 0:de.MetaField){case G.META_DATA_SOURCE_ACCOMMODATION_FORM:re="submission.status";break;case G.META_DATA_SOURCE_BADGE_FORM:re="submission.status";break;case G.META_DATA_SOURCE_DEALER_FORM:re="submission.status";break;case G.META_DATA_SOURCE_REGISTRATION_FORM:re="submission.status";break;case G.META_DATA_SOURCE_REGISTRATION_REFERENCE:re="reference";break;case G.META_DATA_SOURCE_SUBMISSION_DATE:re="created";break;case G.META_DATA_SOURCE_SUBMISSION_STATUS:re="submission.status";break}switch(de==null?void 0:de.UserField){case ie.USER_DATA_SOURCE_DISPLAY_NAME:re="user.display_name";break;case ie.USER_DATA_SOURCE_EMAIL:re="user.email";break;case ie.USER_DATA_SOURCE_FIRST_NAME:re="user.firstname";break;case ie.USER_DATA_SOURCE_HANDLE:re="user.handle";break;case ie.USER_DATA_SOURCE_LAST_NAME:re="user.lastname";break}}try{const de={Direction:it,Limit:C,Offset:(V-1)*C,Order:re};L&&L.layout.RequiredRegistrationTags.length>0&&(de.PanelUUID=L==null?void 0:L.layout.LayoutPanelUUID),(L==null?void 0:L.layout.RequiredFormType)===_e.FORM_TYPE_ACCOMMODATION&&(de.Accommodation=!0),(L==null?void 0:L.layout.RequiredFormType)===_e.FORM_TYPE_BADGE&&(de.Badge=!0),(L==null?void 0:L.layout.RequiredFormType)===_e.FORM_TYPE_DEALER&&(de.Dealer=!0),(L==null?void 0:L.layout.RequiredFormType)===_e.FORM_TYPE_REGISTRATION&&(de.Registration=!0),de.GroupUUID=et.value||Nt,de.TagUUID=tt.value||Nt,de.Email=F.value,de.Reference=$.value,de.FieldValues=Array.from(pe.value.values());const Mt=Y.value;s.searchConventionRegistrations(a.value.ConventionUUID,de).then(ht=>{ht&&Mt===Y.value&&(z.value=ht.Total,O.value=ht.Registrations,k.value.forEach(kt=>{const el=kt.layout;kt.items=O.value.map(X=>{const vt=[];let he;X.Leader?he=X:he=X.Primary,vt.push({Name:he.User.DisplayName,UUID:he.UserUUID,UserUUID:he.User.UserUUID,IsLeader:!0,Reference:he.Reference,Paid:he.Paid,Total:he.Total}),vt.push(...he.Members.map(ke=>({Name:ke.User.DisplayName,UUID:ke.UserUUID,UserUUID:ke.User.UserUUID,IsLeader:!1,Reference:ke.Reference,Paid:ke.Paid,Total:ke.Total})));const ae={};return kt.headers.forEach(ke=>{var ea;const K=el.Items.find(st=>st.LayoutItemUUID===ke.key);if(K){if(K.SourceType==="LAYOUT_ITEM_SOURCE_FORM"&&K.SectionField)X.Submissions.forEach(st=>{const lt=st.Data.find(H=>H.SectionFieldUUID===K.SectionFieldUUID);if(lt){ke.type===_a.ACCOMMODATION?ae[K.LayoutItemUUID]={Data:lt.Data,Registration:X}:ae[K.LayoutItemUUID]=lt.Data;return}});else if(K.SourceType==="LAYOUT_ITEM_SOURCE_USER"&&K.UserField)switch(K.UserField){case ie.USER_DATA_SOURCE_AVATAR:ae[K.LayoutItemUUID]=o.GetProfileImageURL(X.UserUUID);break;case ie.USER_DATA_SOURCE_DISPLAY_NAME:ae[K.LayoutItemUUID]=X.User.DisplayName;break;case ie.USER_DATA_SOURCE_EMAIL:ae[K.LayoutItemUUID]=X.User.Additional.Email;break;case ie.USER_DATA_SOURCE_HANDLE:ae[K.LayoutItemUUID]=X.User.Handle;break;case ie.USER_DATA_SOURCE_DATE_OF_BIRTH:ae[K.LayoutItemUUID]=X.User.Additional.DOB;break;case ie.USER_DATA_SOURCE_FIRST_NAME:ae[K.LayoutItemUUID]=X.User.Additional.FirstName;break;case ie.USER_DATA_SOURCE_LAST_NAME:ae[K.LayoutItemUUID]=X.User.Additional.LastName;break;case ie.USER_DATA_SOURCE_TELEGRAM:ae[K.LayoutItemUUID]="";break}else if(K.SourceType==="LAYOUT_ITEM_SOURCE_META"&&K.MetaField){const st=(ea=m.value.find(H=>H.Type===_e.FORM_TYPE_REGISTRATION))==null?void 0:ea.FormUUID,lt=X.Submissions.find(H=>H.FormUUID===st);switch(K.MetaField){case G.META_DATA_SOURCE_REGISTRATION_ACTIONS:ae[K.LayoutItemUUID]=X;break;case G.META_DATA_SOURCE_REGISTRATION_GROUP:ae[K.LayoutItemUUID]=vt;break;case G.META_DATA_SOURCE_REGISTRATION_REFERENCE:ae[K.LayoutItemUUID]=X.Reference;break;case G.META_DATA_SOURCE_SUBMISSION_DATE:if(lt){const H=new Date(lt.CreatedAt||"");ae[K.LayoutItemUUID]=`${H.getFullYear()}-${(H.getMonth()+1).toString().padStart(2,"0")}-${H.getDate().toString().padStart(2,"0")} ${H.getHours().toString().padStart(2,"0")}:${H.getMinutes().toString().padStart(2,"0")}:${H.getSeconds().toString().padStart(2,"0")}`}else{const H=new Date(X.CreatedAt||"");ae[K.LayoutItemUUID]=`${H.getFullYear()}-${(H.getMonth()+1).toString().padStart(2,"0")}-${H.getDate().toString().padStart(2,"0")} ${H.getHours().toString().padStart(2,"0")}:${H.getMinutes().toString().padStart(2,"0")}:${H.getSeconds().toString().padStart(2,"0")}`}break;case G.META_DATA_SOURCE_ACCOMMODATION_FORM:ae[K.LayoutItemUUID]=X.Submissions.map(H=>{const ee=m.value.find(Re=>Re.FormUUID===H.FormUUID);return{Heading:ee==null?void 0:ee.Heading,Form:ee,Submission:H,Registration:X}}).filter(H=>{var ee;return((ee=H.Form)==null?void 0:ee.Type)===_e.FORM_TYPE_ACCOMMODATION});break;case G.META_DATA_SOURCE_BADGE_FORM:ae[K.LayoutItemUUID]=X.Submissions.map(H=>{const ee=m.value.find(Re=>Re.FormUUID===H.FormUUID);return{Heading:ee==null?void 0:ee.Heading,Form:ee,Submission:H,Registration:X}}).filter(H=>{var ee;return((ee=H.Form)==null?void 0:ee.Type)===_e.FORM_TYPE_BADGE});break;case G.META_DATA_SOURCE_DEALER_FORM:ae[K.LayoutItemUUID]=X.Submissions.map(H=>{const ee=m.value.find(Re=>Re.FormUUID===H.FormUUID);return{Heading:ee==null?void 0:ee.Heading,Form:ee,Submission:H,Registration:X}}).filter(H=>{var ee;return((ee=H.Form)==null?void 0:ee.Type)===_e.FORM_TYPE_DEALER});break;case G.META_DATA_SOURCE_PAYMENT_STATUS:if(X.Paid===0&&X.Total)ae[K.LayoutItemUUID]="REQUIRED";else if(X.Total>X.Paid)ae[K.LayoutItemUUID]="ADDITIONAL_REQUIRED";else{const H=vt.find(ee=>ee.Paid===0&&(ee.Total||0)>0);if(H){X.Total===0&&H.Total===0?ae[K.LayoutItemUUID]="NOT_REQUIRED":X.Total===0&&H.Total||X.Total>0&&H.Total===0?ae[K.LayoutItemUUID]="MISSING_REQUIRED":X.Paid>=X.Total?ae[K.LayoutItemUUID]="AWAITING_PARTNER":ae[K.LayoutItemUUID]="ALL_REQUIRED";break}else X.Total===0?ae[K.LayoutItemUUID]="NOT_REQUIRED":ae[K.LayoutItemUUID]="COMPLETE"}break;case G.META_DATA_SOURCE_SUBMISSION_STATUS:Hl(X.Submissions,m.value),ae[K.LayoutItemUUID]=X.Submissions.map(H=>{const ee=m.value.find(Re=>Re.FormUUID===H.FormUUID);return{Heading:ee==null?void 0:ee.Heading,Form:ee,Submission:H,Registration:X}});break;case G.META_DATA_SOURCE_DATA_LAYOUT:ae[K.LayoutItemUUID]={Registration:X,Layouts:S.value.filter(H=>{if(K.Meta&&K.Meta.LayoutUUID&&Array.isArray(K.Meta.LayoutUUID))return H.Panels.forEach(ee=>{ee.Items.sort((Re,ta)=>Re.Order>ta.Order?1:Re.Order===ta.Order?0:-1)}),K.Meta.LayoutUUID.includes(H.AdminLayoutUUID)})};break}}}}),{key:X.RegistrationUUID,registration:X,...ae}})}),A.value=!1)})}catch{}},Ka=V=>{x.value=!1,V&&(v.value=V,Wt())},Wt=()=>{Ga(v.value.Panels,m.value),v.value.Panels.length>0&&(k.value=[],v.value.Panels.forEach(V=>{const C={uuid:ye(),order:V.Order,name:V.Name,headers:[],items:[],layout:V};V.Items.sort((P,L)=>P.Order>L.Order?1:P.Order==L.Order?0:-1),C.headers=V.Items.map(P=>{var L,Te;return{key:P.LayoutItemUUID,title:P.Label||((Te=(L=P.SectionField)==null?void 0:L.Field)==null?void 0:Te.Label)||"",align:P.Align==="end"?"end":"start",sortable:za(P),type:ja(P),defaultSort:P.DefaultSort,meta:P.Meta}}),k.value.push(C)}),k.value=k.value.sort((V,C)=>V.order>C.order?1:V.order==C.order?0:-1)),(le.value==null||le.value=="")&&k.value.length>0&&(le.value=k.value[0].uuid)};u?s.getConvention(u).then(V=>{V&&(a.value=V,v.value.ConventionID=a.value.ID,v.value.ConventionUUID=a.value.ConventionUUID,qa())}).catch(()=>{f.push("/")}):f.push("/");const ja=V=>{var C,P;if(V.SourceType===Le.LAYOUT_ITEM_SOURCE_META)return`${V.SourceType}.${V.MetaField}`;if(V.SourceType===Le.LAYOUT_ITEM_SOURCE_FORM)return(P=(C=V.SectionField)==null?void 0:C.Field)==null?void 0:P.Type;if(V.SourceType===Le.LAYOUT_ITEM_SOURCE_USER)return`${V.SourceType}.${V.UserField}`},za=V=>{const C=[G.META_DATA_SOURCE_ACCOMMODATION_FORM,G.META_DATA_SOURCE_BADGE_FORM,G.META_DATA_SOURCE_DEALER_FORM,G.META_DATA_SOURCE_REGISTRATION_FORM,G.META_DATA_SOURCE_REGISTRATION_REFERENCE,G.META_DATA_SOURCE_SUBMISSION_DATE,G.META_DATA_SOURCE_SUBMISSION_STATUS],P=[ie.USER_DATA_SOURCE_DISPLAY_NAME,ie.USER_DATA_SOURCE_EMAIL,ie.USER_DATA_SOURCE_HANDLE,ie.USER_DATA_SOURCE_DATE_OF_BIRTH,ie.USER_DATA_SOURCE_FIRST_NAME,ie.USER_DATA_SOURCE_LAST_NAME];return C.includes(V.MetaField)||P.includes(V.UserField)},Qa=V=>{Ie.value=V,He.value=!0},Ja=V=>{Ie.value=V,Jt.value=!0},Xa=V=>{Ie.value=V,xa.value=!0};fe(He,V=>{V||(Ie.value=void 0)}),fe(Jt,V=>{V||(Ie.value=void 0)});const Ot=async(V="")=>{Xt.value=await s.getRegistrationGroup(V)},Wa=({registration:V,form:C,submission:P})=>{Ie.value=V,Ot(V.RegistrationUUID).then(()=>{ct.value=C,Rt.value=P,at.value=!0})},Za=V=>{s.switchUser(V.UserUUID).then(C=>{C&&jl(C.tokens,C.user,f,!1)}).catch(C=>{console.error(C)})};return d.on("registration.group.leave",V=>{s.leaveRegistrationGroup(V).then(C=>{C&&Ot(V).then(()=>{d.emit("registration.group.left",C)})})}),d.on("registration.group.remove.member",V=>{s.leaveRegistrationGroup(V).then(C=>{C&&Ot(V).then(()=>{d.emit("registration.group.left",C)})})}),(V,C)=>(n(),D(Ql,null,{default:l(()=>[t($t,{color:"blue-darken-4"},{default:l(()=>[t(Ia,{modelValue:le.value,"onUpdate:modelValue":C[0]||(C[0]=P=>le.value=P),"show-arrows":""},{default:l(()=>[(n(!0),_(h,null,W(k.value,P=>(n(),D(Ca,{key:P.uuid,value:P.uuid},{default:l(()=>[R(y(P.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"]),t(Pe),t(q,{icon:"mdi:mdi-cog-outline",onClick:C[1]||(C[1]=P=>x.value=!0)})]),_:1}),t(Va,{modelValue:le.value,"onUpdate:modelValue":C[23]||(C[23]=P=>le.value=P),disabled:!0,touch:!1},{default:l(()=>[(n(!0),_(h,null,W(k.value,P=>(n(),D(ze,{key:P.uuid,value:P.uuid},{default:l(()=>[P.uuid===le.value?(n(),D($e,{key:0,class:"pa-2"},{default:l(()=>[t(oo,{expanded:U.value,"onUpdate:expanded":C[19]||(C[19]=L=>U.value=L),page:T.value,"onUpdate:page":C[20]||(C[20]=L=>T.value=L),"items-per-page":B.value,"onUpdate:itemsPerPage":C[21]||(C[21]=L=>B.value=L),"sort-by":nt.value,"onUpdate:sortBy":C[22]||(C[22]=L=>nt.value=L),headers:P.headers,"items-length":z.value,items:P.items,"item-value":"key",loading:A.value,search:Y.value,"onUpdate:options":Vt,"show-expand":""},Je({top:l(()=>[t(It,{class:"mb-3"},{default:l(()=>[t(yt,null,{default:l(()=>[t(St,{color:"secondary",class:"font-weight-bold pb-0 pt-0"},{default:l(()=>[t(M,{class:"pa-0"},{default:l(()=>[R(" Search Criteria "),t(Me,{class:"pl-5",icon:"mdi:mdi-credit-card-search-outline"})]),_:1}),t(M,{class:"d-none d-sm-block pa-0",cols:"0"},{default:l(()=>[t(oe,{modelValue:$.value,"onUpdate:modelValue":C[2]||(C[2]=L=>$.value=L),label:"Badge No.",clearable:!0,"hide-details":"",variant:"plain",onClick:C[3]||(C[3]=Lt(()=>{},["stop"])),"onClick:clear":p(Ue),onInput:p(Ue)},null,8,["modelValue","onClick:clear","onInput"])]),_:1}),t(M,{class:"d-none d-md-block pa-0"},{default:l(()=>[t(oe,{modelValue:b.value.Value,"onUpdate:modelValue":C[4]||(C[4]=L=>b.value.Value=L),label:"Furry Name",clearable:!0,"hide-details":"",variant:"plain",onClick:C[5]||(C[5]=Lt(()=>{},["stop"])),"onClick:clear":p(Ue),onInput:p(Ue)},null,8,["modelValue","onClick:clear","onInput"])]),_:1})]),_:1}),t(Dt,{class:"pt-2"},{default:l(()=>[t(Q,null,{default:l(()=>[t(M,{cols:"12",sm:"6",md:"3",lg:"2",xl:"1"},{default:l(()=>[R(y($.value)+" ",1),t(oe,{modelValue:$.value,"onUpdate:modelValue":C[6]||(C[6]=L=>$.value=L),label:"Badge No.",clearable:!0,"hide-details":"",variant:"outlined","onClick:clear":p(Ue),onInput:p(Ue)},null,8,["modelValue","onClick:clear","onInput"])]),_:1}),t(M,{cols:"12",sm:"6",md:"4",lg:"5",xl:"2"},{default:l(()=>[t(oe,{modelValue:b.value.Value,"onUpdate:modelValue":C[7]||(C[7]=L=>b.value.Value=L),label:"Furry Name",clearable:!0,"hide-details":"",variant:"outlined","onClick:clear":p(Ue),onInput:p(Ue)},null,8,["modelValue","onClick:clear","onInput"])]),_:1}),t(M,{cols:"12",sm:"12",md:"5",lg:"5",xl:"3"},{default:l(()=>[t(oe,{modelValue:F.value,"onUpdate:modelValue":C[8]||(C[8]=L=>F.value=L),label:"E-mail",clearable:!0,"hide-details":"",variant:"outlined","onClick:clear":p(Ue),onInput:p(Ue)},null,8,["modelValue","onClick:clear","onInput"])]),_:1}),t(M,{cols:"12",sm:"6",md:"4",lg:"4",xl:"2"},{default:l(()=>[t(oe,{modelValue:Z.value.Value,"onUpdate:modelValue":C[9]||(C[9]=L=>Z.value.Value=L),label:"Legal Forename",clearable:!0,"hide-details":"",variant:"outlined","onClick:clear":p(Ue),onInput:p(Ue)},null,8,["modelValue","onClick:clear","onInput"])]),_:1}),t(M,{cols:"12",sm:"6",md:"4",lg:"4",xl:"2"},{default:l(()=>[t(oe,{modelValue:ce.value.Value,"onUpdate:modelValue":C[10]||(C[10]=L=>ce.value.Value=L),label:"Legal Surname",clearable:!0,"hide-details":"",variant:"outlined","onClick:clear":p(Ue),onInput:p(Ue)},null,8,["modelValue","onClick:clear","onInput"])]),_:1}),t(M,{cols:"12",sm:"12",md:"4",lg:"4",xl:"2"},{default:l(()=>[t(oe,{modelValue:ne.value.Value,"onUpdate:modelValue":C[11]||(C[11]=L=>ne.value.Value=L),type:"date",label:"Date of Birth",clearable:!0,"hide-details":"",variant:"outlined","onClick:clear":p(Ue),onInput:p(Ue)},null,8,["modelValue","onClick:clear","onInput"])]),_:1}),t(M,{cols:"12",sm:"6",md:"6",lg:"6",xl:"6"},{default:l(()=>[t(ve,{modelValue:et.value,"onUpdate:modelValue":C[12]||(C[12]=L=>et.value=L),label:"Permission Groups",clearable:!0,"hide-details":"",variant:"outlined",items:g.value,"item-value":"GroupUUID","item-title":"Name"},null,8,["modelValue","items"])]),_:1}),t(M,{cols:"12",sm:"6",md:"6",lg:"6",xl:"6"},{default:l(()=>[t(ve,{modelValue:tt.value,"onUpdate:modelValue":C[13]||(C[13]=L=>tt.value=L),label:"Tags",clearable:!0,"hide-details":"",variant:"outlined",items:I.value,"item-value":"TagUUID","item-title":"Title"},null,8,["modelValue","items"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),"expanded-row":l(({columns:L,internalItem:Te})=>[w("tr",null,[w("td",{colspan:L.length},[t(Aa,{modelValue:He.value,"onUpdate:modelValue":C[15]||(C[15]=re=>He.value=re),registration:Te.raw.registration,"onUpdate:registration":re=>Te.raw.registration=re,accommodations:Ce.value,convention:a.value,extras:Be.value,forms:m.value,interests:Ye.value,tickets:Ge.value,title:`Registration Controls (#${Te.raw.registration.Reference} ${Te.raw.registration.User.DisplayName})`,"use-dialog":!1,venues:xe.value,style:{"max-width":"calc(100vw - 48px)"},class:"ml-auto mr-0"},null,8,["modelValue","registration","onUpdate:registration","accommodations","convention","extras","forms","interests","tickets","title","venues"])],8,Fi)])]),"item.data-table-expand":l(({internalItem:L})=>[U.value.findIndex(Te=>Te===L.key)>=0?(n(),D(q,{key:0,"append-icon":"mdi:mdi-chevron-up",size:"xs",variant:"flat",onClick:Te=>U.value.splice(U.value.findIndex(re=>re===L.key),1)},{default:l(()=>[L.raw.registration.Notes&&L.raw.registration.Notes.length>0?(n(),_(h,{key:0},[R(y(L.raw.registration.Notes.length),1)],64)):N("",!0)]),_:2},1032,["onClick"])):(n(),D(q,{key:1,"append-icon":"mdi:mdi-chevron-down",size:"xs",variant:"flat",onClick:Te=>U.value.push(L.key)},{default:l(()=>[L.raw.registration.Notes&&L.raw.registration.Notes.length>0?(n(),_(h,{key:0},[R(y(L.raw.registration.Notes.length),1)],64)):N("",!0)]),_:2},1032,["onClick"]))]),bottom:l(()=>[t(me,{fluid:!0},{default:l(()=>[t(Q,{class:"align-center"},{default:l(()=>[t(M,{cols:"12",lg:"7","order-lg":"3",xl:"8"},{default:l(()=>[t($l,{modelValue:T.value,"onUpdate:modelValue":C[16]||(C[16]=L=>T.value=L),length:Math.ceil(z.value/B.value)},null,8,["modelValue","length"])]),_:1}),t(M,{cols:"6",sm:"4",md:"2",lg:"2",xl:"1","order-lg":"1"},{default:l(()=>[t(ve,{modelValue:B.value,"onUpdate:modelValue":C[17]||(C[17]=L=>B.value=L),density:"compact","hide-details":"","item-title":"title","item-value":"value",label:"Items per page",min:"-1",max:"100",type:"number",variant:"outlined",items:[{title:"10",value:10},{title:"25",value:25},{title:"50",value:50},{title:"100",value:100},{title:"All",value:-1}]},null,8,["modelValue"])]),_:1}),t(M,{cols:"6",sm:"3",md:"2",lg:"1",xl:"1","order-lg":"2"},{default:l(()=>[t(oe,{modelValue:T.value,"onUpdate:modelValue":C[18]||(C[18]=L=>T.value=L),modelModifiers:{number:!0},density:"compact","hide-details":"",label:"Page",min:"1",max:Math.ceil(z.value/B.value),type:"number",variant:"outlined"},null,8,["modelValue","max"])]),_:1}),t(M,{class:"text-right",cols:"12",sm:"5",md:"8",lg:"2",xl:"2","order-lg":"4"},{default:l(()=>[w("span",Pi,[B.value===-1?(n(),_(h,{key:0},[R(" 1-"+y(z.value)+" of "+y(z.value),1)],64)):(n(),_(h,{key:1},[R(y((T.value-1)*B.value+1)+"-"+y(T.value*B.value>=z.value?z.value:T.value*B.value)+" of "+y(z.value),1)],64))])]),_:1})]),_:1})]),_:1})]),_:2},[W(P.headers,L=>({name:`item.${L.key}`,fn:l(({internalItem:Te,index:re})=>[t(ni,{header:L,item:Te,accommodations:Ce.value,convention:a.value,extras:Be.value,forms:m.value,interests:Ye.value,tickets:Ge.value,user:p(Ha),venues:xe.value,modelValue:P.items[re],"onUpdate:modelValue":it=>P.items[re]=it,onOpenActions:Qa,onOpenPayments:Ja,onOpenTags:Xa,onReload:C[14]||(C[14]=it=>Vt({page:T.value,itemsPerPage:B.value,sortBy:se.value})),onSwitchUser:Za,onShowForm:Wa},null,8,["header","item","accommodations","convention","extras","forms","interests","tickets","user","venues","modelValue","onUpdate:modelValue"])])}))]),1032,["expanded","page","items-per-page","sort-by","headers","items-length","items","loading","search"])]),_:2},1024)):N("",!0)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"]),x.value?(n(),D(wi,{key:0,title:"Edit Layouts",modelValue:x.value,"onUpdate:modelValue":C[24]||(C[24]=P=>x.value=P),convention:a.value,onSave:Ka},null,8,["modelValue","convention"])):N("",!0),Ie.value?(n(),_(h,{key:1},[He.value?(n(),D(Aa,{key:0,modelValue:He.value,"onUpdate:modelValue":C[25]||(C[25]=P=>He.value=P),registration:Ie.value,"onUpdate:registration":C[26]||(C[26]=P=>Ie.value=P),accommodations:Ce.value,convention:a.value,extras:Be.value,forms:m.value,interests:Ye.value,tickets:Ge.value,title:`Registration Controls (#${Ie.value.Reference} ${Ie.value.User.DisplayName})`,"use-dialog":!0,venues:xe.value},null,8,["modelValue","registration","accommodations","convention","extras","forms","interests","tickets","title","venues"])):N("",!0)],64)):N("",!0),at.value&&Rt.value&&ct.value?(n(),D(_t,{key:2,modelValue:at.value,"onUpdate:modelValue":C[30]||(C[30]=P=>at.value=P),scrollable:!0,fullscreen:!0,persistent:!0},{default:l(()=>[t($e,{class:"bg-red-darken-4"},{default:l(()=>[t($t,{color:"error"},{default:l(()=>[t(Ma,null,{default:l(()=>[R("Submission Editor - Admin Mode")]),_:1}),t(Pe),t(zl,null,{default:l(()=>[t(q,{icon:"mdi:mdi-window-close",onClick:C[27]||(C[27]=P=>at.value=!1)})]),_:1})]),_:1}),t(Ze,null,{default:l(()=>[t(Tl,{modelValue:ct.value,"onUpdate:modelValue":C[28]||(C[28]=P=>ct.value=P),admin:!0,convention:a.value,data:Rt.value,editable:!0,"registration-group":Xt.value,onClose:C[29]||(C[29]=P=>{at.value=!1,Vt({page:T.value,itemsPerPage:B.value,sortBy:se.value})})},null,8,["modelValue","convention","data","registration-group"])]),_:1})]),_:1})]),_:1},8,["modelValue"])):N("",!0)]),_:1}))}});export{Cs as default};
