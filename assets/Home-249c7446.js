import{i as j,M as ge,N as ye,j as Se,r as b,w as oe,n as e,q as l,v as t,f as r,x as a,z as he,y as h,A as S,O as Te,D as _,P as ae,k as ce,B as u,F as f,Q as q,C as c,p as ke,R as Ie,d as Ue,u as Ee,S as Ae,c as N,m as ee,l as te,G as De,H as be,_ as fe}from"./index-33cb343b.js";import{G as ne}from"./userData-a2936c04.js";import{_ as we}from"./LoginView.vue_vue_type_script_setup_true_lang-e53d1275.js";import{s as Q}from"./index-26b71cef.js";import{F as D}from"./form-3a7bf7fd.js";import{S as M,a as Ce}from"./submission-6136b51d.js";import{V as pe,u as Pe,a as Ve}from"./scopeId-975c80a4.js";import{c as W}from"./canEditForm-0574b4b5.js";import{s as Re}from"./sortSubmissions-4bc1d48e.js";import{P as K,a as Oe,f as Fe,h as de,u as Me}from"./useDisplayTransactions-3def2228.js";import{l as Ne}from"./stripe.esm-091597cd.js";import{_ as $e}from"./ModelDialog.vue_vue_type_script_setup_true_lang-1cbbca51.js";import{V as Le}from"./VAlert-a74a0ea6.js";import{V as Ye}from"./VForm-bcbf62b1.js";import{V as J,a as H}from"./VRow-5e237e9e.js";import{V as m,a as xe}from"./VBtn-fa63250a.js";import{a as se,u as Be}from"./VContainer-e59a5738.js";import{V as ze,m as Ge,a as me}from"./SaveButton.vue_vue_type_script_setup_true_lang-d829d1de.js";import{V as He}from"./VAvatar-97554375.js";import{V as X,a as ve,b as qe,c as Z,d as je,e as We}from"./VCard-b9e17e07.js";import{f as Ke}from"./forwardRefs-cc622295.js";import{V as Je,a as Qe,c as Xe,d as Ze}from"./VList-649db363.js";import"./emailFormVariant-e5e0aad4.js";import"./LoginButton-beaa6803.js";import"./createSimpleFunctional-9b9833fb.js";import"./VDialog-aaac471f.js";import"./VToolbar-93d0a800.js";import"./VDivider-6ad118e6.js";const et=_("p",{class:"my-4"},[a(" Payments are non-refundable, please check our "),_("a",{target:"_blank",href:"https://www.scotiacon.org.uk/policies"},"policies"),a(" for further information. ")],-1),tt=_("p",{class:"my-4"}," You must be over 18 to attend the convention and be able to produce valid ID matching the details on your registration. ",-1),ot=_("p",{class:"my-4"}," If you are unable to provide valid ID when asked at the convention you will not be issued your attendee badge. ",-1),at=_("p",{class:"my-4"}," Payments should be made by the authorised card holder only. ",-1),nt=_("p",{class:"my-4"},[a(" Please contact "),_("a",{href:"mailto:registration@scotiacon.org.uk"},"registration@scotiacon.org.uk"),a(" if you need any further assistance. ")],-1),st=_("div",{id:"link-authentication-element"},null,-1),lt=_("div",{id:"payment-element"},null,-1),it=j({__name:"StripePayment",props:ge({paymentTransactions:{},registration:{}},{modelValue:{type:Boolean,required:!0}}),emits:["update:modelValue"],setup(i){const T=ye(i,"modelValue"),k=ae(),U=ne(),v=Se(),n=b(),y=b(),E=b((U==null?void 0:U.Additional.Email)||""),V=b(!1),Y=b("");let F;const $=b(!1);oe(T,I=>{I&&k.stripePublicKey().then(async p=>{p&&(y.value=await Ne(p),await x(y.value))})});const B=I=>{Y.value=I,V.value=!0};async function x(I){var d;if(!I)return;const p=await k.stripePaymentIntent(((d=i.registration)==null?void 0:d.RegistrationUUID)||""),C={theme:"stripe"};v.current.value.dark&&(C.theme="night"),F=I.elements({clientSecret:p,appearance:C});const L=F.create("linkAuthentication",{defaultValues:{email:E.value}});L.mount("#link-authentication-element"),L.on("change",O=>{E.value=O.value.email});const o={layout:"tabs"};F.create("payment",o).mount("#payment-element")}async function z(I,p){if(!p)return;I.preventDefault(),$.value=!0;const C=new URL(location.href);C.pathname+="payment/stripe/processing";const{error:L}=await p.confirmPayment({elements:F,confirmParams:{return_url:C.toString(),receipt_email:E.value}});L.type==="card_error"||L.type==="validation_error"?B(L.message):B("An unexpected error occurred."),$.value=!1}return(I,p)=>(e(),l($e,{modelValue:T.value,"onUpdate:modelValue":p[4]||(p[4]=C=>T.value=C),title:"Make a Payment",color:"blue-darken-4",fullscreen:"",persistent:""},{default:t(()=>[r(se,{class:"pa-0"},{default:t(()=>[r(Le,{class:"mb-2",closable:!0},{title:t(()=>[a(" Payment Information ")]),text:t(()=>[et,tt,ot,at,nt]),_:1}),r(Ye,{ref_key:"paymentForm",ref:n,id:"payment-form",onSubmit:p[1]||(p[1]=he(C=>z(C,y.value),["prevent"]))},{default:t(()=>[r(J,null,{default:t(()=>[r(H,null,{default:t(()=>[st]),_:1})]),_:1}),r(J,null,{default:t(()=>[r(H,null,{default:t(()=>[lt]),_:1})]),_:1}),r(J,null,{default:t(()=>[I.registration?(e(),l(H,{key:0,class:"font-weight-bold text-right"},{default:t(()=>[a(" Payment Amount: £"+h(I.registration.Total-I.registration.Paid),1)]),_:1})):S("",!0)]),_:1}),r(J,null,{default:t(()=>[r(H,{class:"text-right",cols:"12",sm:"3",md:"2",lg:"2",xl:"1"},{default:t(()=>[r(m,{color:"error",class:"w-100",onClick:p[0]||(p[0]=C=>T.value=!1)},{default:t(()=>[a("Cancel")]),_:1})]),_:1}),r(pe),r(H,{class:"text-left",cols:"12",sm:"3",md:"2",lg:"2",xl:"1"},{default:t(()=>[r(m,{type:"submit",color:"success",class:"w-100"},Te({default:t(()=>[a(" Pay Now ")]),_:2},[$.value?{name:"prepend",fn:t(()=>[r(xe,{size:"20",indeterminate:""})]),key:"0"}:void 0]),1024)]),_:1})]),_:1})]),_:1},512)]),_:1}),r(ze,{modelValue:V.value,"onUpdate:modelValue":p[3]||(p[3]=C=>V.value=C)},{actions:t(()=>[r(m,{variant:"text",onClick:p[2]||(p[2]=C=>V.value=!1)},{default:t(()=>[a(" Close ")]),_:1})]),default:t(()=>[a(h(Y.value)+" ",1)]),_:1},8,["modelValue"])]),_:1},8,["modelValue"]))}}),rt={key:0},ut={key:1,class:"v-row"},ct={key:0,class:"v-col v-col-10 py-1 v-row mx-0 pl-0"},dt={class:"v-col v-col-12 v-col-sm-4 v-col-md-3 font-weight-bold pb-0 pr-0"},mt={class:"v-col v-col-12 v-col-sm-8 v-col-md-9 font-italic pt-0 pt-sm-3 pb-sm-0 pl-sm-0"},vt={key:1,class:"v-col v-col-10 py-1 v-row mx-0 pl-0"},ft={class:"v-col v-col-12 v-col-sm-4 v-col-md-3 font-weight-bold pb-0 pr-0"},pt={class:"v-col v-col-12 v-col-sm-8 v-col-md-9 font-italic pt-0 pt-sm-3 pb-sm-0 pl-sm-0"},_t={class:"v-col v-col-2 align-self-end text-right py-1 text-no-wrap"},gt=_("dt",{class:"v-col v-col-9 py-1 font-weight-bold totals"}," Total Charges ",-1),yt={class:"v-col v-col-3 align-self-end text-right py-1 totals text-no-wrap"},St=_("dt",{class:"v-col v-col-9 py-1 font-weight-bold"}," Current Payments ",-1),ht={class:"v-col v-col-3 align-self-end text-right py-1 text-no-wrap"},Tt=_("dt",{class:"v-col v-col-9 py-1 font-weight-bold totals"}," Balance Due ",-1),kt={class:"v-col v-col-3 align-self-end text-right py-1 totals text-no-wrap"},It=j({__name:"AttendeeTransactionList",props:{paymentTransactions:{},registration:{}},setup(i){const T=i,k=b(ce(T.paymentTransactions));oe(T,()=>{k.value=ce(T.paymentTransactions)});const U=(v,n)=>v.Type===K.PAYMENT_TRANSACTION_TYPE_CHARGE&&n.Type!==K.PAYMENT_TRANSACTION_TYPE_CHARGE?-1:v.Type!==K.PAYMENT_TRANSACTION_TYPE_CHARGE&&n.Type===K.PAYMENT_TRANSACTION_TYPE_CHARGE||(v.UpdatedAt||0)>(n.UpdatedAt||0)?1:v.UpdatedAt===n.UpdatedAt?0:-1;return(v,n)=>v.registration.Total==0?(e(),u("p",rt," Your registration is currently being processed, payment information will appear here when ready. ")):(e(),u("dl",ut,[(e(!0),u(f,null,q(k.value.sort(U),y=>{var E;return e(),u(f,{key:y.PaymentTransactionUUID},[y.Type===c(K).PAYMENT_TRANSACTION_TYPE_CHARGE?(e(),u("dt",ct,[_("div",dt,h(y.Description.split(":")[0]),1),_("div",mt,h(y.Description.split(":")[1]),1)])):(e(),u("dt",vt,[_("div",ft,h((E=c(Oe).find(V=>V.value===y.Type))==null?void 0:E.title),1),_("div",pt," [ "+h(c(Fe)(y.UpdatedAt||""))+" ] "+h(y.Description),1)])),_("dd",_t," £"+h(y.Amount),1)],64)}),128)),gt,_("dd",yt," £"+h(v.registration.Total),1),St,_("dd",ht," £"+h(v.registration.Paid),1),Tt,_("dd",kt," £"+h(v.registration.Total-v.registration.Paid),1)]))}});const Ut=ke({id:String,text:String,...Ie(Ge({closeOnBack:!1,location:"end",locationStrategy:"connected",eager:!0,minWidth:0,offset:10,openOnClick:!1,openOnHover:!0,origin:"auto",scrim:!1,scrollStrategy:"reposition",transition:!1}),["absolute","persistent"])},"VTooltip"),Et=Ue()({name:"VTooltip",props:Ut(),emits:{"update:modelValue":i=>!0},setup(i,T){let{slots:k}=T;const U=Ee(i,"modelValue"),{scopeId:v}=Pe(),n=Ae(),y=N(()=>i.id||`v-tooltip-${n}`),E=b(),V=N(()=>i.location.split(" ").length>1?i.location:i.location+" center"),Y=N(()=>i.origin==="auto"||i.origin==="overlap"||i.origin.split(" ").length>1||i.location.split(" ").length>1?i.origin:i.origin+" center"),F=N(()=>i.transition?i.transition:U.value?"scale-transition":"fade-transition"),$=N(()=>ee({"aria-describedby":y.value},i.activatorProps));return Be(()=>{const[B]=me.filterProps(i);return r(me,ee({ref:E,class:["v-tooltip",i.class],style:i.style,id:y.value},B,{modelValue:U.value,"onUpdate:modelValue":x=>U.value=x,transition:F.value,absolute:!0,location:V.value,origin:Y.value,persistent:!0,role:"tooltip",activatorProps:$.value,_disableGlobalStack:!0},v),{activator:k.activator,default:function(){var p;for(var x=arguments.length,z=new Array(x),I=0;I<x;I++)z[I]=arguments[I];return((p=k.default)==null?void 0:p.call(k,...z))??i.text}})}),Ke({},E)}}),_e=i=>(De("data-v-b71e674d"),i=i(),be(),i),At=["innerHTML"],Dt={key:0},bt={key:0,class:"font-weight-bold float-left pt-1 w-50"},wt={key:1,class:"pa-1"},Ct={key:0,class:"font-weight-bold float-left pt-1 w-50"},Pt={key:1},Vt={class:"font-weight-bold float-left pt-1 w-50"},Rt={class:"text-red-darken-4"},Ot={key:1,class:"text-red-darken-4 mt-4"},Ft=_e(()=>_("strong",null,"There are forms above that require completion, please edit and save them.",-1)),Mt=[Ft],Nt=_e(()=>_("br",null,null,-1)),$t=j({__name:"OpenConvention",props:{convention:{},forms:{default:()=>[]}},setup(i){const T=Ve(),k=ae(),{getPaymentTransactions:U}=Me(),v=b(T.GetConventionLogoURL(i.convention.ConventionUUID)),n=b(),y=b([]),E=b([]),V=b([]),Y=b(!1),F=b([]),$=N(()=>{var o;return W(i.forms,((o=n.value)==null?void 0:o.Submissions)||[],D.FORM_TYPE_REGISTRATION)}),B=N(()=>{var o;return W(i.forms,((o=n.value)==null?void 0:o.Submissions)||[],D.FORM_TYPE_DEALER)}),x=N(()=>{var o;return W(i.forms,((o=n.value)==null?void 0:o.Submissions)||[],D.FORM_TYPE_BADGE)}),z=N(()=>{var o;return W(i.forms,((o=n.value)==null?void 0:o.Submissions)||[],D.FORM_TYPE_ACCOMMODATION)}),I=N(()=>{var o;return W(i.forms,((o=n.value)==null?void 0:o.Submissions)||[],D.FORM_TYPE_ADDITIONAL)}),p=N(()=>{var o,g;return n.value&&((o=n.value)!=null&&o.Submissions)?!!((g=n.value)!=null&&g.Submissions.find(d=>{var O;return((O=d.Form)==null?void 0:O.Type)==D.FORM_TYPE_REGISTRATION&&(d.Status==M.SUBMISSION_STATUS_ACCEPTED||d.Status==M.SUBMISSION_STATUS_COMPLETED)})):!1}),C=async()=>{n.value&&"RegistrationUUID"in n.value&&k.getRegistrationAllocationPeriods(n.value.RegistrationUUID).then(o=>{o&&(E.value=[],y.value=o,y.value.sort((g,d)=>g.DateStart>d.DateStart?1:-1).forEach(g=>{var O;const d=E.value.find(w=>{var P;return w.name===((P=g.Accommodation)==null?void 0:P.Name)});if(d){const w=d.periods.find(s=>s.start===g.DateEnd),P=d.periods.find(s=>s.end===g.DateStart);w?w.start=g.DateStart:P?P.end=g.DateEnd:d.periods.push({start:g.DateStart,end:g.DateEnd})}else E.value.push({name:((O=g.Accommodation)==null?void 0:O.Name)||"",periods:[{start:g.DateStart,end:g.DateEnd}]})}))}).catch(()=>{})},L=()=>{k.getRegistrationByConvention(i.convention.ConventionUUID).then(o=>{var g;o&&(o.Submissions?(o.Submissions.forEach((d,O)=>{d.Form||(o.Submissions[O].Form=i.forms.find(w=>w.FormUUID===d.FormUUID))}),Re(o.Submissions)):o.Submissions=[],n.value=o,C(),p.value&&U(((g=n.value)==null?void 0:g.RegistrationUUID)||"").then(d=>{V.value=d}))})};return oe(()=>i.forms,()=>{L()}),L(),(o,g)=>{const d=te("router-link"),O=te("RouterLink");return e(),l(We,{class:"elevation-5 flex-1-0 d-flex flex-column"},{default:t(()=>[r(qe,{class:"flex-1-1 align-content-start"},{default:t(()=>[v.value?(e(),l(He,{key:0,src:v.value,title:o.convention.Name,class:"logo text-center"},null,8,["src","title"])):S("",!0),o.convention.Name?(e(),l(X,{key:1,class:"text-center"},{default:t(()=>[a(h(o.convention.Name),1)]),_:1})):S("",!0),o.convention.Description?(e(),l(ve,{key:2,class:"text-wrap subtitle"},{default:t(()=>[_("div",{innerHTML:o.convention.Description},null,8,At)]),_:1})):S("",!0)]),_:1}),r(Z,null,{default:t(()=>{var w,P;return[n.value?(e(),u("dl",Dt,[n.value.Reference?(e(),u("dt",bt," Badge No: ")):S("",!0),n.value.Reference?(e(),u("dd",wt," #"+h(n.value.Reference),1)):S("",!0),(e(!0),u(f,null,q((w=n.value)==null?void 0:w.Submissions,(s,R)=>{var G,le,ie,re,ue;return e(),u(f,{key:s.SubmissionUUID},[s.Form?(e(),u(f,{key:0},[s.Form?(e(),u("dt",Ct,h(s.Form.Heading),1)):S("",!0),s.Form?(e(),u("dd",Pt,[r(Et,{modelValue:F.value[R],"onUpdate:modelValue":A=>F.value[R]=A},{activator:t(({props:A})=>[r(m,ee(A,{color:"blue-darken-2",icon:"mdi:mdi-information",variant:"text",size:"xs",onClick:Ht=>F.value[R]=!F.value[R]}),null,16,["onClick"])]),default:t(()=>[s.Status===c(M).SUBMISSION_STATUS_NULL?(e(),u(f,{key:0},[a(" There is an error with your submission, please contact the registration team for support. ")],64)):s.Status===c(M).SUBMISSION_STATUS_INCOMPLETE?(e(),u(f,{key:1},[a(" Something is missing on your submission which requires completing to be able to process your request. Please contact the registration team for further advice. ")],64)):s.Status===c(M).SUBMISSION_STATUS_OPEN?(e(),u(f,{key:2},[a(" Your submission has been received by our system but you may still make changes before the registration team begins processing it. ")],64)):s.Status===c(M).SUBMISSION_STATUS_LOCKED?(e(),u(f,{key:3},[a(" We have locked your submission to prevent further changes whilst we process it. If you need to change something please get in touch. ")],64)):s.Status===c(M).SUBMISSION_STATUS_ACCEPTED?(e(),u(f,{key:4},[a(" We have locked your submission to prevent further changes whilst we process it. If you need to change something please get in touch. ")],64)):s.Status===c(M).SUBMISSION_STATUS_COMPLETED?(e(),u(f,{key:5},[a(" Congratulations everything is complete. If you need to make changes please get in touch. ")],64)):s.Status===c(M).SUBMISSION_STATUS_REJECTED?(e(),u(f,{key:6},[a(" Your request has been rejected. The registration team will provide an explanation. ")],64)):s.Status===c(M).SUBMISSION_STATUS_INVALID?(e(),u(f,{key:7},[a(" Your request has been identified as having errors or being incomplete. Please contact the registration team for additional support. ")],64)):s.Status===c(M).SUBMISSION_STATUS_CANCELLED?(e(),u(f,{key:8},[a(" Your submission has been cancelled. This may be at your request or another reason. The registration team will be able to provide further details. ")],64)):(e(),u(f,{key:9},[a(" Please contact the registration team for support. ")],64))]),_:2},1032,["modelValue","onUpdate:modelValue"]),a(" "+h(c(Ce)(s.Status))+" ",1),((G=s.Form)==null?void 0:G.Type)===c(D).FORM_TYPE_REGISTRATION?(e(),l(d,{key:0,to:`/register/${o.convention.Slug||o.convention.ConventionUUID}/registration`},{default:t(()=>{var A;return[(A=s.Form)!=null&&A.State.Edit&&$.value?(e(),l(m,{key:0,size:"small",variant:"text",color:"success"},{default:t(()=>[a(" Edit ")]),_:1})):(e(),l(m,{key:1,size:"small",variant:"text",color:"warning"},{default:t(()=>[a("View")]),_:1}))]}),_:2},1032,["to"])):((le=s.Form)==null?void 0:le.Type)===c(D).FORM_TYPE_ACCOMMODATION?(e(),l(d,{key:1,to:`/register/${o.convention.Slug||o.convention.ConventionUUID}/accommodation`},{default:t(()=>{var A;return[(A=s.Form)!=null&&A.State.Edit&&z.value?(e(),l(m,{key:0,size:"small",variant:"text",color:"success"},{default:t(()=>[a(" Edit ")]),_:1})):(e(),l(m,{key:1,size:"small",variant:"text",color:"warning"},{default:t(()=>[a("View")]),_:1}))]}),_:2},1032,["to"])):((ie=s.Form)==null?void 0:ie.Type)===c(D).FORM_TYPE_DEALER?(e(),l(d,{key:2,to:`/register/${o.convention.Slug||o.convention.ConventionUUID}/dealer`},{default:t(()=>{var A;return[(A=s.Form)!=null&&A.State.Edit&&B.value?(e(),l(m,{key:0,size:"small",variant:"text",color:"success"},{default:t(()=>[a(" Edit ")]),_:1})):(e(),l(m,{key:1,size:"small",variant:"text",color:"warning"},{default:t(()=>[a("View")]),_:1}))]}),_:2},1032,["to"])):((re=s.Form)==null?void 0:re.Type)===c(D).FORM_TYPE_BADGE?(e(),l(d,{key:3,to:`/register/${o.convention.Slug||o.convention.ConventionUUID}/badge`},{default:t(()=>{var A;return[(A=s.Form)!=null&&A.State.Edit&&I.value?(e(),l(m,{key:0,size:"small",variant:"text",color:"success"},{default:t(()=>[a(" Edit ")]),_:1})):(e(),l(m,{key:1,size:"small",variant:"text",color:"warning"},{default:t(()=>[a("View")]),_:1}))]}),_:2},1032,["to"])):((ue=s.Form)==null?void 0:ue.Type)===c(D).FORM_TYPE_ADDITIONAL?(e(),l(d,{key:4,to:`/register/${o.convention.Slug||o.convention.ConventionUUID}/additional`},{default:t(()=>{var A;return[(A=s.Form)!=null&&A.State.Edit&&I.value?(e(),l(m,{key:0,size:"small",variant:"text",color:"success"},{default:t(()=>[a(" Edit ")]),_:1})):(e(),l(m,{key:1,size:"small",variant:"text",color:"warning"},{default:t(()=>[a("View")]),_:1}))]}),_:2},1032,["to"])):S("",!0)])):S("",!0)],64)):S("",!0)],64)}),128)),((P=n.value)==null?void 0:P.Submissions.length)>=1?(e(!0),u(f,{key:2},q(o.forms,s=>{var R;return e(),u(f,{key:s.FormUUID},[(R=n.value)!=null&&R.Submissions.find(G=>G.FormUUID===s.FormUUID)?S("",!0):(e(),u(f,{key:0},[_("dt",Vt,h(s.Heading),1),_("dd",Rt,[a(" Requires Completion "),s.Type===c(D).FORM_TYPE_REGISTRATION?(e(),l(d,{key:0,to:`/register/${o.convention.Slug||o.convention.ConventionUUID}/registration`},{default:t(()=>[s.State.Edit&&$.value?(e(),l(m,{key:0,size:"small",variant:"text",color:"success"},{default:t(()=>[a(" Edit ")]),_:1})):(e(),l(m,{key:1,size:"small",variant:"text",color:"warning"},{default:t(()=>[a("View")]),_:1}))]),_:2},1032,["to"])):s.Type===c(D).FORM_TYPE_ACCOMMODATION?(e(),l(d,{key:1,to:`/register/${o.convention.Slug||o.convention.ConventionUUID}/accommodation`},{default:t(()=>[s.State.Edit&&z.value?(e(),l(m,{key:0,size:"small",variant:"text",color:"success"},{default:t(()=>[a(" Edit ")]),_:1})):(e(),l(m,{key:1,size:"small",variant:"text",color:"warning"},{default:t(()=>[a("View")]),_:1}))]),_:2},1032,["to"])):s.Type===c(D).FORM_TYPE_DEALER?(e(),l(d,{key:2,to:`/register/${o.convention.Slug||o.convention.ConventionUUID}/dealer`},{default:t(()=>[s.State.Edit&&B.value?(e(),l(m,{key:0,size:"small",variant:"text",color:"success"},{default:t(()=>[a(" Edit ")]),_:1})):(e(),l(m,{key:1,size:"small",variant:"text",color:"warning"},{default:t(()=>[a("View")]),_:1}))]),_:2},1032,["to"])):s.Type===c(D).FORM_TYPE_BADGE?(e(),l(d,{key:3,to:`/register/${o.convention.Slug||o.convention.ConventionUUID}/badge`},{default:t(()=>[s.State.Edit&&x.value?(e(),l(m,{key:0,size:"small",variant:"text",color:"success"},{default:t(()=>[a(" Edit ")]),_:1})):(e(),l(m,{key:1,size:"small",variant:"text",color:"warning"},{default:t(()=>[a("View")]),_:1}))]),_:2},1032,["to"])):s.Type===c(D).FORM_TYPE_ADDITIONAL?(e(),l(d,{key:4,to:`/register/${o.convention.Slug||o.convention.ConventionUUID}/additional`},{default:t(()=>[s.State.Edit&&I.value?(e(),l(m,{key:0,size:"small",variant:"text",color:"success"},{default:t(()=>[a(" Edit ")]),_:1})):(e(),l(m,{key:1,size:"small",variant:"text",color:"warning"},{default:t(()=>[a("View")]),_:1}))]),_:2},1032,["to"])):S("",!0)])],64))],64)}),128)):S("",!0)])):S("",!0),n.value&&n.value.Submissions.length>=1&&o.forms.filter(s=>{var R;return!((R=n.value)!=null&&R.Submissions.find(G=>G.FormUUID==s.FormUUID))}).length>0?(e(),u("div",Ot,Mt)):S("",!0)]}),_:1}),E.value.length>0?(e(),u(f,{key:0},[r(X,{class:"pb-0"},{default:t(()=>[a("Allocated Accommodation")]),_:1}),r(ve,{class:"text-wrap"},{default:t(()=>[a("The following accommodation has been allocated to your registration. In some cases this may not have been your first choice.")]),_:1}),r(Z,null,{default:t(()=>[r(Je,{density:"compact"},{default:t(()=>[(e(!0),u(f,null,q(E.value,w=>(e(),l(Qe,{key:w.name},{default:t(()=>[r(Xe,null,{default:t(()=>[a(h(w.name),1)]),_:2},1024),(e(!0),u(f,null,q(w.periods,P=>(e(),l(Ze,{key:P.start},{default:t(()=>[a(" ("+h(c(de)(P.start))+" - "+h(c(de)(P.end))+")",1),Nt]),_:2},1024))),128))]),_:2},1024))),128))]),_:1})]),_:1})],64)):S("",!0),p.value&&n.value?(e(),u(f,{key:1},[r(X,{class:"pb-4"},{default:t(()=>[a("Payment Information")]),_:1}),r(Z,null,{default:t(()=>[r(It,{"payment-transactions":V.value,registration:n.value},null,8,["payment-transactions","registration"])]),_:1})],64)):S("",!0),r(je,null,{default:t(()=>{var w,P;return[o.convention.DetailLink?(e(),l(m,{key:0,color:"orange",href:o.convention.DetailLink},{default:t(()=>[a(h(c(Q).buttonDetails),1)]),_:1},8,["href"])):S("",!0),r(pe),$.value?(e(),u(f,{key:1},[(w=n.value)!=null&&w.Submissions.find(s=>{var R;return((R=s.Form)==null?void 0:R.Type)===c(D).FORM_TYPE_REGISTRATION})?(e(),l(O,{key:1,to:`/register/${o.convention.Slug||o.convention.ConventionUUID}`},{default:t(()=>[r(m,{color:"primary"},{default:t(()=>[a(h(c(Q).buttonViewRegistration),1)]),_:1})]),_:1},8,["to"])):(e(),u(f,{key:0},[(P=o.forms.find(s=>s.Type===c(D).FORM_TYPE_REGISTRATION))!=null&&P.State.New?(e(),l(O,{key:0,to:`/register/${o.convention.Slug||o.convention.ConventionUUID}`},{default:t(()=>[r(m,{color:"primary"},{default:t(()=>[a(h(c(Q).buttonRegister),1)]),_:1})]),_:1},8,["to"])):S("",!0)],64))],64)):p.value&&n.value&&n.value.Total>n.value.Paid?(e(),u(f,{key:2},[r(m,{color:"success",variant:"elevated",onClick:g[0]||(g[0]=s=>Y.value=!0)},{default:t(()=>[a("Make Payment")]),_:1}),n.value?(e(),l(it,{key:0,"payment-transactions":V.value,registration:n.value,modelValue:Y.value,"onUpdate:modelValue":g[1]||(g[1]=s=>Y.value=s)},null,8,["payment-transactions","registration","modelValue"])):S("",!0)],64)):S("",!0)]}),_:1})]),_:1})}}});const Lt=fe($t,[["__scopeId","data-v-b71e674d"]]),Yt=j({__name:"Conventions",setup(i){const T=ae(),k=b([]),U=b([]);return T.getOpenConventionsList().then(v=>{v&&(k.value=[...k.value,...v],T.getAvailableConventionForms(k.value.map(n=>n.ConventionUUID)).then(n=>{U.value=[...U.value,...n]}).catch(n=>{console.error(n)}))}),(v,n)=>(e(),l(se,null,{default:t(()=>[r(J,{class:"justify-center"},{default:t(()=>[(e(!0),u(f,null,q(k.value,y=>(e(),l(H,{key:y.ConventionUUID,cols:"12",sm:"11",md:"11",lg:"8",xl:"6",class:"d-flex flex-column"},{default:t(()=>[r(Lt,{convention:y,forms:U.value.filter(E=>E.ConventionUUID===y.ConventionUUID)},null,8,["convention","forms"])]),_:2},1024))),128))]),_:1})]),_:1}))}}),xt={};function Bt(i,T){return e(),u("div")}const zt=fe(xt,[["render",Bt]]),Gt=j({__name:"MainView",emits:["pageTitle"],setup(i,{emit:T}){T("pageTitle","Scotiacon Registration System"),sessionStorage.getItem("reload")==="true"&&(sessionStorage.removeItem("reload"),setTimeout(()=>{location.reload()},500));const U=localStorage.getItem("gjt_token"),v=localStorage.getItem("ajt_token");U?(localStorage.removeItem("gjt_token"),location.href=U):v&&(localStorage.removeItem("ajt_token"),location.href=v);const n=b(ne());return(y,E)=>{const V=te("router-link");return e(),u(f,null,[n.value&&(!n.value.Additional||!n.value.Additional.Email)?(e(),l(se,{key:0,class:"bg-red-darken-4 text-center",fluid:!0},{default:t(()=>[a(" Please enter a Contact Email on the "),r(V,{to:"/profile",class:"text-white font-weight-bold"},{default:t(()=>[a("manage account page")]),_:1}),a(" to ensure we can contact you. ")]),_:1})):S("",!0),r(Yt),r(zt)],64)}}}),To=j({__name:"Home",props:{loggedIn:{type:Boolean}},emits:["pageTitle"],setup(i,{emit:T}){const k=ne();return T("pageTitle","Telegram Login"),(U,v)=>(e(),u("div",null,[U.loggedIn&&c(k)?(e(),l(Gt,{key:0,onPageTitle:v[0]||(v[0]=n=>T("pageTitle",n))})):(e(),l(we,{key:1}))]))}});export{To as default};
