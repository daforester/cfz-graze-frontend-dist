import{p as Le,r as O,e as de,W as c,y as hl,ao as nl,as as Fe,a5 as ol,n as Be,ah as pl,s as ke,u as we,w as Z,E as Xe,au as yl,v as i,H as N,x as he,P as H,aE as Ul,aF as je,I as Ie,a0 as ne,a1 as Te,a8 as Ke,M as u,V as x,X as G,Q as z,O as r,a4 as ee,N as I,S as M,K as De,R as ul,ac as Pe,a3 as il,U as bl,ag as ze,a as Il,aC as Tl,L as Dl,aG as Qe}from"./index-a721f26d.js";import{F as ue}from"./form-29fd1dbb.js";import{S as Vl}from"./submission-6136b51d.js";import{a as Cl,V as be,u as He,m as kl,b as sl,c as Sl,d as El}from"./VCheckbox-8b125873.js";import{s as Ee}from"./index-26b71cef.js";import{e as Al,V as pe,a as ce,c as Me,d as Se,b as rl}from"./VList-4d3e13a8.js";import{V as W,a as K}from"./VRow-50023ab7.js";import{m as Ol,u as _l,a as Rl,b as wl,V as qe,c as Ml}from"./copyToClipboard-868631e3.js";import{q as Ll,u as Ge,V as Ae,A as Pl,j as $l}from"./VContainer-cd9de7d2.js";import{d as xl,_ as Ze}from"./SaveButton.vue_vue_type_script_setup_true_lang-aa74317a.js";import{a as Fl}from"./scopeId-9d9646da.js";import{e as ql,V as Ve,b as Ne,m as Nl,g as Bl}from"./VTextField-9052b146.js";import{V as me}from"./VBtn-2305d2f7.js";import{m as Kl,V as el}from"./VAvatar-27e9bb9c.js";import{V as Hl}from"./VTextarea-5e54b75f.js";import{u as Gl,f as Yl}from"./forwardRefs-93d241ec.js";import{a as Jl}from"./VChip-981afdb2.js";import{G as Wl}from"./userData-daa97704.js";import{v as $e}from"./v4-a960c1f4.js";import{e as Xl,V as jl,a as zl,c as Ql}from"./VCard-24087343.js";import{V as Zl}from"./VForm-e82fe07c.js";var ie=(e=>(e.ACCOMMODATION="ACCOMMODATION",e.AGE="AGE",e.CHECKBOX="CHECKBOX",e.DATE="DATE",e.EXTRAS="EXTRAS",e.INTERESTS="INTERESTS",e.RADIO="RADIO",e.SELECT="SELECT",e.TEXT="TEXT",e.TEXTAREA="TEXTAREA",e.TICKET="TICKET",e.NUMBER="NUMBER",e))(ie||{});const ra=[{title:"Accommodation",value:"ACCOMMODATION"},{title:"Additional Purchase",value:"EXTRAS"},{title:"Age Check",value:"AGE"},{title:"Button",value:"RADIO"},{title:"Checkbox",value:"CHECKBOX"},{title:"Date",value:"DATE"},{title:"Dropdown",value:"SELECT"},{title:"Interests",value:"INTERESTS"},{title:"Text",value:"TEXT"},{title:"Textarea",value:"TEXTAREA"},{title:"Ticket",value:"TICKET"},{title:"Number",value:"NUMBER"}];var dl=(e=>(e.TICKET_TYPE_ADD_ON="TICKET_TYPE_ADD_ON",e.TICKET_TYPE_GROUP="TICKET_TYPE_GROUP",e.TICKET_TYPE_TICKET="TICKET_TYPE_TICKET",e.TICKET_TYPE_TICKET_COMPONENT="TICKET_TYPE_TICKET_COMPONENT",e))(dl||{});const da=[{title:"Add on",value:"TICKET_TYPE_ADD_ON"},{title:"Category",value:"TICKET_TYPE_GROUP"},{title:"Ticket",value:"TICKET_TYPE_TICKET"},{title:"Component",value:"TICKET_TYPE_TICKET_COMPONENT"}],Oe=e=>{e.sort((f,l)=>(f.Order?f.Order:0)-(l.Order?l.Order:0)),e.forEach((f,l)=>{f.Order=l})},ca=(e,f)=>{const l=f.indexOf(e);if(l===0)return;const R=e.Order;e.Order=f[l-1].Order,f[l-1].Order=R,Oe(f)},va=(e,f)=>{const l=f.indexOf(e);if(l>=f.length-1)return;const R=e.Order;e.Order=f[l+1].Order,f[l+1].Order=R,Oe(f)};const et=(e,f,l)=>e==null||f==null?-1:e.toString().toLocaleLowerCase().indexOf(f.toString().toLocaleLowerCase()),lt=Le({customFilter:Function,customKeyFilter:Object,filterKeys:[Array,String],filterMode:{type:String,default:"intersection"},noFilter:Boolean},"filter");function tt(e,f,l){var b;const R=[],y=(l==null?void 0:l.default)??et,p=l!=null&&l.filterKeys?nl(l.filterKeys):!1,C=Object.keys((l==null?void 0:l.customKeyFilter)??{}).length;if(!(e!=null&&e.length))return R;e:for(let k=0;k<e.length;k++){const v=e[k],t={},d={};let m=-1;if(f&&!(l!=null&&l.noFilter)){if(typeof v=="object"){const D=p||Object.keys(v);for(const a of D){const n=Fe(v,a,v),o=(b=l==null?void 0:l.customKeyFilter)==null?void 0:b[a];if(m=o?o(n,f,v):y(n,f,v),m!==-1&&m!==!1)o?t[a]=m:d[a]=m;else if((l==null?void 0:l.filterMode)==="every")continue e}}else m=y(v,f,v),m!==-1&&m!==!1&&(d.title=m);const V=Object.keys(d).length,s=Object.keys(t).length;if(!V&&!s||(l==null?void 0:l.filterMode)==="union"&&s!==C&&!V||(l==null?void 0:l.filterMode)==="intersection"&&(s!==C||!V))continue}R.push({index:k,matches:{...d,...t}})}return R}function at(e,f,l,R){const y=O([]),p=O(new Map),C=de(()=>R!=null&&R.transform?c(f).map(R==null?void 0:R.transform):c(f));hl(()=>{const k=typeof l=="function"?l():c(l),v=typeof k!="string"&&typeof k!="number"?"":String(k),t=tt(C.value,v,{customKeyFilter:e.customKeyFilter,default:e.customFilter,filterKeys:e.filterKeys,filterMode:e.filterMode,noFilter:e.noFilter}),d=c(f),m=[],V=new Map;t.forEach(s=>{let{index:D,matches:a}=s;const n=d[D];m.push(n),V.set(n.value,a)}),y.value=m,p.value=V});function b(k){return p.value.get(k.value)}return{filteredItems:y,filteredMatches:p,getMatches:b}}function nt(e,f,l){if(f==null)return e;if(Array.isArray(f))throw new Error("Multiple matches is not implemented");return typeof f=="number"&&~f?i(N,null,[i("span",{class:"v-autocomplete__unmask"},[e.substr(0,f)]),i("span",{class:"v-autocomplete__mask"},[e.substr(f,l)]),i("span",{class:"v-autocomplete__unmask"},[e.substr(f+l)])]):e}const ot=Le({autoSelectFirst:{type:[Boolean,String]},search:String,...lt({filterKeys:["title"]}),...Ol(),...ol(ql({modelValue:null,role:"combobox"}),["validationValue","dirty","appendInnerIcon"]),...Kl({transition:!1})},"VAutocomplete"),ll=Be()({name:"VAutocomplete",props:ot(),emits:{"update:focused":e=>!0,"update:search":e=>!0,"update:modelValue":e=>!0,"update:menu":e=>!0},setup(e,f){let{slots:l}=f;const{t:R}=pl(),y=O(),p=ke(!1),C=ke(!0),b=ke(!1),k=O(),v=O(),t=we(e,"menu"),d=de({get:()=>t.value,set:T=>{var B;t.value&&!T&&((B=k.value)!=null&&B.ΨopenChildren)||(t.value=T)}}),m=ke(-1),V=de(()=>{var T;return(T=y.value)==null?void 0:T.color}),s=de(()=>d.value?e.closeText:e.openText),{items:D,transformIn:a,transformOut:n}=Al(e),{textColorClasses:o,textColorStyles:A}=Ll(V),_=we(e,"search",""),F=we(e,"modelValue",[],T=>a(T===null?[null]:nl(T)),T=>{const B=n(T);return e.multiple?B:B[0]??null}),q=Gl(),{filteredItems:E,getMatches:h}=at(e,D,()=>C.value?"":_.value),S=de(()=>F.value.map(T=>D.value.find(B=>{const J=Fe(B.raw,e.itemValue),ge=Fe(T.raw,e.itemValue);return J===void 0||ge===void 0?!1:e.returnObject?e.valueComparator(J,ge):e.valueComparator(B.value,T.value)})||T)),U=de(()=>e.hideSelected?E.value.filter(T=>!S.value.some(B=>B.value===T.value)):E.value),w=de(()=>S.value.map(T=>T.props.value)),$=de(()=>S.value[m.value]),le=de(()=>{var B;return(e.autoSelectFirst===!0||e.autoSelectFirst==="exact"&&_.value===((B=U.value[0])==null?void 0:B.title))&&U.value.length>0&&!C.value&&!b.value}),oe=de(()=>e.hideNoData&&!D.value.length||e.readonly||(q==null?void 0:q.isReadonly.value)),fe=O(),{onListScroll:X,onListKeydown:g}=_l(fe,y);function L(T){e.openOnClear&&(d.value=!0),_.value=""}function ve(){oe.value||(d.value=!0)}function P(T){oe.value||(p.value&&(T.preventDefault(),T.stopPropagation()),d.value=!d.value)}function te(T){var ge,Y,ae;if(e.readonly||q!=null&&q.isReadonly.value)return;const B=y.value.selectionStart,J=w.value.length;if((m.value>-1||["Enter","ArrowDown","ArrowUp"].includes(T.key))&&T.preventDefault(),["Enter","ArrowDown"].includes(T.key)&&(d.value=!0),["Escape"].includes(T.key)&&(d.value=!1),le.value&&["Enter","Tab"].includes(T.key)&&ye(U.value[0]),T.key==="ArrowDown"&&le.value&&((ge=fe.value)==null||ge.focus("next")),!!e.multiple){if(["Backspace","Delete"].includes(T.key)){if(m.value<0){T.key==="Backspace"&&!_.value&&(m.value=J-1);return}const j=m.value;$.value&&ye($.value),m.value=j>=J-1?J-2:j}if(T.key==="ArrowLeft"){if(m.value<0&&B>0)return;const j=m.value>-1?m.value-1:J-1;S.value[j]?m.value=j:(m.value=-1,y.value.setSelectionRange((Y=_.value)==null?void 0:Y.length,(ae=_.value)==null?void 0:ae.length))}if(T.key==="ArrowRight"){if(m.value<0)return;const j=m.value+1;S.value[j]?m.value=j:(m.value=-1,y.value.setSelectionRange(0,0))}}}function Q(T){_.value=T.target.value}function Ye(T){if(je(y.value,":autofill")||je(y.value,":-webkit-autofill")){const B=D.value.find(J=>J.title===T.target.value);B&&ye(B)}}function cl(){var T;p.value&&(C.value=!0,(T=y.value)==null||T.focus())}function vl(T){p.value=!0,setTimeout(()=>{b.value=!0})}function ml(T){b.value=!1}function fl(T){(T==null||T===""&&!e.multiple)&&(F.value=[])}const Ce=ke(!1);function ye(T){if(e.multiple){const B=w.value.findIndex(J=>e.valueComparator(J,T.value));if(B===-1)F.value=[...F.value,T];else{const J=[...F.value];J.splice(B,1),F.value=J}}else F.value=[T],Ce.value=!0,_.value=T.title,d.value=!1,C.value=!0,Xe(()=>Ce.value=!1)}return Z(p,(T,B)=>{var J;T!==B&&(T?(Ce.value=!0,_.value=e.multiple?"":String(((J=S.value.at(-1))==null?void 0:J.props.title)??""),C.value=!0,Xe(()=>Ce.value=!1)):(!e.multiple&&!_.value?F.value=[]:le.value&&!b.value&&!S.value.some(ge=>{let{value:Y}=ge;return Y===U.value[0].value})&&ye(U.value[0]),d.value=!1,_.value="",m.value=-1))}),Z(_,T=>{!p.value||Ce.value||(T&&(d.value=!0),C.value=!T)}),Z(d,()=>{if(!e.hideSelected&&d.value&&S.value.length){const T=U.value.findIndex(B=>S.value.some(J=>B.value===J.value));yl&&window.requestAnimationFrame(()=>{var B;T>=0&&((B=v.value)==null||B.scrollToIndex(T))})}}),Ge(()=>{const T=!!(e.chips||l.chip),B=!!(!e.hideNoData||U.value.length||l["prepend-item"]||l["append-item"]||l["no-data"]),J=F.value.length>0,[ge]=Ve.filterProps(e);return i(Ve,he({ref:y},ge,{modelValue:_.value,"onUpdate:modelValue":fl,focused:p.value,"onUpdate:focused":Y=>p.value=Y,validationValue:F.externalValue,dirty:J,onInput:Q,onChange:Ye,class:["v-autocomplete",`v-autocomplete--${e.multiple?"multiple":"single"}`,{"v-autocomplete--active-menu":d.value,"v-autocomplete--chips":!!e.chips,"v-autocomplete--selection-slot":!!l.selection,"v-autocomplete--selecting-index":m.value>-1},e.class],style:e.style,readonly:e.readonly,placeholder:J?void 0:e.placeholder,"onClick:clear":L,"onMousedown:control":ve,onKeydown:te}),{...l,default:()=>i(N,null,[i(Rl,he({ref:k,modelValue:d.value,"onUpdate:modelValue":Y=>d.value=Y,activator:"parent",contentClass:"v-autocomplete__content",disabled:oe.value,eager:e.eager,maxHeight:310,openOnClick:!1,closeOnContentClick:!1,transition:e.transition,onAfterLeave:cl},e.menuProps),{default:()=>[B&&i(pe,{ref:fe,selected:w.value,selectStrategy:e.multiple?"independent":"single-independent",onMousedown:Y=>Y.preventDefault(),onKeydown:g,onFocusin:vl,onFocusout:ml,onScrollPassive:X,tabindex:"-1",color:e.itemColor??e.color},{default:()=>{var Y,ae,j;return[(Y=l["prepend-item"])==null?void 0:Y.call(l),!U.value.length&&!e.hideNoData&&(((ae=l["no-data"])==null?void 0:ae.call(l))??i(ce,{title:R(e.noDataText)},null)),i(wl,{ref:v,renderless:!0,items:U.value},{default:Ue=>{var We;let{item:se,index:re,itemRef:gl}=Ue;const Je=he(se.props,{ref:gl,key:re,active:le.value&&re===0?!0:void 0,onClick:()=>ye(se)});return((We=l.item)==null?void 0:We.call(l,{item:se,index:re,props:Je}))??i(ce,Je,{prepend:_e=>{let{isSelected:Re}=_e;return i(N,null,[e.multiple&&!e.hideSelected?i(Cl,{key:se.value,modelValue:Re,ripple:!1,tabindex:"-1"},null):void 0,se.props.prependIcon&&i(Ae,{icon:se.props.prependIcon},null)])},title:()=>{var _e,Re;return C.value?se.title:nt(se.title,(_e=h(se))==null?void 0:_e.title,((Re=_.value)==null?void 0:Re.length)??0)}})}}),(j=l["append-item"])==null?void 0:j.call(l)]}})]}),S.value.map((Y,ae)=>{var se;function j(re){re.stopPropagation(),re.preventDefault(),ye(Y)}const Ue={"onClick:close":j,onMousedown(re){re.preventDefault(),re.stopPropagation()},modelValue:!0,"onUpdate:modelValue":void 0};return i("div",{key:Y.value,class:["v-autocomplete__selection",ae===m.value&&["v-autocomplete__selection--selected",o.value]],style:ae===m.value?A.value:{}},[T?l.chip?i(Pl,{key:"chip-defaults",defaults:{VChip:{closable:e.closableChips,size:"small",text:Y.title}}},{default:()=>{var re;return[(re=l.chip)==null?void 0:re.call(l,{item:Y,index:ae,props:Ue})]}}):i(Jl,he({key:"chip",closable:e.closableChips,size:"small",text:Y.title},Ue),null):((se=l.selection)==null?void 0:se.call(l,{item:Y,index:ae}))??i("span",{class:"v-autocomplete__selection-text"},[Y.title,e.multiple&&ae<S.value.length-1&&i("span",{class:"v-autocomplete__selection-comma"},[H(",")])])])})]),"append-inner":function(){var Ue;for(var Y=arguments.length,ae=new Array(Y),j=0;j<Y;j++)ae[j]=arguments[j];return i(N,null,[(Ue=l["append-inner"])==null?void 0:Ue.call(l,...ae),e.menuIcon?i(Ae,{class:"v-autocomplete__menu-icon",icon:e.menuIcon,onMousedown:P,onClick:Ul,"aria-label":R(s.value),title:R(s.value)},null):void 0])}})}),Yl({isFocused:p,isPristine:C,menu:d,search:_,filteredItems:E,select:ye},y)}}),ut={class:"extrasList"},it=Ie({__name:"Extras",props:ne({admin:{type:Boolean},convention:{},disabled:{type:Boolean},hint:{},label:{},name:{},items:{},persistentHint:{type:Boolean},required:{type:Boolean},errorMessages:{}},{modelValue:{required:!0}}),emits:ne(["change"],["update:modelValue"]),setup(e,{emit:f}){const l=e,{admin:R=!1,convention:y,disabled:p=!1}=l,C=Te(e,"modelValue"),b=Ke.getInstance(),k=O({});try{k.value=JSON.parse(C.value)}catch{}const v=O([]),t=O([]);Z(l,()=>{m()}),Z(k.value,s=>{for(const D in s)if(s[D].checked){const a=v.value.map(n=>{var o;return(o=n.Options)==null?void 0:o.find(A=>A.OptionUUID===D)});if(a&&a.length>0)try{const n=a[0];s[D].choiceId===""&&n&&n.Choices&&n.Choices.length>0&&(s[D].choiceId=n.Choices[0].TagUUID),s[D].price=n==null?void 0:n.Price}catch{}}else s[D].choiceId="",s[D].price=0;C.value=JSON.stringify(s),V()});const d=de({get:()=>v.value.map(s=>s.ExtraUUID),set:()=>{}}),m=()=>{var D;const s=((D=l.items.find(a=>a.Title==="SelectedExtras"))==null?void 0:D.Value)||"[]";try{const a=JSON.parse(s);v.value=t.value.filter(n=>a.find(o=>o===n.ExtraUUID))||[],d.value=[...v.value.map(n=>n.ExtraUUID)],v.value.forEach(n=>{var o;(o=n.Options)==null||o.forEach(A=>{k.value[A.OptionUUID]||(k.value[A.OptionUUID]={choiceId:"",checked:!1})})})}catch{}};"Extras"in y&&y.Extras.length?(t.value=y.Extras,m()):"ConventionUUID"in y&&(R?b==null||b.getConventionExtras(y.ConventionUUID).then(s=>{s&&(t.value=s,m())}):b==null||b.getAvailableConventionExtras(y.ConventionUUID).then(s=>{s&&(t.value=s,m())}));const V=(s=void 0)=>{setTimeout(()=>f("change",s),100)};return(s,D)=>(u(),x("div",ut,[G("h4",null,z(s.label),1),i(pe,{opened:d.value,"onUpdate:opened":D[0]||(D[0]=a=>d.value=a)},{default:r(()=>[(u(!0),x(N,null,ee(v.value,a=>(u(),I(rl,{key:a.ExtraUUID,value:a.ExtraUUID},{activator:r(({props:n})=>[i(ce,he({"prepend-icon":"mdi:mdi-group","append-icon":""},n),{default:r(()=>[a.Name?(u(),I(Me,{key:0},{default:r(()=>[G("strong",null,z(a.Name),1)]),_:2},1024)):M("",!0),a.Description?(u(),I(Se,{key:1,class:"mt-2 d-inline"},{default:r(()=>[H(z(a.Description),1)]),_:2},1024)):M("",!0)]),_:2},1040)]),default:r(()=>[a.Options?(u(!0),x(N,{key:0},ee(a.Options,n=>(u(),I(ce,{key:n.OptionUUID,class:"override-pl"},{default:r(()=>[i(W,null,{default:r(()=>[i(K,{cols:"12",sm:"6"},{default:r(()=>[i(be,{label:`${n.Name} ${n.Price&&n.Price!==0?`(${c(Ee).currencySymbol}${n.Price})`:""}`,modelValue:k.value[n.OptionUUID].checked,"onUpdate:modelValue":o=>k.value[n.OptionUUID].checked=o,disabled:c(p),"hide-details":"",onChange:V},null,8,["label","modelValue","onUpdate:modelValue","disabled"])]),_:2},1024),n.Choices&&n.Choices.length>1&&k.value[n.OptionUUID].checked?(u(),I(K,{key:0,cols:"12",sm:"6"},{default:r(()=>[i(qe,{items:n.Choices.sort((o,A)=>o.Title.localeCompare(A.Title)).map(o=>({value:o.TagUUID,title:o.Title})),modelValue:k.value[n.OptionUUID].choiceId,"onUpdate:modelValue":o=>k.value[n.OptionUUID].choiceId=o,"item-value":"value","item-title":"title",variant:"outlined",disabled:c(p),"hide-details":"",onChange:V},null,8,["items","modelValue","onUpdate:modelValue","disabled"])]),_:2},1024)):M("",!0)]),_:2},1024)]),_:2},1024))),128)):M("",!0)]),_:2},1032,["value"]))),128))]),_:1},8,["opened"])]))}});const st={class:"interestList"},rt=Ie({__name:"Interests",props:ne({admin:{type:Boolean},convention:{},disabled:{type:Boolean},hint:{},label:{},name:{},items:{},persistentHint:{type:Boolean},required:{type:Boolean},errorMessages:{}},{modelValue:{required:!0}}),emits:ne(["change"],["update:modelValue"]),setup(e,{emit:f}){const l=e,{admin:R=!1,convention:y,disabled:p=!1}=l,C=Te(e,"modelValue"),b=Ke.getInstance(),k=O({});try{k.value=JSON.parse(C.value)}catch{}const v=O([]),t=O([]);Z(k.value,s=>{C.value=JSON.stringify(s)});const d=O([]),m=()=>{var D;const s=((D=l.items.find(a=>a.Title==="SelectedInterests"))==null?void 0:D.Value)||"[]";try{const a=JSON.parse(s);v.value=t.value.filter(n=>a.find(o=>o===n.InterestUUID))||[],d.value=[...v.value.map(n=>n.InterestUUID)]}catch{}};"ConventionUUID"in y&&(R?b==null||b.getConventionInterests(y.ConventionUUID).then(s=>{s&&(t.value=s,m())}):b==null||b.getConventionInterests(y.ConventionUUID).then(s=>{s&&(t.value=s,m())})),Z(l,()=>{m()});const V=(s=void 0)=>{setTimeout(()=>f("change",s),100)};return(s,D)=>(u(),x("div",st,[G("h4",null,z(s.label),1),i(pe,{opened:d.value,"onUpdate:opened":D[0]||(D[0]=a=>d.value=a)},{default:r(()=>[(u(!0),x(N,null,ee(v.value.sort((a,n)=>a.Order>n.Order?1:a.Order==n.Order?0:-1),a=>(u(),I(ce,{key:a.InterestUUID},{default:r(()=>[i(W,null,{default:r(()=>[i(K,null,{default:r(()=>[i(be,{label:`${a.Name} ${a.Price&&a.Price>0?`(${c(Ee).currencySymbol}${a.Price})`:""}`,modelValue:k.value[a.InterestUUID],"onUpdate:modelValue":n=>k.value[a.InterestUUID]=n,disabled:c(p),messages:a.Description,onChange:V},null,8,["label","modelValue","onUpdate:modelValue","disabled","messages"])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1},8,["opened"])]))}});const tl=(e,f,l)=>{if(l>=e.length){let R=l-e.length+1;for(;R--;)e.push(void 0)}e.splice(l,0,e.splice(f,1)[0])},xe=e=>(Oe(e),e),ma=e=>(f,l)=>f[e]<l[e]?-1:f[e]>l[e]?1:0,dt={class:"ticketList"},ct={key:0,class:"text-orange-darken-1"},vt=Ie({__name:"Tickets",props:ne({admin:{type:Boolean},convention:{},disabled:{type:Boolean},hint:{},label:{},name:{},items:{},persistentHint:{type:Boolean},registrationGroup:{},required:{type:Boolean},errorMessages:{}},{modelValue:{required:!0}}),emits:ne(["change"],["update:modelValue"]),setup(e,{emit:f}){const l=e,{admin:R=!1,convention:y,disabled:p=!1,registrationGroup:C=void 0}=l,b=Te(e,"modelValue"),k=Ke.getInstance(),v=O({Ticket:[],AddonsChecked:[],ComponentsChecked:[]});try{v.value=JSON.parse(b.value),"ticket"in v.value&&(v.value.Ticket=v.value.ticket),"addonsChecked"in v.value&&(v.value.AddonsChecked=v.value.addonsChecked),"componentsChecked"in v.value&&(v.value.ComponentsChecked=v.value.componentsChecked)}catch{}const t=O([]),d=O([]),m=O([]),V=O({required:(o,A=void 0)=>()=>{if(p||!(C!=null&&C.Registration.Leader))return!0;if(A==null){if(v.value.Ticket.length===0&&l.required)return"Must select at least one ticket option.";if(o&&o.ComponentsRequired>0&&v.value.Ticket.includes(o.TicketUUID||"")){let _=0;if(o.TicketComponents.forEach(F=>{v.value.ComponentsChecked.forEach(q=>{F.TicketUUID===q&&(_+=1)})}),_<o.ComponentsRequired)return`Must select ticket ${o.ComponentsRequired} component${o.ComponentsRequired===1?"":"s"}`}}return!0}}),s=()=>{var A;const o=((A=l.items.find(_=>_.Title==="SelectedTickets"))==null?void 0:A.Value)||"[]";try{const _=JSON.parse(o);t.value=d.value.filter(F=>F.Type==="TICKET_TYPE_GROUP"&&_.find(q=>q===F.TicketUUID))||[],m.value=[...t.value.filter(F=>F.Type==="TICKET_TYPE_GROUP").map(F=>F.TicketUUID)]}catch{}};if("ConventionUUID"in y)if(R)k==null||k.getConventionTickets(y.ConventionUUID).then(o=>{o&&(d.value=o,s())});else{const o=l.items.find(A=>A.Title==="SelectedTickets");o&&(k==null||k.getFieldTickets(o.FieldUUID).then(A=>{A&&(d.value=A,s())}))}Z(l,()=>{s()});const D=o=>{v.value.Ticket.length>1&&v.value.Ticket.shift(),v.value.ComponentsChecked=[];const A=[];t.value.forEach(_=>{(v.value.Ticket.includes(_.TicketUUID)||v.value.ComponentsChecked.includes(_.TicketUUID))&&A.push(..._.AddonTickets.map(F=>F.TicketUUID))}),v.value.AddonsChecked=v.value.AddonsChecked.filter(_=>A.includes(_)),n(o)},a=o=>{const A=d.value.find(_=>_.TicketUUID===v.value.Ticket[0]);if(A)for(;v.value.ComponentsChecked.length>A.ComponentsRequired;)v.value.ComponentsChecked.shift();n(o)},n=(o=void 0)=>{b.value=JSON.stringify(v.value),setTimeout(()=>f("change",o),100)};try{C!=null&&C.TicketData&&(v.value=JSON.parse(C.TicketData),"ticket"in v.value&&(v.value.Ticket=v.value.ticket),"addonsChecked"in v.value&&(v.value.AddonsChecked=v.value.addonsChecked),"componentsChecked"in v.value&&(v.value.ComponentsChecked=v.value.componentsChecked),n())}catch{}return(o,A)=>{var _;return u(),x("div",dt,[G("h4",null,[H(z(o.label)+" ",1),(_=c(C))!=null&&_.Registration.Leader?M("",!0):(u(),x("small",ct,"(controlled by group leader)"))]),i(pe,{opened:m.value,"onUpdate:opened":A[4]||(A[4]=F=>m.value=F)},{default:r(()=>[(u(!0),x(N,null,ee(c(xe)(t.value.filter(F=>F.Type===c(dl).TICKET_TYPE_GROUP)),F=>(u(),x(N,{key:F.TicketUUID},[F.Tickets.length>0?(u(),I(rl,{key:0,value:F.TicketUUID},{activator:r(({props:q})=>[i(ce,he(q,{"prepend-icon":"mdi:mdi-group"}),{default:r(()=>[i(Me,null,{default:r(()=>[G("strong",null,z(F.Name),1)]),_:2},1024),i(Se,{class:"d-inline"},{default:r(()=>[H(z(F.Description),1)]),_:2},1024)]),_:2},1040)]),default:r(()=>[(u(!0),x(N,null,ee(F.Tickets,q=>(u(),I(ce,{key:q.TicketUUID,class:"override-pl"},{default:r(()=>{var E;return[i(Se,{class:"d-inline"},{default:r(()=>[H(z(q.Description),1)]),_:2},1024),i(be,{modelValue:v.value.Ticket,"onUpdate:modelValue":A[0]||(A[0]=h=>v.value.Ticket=h),value:q.TicketUUID,onChange:D,rules:[V.value.required(q)],"validate-on":"submit",disabled:c(p)||!((E=c(C))!=null&&E.Registration.Leader)},{label:r(()=>[i(Ae,{icon:q.RequiresAccommodation?"mdi:mdi-home":q.ComponentsRequired>0?"mdi:mdi-ticket-confirmation":"mdi:mdi-ticket",class:"mx-2"},null,8,["icon"]),H(" "+z(`${q.Name} ${q.Price>0?`(${c(Ee).currencySymbol}${q.Price})`:""}`),1)]),_:2},1032,["modelValue","value","rules","disabled"]),v.value.Ticket.length>0&&q.TicketUUID===v.value.Ticket[0]?(u(),x(N,{key:0},[q.AddonTickets.length?(u(),I(pe,{key:0},{default:r(()=>[(u(!0),x(N,null,ee(c(xe)(q.AddonTickets),h=>(u(),x(N,{key:h==null?void 0:h.TicketUUID},[h?(u(),I(ce,{key:0},{default:r(()=>[i(Me,null,{default:r(()=>{var S;return[i(be,{modelValue:v.value.AddonsChecked,"onUpdate:modelValue":A[1]||(A[1]=U=>v.value.AddonsChecked=U),value:h.TicketUUID,onChange:A[2]||(A[2]=U=>{v.value.ComponentsChecked=[],n(U)}),disabled:c(p)||!((S=c(C))!=null&&S.Registration.Leader)},{label:r(()=>[i(Ae,{icon:h.RequiresAccommodation?"mdi:mdi-home-plus":h.ComponentsRequired>0?"mdi:mdi-ticket-confirmation":"mdi:mdi-ticket",class:"mx-2"},null,8,["icon"]),H(" "+z(`${h.Name} ${h.Price>0?`(${c(Ee).currencySymbol}${h.Price})`:""}`),1)]),_:2},1032,["modelValue","value","disabled"])]}),_:2},1024),i(Se,{class:"d-inline"},{default:r(()=>[H(z(h.Description),1)]),_:2},1024)]),_:2},1024)):M("",!0)],64))),128))]),_:2},1024)):M("",!0),q.TicketComponents.length?(u(),I(pe,{key:1},{default:r(()=>[(u(!0),x(N,null,ee(c(xe)(q.TicketComponents),h=>(u(),x(N,{key:h==null?void 0:h.TicketUUID},[h?(u(),I(ce,{key:0},{default:r(()=>[i(Me,null,{default:r(()=>{var S;return[i(be,{modelValue:v.value.ComponentsChecked,"onUpdate:modelValue":A[3]||(A[3]=U=>v.value.ComponentsChecked=U),value:h.TicketUUID,onChange:a,rules:[V.value.required(q,h)],"validate-on":"submit",disabled:c(p)||!((S=c(C))!=null&&S.Registration.Leader)},{label:r(()=>[i(Ae,{icon:h.RequiresAccommodation?"mdi:mdi-home-plus":h.ComponentsRequired>0?"mdi:mdi-ticket-confirmation":"mdi:mdi-ticket",class:"mx-2"},null,8,["icon"]),H(" "+z(`${h.Name} ${h.Price>0?`(${c(Ee).currencySymbol}${h.Price})`:""}`),1)]),_:2},1032,["modelValue","value","rules","disabled"])]}),_:2},1024),i(Se,null,{default:r(()=>[H(z(h.Description),1)]),_:2},1024)]),_:2},1024)):M("",!0)],64))),128))]),_:2},1024)):M("",!0)],64)):M("",!0)]}),_:2},1024))),128))]),_:2},1032,["value"])):M("",!0)],64))),128))]),_:1},8,["opened"])])}}});const mt={key:0},ft=G("strong",null,"Your Sharing Group",-1),gt={class:"d-flex flex-wrap my-2"},ht=G("dt",{class:"v-col-12 v-col-sm-2 v-col-md-1 font-weight-bold pa-1 pt-4"}," Leader: ",-1),pt={class:"v-col-12 v-col-sm-10 v-col-md-11 pa-1 align-content-center"},yt={class:"d-inline-block position-relative ml-4",style:{top:"-5px"}},Ut=G("dt",{class:"v-col-12 v-col-sm-2 v-col-md-1 pa-1 pt-4"}," Member: ",-1),bt={class:"v-col-12 v-col-sm-10 v-col-md-11 pa-1"},It={class:"d-inline-block position-relative ml-4",style:{top:"-5px"}},Tt=["href","onClick"],Dt=G("br",null,null,-1),Vt=G("small",null,"Link will be copied to clipboard for you to paste (ctrl+v) in to message or email",-1),Ct=G("strong",null,"Your Groups Accommodation",-1),kt=G("br",null,null,-1),St=G("small",null,"(in order of preference, controlled by group leader)",-1),Et=G("strong",null,"Accommodation Options",-1),At=G("br",null,null,-1),Ot=G("strong",null,"Your Chosen Accommodation",-1),_t=G("small",null,"(in order of preference)",-1),Rt=Ie({__name:"Accommodation",props:ne({admin:{type:Boolean},convention:{},data:{},disabled:{type:Boolean},hint:{},items:{},label:{},name:{},persistentHint:{type:Boolean},registrationGroup:{},required:{type:Boolean},errorMessages:{}},{modelValue:{required:!0}}),emits:ne(["change","update:items"],["update:modelValue"]),setup(e,{emit:f}){const l=e,{admin:R=!1,convention:y,disabled:p}=l,C=Te(e,"modelValue"),b=He(l,f,void 0,void 0,"items"),k=il(),v=Fl(),t=bl.getInstance(),d=O(De(C.value)),m=O([]),V=O(),s=O({sharing:!1}),D=()=>{try{const g=JSON.parse(l.data);g&&(s.value=g)}catch{}};D(),Z(l,()=>{D(),l.registrationGroup&&(m.value=l.registrationGroup.Members,V.value=l.registrationGroup.Registration)}),Z(d,g=>{C.value=De(g)},{deep:!0});const a=O(""),n=O(!1),o=()=>{var g;(g=V.value)!=null&&g.Leader&&k.getRegistrationInvite(y.ConventionUUID).then(L=>{if(L){const ve=new URL(location.href);ve.searchParams.set("token",L),a.value=ve.toString()}})},A=()=>{Ml(a.value),o(),n.value=!0,setTimeout(()=>n.value=!1,2200)},_=(g=void 0)=>{setTimeout(()=>f("change",g),100)},F=O({required:g=>!l.required||g.length>0||"Selections Required"}),q=g=>g?`${g.Reference?`#${g.Reference}`:"(not registered)"} ${g.Name}`:"",E=()=>{var g;t.emit("registration.group.leave",(g=V.value)==null?void 0:g.RegistrationUUID)},h=g=>{t.emit("registration.group.remove.member",g)},S=O([]);Z(b,()=>{U()});const U=()=>{R?k.getConventionAccommodation(y.ConventionUUID).then(g=>{S.value=g.filter(L=>!!(b!=null&&b.value.find(ve=>ve.Value===L.AccommodationUUID)))||[]}):b.value.length>0&&k.getFieldAccommodation(b.value[0].FieldUUID).then(g=>{S.value=g.filter(L=>!!(b!=null&&b.value.find(ve=>ve.Value===L.AccommodationUUID)))||[]})};U(),(()=>{var g;if(l.registrationGroup)if(m.value=l.registrationGroup.Members,V.value=l.registrationGroup.Registration,(g=V.value)!=null&&g.Leader)o();else try{d.value=JSON.parse(l.registrationGroup.AccommodationData),_()}catch{}})();const $=O({column:0,id:""}),le=()=>{!p&&!d.value.includes($.value.id)&&($.value.column===0&&$.value.id!==""&&d.value.push($.value.id),_())},oe=()=>{const g=d.value.findIndex(L=>L===$.value.id);!p&&g>=0&&(d.value.splice(g,1),_())},fe=()=>{if(p||$.value.column!==1)return;const g=d.value.findIndex(L=>L===$.value.id);g<=0||(tl(d.value,g,g-1),_())},X=()=>{if(p||$.value.column!==1)return;const g=d.value.findIndex(L=>L===$.value.id);g>=d.value.length-1||(tl(d.value,g,g+1),_())};return(g,L)=>{var ve;return u(),x(N,null,[G("h4",null,z(g.label),1),i(W,null,{default:r(()=>[i(K,{cols:"12"},{default:r(()=>{var P,te;return[m.value&&V.value&&s.value.sharing?(u(),x("div",mt,[ft,!c(p)&&((P=m.value.find(Q=>Q.IsLeader))==null?void 0:P.UUID)!==V.value.RegistrationUUID?(u(),I(me,{key:0,color:"red",variant:"text",onClick:E},{default:r(()=>[H("(leave group)")]),_:1})):M("",!0),G("dl",gt,[ht,G("dd",pt,[i(el,{class:"rounded-circle d-inline-block",src:c(v).GetProfileImageURL(((te=m.value.find(Q=>Q.IsLeader))==null?void 0:te.UserUUID)||""),height:"32",width:"32"},null,8,["src"]),G("div",yt,z(q(m.value.find(Q=>Q.IsLeader))),1)]),(u(!0),x(N,null,ee(m.value,Q=>(u(),x(N,{key:Q.UUID},[Q.IsLeader?M("",!0):(u(),x(N,{key:0},[Ut,G("dd",bt,[i(el,{class:"rounded-circle d-inline-block",src:c(v).GetProfileImageURL(Q.UserUUID),height:"32",width:"32"},null,8,["src"]),G("div",It,[H(z(q(Q))+" ",1),V.value.Leader?(u(),I(me,{key:0,variant:"text",class:"ml-4",icon:"mdi:mdi-close-circle",color:"red",size:"xs",title:"Remove Member",onClick:Ye=>h(Q.UUID),disabled:c(p)},null,8,["onClick","disabled"])):M("",!0)])])],64))],64))),128))]),i(xl,{modelValue:n.value,"onUpdate:modelValue":L[0]||(L[0]=Q=>n.value=Q),message:"Invite Link Copied",timeout:2e3},null,8,["modelValue"]),a.value&&V.value.Leader&&!c(p)?(u(),x(N,{key:1},[G("a",{href:a.value,onClick:ul(A,["prevent"]),class:"text-white text-decoration-none"},[i(me,{color:"blue",class:"mb-2"},{default:r(()=>[H("Get Invite Link")]),_:1})],8,Tt),Dt,Vt],64)):M("",!0)])):M("",!0)]}),_:1})]),_:1}),V.value&&!V.value.Leader?(u(),I(W,{key:0},{default:r(()=>[i(K,{cols:"10",md:"5"},{default:r(()=>[Ct,kt,St,i(pe,null,{default:r(()=>[(u(!0),x(N,null,ee(d.value.map(P=>S.value.find(te=>te.AccommodationUUID==P)).filter(P=>P!==void 0),(P,te)=>(u(),x(N,null,[P?(u(),I(ce,{key:P.AccommodationUUID,title:`${te+1}. ${P.Name}`,class:Pe($.value.column===1&&$.value.id===P.AccommodationUUID?"bg-blue-accent-3":"border-dashed border")},null,8,["title","class"])):M("",!0)],64))),256))]),_:1})]),_:1})]),_:1})):(u(),I(W,{key:1},{default:r(()=>[i(K,{cols:"12",md:"5"},{default:r(()=>[Et,At,i(pe,null,{default:r(()=>[(u(!0),x(N,null,ee(S.value,P=>(u(),I(ce,{key:P.AccommodationUUID,title:P.Name,class:Pe($.value.column===0&&$.value.id===P.AccommodationUUID?"bg-blue-accent-3":"border-dashed border"),onClick:te=>$.value={column:0,id:P.AccommodationUUID},"append-icon":c(p)?"":"mdi:mdi-gesture-tap",onDblclick:L[1]||(L[1]=te=>le())},null,8,["title","class","onClick","append-icon"]))),128))]),_:1})]),_:1}),c(p)?M("",!0):(u(),I(K,{key:0,cols:"12",md:"1"},{default:r(()=>[i(W,{class:"d-md-none"},{default:r(()=>[i(K,{cols:"12",class:"text-center"},{default:r(()=>[i(me,{icon:"mdi:mdi-arrow-down",size:"small",onClick:L[2]||(L[2]=P=>le()),color:"primary",title:"Select"}),H("   "),i(me,{icon:"mdi:mdi-arrow-up",size:"small",onClick:L[3]||(L[3]=P=>oe()),color:"secondary",title:"Remove"})]),_:1})]),_:1}),i(W,{class:"d-none d-md-flex h-100 align-content-center"},{default:r(()=>[i(K,{cols:"12"},{default:r(()=>[i(me,{icon:"mdi:mdi-arrow-right",size:"small",onClick:L[4]||(L[4]=P=>le()),color:"primary",title:"Select"})]),_:1}),i(K,{cols:"12"},{default:r(()=>[i(me,{icon:"mdi:mdi-arrow-left",size:"small",onClick:L[5]||(L[5]=P=>oe()),color:"secondary",title:"Remove"})]),_:1})]),_:1})]),_:1})),i(K,{cols:"10",md:"5"},{default:r(()=>[Ot,i(pe,null,{default:r(()=>[(u(!0),x(N,null,ee(d.value.map(P=>S.value.find(te=>te.AccommodationUUID==P)).filter(P=>P!==void 0),(P,te)=>(u(),x(N,null,[P?(u(),I(ce,{key:P.AccommodationUUID,title:`${te+1}. ${P.Name}`,class:Pe($.value.column===1&&$.value.id===P.AccommodationUUID?"bg-blue-accent-3":"border-dashed border"),onClick:Q=>$.value={column:1,id:(P==null?void 0:P.AccommodationUUID)||""},"append-icon":c(p)?"":"mdi:mdi-gesture-tap",onDblclick:L[6]||(L[6]=Q=>oe())},null,8,["title","class","onClick","append-icon"])):M("",!0)],64))),256))]),_:1}),_t]),_:1}),c(p)?M("",!0):(u(),I(K,{key:1,cols:"2",md:"1"},{default:r(()=>[i(W,{class:"d-flex h-100 align-content-center mt-3"},{default:r(()=>[i(K,{cols:"12"},{default:r(()=>[i(me,{icon:"mdi:mdi-arrow-up",size:"small",onClick:L[7]||(L[7]=P=>fe()),color:"primary",title:"Higher Priority"})]),_:1}),i(K,{cols:"12"},{default:r(()=>[i(me,{icon:"mdi:mdi-arrow-down",size:"small",onClick:L[8]||(L[8]=P=>X()),color:"secondary",title:"Lower Priority"})]),_:1})]),_:1})]),_:1}))]),_:1})),(ve=V.value)!=null&&ve.Leader?(u(),I(Ne,{key:2,modelValue:C.value,"onUpdate:modelValue":L[9]||(L[9]=P=>C.value=P),disabled:c(p)||!1,"persistent-hint":g.persistentHint||!1,"error-messages":g.errorMessages||"",rules:[F.value.required],class:"accommodation-field-warning"},null,8,["modelValue","disabled","persistent-hint","error-messages","rules"])):M("",!0)],64)}}});const wt=Ie({__name:"AgeCheck",props:ne({disabled:{type:Boolean},hint:{},label:{},name:{},items:{},persistentHint:{type:Boolean},required:{type:Boolean},errorMessages:{}},{modelValue:{required:!0}}),emits:ne(["blur","change","update:items"],["update:modelValue"]),setup(e,{emit:f}){const l=e,R=He(l,f,void 0,void 0,"items"),y=Te(e,"modelValue"),p=O({required:t=>!l.required||!!t||"Required.",min:t=>{var o,A;const d=new Date,m=d.getFullYear(),V=(d.getMonth()+1).toLocaleString("en-US",{minimumIntegerDigits:2}),s=d.getDate().toLocaleString("en-US",{minimumIntegerDigits:2}),D=((o=R.value.find(_=>_.Title=="MIN_AGE"))==null?void 0:o.Value)||"18",a=((A=R.value.find(_=>_.Title=="BEFORE_DATE"))==null?void 0:A.Value)||`${m}-${V}-${s}`,n=k(a);return b(t,a,parseInt(D))||`You must be at least ${D} years old by ${n.toLocaleDateString(navigator.language,{timeZone:"UTC"})}.`}}),C=()=>(f("blur"),!(p.value.min(y.value||"")!==!0||p.value.required(y.value||"")!==!0)),b=(t,d,m)=>{if(t>=d)return!1;const V=k(t),D=k(d).getTime()-V.getTime(),a=1e3*60*60*24*365.25;return D/a>=m},k=t=>{const[d,m,V]=t.split("-");return new Date(parseInt(d),parseInt(m)-1,parseInt(V))},v=(t=void 0)=>{setTimeout(()=>f("change",t),100)};return(t,d)=>(u(),I(Ve,{modelValue:y.value,"onUpdate:modelValue":d[0]||(d[0]=m=>y.value=m),type:"date",hint:t.hint||"",label:t.label||"",name:t.name||"",variant:"outlined",disabled:t.disabled||!1,"persistent-hint":t.persistentHint||!1,"error-messages":t.errorMessages||"",rules:[p.value.required,p.value.min],onBlur:C,onChange:v},null,8,["modelValue","hint","label","name","disabled","persistent-hint","error-messages","rules"]))}}),Mt=Le({...kl({falseIcon:"$radioOff",trueIcon:"$radioOn"})},"VRadio"),Lt=Be()({name:"VRadio",props:Mt(),setup(e,f){let{slots:l}=f;return Ge(()=>i(sl,he(e,{class:["v-radio",e.class],style:e.style,type:"radio"}),l)),{}}});const Pt=Le({height:{type:[Number,String],default:"auto"},...Nl(),...ol(Sl(),["multiple"]),trueIcon:{type:ze,default:"$radioOn"},falseIcon:{type:ze,default:"$radioOff"},type:{type:String,default:"radio"}},"VRadioGroup"),$t=Be()({name:"VRadioGroup",inheritAttrs:!1,props:Pt(),emits:{"update:modelValue":e=>!0},setup(e,f){let{attrs:l,slots:R}=f;const y=Il(),p=de(()=>e.id||`radio-group-${y}`),C=we(e,"modelValue");return Ge(()=>{const[b,k]=Tl(l),[v,t]=Ne.filterProps(e),[d,m]=sl.filterProps(e),V=R.label?R.label({label:e.label,props:{for:p.value}}):e.label;return i(Ne,he({class:["v-radio-group",e.class],style:e.style},b,v,{modelValue:C.value,"onUpdate:modelValue":s=>C.value=s,id:p.value}),{...R,default:s=>{let{id:D,messagesId:a,isDisabled:n,isReadonly:o}=s;return i(N,null,[V&&i(Bl,{id:D.value},{default:()=>[V]}),i(El,he(d,{id:D.value,"aria-describedby":a.value,defaultsTarget:"VRadio",trueIcon:e.trueIcon,falseIcon:e.falseIcon,type:e.type,disabled:n.value,readonly:o.value,"aria-labelledby":V?D.value:void 0,multiple:!1},k,{modelValue:C.value,"onUpdate:modelValue":A=>C.value=A}),R)])}})}),{}}}),al=Ie({__name:"FormField",props:ne({admin:{type:Boolean},convention:{},name:{},field:{},disabled:{type:Boolean},maxLength:{},minLength:{},persistentHint:{type:Boolean},registrationGroup:{},required:{type:Boolean}},{modelValue:{required:!0}}),emits:ne(["change","input","update:field"],["update:modelValue"]),setup(e,{emit:f}){const l=e,{admin:R=!1,disabled:y=!1,persistentHint:p=!1,required:C=!1}=l,b=O(""),k=Te(e,"modelValue"),v=He(l,f,void 0,void 0,"field"),t=O(De(v.value)),d=O({maxlength:a=>!l.maxLength||a.length<=l.maxLength||`Maximum length is ${l.maxLength} characters. (Current length: ${a.length})`,minlength:a=>!l.minLength||a.length>=l.minLength||`Minimum length is ${l.minLength} characters. (Current length: ${a.length})`,required:a=>!l.required||!!a.replace(/\s/g,"")||"Required field."}),m=O(!1),V=O([]),s=O("");try{const a=JSON.parse(k.value);Array.isArray(a)?V.value=a:typeof a=="boolean"?m.value=a:s.value=k.value}catch{m.value=!1,V.value=[],s.value=k.value}Z(m,()=>{k.value=JSON.stringify(m.value),f("input"),f("change")}),Z(V,()=>{k.value=JSON.stringify(V.value),f("input"),f("change")},{deep:!0}),Z(s,()=>{k.value=s.value,f("input"),f("change")}),Z(v.value,()=>{t.value.Type!==v.value.Type?(t.value=De(v.value),m.value=!1,V.value=[],s.value=""):t.value=De(v.value)});const D=(a=void 0)=>{f("change",a)};return(a,n)=>t.value.Type===c(ie).TEXT?(u(),I(Ve,{key:0,modelValue:s.value,"onUpdate:modelValue":n[0]||(n[0]=o=>s.value=o),name:a.name||"",hint:t.value.Hint,label:`${t.value.Label}${c(C)?"*":""}`,placeholder:t.value.Placeholder,variant:"outlined",disabled:c(y)||!1,"persistent-hint":c(p)||!1,"error-messages":b.value,rules:[d.value.maxlength,d.value.minlength,d.value.required],onChange:D,autocomplete:"off"},null,8,["modelValue","name","hint","label","placeholder","disabled","persistent-hint","error-messages","rules"])):t.value.Type===c(ie).DATE?(u(),I(Ve,{key:1,modelValue:s.value,"onUpdate:modelValue":n[1]||(n[1]=o=>s.value=o),type:"date",name:a.name||"",hint:t.value.Hint,label:t.value.Label,placeholder:t.value.Placeholder,variant:"outlined",disabled:c(y)||!1,"persistent-hint":c(p)||!1,"error-messages":b.value,rules:[d.value.maxlength,d.value.minlength,d.value.required],onChange:D,autocomplete:"off"},null,8,["modelValue","name","hint","label","placeholder","disabled","persistent-hint","error-messages","rules"])):t.value.Type===c(ie).NUMBER?(u(),I(Ve,{key:2,modelValue:s.value,"onUpdate:modelValue":n[2]||(n[2]=o=>s.value=o),type:"number",name:a.name||"",hint:t.value.Hint,label:t.value.Label,placeholder:t.value.Placeholder,variant:"outlined",disabled:c(y)||!1,"persistent-hint":c(p)||!1,"error-messages":b.value,rules:[d.value.maxlength,d.value.minlength,d.value.required],onChange:D,autocomplete:"off"},null,8,["modelValue","name","hint","label","placeholder","disabled","persistent-hint","error-messages","rules"])):t.value.Type===c(ie).TEXTAREA?(u(),I(Hl,{key:3,modelValue:s.value,"onUpdate:modelValue":n[3]||(n[3]=o=>s.value=o),name:a.name||"",hint:t.value.Hint,label:t.value.Label,placeholder:t.value.Placeholder,variant:"outlined",disabled:c(y)||!1,"persistent-hint":c(p)||!1,"error-messages":b.value,rules:[d.value.maxlength,d.value.minlength,d.value.required],onChange:D,autocomplete:"off"},null,8,["modelValue","name","hint","label","placeholder","disabled","persistent-hint","error-messages","rules"])):t.value.Type===c(ie).CHECKBOX?(u(),x(N,{key:4},[t.value.Multiple?(u(!0),x(N,{key:0},ee(t.value.Values,o=>(u(),I(be,{key:o.ID,modelValue:V.value,"onUpdate:modelValue":n[4]||(n[4]=A=>V.value=A),name:a.name||"",hint:t.value.Hint,label:o.Title,value:o.Value,disabled:c(y)||!1,"persistent-hint":c(p),"error-messages":b.value,rules:[d.value.required],onChange:D},null,8,["modelValue","name","hint","label","value","disabled","persistent-hint","error-messages","rules"]))),128)):(u(),I(be,{key:1,modelValue:m.value,"onUpdate:modelValue":n[5]||(n[5]=o=>m.value=o),name:a.name||"",hint:t.value.Hint,label:t.value.Label,disabled:c(y)||!1,"persistent-hint":c(p),"error-messages":b.value,required:c(C),rules:[o=>!c(C)||!!o||"You must tick to continue!"],onChange:D},null,8,["modelValue","name","hint","label","disabled","persistent-hint","error-messages","required","rules"]))],64)):t.value.Type===c(ie).SELECT?(u(),x(N,{key:5},[!t.value.Autofill&&t.value.Multiple?(u(),I(qe,{key:0,modelValue:V.value,"onUpdate:modelValue":n[6]||(n[6]=o=>V.value=o),name:a.name||"",hint:t.value.Hint,label:t.value.Label,multiple:"",items:t.value.Values,"item-title":"Title","item-value":"Value",variant:"outlined",disabled:c(y)||!1,"persistent-hint":c(p)||!1,"error-messages":b.value,rules:[d.value.required]},null,8,["modelValue","name","hint","label","items","disabled","persistent-hint","error-messages","rules"])):t.value.Autofill&&t.value.Multiple?(u(),I(ll,{key:1,modelValue:V.value,"onUpdate:modelValue":n[7]||(n[7]=o=>V.value=o),name:a.name||"",hint:t.value.Hint,label:t.value.Label,multiple:"",items:t.value.Values,"item-title":"Title","item-value":"Value",variant:"outlined",disabled:c(y)||!1,"persistent-hint":c(p)||!1,"error-messages":b.value,rules:[d.value.required]},null,8,["modelValue","name","hint","label","items","disabled","persistent-hint","error-messages","rules"])):t.value.Autofill?t.value.Autofill?(u(),I(ll,{key:3,modelValue:s.value,"onUpdate:modelValue":n[9]||(n[9]=o=>s.value=o),name:a.name||"",hint:t.value.Hint,label:t.value.Label,items:t.value.Values,"item-title":"Title","item-value":"Value",variant:"outlined",disabled:c(y)||!1,"persistent-hint":c(p)||!1,"error-messages":b.value,rules:[d.value.required]},null,8,["modelValue","name","hint","label","items","disabled","persistent-hint","error-messages","rules"])):M("",!0):(u(),I(qe,{key:2,modelValue:s.value,"onUpdate:modelValue":n[8]||(n[8]=o=>s.value=o),name:a.name||"",hint:t.value.Hint,label:t.value.Label,items:t.value.Values,"item-title":"Title","item-value":"Value",variant:"outlined",disabled:c(y)||!1,"persistent-hint":c(p)||!1,"error-messages":b.value,rules:[d.value.required]},null,8,["modelValue","name","hint","label","items","disabled","persistent-hint","error-messages","rules"]))],64)):t.value.Type===c(ie).RADIO?(u(),I($t,{key:6,modelValue:s.value,"onUpdate:modelValue":n[10]||(n[10]=o=>s.value=o),name:a.name||"",hint:t.value.Hint,label:t.value.Label,disabled:c(y)||!1,"persistent-hint":c(p),"error-messages":b.value,rules:[d.value.required],onChange:D},{default:r(()=>[(u(!0),x(N,null,ee(t.value.Values,o=>(u(),I(Lt,{key:o.Value,label:o.Title,value:o.Value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","name","hint","label","disabled","persistent-hint","error-messages","rules"])):t.value.Type===c(ie).ACCOMMODATION?(u(),I(Rt,{key:7,modelValue:V.value,"onUpdate:modelValue":n[11]||(n[11]=o=>V.value=o),name:a.name,admin:c(R),convention:a.convention,"registration-group":a.registrationGroup,data:a.field.Data,hint:t.value.Hint,label:t.value.Label,items:t.value.Values,disabled:c(y)||!1,"persistent-hint":c(p),"error-messages":b.value,required:c(C),onChange:D},null,8,["modelValue","name","admin","convention","registration-group","data","hint","label","items","disabled","persistent-hint","error-messages","required"])):t.value.Type===c(ie).AGE?(u(),I(wt,{key:8,modelValue:s.value,"onUpdate:modelValue":n[12]||(n[12]=o=>s.value=o),name:a.name,hint:t.value.Hint,label:t.value.Label,items:t.value.Values,disabled:c(y)||!1,"persistent-hint":c(p),"error-messages":b.value,onChange:D},null,8,["modelValue","name","hint","label","items","disabled","persistent-hint","error-messages"])):t.value.Type===c(ie).EXTRAS?(u(),I(it,{key:9,modelValue:s.value,"onUpdate:modelValue":n[13]||(n[13]=o=>s.value=o),admin:c(R),convention:a.convention,name:a.name,hint:t.value.Hint,label:t.value.Label,items:t.value.Values,disabled:c(y)||!1,"persistent-hint":c(p),"error-messages":b.value,required:c(C),onChange:D},null,8,["modelValue","admin","convention","name","hint","label","items","disabled","persistent-hint","error-messages","required"])):t.value.Type===c(ie).INTERESTS?(u(),I(rt,{key:10,modelValue:s.value,"onUpdate:modelValue":n[14]||(n[14]=o=>s.value=o),admin:c(R),convention:a.convention,name:a.name,hint:t.value.Hint,label:t.value.Label,items:t.value.Values,disabled:c(y)||!1,"persistent-hint":c(p),"error-messages":b.value,required:c(C),onChange:D},null,8,["modelValue","admin","convention","name","hint","label","items","disabled","persistent-hint","error-messages","required"])):t.value.Type===c(ie).TICKET?(u(),I(vt,{key:11,modelValue:s.value,"onUpdate:modelValue":n[15]||(n[15]=o=>s.value=o),admin:c(R),convention:a.convention,name:a.name,"registration-group":a.registrationGroup,hint:t.value.Hint,label:t.value.Label,items:t.value.Values,disabled:c(y)||!1,"persistent-hint":c(p),"error-messages":b.value,required:c(C),onChange:D},null,8,["modelValue","admin","convention","name","registration-group","hint","label","items","disabled","persistent-hint","error-messages","required"])):M("",!0)}}),xt={key:0,class:"my-2 text-white text-center"},Ft={key:1,class:"admin-header my-2 text-white text-center"},qt=["innerHTML"],Nt=["innerHTML"],fa=Ie({__name:"FormRenderer",props:ne({admin:{type:Boolean},convention:{},data:{},editable:{type:Boolean},preview:{type:Boolean},registrationGroup:{}},{modelValue:{required:!0}}),emits:ne(["close"],["update:modelValue"]),setup(e,{emit:f}){const l=Te(e,"modelValue");Oe(l.value.Sections),l.value.Sections.forEach(E=>{E.Fields&&Oe(E.Fields)});const R=O(),y=Wl(),p=il(),C=O(!1),b=O(!1),k=O(!1),v=O(!1),t=O(!1),d=O(!1),m=O(!1),V=O(!1),s=O(!1),D=O(!1),a=O(!1),n=O((()=>{if(e.data!==void 0){const h=De(e.data);return l.value.Sections.forEach(S=>{S.Fields&&S.Fields.forEach(U=>{const w=e.data.Data.find($=>$.SectionFieldUUID===U.SectionFieldUUID&&$.SectionFieldUUID==U.SectionFieldUUID);if(w)U.Value=w.Data;else{const $={ID:0,SubmissionDataUUID:$e(),SubmissionID:e.data.ID,SubmissionUUID:e.data.SubmissionUUID,SectionID:S.ID,SectionUUID:S.SectionUUID,SectionFieldID:U.ID,SectionFieldUUID:U.SectionFieldUUID,Data:U.Value,CreatedAt:"",DeletedAt:"",UpdatedAt:""};h.Data.push($),U.Value=""}})}),h}const E={ID:0,SubmissionUUID:$e(),FormID:l.value.ID,FormUUID:l.value.FormUUID,UserID:(y==null?void 0:y.ID)||0,UserUUID:(y==null?void 0:y.UserUUID)||"",Data:[],Status:Vl.SUBMISSION_STATUS_OPEN};return E.Data=l.value.Sections.map(h=>h.Fields?h.Fields.map(S=>({ID:0,SubmissionDataUUID:$e(),SubmissionID:E.ID,SubmissionUUID:E.SubmissionUUID,SectionID:h.ID,SectionUUID:h.SectionUUID,SectionFieldID:S.ID,SectionFieldUUID:S.SectionFieldUUID,Data:""})):[]).flat(),E})()),o=(E,h,S)=>{const U=n.value.Data.find(w=>w.SectionUUID===E&&w.SectionFieldUUID===h);U&&(U.Data=S)},A=(E,h,S,U,w)=>E&&E.Type===ue.FORM_TYPE_REGISTRATION?h?`/register/${e.convention.Slug||e.convention.ConventionUUID}/accommodation`:S?`/register/${e.convention.Slug||e.convention.ConventionUUID}/dealer`:U?`/register/${e.convention.Slug||e.convention.ConventionUUID}/badgeForm`:w?`/register/${e.convention.Slug||e.convention.ConventionUUID}/additional`:"/":E&&E.Type===ue.FORM_TYPE_ACCOMMODATION?S?`/register/${e.convention.Slug||e.convention.ConventionUUID}/dealer`:U?`/register/${e.convention.Slug||e.convention.ConventionUUID}/badge`:w?`/register/${e.convention.Slug||e.convention.ConventionUUID}/additional`:"/":E&&E.Type===ue.FORM_TYPE_DEALER?U?`/register/${e.convention.Slug||e.convention.ConventionUUID}/badge`:w?`/register/${e.convention.Slug||e.convention.ConventionUUID}/additional`:"/":E&&E.Type===ue.FORM_TYPE_BADGE?w?`/register/${e.convention.Slug||e.convention.ConventionUUID}/additional`:"/":(E&&E.Type===ue.FORM_TYPE_ADDITIONAL,"/"),_=({callback:E})=>{p.getRegistrationByConvention(e.convention.ConventionUUID).then(h=>{E&&E("Loading"),p.getAvailableConventionForms(e.convention.ConventionUUID).then(S=>{h.Submissions.forEach((X,g)=>{X.Form||(h.Submissions[g].Form=S.find(L=>L.FormUUID===X.FormUUID))});const U=h.Submissions.find(X=>X.FormUUID===n.value.FormUUID),w=h.Submissions.find(X=>{var g;return((g=X.Form)==null?void 0:g.Type)===ue.FORM_TYPE_ACCOMMODATION}),$=h.Submissions.find(X=>{var g;return((g=X.Form)==null?void 0:g.Type)===ue.FORM_TYPE_ADDITIONAL}),le=h.Submissions.find(X=>{var g;return((g=X.Form)==null?void 0:g.Type)===ue.FORM_TYPE_DEALER}),oe=h.Submissions.find(X=>{var g;return((g=X.Form)==null?void 0:g.Type)===ue.FORM_TYPE_BADGE}),fe=A(U==null?void 0:U.Form,w==null?void 0:w.Form,le==null?void 0:le.Form,oe==null?void 0:oe.Form,$==null?void 0:$.Form);Qe.push(fe)})})},F=({callback:E})=>{var h;(h=R.value)==null||h.validate().then(S=>{S.valid?p.saveSubmission(n.value).then(U=>{U?setTimeout(()=>{q(U,E,1)},1e3):E&&E("Failed to process request")}).catch(()=>{E&&E("Failed to process request")}):E&&E("Errors in form detected, please review and try again.")})},q=(E,h,S=1)=>{p.checkSubmission(E).then(U=>{if(U)if(U.Ready&&U.Submission){if(C.value=!1,n.value=U.Submission,h&&h("Saved"),e.admin)f("close");else if(U.Forms&&U.Forms.length>0){const w=U.Forms.find(g=>g.FormUUID===n.value.FormUUID),$=U.Forms.find(g=>g.Type===ue.FORM_TYPE_ACCOMMODATION),le=U.Forms.find(g=>g.Type===ue.FORM_TYPE_DEALER),oe=U.Forms.find(g=>g.Type===ue.FORM_TYPE_BADGE),fe=U.Forms.find(g=>g.Type===ue.FORM_TYPE_ADDITIONAL),X=A(w,$,le,oe,fe);Qe.push(X)}}else{if(S>5&&(C.value=!0),S>10&&(b.value=!0),S>20&&(k.value=!0),S>30&&(v.value=!0),S>40&&(t.value=!0),S>50&&(d.value=!0),S>60&&(m.value=!0),S>70&&(V.value=!0),S>80&&(s.value=!0),S>90&&(D.value=!0),S>100&&(a.value=!0),S>200){h&&(C.value=!1,b.value=!1,k.value=!1,v.value=!1,t.value=!1,d.value=!1,m.value=!1,V.value=!1,s.value=!1,D.value=!1,a.value=!1,h("A problem was encountered during saving, please check form and try again."));return}setTimeout(()=>{q(E,h,S+1)},S<20?1e3*S:2e4)}else h&&(C.value=!1,b.value=!1,k.value=!1,v.value=!1,t.value=!1,d.value=!1,m.value=!1,V.value=!1,s.value=!1,D.value=!1,a.value=!1,h("A problem was encountered during saving, please check form and try again."))}).catch(()=>{h&&(C.value=!1,b.value=!1,k.value=!1,v.value=!1,t.value=!1,d.value=!1,m.value=!1,V.value=!1,s.value=!1,D.value=!1,a.value=!1,h("A problem was encountered during saving, please check form and try again."))})};return(E,h)=>{const S=Dl("router-link");return u(),I($l,null,{default:r(()=>[i(Zl,{ref_key:"formValidator",ref:R,autocomplete:"off",onSubmit:h[1]||(h[1]=ul(()=>{},["prevent"]))},{default:r(()=>[l.value.Heading?(u(),x("h1",xt,z(l.value.Heading),1)):M("",!0),E.admin?(u(),x("h2",Ft," (Admin Mode) ")):M("",!0),l.value.Description?(u(),x("div",{key:2,class:"my-2 form-description-container pa-5 border rounded-lg text-black",innerHTML:l.value.Description},null,8,qt)):M("",!0),(u(!0),x(N,null,ee(l.value.Sections,U=>(u(),I(Xl,{key:`section_${l.value.ID}.${U.ID}`,class:"my-4 section-container rounded-lg",elevation:"4"},{default:r(()=>[U.Heading?(u(),I(jl,{key:0},{default:r(()=>[H(z(U.Heading),1)]),_:2},1024)):M("",!0),U.Description?(u(),I(zl,{key:1,class:"text-wrap"},{default:r(()=>[G("div",{innerHTML:U.Description},null,8,Nt)]),_:2},1024)):M("",!0),U.Fields?(u(),I(Ql,{key:2},{default:r(()=>[(u(!0),x(N,null,ee(U.Fields,w=>(u(),x(N,{key:`field_${l.value.ID}.${U.ID}.${w.ID}`},[w.Field?(u(),I(W,{key:0},{default:r(()=>[i(K,null,{default:r(()=>[E.editable?(u(),I(al,{key:0,name:w.SectionFieldUUID,field:w.Field,modelValue:w.Value,"onUpdate:modelValue":$=>w.Value=$,admin:E.admin,convention:E.convention,"registration-group":E.registrationGroup,required:w.Required,"min-length":w.MinLength,"max-length":w.MaxLength,"persistent-hint":!0,onChange:$=>o(U.SectionUUID,w.SectionFieldUUID,w.Value)},null,8,["name","field","modelValue","onUpdate:modelValue","admin","convention","registration-group","required","min-length","max-length","onChange"])):(u(),I(al,{key:1,name:w.SectionFieldUUID,field:w.Field,modelValue:w.Value,"onUpdate:modelValue":$=>w.Value=$,admin:E.admin,convention:E.convention,"registration-group":E.registrationGroup,required:w.Required,"min-length":w.MinLength,"max-length":w.MaxLength,"persistent-hint":!0,disabled:"",onChange:$=>o(U.SectionUUID,w.SectionFieldUUID,w.Value)},null,8,["name","field","modelValue","onUpdate:modelValue","admin","convention","registration-group","required","min-length","max-length","onChange"]))]),_:2},1024)]),_:2},1024)):M("",!0)],64))),128))]),_:2},1024)):M("",!0)]),_:2},1024))),128)),E.preview?M("",!0):(u(),x(N,{key:3},[i(W,null,{default:r(()=>[E.admin?(u(),I(K,{key:1,class:"text-right"},{default:r(()=>[i(me,{color:"red",onClick:h[0]||(h[0]=U=>f("close"))},{default:r(()=>[H("Cancel")]),_:1})]),_:1})):(u(),I(K,{key:0,class:"text-right"},{default:r(()=>[i(S,{to:{name:"Home"},class:"text-decoration-none text-white"},{default:r(()=>[i(me,{color:"red"},{default:r(()=>[H("Close")]),_:1})]),_:1})]),_:1})),E.admin||E.editable?(u(),I(K,{key:2,class:"text-left"},{default:r(()=>[i(Ze,{onClick:F,type:"submit"})]),_:1})):(u(),I(K,{key:3,class:"text-left"},{default:r(()=>[i(Ze,{onClick:_,type:"submit",label:"Next",color:"green"})]),_:1}))]),_:1}),C.value?(u(),I(W,{key:0},{default:r(()=>[i(K,{class:"bg-red-accent-4 border rounded-lg text-center mb-2"},{default:r(()=>[H(" Your request is currently queued for processing. We have received your data, you do not need to resubmit it or refresh. The next page will load once the system has processed your details. Please be patient as this may take a while. ")]),_:1})]),_:1})):M("",!0),b.value?(u(),I(W,{key:1},{default:r(()=>[i(K,{class:"bg-red-accent-4 border rounded-lg text-center mb-2"},{default:r(()=>[H(" Honestly! It really is being handled by our systems, the web browser window will continue, to monitor progress whilst it remains open. ")]),_:1})]),_:1})):M("",!0),k.value?(u(),I(W,{key:2},{default:r(()=>[i(K,{class:"bg-red-accent-4 border rounded-lg text-center mb-2"},{default:r(()=>[H(" There seems to be a bit of Jam, don't worry because we have a fine selection of Jams at breakfast. Keep holding on in there, we'll get you on your way soon. ")]),_:1})]),_:1})):M("",!0),v.value?(u(),I(W,{key:3},{default:r(()=>[i(K,{class:"bg-red-accent-4 border rounded-lg text-center mb-2"},{default:r(()=>[H(" Reticulating splines ")]),_:1})]),_:1})):M("",!0),t.value?(u(),I(W,{key:4},{default:r(()=>[i(K,{class:"bg-red-accent-4 border rounded-lg text-center mb-2"},{default:r(()=>[H(" Downloading more RAM to process your registration. ")]),_:1})]),_:1})):M("",!0),d.value?(u(),I(W,{key:5},{default:r(()=>[i(K,{class:"bg-red-accent-4 border rounded-lg text-center mb-2"},{default:r(()=>[H(" Ever seen a loading screen with a jump scare? ")]),_:1})]),_:1})):M("",!0),m.value?(u(),I(W,{key:6},{default:r(()=>[i(K,{class:"bg-red-accent-4 border rounded-lg text-center mb-2"},{default:r(()=>[H(" We are not liable for any broken screens as a result of waiting. ")]),_:1})]),_:1})):M("",!0),V.value?(u(),I(W,{key:7},{default:r(()=>[i(K,{class:"bg-red-accent-4 border rounded-lg text-center mb-2"},{default:r(()=>[H(" Let's have a race, see if you can inflate a Puffy Paws pool toy by mouth before we finish. ")]),_:1})]),_:1})):M("",!0),s.value?(u(),I(W,{key:8},{default:r(()=>[i(K,{class:"bg-red-accent-4 border rounded-lg text-center mb-2"},{default:r(()=>[H(" Apparently there were just under 1,000 of you at Scotiacon 2023, so where did the other 4,000 appear from? ")]),_:1})]),_:1})):M("",!0),D.value?(u(),I(W,{key:9},{default:r(()=>[i(K,{class:"bg-red-accent-4 border rounded-lg text-center mb-2"},{default:r(()=>[H(" Jesus titty fucking christ! Why are there so many of you, this is ridiculous. We're still working on your request, please don't panic. ")]),_:1})]),_:1})):M("",!0),a.value?(u(),I(W,{key:10},{default:r(()=>[i(K,{class:"bg-red-accent-4 border rounded-lg text-center mb-2"},{default:r(()=>[H(" We've run out of silly things to say, but if the save button is still spinning then the registration request is still queued for processing. ")]),_:1})]),_:1})):M("",!0)],64))]),_:1},512)]),_:1})}}});export{ra as F,dl as T,ll as V,al as _,va as a,da as b,ie as c,fa as d,ma as e,lt as f,ca as m,Oe as s,at as u};
