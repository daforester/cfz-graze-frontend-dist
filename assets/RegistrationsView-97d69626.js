import{p as Ua,d as Aa,c as ne,t as pe,a0 as ll,a1 as ht,f as t,F as k,m as ke,i as Q,M as X,N as ae,r as p,k as _e,w as me,n as i,q as E,v as n,C as y,D as B,y as I,B as _,Q as W,x as C,A as L,P as Ae,G as Ft,H as $t,_ as rt,a2 as qe,O as je,a3 as nl,X as et,o as ol,b as il,a4 as sl,a5 as ul,a6 as Zt,z as bt,a7 as ga,a8 as ea,Z as st,a9 as rl,aa as vt,I as dl,u as ml,ab as cl,K as vl,J as fl,s as Ul,ac as ft,ad as ta,V as Al,U as gl,E as Tl}from"./index-b5abcb9c.js";import{T as _l,V as Ta,e as pl,c as _a,d as yl}from"./FormRenderer.vue_vue_type_style_index_0_lang-90b63e41.js";import{F as Te,a as El}from"./form-3a7bf7fd.js";import{u as dt,V as kt}from"./VCheckbox-0ee7cae8.js";import{_ as tt}from"./ModelDialog.vue_vue_type_script_setup_true_lang-81346f1e.js";import{h as Re,b as pa,a as Dl,c as Il,d as aa,P as Mt,u as ya}from"./useDisplayTransactions-3eb0b3f5.js";import{V as J,a as M}from"./VRow-98a5e11e.js";import{V as He,a as Ne,c as Nt}from"./VList-0258b68c.js";import{V as de}from"./copyToClipboard-2e720fca.js";import{u as Ea,a as fe,V as Ce,b as Sl,m as Rl,j as Cl,c as Vl,d as Ol,k as hl,e as bl,l as kl}from"./VContainer-d4c2877e.js";import{G as at}from"./userData-1d1266ac.js";import{C as Bt}from"./canEditRegistrations-68b5b4be.js";import{V as j,a as Da,u as Ml}from"./VBtn-7d29c3b3.js";import{b as Ia,c as Yt,S as Sa,d as la}from"./submission-6136b51d.js";import{G as Gt}from"./group-d2a77946.js";import{C as xt}from"./canDo-99eb87c2.js";import{a as At,V as Le}from"./scopeId-1380f124.js";import{V as ze,b as lt,c as Qe,d as Ht,e as Pe}from"./VCard-1e787068.js";import{V as qt}from"./VAvatar-4c2465ae.js";import{V as oe}from"./VTextField-05cbab1a.js";import{v as Ee}from"./v4-a960c1f4.js";import{_ as ut,V as Ra}from"./SaveButton.vue_vue_type_script_setup_true_lang-89994a64.js";import{m as Nl,k as Ll,l as Pl,n as wl,o as Fl,p as $l,q as Bl,u as Yl,r as Gl,s as xl,t as Hl,v as ql,w as jl,x as zl,y as Ql,z as na,A as oa,B as ia,c as gt,d as Tt,e as jt,b as _t,V as pt,a as Ca,g as Va,h as Oa,_ as ha,j as ba,i as xe,f as Lt}from"./VWindowItem-5be18ecd.js";import{_ as ka}from"./DeleteDialog.vue_vue_type_script_setup_true_lang-c11fdae2.js";import{a as Ma,V as Pt}from"./VToolbar-a848f7a4.js";import{V as Kl}from"./VDivider-359953db.js";import{V as Xl}from"./VTextarea-cd965534.js";import{V as Na,a as wt}from"./VChip-b5ff60a3.js";import{V as Ut}from"./VDialog-731f8802.js";import{V as Wl}from"./VForm-ea8ca88d.js";import{b as Jl,V as Zl}from"./VNavigationDrawer-4b1e7232.js";import{s as en}from"./sortSubmissions-4bc1d48e.js";import{V as tn,a as an}from"./VAlert-40a07731.js";import{S as ln}from"./setupLogin-b4f4fad6.js";import{V as nn}from"./forwardRefs-d2af5917.js";import{u as Vt}from"./nil-d01db1aa.js";import{V as sa,a as on}from"./VTable-43beb4ff.js";import"./index-26b71cef.js";import"./VFileInput-7a5b5d65.js";import"./createSimpleFunctional-bb20caaa.js";import"./VToolbarItems-4468e5a1.js";var be=(e=>(e.ADMIN_LAYOUT_PANELS="ADMIN_LAYOUT_PANELS",e.ADMIN_LAYOUT_TABLE="ADMIN_LAYOUT_TABLE",e))(be||{});const sn=[{title:"Panel Layout",value:"ADMIN_LAYOUT_PANELS"},{title:"Table Layout",value:"ADMIN_LAYOUT_TABLE"}];var Me=(e=>(e.LAYOUT_ITEM_SOURCE_FORM="LAYOUT_ITEM_SOURCE_FORM",e.LAYOUT_ITEM_SOURCE_META="LAYOUT_ITEM_SOURCE_META",e.LAYOUT_ITEM_SOURCE_USER="LAYOUT_ITEM_SOURCE_USER",e))(Me||{});const un=[{title:"Form Field Submission Data",value:"LAYOUT_ITEM_SOURCE_FORM"},{title:"Miscellaneous Data",value:"LAYOUT_ITEM_SOURCE_META"},{title:"User Profile Data",value:"LAYOUT_ITEM_SOURCE_USER"}];var H=(e=>(e.META_DATA_SOURCE_NULL="",e.META_DATA_SOURCE_ACCOMMODATION_ALLOCATION="META_DATA_SOURCE_ACCOMMODATION_ALLOCATION",e.META_DATA_SOURCE_ACCOMMODATION_FORM="META_DATA_SOURCE_ACCOMMODATION_FORM",e.META_DATA_SOURCE_ADMIN_FORM="META_DATA_SOURCE_ADMIN_FORM",e.META_DATA_SOURCE_BADGE_DISPLAY="META_DATA_SOURCE_BADGE_DISPLAY",e.META_DATA_SOURCE_BADGE_FORM="META_DATA_SOURCE_BADGE_FORM",e.META_DATA_SOURCE_DATA_LAYOUT="META_DATA_SOURCE_DATA_LAYOUT",e.META_DATA_SOURCE_DEALER_FORM="META_DATA_SOURCE_DEALER_FORM",e.META_DATA_SOURCE_EMAILS="META_DATA_SOURCE_EMAILS",e.META_DATA_SOURCE_NOTES="META_DATA_SOURCE_NOTES",e.META_DATA_SOURCE_PAYMENT_STATUS="META_DATA_SOURCE_PAYMENT_STATUS",e.META_DATA_SOURCE_PAYMENTS="META_DATA_SOURCE_PAYMENTS",e.META_DATA_SOURCE_REGISTRATION_ACTIONS="META_DATA_SOURCE_REGISTRATION_ACTIONS",e.META_DATA_SOURCE_REGISTRATION_FORM="META_DATA_SOURCE_REGISTRATION_FORM",e.META_DATA_SOURCE_REGISTRATION_GROUP="META_DATA_SOURCE_REGISTRATION_GROUP",e.META_DATA_SOURCE_REGISTRATION_REFERENCE="META_DATA_SOURCE_REGISTRATION_REFERENCE",e.META_DATA_SOURCE_SUBMISSION_DATE="META_DATA_SOURCE_SUBMISSION_DATE",e.META_DATA_SOURCE_SUBMISSION_STATUS="META_DATA_SOURCE_SUBMISSION_STATUS",e.META_DATA_SOURCE_TAGS="META_DATA_SOURCE_TAGS",e))(H||{});const rn=[{title:"Accommodation Allocation",value:"META_DATA_SOURCE_ACCOMMODATION_ALLOCATION"},{title:"Accommodation Form",value:"META_DATA_SOURCE_ACCOMMODATION_FORM"},{title:"Actions",value:"META_DATA_SOURCE_REGISTRATION_ACTIONS"},{title:"Badge Display",value:"META_DATA_SOURCE_BADGE_DISPLAY"},{title:"Badge Form",value:"META_DATA_SOURCE_BADGE_FORM"},{title:"Data Display",value:"META_DATA_SOURCE_DATA_LAYOUT"},{title:"Dealer Form",value:"META_DATA_SOURCE_DEALER_FORM"},{title:"Emails",value:"META_DATA_SOURCE_EMAILS"},{title:"Notes",value:"META_DATA_SOURCE_NOTES"},{title:"Payment Status",value:"META_DATA_SOURCE_PAYMENT_STATUS"},{title:"Payments",value:"META_DATA_SOURCE_PAYMENTS"},{title:"Registration Group",value:"META_DATA_SOURCE_REGISTRATION_GROUP"},{title:"Registration Reference",value:"META_DATA_SOURCE_REGISTRATION_REFERENCE"},{title:"Registration Form",value:"META_DATA_SOURCE_REGISTRATION_FORM"},{title:"Submission Date",value:"META_DATA_SOURCE_SUBMISSION_DATE"},{title:"Submission Status",value:"META_DATA_SOURCE_SUBMISSION_STATUS"},{title:"Tags",value:"META_DATA_SOURCE_TAGS"}];var ye=(e=>(e.PANEL_STYLE_FLEX="PANEL_STYLE_FLEX",e.PANEL_STYLE_NAV_BOTTOM="PANEL_STYLE_NAV_BOTTOM",e.PANEL_STYLE_NAV_LEFT="PANEL_STYLE_NAV_LEFT",e.PANEL_STYLE_NAV_RIGHT="PANEL_STYLE_NAV_RIGHT",e.PANEL_STYLE_NAV_TOP="PANEL_STYLE_NAV_TOP",e))(ye||{});const dn=[{title:"Body Flexible",value:"PANEL_STYLE_FLEX"},{title:"Fixed Bottom",value:"PANEL_STYLE_NAV_BOTTOM"},{title:"Fixed Left",value:"PANEL_STYLE_NAV_LEFT"},{title:"Fixed Right",value:"PANEL_STYLE_NAV_RIGHT"},{title:"Fixed Top",value:"PANEL_STYLE_NAV_TOP"}];var ie=(e=>(e.USER_DATA_SOURCE_NULL="",e.USER_DATA_SOURCE_DISPLAY_NAME="USER_DATA_SOURCE_DISPLAY_NAME",e.USER_DATA_SOURCE_HANDLE="USER_DATA_SOURCE_HANDLE",e.USER_DATA_SOURCE_AVATAR="USER_DATA_SOURCE_AVATAR",e.USER_DATA_SOURCE_FIRST_NAME="USER_DATA_SOURCE_FIRST_NAME",e.USER_DATA_SOURCE_LAST_NAME="USER_DATA_SOURCE_LAST_NAME",e.USER_DATA_SOURCE_DATE_OF_BIRTH="USER_DATA_SOURCE_DATE_OF_BIRTH",e.USER_DATA_SOURCE_EMAIL="USER_DATA_SOURCE_EMAIL",e.USER_DATA_SOURCE_TELEGRAM="USER_DATA_SOURCE_TELEGRAM",e))(ie||{});const mn=[{title:"Display Name",value:"USER_DATA_SOURCE_DISPLAY_NAME"},{title:"Handle",value:"USER_DATA_SOURCE_HANDLE"},{title:"Avatar",value:"USER_DATA_SOURCE_AVATAR"},{title:"First Name",value:"USER_DATA_SOURCE_FIRST_NAME"},{title:"Last Name",value:"USER_DATA_SOURCE_LAST_NAME"},{title:"Date of Birth",value:"USER_DATA_SOURCE_DATE_OF_BIRTH"},{title:"Email Address",value:"USER_DATA_SOURCE_EMAIL"},{title:"Telegram Username",value:"USER_DATA_SOURCE_TELEGRAM"}],cn=e=>{switch(e){case"EMAIL_STATUS_QUEUED":return"Queued";case"EMAIL_STATUS_QUEUE_ERROR":return"Processing";case"EMAIL_STATUS_QUEUE_FAILURE":return"Internal Error";case"EMAIL_STATUS_SENDING":return"Sending";case"EMAIL_STATUS_SENT":return"Sent";case"EMAIL_STATUS_SEND_ERROR":return"Failed to Send"}return"Unknown"},vn=e=>e===void 0?!1:xt(e,Gt.GROUP_TYPE_SYSTEM).ManageUsers,fn=Ua({itemsLength:{type:[Number,String],required:!0},...Nl(),...Ll(),...Pl()},"VDataTableServer"),Un=Aa()({name:"VDataTableServer",props:fn(),emits:{"update:modelValue":e=>!0,"update:page":e=>!0,"update:itemsPerPage":e=>!0,"update:sortBy":e=>!0,"update:options":e=>!0,"update:expanded":e=>!0,"update:groupBy":e=>!0,"click:row":(e,f)=>!0},setup(e,f){let{emit:l,slots:o}=f;const{groupBy:u}=wl(e),{sortBy:v,multiSort:m,mustSort:a}=Fl(e),{page:s,itemsPerPage:d}=$l(e),c=ne(()=>parseInt(e.itemsLength,10)),{columns:g,headers:r}=Bl(e,{groupBy:u,showSelect:pe(e,"showSelect"),showExpand:pe(e,"showExpand")}),{items:T}=Yl(e,g),{toggleSort:A}=Gl({sortBy:v,multiSort:m,mustSort:a,page:s}),{opened:F,isGroupOpen:V,toggleGroup:P,extractRows:U}=xl({groupBy:u,sortBy:v}),{pageCount:w,setItemsPerPage:Z}=Hl({page:s,itemsPerPage:d,itemsLength:c}),{flatItems:Y}=ql(T,u,F),{isSelected:G,select:te,selectAll:O,toggleSelect:b,someSelected:h,allSelected:R}=jl(e,{allItems:T,currentPage:T}),{isExpanded:x,toggleExpand:se}=zl(e),Ue=ne(()=>U(T.value));Ql({page:s,itemsPerPage:d,sortBy:v,groupBy:u,search:pe(e,"search")}),ll("v-data-table",{toggleSort:A,sortBy:v}),ht({VDataTableRows:{hideNoData:pe(e,"hideNoData"),noDataText:pe(e,"noDataText"),loading:pe(e,"loading"),loadingText:pe(e,"loadingText")}});const ce=ne(()=>({page:s.value,itemsPerPage:d.value,sortBy:v.value,pageCount:w.value,toggleSort:A,setItemsPerPage:Z,someSelected:h.value,allSelected:R.value,isSelected:G,select:te,selectAll:O,toggleSelect:b,isExpanded:x,toggleExpand:se,isGroupOpen:V,toggleGroup:P,items:Ue.value,groupedItems:Y.value,columns:g.value,headers:r.value}));Ea(()=>{const[Ke]=na.filterProps(e),[Xe]=oa.filterProps(e),[nt]=ia.filterProps(e),[We]=sa.filterProps(e);return t(sa,ke({class:["v-data-table",{"v-data-table--loading":e.loading},e.class],style:e.style},We),{top:()=>{var Ie;return(Ie=o.top)==null?void 0:Ie.call(o,ce.value)},default:()=>{var Ie,we,Fe,$e;return o.default?o.default(ce.value):t(k,null,[(Ie=o.colgroup)==null?void 0:Ie.call(o,ce.value),t("thead",{class:"v-data-table__thead",role:"rowgroup"},[t(oa,ke(Xe,{sticky:e.fixedHeader}),o)]),(we=o.thead)==null?void 0:we.call(o,ce.value),t("tbody",{class:"v-data-table__tbody",role:"rowgroup"},[o.body?o.body(ce.value):t(ia,ke(nt,{items:Y.value}),o)]),(Fe=o.tbody)==null?void 0:Fe.call(o,ce.value),($e=o.tfoot)==null?void 0:$e.call(o,ce.value)])},bottom:()=>o.bottom?o.bottom(ce.value):t(na,Ke,{prepend:o["footer.prepend"]})})})}}),An=B("br",null,null,-1),gn=B("h3",null,"Assigned Accommodation",-1),Tn=B("br",null,null,-1),_n=B("br",null,null,-1),pn=B("h3",null,"Accommodation Preferences",-1),yn=B("h3",null,"Selected Tickets",-1),En=B("br",null,null,-1),Dn=Q({__name:"EditAccommodationAssignmentDialog",props:X({convention:{},registration:{},selectedAccommodation:{},title:{}},{modelValue:{type:Boolean,required:!0}}),emits:X(["update:field"],["update:modelValue"]),setup(e,{emit:f}){const l=e,{convention:o,registration:u,title:v=""}=l,m=Ae(),a=ae(e,"modelValue"),s=p({capacity:{max:O=>{var R;const b=w.value.find(x=>x.room.RoomUUID===O);return!b||b.room.MaximumCapacity===0?!0:(((R=r.value)==null?void 0:R.Members.length)||0)<=b.room.MaximumCapacity||"Too many people in the group for this room"},min:O=>{var R;const b=w.value.find(x=>x.room.RoomUUID===O);return!b||b.room.MinimumCapacity===0?!0:(((R=r.value)==null?void 0:R.Members.length)||0)>=b.room.MinimumCapacity||"Not enough people in the group for this room"}}}),d=p([]),c=dt(l,f,void 0,void 0,"field"),g=p(_e(c.value));me(c,()=>{g.value=_e(c.value)});const r=p(),T=p(""),A=p(""),F=p([]),V=p({Ticket:[],AddonsChecked:[],ComponentsChecked:[]}),P=async()=>{var R;const O=await m.getConventionAvailableAccommodation(o.ConventionUUID);O&&(d.value=O);const b=await m.getRegistrationGroup(u.RegistrationUUID||"");b&&(r.value=b);const h=await m.getConventionTickets(o.ConventionUUID);h&&(F.value=h);try{V.value=JSON.parse(((R=r.value)==null?void 0:R.TicketData)||"")}catch{}};me(T,()=>{A.value=w.value.length>0?w.value[0].value:""});const U=ne(()=>{const O=Z.value;return d.value.map(b=>{let h;return O.forEach(R=>{b.Costs.forEach(x=>{x.DateStart===(R==null?void 0:R.DateStart)&&x.DateEnd===R.DateEnd&&(h===void 0||h>x.Availability)&&(h=x.Availability)})}),{label:`${b.Name}`,title:`${b.Name} (${h} Available)`,value:b.AccommodationUUID}})}),w=ne(()=>{const O=Z.value,b=d.value.find(h=>h.AccommodationUUID===T.value);return(b==null?void 0:b.Pool.map(h=>{var x,se;let R;return O.forEach(Ue=>{h.Costs.forEach(ce=>{ce.DateStart===(Ue==null?void 0:Ue.DateStart)&&ce.DateEnd===Ue.DateEnd&&(R===void 0||R>ce.Availability)&&(R=ce.Availability)})}),{label:`${(x=h.Venue)==null?void 0:x.Name} - ${h.Name}`,title:`${(se=h.Venue)==null?void 0:se.Name} - ${h.Name} (${R} Available)`,value:h.RoomUUID,room:h}}))||[]}),Z=ne(()=>[...V.value.Ticket,...V.value.AddonsChecked,...V.value.ComponentsChecked].map(O=>F.value.find(b=>b.TicketUUID===O)).filter(O=>O!==void 0&&O.RequiresAccommodation)),Y=O=>{var b;m.assignAccommodation(((b=r.value)==null?void 0:b.Registration.RegistrationUUID)||"",T.value,A.value,!1).then(h=>{h?(P(),O&&O("Room Assigned")):O&&O("Room not assigned")}).catch(()=>{O&&O("Room not assigned")})},G=O=>{var b,h;(b=r.value)!=null&&b.Registration.AllocationUUID?m.deleteAllocation(((h=r.value)==null?void 0:h.Registration.AllocationUUID)||"").then(R=>{R?(P(),O&&O("Allocation Deleted")):O&&O("Allocation not deleted")}).catch(()=>{O&&O("Allocation not deleted")}):O&&O("Nothing to Delete")},te=O=>{var h,R;const b=(h=d.value.find(x=>x.AccommodationUUID===O.AccommodationUUID))==null?void 0:h.Pool;if(b){const x=b.find(se=>se.RoomUUID===O.RoomUUID);if(x)return`${(R=x.Venue)==null?void 0:R.Name} - ${x.Name}`}return""};return P(),(O,b)=>{var h;return i(),E(tt,{modelValue:a.value,"onUpdate:modelValue":b[2]||(b[2]=R=>a.value=R),title:y(v),color:"primary","show-close-action":!0,"show-delete-action":!!((h=r.value)!=null&&h.Registration.Allocation),"show-save-action":!!A.value,"save-button-label":"Assign Room",onDelete:G,onSave:Y,fullscreen:!0,persistent:!0},{default:n(()=>[t(fe,{class:"pa-0",fluid:!0},{default:n(()=>[t(J,null,{default:n(()=>{var R;return[t(M,{cols:"12",md:"6"},{default:n(()=>{var x,se;return[B("h3",null,"Group Members ("+I((x=r.value)==null?void 0:x.Members.length)+")",1),(i(!0),_(k,null,W((se=r.value)==null?void 0:se.Members,Ue=>(i(),_(k,{key:Ue.UUID},[C(" #"+I(Ue.Reference)+" "+I(Ue.Name),1),An],64))),128))]}),_:1}),(R=r.value)!=null&&R.Registration.Allocation?(i(),E(M,{key:0,cols:"12",md:"6"},{default:n(()=>[gn,t(He,null,{default:n(()=>{var x;return[(i(!0),_(k,null,W((x=r.value)==null?void 0:x.Registration.Allocation.Periods,se=>(i(),E(Ne,{key:se.AllocationPeriodUUID},{default:n(()=>{var Ue;return[C(I((Ue=d.value.find(ce=>ce.AccommodationUUID===se.AccommodationUUID))==null?void 0:Ue.Name)+" ",1),Tn,C(" "+I(te(se))+" ",1),_n,B("small",null,"("+I(y(Re)(se.DateStart))+" - "+I(y(Re)(se.DateEnd))+")",1)]}),_:2},1024))),128))]}),_:1})]),_:1})):L("",!0)]}),_:1}),t(J,null,{default:n(()=>[t(M,{cols:"12",md:"6"},{default:n(()=>[O.selectedAccommodation.length?(i(),_(k,{key:0},[pn,t(He,null,{default:n(()=>[(i(!0),_(k,null,W(O.selectedAccommodation,(R,x)=>(i(),E(Ne,{key:R.AccommodationUUID},{default:n(()=>[C(I(x+1)+". "+I(R.Name),1)]),_:2},1024))),128))]),_:1})],64)):L("",!0)]),_:1}),t(M,{cosl:"12",md:"6"},{default:n(()=>[yn,t(He,null,{default:n(()=>[(i(!0),_(k,null,W(Z.value,R=>(i(),E(Ne,{key:R==null?void 0:R.TicketUUID},{default:n(()=>[C(I(R.Name)+" ",1),En,B("small",null,"("+I(y(Re)(R.DateStart))+" - "+I(y(Re)(R.DateEnd))+")",1)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1}),t(J,null,{default:n(()=>[t(M,{cols:"12",md:"6"},{default:n(()=>[t(de,{modelValue:T.value,"onUpdate:modelValue":b[0]||(b[0]=R=>T.value=R),items:U.value,"item-title":"title","item-value":"value",label:"Accommodation"},null,8,["modelValue","items"])]),_:1}),t(M,{cols:"12",md:"6"},{default:n(()=>[t(de,{modelValue:A.value,"onUpdate:modelValue":b[1]||(b[1]=R=>A.value=R),items:w.value,"item-title":"title","item-value":"value",label:"Room Pool",rules:[s.value.capacity.min,s.value.capacity.max]},null,8,["modelValue","items","rules"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue","title","show-delete-action","show-save-action"])}}}),In=e=>(Ft("data-v-33548a38"),e=e(),$t(),e),Sn={key:0,class:"accommodationList"},Rn={key:0,class:"text-orange-darken-2"},Cn={key:1,class:"accommodationList"},Vn=In(()=>B("br",null,null,-1)),On=Q({__name:"DataTableItemAccommodation",props:{accommodations:{default:()=>[]},convention:{},forms:{},registration:{},tickets:{default:()=>[]},value:{default:""},venues:{}},setup(e){const f=at(),l=Bt(f,e.convention),o=p(!1),u=ne(()=>e.registration.Allocation.Periods.map(a=>{var s;return{DateStart:a.DateStart,DateEnd:a.DateEnd,Accommodation:a.Accommodation||((s=e.accommodations)==null?void 0:s.find(d=>d.AccommodationUUID==a.AccommodationUUID))}}).sort((a,s)=>a.DateStart>s.DateStart?1:a.DateStart==s.DateStart?0:-1));e.registration&&e.registration.Allocation&&e.registration.Allocation.Periods&&e.registration.Allocation.Periods.forEach(a=>{var d;if(a.Accommodation)return;const s=(d=e.accommodations)==null?void 0:d.find(c=>c.AccommodationUUID==a.AccommodationUUID);s&&(a.Accommodation=s)});const v=ne(()=>{if(!e.value)return[];const a=JSON.parse(e.value),s=e.accommodations.filter(d=>a.includes(d.AccommodationUUID)).sort((d,c)=>{const g=a.findIndex(T=>T===d.AccommodationUUID),r=a.findIndex(T=>T===c.AccommodationUUID);return g>r?1:-1});return _e(s)}),m=ne(()=>{let a;const s=e.forms.find(d=>!!d.Sections.find(c=>{var g;return c.Fields?!!((g=c.Fields)!=null&&g.find(r=>{var T;return((T=r.Field)==null?void 0:T.Type)==="TICKET"?(a=r,!0):!1})):!1}));return a?!!e.registration.Submissions.find(d=>{if(d.FormUUID==(s==null?void 0:s.FormUUID))return!!d.Data.find(c=>{if(c.SectionFieldUUID==(a==null?void 0:a.SectionFieldUUID)){const g=JSON.parse(c.Data);return e.tickets.filter(r=>r.RequiresAccommodation).find(r=>g.Ticket.includes(r.TicketUUID)||g.AddonsChecked.includes(r.TicketUUID)||g.ComponentsChecked.includes(r.TicketUUID))}})}):!1});return(a,s)=>m.value?(i(),_(k,{key:0},[a.value?(i(),_("ol",Sn,[(i(!0),_(k,null,W(v.value,d=>(i(),_("li",{key:d.AccommodationUUID},[a.registration&&a.registration.Allocation&&a.registration.Allocation.Periods.find(c=>c.AccommodationUUID===d.AccommodationUUID)?(i(),_("strong",Rn,I(d.Name),1)):(i(),_(k,{key:1},[C(I(d.Name),1)],64))]))),128))])):(i(),_("ul",Cn,[(i(!0),_(k,null,W(u.value,d=>{var c;return i(),_("li",{key:d.DateStart},[C(I((c=d.Accommodation)==null?void 0:c.Name)+" ("+I(y(Re)(d.DateStart))+" - "+I(y(Re)(d.DateEnd))+")",1),Vn])}),128))])),y(l)?(i(),E(j,{key:2,onClick:s[0]||(s[0]=d=>o.value=!0),variant:"flat",color:"success"},{default:n(()=>[C("Assign Accommodation")]),_:1})):L("",!0),a.convention&&o.value?(i(),E(Dn,{key:3,modelValue:o.value,"onUpdate:modelValue":s[1]||(s[1]=d=>o.value=d),title:"Accommodation Allocation",convention:a.convention,registration:a.registration,tickets:a.tickets,"selected-accommodation":v.value},null,8,["modelValue","convention","registration","tickets","selected-accommodation"])):L("",!0)],64)):L("",!0)}});const La=rt(On,[["__scopeId","data-v-33548a38"]]),hn={key:0,class:"addonList"},bn={key:0},kn={key:0},Mn=Q({__name:"DataTableItemExtras",props:{extras:{default:()=>[]},value:{default:""}},setup(e){const f=ne(()=>{if(!e.value)return;const l=JSON.parse(e.value),o=Object.keys(l),u=_e(e.extras);return u.forEach(v=>{v.Options=v.Options.filter(m=>o.includes(m.OptionUUID)?(m.Choices=m.Choices.filter(a=>a.TagUUID===l[m.OptionUUID].choiceId),l[m.OptionUUID].checked):!1)}),u.filter(v=>v.Options.length>0),u});return(l,o)=>l.value?(i(),_("ul",hn,[(i(!0),_(k,null,W(f.value,u=>(i(),_(k,{key:u.ExtraUUID},[u.Options.length?(i(),_("li",bn,[B("strong",null,I(u.Name),1),B("ul",null,[(i(!0),_(k,null,W(u.Options,v=>(i(),_("li",{key:v.OptionUUID},[C(I(v.Name)+" ",1),v.Choices.length==1?(i(),_("small",kn,"("+I(v.Choices[0].Title)+")",1)):L("",!0)]))),128))])])):L("",!0)],64))),128))])):L("",!0)}});const Pa=rt(Mn,[["__scopeId","data-v-55786e01"]]),Nn={key:0},wa=Q({__name:"DataTableItemInterests",props:{interests:{default:()=>[]},value:{default:""}},setup(e){const f=ne(()=>{if(!e.value)return;const l=JSON.parse(e.value);return Object.entries(l).filter(([,o])=>o).map(([o,u])=>e.interests.find(v=>v.InterestUUID===o)).filter(o=>o!==void 0)});return(l,o)=>l.value?(i(),_("ul",Nn,[(i(!0),_(k,null,W(f.value,u=>(i(),_("li",{key:u.InterestUUID},I(u.Name),1))),128))])):L("",!0)}}),Ln=B("br",null,null,-1),Pn=B("small",null,"Options:",-1),wn=B("br",null,null,-1),Fn=B("small",null,"Addons:",-1),Fa=Q({__name:"DataTableItemTicket",props:{tickets:{default:()=>[]},value:{default:""}},setup(e){const f=ne(()=>{if(!e.value)return;let l={Ticket:[],AddonsChecked:[],ComponentsChecked:[]};try{l=JSON.parse(e.value),"ticket"in l&&(l.Ticket=l.ticket),"addonsChecked"in l&&(l.AddonsChecked=l.addonsChecked),"componentsChecked"in l&&(l.ComponentsChecked=l.componentsChecked)}catch{}return l.Ticket.filter(o=>{const u=e.tickets.find(v=>v.TicketUUID===o);return!(!u||u.Type!==_l.TICKET_TYPE_TICKET)}).map(o=>{const u=e.tickets.find(m=>m.TicketUUID===o),v=_e(u);return v.TicketComponents=u.TicketComponents.filter(m=>l.ComponentsChecked.includes(m.TicketUUID)),v.AddonTickets=u.AddonTickets.filter(m=>l.AddonsChecked.includes(m.TicketUUID)),v})});return(l,o)=>l.value?(i(!0),_(k,{key:0},W(f.value,u=>(i(),_("div",{key:u.TicketUUID},[B("strong",null,I(u.Name),1),u.TicketComponents.length>0?(i(),_(k,{key:0},[Ln,Pn,C("  "),(i(!0),_(k,null,W(u.TicketComponents,v=>(i(),_(k,{key:v.TicketUUID},[B("small",null,I(v.Name),1),C("  ")],64))),128))],64)):L("",!0),u.AddonTickets.length>0?(i(),_(k,{key:1},[wn,Fn,C("  "),(i(!0),_(k,null,W(u.AddonTickets,v=>(i(),_("small",{key:v.TicketUUID},[C("("),B("em",null,I(v.Name),1),C(")")]))),128))],64)):L("",!0)]))),128)):L("",!0)}}),$a=Q({__name:"DataPanelAccommodation",props:X({accommodations:{},convention:{},data:{},forms:{},tickets:{},venues:{},registration:{}},{modelValue:{required:!0}}),emits:["update:modelValue"],setup(e){return ae(e,"modelValue"),(f,l)=>(i(),_("div",null,[t(La,{value:f.data,accommodations:f.accommodations,convention:f.convention,forms:f.forms,registration:f.registration,tickets:f.tickets,venues:f.venues},null,8,["value","accommodations","convention","forms","registration","tickets","venues"])]))}}),$n={key:0,class:"text-red-darken-4 font-weight-bold"},Bn={key:1,class:"text-orange-darken-2 font-weight-bold"},Yn=Q({__name:"DataPanelAge",props:X({data:{},forms:{},registration:{}},{modelValue:{required:!0}}),emits:["update:modelValue"],setup(e){const f=ae(e,"modelValue"),l=new Date,o=l.getFullYear(),u=(l.getMonth()+1).toLocaleString("en-US",{minimumIntegerDigits:2}),v=l.getDate().toLocaleString("en-US",{minimumIntegerDigits:2}),m=p(!1),a=p(`${o}-${u}-${v}`),s=p(18);e.forms.find(r=>r.Sections.find(T=>T.Fields?T.Fields.find(A=>{var F;return A.SectionFieldUUID===f.value.SectionFieldUUID?(f.value.SectionField=A,(F=A.Field)==null||F.Values.forEach(V=>{switch(V.Title){case"UNDER_AGE_APPLY_TAG":V.Value.length>0&&(m.value=!0);break;case"BEFORE_DATE":a.value=V.Value;break;case"MIN_AGE":s.value=parseInt(V.Value);break}}),!0):!1}):!1));const d=r=>({registration:c(r,e.registration.CreatedAt||"",s.value),convention:c(r,a.value,s.value)}),c=(r,T,A)=>{if(r>=T)return!1;const F=g(r),P=g(T).getTime()-F.getTime(),U=1e3*60*60*24*365.25;return P/U>=A},g=r=>{const[T,A,F]=r.split("-");return new Date(parseInt(T),parseInt(A)-1,parseInt(F))};return(r,T)=>(i(),_("div",null,[B("p",null,[C(I(y(Re)(r.data,{withDay:!1,withYear:!0}))+" ",1),m.value&&d(r.data).convention&&d(r.data).registration?(i(),E(Ce,{key:0,icon:"mdi:mdi-check",color:"success"})):m.value&&!d(r.data).convention?(i(),E(Ce,{key:1,icon:"mdi:mdi-alert",color:"error"})):m.value&&d(r.data).convention&&!d(r.data).registration?(i(),E(Ce,{key:2,icon:"mdi:mdi-alert",color:"warning"})):L("",!0)]),m.value?(i(),_(k,{key:0},[d(r.data).convention?d(r.data).registration?L("",!0):(i(),_("p",Bn," Attendee was under "+I(s.value)+" at time of registration ",1)):(i(),_("p",$n," Attendee is under "+I(s.value),1))],64)):L("",!0)]))}}),zt=Q({__name:"Badges",props:{cardClass:{default:""},convention:{},registration:{},showTitle:{type:Boolean,default:!0}},setup(e){const f=Ae(),l=At(),o=p([]),u=m=>{var s;const a=document.createElement("a");a.download=`${((s=e.convention)==null?void 0:s.Name)||""} Badge Image - ${e.registration.Reference} - ${e.registration.User.DisplayName}.jpg`,a.href=m,document.body.appendChild(a),a.click(),document.body.removeChild(a)},v=async m=>l.GetConBadgeImageURL(e.registration.RegistrationUUID,m);return f.getConBadgeList(e.registration.RegistrationUUID).then(m=>{m.forEach(a=>{v(a).then(s=>{o.value.push({template:a,url:s})})})}).catch(()=>{}),(m,a)=>(i(!0),_(k,null,W(o.value,s=>(i(),E(Pe,{key:s.template,class:qe(m.cardClass)},{default:n(()=>[t(lt,null,{default:n(()=>[m.showTitle?(i(),E(ze,{key:0},{default:n(()=>[t(J,{class:"flex-row-reverse"},{default:n(()=>[t(M,{class:"text-wrap flex-grow-1"},{default:n(()=>[C(" Badges (#"+I(m.registration.Reference)+" "+I(m.registration.User.DisplayName)+") ",1)]),_:1})]),_:1})]),_:1})):L("",!0)]),_:1}),t(Qe,null,{default:n(()=>[t(qt,{src:s.url,height:"280",width:"280"},null,8,["src"])]),_:2},1024),t(Ht,null,{default:n(()=>[t(j,{color:"primary","prepend-icon":"mdi:mdi-download",variant:"flat",onClick:d=>u(s.url)},{default:n(()=>[C("Download")]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1032,["class"]))),128))}}),Gn=Q({__name:"DataPanelText",props:X({convention:{},data:{},forms:{}},{modelValue:{required:!0},registration:{required:!0}}),emits:["update:modelValue","update:registration"],setup(e){const f=ae(e,"modelValue"),l=ae(e,"registration"),o=p(e.data),u=ne(()=>s.value?"":o.value!==e.data?"mdi:mdi-content-save":""),v=at(),m=Ae(),a=p(Bt(v,e.convention)),s=p(!1),d=()=>{s.value=!0,m.directEditFieldData(l.value.RegistrationUUID,f.value.LayoutItemUUID,o.value).then(c=>{c&&l.value.Submissions.find(g=>!!g.Data.find(r=>{if(r.SectionFieldUUID===f.value.SectionFieldUUID)return r.Data=c,!0})),s.value=!1}).catch(()=>{})};return(c,g)=>f.value.Meta.DirectEdit&&(a.value||f.value.Meta.DirectEditPermission==="View")?(i(),E(oe,{key:0,modelValue:o.value,"onUpdate:modelValue":g[0]||(g[0]=r=>o.value=r),"append-inner-icon":u.value,"onClick:appendInner":d},je({_:2},[s.value?{name:"append-inner",fn:n(()=>[t(Da,{color:"primary",indeterminate:"",size:30})]),key:"0"}:void 0]),1032,["modelValue","append-inner-icon"])):(i(),_(k,{key:1},[C(I(c.data),1)],64))}}),xn={key:4},Hn={key:8},qn=Q({__name:"FormDataItem",props:X({accommodations:{},convention:{},extras:{},forms:{},interests:{},itemClass:{},tickets:{},venues:{}},{modelValue:{required:!0},registration:{required:!0}}),emits:["update:modelValue","update:registration"],setup(e){const f=ae(e,"modelValue"),l=ae(e,"registration"),o=ne(()=>{var g,r,T,A;const d=f.value,c=()=>{var F;for(let V=0;V<e.forms.length;V+=1)for(let P=0;P<e.forms[V].Sections.length;P+=1)if(e.forms[V].Sections[P].Fields){const U=(F=e.forms[V].Sections[P].Fields)==null?void 0:F.find(w=>w.SectionFieldUUID===d.SectionFieldUUID);if(U)return U}};return((r=(g=d.SectionField)==null?void 0:g.Field)==null?void 0:r.Type)||((A=(T=c())==null?void 0:T.Field)==null?void 0:A.Type)}),u=ne(()=>{for(let d=0;d<l.value.Submissions.length;d+=1){const g=l.value.Submissions[d].Data.find(r=>r.SectionFieldUUID===f.value.SectionFieldUUID);if(g)return g.Data}return""}),v=Ae(),m=At(),a=p(""),s=p("");if(o.value==="BADGE_IMAGE")try{const d=JSON.parse(u.value||"{}");d.fileUUID&&(s.value=m.GetBadgeImageURL(d.fileUUID)),l.value&&v.getConBadgeDisplayName(l.value.RegistrationUUID).then(c=>{c&&(a.value=c)}).catch(()=>{})}catch{}return(d,c)=>o.value==="ACCOMMODATION"?(i(),E($a,{key:0,convention:d.convention,tickets:d.tickets,accommodations:d.accommodations,venues:d.venues,registration:l.value,forms:d.forms,modelValue:f.value,"onUpdate:modelValue":c[0]||(c[0]=g=>f.value=g),data:u.value},null,8,["convention","tickets","accommodations","venues","registration","forms","modelValue","data"])):o.value==="EXTRAS"?(i(),E(Pa,{key:1,value:u.value,extras:d.extras},null,8,["value","extras"])):o.value==="TICKET"?(i(),E(Fa,{key:2,value:u.value,tickets:d.tickets},null,8,["value","tickets"])):o.value==="INTERESTS"?(i(),E(wa,{key:3,value:u.value,interests:d.interests},null,8,["value","interests"])):o.value==="CHECKBOX"?(i(),_("div",xn,[u.value?(i(),E(Ce,{key:0,icon:"mdi:mdi-check",color:"success"})):(i(),E(Ce,{key:1,icon:"mdi:mdi-close",color:"error"}))])):o.value==="AGE"?(i(),E(Yn,{key:5,data:u.value,forms:d.forms,registration:l.value,modelValue:f.value,"onUpdate:modelValue":c[1]||(c[1]=g=>f.value=g)},null,8,["data","forms","registration","modelValue"])):o.value==="BADGE_IMAGE"?(i(),E(zt,{key:6,convention:d.convention,registration:l.value,"show-title":!1,"card-class":d.itemClass},null,8,["convention","registration","card-class"])):o.value==="TEXT"?(i(),E(Gn,{key:7,convention:d.convention,data:u.value,forms:d.forms,modelValue:f.value,"onUpdate:modelValue":c[2]||(c[2]=g=>f.value=g),registration:l.value,"onUpdate:registration":c[3]||(c[3]=g=>l.value=g)},null,8,["convention","data","forms","modelValue","registration"])):(i(),_("div",Hn,I(u.value),1))}}),jn={key:0},zn={key:0},Qn=B("strong",null,"Total:",-1),Kn=Q({__name:"DataPanelRegistrationGroup",props:{registration:{}},setup(e){const f=ne(()=>{const l=[];let o;return e.registration.Leader?o=e.registration:o=e.registration.Primary,l.push({Name:o.User.DisplayName,UUID:o.UserUUID,UserUUID:o.User.UserUUID,IsLeader:!0,Reference:o.Reference,Paid:o.Paid,Total:o.Total}),l.push(...o.Members.map(u=>({Name:u.User.DisplayName,UUID:u.UserUUID,UserUUID:u.User.UserUUID,IsLeader:!1,Reference:u.Reference,Paid:u.Paid,Total:u.Total}))),l});return(l,o)=>l.registration.Members.length===0&&!l.registration.Primary?(i(),_("em",jn," Not in a group ")):(i(),_(k,{key:1},[B("ul",null,[(i(!0),_(k,null,W(f.value,u=>(i(),_("li",{key:u.UUID,class:"ml-0"},[C(" #"+I(u.Reference)+" : "+I(u.Name)+" ",1),u.IsLeader?(i(),_("strong",zn,"(Leader)")):L("",!0)]))),128))]),Qn,C(" "+I(f.value.length),1)],64))}}),Xn=Q({__name:"DataPanelSubmissionDate",props:{registration:{}},setup(e){const f=ne(()=>{const l=e.registration.Submissions.find(o=>{var u;return((u=o.Form)==null?void 0:u.Type)===Te.FORM_TYPE_REGISTRATION});return l?l.CreatedAt||"":e.registration.CreatedAt||""});return(l,o)=>(i(),_("div",null,I(y(Re)(f.value,{withDay:!1,withYear:!0})),1))}}),Wn={class:"text-grey-lighten-1"},Jn=Q({__name:"DataPanelSubmissionStatus",props:{convention:{},forms:{},registration:{}},emits:["showForm"],setup(e,{emit:f}){const l=at(),o=Bt(l,e.convention),u=ne(()=>e.registration.Submissions.map(a=>{const s=e.forms.find(d=>d.FormUUID===a.FormUUID);if(s)return{Heading:s.Heading,Form:s,Submission:a,Registration:e.registration}}).filter(a=>!!a)),v=(a,s,d)=>{f("showForm",a,s,d)},m=a=>({ID:0,SubmissionUUID:Ee(),FormID:a.ID,FormUUID:a.FormUUID,Form:a,UserID:e.registration.UserID,UserUUID:e.registration.UserUUID,RegistrationID:e.registration.ID,RegistrationUUID:e.registration.RegistrationUUID,Registration:e.registration,Data:[],Status:Sa.SUBMISSION_STATUS_NULL});return(a,s)=>(i(),_(k,null,[B("ul",null,[(i(!0),_(k,null,W(a.forms.filter(d=>d.Type===y(Te).FORM_TYPE_ADMIN&&u.value.findIndex(c=>c.Form.ID===d.ID)<0),d=>(i(),_("li",{key:d.Heading},[B("strong",Wn,I(d.Heading),1),y(o)?(i(),E(j,{key:0,class:"text-grey-lighten-1",icon:"mdi:mdi-form-select",title:"Edit Submitted Data",variant:"flat",onClick:c=>v(a.registration,d,m(d))},null,8,["onClick"])):L("",!0)]))),128))]),B("ul",null,[(i(!0),_(k,null,W(u.value,d=>(i(),_("li",{key:d.Heading},[B("strong",null,[C(I(d.Heading),1),d.Form.Type!==y(Te).FORM_TYPE_ADMIN?(i(),_(k,{key:0},[C(": ")],64)):L("",!0)]),d.Form.Type!==y(Te).FORM_TYPE_ADMIN?(i(),_("span",{key:0,class:qe(y(Ia)(d.Submission.Status))},I(y(Yt)(d.Submission.Status)),3)):L("",!0),y(o)?(i(),E(j,{key:1,icon:"mdi:mdi-form-select",title:"Edit Submitted Data",variant:"flat",onClick:c=>v(d.Registration,d.Form,d.Submission)},null,8,["onClick"])):L("",!0)]))),128))])],64))}}),Zn={key:0,class:"text-blue"},eo={key:1,class:"text-red"},to={key:2,class:"text-orange"},ao={key:3,class:"text-orange"},lo={key:4,class:"text-orange"},no={key:5,class:"text-orange"},oo={key:6,class:"text-green"},io=Q({__name:"DataPanelPaymentStatus",props:{registration:{}},setup(e){const f=ne(()=>{if(e.registration.Paid===0&&e.registration.Total)return"REQUIRED";if(e.registration.Total>e.registration.Paid)return"ADDITIONAL_REQUIRED";const l=e.registration.Members.find(o=>o.Paid===0&&(o.Total||0)>0);return l?e.registration.Total===0&&l.Total===0?"NOT_REQUIRED":e.registration.Total===0&&l.Total||e.registration.Total>0&&l.Total===0?"MISSING_REQUIRED":e.registration.Paid>=e.registration.Total?"AWAITING_PARTNER":"ALL_REQUIRED":e.registration.Total===0?"NOT_REQUIRED":"COMPLETE"});return(l,o)=>f.value=="NOT_REQUIRED"?(i(),_("div",Zn,"No Payment Requested")):f.value=="MISSING_REQUIRED"?(i(),_("div",eo,"Partner Payment Not Requested")):f.value=="AWAITING_PARTNER"?(i(),_("div",to,"Awaiting Partner Payment")):f.value=="ALL_REQUIRED"?(i(),_("div",ao,"Awaiting Payments")):f.value=="REQUIRED"?(i(),_("div",lo,"Awaiting Payment")):f.value=="ADDITIONAL_REQUIRED"?(i(),_("div",no,"Awaiting Additional Payments")):(i(),_("div",oo,"Completed"))}});var so=["onActivate","onAddUndo","onBeforeAddUndo","onBeforeExecCommand","onBeforeGetContent","onBeforeRenderUI","onBeforeSetContent","onBeforePaste","onBlur","onChange","onClearUndos","onClick","onContextMenu","onCopy","onCut","onDblclick","onDeactivate","onDirty","onDrag","onDragDrop","onDragEnd","onDragGesture","onDragOver","onDrop","onExecCommand","onFocus","onFocusIn","onFocusOut","onGetContent","onHide","onInit","onKeyDown","onKeyPress","onKeyUp","onLoadContent","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp","onNodeChange","onObjectResizeStart","onObjectResized","onObjectSelected","onPaste","onPostProcess","onPostRender","onPreProcess","onProgressState","onRedo","onRemove","onReset","onSaveContent","onSelectionChange","onSetAttrib","onSetContent","onShow","onSubmit","onUndo","onVisualAid"],uo=function(e){return so.map(function(f){return f.toLowerCase()}).indexOf(e.toLowerCase())!==-1},ro=function(e,f,l){Object.keys(f).filter(uo).forEach(function(o){var u=f[o];typeof u=="function"&&(o==="onInit"?u(e,l):l.on(o.substring(2),function(v){return u(v,l)}))})},mo=function(e,f,l,o){var u=e.modelEvents?e.modelEvents:null,v=Array.isArray(u)?u.join(" "):u;me(o,function(m,a){l&&typeof m=="string"&&m!==a&&m!==l.getContent({format:e.outputFormat})&&l.setContent(m)}),l.on(v||"change input undo redo",function(){f.emit("update:modelValue",l.getContent({format:e.outputFormat}))})},co=function(e,f,l,o,u,v){o.setContent(v()),l.attrs["onUpdate:modelValue"]&&mo(f,l,o,u),ro(e,l.attrs,o)},ua=0,Ba=function(e){var f=Date.now(),l=Math.floor(Math.random()*1e9);return ua++,e+"_"+l+ua+String(f)},vo=function(e){return e!==null&&e.tagName.toLowerCase()==="textarea"},ra=function(e){return typeof e>"u"||e===""?[]:Array.isArray(e)?e:e.split(" ")},fo=function(e,f){return ra(e).concat(ra(f))},Uo=function(e){return e==null},da=function(){return{listeners:[],scriptId:Ba("tiny-script"),scriptLoaded:!1}},Ao=function(){var e=da(),f=function(u,v,m,a){var s=v.createElement("script");s.referrerPolicy="origin",s.type="application/javascript",s.id=u,s.src=m;var d=function(){s.removeEventListener("load",d),a()};s.addEventListener("load",d),v.head&&v.head.appendChild(s)},l=function(u,v,m){e.scriptLoaded?m():(e.listeners.push(m),u.getElementById(e.scriptId)||f(e.scriptId,u,v,function(){e.listeners.forEach(function(a){return a()}),e.scriptLoaded=!0}))},o=function(){e=da()};return{load:l,reinitialize:o}},go=Ao(),To=function(){return typeof window<"u"?window:global},Ge=function(){var e=To();return e&&e.tinymce?e.tinymce:null},_o={apiKey:String,cloudChannel:String,id:String,init:Object,initialValue:String,inline:Boolean,modelEvents:[String,Array],plugins:[String,Array],tagName:String,toolbar:[String,Array],modelValue:String,disabled:Boolean,tinymceScriptSrc:String,outputFormat:{type:String,validator:function(e){return e==="html"||e==="text"}}},Se=globalThis&&globalThis.__assign||function(){return Se=Object.assign||function(e){for(var f,l=1,o=arguments.length;l<o;l++){f=arguments[l];for(var u in f)Object.prototype.hasOwnProperty.call(f,u)&&(e[u]=f[u])}return e},Se.apply(this,arguments)},po=function(e,f,l,o){return e(o||"div",{id:f,ref:l})},yo=function(e,f,l){return e("textarea",{id:f,visibility:"hidden",ref:l})},Ot={selector:void 0,target:void 0},Eo=Q({props:_o,setup:function(e,f){var l=e.init?Se(Se({},e.init),Ot):Se({},Ot),o=nl(e),u=o.disabled,v=o.modelValue,m=o.tagName,a=p(null),s=null,d=e.id||Ba("tiny-vue"),c=e.init&&e.init.inline||e.inline,g=!!f.attrs["onUpdate:modelValue"],r=!0,T=e.initialValue?e.initialValue:"",A="",F=function(U){return g?function(){return v!=null&&v.value?v.value:""}:function(){return U?T:A}},V=function(){var U=F(r),w=Se(Se({},l),{readonly:e.disabled,target:a.value,plugins:fo(l.plugins,e.plugins),toolbar:e.toolbar||l.toolbar,inline:c,setup:function(Z){s=Z,Z.on("init",function(Y){return co(Y,e,f,Z,v,U)}),typeof l.setup=="function"&&l.setup(Z)}});vo(a.value)&&(a.value.style.visibility=""),Ge().init(w),r=!1};me(u,function(U){var w;s!==null&&(typeof((w=s.mode)===null||w===void 0?void 0:w.set)=="function"?s.mode.set(U?"readonly":"design"):s.setMode(U?"readonly":"design"))}),me(m,function(U){var w;g||(A=s.getContent()),(w=Ge())===null||w===void 0||w.remove(s),et(function(){return V()})}),ol(function(){if(Ge()!==null)V();else if(a.value&&a.value.ownerDocument){var U=e.cloudChannel?e.cloudChannel:"6",w=e.apiKey?e.apiKey:"no-api-key",Z=Uo(e.tinymceScriptSrc)?"https://cdn.tiny.cloud/1/".concat(w,"/tinymce/").concat(U,"/tinymce.min.js"):e.tinymceScriptSrc;go.load(a.value.ownerDocument,Z,V)}}),il(function(){Ge()!==null&&Ge().remove(s)}),c||(sl(function(){r||V()}),ul(function(){var U;g||(A=s.getContent()),(U=Ge())===null||U===void 0||U.remove(s)}));var P=function(U){var w;A=s.getContent(),(w=Ge())===null||w===void 0||w.remove(s),l=Se(Se(Se({},l),U),Ot),et(function(){return V()})};return f.expose({rerender:P,getEditor:function(){return s}}),function(){return c?po(Zt,d,a,e.tagName):yo(Zt,d,a)}}});const Do=["colspan"],Io=B("strong",null,"E-Mail Content",-1),So=["innerHTML"],Ro=Q({__name:"Communications",props:{expanded:{type:Boolean,default:!0},hideHistory:{type:Boolean,default:!1},registration:{},showEditor:{type:Boolean}},emits:["close-editor"],setup(e,{emit:f}){const l=Ae(),o=p([]),u=p({From:"",Subject:"",HTML:""}),v=p(""),m=p(""),a=p(""),s=p(!1),d=p(e.expanded?["1"]:[]),c=p([]),g=p([]),r=p([{key:"CreatedAt",title:"Date"},{key:"Subject",title:"Subject"},{key:"User.DisplayName",title:"Sender"},{key:"Status",title:"Status"}]),T=p([{key:"CreatedAt",order:"asc"}]);me(u,P=>{a.value=P.From||a.value||"",m.value=P.Subject||m.value||"",v.value=P.HTML||v.value||""});const A=()=>{l.getRegistrationEmails(e.registration.RegistrationUUID).then(P=>{P&&(P.forEach(U=>{U.CreatedAt=pa(new Date(U.CreatedAt||"")),U.Status=cn(U.Status),U.User||(U.User={ID:0,UserUUID:"",DisplayName:"System",Handle:"",Credentials:[],Additional:{FirstName:"",LastName:"",DOB:"",Email:""},Data:"",Groups:[],Tags:[]})}),g.value=P)})};A(),(()=>{l.getRegistrationEmailTemplates(e.registration.RegistrationUUID).then(P=>{P&&(o.value=P)})})();const V=({callback:P})=>{l.sendRegistrationEmail(e.registration.RegistrationUUID,a.value,m.value,v.value).then(U=>{U?P&&(P("Email Sent"),A(),setTimeout(()=>{s.value=!1},2e3)):P&&P("Not sent")}).catch(()=>{P&&P("Not sent")})};return(P,U)=>(i(),_(k,null,[P.showEditor?(i(),E(fe,{key:0,class:"ml-0 px-0",style:{"max-width":"calc(100vw - 64px)"}},{default:n(()=>[t(J,null,{default:n(()=>[t(M,null,{default:n(()=>[t(Ta,{items:o.value,"item-title":"Subject","return-object":"",label:"Template","hide-details":"",modelValue:u.value,"onUpdate:modelValue":U[0]||(U[0]=w=>u.value=w),variant:"outlined"},null,8,["items","modelValue"])]),_:1})]),_:1}),t(J,null,{default:n(()=>[t(M,{cols:"12"},{default:n(()=>[t(oe,{modelValue:a.value,"onUpdate:modelValue":U[1]||(U[1]=w=>a.value=w),label:"From",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),t(M,{cols:"12"},{default:n(()=>[t(oe,{modelValue:m.value,"onUpdate:modelValue":U[2]||(U[2]=w=>m.value=w),label:"Subject",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),t(M,{cols:"12"},{default:n(()=>[t(y(Eo),{modelValue:v.value,"onUpdate:modelValue":U[3]||(U[3]=w=>v.value=w),"api-key":"g9sce3fktcgvk0i7sp96cahgyk4cos7q27es3ubnlal3xf3z"},null,8,["modelValue"])]),_:1})]),_:1}),t(J,null,{default:n(()=>[t(M,null,{default:n(()=>[t(ut,{onClick:U[4]||(U[4]=w=>f("close-editor")),label:"Close E-mail Editor",color:"secondary","prepend-icon":"mdi:mdi-window-close"})]),_:1}),t(M,{class:"text-right"},{default:n(()=>[t(ut,{onClick:V,label:"Send",color:"error"})]),_:1})]),_:1})]),_:1})):L("",!0),g.value.length&&!P.hideHistory?(i(),E(pt,{key:1,class:"my-2",multiple:!0,modelValue:d.value,"onUpdate:modelValue":U[7]||(U[7]=w=>d.value=w)},{default:n(()=>[t(_t,{value:"1"},{default:n(()=>[t(gt,null,{default:n(()=>[C(" Email History ")]),_:1}),t(Tt,null,{default:n(()=>[t(y(jt),{items:g.value,headers:r.value,"show-expand":!0,"item-value":"EmailUUID",expanded:c.value,"onUpdate:expanded":U[5]||(U[5]=w=>c.value=w),"sort-by":T.value,"onUpdate:sortBy":U[6]||(U[6]=w=>T.value=w)},{"expanded-row":n(({columns:w,item:Z})=>[B("tr",null,[B("td",{colspan:w.length},[Io,B("div",{class:"communicationsViewEmailPreview",innerHTML:Z.raw.HTML},null,8,So)],8,Do)])]),"footer.prepend":n(()=>[t(j,{"prepend-icon":"mdi:mdi-refresh",color:"primary",class:"mr-4",onClick:A},{default:n(()=>[C("Refresh")]),_:1})]),_:1},8,["items","headers","expanded","sort-by"])]),_:1})]),_:1})]),_:1},8,["modelValue"])):L("",!0)],64))}});const Ya=Q({__name:"Emails",props:{allowSending:{type:Boolean,default:!0},expanded:{type:Boolean,default:!0},hideHistory:{type:Boolean,default:!1},showTitle:{type:Boolean,default:!0},registration:{},textClass:{default:""}},setup(e){const f=p(!1);return(l,o)=>(i(),_(k,null,[t(Pe,null,{default:n(()=>[l.showTitle?(i(),E(lt,{key:0},{default:n(()=>[t(ze,null,{default:n(()=>[C(" E-Mails (#"+I(l.registration.Reference)+" "+I(l.registration.User.DisplayName)+") ",1)]),_:1})]),_:1})):L("",!0),t(Qe,{class:qe(l.textClass)},{default:n(()=>[l.allowSending?(i(),E(J,{key:0},{default:n(()=>[t(M,{cols:"12"},{default:n(()=>[t(j,{"prepend-icon":"mdi:mdi-email",color:"primary",onClick:o[0]||(o[0]=u=>f.value=!0)},{default:n(()=>[C(" Prepare Email ")]),_:1})]),_:1})]),_:1})):L("",!0)]),_:1},8,["class"])]),_:1}),t(Ro,{registration:l.registration,expanded:l.expanded,"hide-history":l.hideHistory,"show-editor":f.value,onCloseEditor:o[1]||(o[1]=u=>f.value=!1)},null,8,["registration","expanded","hide-history","show-editor"])],64))}}),Co=Q({__name:"EditNoteCategoryDialog",props:X({convention:{},noteCategory:{},title:{}},{modelValue:{type:Boolean,required:!0}}),emits:X(["update:noteCategory"],["update:modelValue"]),setup(e,{emit:f}){const l=e,{title:o=""}=l,u=ae(e,"modelValue"),v=dt(l,f,void 0,void 0,"noteCategory"),m=p(_e(v.value));me(v,()=>{m.value=_e(v.value)});const a=()=>{u.value=!1},s=()=>{m.value=_e(v.value)},d=()=>{v.value=m.value};return(c,g)=>(i(),E(tt,{modelValue:u.value,"onUpdate:modelValue":g[2]||(g[2]=r=>u.value=r),onReset:s,onSave:d,title:y(o),color:"primary",persistent:!0,fullscreen:!1,"hide-extension":!0},{default:n(()=>[t(fe,{class:"pa-0",fluid:!0},{default:n(()=>[t(J,null,{default:n(()=>[t(M,{cols:"12",sm:"6",md:"4"},{default:n(()=>[t(oe,{modelValue:m.value.Name,"onUpdate:modelValue":g[0]||(g[0]=r=>m.value.Name=r),label:"Internal name",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),t(M,{cols:"12",sm:"6",md:"4"},{default:n(()=>[t(Ca,{modelValue:m.value.Groups,"onUpdate:modelValue":g[1]||(g[1]=r=>m.value.Groups=r),convention:c.convention,label:"Groups",variant:"outlined","hide-details":""},null,8,["modelValue","convention"])]),_:1})]),_:1})]),_:1})]),actions:n(()=>[t(j,{color:"blue-darken-1",variant:"text",onClick:a},{default:n(()=>[C(" Cancel ")]),_:1}),t(j,{color:"blue-darken-1",variant:"text",onClick:s},{default:n(()=>[C(" Reset ")]),_:1}),t(Le),t(j,{color:"blue-darken-1",variant:"text",onClick:d},{default:n(()=>[C(" Save ")]),_:1})]),_:1},8,["modelValue","title"]))}}),Vo=()=>{const e=p(""),f=()=>{const l={x:window.innerWidth,y:window.innerHeight};l.x<600?e.value="xs":l.x>=600&&l.x<960?e.value="sm":l.x>=960&&l.x<1280?e.value="md":l.x>=1280&&l.x<1920?e.value="lg":l.x>=1920&&l.x<2560?e.value="xl":l.x>=2560&&(e.value="xxl")};return window.addEventListener("resize",f),f(),e},Oo={style:{"list-style":"none"}},ho=Q({__name:"NoteCategories",props:{hideHistory:{type:Boolean},convention:{},showEditor:{type:Boolean}},emits:["close"],setup(e,{emit:f}){const l=Ae(),o=p(!1),u=p(!1),v=p(""),m=p([]),a=p([{key:"Name",title:"Name"},{key:"Groups",title:"Groups"},{key:"actions",title:"",sortable:!1}]),s=Vo();p([{key:"CreatedAt",order:"asc"}]);const d=()=>({ID:0,NoteCategoryUUID:Ee(),ConventionID:e.convention.ID,ConventionUUID:e.convention.ConventionUUID,Name:"",Groups:[],Notes:[]}),c=p(-1),g=p(d()),r=p(d()),T=()=>{r.value.NoteCategoryUUID=Ee(),g.value=Object.assign({},d()),c.value=-1,o.value=!0},A=Y=>{c.value=m.value.indexOf(Y),g.value=Object.assign({},Y),o.value=!0},F=Y=>{c.value=m.value.indexOf(Y),g.value=Object.assign({},Y),u.value=!0},V=()=>{l.deleteNoteCategory(g.value.NoteCategoryUUID).then(Y=>{Y&&(m.value.splice(c.value,1),U())})},P=()=>{o.value=!1,et(()=>{g.value=Object.assign({},r.value),c.value=-1})},U=()=>{u.value=!1,et(()=>{g.value=Object.assign({},r.value),c.value=-1})},w=()=>{l.saveNoteCategory(g.value).then(Y=>{Y&&(c.value>-1?Object.assign(m.value[c.value],Y):m.value.push(Y),P())})};return(()=>{l.getNoteCategories(e.convention.ConventionUUID).then(Y=>{Y&&(m.value=Y)})})(),(Y,G)=>(i(),E(y(jt),{headers:a.value,items:m.value,"sort-by":[{key:"calories",order:"asc"}],class:"elevation-1"},{top:n(()=>[t(Pt,{color:"primary"},je({default:n(()=>[t(Ma,null,{default:n(()=>[C("Note Categories")]),_:1}),t(Kl,{class:"mx-4 d-none d-sm-inline-flex",inset:!0,vertical:!0}),t(Le,{class:"d-none d-sm-inline-flex"}),y(s)!="xs"?(i(),E(j,{key:0,dark:"",class:"mb-2","prepend-icon":"mdi:mdi-pencil",onClick:T},{default:n(()=>[C(" New Item ")]),_:1})):L("",!0),t(j,{dark:"",class:"mb-2",icon:"mdi:mdi-window-close",onClick:G[0]||(G[0]=te=>f("close"))}),t(ka,{modelValue:u.value,"onUpdate:modelValue":G[1]||(G[1]=te=>u.value=te),onDelete:V},null,8,["modelValue"])]),_:2},[y(s)=="xs"?{name:"extension",fn:n(()=>[t(Le),t(j,{dark:"",class:"mb-2","prepend-icon":"mdi:mdi-pencil",onClick:T},{default:n(()=>[C(" New Item ")]),_:1})]),key:"0"}:void 0]),1024),o.value?(i(),E(Co,{key:0,modelValue:o.value,"onUpdate:modelValue":G[2]||(G[2]=te=>o.value=te),"note-category":g.value,"onUpdate:noteCategory":[G[3]||(G[3]=te=>g.value=te),w],title:v.value,convention:Y.convention},null,8,["modelValue","note-category","title","convention"])):L("",!0)]),"item.Groups":n(({item:te})=>[B("ul",Oo,[(i(!0),_(k,null,W(te.selectable.Groups,O=>(i(),_("li",{key:O.GroupUUID,class:"py-1"},I(O.Name),1))),128))])]),"item.actions":n(({item:te})=>[t(Ce,{size:"small",class:"me-2",onClick:O=>A(te.raw)},{default:n(()=>[C(" mdi:mdi-pencil ")]),_:2},1032,["onClick"]),t(Ce,{size:"small",onClick:O=>F(te.raw)},{default:n(()=>[C(" mdi:mdi-delete ")]),_:2},1032,["onClick"])]),_:1},8,["headers","items"]))}}),bo=Q({__name:"SelectNoteCategories",props:X({convention:{},chips:{type:Boolean,default:!1},clearable:{type:Boolean,default:!1},hint:{default:""},label:{},variant:{}},{modelValue:{required:!0}}),emits:X(["change"],["update:modelValue"]),setup(e,{emit:f}){const l=ae(e,"modelValue"),o=p([]),u=Ae(),v=p([]),m=p(""),a=p(0),s=ne(()=>[...v.value].map(g=>({title:g.Name,value:o.value.find(r=>r.NoteCategoryUUID===g.NoteCategoryUUID)||g})));return typeof e.convention=="object"?m.value=e.convention.ConventionUUID:m.value=e.convention||"",(async()=>{const c=[];m.value&&c.push(u.getNoteCategories(m.value));const g=await Promise.all(c);if(m.value&&g.length==1&&(v.value=g[0].sort((r,T)=>r.Name.localeCompare(T.Name))),Array.isArray(l.value))a.value=2,s.value.forEach(r=>{Array.isArray(l.value)&&l.value.find(A=>A.NoteCategoryUUID===r.value.NoteCategoryUUID)&&o.value.push(r.value)});else if(typeof l.value=="string"){a.value=1;try{const r=JSON.parse(l.value);s.value.forEach(T=>{r.find(F=>F.NoteCategoryUUID===T.value.NoteCategoryUUID)&&o.value.push(T.value)})}catch{}}})(),me(o,()=>{switch(a.value){default:case 2:{l.value=o.value,f("change");break}case 1:{l.value=JSON.stringify(o.value),f("change");break}}}),(c,g)=>(i(),E(Ta,{modelValue:o.value,"onUpdate:modelValue":g[0]||(g[0]=r=>o.value=r),chips:c.chips,multiple:"",label:c.label||"Tags",variant:c.variant||"solo",hint:c.hint,"persistent-hint":!0,clearable:c.clearable,items:s.value,"item-title":"title","item-value":"value"},null,8,["modelValue","chips","label","variant","hint","clearable","items"]))}}),ko=Q({__name:"EditNoteDialog",props:X({convention:{},note:{},title:{}},{modelValue:{type:Boolean,required:!0}}),emits:X(["update:note","saved"],["update:modelValue"]),setup(e,{emit:f}){const l=e,{title:o=""}=l,u=Ae(),v=ae(e,"modelValue"),m=dt(l,f,void 0,void 0,"note"),a=p(_e(m.value));me(m,()=>{a.value=_e(m.value)});const s=()=>{a.value=_e(m.value)},d=c=>{a.value.NoteCategories===null&&(a.value.NoteCategories=[]),a.value.CreatedAt=void 0,a.value.DeletedAt=void 0,a.value.UpdatedAt=void 0,a.value.Admin=void 0,a.value.AdminID=void 0,a.value.AdminUUID=void 0,u.saveNote(a.value).then(g=>{g?(a.value=_e(g),c&&c("Note Saved"),m.value=a.value,f("saved",m.value)):c&&c("Internal Error Saving Note")}).catch(g=>{c&&c("Error Saving Note:"+g.ErrorMessage)})};return(c,g)=>a.value?(i(),E(tt,{key:0,"card-class":"pa-4",modelValue:v.value,"onUpdate:modelValue":g[3]||(g[3]=r=>v.value=r),onReset:s,onSave:d,title:y(o),color:"primary",persistent:!0,fullscreen:!1,"hide-extension":!0,"show-close-action":!0,"show-reset-action":!0,"show-save-action":!0},{default:n(()=>[t(fe,{class:"pa-0",fluid:!0},{default:n(()=>[t(J,null,{default:n(()=>[t(M,{cols:"12"},{default:n(()=>[t(bo,{modelValue:a.value.NoteCategories,"onUpdate:modelValue":g[0]||(g[0]=r=>a.value.NoteCategories=r),convention:c.convention,label:"Categories",variant:"outlined","hide-details":"",chips:!0},null,8,["modelValue","convention"])]),_:1})]),_:1}),t(J,null,{default:n(()=>[t(M,{cols:"12"},{default:n(()=>[t(oe,{modelValue:a.value.Subject,"onUpdate:modelValue":g[1]||(g[1]=r=>a.value.Subject=r),label:"Subject",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),t(M,{cols:"12"},{default:n(()=>[t(Xl,{modelValue:a.value.Description,"onUpdate:modelValue":g[2]||(g[2]=r=>a.value.Description=r),label:"Note",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue","title"])):L("",!0)}}),Ga=Q({__name:"Notes",props:{allowAdding:{type:Boolean,default:!0},cardClass:{default:""},convention:{},expanded:{type:Boolean,default:!0},hideHistory:{type:Boolean},registration:{},showControlPanel:{type:Boolean,default:!0},showEditor:{type:Boolean},showTitle:{type:Boolean,default:!0},textClass:{default:""}},setup(e){const f=Ae(),l=()=>({ID:0,NoteUUID:Ee(),Description:"",NoteCategories:[],Registration:e.registration,RegistrationID:e.registration.ID,RegistrationUUID:e.registration.RegistrationUUID,Subject:""}),o=p(!1),u=p(!1),v=p([]),m=p([]),a=p(l()),s=()=>{a.value=l(),o.value=!0},d=r=>{a.value=r,o.value=!0},c=()=>{f.getRegistrationNotes(e.registration.RegistrationUUID).then(r=>{r&&(r.forEach(T=>{T.CreatedAt=pa(new Date(T.CreatedAt||"")),T.Admin||(T.Admin={ID:0,UserUUID:"",DisplayName:"System",Handle:"",Credentials:[],Additional:{FirstName:"",LastName:"",DOB:"",Email:""},Data:"",Groups:[],Tags:[]})}),v.value=r,e.expanded&&(m.value=r.map(T=>T.NoteUUID)))})},g=()=>{c(),setTimeout(()=>{o.value=!1},2e3)};return c(),(r,T)=>(i(),_(k,null,[t(Pe,{class:qe(r.cardClass)},{default:n(()=>[t(lt,null,{default:n(()=>[t(ze,null,{default:n(()=>[t(J,{class:"flex-row-reverse"},{default:n(()=>[r.showControlPanel?(i(),E(M,{key:0,class:"text-right flex-shrink-1 flex-grow-0",style:{"flex-grow":"0 !important"}},{default:n(()=>[t(j,{class:"d-sm-none",size:"xs",icon:"mdi:mdi-cog",variant:"text",color:"warning",onClick:T[0]||(T[0]=A=>u.value=!0)}),t(j,{class:"d-none d-sm-inline-flex","prepend-icon":"mdi:mdi-cog",variant:"text",color:"warning",onClick:T[1]||(T[1]=A=>u.value=!0)},{default:n(()=>[C("Categories")]),_:1})]),_:1})):L("",!0),r.showTitle?(i(),E(M,{key:1,class:"text-wrap flex-grow-1"},{default:n(()=>[C(" Notes (#"+I(r.registration.Reference)+" "+I(r.registration.User.DisplayName)+") ",1)]),_:1})):L("",!0)]),_:1})]),_:1})]),_:1}),t(Qe,{class:qe(r.textClass)},{default:n(()=>[v.value.length===0?(i(),_(k,{key:0},[C(" No Notes Recorded ")],64)):(i(),E(pt,{key:1,multiple:!0,variant:"accordion",modelValue:m.value,"onUpdate:modelValue":T[2]||(T[2]=A=>m.value=A)},{default:n(()=>[(i(!0),_(k,null,W(v.value,A=>(i(),E(_t,{key:`${A.NoteUUID}.${A.UpdatedAt}`,value:A.NoteUUID},{default:n(()=>[t(gt,{class:"py-0"},{default:n(()=>[C(I(A.Subject)+" ",1),t(Na,{class:"ml-4"},{default:n(()=>[A.NoteCategories.length===0?(i(),E(wt,{key:0},{default:n(()=>[C(" Global ")]),_:1})):L("",!0),(i(!0),_(k,null,W(A.NoteCategories,F=>(i(),E(wt,{key:F.NoteCategoryUUID},{default:n(()=>[C(I(F.Name),1)]),_:2},1024))),128))]),_:2},1024)]),_:2},1024),t(Tt,null,{default:n(()=>[t(J,null,{default:n(()=>[t(M,null,{default:n(()=>[C(I(A.Description),1)]),_:2},1024)]),_:2},1024),t(J,null,{default:n(()=>[t(M,null,{default:n(()=>[C(I(y(Re)(A.UpdatedAt||""))+" ",1),A&&A.Admin&&A.Admin.DisplayName?(i(),_(k,{key:0},[C(" - "+I(A.Admin.DisplayName),1)],64)):L("",!0)]),_:2},1024),t(M,{class:"text-right"},{default:n(()=>[t(j,{color:"primary","prepend-icon":"mdi:mdi-pencil",onClick:F=>d(A)},{default:n(()=>[C("Edit")]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"]))]),_:1},8,["class"]),r.allowAdding?(i(),E(Ht,{key:0},{default:n(()=>[t(j,{color:"primary",variant:"flat",onClick:s},{default:n(()=>[C("Add Note")]),_:1})]),_:1})):L("",!0)]),_:1},8,["class"]),t(Ut,{modelValue:o.value,"onUpdate:modelValue":T[5]||(T[5]=A=>o.value=A),title:"Create Note"},{default:n(()=>[t(ko,{modelValue:o.value,"onUpdate:modelValue":T[3]||(T[3]=A=>o.value=A),note:a.value,"onUpdate:note":T[4]||(T[4]=A=>a.value=A),convention:r.convention,title:"Create Note",onSaved:g},null,8,["modelValue","note","convention"])]),_:1},8,["modelValue"]),t(Ut,{modelValue:u.value,"onUpdate:modelValue":T[7]||(T[7]=A=>u.value=A),title:"Note Configuration"},{default:n(()=>[t(ho,{convention:r.convention,onClose:T[6]||(T[6]=A=>u.value=!1)},null,8,["convention"])]),_:1},8,["modelValue"])],64))}}),Mo=Q({__name:"StripeRefundPayment",props:X({paymentTransaction:{}},{modelValue:{type:Boolean,required:!0}}),emits:X(["refunded"],["update:modelValue"]),setup(e,{emit:f}){const l=ae(e,"modelValue"),o=Ae(),u=p(!1),v=p("");let m=0;if(e.paymentTransaction.Data&&e.paymentTransaction.Data.PaymentIntent&&typeof e.paymentTransaction.Data.PaymentIntent=="object"){const r=e.paymentTransaction.Data.PaymentIntent;r&&(m=r.amount)}const a=p({Amount:m/100,Description:"",Reason:""}),s=p([{title:"Duplicate",value:"duplicate"},{title:"Fraudulent",value:"fraudulent"},{title:"Requested By Customer",value:"requested_by_customer"}]),d=p(!1);async function c(r){r.preventDefault(),d.value=!0,o.refundStripePayment(e.paymentTransaction.PaymentTransactionUUID,a.value).then(T=>{T?f("refunded",T):g("An unexpected error occurred.")}).catch(T=>{g("An error occurred processing the refund: "+T.toString())}),d.value=!1}const g=r=>{v.value=r,u.value=!0};return(r,T)=>(i(),E(tt,{modelValue:l.value,"onUpdate:modelValue":T[7]||(T[7]=A=>l.value=A),title:"Refund a Stripe Payment",color:"blue-darken-4",persistent:""},{default:n(()=>[t(fe,{class:"pa-0"},{default:n(()=>[t(Wl,{ref:"refundForm",id:"refund-form",onSubmit:T[4]||(T[4]=bt(A=>c(A),["prevent"]))},{default:n(()=>[t(J,null,{default:n(()=>[t(M,{cols:"12",sm:"6",md:"4",lg:"3",xl:"2"},{default:n(()=>[t(oe,{modelValue:a.value.Amount,"onUpdate:modelValue":T[0]||(T[0]=A=>a.value.Amount=A),modelModifiers:{number:!0},label:"Amount",prefix:"£",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),t(M,{cols:"12",sm:"6",md:"8",lg:"9",xl:"10"},{default:n(()=>[t(de,{modelValue:a.value.Reason,"onUpdate:modelValue":T[1]||(T[1]=A=>a.value.Reason=A),modelModifiers:{number:!0},items:s.value,"item-title":"title","item-value":"value",label:"Stripe Refund Reason",variant:"outlined","hide-details":""},null,8,["modelValue","items"])]),_:1}),t(M,{cols:"12"},{default:n(()=>[t(oe,{modelValue:a.value.Description,"onUpdate:modelValue":T[2]||(T[2]=A=>a.value.Description=A),modelModifiers:{number:!0},label:"Refund Description",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1})]),_:1}),t(J,null,{default:n(()=>[t(M,{class:"text-right",cols:"12",sm:"3",md:"2",lg:"2",xl:"1"},{default:n(()=>[t(j,{color:"error",class:"w-100",onClick:T[3]||(T[3]=A=>l.value=!1)},{default:n(()=>[C("Cancel")]),_:1})]),_:1}),t(Le),t(M,{class:"text-left",cols:"12",sm:"3",md:"2",lg:"2",xl:"1"},{default:n(()=>[t(j,{type:"submit",color:"success",class:"w-100"},je({default:n(()=>[C(" Issue Refund ")]),_:2},[d.value?{name:"prepend",fn:n(()=>[t(Da,{size:"20",indeterminate:""})]),key:"0"}:void 0]),1024)]),_:1})]),_:1})]),_:1},512)]),_:1}),t(Ra,{modelValue:u.value,"onUpdate:modelValue":T[6]||(T[6]=A=>u.value=A)},{actions:n(()=>[t(j,{variant:"text",onClick:T[5]||(T[5]=A=>u.value=!1)},{default:n(()=>[C(" Close ")]),_:1})]),default:n(()=>[C(I(v.value)+" ",1)]),_:1},8,["modelValue"])]),_:1},8,["modelValue"]))}}),No=["colspan"],Lo=B("strong",null,"Details",-1),Po=["innerHTML"],xa=Q({__name:"PaymentTransactions",props:{canEdit:{type:Boolean},expanded:{type:Boolean},hideHistory:{type:Boolean},updated:{},registration:{},showEditor:{type:Boolean}},emits:["close-editor","change"],setup(e,{emit:f}){const l=e;let{expanded:o=!0,hideHistory:u=!1,registration:v,showEditor:m}=l;const a=Ae(),s=p([]),d=p(o?["1"]:[]),c=p([]),g=p([{key:"CreatedAt",title:"Date"},{key:"Type",title:"Type"},{key:"Source",title:"Source"},{key:"Description",title:"Description"},{key:"Admin",title:"Admin"},{key:"Amount",title:"Amount"},{key:"Controls",title:""}]),r=p(!1),T=p(),A=p(!1),F=p(""),V=p([{key:"CreatedAt",order:"asc"}]),P=()=>({PaymentTransactionUUID:Ee(),Amount:0,Data:{},Description:"",ID:0,RegistrationID:v.ID,RegistrationUUID:v.RegistrationUUID,Source:aa.PAYMENT_TRANSACTION_SOURCE_NULL,Type:Mt.PAYMENT_TRANSACTION_TYPE_NULL}),U=p(P()),{convertTransactions:w,getPaymentTransactionsDisplay:Z}=ya();me(l,()=>{u=l.hideHistory,v=l.registration,m=l.showEditor,Z(v.RegistrationUUID).then(b=>{c.value=b})});const Y=()=>{Z(v.RegistrationUUID).then(b=>{c.value=b})};Y();const G=()=>{a.saveRegistrationPaymentTransaction(U.value).then(b=>{b&&(w(b.PaymentTransactions),U.value=P(),f("close-editor"),f("change"))})},te=b=>{const h=c.value.find(R=>R.PaymentTransactionUUID===b);h&&(T.value=h.PaymentTransaction,r.value=!0)},O=b=>{if(b)try{c.value=w(b.PaymentTransactions),T.value=void 0,r.value=!1,F.value="Refund Processed",A.value=!0,f("change")}catch(h){console.error(h)}};return(b,h)=>(i(),_(k,null,[y(m)?(i(),_(k,{key:0},[t(ze,null,{default:n(()=>[C(" Add Transaction ")]),_:1}),t(J,null,{default:n(()=>[t(M,{cols:"12",sm:"6"},{default:n(()=>[t(de,{items:y(Dl),"item-title":"title","item-value":"value",label:"Transaction Type",clearable:!0,"hide-details":"",modelValue:U.value.Type,"onUpdate:modelValue":h[0]||(h[0]=R=>U.value.Type=R),variant:"outlined"},null,8,["items","modelValue"])]),_:1}),t(M,{cols:"12",sm:"6"},{default:n(()=>[t(de,{items:y(Il),"item-title":"title","item-value":"value",label:"Source",clearable:!0,"hide-details":"",modelValue:U.value.Source,"onUpdate:modelValue":h[1]||(h[1]=R=>U.value.Source=R),variant:"outlined"},null,8,["items","modelValue"])]),_:1})]),_:1}),t(J,null,{default:n(()=>[t(M,{cols:"12",sm:"8",md:"10"},{default:n(()=>[t(oe,{label:"Description","hide-details":"",modelValue:U.value.Description,"onUpdate:modelValue":h[2]||(h[2]=R=>U.value.Description=R),variant:"outlined"},null,8,["modelValue"])]),_:1}),t(M,{cols:"12",sm:"4",md:"2"},{default:n(()=>[t(oe,{label:"Amount","prepend-inner-icon":"mdi:mdi-currency-gbp","hide-details":"",modelValue:U.value.Amount,"onUpdate:modelValue":h[3]||(h[3]=R=>U.value.Amount=R),modelModifiers:{number:!0},variant:"outlined"},null,8,["modelValue"])]),_:1})]),_:1}),t(J,null,{default:n(()=>[t(M,{cols:"12",sm:"3",md:"2",lg:"1"},{default:n(()=>[t(j,{class:"w-100",onClick:h[4]||(h[4]=R=>f("close-editor")),color:"warning"},{default:n(()=>[C("Cancel")]),_:1})]),_:1}),t(Le),t(M,{cols:"12",sm:"6",md:"3",lg:"2",xl:"2"},{default:n(()=>[t(j,{class:"w-100",onClick:G,color:"primary"},{default:n(()=>[C("Submit Transaction")]),_:1})]),_:1})]),_:1})],64)):L("",!0),c.value.length&&!y(u)?(i(),E(pt,{key:1,class:"my-2",modelValue:d.value,"onUpdate:modelValue":h[10]||(h[10]=R=>d.value=R)},{default:n(()=>[t(_t,{value:"1"},{default:n(()=>[t(gt,null,{default:n(()=>[C(" Transaction History ")]),_:1}),t(Tt,null,{default:n(()=>[t(y(jt),{items:c.value,headers:g.value,"show-expand":!1,"item-value":"PaymentTransactionUUID",expanded:s.value,"onUpdate:expanded":h[5]||(h[5]=R=>s.value=R),"sort-by":V.value,"onUpdate:sortBy":h[6]||(h[6]=R=>V.value=R),class:"transactionTable"},{"item.Controls":n(({item:R})=>[b.canEdit&&R.raw.PaymentTransaction.Source===y(aa).PAYMENT_TRANSACTION_SOURCE_STRIPE&&R.raw.PaymentTransaction.Type===y(Mt).PAYMENT_TRANSACTION_TYPE_PAYMENT?(i(),E(j,{key:0,icon:"mdi:mdi-credit-card-refund",variant:"text",size:"xs",onClick:x=>te(R.key)},null,8,["onClick"])):L("",!0)]),"expanded-row":n(({columns:R,item:x})=>[B("tr",null,[B("td",{colspan:R.length},[Lo,B("div",{innerHTML:x.raw.HTML},null,8,Po)],8,No)])]),"footer.prepend":n(()=>[t(j,{"prepend-icon":"mdi:mdi-refresh",color:"primary",class:"mr-4",onClick:Y},{default:n(()=>[C("Refresh")]),_:1})]),_:1},8,["items","headers","expanded","sort-by"]),r.value&&T.value?(i(),E(Mo,{key:0,modelValue:r.value,"onUpdate:modelValue":h[7]||(h[7]=R=>r.value=R),"payment-transaction":T.value,onRefunded:O},null,8,["modelValue","payment-transaction"])):L("",!0),t(Ra,{modelValue:A.value,"onUpdate:modelValue":h[9]||(h[9]=R=>A.value=R)},{actions:n(()=>[t(j,{variant:"text",onClick:h[8]||(h[8]=R=>A.value=!1)},{default:n(()=>[C(" Close ")]),_:1})]),default:n(()=>[C(I(F.value)+" ",1)]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])):L("",!0)],64))}});const wo=Q({__name:"DataPanelRegistrationTags",props:X({registration:{}},{modelValue:{required:!0}}),emits:["update:modelValue"],setup(e){const f=ae(e,"modelValue"),l=ne(()=>!f.value.Meta.Tags||!Array.isArray(f.value.Meta.Tags)||f.value.Meta.Tags.length===0?e.registration.Tags:e.registration.Tags.filter(o=>f.value.Meta.Tags.includes(o.TagUUID)));return(o,u)=>(i(),E(Na,null,{default:n(()=>[(i(!0),_(k,null,W(l.value,v=>(i(),E(wt,{key:v.TagUUID},{default:n(()=>[C(I(v.Title),1)]),_:2},1024))),128))]),_:1}))}});const Fo=rt(wo,[["__scopeId","data-v-8cc2c172"]]),$o=Q({__name:"MetaDataItem",props:X({accommodations:{},convention:{},forms:{},interests:{},itemClass:{},tickets:{},venues:{}},{modelValue:{required:!0},registration:{required:!0}}),emits:X(["openActions","showForm"],["update:modelValue","update:registration"]),setup(e,{emit:f}){const l=ae(e,"modelValue"),o=ae(e,"registration"),u=m=>{f("openActions",m)},v=(m,a,s)=>{f("showForm",m,a,s)};return(m,a)=>l.value.MetaField===y(H).META_DATA_SOURCE_ACCOMMODATION_ALLOCATION?(i(),E($a,{key:0,convention:m.convention,tickets:m.tickets,accommodations:m.accommodations,venues:m.venues,registration:o.value,forms:m.forms,modelValue:l.value,"onUpdate:modelValue":a[0]||(a[0]=s=>l.value=s),data:""},null,8,["convention","tickets","accommodations","venues","registration","forms","modelValue"])):l.value.MetaField===y(H).META_DATA_SOURCE_BADGE_DISPLAY?(i(),E(zt,{key:1,"card-class":m.itemClass,registration:o.value,"show-title":!1},null,8,["card-class","registration"])):l.value.MetaField===y(H).META_DATA_SOURCE_EMAILS?(i(),E(Ya,{key:2,"allow-sending":!1,expanded:!1,"show-title":!1,registration:o.value,"text-class":"pa-0 ma-0"},null,8,["registration"])):l.value.MetaField===y(H).META_DATA_SOURCE_NOTES?(i(),E(Ga,{key:3,"allow-adding":!0,"card-class":m.itemClass,convention:m.convention,expanded:!1,registration:o.value,"show-control-panel":!1,"show-title":!1,"text-class":"pa-0 ma-0"},null,8,["card-class","convention","registration"])):l.value.MetaField===y(H).META_DATA_SOURCE_PAYMENT_STATUS?(i(),E(io,{key:4,registration:o.value},null,8,["registration"])):l.value.MetaField===y(H).META_DATA_SOURCE_PAYMENTS?(i(),E(xa,{key:5,registration:o.value,expanded:!1},null,8,["registration"])):l.value.MetaField===y(H).META_DATA_SOURCE_REGISTRATION_ACTIONS?(i(),E(j,{key:6,icon:"mdi:mdi-briefcase",variant:"flat",onClick:a[1]||(a[1]=s=>u(o.value))})):l.value.MetaField===y(H).META_DATA_SOURCE_SUBMISSION_STATUS||l.value.MetaField===y(H).META_DATA_SOURCE_ACCOMMODATION_FORM||l.value.MetaField===y(H).META_DATA_SOURCE_ADMIN_FORM||l.value.MetaField===y(H).META_DATA_SOURCE_DEALER_FORM||l.value.MetaField===y(H).META_DATA_SOURCE_BADGE_FORM||l.value.MetaField===y(H).META_DATA_SOURCE_REGISTRATION_FORM?(i(),E(Jn,{key:7,convention:m.convention,forms:m.forms,registration:o.value,onShowForm:v},null,8,["convention","forms","registration"])):l.value.MetaField===y(H).META_DATA_SOURCE_REGISTRATION_GROUP?(i(),E(Kn,{key:8,registration:o.value},null,8,["registration"])):l.value.MetaField===y(H).META_DATA_SOURCE_REGISTRATION_REFERENCE?(i(),_(k,{key:9},[C(I(o.value.Reference),1)],64)):l.value.MetaField===y(H).META_DATA_SOURCE_SUBMISSION_DATE?(i(),E(Xn,{key:10,registration:o.value},null,8,["registration"])):l.value.MetaField===y(H).META_DATA_SOURCE_TAGS?(i(),E(Fo,{key:11,registration:o.value,modelValue:l.value,"onUpdate:modelValue":a[2]||(a[2]=s=>l.value=s)},null,8,["registration","modelValue"])):(i(),_(k,{key:12},[C(" Unhandled Meta Item "+I(l.value),1)],64))}}),Bo=Q({__name:"UserDataItem",props:X({accommodations:{},convention:{},forms:{},interests:{},itemClass:{},tickets:{},venues:{}},{modelValue:{required:!0},registration:{required:!0}}),emits:["update:modelValue","update:registration"],setup(e){const f=ae(e,"modelValue"),l=ae(e,"registration"),o=At(),u=ne(()=>o.GetProfileImageURL(l.value.UserUUID));return(v,m)=>f.value.UserField===y(ie).USER_DATA_SOURCE_TELEGRAM&&l.value.User.Handle?(i(),_(k,{key:0},[C(" @"+I(l.value.User.Handle),1)],64)):f.value.UserField===y(ie).USER_DATA_SOURCE_AVATAR?(i(),E(qt,{key:1,class:"rounded-circle",src:u.value,height:"32",width:"32"},null,8,["src"])):f.value.UserField===y(ie).USER_DATA_SOURCE_DATE_OF_BIRTH?(i(),_(k,{key:2},[C(I(y(Re)(l.value.User.Additional.DOB,{withYear:!0,withDay:!1})),1)],64)):f.value.UserField===y(ie).USER_DATA_SOURCE_EMAIL?(i(),_(k,{key:3},[C(I(l.value.User.Additional.Email),1)],64)):f.value.UserField===y(ie).USER_DATA_SOURCE_FIRST_NAME?(i(),_(k,{key:4},[C(I(l.value.User.Additional.FirstName),1)],64)):f.value.UserField===y(ie).USER_DATA_SOURCE_LAST_NAME?(i(),_(k,{key:5},[C(I(l.value.User.Additional.LastName),1)],64)):(i(),_(k,{key:6},[C(" Unhandled User Field "+I(f.value),1)],64))}}),ma=Q({__name:"PanelItem",props:X({accommodations:{},convention:{},extras:{},forms:{},interests:{},itemClass:{},tickets:{},venues:{}},{modelValue:{required:!0},registration:{required:!0}}),emits:X(["openActions","showForm"],["update:modelValue","update:registration"]),setup(e,{emit:f}){const l=ae(e,"modelValue"),o=ae(e,"registration"),u=m=>{f("openActions",m)},v=(m,a,s)=>{f("showForm",m,a,s)};return(m,a)=>l.value.SourceType===y(Me).LAYOUT_ITEM_SOURCE_FORM?(i(),E(qn,{key:0,accommodations:m.accommodations,convention:m.convention,extras:m.extras,forms:m.forms,interests:m.interests,"item-class":m.itemClass,tickets:m.tickets,venues:m.venues,modelValue:l.value,"onUpdate:modelValue":a[0]||(a[0]=s=>l.value=s),registration:o.value,"onUpdate:registration":a[1]||(a[1]=s=>o.value=s)},null,8,["accommodations","convention","extras","forms","interests","item-class","tickets","venues","modelValue","registration"])):l.value.SourceType===y(Me).LAYOUT_ITEM_SOURCE_META?(i(),E($o,{key:1,accommodations:m.accommodations,convention:m.convention,forms:m.forms,interests:m.interests,"item-class":m.itemClass,tickets:m.tickets,venues:m.venues,modelValue:l.value,"onUpdate:modelValue":a[2]||(a[2]=s=>l.value=s),registration:o.value,"onUpdate:registration":a[3]||(a[3]=s=>o.value=s),onOpenActions:u,onShowForm:v},null,8,["accommodations","convention","forms","interests","item-class","tickets","venues","modelValue","registration"])):l.value.SourceType===y(Me).LAYOUT_ITEM_SOURCE_USER?(i(),E(Bo,{key:2,accommodations:m.accommodations,convention:m.convention,forms:m.forms,interests:m.interests,"item-class":m.itemClass,tickets:m.tickets,venues:m.venues,modelValue:l.value,"onUpdate:modelValue":a[4]||(a[4]=s=>l.value=s),registration:o.value,"onUpdate:registration":a[5]||(a[5]=s=>o.value=s)},null,8,["accommodations","convention","forms","interests","item-class","tickets","venues","modelValue","registration"])):L("",!0)}}),Yo=["onClick"],Go=["onClick"],xo=Q({__name:"PanelLayout",props:X({accommodations:{},convention:{},extras:{},forms:{},interests:{},tickets:{},venues:{}},{layout:{required:!0},modelValue:{required:!0}}),emits:X(["openActions","showForm"],["update:layout","update:modelValue"]),setup(e,{emit:f}){const l=ga(),o=ae(e,"layout"),u=ae(e,"modelValue"),v=p({});o.value.Panels.forEach(c=>{v.value[c.LayoutPanelUUID]=!1});const m=c=>{f("openActions",c)},a=(c,g,r)=>{f("showForm",c,g,r)},s=c=>{switch(c.PanelStyle){case ye.PANEL_STYLE_NAV_BOTTOM:return"bottom";case ye.PANEL_STYLE_NAV_LEFT:return"left";case ye.PANEL_STYLE_NAV_RIGHT:return"right";case ye.PANEL_STYLE_NAV_TOP:return"top"}},d=(c,g=!1)=>{switch(c.PanelStyle){case ye.PANEL_STYLE_NAV_BOTTOM:return g?"mdi:mdi-chevron-double-down":"mdi:mdi-chevron-double-up";case ye.PANEL_STYLE_NAV_LEFT:return g?"mdi:mdi-chevron-double-left":"mdi:mdi-chevron-double-right";case ye.PANEL_STYLE_NAV_RIGHT:return g?"mdi:mdi-chevron-double-right":"mdi:mdi-chevron-double-left";case ye.PANEL_STYLE_NAV_TOP:return g?"mdi:mdi-chevron-double-up":"mdi:mdi-chevron-double-down"}};return(c,g)=>(i(),_(k,null,[(i(!0),_(k,null,W(o.value.Panels,r=>(i(),_(k,{key:r.LayoutPanelUUID},[s(r)!==void 0?(i(),E(Zl,{key:0,permanent:!0,location:s(r),border:y(l).smAndDown.value?1:0,rail:y(l).smAndDown.value&&!v.value[r.LayoutPanelUUID],"rail-width":"30",width:y(l).smAndDown.value?"100%":256},{default:n(()=>[y(l).smAndDown.value&&!v.value[r.LayoutPanelUUID]?(i(),_("h3",{key:0,class:qe(`bg-secondary fill-height ${s(r)==="top"||s(r)==="bottom"?"px-3 text-right":"py-3 text-left"}`),style:{cursor:"pointer"},onClick:T=>v.value[r.LayoutPanelUUID]=!0},[t(Ce,{icon:d(r,!1)},null,8,["icon"])],10,Yo)):(i(),_(k,{key:1},[B("h3",{class:"bg-secondary pa-3 d-flex",style:ea(y(l).smAndDown.value?"cursor: pointer;":""),onClick:T=>v.value[r.LayoutPanelUUID]=!1},[C(I(r.Name)+" ",1),y(l).smAndDown.value?(i(),_(k,{key:0},[t(Le),t(j,{icon:d(r,!0),variant:"plain",size:"sm"},null,8,["icon"])],64)):L("",!0)],12,Go),t(He,{class:"bg-panel",style:{height:"calc(100vh - 116px)"}},{default:n(()=>[(i(!0),_(k,null,W(r.Items,(T,A)=>(i(),E(Ne,{key:T.LayoutItemUUID},{default:n(()=>[r.Items.length>1?(i(),E(Nt,{key:0,class:"font-weight-bold"},{default:n(()=>[C(I(T.Label),1)]),_:2},1024)):L("",!0),t(ma,{accommodations:c.accommodations,convention:c.convention,extras:c.extras,forms:c.forms,interests:c.interests,"item-class":"bg-panel border-0",tickets:c.tickets,venues:c.venues,modelValue:r.Items[A],"onUpdate:modelValue":F=>r.Items[A]=F,registration:u.value,onOpenActions:m,onShowForm:a},null,8,["accommodations","convention","extras","forms","interests","tickets","venues","modelValue","onUpdate:modelValue","registration"])]),_:2},1024))),128))]),_:2},1024)],64))]),_:2},1032,["location","border","rail","width"])):L("",!0)],64))),128)),t(Jl,{class:"py-0"},{default:n(()=>[t(fe,null,{default:n(()=>[t(J,null,{default:n(()=>[(i(!0),_(k,null,W(o.value.Panels,r=>{var T,A,F,V,P,U;return i(),_(k,{key:r.LayoutPanelUUID},[r.PanelStyle===y(ye).PANEL_STYLE_FLEX?(i(),E(M,{key:0,cols:((T=r.Meta.cols)==null?void 0:T.toString())||!1,xs:((A=r.Meta.cols_xs)==null?void 0:A.toString())||!1,sm:((F=r.Meta.cols_sm)==null?void 0:F.toString())||!1,md:((V=r.Meta.cols_md)==null?void 0:V.toString())||!1,lg:((P=r.Meta.cols_lg)==null?void 0:P.toString())||!1,xl:((U=r.Meta.cols_xl)==null?void 0:U.toString())||!1,class:"pa-0 pa-sm-2"},{default:n(()=>[t(fe,{class:"bg-panel",style:ea(y(l).smAndUp.value?"border-radius: 15px;":"")},{default:n(()=>[B("h3",null,I(r.Name),1),t(He,{class:"bg-panel"},{default:n(()=>[(i(!0),_(k,null,W(r.Items,(w,Z)=>(i(),E(Ne,{key:w.LayoutItemUUID,class:"px-0"},{default:n(()=>[r.Items.length>1?(i(),E(Nt,{key:0,class:"font-weight-bold"},{default:n(()=>[C(I(w.Label),1)]),_:2},1024)):L("",!0),t(ma,{accommodations:c.accommodations,convention:c.convention,extras:c.extras,forms:c.forms,interests:c.interests,"item-class":"bg-panel border-0",tickets:c.tickets,venues:c.venues,modelValue:r.Items[Z],"onUpdate:modelValue":Y=>r.Items[Z]=Y,registration:u.value,"onUpdate:registration":g[0]||(g[0]=Y=>u.value=Y),onOpenActions:m,onShowForm:a},null,8,["accommodations","convention","extras","forms","interests","tickets","venues","modelValue","onUpdate:modelValue","registration"])]),_:2},1024))),128))]),_:2},1024)]),_:2},1032,["style"])]),_:2},1032,["cols","xs","sm","md","lg","xl"])):L("",!0)],64)}),128))]),_:1})]),_:1})]),_:1})],64))}}),Ho=Q({__name:"DataTableItemPanel",props:X({accommodations:{},cardClass:{},convention:{},extras:{},forms:{},interests:{},tickets:{},venues:{},layouts:{}},{modelValue:{required:!0}}),emits:X(["openActions","showForm"],["update:modelValue"]),setup(e,{emit:f}){const l=p(),o=p(!1),u=s=>{l.value=s,o.value=!0},v=ae(e,"modelValue"),m=s=>{f("openActions",s)},a=(s,d,c)=>{f("showForm",s,d,c)};return(s,d)=>(i(),_("div",null,[s.layouts?(i(),E(He,{key:0},{default:n(()=>[(i(!0),_(k,null,W(s.layouts,c=>(i(),E(Ne,{key:c.AdminLayoutUUID,class:"d-block pa-0 ma-0"},{default:n(()=>[t(Nt,{style:{"text-overflow":"inherit"},class:"overflow-visible text-wrap"},{default:n(()=>[t(j,{"prepend-icon":"mdi:mdi-page-layout-body",variant:"flat",onClick:g=>u(c)},{default:n(()=>[C(I(c.Name),1)]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024))),128))]),_:1})):L("",!0),o.value&&l.value?(i(),E(tt,{key:1,modelValue:o.value,"onUpdate:modelValue":d[2]||(d[2]=c=>o.value=c),"hide-extension":!0,fullscreen:!0,title:`#${v.value.Reference} ${v.value.User.DisplayName} - ${l.value.Name} `,scrollable:!0,"card-class":"pa-0","card-style":"margin-bottom: -52px"},{default:n(()=>[t(xo,{accommodations:s.accommodations,convention:s.convention,extras:s.extras,forms:s.forms,interests:s.interests,tickets:s.tickets,venues:s.venues,layout:l.value,"onUpdate:layout":d[0]||(d[0]=c=>l.value=c),modelValue:v.value,"onUpdate:modelValue":d[1]||(d[1]=c=>v.value=c),onOpenActions:m,onShowForm:a},null,8,["accommodations","convention","extras","forms","interests","tickets","venues","layout","modelValue"])]),_:1},8,["modelValue","title"])):L("",!0)]))}}),qo={class:"text-grey-lighten-1"},jo={key:0,class:"text-blue text-center"},zo={key:1,class:"text-red text-center"},Qo={key:2,class:"text-orange text-center"},Ko={key:3,class:"text-orange text-center"},Xo={key:4,class:"text-orange text-center"},Wo={key:5,class:"text-orange text-center"},Jo={key:6,class:"text-green text-center"},Zo={key:0},ei={key:0},ti=B("strong",null,"Total:",-1),ai=Q({__name:"RegListRow",props:X({header:{},accommodations:{},convention:{},extras:{},forms:{},interests:{},item:{},tickets:{},user:{},venues:{}},{modelValue:{required:!0}}),emits:X(["openActions","openPayments","openTags","reload","showForm","switchUser"],["update:modelValue"]),setup(e,{emit:f}){const l=ae(e,"modelValue"),o=(a,s,d)=>{f("showForm",{registration:a,form:s,submission:d})},u=a=>{f("openActions",a)},v=a=>{f("switchUser",a)},m=a=>{const s=l.value.registration;return{ID:0,SubmissionUUID:Ee(),FormID:a.ID,FormUUID:a.FormUUID,Form:a,UserID:s.UserID,UserUUID:s.UserUUID,RegistrationID:s.ID,RegistrationUUID:s.RegistrationUUID,Registration:s,Data:[],Status:Sa.SUBMISSION_STATUS_NULL}};return(a,s)=>a.header.type==="ACCOMMODATION"&&a.accommodations.length>0&&a.item.raw[a.header.key]?(i(),E(La,{key:0,value:a.item.raw[a.header.key].Data,accommodations:a.accommodations,convention:a.convention,forms:a.forms,tickets:a.tickets,venues:a.venues,registration:a.item.raw[a.header.key].Registration},null,8,["value","accommodations","convention","forms","tickets","venues","registration"])):a.header.type==="EXTRAS"&&a.extras.length>0?(i(),E(Pa,{key:1,value:a.item.raw[a.header.key],extras:a.extras},null,8,["value","extras"])):a.header.type==="INTERESTS"&&a.interests.length>0?(i(),E(wa,{key:2,value:a.item.raw[a.header.key],interests:a.interests},null,8,["value","interests"])):a.header.type==="TICKET"&&a.tickets.length>0?(i(),E(Fa,{key:3,value:a.item.raw[a.header.key],tickets:a.tickets},null,8,["value","tickets"])):a.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_SUBMISSION_STATUS"||a.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_ACCOMMODATION_FORM"||a.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_ADMIN_FORM"||a.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_DEALER_FORM"||a.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_BADGE_FORM"||a.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_REGISTRATION_FORM"?(i(),_(k,{key:4},[B("ul",null,[(i(!0),_(k,null,W(a.forms.filter(d=>d.Type===y(Te).FORM_TYPE_ADMIN&&a.item.raw[a.header.key].findIndex(c=>c.Form.ID===d.ID)<0),d=>(i(),_("li",{key:d.Heading},[B("strong",qo,I(d.Heading),1),t(j,{class:"text-grey-lighten-1",icon:"mdi:mdi-form-select",title:"Edit Submitted Data",variant:"flat",onClick:c=>o(a.item.raw.registration,d,m(d))},null,8,["onClick"])]))),128))]),B("ul",null,[(i(!0),_(k,null,W(a.item.raw[a.header.key],d=>(i(),_("li",{key:d.Heading},[B("strong",null,[C(I(d.Heading),1),d.Form.Type!==y(Te).FORM_TYPE_ADMIN?(i(),_(k,{key:0},[C(": ")],64)):L("",!0)]),d.Form.Type!==y(Te).FORM_TYPE_ADMIN?(i(),_("span",{key:0,class:qe(y(Ia)(d.Submission.Status))},I(y(Yt)(d.Submission.Status)),3)):L("",!0),t(j,{icon:"mdi:mdi-form-select",title:"Edit Submitted Data",variant:"flat",onClick:c=>o(d.Registration,d.Form,d.Submission)},null,8,["onClick"])]))),128))])],64)):a.header.type==="LAYOUT_ITEM_SOURCE_USER.USER_DATA_SOURCE_AVATAR"?(i(),E(qt,{key:5,class:"rounded-circle",src:a.item.raw[a.header.key],height:"32",width:"32"},null,8,["src"])):a.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_PAYMENT_STATUS"?(i(),_(k,{key:6},[a.item.raw[a.header.key]=="NOT_REQUIRED"?(i(),_("div",jo,"No Payment Requested")):a.item.raw[a.header.key]=="MISSING_REQUIRED"?(i(),_("div",zo,"Partner Payment Not Requested")):a.item.raw[a.header.key]=="AWAITING_PARTNER"?(i(),_("div",Qo,"Awaiting Partner Payment")):a.item.raw[a.header.key]=="ALL_REQUIRED"?(i(),_("div",Ko,"Awaiting Payments")):a.item.raw[a.header.key]=="REQUIRED"?(i(),_("div",Xo,"Awaiting Payment")):a.item.raw[a.header.key]=="ADDITIONAL_REQUIRED"?(i(),_("div",Wo,"Awaiting Additional Payments")):(i(),_("div",Jo,"Completed"))],64)):a.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_REGISTRATION_ACTIONS"?(i(),_(k,{key:7},[t(j,{icon:"mdi:mdi-briefcase",variant:"flat",onClick:s[0]||(s[0]=d=>u(a.item.raw[a.header.key]))}),y(vn)(a.user)?(i(),E(j,{key:0,icon:"mdi:mdi-account-switch-outline",variant:"flat",onClick:s[1]||(s[1]=d=>v(a.item.raw[a.header.key]))})):L("",!0)],64)):a.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_REGISTRATION_GROUP"?(i(),_(k,{key:8},[a.item.raw[a.header.key].length===1?(i(),_("em",Zo," Not in a group ")):(i(),_(k,{key:1},[B("ul",null,[(i(!0),_(k,null,W(a.item.raw[a.header.key],d=>(i(),_("li",{key:d.UUID,class:"ml-0"},[C(" #"+I(d.Reference)+" : "+I(d.Name)+" ",1),d.IsLeader?(i(),_("strong",ei,"(Leader)")):L("",!0)]))),128))]),ti,C(" "+I(a.item.raw[a.header.key].length),1)],64))],64)):a.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_DATA_LAYOUT"?(i(),_(k,{key:9},[l.value.registration?(i(),E(Ho,{key:0,accommodations:a.accommodations,convention:a.convention,extras:a.extras,forms:a.forms,interests:a.interests,tickets:a.tickets,venues:a.venues,layouts:a.item.raw[a.header.key].Layouts,modelValue:l.value.registration,"onUpdate:modelValue":s[2]||(s[2]=d=>l.value.registration=d),onOpenActions:u,onShowForm:o},null,8,["accommodations","convention","extras","forms","interests","tickets","venues","layouts","modelValue"])):L("",!0)],64)):(i(),_(k,{key:10},[C(I(a.item.raw[a.header.key]),1)],64))}}),ca=Q({__name:"RegistrationActionTabs",props:X({alignTabs:{},class:{},fixedTabs:{type:Boolean},showArrows:{type:[String,Boolean]},tabs:{}},{modelValue:{required:!0}}),emits:["update:modelValue"],setup(e){const f=e,l=ae(e,"modelValue");return(o,u)=>(i(),E(Va,ke({modelValue:l.value,"onUpdate:modelValue":u[0]||(u[0]=v=>l.value=v)},f),{default:n(()=>[(i(!0),_(k,null,W(o.tabs,v=>(i(),E(Oa,{value:v.value,key:v.value},{default:n(()=>[C(I(v.label),1)]),_:2},1032,["value"]))),128))]),_:1},16,["modelValue"]))}}),li=(e=void 0,f)=>e===void 0?!1:xt(e,Gt.GROUP_TYPE_CONVENTION,f.ConventionUUID,f).EditPaymentTransactions,yt=e=>(Ft("data-v-8af8174d"),e=e(),$t(),e),ni={class:"mb-4"},oi={class:"v-row"},ii={key:0,class:"v-col v-col-10 py-1 v-row mx-0 pl-0"},si={class:"v-col v-col-12 v-col-sm-4 v-col-md-3 font-weight-bold pb-0 pr-0"},ui={class:"v-col v-col-12 v-col-sm-8 v-col-md-9 font-italic pt-0 pt-sm-3 pb-sm-0 pl-sm-0"},ri={class:"v-col v-col-2 align-self-end text-right py-1 text-no-wrap"},di=yt(()=>B("dt",{class:"v-col v-col-9 py-1 font-weight-bold totals"}," Total Charges ",-1)),mi={class:"v-col v-col-3 align-self-end text-right py-1 totals text-no-wrap"},ci=yt(()=>B("dt",{class:"v-col v-col-9 py-1 font-weight-bold"}," Applied Total ",-1)),vi={class:"v-col v-col-3 align-self-end text-right py-1 text-no-wrap"},fi=yt(()=>B("dt",{class:"v-col v-col-9 py-1 font-weight-bold"}," Currently Paid ",-1)),Ui={class:"v-col v-col-3 align-self-end text-right py-1 text-no-wrap"},Ai=yt(()=>B("dt",{class:"v-col v-col-9 py-1 font-weight-bold totals"}," Balance ",-1)),gi={class:"v-col v-col-3 align-self-end text-right py-1 totals text-no-wrap"},Ti=Q({__name:"PaymentActions",props:X({forms:{},title:{}},{modelValue:{required:!0}}),emits:["update:modelValue"],setup(e){const f=p(!1),l=p(),o=p([]),u=p(new Date().getTime()),v=p(!1),m=ae(e,"modelValue"),a=p(_e(m.value));me(m,()=>{a.value=_e(m.value)});const s=Ae();s.getConvention(m.value.ConventionUUID).then(r=>{r&&(v.value=li(at(),r))});const d=()=>{s.generateRegistrationCharges(m.value.RegistrationUUID,!1).then(r=>{r&&(o.value=r.PaymentTransactions,l.value=r.Registration,u.value=new Date().getTime())}).catch(()=>{})};d();const c=()=>{s.generateRegistrationCharges(m.value.RegistrationUUID,!0).then(r=>{r&&(o.value=r.PaymentTransactions,l.value=r.Registration,u.value=new Date().getTime())})},{totalCharges:g}=ya();return(r,T)=>(i(),E(Pe,null,{default:n(()=>[t(lt,null,{default:n(()=>[t(ze,null,{default:n(()=>[C(" Payments (#"+I(m.value.Reference)+" "+I(m.value.User.DisplayName)+") ",1)]),_:1})]),_:1}),t(Qe,null,{default:n(()=>[l.value?(i(),_(k,{key:0},[B("h3",ni,"#"+I(l.value.Reference)+" "+I(l.value.User.DisplayName),1),B("dl",oi,[(i(!0),_(k,null,W(o.value,A=>(i(),_(k,{key:A.PaymentTransactionUUID},[A.Type===y(Mt).PAYMENT_TRANSACTION_TYPE_CHARGE?(i(),_("dt",ii,[B("div",si,I(A.Description.split(":")[0])+": ",1),B("div",ui,I(A.Description.split(":")[1]),1)])):L("",!0),B("dd",ri," £"+I(A.Amount),1)],64))),128)),di,B("dd",mi," £"+I(y(g)(o.value)),1),ci,B("dd",vi," £"+I(l.value.Total),1),fi,B("dd",Ui," £"+I(l.value.Paid),1),Ai,B("dd",gi," £"+I(l.value.Total-l.value.Paid),1)]),t(J,{class:"flex-row-reverse"},{default:n(()=>[t(M,{class:"text-right"},{default:n(()=>[t(j,{color:"primary",onClick:c},{default:n(()=>[C("Apply Charges")]),_:1})]),_:1}),!f.value&&v.value?(i(),E(M,{key:0},{default:n(()=>[t(j,{color:"secondary",onClick:T[0]||(T[0]=A=>f.value=!0)},{default:n(()=>[C("Transaction Entry")]),_:1})]),_:1})):L("",!0)]),_:1})],64)):L("",!0),t(xa,{"can-edit":v.value,registration:m.value,"show-editor":f.value,onCloseEditor:T[1]||(T[1]=A=>f.value=!1),updated:u.value,onChange:d},null,8,["can-edit","registration","show-editor","updated"])]),_:1})]),_:1}))}});const _i=rt(Ti,[["__scopeId","data-v-8af8174d"]]),pi=Q({__name:"RegistrationFormStatus",props:X({forms:{}},{modelValue:{required:!0}}),emits:["update:modelValue"],setup(e){const f=Ae(),l=ae(e,"modelValue"),o=(u,v)=>{const m=l.value.Submissions.find(a=>a.SubmissionUUID==v);if(!m){u&&u("Submission not found");return}f.setSubmissionStatus(v,m.Status).then(a=>{a?(l.value.Submissions.forEach((s,d)=>{l.value.Submissions[d].Status=s.Status}),u&&u("Status Saved")):u&&u("Status not saved")}).catch(()=>{u&&u("Status not saved")})};return(u,v)=>(i(),E(Pe,null,{default:n(()=>[t(lt,null,{default:n(()=>[t(ze,null,{default:n(()=>[C("Status (#"+I(l.value.Reference)+" "+I(l.value.User.DisplayName)+")",1)]),_:1})]),_:1}),t(Qe,null,{default:n(()=>[t(He,null,{default:n(()=>[(i(!0),_(k,null,W(l.value.Submissions,m=>(i(),E(Ne,{key:m.SubmissionUUID,class:"pa-0"},{default:n(()=>[t(J,{class:"py-2 align-center"},{default:n(()=>[t(M,{cols:"9",sm:"10",md:"10",lg:"9"},{default:n(()=>{var a;return[t(de,{modelValue:m.Status,"onUpdate:modelValue":s=>m.Status=s,items:y(la),"item-text":"title","item-value":"value",variant:"outlined","hide-details":"",label:((a=u.forms.find(s=>s.FormUUID==m.FormUUID))==null?void 0:a.Name)||""},{selection:n(()=>[t(Ce,{class:"mr-4 d-none d-sm-inline"},{default:n(()=>{var s;return[C(I((s=y(la).find(d=>d.value===m.Status))==null?void 0:s.icon),1)]}),_:2},1024),C(" "+I(y(Yt)(m.Status)),1)]),item:n(({item:s,props:{onClick:d}})=>[t(Ne,{title:s.title,"prepend-icon":s.raw.icon,onClick:d},null,8,["title","prepend-icon","onClick"])]),_:2},1032,["modelValue","onUpdate:modelValue","items","label"])]}),_:2},1024),t(M,{cols:"3",sm:"2",md:"2",lg:"1"},{default:n(()=>[t(ut,{class:"d-none d-sm-inline-flex",title:"Save","prepend-icon":"mdi:mdi-content-save",color:"warning",onClick:a=>o(a.callback,m.SubmissionUUID)},null,8,["onClick"]),t(ut,{class:"d-sm-none",size:"35",icon:"mdi:mdi-content-save",color:"warning",onClick:a=>o(a.callback,m.SubmissionUUID)},null,8,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1}))}}),yi=e=>(Ft("data-v-7d39acf0"),e=e(),$t(),e),Ei=yi(()=>B("p",null,"Any tags controlled through registration form fields will be reset when the applicable form is saved. If you don't know what you're doing here, don't touch!",-1)),Di={class:"mb-4"},Ii=Q({__name:"RegistrationTags",props:X({title:{}},{modelValue:{required:!0}}),emits:["update:modelValue"],setup(e){const f=Ae(),l=ae(e,"modelValue"),o=p(_e(l.value)),u=p(!1),v=p(o.value.Tags);me(l,()=>{o.value=_e(l.value)});const m=({callback:a})=>{const s=[],d=[];o.value.Tags.forEach(c=>{v.value.find(r=>r.TagUUID===c.TagUUID)||s.push(c.TagUUID)}),v.value.forEach(c=>{o.value.Tags.find(r=>c.TagUUID===r.TagUUID)||d.push(c.TagUUID)}),f.updateRegistrationTags(s,d,o.value.RegistrationUUID).then(c=>{c?a&&(a("Tags Saved"),l.value.Tags=c.Tags):a&&a("Error Saving Tags")}).catch(()=>{a&&a("Error Saving Tags")})};return(a,s)=>(i(),E(Pe,null,{default:n(()=>[t(lt,null,{default:n(()=>[t(ze,null,{default:n(()=>[C("Tags (#"+I(o.value.Reference)+" "+I(o.value.User.DisplayName)+")",1)]),_:1})]),_:1}),t(Qe,null,{default:n(()=>[t(tn,{class:"my-4"},{default:n(()=>[t(an,null,{default:n(()=>[C("Caution")]),_:1}),Ei]),_:1}),B("h3",Di,"#"+I(o.value.Reference)+" "+I(o.value.User.DisplayName),1),t(ha,{modelValue:o.value.Tags,"onUpdate:modelValue":s[0]||(s[0]=d=>o.value.Tags=d),convention:o.value.ConventionUUID,"show-key":!0,chips:!0,"show-uuid":u.value},null,8,["modelValue","convention","show-uuid"])]),_:1}),t(Ht,{class:"px-4 align-start"},{default:n(()=>[t(kt,{label:"Show UUID",modelValue:u.value,"onUpdate:modelValue":s[1]||(s[1]=d=>u.value=d)},null,8,["modelValue"]),t(ut,{onClick:m,variant:"flat"})]),_:1})]),_:1}))}});const Si=rt(Ii,[["__scopeId","data-v-7d39acf0"]]),va=Q({__name:"RegistrationActionWindows",props:X({accommodations:{},convention:{},extras:{},forms:{},interests:{},registration:{},tickets:{},venues:{}},{modelValue:{required:!0}}),emits:X(["update:registration"],["update:modelValue"]),setup(e,{emit:f}){const l=e,o=ae(e,"modelValue"),u=dt(l,f,void 0,void 0,"registration");return(v,m)=>(i(),E(ba,{modelValue:o.value,"onUpdate:modelValue":m[3]||(m[3]=a=>o.value=a)},{default:n(()=>[t(xe,{value:"badges"},{default:n(()=>[o.value=="badges"?(i(),E(fe,{key:0,class:"pa-0 mx-0",fluid:!0},{default:n(()=>[t(zt,{convention:v.convention,registration:y(u)},null,8,["convention","registration"])]),_:1})):L("",!0)]),_:1}),t(xe,{value:"emails"},{default:n(()=>[o.value=="emails"?(i(),E(fe,{key:0,class:"pa-0 mx-0",fluid:!0},{default:n(()=>[t(Ya,{registration:y(u)},null,8,["registration"])]),_:1})):L("",!0)]),_:1}),t(xe,{value:"notes"},{default:n(()=>[o.value=="notes"?(i(),E(fe,{key:0,class:"pa-0 mx-0",fluid:!0},{default:n(()=>[t(Ga,{convention:v.convention,expanded:!1,registration:y(u)},null,8,["convention","registration"])]),_:1})):L("",!0)]),_:1}),t(xe,{value:"payments"},{default:n(()=>[o.value=="payments"?(i(),E(fe,{key:0,class:"pa-0 mx-0",fluid:!0},{default:n(()=>[t(_i,{modelValue:y(u),"onUpdate:modelValue":m[0]||(m[0]=a=>st(u)?u.value=a:null),forms:v.forms,title:"Registration Payments"},null,8,["modelValue","forms"])]),_:1})):L("",!0)]),_:1}),t(xe,{value:"status"},{default:n(()=>[o.value=="status"?(i(),E(fe,{key:0,class:"pa-0 mx-0",fluid:!0},{default:n(()=>[t(pi,{modelValue:y(u),"onUpdate:modelValue":m[1]||(m[1]=a=>st(u)?u.value=a:null),forms:v.forms},null,8,["modelValue","forms"])]),_:1})):L("",!0)]),_:1}),t(xe,{value:"tags"},{default:n(()=>[o.value=="tags"?(i(),E(fe,{key:0,class:"pa-0 mx-0",fluid:!0},{default:n(()=>[t(Si,{modelValue:y(u),"onUpdate:modelValue":m[2]||(m[2]=a=>st(u)?u.value=a:null),title:"Registration Tags"},null,8,["modelValue"])]),_:1})):L("",!0)]),_:1})]),_:1},8,["modelValue"]))}}),Ri=(e,f)=>e===void 0?!1:xt(e,Gt.GROUP_TYPE_CONVENTION,f.ConventionUUID,f).ViewPaymentTransactions,Ci={key:0},Vi={key:1},fa=Q({__name:"RegistrationActions",props:X({accommodations:{},convention:{},extras:{},forms:{},interests:{},registration:{},tickets:{},title:{},useDialog:{type:Boolean},venues:{}},{modelValue:{type:Boolean,required:!0}}),emits:X(["update:registration"],["update:modelValue"]),setup(e,{emit:f}){const l=e,o=ae(e,"modelValue"),u=dt(l,f,void 0,void 0,"registration"),v=p("notes"),m=at(),a=[{label:"Badge",value:"badges"},{label:"Emails",value:"emails"},{label:"Notes",value:"notes"},{label:"Status",value:"status"},{label:"Tags",value:"tags"}];return Ri(m,l.convention)&&a.splice(2,0,{label:"Payments",value:"payments"}),(s,d)=>s.useDialog?(i(),_("div",Ci,[t(tt,{modelValue:o.value,"onUpdate:modelValue":d[3]||(d[3]=c=>o.value=c),title:s.title,"show-close-action":!0,color:"primary","close-action-label":"Close",persistent:!0,"retain-focus":!1,scrollable:!0,fullscreen:"","card-class":"ma-0 pa-0"},{extension:n(()=>[t(ca,{modelValue:v.value,"onUpdate:modelValue":d[0]||(d[0]=c=>v.value=c),tabs:a,"show-arrows":!0},null,8,["modelValue"])]),default:n(()=>[t(va,{modelValue:v.value,"onUpdate:modelValue":d[1]||(d[1]=c=>v.value=c),registration:y(u),"onUpdate:registration":d[2]||(d[2]=c=>st(u)?u.value=c:null),accommodations:s.accommodations,convention:s.convention,extras:s.extras,forms:s.forms,interests:s.interests,tabs:a,tickets:s.tickets,venues:s.venues},null,8,["modelValue","registration","accommodations","convention","extras","forms","interests","tickets","venues"])]),_:1},8,["modelValue","title"])])):(i(),_("div",Vi,[t(ca,{modelValue:v.value,"onUpdate:modelValue":d[4]||(d[4]=c=>v.value=c),tabs:a,"show-arrows":!0},null,8,["modelValue"]),t(va,{modelValue:v.value,"onUpdate:modelValue":d[5]||(d[5]=c=>v.value=c),registration:y(u),"onUpdate:registration":d[6]||(d[6]=c=>st(u)?u.value=c:null),accommodations:s.accommodations,convention:s.convention,extras:s.extras,forms:s.forms,interests:s.interests,tabs:a,tickets:s.tickets,venues:s.venues},null,8,["modelValue","registration","accommodations","convention","extras","forms","interests","tickets","venues"])]))}});const Oi=(e,f=500,l=!1)=>{let o;return(...u)=>{const m=function(){o=void 0,l||e.apply(void 0,u)},a=l&&!o;clearTimeout(o),o=setTimeout(m,f),a&&e.apply(void 0,u)}},Ha=(e,f)=>{e.forEach(l=>{l.Items.forEach(o=>{(o.SectionField==null||o.SectionField.Field==null)&&f.find(u=>{u.Sections.find(v=>{if(v.Fields){const m=v.Fields.find(a=>a.SectionFieldUUID===o.SectionFieldUUID);if(m)return o.SectionField=m,!0}})})})})},hi=B("h4",null,"Grid Size (Max 12)",-1),bi={key:0,class:"text-warning text-right pl-1"},ki=Q({__name:"EditAdminLayout",props:X({convention:{},layouts:{}},{modelValue:{required:!0}}),emits:X(["change","delete"],["update:modelValue"]),setup(e,{emit:f}){const l=ae(e,"modelValue"),o=p([]),u=Ae(),v=p(Object.assign({},...e.layouts.map(A=>A.Panels.map(F=>F.Items.map(V=>{if(!V.Meta)return{};const P={};return Object.entries(V.Meta).forEach(U=>{Array.isArray(U[1])?(P[`${V.LayoutItemUUID}.${U[0]}`]=[],U[1].forEach(w=>{P[`${V.LayoutItemUUID}.${U[0]}`].push(w.toString())})):U[1]!==void 0&&U[1]!==null&&(P[`${V.LayoutItemUUID}.${U[0]}`]=[U[1].toString()])}),P}))).flat(2))),m=p(`
Are you sure you wish to delete this layout? All panels relating to it will be
removed and can not be recovered. This action can not be undone once saved.
You will have to create a new layout.
`),a=p(!1),s=p([]);u.getConventionTags(e.convention.ConventionUUID).then(A=>{A&&(s.value=A)}).catch(()=>{});const d=()=>({ID:0,LayoutPanelUUID:Ee(),AdminLayoutID:l.value.ID,AdminLayoutUUID:l.value.AdminLayoutUUID,Name:"",Order:l.value.Panels.length+1,Items:[],PanelStyle:ye.PANEL_STYLE_FLEX,RequiredFormType:Te.FORM_TYPE_NIL,RequiredGroupMemberships:[],RequiredRegistrationTags:[],Meta:{}}),c=A=>()=>({ID:0,LayoutItemUUID:Ee(),LayoutPanelID:A.ID,LayoutPanelUUID:A.LayoutPanelUUID,Label:"",SourceType:Me.LAYOUT_ITEM_SOURCE_FORM,SectionFieldID:void 0,SectionFieldUUID:void 0,SectionField:void 0,MetaField:void 0,UserField:void 0,Align:"",Order:A.Items.length+1,DefaultSort:!1,Meta:{}}),g=(A,F)=>{A.Meta[F]=v.value[`${A.LayoutItemUUID}.${F}`]},r=A=>{const F=o.value.find(V=>V.value===A.SectionFieldUUID);F&&(A.SectionFieldID=F.object.ID,A.SectionField=F.object)};u.getConventionForms(l.value.ConventionUUID).then(A=>{A&&(A.forEach(F=>F.Sections.forEach(V=>V.Fields&&o.value.push(...V.Fields.map(P=>{var w;return{title:`${F.Name} - ${V.Name} - ${(w=P.Field)==null?void 0:w.Name}`,value:P.SectionFieldUUID,object:P}})))),o.value.sort(pl("title")),Ha(l.value.Panels,A))});const T=ne(()=>{switch(l.value.Type){case be.ADMIN_LAYOUT_PANELS:return"Panels";case be.ADMIN_LAYOUT_TABLE:return"Tabs"}return"Unknown"});return me(l,()=>{f("change")},{deep:!0}),(A,F)=>(i(),E(fe,{class:"px-0 mx-0",fluid:!0},{default:n(()=>[t(J,null,{default:n(()=>[t(M,{cols:"12",sm:"6"},{default:n(()=>[t(oe,{modelValue:l.value.Name,"onUpdate:modelValue":F[0]||(F[0]=V=>l.value.Name=V),label:"Name",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),t(M,{cols:"12",sm:"6"},{default:n(()=>[t(de,{modelValue:l.value.Type,"onUpdate:modelValue":F[1]||(F[1]=V=>l.value.Type=V),label:"Layout Type",items:y(sn),"item-title":"title","item-value":"value",variant:"outlined","hide-details":""},null,8,["modelValue","items"])]),_:1})]),_:1}),t(J,null,{default:n(()=>[t(M,null,{default:n(()=>[t(Lt,{modelValue:l.value.Panels,"onUpdate:modelValue":F[2]||(F[2]=V=>l.value.Panels=V),"new-item":d,closeable:!1,title:T.value,label:"Name","slot-name-prefix":"panel"},je({_:2},[W(l.value.Panels,(V,P)=>({name:`panel_${P}`,fn:n(()=>[t(fe,{class:"px-0 mx-0",fluid:!0},{default:n(()=>[t(J,null,{default:n(()=>[t(M,{cols:"12",sm:"6"},{default:n(()=>[t(oe,{modelValue:V.Name,"onUpdate:modelValue":U=>V.Name=U,label:"Name",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),l.value.Type===y(be).ADMIN_LAYOUT_PANELS?(i(),E(M,{key:0,cols:"12",sm:"6"},{default:n(()=>[t(de,{modelValue:V.PanelStyle,"onUpdate:modelValue":U=>V.PanelStyle=U,items:y(dn),clearable:!0,label:"Panel Style",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"])]),_:2},1024)):L("",!0),t(M,{cols:"12",sm:"6"},{default:n(()=>[t(de,{modelValue:V.RequiredFormType,"onUpdate:modelValue":U=>V.RequiredFormType=U,items:y(El),clearable:!0,label:"Required Form",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"])]),_:2},1024),t(M,{cols:"12",sm:"6"},{default:n(()=>[t(Ca,{label:"Required Groups",variant:"outlined",modelValue:V.RequiredGroupMemberships,"onUpdate:modelValue":U=>V.RequiredGroupMemberships=U,convention:l.value.ConventionUUID,chips:"",clearable:"",hint:"Groups that a user must be in to see this panel. (Any one)"},null,8,["modelValue","onUpdate:modelValue","convention"])]),_:2},1024),t(M,{cols:"12",sm:"6"},{default:n(()=>[t(ha,{label:"Registration Tags",variant:"outlined",modelValue:V.RequiredRegistrationTags,"onUpdate:modelValue":U=>V.RequiredRegistrationTags=U,convention:l.value.ConventionUUID,chips:"",clearable:"",hint:"Tags that a registration must have to appear in results. (Any one)"},null,8,["modelValue","onUpdate:modelValue","convention"])]),_:2},1024)]),_:2},1024),l.value.Type===y(be).ADMIN_LAYOUT_PANELS&&V.PanelStyle===y(ye).PANEL_STYLE_FLEX?(i(),E(J,{key:0},{default:n(()=>[t(M,{cols:"12",class:"py-0 my-0"},{default:n(()=>[hi]),_:1}),t(M,{cols:"6",sm:"4",lg:"2"},{default:n(()=>[t(oe,{modelValue:V.Meta.cols,"onUpdate:modelValue":U=>V.Meta.cols=U,modelModifiers:{number:!0},clearable:!0,"hide-details":"",label:"Default",type:"number",min:"1",max:"12"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),t(M,{cols:"6",sm:"4",lg:"2"},{default:n(()=>[t(oe,{modelValue:V.Meta.cols_xs,"onUpdate:modelValue":U=>V.Meta.cols_xs=U,modelModifiers:{number:!0},clearable:!0,"hide-details":"",label:"XS",type:"number",min:"1",max:"12"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),t(M,{cols:"6",sm:"4",lg:"2"},{default:n(()=>[t(oe,{modelValue:V.Meta.cols_sm,"onUpdate:modelValue":U=>V.Meta.cols_sm=U,modelModifiers:{number:!0},clearable:!0,"hide-details":"",label:"SM",type:"number",min:"1",max:"12"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),t(M,{cols:"6",sm:"4",lg:"2"},{default:n(()=>[t(oe,{modelValue:V.Meta.cols_md,"onUpdate:modelValue":U=>V.Meta.cols_md=U,modelModifiers:{number:!0},clearable:!0,"hide-details":"",label:"MD",type:"number",min:"1",max:"12"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),t(M,{cols:"6",sm:"4",lg:"2"},{default:n(()=>[t(oe,{modelValue:V.Meta.cols_lg,"onUpdate:modelValue":U=>V.Meta.cols_lg=U,modelModifiers:{number:!0},clearable:!0,"hide-details":"",label:"LG",type:"number",min:"1",max:"12"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),t(M,{cols:"6",sm:"4",lg:"2"},{default:n(()=>[t(oe,{modelValue:V.Meta.cols_xl,"onUpdate:modelValue":U=>V.Meta.cols_xl=U,modelModifiers:{number:!0},clearable:!0,"hide-details":"",label:"XL",type:"number",min:"1",max:"12"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)):L("",!0)]),_:2},1024),t(Lt,{modelValue:V.Items,"onUpdate:modelValue":U=>V.Items=U,"new-item":c(V),closeable:!1,title:"Items",label:"Label","slot-name-prefix":"item"},je({_:2},[W(V.Items,(U,w)=>({name:`item_${w}`,fn:n(()=>[t(fe,{class:"px-0 mx-0",fluid:!0},{default:n(()=>{var Z,Y;return[t(J,null,{default:n(()=>[t(M,{cols:"12",sm:"6"},{default:n(()=>[t(oe,{modelValue:U.Label,"onUpdate:modelValue":G=>U.Label=G,label:"Name",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024),t(J,null,{default:n(()=>[t(M,{cols:"12",sm:"6"},{default:n(()=>[t(de,{modelValue:U.SourceType,"onUpdate:modelValue":G=>U.SourceType=G,label:"Source Type",items:y(un),"item-title":"title","item-value":"value",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"])]),_:2},1024),t(M,{cols:"12",sm:"6"},{default:n(()=>[U.SourceType==="LAYOUT_ITEM_SOURCE_FORM"?(i(),E(de,{key:0,modelValue:U.SectionFieldUUID,"onUpdate:modelValue":G=>U.SectionFieldUUID=G,label:"Form Data",items:o.value,"item-title":"title","item-value":"value",variant:"outlined","hide-details":"",onBlur:G=>r(U)},null,8,["modelValue","onUpdate:modelValue","items","onBlur"])):U.SourceType==="LAYOUT_ITEM_SOURCE_META"?(i(),E(de,{key:1,modelValue:U.MetaField,"onUpdate:modelValue":G=>U.MetaField=G,label:"Miscellaneous Data",items:y(rn),"item-title":"title","item-value":"value",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"])):U.SourceType==="LAYOUT_ITEM_SOURCE_USER"?(i(),E(de,{key:2,modelValue:U.UserField,"onUpdate:modelValue":G=>U.UserField=G,label:"User Profile Data",items:y(mn),"item-title":"title","item-value":"value",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"])):L("",!0)]),_:2},1024)]),_:2},1024),A.layouts&&U.SourceType==="LAYOUT_ITEM_SOURCE_FORM"&&((Y=(Z=U.SectionField)==null?void 0:Z.Field)==null?void 0:Y.Type)===y(_a).TEXT?(i(),E(J,{key:0},{default:n(()=>[t(M,{cols:"12",xs:"6",sm:"6",lg:"3"},{default:n(()=>[t(kt,{modelValue:U.Meta.DirectEdit,"onUpdate:modelValue":G=>U.Meta.DirectEdit=G,label:"Direct Edit","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),t(M,{cols:"12",xs:"6",sm:"6",lg:"3"},{default:n(()=>[t(de,{modelValue:U.Meta.DirectEditPermission,"onUpdate:modelValue":G=>U.Meta.DirectEditPermission=G,label:"Minimum Permission Required",items:["View","Edit"],"hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)):L("",!0),A.layouts&&U.SourceType==="LAYOUT_ITEM_SOURCE_META"&&U.MetaField===y(H).META_DATA_SOURCE_DATA_LAYOUT?(i(),E(J,{key:1},{default:n(()=>[t(M,{cols:"6",sm:"4",lg:"2"},{default:n(()=>[t(de,{modelValue:v.value[`${U.LayoutItemUUID}.LayoutUUID`],"onUpdate:modelValue":[G=>v.value[`${U.LayoutItemUUID}.LayoutUUID`]=G,G=>g(U,"LayoutUUID")],clearable:!0,items:A.layouts.filter(G=>G.Type===y(be).ADMIN_LAYOUT_PANELS)||[],multiple:!0,label:"Data Display","item-title":"Name","item-value":"AdminLayoutUUID",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"])]),_:2},1024)]),_:2},1024)):L("",!0),A.layouts&&U.SourceType==="LAYOUT_ITEM_SOURCE_META"&&U.MetaField===y(H).META_DATA_SOURCE_TAGS?(i(),E(J,{key:2},{default:n(()=>[t(M,{cols:"6",sm:"4",lg:"2"},{default:n(()=>[t(de,{modelValue:v.value[`${U.LayoutItemUUID}.Tags`],"onUpdate:modelValue":[G=>v.value[`${U.LayoutItemUUID}.Tags`]=G,G=>g(U,"Tags")],clearable:!0,items:s.value||[],multiple:!0,label:"Tags to Display","item-title":"Title","item-value":"TagUUID",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"]),!v.value[U.LayoutItemUUID]||v.value[U.LayoutItemUUID].length===0?(i(),_("small",bi," Will show all tags ")):L("",!0)]),_:2},1024)]),_:2},1024)):L("",!0),l.value.Type===y(be).ADMIN_LAYOUT_TABLE&&(U.SourceType!==y(Me).LAYOUT_ITEM_SOURCE_META||U.MetaField!==y(H).META_DATA_SOURCE_DATA_LAYOUT)?(i(),E(J,{key:3},{default:n(()=>[t(M,null,{default:n(()=>[t(kt,{modelValue:U.DefaultSort,"onUpdate:modelValue":G=>U.DefaultSort=G,label:"Default Sort","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)):L("",!0)]}),_:2},1024)])}))]),1032,["modelValue","onUpdate:modelValue","new-item"])])}))]),1032,["modelValue","title"])]),_:1})]),_:1}),t(J,null,{default:n(()=>[t(M,null,{default:n(()=>[t(j,{onClick:F[3]||(F[3]=V=>a.value=!0),"prepend-icon":"mdi:mdi-delete",color:"red-darken-4"},{default:n(()=>[C("Delete Layout")]),_:1})]),_:1})]),_:1}),a.value?(i(),E(ka,{key:0,modelValue:a.value,"onUpdate:modelValue":F[4]||(F[4]=V=>a.value=V),message:m.value,title:"Delete Layout",subtitle:"Removes this layout and all it's panels",onDelete:F[5]||(F[5]=V=>f("delete"))},null,8,["modelValue","message"])):L("",!0)]),_:1}))}}),Mi=Q({__name:"EditAdminLayouts",props:X({title:{},convention:{}},{modelValue:{type:Boolean,required:!0}}),emits:X(["save"],["update:modelValue"]),setup(e,{emit:f}){const l=ae(e,"modelValue"),o=p([]),u=p([]),v=p([]),m=Ae(),a=()=>({ID:0,AdminLayoutUUID:Ee(),ConventionID:e.convention.ID,ConventionUUID:e.convention.ConventionUUID,Name:"New Layout",Type:be.ADMIN_LAYOUT_PANELS,Panels:[]}),s=()=>{let c=!1;[...new Set(v.value)].forEach(r=>{const T=o.value.findIndex(A=>A.AdminLayoutUUID===r);T<0||T>=o.value.length||(m.saveAdminLayout(o.value[T]).then(A=>{A&&o.value.splice(T,1,A)}).catch(()=>{}),c=!0)}),u.value.forEach(r=>{m.deleteAdminLayout(r).catch(()=>{})}),u.value=[],v.value=[],c&&f("save")},d=c=>{const g=o.value.findIndex(r=>r.AdminLayoutUUID===c.AdminLayoutUUID);g<0||g>=o.value.length||(o.value[g].ID>0&&u.value.push(c.AdminLayoutUUID),o.value.splice(g,1))};return m.getConventionAdminLayouts(e.convention.ConventionUUID).then(c=>{c&&(o.value=c)}).catch(()=>[]),(c,g)=>(i(),E(Ut,{modelValue:l.value,"onUpdate:modelValue":g[2]||(g[2]=r=>l.value=r),scrollable:!0,"retain-focus":!0,persistent:!0,fullscreen:!0},{default:n(()=>[t(Lt,{modelValue:o.value,"onUpdate:modelValue":g[0]||(g[0]=r=>o.value=r),"new-item":a,closeable:!0,"show-delete":!1,"show-save":!0,"has-order":!1,title:c.title,label:"Name","slot-name-prefix":"panel",onClose:g[1]||(g[1]=r=>l.value=!1),onSave:s},je({_:2},[W(o.value,(r,T)=>({name:`panel_${T}`,fn:n(()=>[t(fe,{class:"px-0 mx-0",fluid:!0},{default:n(()=>[t(J,null,{default:n(()=>[t(M,{cols:"12"},{default:n(()=>[t(ki,{modelValue:o.value[T],"onUpdate:modelValue":A=>o.value[T]=A,convention:c.convention,layouts:o.value,onChange:A=>v.value.push(r.AdminLayoutUUID),onDelete:A=>d(r)},null,8,["modelValue","onUpdate:modelValue","convention","layouts","onChange","onDelete"])]),_:2},1024)]),_:2},1024)]),_:2},1024)])}))]),1032,["modelValue","title"])]),_:1},8,["modelValue"]))}});function Ni(){const e=p([]);rl(()=>e.value=[]);function f(l,o){e.value[o]=l}return{refs:e,updateRef:f}}const Li=Ua({activeColor:String,start:{type:[Number,String],default:1},modelValue:{type:Number,default:e=>e.start},disabled:Boolean,length:{type:[Number,String],default:1,validator:e=>e%1===0},totalVisible:[Number,String],firstIcon:{type:vt,default:"$first"},prevIcon:{type:vt,default:"$prev"},nextIcon:{type:vt,default:"$next"},lastIcon:{type:vt,default:"$last"},ariaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.root"},pageAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.page"},currentPageAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.currentPage"},firstAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.first"},previousAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.previous"},nextAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.next"},lastAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.last"},ellipsis:{type:String,default:"..."},showFirstLastPage:Boolean,...Sl(),...Rl(),...Cl(),...Vl(),...Ol(),...hl(),...bl({tag:"nav"}),...dl(),...kl({variant:"text"})},"VPagination"),Pi=Aa()({name:"VPagination",props:Li(),emits:{"update:modelValue":e=>!0,first:e=>!0,prev:e=>!0,next:e=>!0,last:e=>!0},setup(e,f){let{slots:l,emit:o}=f;const u=ml(e,"modelValue"),{t:v,n:m}=cl(),{isRtl:a}=vl(),{themeClasses:s}=fl(e),{width:d}=ga(),c=Ul(-1);ht(void 0,{scoped:!0});const{resizeRef:g}=Ml(O=>{if(!O.length)return;const{target:b,contentRect:h}=O[0],R=b.querySelector(".v-pagination__list > *");if(!R)return;const x=h.width,se=R.offsetWidth+parseFloat(getComputedStyle(R).marginRight)*2;c.value=F(x,se)}),r=ne(()=>parseInt(e.length,10)),T=ne(()=>parseInt(e.start,10)),A=ne(()=>e.totalVisible?parseInt(e.totalVisible,10):c.value>=0?c.value:F(d.value,58));function F(O,b){const h=e.showFirstLastPage?5:3;return Math.max(0,Math.floor(+((O-b*h)/b).toFixed(2)))}const V=ne(()=>{if(r.value<=0||isNaN(r.value)||r.value>Number.MAX_SAFE_INTEGER)return[];if(A.value<=1)return[u.value];if(r.value<=A.value)return ft(r.value,T.value);const O=A.value%2===0,b=O?A.value/2:Math.floor(A.value/2),h=O?b:b+1,R=r.value-b;if(h-u.value>=0)return[...ft(Math.max(1,A.value-1),T.value),e.ellipsis,r.value];if(u.value-R>=(O?1:0)){const x=A.value-1,se=r.value-x+T.value;return[T.value,e.ellipsis,...ft(x,se)]}else{const x=Math.max(1,A.value-3),se=x===1?u.value:u.value-Math.ceil(x/2)+T.value;return[T.value,e.ellipsis,...ft(x,se),e.ellipsis,r.value]}});function P(O,b,h){O.preventDefault(),u.value=b,h&&o(h,b)}const{refs:U,updateRef:w}=Ni();ht({VPaginationBtn:{color:pe(e,"color"),border:pe(e,"border"),density:pe(e,"density"),size:pe(e,"size"),variant:pe(e,"variant"),rounded:pe(e,"rounded"),elevation:pe(e,"elevation")}});const Z=ne(()=>V.value.map((O,b)=>{const h=R=>w(R,b);if(typeof O=="string")return{isActive:!1,key:`ellipsis-${b}`,page:O,props:{ref:h,ellipsis:!0,icon:!0,disabled:!0}};{const R=O===u.value;return{isActive:R,key:O,page:m(O),props:{ref:h,ellipsis:!1,icon:!0,disabled:!!e.disabled||+e.length<2,color:R?e.activeColor:e.color,ariaCurrent:R,ariaLabel:v(R?e.currentPageAriaLabel:e.pageAriaLabel,O),onClick:x=>P(x,O)}}}})),Y=ne(()=>{const O=!!e.disabled||u.value<=T.value,b=!!e.disabled||u.value>=T.value+r.value-1;return{first:e.showFirstLastPage?{icon:a.value?e.lastIcon:e.firstIcon,onClick:h=>P(h,T.value,"first"),disabled:O,ariaLabel:v(e.firstAriaLabel),ariaDisabled:O}:void 0,prev:{icon:a.value?e.nextIcon:e.prevIcon,onClick:h=>P(h,u.value-1,"prev"),disabled:O,ariaLabel:v(e.previousAriaLabel),ariaDisabled:O},next:{icon:a.value?e.prevIcon:e.nextIcon,onClick:h=>P(h,u.value+1,"next"),disabled:b,ariaLabel:v(e.nextAriaLabel),ariaDisabled:b},last:e.showFirstLastPage?{icon:a.value?e.firstIcon:e.lastIcon,onClick:h=>P(h,T.value+r.value-1,"last"),disabled:b,ariaLabel:v(e.lastAriaLabel),ariaDisabled:b}:void 0}});function G(){var b;const O=u.value-T.value;(b=U.value[O])==null||b.$el.focus()}function te(O){O.key===ta.left&&!e.disabled&&u.value>+e.start?(u.value=u.value-1,et(G)):O.key===ta.right&&!e.disabled&&u.value<T.value+r.value-1&&(u.value=u.value+1,et(G))}return Ea(()=>t(e.tag,{ref:g,class:["v-pagination",s.value,e.class],style:e.style,role:"navigation","aria-label":v(e.ariaLabel),onKeydown:te,"data-test":"v-pagination-root"},{default:()=>[t("ul",{class:"v-pagination__list"},[e.showFirstLastPage&&t("li",{key:"first",class:"v-pagination__first","data-test":"v-pagination-first"},[l.first?l.first(Y.value.first):t(j,ke({_as:"VPaginationBtn"},Y.value.first),null)]),t("li",{key:"prev",class:"v-pagination__prev","data-test":"v-pagination-prev"},[l.prev?l.prev(Y.value.prev):t(j,ke({_as:"VPaginationBtn"},Y.value.prev),null)]),Z.value.map((O,b)=>t("li",{key:O.key,class:["v-pagination__item",{"v-pagination__item--is-active":O.isActive}],"data-test":"v-pagination-item"},[l.item?l.item(O):t(j,ke({_as:"VPaginationBtn"},O.props),{default:()=>[O.page]})])),t("li",{key:"next",class:"v-pagination__next","data-test":"v-pagination-next"},[l.next?l.next(Y.value.next):t(j,ke({_as:"VPaginationBtn"},Y.value.next),null)]),e.showFirstLastPage&&t("li",{key:"last",class:"v-pagination__last","data-test":"v-pagination-last"},[l.last?l.last(Y.value.last):t(j,ke({_as:"VPaginationBtn"},Y.value.last),null)])])]})),{}}}),wi=["colspan"],Fi={style:{opacity:"var(--v-medium-emphasis-opacity)"}},Rs=Q({__name:"RegistrationsView",emits:["pageTitle"],setup(e,{emit:f}){var Wt;const l=At();f("pageTitle","Registration Manager");const o=Al(),u=gl(),v=p(!0);let m=((Wt=o.params.convention)==null?void 0:Wt.toString())||"";const a=p({ID:0,ConventionUUID:Ee(),OrganisationID:0,OrganisationUUID:Vt,Name:"New Convention",Description:"",DetailLink:"",Logo:"",Slug:"",Accommodation:[],Tickets:[],Extras:[],Interests:[],Visible:!1}),s=Ae(),d=Tl.getInstance(),c=p([]),g=p({ID:0,AdminLayoutUUID:Ee(),ConventionID:a.value.ID,ConventionUUID:a.value.ConventionUUID,Name:"Registration Table",Type:be.ADMIN_LAYOUT_TABLE,Panels:[]}),r=p([]),T=p([]),A=p([]),F=p([]),V=p([]),P=p([]),U=p(1),w=p(10),Z=p([]),Y=p(0),G=p(!1),te=p(""),O=p(""),b=p(""),h=p(""),R=p({FieldUUID:"591c9bca-c78c-4e97-8aef-bc596ef472fb",Value:""}),x=p({FieldUUID:"50189b21-6c55-4c99-a38f-7740a01ec4a4",Value:""}),se=p({FieldUUID:"1523ef15-f2c3-46b9-a687-dcd7bc2c0a50",Value:""}),Ue=p({FieldUUID:"926d43c6-a743-4ab7-bef2-060d762d37a9",Value:""}),ce=p(new Map([["591c9bca-c78c-4e97-8aef-bc596ef472fb",R.value],["50189b21-6c55-4c99-a38f-7740a01ec4a4",x.value],["1523ef15-f2c3-46b9-a687-dcd7bc2c0a50",se.value],["926d43c6-a743-4ab7-bef2-060d762d37a9",Ue.value]])),Ke=p(""),Xe=p(""),nt=p([]),We=p([]),Ie=p([]),we=p([]),Fe=p([]),$e=p([]),Ve=p(0),De=p(),Be=p(!1),Qt=p(!1),qa=p(!1),mt=p(),Kt=p(),Et=p(),Je=p(!1),ja=at(),ve=Oi(()=>{O.value=Date.now().toString()});me(te,S=>{const D=P.value.find($=>$.uuid===S);if(D){const $=D.headers.find(N=>N.defaultSort===!0);$&&(Z.value=[{key:$.key,order:"asc"}],nt.value=[{key:$.key,order:"asc"}])}}),me(Ve,S=>{S===8&&Xt()}),me(Ke,()=>{ve()}),me(Xe,()=>{ve()});const za=()=>{r.value=[],A.value=[],F.value=[],P.value=[];try{s.getConventionAdminLayoutByName(a.value.ConventionUUID,"Registration Table").then(S=>{Ve.value+=1,S?g.value=S:(g.value.ConventionID=a.value.ID,g.value.ConventionUUID=a.value.ConventionUUID)})}catch{g.value.ConventionID=a.value.ID,g.value.ConventionUUID=a.value.ConventionUUID}try{s.getConventionAdminLayouts(a.value.ConventionUUID).then(S=>{Ve.value+=1,S&&(A.value=S)})}catch{}try{s.getConventionForms(a.value.ConventionUUID).then(S=>{Ve.value+=1,S&&(r.value=S)})}catch{}try{s.getConventionAccommodation(a.value.ConventionUUID).then(S=>{Ve.value+=1,S&&(We.value=S)})}catch{}try{s.getConventionVenues(a.value.ConventionUUID).then(S=>{Ve.value+=1,S&&($e.value=S)})}catch{}try{s.getConventionExtras(a.value.ConventionUUID).then(S=>{Ve.value+=1,S&&(Ie.value=S)})}catch{}try{s.getConventionInterests(a.value.ConventionUUID).then(S=>{Ve.value+=1,S&&(we.value=S)})}catch{}try{s.getConventionTickets(a.value.ConventionUUID).then(S=>{Ve.value+=1,S&&(Fe.value=S)})}catch{}try{s.getConventionGroups(a.value.ConventionUUID).then(S=>{S&&(T.value=S.sort((D,$)=>D.Name.localeCompare($.Name)))})}catch{}try{s.getConventionTags(a.value.ConventionUUID).then(S=>{S&&(V.value=S.sort((D,$)=>D.Title.localeCompare($.Title)).map(D=>(D.Title=`${D.Title} [${D.Key}]`,D)))})}catch{}},Dt=({page:S,itemsPerPage:D,sortBy:$})=>{v.value=!0,U.value=S,Z.value=$;const N=P.value.find(re=>re.uuid==te.value),ge=N==null?void 0:N.layout.Items;let ue="",ot="";if($&&ge&&$.length>=1){const re=ge.find(St=>St.LayoutItemUUID==$[0].key);switch(ot=$[0].order||"asc",re==null?void 0:re.MetaField){case H.META_DATA_SOURCE_ACCOMMODATION_FORM:ue="submission.status";break;case H.META_DATA_SOURCE_BADGE_FORM:ue="submission.status";break;case H.META_DATA_SOURCE_DEALER_FORM:ue="submission.status";break;case H.META_DATA_SOURCE_REGISTRATION_FORM:ue="submission.status";break;case H.META_DATA_SOURCE_REGISTRATION_REFERENCE:ue="reference";break;case H.META_DATA_SOURCE_SUBMISSION_DATE:ue="created";break;case H.META_DATA_SOURCE_SUBMISSION_STATUS:ue="submission.status";break}switch(re==null?void 0:re.UserField){case ie.USER_DATA_SOURCE_DISPLAY_NAME:ue="user.display_name";break;case ie.USER_DATA_SOURCE_EMAIL:ue="user.email";break;case ie.USER_DATA_SOURCE_FIRST_NAME:ue="user.firstname";break;case ie.USER_DATA_SOURCE_HANDLE:ue="user.handle";break;case ie.USER_DATA_SOURCE_LAST_NAME:ue="user.lastname";break}}try{const re={Direction:ot,Limit:D,Offset:(S-1)*D,Order:ue};N&&N.layout.RequiredRegistrationTags.length>0&&(re.PanelUUID=N==null?void 0:N.layout.LayoutPanelUUID),(N==null?void 0:N.layout.RequiredFormType)===Te.FORM_TYPE_ACCOMMODATION&&(re.Accommodation=!0),(N==null?void 0:N.layout.RequiredFormType)===Te.FORM_TYPE_BADGE&&(re.Badge=!0),(N==null?void 0:N.layout.RequiredFormType)===Te.FORM_TYPE_DEALER&&(re.Dealer=!0),(N==null?void 0:N.layout.RequiredFormType)===Te.FORM_TYPE_REGISTRATION&&(re.Registration=!0),re.GroupUUID=Ke.value||Vt,re.TagUUID=Xe.value||Vt,re.Email=h.value,re.Reference=b.value,re.FieldValues=Array.from(ce.value.values());const St=O.value;s.searchConventionRegistrations(a.value.ConventionUUID,re).then(Rt=>{Rt&&St===O.value&&(Y.value=Rt.Total,F.value=Rt.Registrations,P.value.forEach(Ct=>{const al=Ct.layout;Ct.items=F.value.map(K=>{const ct=[];let Oe;K.Leader?Oe=K:Oe=K.Primary,ct.push({Name:Oe.User.DisplayName,UUID:Oe.UserUUID,UserUUID:Oe.User.UserUUID,IsLeader:!0,Reference:Oe.Reference,Paid:Oe.Paid,Total:Oe.Total}),ct.push(...Oe.Members.map(he=>({Name:he.User.DisplayName,UUID:he.UserUUID,UserUUID:he.User.UserUUID,IsLeader:!1,Reference:he.Reference,Paid:he.Paid,Total:he.Total})));const le={};return Ct.headers.forEach(he=>{var Jt;const z=al.Items.find(it=>it.LayoutItemUUID===he.key);if(z){if(z.SourceType==="LAYOUT_ITEM_SOURCE_FORM"&&z.SectionField)K.Submissions.forEach(it=>{const Ze=it.Data.find(q=>q.SectionFieldUUID===z.SectionFieldUUID);if(Ze){he.type===_a.ACCOMMODATION?le[z.LayoutItemUUID]={Data:Ze.Data,Registration:K}:le[z.LayoutItemUUID]=Ze.Data;return}});else if(z.SourceType==="LAYOUT_ITEM_SOURCE_USER"&&z.UserField)switch(z.UserField){case ie.USER_DATA_SOURCE_AVATAR:le[z.LayoutItemUUID]=l.GetProfileImageURL(K.UserUUID);break;case ie.USER_DATA_SOURCE_DISPLAY_NAME:le[z.LayoutItemUUID]=K.User.DisplayName;break;case ie.USER_DATA_SOURCE_EMAIL:le[z.LayoutItemUUID]=K.User.Additional.Email;break;case ie.USER_DATA_SOURCE_HANDLE:le[z.LayoutItemUUID]=K.User.Handle;break;case ie.USER_DATA_SOURCE_DATE_OF_BIRTH:le[z.LayoutItemUUID]=K.User.Additional.DOB;break;case ie.USER_DATA_SOURCE_FIRST_NAME:le[z.LayoutItemUUID]=K.User.Additional.FirstName;break;case ie.USER_DATA_SOURCE_LAST_NAME:le[z.LayoutItemUUID]=K.User.Additional.LastName;break;case ie.USER_DATA_SOURCE_TELEGRAM:le[z.LayoutItemUUID]="";break}else if(z.SourceType==="LAYOUT_ITEM_SOURCE_META"&&z.MetaField){const it=(Jt=r.value.find(q=>q.Type===Te.FORM_TYPE_REGISTRATION))==null?void 0:Jt.FormUUID,Ze=K.Submissions.find(q=>q.FormUUID===it);switch(z.MetaField){case H.META_DATA_SOURCE_REGISTRATION_ACTIONS:le[z.LayoutItemUUID]=K;break;case H.META_DATA_SOURCE_REGISTRATION_GROUP:le[z.LayoutItemUUID]=ct;break;case H.META_DATA_SOURCE_REGISTRATION_REFERENCE:le[z.LayoutItemUUID]=K.Reference;break;case H.META_DATA_SOURCE_SUBMISSION_DATE:if(Ze){const q=new Date(Ze.CreatedAt||"");le[z.LayoutItemUUID]=`${q.getFullYear()}-${(q.getMonth()+1).toString().padStart(2,"0")}-${q.getDate().toString().padStart(2,"0")} ${q.getHours().toString().padStart(2,"0")}:${q.getMinutes().toString().padStart(2,"0")}:${q.getSeconds().toString().padStart(2,"0")}`}else{const q=new Date(K.CreatedAt||"");le[z.LayoutItemUUID]=`${q.getFullYear()}-${(q.getMonth()+1).toString().padStart(2,"0")}-${q.getDate().toString().padStart(2,"0")} ${q.getHours().toString().padStart(2,"0")}:${q.getMinutes().toString().padStart(2,"0")}:${q.getSeconds().toString().padStart(2,"0")}`}break;case H.META_DATA_SOURCE_ACCOMMODATION_FORM:le[z.LayoutItemUUID]=K.Submissions.map(q=>{const ee=r.value.find(Ye=>Ye.FormUUID===q.FormUUID);return{Heading:ee==null?void 0:ee.Heading,Form:ee,Submission:q,Registration:K}}).filter(q=>{var ee;return((ee=q.Form)==null?void 0:ee.Type)===Te.FORM_TYPE_ACCOMMODATION});break;case H.META_DATA_SOURCE_BADGE_FORM:le[z.LayoutItemUUID]=K.Submissions.map(q=>{const ee=r.value.find(Ye=>Ye.FormUUID===q.FormUUID);return{Heading:ee==null?void 0:ee.Heading,Form:ee,Submission:q,Registration:K}}).filter(q=>{var ee;return((ee=q.Form)==null?void 0:ee.Type)===Te.FORM_TYPE_BADGE});break;case H.META_DATA_SOURCE_DEALER_FORM:le[z.LayoutItemUUID]=K.Submissions.map(q=>{const ee=r.value.find(Ye=>Ye.FormUUID===q.FormUUID);return{Heading:ee==null?void 0:ee.Heading,Form:ee,Submission:q,Registration:K}}).filter(q=>{var ee;return((ee=q.Form)==null?void 0:ee.Type)===Te.FORM_TYPE_DEALER});break;case H.META_DATA_SOURCE_PAYMENT_STATUS:if(K.Paid===0&&K.Total)le[z.LayoutItemUUID]="REQUIRED";else if(K.Total>K.Paid)le[z.LayoutItemUUID]="ADDITIONAL_REQUIRED";else{const q=ct.find(ee=>ee.Paid===0&&(ee.Total||0)>0);if(q){K.Total===0&&q.Total===0?le[z.LayoutItemUUID]="NOT_REQUIRED":K.Total===0&&q.Total||K.Total>0&&q.Total===0?le[z.LayoutItemUUID]="MISSING_REQUIRED":K.Paid>=K.Total?le[z.LayoutItemUUID]="AWAITING_PARTNER":le[z.LayoutItemUUID]="ALL_REQUIRED";break}else K.Total===0?le[z.LayoutItemUUID]="NOT_REQUIRED":le[z.LayoutItemUUID]="COMPLETE"}break;case H.META_DATA_SOURCE_SUBMISSION_STATUS:en(K.Submissions,r.value),le[z.LayoutItemUUID]=K.Submissions.map(q=>{const ee=r.value.find(Ye=>Ye.FormUUID===q.FormUUID);return{Heading:ee==null?void 0:ee.Heading,Form:ee,Submission:q,Registration:K}});break;case H.META_DATA_SOURCE_DATA_LAYOUT:le[z.LayoutItemUUID]={Registration:K,Layouts:A.value.filter(q=>{if(z.Meta&&z.Meta.LayoutUUID&&Array.isArray(z.Meta.LayoutUUID))return z.Meta.LayoutUUID.includes(q.AdminLayoutUUID)})};break}}}}),{key:K.RegistrationUUID,registration:K,...le}})}),v.value=!1)})}catch{}},Qa=S=>{G.value=!1,S&&(g.value=S,Xt())},Xt=()=>{Ha(g.value.Panels,r.value),g.value.Panels.length>0&&(P.value=[],g.value.Panels.forEach(S=>{const D={uuid:Ee(),order:S.Order,name:S.Name,headers:[],items:[],layout:S};S.Items.sort(($,N)=>$.Order>N.Order?1:$.Order==N.Order?0:-1),D.headers=S.Items.map($=>{var N,ge;return{key:$.LayoutItemUUID,title:$.Label||((ge=(N=$.SectionField)==null?void 0:N.Field)==null?void 0:ge.Label)||"",align:$.Align==="end"?"end":"start",sortable:Xa($),type:Ka($),defaultSort:$.DefaultSort,meta:$.Meta}}),P.value.push(D)}),P.value=P.value.sort((S,D)=>S.order>D.order?1:S.order==D.order?0:-1)),(te.value==null||te.value=="")&&P.value.length>0&&(te.value=P.value[0].uuid)};m?s.getConvention(m).then(S=>{S&&(a.value=S,g.value.ConventionID=a.value.ID,g.value.ConventionUUID=a.value.ConventionUUID,za())}).catch(()=>{u.push("/")}):u.push("/");const Ka=S=>{var D,$;if(S.SourceType===Me.LAYOUT_ITEM_SOURCE_META)return`${S.SourceType}.${S.MetaField}`;if(S.SourceType===Me.LAYOUT_ITEM_SOURCE_FORM)return($=(D=S.SectionField)==null?void 0:D.Field)==null?void 0:$.Type;if(S.SourceType===Me.LAYOUT_ITEM_SOURCE_USER)return`${S.SourceType}.${S.UserField}`},Xa=S=>{const D=[H.META_DATA_SOURCE_ACCOMMODATION_FORM,H.META_DATA_SOURCE_BADGE_FORM,H.META_DATA_SOURCE_DEALER_FORM,H.META_DATA_SOURCE_REGISTRATION_FORM,H.META_DATA_SOURCE_REGISTRATION_REFERENCE,H.META_DATA_SOURCE_SUBMISSION_DATE,H.META_DATA_SOURCE_SUBMISSION_STATUS],$=[ie.USER_DATA_SOURCE_DISPLAY_NAME,ie.USER_DATA_SOURCE_EMAIL,ie.USER_DATA_SOURCE_HANDLE,ie.USER_DATA_SOURCE_DATE_OF_BIRTH,ie.USER_DATA_SOURCE_FIRST_NAME,ie.USER_DATA_SOURCE_LAST_NAME];return D.includes(S.MetaField)||$.includes(S.UserField)},Wa=S=>{De.value=S,Be.value=!0},Ja=S=>{De.value=S,Qt.value=!0},Za=S=>{De.value=S,qa.value=!0};me(Be,S=>{S||(De.value=void 0)}),me(Qt,S=>{S||(De.value=void 0)});const It=async(S="")=>{Kt.value=await s.getRegistrationGroup(S)},el=({registration:S,form:D,submission:$})=>{De.value=S,It(S.RegistrationUUID).then(()=>{mt.value=D,Et.value=$,Je.value=!0})},tl=S=>{s.switchUser(S.UserUUID).then(D=>{D&&ln(D.tokens,D.user,u,!1)}).catch(D=>{console.error(D)})};return d.on("registration.group.leave",S=>{s.leaveRegistrationGroup(S).then(D=>{D&&It(S).then(()=>{d.emit("registration.group.left",D)})})}),d.on("registration.group.remove.member",S=>{s.leaveRegistrationGroup(S).then(D=>{D&&It(S).then(()=>{d.emit("registration.group.left",D)})})}),(S,D)=>(i(),E(on,null,{default:n(()=>[t(Pt,{color:"blue-darken-4"},{default:n(()=>[t(Va,{modelValue:te.value,"onUpdate:modelValue":D[0]||(D[0]=$=>te.value=$),"show-arrows":""},{default:n(()=>[(i(!0),_(k,null,W(P.value,$=>(i(),E(Oa,{key:$.uuid,value:$.uuid},{default:n(()=>[C(I($.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"]),t(Le),t(j,{icon:"mdi:mdi-cog-outline",onClick:D[1]||(D[1]=$=>G.value=!0)})]),_:1}),t(ba,{modelValue:te.value,"onUpdate:modelValue":D[23]||(D[23]=$=>te.value=$),disabled:!0,touch:!1},{default:n(()=>[(i(!0),_(k,null,W(P.value,$=>(i(),E(xe,{key:$.uuid,value:$.uuid},{default:n(()=>[$.uuid===te.value?(i(),E(Pe,{key:0,class:"pa-2"},{default:n(()=>[t(y(Un),{expanded:c.value,"onUpdate:expanded":D[19]||(D[19]=N=>c.value=N),page:U.value,"onUpdate:page":D[20]||(D[20]=N=>U.value=N),"items-per-page":w.value,"onUpdate:itemsPerPage":D[21]||(D[21]=N=>w.value=N),"sort-by":nt.value,"onUpdate:sortBy":D[22]||(D[22]=N=>nt.value=N),headers:$.headers,"items-length":Y.value,items:$.items,"item-value":"key",loading:v.value,search:O.value,"onUpdate:options":Dt,"show-expand":""},je({top:n(()=>[t(pt,{class:"mb-3"},{default:n(()=>[t(_t,null,{default:n(()=>[t(gt,{color:"secondary",class:"font-weight-bold pb-0 pt-0"},{default:n(()=>[t(M,{class:"pa-0"},{default:n(()=>[C(" Search Criteria "),t(Ce,{class:"pl-5",icon:"mdi:mdi-credit-card-search-outline"})]),_:1}),t(M,{class:"d-none d-sm-block pa-0",cols:"0"},{default:n(()=>[t(oe,{modelValue:b.value,"onUpdate:modelValue":D[2]||(D[2]=N=>b.value=N),label:"Badge No.",clearable:!0,"hide-details":"",variant:"plain",onClick:D[3]||(D[3]=bt(()=>{},["stop"])),"onClick:clear":y(ve),onInput:y(ve)},null,8,["modelValue","onClick:clear","onInput"])]),_:1}),t(M,{class:"d-none d-md-block pa-0"},{default:n(()=>[t(oe,{modelValue:R.value.Value,"onUpdate:modelValue":D[4]||(D[4]=N=>R.value.Value=N),label:"Furry Name",clearable:!0,"hide-details":"",variant:"plain",onClick:D[5]||(D[5]=bt(()=>{},["stop"])),"onClick:clear":y(ve),onInput:y(ve)},null,8,["modelValue","onClick:clear","onInput"])]),_:1})]),_:1}),t(Tt,{class:"pt-2"},{default:n(()=>[t(J,null,{default:n(()=>[t(M,{cols:"12",sm:"6",md:"3",lg:"2",xl:"1"},{default:n(()=>[t(oe,{modelValue:b.value,"onUpdate:modelValue":D[6]||(D[6]=N=>b.value=N),label:"Badge No.",clearable:!0,"hide-details":"",variant:"outlined","onClick:clear":y(ve),onInput:y(ve)},null,8,["modelValue","onClick:clear","onInput"])]),_:1}),t(M,{cols:"12",sm:"6",md:"4",lg:"5",xl:"2"},{default:n(()=>[t(oe,{modelValue:R.value.Value,"onUpdate:modelValue":D[7]||(D[7]=N=>R.value.Value=N),label:"Furry Name",clearable:!0,"hide-details":"",variant:"outlined","onClick:clear":y(ve),onInput:y(ve)},null,8,["modelValue","onClick:clear","onInput"])]),_:1}),t(M,{cols:"12",sm:"12",md:"5",lg:"5",xl:"3"},{default:n(()=>[t(oe,{modelValue:h.value,"onUpdate:modelValue":D[8]||(D[8]=N=>h.value=N),label:"E-mail",clearable:!0,"hide-details":"",variant:"outlined","onClick:clear":y(ve),onInput:y(ve)},null,8,["modelValue","onClick:clear","onInput"])]),_:1}),t(M,{cols:"12",sm:"6",md:"4",lg:"4",xl:"2"},{default:n(()=>[t(oe,{modelValue:x.value.Value,"onUpdate:modelValue":D[9]||(D[9]=N=>x.value.Value=N),label:"Legal Forename",clearable:!0,"hide-details":"",variant:"outlined","onClick:clear":y(ve),onInput:y(ve)},null,8,["modelValue","onClick:clear","onInput"])]),_:1}),t(M,{cols:"12",sm:"6",md:"4",lg:"4",xl:"2"},{default:n(()=>[t(oe,{modelValue:se.value.Value,"onUpdate:modelValue":D[10]||(D[10]=N=>se.value.Value=N),label:"Legal Surname",clearable:!0,"hide-details":"",variant:"outlined","onClick:clear":y(ve),onInput:y(ve)},null,8,["modelValue","onClick:clear","onInput"])]),_:1}),t(M,{cols:"12",sm:"12",md:"4",lg:"4",xl:"2"},{default:n(()=>[t(oe,{modelValue:Ue.value.Value,"onUpdate:modelValue":D[11]||(D[11]=N=>Ue.value.Value=N),type:"date",label:"Date of Birth",clearable:!0,"hide-details":"",variant:"outlined","onClick:clear":y(ve),onInput:y(ve)},null,8,["modelValue","onClick:clear","onInput"])]),_:1}),t(M,{cols:"12",sm:"6",md:"6",lg:"6",xl:"6"},{default:n(()=>[t(de,{modelValue:Ke.value,"onUpdate:modelValue":D[12]||(D[12]=N=>Ke.value=N),label:"Permission Groups",clearable:!0,"hide-details":"",variant:"outlined",items:T.value,"item-value":"GroupUUID","item-title":"Name"},null,8,["modelValue","items"])]),_:1}),t(M,{cols:"12",sm:"6",md:"6",lg:"6",xl:"6"},{default:n(()=>[t(de,{modelValue:Xe.value,"onUpdate:modelValue":D[13]||(D[13]=N=>Xe.value=N),label:"Tags",clearable:!0,"hide-details":"",variant:"outlined",items:V.value,"item-value":"TagUUID","item-title":"Title"},null,8,["modelValue","items"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),"expanded-row":n(({columns:N,item:ge})=>[B("tr",null,[B("td",{colspan:N.length},[t(fa,{modelValue:Be.value,"onUpdate:modelValue":D[15]||(D[15]=ue=>Be.value=ue),registration:ge.selectable.registration,"onUpdate:registration":ue=>ge.selectable.registration=ue,accommodations:We.value,convention:a.value,extras:Ie.value,forms:r.value,interests:we.value,tickets:Fe.value,title:`Registration Controls (#${ge.selectable.registration.Reference} ${ge.selectable.registration.User.DisplayName})`,"use-dialog":!1,venues:$e.value,style:{"max-width":"calc(100vw - 48px)"},class:"ml-auto mr-0"},null,8,["modelValue","registration","onUpdate:registration","accommodations","convention","extras","forms","interests","tickets","title","venues"])],8,wi)])]),"item.data-table-expand":n(({item:N})=>[c.value.findIndex(ge=>ge===N.key)>=0?(i(),E(j,{key:0,"append-icon":"mdi:mdi-chevron-up",size:"xs",variant:"flat",onClick:ge=>c.value.splice(c.value.findIndex(ue=>ue===N.key),1)},{default:n(()=>[N.selectable.registration.Notes&&N.selectable.registration.Notes.length>0?(i(),_(k,{key:0},[C(I(N.selectable.registration.Notes.length),1)],64)):L("",!0)]),_:2},1032,["onClick"])):(i(),E(j,{key:1,"append-icon":"mdi:mdi-chevron-down",size:"xs",variant:"flat",onClick:ge=>c.value.push(N.key)},{default:n(()=>[N.selectable.registration.Notes&&N.selectable.registration.Notes.length>0?(i(),_(k,{key:0},[C(I(N.selectable.registration.Notes.length),1)],64)):L("",!0)]),_:2},1032,["onClick"]))]),bottom:n(()=>[t(fe,{fluid:!0},{default:n(()=>[t(J,{class:"align-center"},{default:n(()=>[t(M,{cols:"12",lg:"7","order-lg":"3",xl:"8"},{default:n(()=>[t(Pi,{modelValue:U.value,"onUpdate:modelValue":D[16]||(D[16]=N=>U.value=N),length:Math.ceil(Y.value/w.value)},null,8,["modelValue","length"])]),_:1}),t(M,{cols:"6",sm:"4",md:"2",lg:"2",xl:"1","order-lg":"1"},{default:n(()=>[t(de,{"model-value":w.value,density:"compact","hide-details":"","item-title":"title","item-value":"value",label:"Items per page",min:"-1",max:"100",type:"number",variant:"outlined",items:[{title:"10",value:10},{title:"25",value:25},{title:"50",value:50},{title:"100",value:100},{title:"All",value:-1}],"onUpdate:modelValue":D[17]||(D[17]=N=>w.value=parseInt(N,10))},null,8,["model-value"])]),_:1}),t(M,{cols:"6",sm:"3",md:"2",lg:"1",xl:"1","order-lg":"2"},{default:n(()=>[t(oe,{modelValue:U.value,"onUpdate:modelValue":D[18]||(D[18]=N=>U.value=N),modelModifiers:{number:!0},density:"compact","hide-details":"",label:"Page",min:"1",max:Math.ceil(Y.value/w.value),type:"number",variant:"outlined"},null,8,["modelValue","max"])]),_:1}),t(M,{class:"text-right",cols:"12",sm:"5",md:"8",lg:"2",xl:"2","order-lg":"4"},{default:n(()=>[B("span",Fi,[w.value===-1?(i(),_(k,{key:0},[C(" 1-"+I(Y.value)+" of "+I(Y.value),1)],64)):(i(),_(k,{key:1},[C(I((U.value-1)*w.value+1)+"-"+I(U.value*w.value>=Y.value?Y.value:U.value*w.value)+" of "+I(Y.value),1)],64))])]),_:1})]),_:1})]),_:1})]),_:2},[W($.headers,N=>({name:`item.${N.key}`,fn:n(({item:ge,index:ue})=>[t(ai,{header:N,item:ge,accommodations:We.value,convention:a.value,extras:Ie.value,forms:r.value,interests:we.value,tickets:Fe.value,user:y(ja),venues:$e.value,modelValue:$.items[ue],"onUpdate:modelValue":ot=>$.items[ue]=ot,onOpenActions:Wa,onOpenPayments:Ja,onOpenTags:Za,onReload:D[14]||(D[14]=ot=>Dt({page:U.value,itemsPerPage:w.value,sortBy:Z.value})),onSwitchUser:tl,onShowForm:el},null,8,["header","item","accommodations","convention","extras","forms","interests","tickets","user","venues","modelValue","onUpdate:modelValue"])])}))]),1032,["expanded","page","items-per-page","sort-by","headers","items-length","items","loading","search"])]),_:2},1024)):L("",!0)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"]),G.value?(i(),E(Mi,{key:0,title:"Edit Layouts",modelValue:G.value,"onUpdate:modelValue":D[24]||(D[24]=$=>G.value=$),convention:a.value,onSave:Qa},null,8,["modelValue","convention"])):L("",!0),De.value?(i(),_(k,{key:1},[Be.value?(i(),E(fa,{key:0,modelValue:Be.value,"onUpdate:modelValue":D[25]||(D[25]=$=>Be.value=$),registration:De.value,"onUpdate:registration":D[26]||(D[26]=$=>De.value=$),accommodations:We.value,convention:a.value,extras:Ie.value,forms:r.value,interests:we.value,tickets:Fe.value,title:`Registration Controls (#${De.value.Reference} ${De.value.User.DisplayName})`,"use-dialog":!0,venues:$e.value},null,8,["modelValue","registration","accommodations","convention","extras","forms","interests","tickets","title","venues"])):L("",!0)],64)):L("",!0),Je.value&&Et.value&&mt.value?(i(),E(Ut,{key:2,modelValue:Je.value,"onUpdate:modelValue":D[30]||(D[30]=$=>Je.value=$),scrollable:!0,fullscreen:!0,persistent:!0},{default:n(()=>[t(Pe,{class:"bg-red-darken-4"},{default:n(()=>[t(Pt,{color:"error"},{default:n(()=>[t(Ma,null,{default:n(()=>[C("Submission Editor - Admin Mode")]),_:1}),t(Le),t(nn,null,{default:n(()=>[t(j,{icon:"mdi:mdi-window-close",onClick:D[27]||(D[27]=$=>Je.value=!1)})]),_:1})]),_:1}),t(Qe,null,{default:n(()=>[t(yl,{modelValue:mt.value,"onUpdate:modelValue":D[28]||(D[28]=$=>mt.value=$),admin:!0,convention:a.value,data:Et.value,editable:!0,"registration-group":Kt.value,onClose:D[29]||(D[29]=$=>{Je.value=!1,Dt({page:U.value,itemsPerPage:w.value,sortBy:Z.value})})},null,8,["modelValue","convention","data","registration-group"])]),_:1})]),_:1})]),_:1},8,["modelValue"])):L("",!0)]),_:1}))}});export{Rs as default};
