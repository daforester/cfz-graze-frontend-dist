import{s as O}from"./index-2XRRB2DS.js";import{i as P,M,N as q,r as g,k as Y,n as p,q as y,v as l,x as C,f as e,C as T,A as S,c as le,B as E,F as $,y as R,Q as K,D as k,P as G,z as se,m as ke,w as W,V as be,W as ye,X as he,Y as Ie,O as Se,U as ge,s as ue,S as Ye,Z as He}from"./index-T_ev4Ctk.js";import{m as Ae,a as Fe,s as Re,p as je,F as xe,b as B,_ as Pe,c as ze}from"./FormRenderer.vue_vue_type_style_index_0_lang-mSgW01ff.js";import{_ as Z,I as Je,a as Oe}from"./EditOrderedItems.vue_vue_type_script_setup_true_lang-E-rcCxW-.js";import{_ as Q}from"./SaveButton.vue_vue_type_script_setup_true_lang-HPs-awLU.js";import{V as ne,a as ie}from"./VToolbar-vIX2Sc71.js";import{V as N,b as X,c as j}from"./VContainer-SYruFpPy.js";import{V as ae}from"./scopeId-_455Qu3h.js";import{V as Ue}from"./VToolbarItems-oFq0u6pz.js";import{c as Te,e as re}from"./VCard-5c1JETF5.js";import{V as F}from"./VTextField-utn1_cTF.js";import{_ as Me}from"./SelectGroups.vue_vue_type_script_setup_true_lang-vFYsVVO0.js";import{V as Ee,a as oe,d as ee,b as $e}from"./VList-6uT2JzUE.js";import{V as A,a as D}from"./VRow-pZl8O6cY.js";import{V as De}from"./VDialog-aY6xlVVk.js";import{v as w}from"./v4-yQnnJER4.js";import{V as me,a as ve,b as ce,c as pe,d as qe}from"./VDataTable-5yEaIcoG.js";import{V as fe}from"./VTextarea-0VM1LaIe.js";import{T as L,a as Xe}from"./ticket-hqexX1_U.js";import{V as We,a as de}from"./VAutocomplete-AC8feqjn.js";import{V as z}from"./VCheckbox-GsbI64Fo.js";import{V as we,a as Le}from"./VChip-C3WlJHLM.js";import{V as Ze,a as te}from"./VTable-VZuAJ-F8.js";import{_ as Ke}from"./DeleteDialog.vue_vue_type_script_setup_true_lang-lu-zyQ6m.js";import{u as Ve}from"./useModel-JlUTqx_j.js";import{_ as Ne}from"./ModelDialog.vue_vue_type_script_setup_true_lang-8ssxllut.js";import{V as Ge}from"./VDivider-DI7QYvU2.js";import{a as Qe,F as el}from"./form-0fJbSFPv.js";import{b as ll}from"./forwardRefs-fW9ehmx-.js";import{V as tl,a as al,b as ol,c as nl}from"./VWindowItem-t-8tVcoY.js";import"./submission-KjP5fLyB.js";import"./copyToClipboard-aCoRGJiH.js";import"./useStoreAPI-EEjp84mW.js";import"./VTooltip-a9yWMTek.js";import"./VFileInput-vBvkhmi7.js";import"./VForm-KBwyi1KJ.js";import"./form-BBpqNdZy.js";import"./VCheckboxBtn-S6DazQ8u.js";import"./userData-j3wD198p.js";import"./createSimpleFunctional-wIOQLavO.js";var Ce=(_=>(_.PER_ROOM="PER_ROOM",_.PER_PERSON="PER_PERSON",_))(Ce||{});const ul=P({__name:"EditConventionExtraOptions",props:M({convention:{}},{modelValue:{},modelModifiers:{}}),emits:M(["close"],["update:modelValue"]),setup(_,{emit:r}){const a=r,d=q(_,"modelValue"),s=g(Y(d.value)),u=()=>{d.value=s.value,a("close")};return(o,n)=>(p(),y(re,null,{default:l(()=>[e(ne,{dark:"",color:"primary"},{default:l(()=>[e(N,{icon:"",dark:"",onClick:n[0]||(n[0]=t=>a("close"))},{default:l(()=>[e(X,null,{default:l(()=>[C("mdi:mdi-close")]),_:1})]),_:1}),e(ie,null,{default:l(()=>[C("Edit Option Choice")]),_:1}),e(ae),e(Ue,null,{default:l(()=>[e(N,{variant:"text",onClick:u},{default:l(()=>[C(" Apply ")]),_:1})]),_:1})]),_:1}),e(Te,{class:"pa-0"},{default:l(()=>[e(j,null,{default:l(()=>[e(F,{label:T(O).formLabelName,type:"text",variant:"outlined",modelValue:s.value.Name,"onUpdate:modelValue":n[1]||(n[1]=t=>s.value.Name=t)},null,8,["label","modelValue"]),e(F,{label:T(O).formLabelDescription,type:"text",variant:"outlined",modelValue:s.value.Description,"onUpdate:modelValue":n[2]||(n[2]=t=>s.value.Description=t)},null,8,["label","modelValue"]),e(F,{label:T(O).formLabelPrice,type:"text",variant:"outlined","prepend-icon":T(O).currencyIcon,modelValue:s.value.Price,"onUpdate:modelValue":n[3]||(n[3]=t=>s.value.Price=t),modelModifiers:{number:!0},hint:"Adds additional charges for selecting this option"},null,8,["label","prepend-icon","modelValue"]),e(Z,{modelValue:s.value.Tags,"onUpdate:modelValue":n[4]||(n[4]=t=>s.value.Tags=t),convention:o.convention,hint:"Tags acquired by selecting this option & any choice within it."},null,8,["modelValue","convention"]),s.value.Choices?(p(),y(Z,{key:0,modelValue:s.value.Choices,"onUpdate:modelValue":n[5]||(n[5]=t=>s.value.Choices=t),convention:o.convention,hint:"Sub-options (tags) that a user may choose from."},null,8,["modelValue","convention"])):S("",!0)]),_:1})]),_:1})]),_:1}))}}),il=k("h3",null,"Options",-1),dl=P({__name:"EditConventionExtra",props:M({convention:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(_){const r=q(_,"modelValue"),a=g(Y(r.value)),d=g(!1),s=g(0),u=G(),o=g([""]),n=g([]),t=g([]);_.convention&&(u.getConventionTags(_.convention.ConventionUUID).then(v=>{t.value=v.sort((U,I)=>U.Title.localeCompare(I.Title))}),u.getOrganisationTags(_.convention.OrganisationUUID).then(v=>{n.value=v.sort((U,I)=>U.Title.localeCompare(I.Title))}));const i=le(()=>[...n.value,...t.value]),c=({callback:v})=>{u.saveExtra(a.value).then(U=>{U?(r.value=U,v&&v("Extra Saved")):v&&v("Failed to Save Extra")}).catch(()=>{v&&v("Failed to Save Extra")})},m=v=>{var U;v.Options||(v.Options=[]),v.Options.push({ID:0,OptionUUID:w(),ExtraID:v.ID,ExtraUUID:v.ExtraUUID,Order:((U=v.Options)==null?void 0:U.length)+1,Name:"",Description:"",Price:0,Choices:[],Tags:[]})},V=(v,U)=>{v.Options&&v.Options.splice(U,1)},f=v=>{if(v.Choices&&v.Choices.length>0)return v.Choices.map(U=>{const I=i.value.find(x=>x.TagUUID===U.TagUUID);if(I)return I.Title}).join(", ")};return(v,U)=>(p(),E($,null,[e(j,{class:"px-0"},{default:l(()=>[e(F,{label:T(O).formLabelName,type:"text",variant:"outlined",modelValue:a.value.Name,"onUpdate:modelValue":U[0]||(U[0]=I=>a.value.Name=I)},null,8,["label","modelValue"]),e(F,{label:T(O).formLabelDescription,type:"text",variant:"outlined",modelValue:a.value.Description,"onUpdate:modelValue":U[1]||(U[1]=I=>a.value.Description=I)},null,8,["label","modelValue"]),e(Z,{modelValue:a.value.AppliesTags,"onUpdate:modelValue":U[2]||(U[2]=I=>a.value.AppliesTags=I),convention:v.convention,organisation:v.convention.OrganisationUUID,hint:"Tags a user acquires by selecting any option within this addon purchase."},null,8,["modelValue","convention","organisation"]),e(Z,{label:"Required Tags",variant:"outlined",modelValue:a.value.RequiredTags,"onUpdate:modelValue":U[3]||(U[3]=I=>a.value.RequiredTags=I),convention:v.convention,organisation:v.convention.OrganisationUUID,chips:"",clearable:"",hint:"Tags that a user must have to see this form. (Any one)"},null,8,["modelValue","convention","organisation"]),e(Me,{label:"Required Groups",variant:"outlined",modelValue:a.value.RequiredGroupMemberships,"onUpdate:modelValue":U[4]||(U[4]=I=>a.value.RequiredGroupMemberships=I),convention:v.convention,organisation:v.convention.OrganisationUUID,chips:"",clearable:"",hint:"Groups that a user must be in to see this form. (Any one)"},null,8,["modelValue","convention","organisation"]),il,e(Ee,{opened:o.value,"onUpdate:opened":U[5]||(U[5]=I=>o.value=I)},{default:l(()=>[(p(!0),E($,null,K(a.value.Options,(I,x)=>(p(),E($,{key:I.ID},[I?(p(),y(oe,{key:0,"prepend-icon":"mdi:mdi-ticket-percent",title:`${I.Name} ${I.Price&&I.Price>0?`(${T(O).currencySymbol}${I.Price})`:""}`},{append:l(()=>[e(N,{color:"red",icon:"mdi:mdi-close",size:"x-small",class:"mr-1",onClick:h=>V(a.value,x)},null,8,["onClick"]),e(N,{color:"primary",icon:"mdi:mdi-pencil",size:"x-small",onClick:h=>{d.value=!0,s.value=x}},null,8,["onClick"])]),default:l(()=>[I.Choices&&I.Choices.length>0?(p(),y(ee,{key:0},{default:l(()=>[C(" Options: "+R(f(I)),1)]),_:2},1024)):S("",!0)]),_:2},1032,["title"])):S("",!0)],64))),128))]),_:1},8,["opened"]),e(N,{color:"primary",onClick:U[6]||(U[6]=I=>m(a.value))},{default:l(()=>[C("Add Option")]),_:1}),e(A,null,{default:l(()=>[e(D,{class:"text-right"},{default:l(()=>[e(Q,{onClick:c})]),_:1})]),_:1})]),_:1}),e(De,{modelValue:d.value,"onUpdate:modelValue":U[9]||(U[9]=I=>d.value=I),scrollable:""},{default:l(()=>[e(ul,{modelValue:a.value.Options[s.value],"onUpdate:modelValue":U[7]||(U[7]=I=>a.value.Options[s.value]=I),convention:v.convention,onClose:U[8]||(U[8]=I=>d.value=!1)},null,8,["modelValue","convention"])]),_:1},8,["modelValue"])],64))}}),sl=P({__name:"EditConventionExtras",props:M({convention:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:M(["close"],["update:modelValue"]),setup(_,{emit:r}){const a=r,d=q(_,"modelValue"),s=G(),u=()=>{const t={ID:0,ExtraUUID:w(),ConventionID:_.convention.ID,ConventionUUID:_.convention.ConventionUUID,Order:d.value.length+1,Name:"New Extra",Description:"",AppliesTags:[],RequiredTags:[],RequiredGroupMemberships:[],Options:[],Tags:[]};s.saveExtra(t).then(i=>{i&&d.value.push(i)})},o=t=>{s.deleteExtra(d.value[t].ExtraUUID).then(i=>{i&&d.value.splice(t,1)})},n=(...t)=>{t.forEach(i=>{i>=0&&i<d.value.length&&s.saveExtra(d.value[i])})};return(t,i)=>(p(),y(re,null,{default:l(()=>[e(ne,{dark:"",color:"primary"},{default:l(()=>[e(ie,null,{default:l(()=>[C("Edit Extras")]),_:1}),e(ae),e(Ue,null,{default:l(()=>[e(N,{variant:"text",onClick:u},{default:l(()=>[C(" Add ")]),_:1}),e(N,{icon:"",dark:"",onClick:i[0]||(i[0]=c=>a("close"))},{default:l(()=>[e(X,null,{default:l(()=>[C("mdi:mdi-close")]),_:1})]),_:1})]),_:1})]),_:1}),e(Te,{class:"pa-0"},{default:l(()=>[e(me,null,{default:l(()=>[(p(!0),E($,null,K(d.value,(c,m)=>(p(),y(ve,{key:c.ID,class:"mt-0"},{default:l(()=>[e(ce,null,{actions:l(({expanded:V})=>[e(N,{icon:"mdi:mdi-close",size:"x-small",color:"red",class:"mr-1",onClick:f=>o(m)},null,8,["onClick"]),e(X,{class:"align-self-center text-h5",icon:V?"mdi:mdi-chevron-up":"mdi:mdi-chevron-down",variant:"flat",size:"x-small"},null,8,["icon"])]),default:l(()=>[e(N,{icon:"mdi:mdi-menu-up",size:"x-small",color:"primary",class:"mr-1",onClick:se(V=>{T(Ae)(c,d.value),n(m,m-1)},["stop"])},null,8,["onClick"]),e(N,{icon:"mdi:mdi-menu-down",size:"x-small",color:"secondary",class:"mr-4",onClick:se(V=>{T(Fe)(c,d.value),n(m,m+1)},["stop"])},null,8,["onClick"]),C(" "+R(c.Name)+" ",1)]),_:2},1024),e(pe,{class:"px-0"},{default:l(()=>[e(dl,{convention:t.convention,modelValue:d.value[m],"onUpdate:modelValue":V=>d.value[m]=V},null,8,["convention","modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1}))}}),rl=k("h3",null,"Additional Purchases",-1),ml=k("p",null,"These are global ticket addons that are not tied to any particular ticket type.",-1),vl=P({__name:"Extras",props:{modelValue:{required:!0},modelModifiers:{}},emits:["update:modelValue"],setup(_){const r=q(_,"modelValue"),a=g([]),d=G(),s=g([""]),u=g(!1),o=t=>{if(t.Choices&&t.Choices.length>0)return t.Choices.map(i=>i.Title).join(", ")},n=()=>{u.value=!1};return d==null||d.getConventionExtras(r.value.ConventionUUID||"").then(t=>{t&&(a.value=t)}),(t,i)=>(p(),E($,null,[e(j,{fluid:!0,class:"px-0"},{default:l(()=>[e(A,null,{default:l(()=>[e(D,null,{default:l(()=>[rl]),_:1}),e(D,{class:"text-right"},{default:l(()=>[e(N,{color:"primary",onClick:i[0]||(i[0]=c=>u.value=!0)},{default:l(()=>[C("Edit")]),_:1})]),_:1})]),_:1})]),_:1}),ml,e(Ee,{opened:s.value,"onUpdate:opened":i[1]||(i[1]=c=>s.value=c)},{default:l(()=>[(p(!0),E($,null,K(a.value,c=>(p(),y($e,{key:c.ID,value:c.ID},{activator:l(({props:m})=>[e(oe,ke(m,{"prepend-icon":"mdi:mdi-group",title:c.Name}),null,16,["title"])]),default:l(()=>[c.Options?(p(!0),E($,{key:0},K(c.Options,m=>(p(),y(oe,{key:m.ID,"prepend-icon":"mdi:mdi-ticket-percent",title:`${m.Name} ${m.Price&&m.Price>0?`(${T(O).currencySymbol}${m.Price})`:""}`},{default:l(()=>[m.Choices&&m.Choices.length>0?(p(),y(ee,{key:0},{default:l(()=>[C(" Options: "+R(o(m)),1)]),_:2},1024)):S("",!0)]),_:2},1032,["title"]))),128)):S("",!0)]),_:2},1032,["value"]))),128))]),_:1},8,["opened"]),e(De,{modelValue:u.value,"onUpdate:modelValue":i[3]||(i[3]=c=>u.value=c),scrollable:!0,persistent:!0,fullscreen:!0},{default:l(()=>[e(sl,{modelValue:a.value,"onUpdate:modelValue":i[2]||(i[2]=c=>a.value=c),convention:r.value,onClose:n},null,8,["modelValue","convention"])]),_:1},8,["modelValue"])],64))}}),cl=P({__name:"EditConventionInterest",props:M({convention:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(_){const r=q(_,"modelValue"),a=g(Y(r.value)),d=G(),s=({callback:u})=>{d.saveInterest(a.value).then(o=>{o?(r.value=o,u&&u("Interest Saved")):u&&u("Failed to Save Interest")}).catch(()=>{u&&u("Failed to Save Interest")})};return(u,o)=>(p(),y(j,{class:"px-0"},{default:l(()=>[e(F,{label:T(O).formLabelName,type:"text",variant:"outlined",modelValue:a.value.Name,"onUpdate:modelValue":o[0]||(o[0]=n=>a.value.Name=n)},null,8,["label","modelValue"]),e(fe,{label:T(O).formLabelDescription,type:"text",variant:"outlined",modelValue:a.value.Description,"onUpdate:modelValue":o[1]||(o[1]=n=>a.value.Description=n)},null,8,["label","modelValue"]),S("",!0),e(Z,{modelValue:a.value.AppliesTags,"onUpdate:modelValue":o[3]||(o[3]=n=>a.value.AppliesTags=n),convention:u.convention,organisation:u.convention.OrganisationUUID,hint:"Tags that a user acquires by selecting this interest."},null,8,["modelValue","convention","organisation"]),e(A,null,{default:l(()=>[e(D,{class:"text-right"},{default:l(()=>[e(Q,{onClick:s})]),_:1})]),_:1})]),_:1}))}}),pl=P({__name:"EditConventionInterests",props:M({convention:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:M(["close"],["update:modelValue"]),setup(_,{emit:r}){const a=r,d=q(_,"modelValue"),s=G(),u=()=>{const t={ID:0,InterestUUID:w(),ConventionID:_.convention.ID,ConventionUUID:_.convention.ConventionUUID,Order:d.value.length+1,Name:"New Interest",Description:"",Price:0,AppliesTags:[]};s.saveInterest(t).then(i=>{i&&d.value.push(i)})},o=t=>{s.deleteInterest(d.value[t].InterestUUID).then(i=>{i&&d.value.splice(t,1)})},n=(...t)=>{t.forEach(i=>{i>=0&&i<d.value.length&&s.saveInterest(d.value[i])})};return(t,i)=>(p(),y(re,null,{default:l(()=>[e(ne,{dark:"",color:"primary"},{default:l(()=>[e(ie,null,{default:l(()=>[C("Edit Interests")]),_:1}),e(ae),e(Ue,null,{default:l(()=>[e(N,{variant:"text",onClick:u},{default:l(()=>[C(" Add ")]),_:1}),e(N,{icon:"",dark:"",onClick:i[0]||(i[0]=c=>a("close"))},{default:l(()=>[e(X,null,{default:l(()=>[C("mdi:mdi-close")]),_:1})]),_:1})]),_:1})]),_:1}),e(Te,{class:"pa-0"},{default:l(()=>[e(me,null,{default:l(()=>[(p(!0),E($,null,K(d.value,(c,m)=>(p(),y(ve,{key:c.ID,class:"mt-0"},{default:l(()=>[e(ce,null,{actions:l(({expanded:V})=>[e(Q,{class:"mr-1",color:"red",icon:"mdi:mdi-close",size:"x-small",onClick:f=>o(m)},null,8,["onClick"]),e(X,{class:"align-self-center text-h5",icon:V?"mdi:mdi-chevron-up":"mdi:mdi-chevron-down",variant:"flat",size:"x-small"},null,8,["icon"])]),default:l(()=>[e(N,{icon:"mdi:mdi-menu-up",size:"x-small",color:"primary",class:"mr-1",onClick:se(V=>{T(Ae)(c,d.value),n(m,m-1)},["stop"])},null,8,["onClick"]),e(N,{icon:"mdi:mdi-menu-down",size:"x-small",color:"secondary",class:"mr-4",onClick:se(V=>{T(Fe)(c,d.value),n(m,m+1)},["stop"])},null,8,["onClick"]),C(" "+R(c.Name)+" ",1)]),_:2},1024),e(pe,{class:"px-0"},{default:l(()=>[e(cl,{convention:t.convention,modelValue:d.value[m],"onUpdate:modelValue":V=>d.value[m]=V},null,8,["convention","modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1}))}}),fl=k("h3",null,"Interests",-1),Vl=k("p",null,"Attendees can tag themselves for particular things.",-1),Ul=P({__name:"Interests",props:{modelValue:{required:!0},modelModifiers:{}},emits:M(["refresh"],["update:modelValue"]),setup(_){const r=q(_,"modelValue"),a=G(),d=g([]);a.getConventionInterests(r.value.ConventionUUID).then(o=>{Re(o),d.value=o});const s=g([""]),u=g(!1);return(o,n)=>(p(),E($,null,[e(j,{fluid:!0,class:"px-0"},{default:l(()=>[e(A,null,{default:l(()=>[e(D,null,{default:l(()=>[fl]),_:1}),e(D,{class:"text-right"},{default:l(()=>[e(N,{color:"primary",onClick:n[0]||(n[0]=t=>u.value=!0)},{default:l(()=>[C("Edit")]),_:1})]),_:1})]),_:1})]),_:1}),Vl,e(Ee,{opened:s.value,"onUpdate:opened":n[1]||(n[1]=t=>s.value=t)},{default:l(()=>[(p(!0),E($,null,K(d.value,t=>(p(),y(oe,{key:t.ID,"prepend-icon":"mdi:mdi-checkbox-marked-outline",title:`${t.Name} ${t.Price&&t.Price>0?`(${T(O).currencySymbol}${t.Price})`:""}`},{default:l(()=>[t.Description?(p(),y(ee,{key:0},{default:l(()=>[C(R(t.Description),1)]),_:2},1024)):S("",!0)]),_:2},1032,["title"]))),128))]),_:1},8,["opened"]),e(De,{modelValue:u.value,"onUpdate:modelValue":n[4]||(n[4]=t=>u.value=t),scrollable:!0,fullscreen:!0,persistent:!0},{default:l(()=>[e(pl,{onClose:n[2]||(n[2]=t=>u.value=!1),convention:r.value,modelValue:d.value,"onUpdate:modelValue":n[3]||(n[3]=t=>d.value=t)},null,8,["convention","modelValue"])]),_:1},8,["modelValue"])],64))}}),_e=P({__name:"SelectTickets",props:M({chips:{type:Boolean,default:!1},clearable:{type:Boolean,default:!1},hint:{default:"Tickets that belong to this group."},label:{default:"Tickets"},persistentHint:{type:Boolean,default:!1},tickets:{default:()=>[]},variant:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(_){const r=q(_,"modelValue"),a=s=>s.Type===L.TICKET_TYPE_GROUP?"mdi:mdi-group":s.Type===L.TICKET_TYPE_TICKET?s.RequiresAccommodation?"mdi:mdi-home":s.ComponentsRequired>0?"mdi:mdi-ticket-confirmation":"mdi:mdi-ticket":s.Type===L.TICKET_TYPE_TICKET_COMPONENT?"mdi:mdi-cog-outline":s.Type===L.TICKET_TYPE_ADD_ON?"mdi:mdi-home-plus":"mdi:mdi-help",d=le(()=>_.tickets.map(s=>({title:s.Name,value:r.value.find(u=>u&&u.TicketUUID===s.TicketUUID)||s,props:{appendIcon:a(s)}})));return(s,u)=>(p(),E("div",null,[e(We,{label:s.label,variant:s.variant||"filled",items:d.value,"item-title":"title","item-value":"value","item-props":"props",modelValue:r.value,"onUpdate:modelValue":u[0]||(u[0]=o=>r.value=o),hint:s.hint,chips:s.chips,clearable:s.clearable,multiple:"","persistent-hint":s.persistentHint},null,8,["label","variant","items","modelValue","hint","chips","clearable","persistent-hint"])]))}}),Tl=k("p",{title:"Automatically calculated",class:"text-grey-lighten-1"},"Applicable Accommodation:",-1),Dl=P({__name:"EditConventionTicket",props:M({accommodation:{default:()=>[]},convention:{},tickets:{default:()=>[]}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(_){const r=q(_,"modelValue"),a=g(Y(r.value)),d=G(),s=le(()=>_.tickets.filter(i=>i.Type===L.TICKET_TYPE_TICKET)),u=le(()=>_.tickets.filter(i=>i.Type===L.TICKET_TYPE_ADD_ON)),o=le(()=>_.tickets.filter(i=>i.Type===L.TICKET_TYPE_TICKET_COMPONENT)),n=i=>_.accommodation.filter(c=>c.Costs.find(m=>m.DateStart===i.DateStart&&m.DateEnd===i.DateEnd)),t=({callback:i})=>{d.saveTicket(a.value).then(c=>{c?(a.value.ID=c.ID,a.value.TicketUUID=c.TicketUUID,r.value=a.value,i&&i("Ticket Saved")):i&&i("Failed to Save Ticket")}).catch(()=>{i&&i("Failed to Save Ticket")})};return(i,c)=>(p(),y(j,{class:"px-0",fluid:""},{default:l(()=>[e(A,null,{default:l(()=>[e(D,{cols:"12"},{default:l(()=>[e(de,{label:"Ticket Type",variant:"outlined",modelValue:a.value.Type,"onUpdate:modelValue":c[0]||(c[0]=m=>a.value.Type=m),items:T(Xe),"item-title":"title","item-value":"value","hide-details":""},null,8,["modelValue","items"])]),_:1}),e(D,{cols:"12"},{default:l(()=>[e(F,{label:T(O).formLabelName,type:"text",variant:"outlined",modelValue:a.value.Name,"onUpdate:modelValue":c[1]||(c[1]=m=>a.value.Name=m),"hide-details":""},null,8,["label","modelValue"])]),_:1}),e(D,{cols:"12"},{default:l(()=>[e(F,{label:T(O).formLabelDescription,type:"text",variant:"outlined",modelValue:a.value.Description,"onUpdate:modelValue":c[2]||(c[2]=m=>a.value.Description=m),"hide-details":""},null,8,["label","modelValue"])]),_:1}),a.value.Type!==T(L).TICKET_TYPE_GROUP?(p(),E($,{key:0},[e(D,{cols:"12"},{default:l(()=>[e(z,{label:T(O).formLabelRequiresAccommodation,modelValue:a.value.RequiresAccommodation,"onUpdate:modelValue":c[3]||(c[3]=m=>a.value.RequiresAccommodation=m),"hide-details":""},null,8,["label","modelValue"])]),_:1}),e(D,{cols:"12"},{default:l(()=>[e(F,{label:T(O).formLabelDateStart,type:"date",variant:"outlined",modelValue:a.value.DateStart,"onUpdate:modelValue":c[4]||(c[4]=m=>a.value.DateStart=m),"hide-details":""},null,8,["label","modelValue"])]),_:1}),e(D,{cols:"12"},{default:l(()=>[e(F,{label:T(O).formLabelDateEnd,type:"date",variant:"outlined",modelValue:a.value.DateEnd,"onUpdate:modelValue":c[5]||(c[5]=m=>a.value.DateEnd=m),"hide-details":""},null,8,["label","modelValue"])]),_:1}),e(D,{cols:"12"},{default:l(()=>[e(F,{label:T(O).formLabelPrice,type:"text",variant:"outlined","prepend-inner-icon":T(O).currencyIcon,modelValue:a.value.Price,"onUpdate:modelValue":c[6]||(c[6]=m=>a.value.Price=m),modelModifiers:{number:!0},"persistent-hint":"",hint:"Adds additional charges for selecting this ticket"},null,8,["label","prepend-inner-icon","modelValue"])]),_:1})],64)):(p(),y(D,{key:1,cols:"12"},{default:l(()=>[e(_e,{label:"Tickets",variant:"outlined",tickets:s.value,modelValue:a.value.Tickets,"onUpdate:modelValue":c[7]||(c[7]=m=>a.value.Tickets=m),chips:"",clearable:"",multiple:"","persistent-hint":"",hint:"Tickets that belong to this group."},null,8,["tickets","modelValue"])]),_:1})),e(D,{cols:"12"},{default:l(()=>[e(Z,{label:"Applied Tags",variant:"outlined",modelValue:a.value.AppliesTags,"onUpdate:modelValue":c[8]||(c[8]=m=>a.value.AppliesTags=m),convention:i.convention,organisation:i.convention.OrganisationUUID,chips:"",clearable:"",hint:"Tags that a user acquires by selecting this ticket."},null,8,["modelValue","convention","organisation"])]),_:1}),e(D,{cols:"12"},{default:l(()=>[e(Z,{label:"Required Tags",variant:"outlined",modelValue:a.value.RequiredTags,"onUpdate:modelValue":c[9]||(c[9]=m=>a.value.RequiredTags=m),convention:i.convention,organisation:i.convention.OrganisationUUID,chips:"",clearable:"",hint:"Tags that a user must have to see this ticket."},null,8,["modelValue","convention","organisation"])]),_:1}),a.value.Type===T(L).TICKET_TYPE_TICKET?(p(),E($,{key:2},[e(D,{cols:"12"},{default:l(()=>[e(F,{label:"Components Required",type:"number",variant:"outlined",modelValue:a.value.ComponentsRequired,"onUpdate:modelValue":c[10]||(c[10]=m=>a.value.ComponentsRequired=m),modelModifiers:{number:!0},"persistent-hint":"",hint:"How many components must be selected."},null,8,["modelValue"])]),_:1}),e(D,{cols:"12"},{default:l(()=>[e(_e,{label:"Components",variant:"outlined",tickets:o.value,modelValue:a.value.TicketComponents,"onUpdate:modelValue":c[11]||(c[11]=m=>a.value.TicketComponents=m),chips:"",clearable:"",multiple:"","persistent-hint":"",hint:"Components that are part of this ticket (and others)."},null,8,["tickets","modelValue"])]),_:1}),e(D,{cols:"12"},{default:l(()=>[e(_e,{label:"Addons",variant:"outlined",tickets:u.value,modelValue:a.value.AddonTickets,"onUpdate:modelValue":c[12]||(c[12]=m=>a.value.AddonTickets=m),chips:"",clearable:"",multiple:"","persistent-hint":"",hint:"Optional ticket addons that apply for this ticket."},null,8,["tickets","modelValue"])]),_:1})],64)):S("",!0),e(D,{cols:"12"},{default:l(()=>[e(_e,{label:"Disables Tickets",variant:"outlined",tickets:i.tickets,modelValue:a.value.DisablesTickets,"onUpdate:modelValue":c[13]||(c[13]=m=>a.value.DisablesTickets=m),chips:"",clearable:"",multiple:"","persistent-hint":"",hint:"Tickets that are mutually exclusive and can't be selected if this one is."},null,8,["tickets","modelValue"])]),_:1})]),_:1}),n(a.value).length?(p(),y(A,{key:0,class:"align-center",dense:!0},{default:l(()=>[e(D,{class:"flex-grow-0 flex-shrink-1 text-no-wrap font-italic"},{default:l(()=>[Tl]),_:1}),e(D,{class:"flex-grow-1"},{default:l(()=>[e(we,null,{default:l(()=>[(p(!0),E($,null,K(n(a.value),m=>(p(),y(Le,{key:m.ID,title:"Automatically calculated",disabled:!0},{default:l(()=>[C(R(m.Name),1)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})):S("",!0),e(A,null,{default:l(()=>[e(D,{class:"text-right"},{default:l(()=>[e(Q,{onClick:t})]),_:1})]),_:1})]),_:1}))}}),_l={class:"pr-2"},Il={class:"mb-2"},yl={key:0,class:"text-grey-darken-1 font-italic"},gl={key:1,class:"text-red"},Cl={key:0,class:"text-grey-darken-1 font-italic"},bl={key:1,class:"text-red"},El={key:0,class:"text-grey-darken-1 font-italic"},kl={key:1,class:"text-red"},hl={class:"text-grey-darken-1"},$l=P({__name:"EditConventionTickets",props:M({accommodation:{default:()=>[]},convention:{}},{modelValue:{default:[]},modelModifiers:{}}),emits:M(["close"],["update:modelValue"]),setup(_,{emit:r}){const a=q(_,"modelValue"),d=r,s=G(),u=()=>{a.value.push({ID:0,TicketUUID:w(),ConventionID:_.convention.ID,ConventionUUID:_.convention.ConventionUUID,Order:a.value.length+1,Name:"New Ticket",Type:L.TICKET_TYPE_GROUP,Description:"",DateStart:"",DateEnd:"",Price:0,Tickets:[],RequiresAccommodation:!1,AppliesTags:[],RequiredTags:[],RequiredGroupMemberships:[],TicketComponents:[],ComponentsRequired:0,AddonTickets:[],DisablesTickets:[]})},o=t=>{s.deleteTicket(a.value[t].TicketUUID).then(i=>{i&&a.value.splice(t,1)})},n=t=>t.Type===L.TICKET_TYPE_GROUP?"mdi:mdi-group":t.Type===L.TICKET_TYPE_TICKET?t.RequiresAccommodation?"mdi:mdi-home":t.ComponentsRequired>0?"mdi:mdi-ticket-confirmation":"mdi:mdi-ticket":t.Type===L.TICKET_TYPE_TICKET_COMPONENT?"mdi:mdi-cog-outline":t.Type===L.TICKET_TYPE_ADD_ON?"mdi:mdi-home-plus":"mdi:mdi-help";return(t,i)=>(p(),y(re,null,{default:l(()=>[e(ne,{dark:"",color:"primary"},{default:l(()=>[e(ie,null,{default:l(()=>[C("Edit Tickets")]),_:1}),e(ae),e(Ue,null,{default:l(()=>[e(N,{variant:"text",onClick:u},{default:l(()=>[C(" Add Ticket ")]),_:1}),e(N,{icon:"",dark:"",onClick:i[0]||(i[0]=c=>d("close"))},{default:l(()=>[e(X,null,{default:l(()=>[C("mdi:mdi-close")]),_:1})]),_:1})]),_:1})]),_:1}),e(Te,{class:"pa-0"},{default:l(()=>[e(me,null,{default:l(()=>[(p(!0),E($,null,K(a.value,(c,m)=>(p(),y(ve,{key:c.ID,class:"mt-0"},{default:l(()=>[e(ce,{class:"py-2"},{actions:l(({expanded:V})=>[e(Q,{class:"mr-1",color:"red",icon:"mdi:mdi-close",size:"x-small",onClick:f=>o(m)},null,8,["onClick"]),e(X,{class:"align-self-center text-h5",icon:V?"mdi:mdi-chevron-up":"mdi:mdi-chevron-down",variant:"flat",size:"x-small"},null,8,["icon"])]),default:l(()=>[e(N,{icon:"mdi:mdi-menu-up",size:"x-small",color:"primary",class:"mr-1",onClick:se(V=>T(Ae)(c,a.value),["stop"])},null,8,["onClick"]),e(N,{icon:"mdi:mdi-menu-down",size:"x-small",color:"secondary",class:"mr-4",onClick:se(V=>T(Fe)(c,a.value),["stop"])},null,8,["onClick"]),k("div",_l,[e(X,{icon:n(c)},null,8,["icon"])]),k("div",null,[k("p",Il,[C(R(c.Name)+" ",1),c.Type===T(L).TICKET_TYPE_TICKET?(p(),E($,{key:0},[a.value.find(V=>V.Type===T(L).TICKET_TYPE_GROUP&&V.Tickets.find(f=>f&&f.TicketUUID===c.TicketUUID))?(p(),E("span",yl," ("+R(a.value.filter(V=>V.Type===T(L).TICKET_TYPE_GROUP&&V.Tickets.find(f=>f&&f.TicketUUID===c.TicketUUID)).map(V=>V.Name).join(", "))+") ",1)):(p(),E("span",gl," (Ticket does not belong to any categories.) "))],64)):S("",!0),c.Type===T(L).TICKET_TYPE_ADD_ON?(p(),E($,{key:1},[a.value.find(V=>V.Type===T(L).TICKET_TYPE_TICKET&&V.AddonTickets.find(f=>f&&f.TicketUUID===c.TicketUUID))?(p(),E("span",Cl," ("+R(a.value.filter(V=>V.Type===T(L).TICKET_TYPE_TICKET&&V.AddonTickets.find(f=>f&&f.TicketUUID===c.TicketUUID)).map(V=>V.Name).join(", "))+") ",1)):(p(),E("span",bl," (Ticket addon must be associated to at least one ticket.) "))],64)):S("",!0),c.Type===T(L).TICKET_TYPE_TICKET_COMPONENT?(p(),E($,{key:2},[a.value.find(V=>V.Type===T(L).TICKET_TYPE_TICKET&&V.TicketComponents.find(f=>f&&f.TicketUUID===c.TicketUUID))?(p(),E("span",El," ("+R(a.value.filter(V=>V.Type===T(L).TICKET_TYPE_TICKET&&V.TicketComponents.find(f=>f&&f.TicketUUID===c.TicketUUID)).map(V=>V.Name).join(", "))+") ",1)):(p(),E("span",kl," (Component has not been assigned to any tickets.) "))],64)):S("",!0)]),k("p",hl,[c.Type===T(L).TICKET_TYPE_GROUP?(p(),E($,{key:0},[C("Category")],64)):c.Type===T(L).TICKET_TYPE_TICKET?(p(),E($,{key:1},[C(" Ticket "),c.ComponentsRequired>0?(p(),E($,{key:0},[C(" ("+R(c.ComponentsRequired)+" component"+R(c.ComponentsRequired>1?"s":"")+" required) ",1)],64)):S("",!0)],64)):S("",!0),c.Type===T(L).TICKET_TYPE_TICKET_COMPONENT?(p(),E($,{key:2},[C("Component")],64)):S("",!0),c.Type===T(L).TICKET_TYPE_ADD_ON?(p(),E($,{key:3},[C("Addon")],64)):S("",!0)])])]),_:2},1024),e(pe,{class:"px-0"},{default:l(()=>[e(Dl,{accommodation:t.accommodation,convention:t.convention,tickets:a.value,modelValue:a.value[m],"onUpdate:modelValue":V=>a.value[m]=V},null,8,["accommodation","convention","tickets","modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1}))}}),Al=k("h3",null,"Tickets",-1),Fl=k("p",null,"Ticket options, along with all sub-types and options applicable to them.",-1),Nl=P({__name:"Tickets",props:{modelValue:{required:!0},modelModifiers:{}},emits:M(["refresh"],["update:modelValue"]),setup(_){var m;const r=q(_,"modelValue"),a=G(),d=g([]),s=g([]);a.getConventionTickets(((m=r.value)==null?void 0:m.ConventionUUID)||"").then(V=>{Re(V),d.value=V});const u=g([""]),o=g(!1),n=V=>V.AddonTickets&&V.AddonTickets.map(f=>d.value&&d.value.find(v=>v.ID===f.ID)),t=V=>V.TicketComponents&&V.TicketComponents.map(f=>d.value&&d.value.find(v=>v.ID===f.ID)),i=V=>"",c=V=>s.value.filter(f=>f.Costs.find(v=>v.DateStart===V.DateStart&&v.DateEnd===V.DateEnd)).map(f=>f.Name).join(", ");return(V,f)=>(p(),E($,null,[e(j,{fluid:!0,class:"px-0"},{default:l(()=>[e(A,null,{default:l(()=>[e(D,null,{default:l(()=>[Al]),_:1}),e(D,{class:"text-right"},{default:l(()=>[e(N,{color:"primary",onClick:f[0]||(f[0]=v=>o.value=!0)},{default:l(()=>[C("Edit")]),_:1})]),_:1})]),_:1})]),_:1}),Fl,e(Ee,{opened:u.value,"onUpdate:opened":f[1]||(f[1]=v=>u.value=v)},{default:l(()=>[(p(!0),E($,null,K(d.value.filter(v=>v.Type===T(L).TICKET_TYPE_GROUP),v=>(p(),y($e,{key:v.ID,value:v.ID},{activator:l(({props:U})=>[e(oe,ke(U,{"prepend-icon":"mdi:mdi-group",title:v.Name}),null,16,["title"])]),default:l(()=>[(p(!0),E($,null,K(d.value.filter(U=>v.Tickets.find(I=>I&&U&&I.TicketUUID===U.TicketUUID)),U=>(p(),E($,{key:U.ID},[U.AddonTickets&&U.AddonTickets.length?(p(),y($e,{key:0,value:U.ID},{activator:l(({props:I})=>[e(oe,ke(I,{"prepend-icon":U.RequiresAccommodation?"mdi:mdi-home":U.ComponentsRequired>0?"mdi:mdi-ticket-confirmation":"mdi:mdi-ticket",title:`${U.Name} ${U.Price>0?`(${T(O).currencySymbol}${U.Price})`:""}`}),{default:l(()=>[U.ComponentsRequired>0?(p(),y(ee,{key:0},{default:l(()=>[C(" Options: "+R(t(U).map(x=>x&&x.Name).join(", ")),1)]),_:2},1024)):S("",!0),U.RequiresAccommodation&&c(U)?(p(),y(ee,{key:1},{default:l(()=>[C(" Accommodation: "+R(c(U)),1)]),_:2},1024)):S("",!0)]),_:2},1040,["prepend-icon","title"])]),default:l(()=>[(p(!0),E($,null,K(n(U),I=>(p(),E($,{key:I},[I?(p(),y(oe,{key:0,title:`${I.Name} ${I.Price>0?`(${T(O).currencySymbol}${I.Price})`:""}`,"prepend-icon":"mdi:mdi-home-plus"},{default:l(()=>[I.RequiredTags&&I.RequiredTags.length>0?(p(),y(ee,{key:0},{default:l(()=>[C(" Required Tags: "+R(I.RequiredTags.join(", ")),1)]),_:2},1024)):S("",!0),I.RequiredGroupMemberships&&I.RequiredGroupMemberships.length>0?(p(),y(ee,{key:1},{default:l(()=>[C(" Required Groups: "+R(i(I.RequiredGroupMemberships)),1)]),_:2},1024)):S("",!0),c(I)?(p(),y(ee,{key:2},{default:l(()=>[C(" Accommodation: "+R(c(I)),1)]),_:2},1024)):S("",!0)]),_:2},1032,["title"])):S("",!0)],64))),128))]),_:2},1032,["value"])):(p(),y(oe,{key:1,"prepend-icon":U.RequiresAccommodation?"mdi:mdi-home":U.ComponentsRequired>0?"mdi:mdi-ticket-confirmation":"mdi:mdi-ticket",title:`${U.Name} ${U.Price>0?`(${T(O).currencySymbol}${U.Price})`:""}`},{default:l(()=>[U.ComponentsRequired>0?(p(),y(ee,{key:0},{default:l(()=>[C(" Options: "+R(t(U).map(I=>I&&I.Name).join(", ")),1)]),_:2},1024)):S("",!0)]),_:2},1032,["prepend-icon","title"]))],64))),128))]),_:2},1032,["value"]))),128))]),_:1},8,["opened"]),e(De,{modelValue:o.value,"onUpdate:modelValue":f[4]||(f[4]=v=>o.value=v),scrollable:!0,fullscreen:!0,persistent:!0},{default:l(()=>[e($l,{onClose:f[2]||(f[2]=v=>o.value=!1),modelValue:d.value,"onUpdate:modelValue":f[3]||(f[3]=v=>d.value=v),accommodation:s.value,convention:r.value},null,8,["modelValue","accommodation","convention"])]),_:1},8,["modelValue"])],64))}}),Sl=P({__name:"VenueRoomCost",props:{modelValue:{required:!0},modelModifiers:{}},emits:M(["deleted"],["update:modelValue"]),setup(_,{emit:r}){const a=r,d=q(_,"modelValue"),s=[{title:"Per Room",value:"PER_ROOM"},{title:"Per Person",value:"PER_PERSON"}],u=()=>{a("deleted")};return(o,n)=>(p(),y(A,{dense:""},{default:l(()=>[e(D,{cols:"12",sm:"4",md:"2",lg:"2"},{default:l(()=>[e(F,{label:T(O).formLabelDateStart,type:"date",variant:"outlined",modelValue:d.value.DateStart,"onUpdate:modelValue":n[0]||(n[0]=t=>d.value.DateStart=t)},null,8,["label","modelValue"])]),_:1}),e(D,{cols:"12",sm:"4",md:"2",lg:"2"},{default:l(()=>[e(F,{label:T(O).formLabelDateEnd,type:"date",variant:"outlined",modelValue:d.value.DateEnd,"onUpdate:modelValue":n[1]||(n[1]=t=>d.value.DateEnd=t)},null,8,["label","modelValue"])]),_:1}),e(D,{cols:"6",sm:"4",md:"2",lg:"2"},{default:l(()=>[e(F,{label:T(O).formLabelAvailability,type:"number",variant:"outlined",modelValue:d.value.Availability,"onUpdate:modelValue":n[2]||(n[2]=t=>d.value.Availability=t),modelModifiers:{number:!0}},null,8,["label","modelValue"])]),_:1}),e(D,{cols:"6",sm:"4",md:"2",lg:"2"},{default:l(()=>[e(F,{label:T(O).formLabelPrice,type:"number","prepend-inner-icon":"mdi:mdi-currency-gbp",variant:"outlined",modelValue:d.value.Price,"onUpdate:modelValue":n[3]||(n[3]=t=>d.value.Price=t),modelModifiers:{number:!0}},null,8,["label","modelValue"])]),_:1}),e(D,{cols:"6",sm:"4",md:"3",lg:"3"},{default:l(()=>[e(de,{label:T(O).formLabelPriceType,variant:"outlined",modelValue:d.value.Type,"onUpdate:modelValue":n[4]||(n[4]=t=>d.value.Type=t),items:s,"item-value":"value","item-title":"title"},null,8,["label","modelValue"])]),_:1}),e(D,{cols:"6",sm:"4",md:"1",class:"text-right"},{default:l(()=>[e(N,{color:"red",icon:"mdi:mdi-minus",onClick:u})]),_:1})]),_:1}))}}),Rl=k("strong",null,"Capacity:",-1),xl=k("thead",null,[k("tr",null,[k("th",null,"Date"),k("th",null,"Price"),k("th",null,"Availability")])],-1),Pl={class:"d-flex flex-wrap justify-space-between",style:{gap:"1rem"}},Ol=k("h4",null," Availability & Costs (To Organisation) ",-1),Ml=P({__name:"VenueRoom",props:{modelValue:{required:!0},modelModifiers:{}},emits:M(["deleted"],["update:modelValue"]),setup(_,{emit:r}){const a=G(),d=r,s=g(O),u=q(_,"modelValue"),o=g(Y(u.value)),n=g(!1),t=f=>{switch(f.Type){case Ce.PER_PERSON:return s.value.enumPER_PERSON;case Ce.PER_ROOM:return s.value.enumPER_ROOM}return"Unknown"},i=()=>{o.value.Costs||(o.value.Costs=[]),o.value.Costs.push({ID:0,CostUUID:w(),Availability:0,DateStart:"",DateEnd:"",Price:0,Type:"PER_ROOM"})},c=f=>{o.value.Costs.splice(f,1)},m=({callback:f})=>{const v=()=>{f&&f("Failed to Delete Room")},U=()=>{f&&f("Room Deleted")};a.deleteRoom(o.value.RoomUUID).then(I=>{I?(U(),d("deleted",o.value)):v()}).catch(()=>{v()})},V=()=>{a.saveRoom(o.value).then(()=>{u.value=o.value,n.value=!1})};return(f,v)=>(p(),E($,null,[e(j,{fluid:"",class:"pa-1 pa-sm-2"},{default:l(()=>[k("h4",null,R(o.value.Name),1),k("p",null,R(o.value.Notes),1),k("p",null,[Rl,C(" "+R(o.value.MinimumCapacity)+" ",1),o.value.MinimumCapacity!=o.value.MaximumCapacity?(p(),E($,{key:0},[C(" - "+R(o.value.MaximumCapacity),1)],64)):S("",!0)]),e(Ze,{density:"compact"},{default:l(()=>[xl,k("tbody",null,[(p(!0),E($,null,K(o.value.Costs,U=>(p(),E("tr",{key:`venue-room-${o.value.ID}-cost-${U.ID}`},[k("td",null,R(U.DateStart)+" - "+R(U.DateEnd),1),k("td",null,R(s.value.currencySymbol)+R(U.Price)+" "+R(t(U)),1),k("td",null,R(U.Availability),1)]))),128))])]),_:1}),k("div",Pl,[e(N,{color:"primary","prepend-icon":"mdi:mdi-playlist-edit",onClick:v[0]||(v[0]=U=>n.value=!0)},{default:l(()=>[C("Edit Room")]),_:1}),e(Q,{color:"red-darken-3","prepend-icon":"mdi:mdi-minus",onClick:m},{default:l(()=>[C("Delete Room")]),_:1})])]),_:1}),e(De,{scrollable:"",modelValue:n.value,"onUpdate:modelValue":v[6]||(v[6]=U=>n.value=U),width:"auto"},{default:l(()=>[e(re,null,{default:l(()=>[e(ne,{dark:"",color:"primary"},{default:l(()=>[e(N,{icon:"",dark:"",onClick:v[1]||(v[1]=U=>n.value=!1)},{default:l(()=>[e(X,null,{default:l(()=>[C("mdi:mdi-close")]),_:1})]),_:1}),e(ie,null,{default:l(()=>[C("Room Details ("+R(o.value.Name)+")",1)]),_:1}),e(ae),e(Ue,null,{default:l(()=>[e(N,{variant:"text",onClick:V},{default:l(()=>[C(" Save ")]),_:1})]),_:1})]),_:1}),e(Te,null,{default:l(()=>[e(te,null,{default:l(()=>[e(A,null,{default:l(()=>[e(D,{cols:"12"},{default:l(()=>[e(F,{label:s.value.formLabelName,type:"text",variant:"outlined",modelValue:o.value.Name,"onUpdate:modelValue":v[2]||(v[2]=U=>o.value.Name=U)},null,8,["label","modelValue"])]),_:1})]),_:1}),e(A,null,{default:l(()=>[e(D,null,{default:l(()=>[e(fe,{label:s.value.formLabelNotes,variant:"outlined",modelValue:o.value.Notes,"onUpdate:modelValue":v[3]||(v[3]=U=>o.value.Notes=U)},null,8,["label","modelValue"])]),_:1})]),_:1}),e(A,null,{default:l(()=>[e(D,{cols:"12",sm:"6"},{default:l(()=>[e(F,{type:"number",label:s.value.formLabelMinimumCapacity,variant:"outlined",modelValue:o.value.MinimumCapacity,"onUpdate:modelValue":v[4]||(v[4]=U=>o.value.MinimumCapacity=U),modelModifiers:{number:!0}},null,8,["label","modelValue"])]),_:1}),e(D,{cols:"12",sm:"6"},{default:l(()=>[e(F,{type:"number",label:s.value.formLabelMaximumCapacity,variant:"outlined",modelValue:o.value.MaximumCapacity,"onUpdate:modelValue":v[5]||(v[5]=U=>o.value.MaximumCapacity=U),modelModifiers:{number:!0}},null,8,["label","modelValue"])]),_:1})]),_:1}),e(A,null,{default:l(()=>[e(D,null,{default:l(()=>[Ol]),_:1})]),_:1}),(p(!0),E($,null,K(o.value.Costs,(U,I)=>(p(),E($,{key:`venue-room-${o.value.ID}-cost-${U.ID}`},[o.value.Costs&&o.value.Costs[I]?(p(),y(Sl,{key:0,modelValue:o.value.Costs[I],"onUpdate:modelValue":x=>o.value.Costs[I]=x,onDeleted:x=>c(I)},null,8,["modelValue","onUpdate:modelValue","onDeleted"])):S("",!0)],64))),128)),e(N,{color:"primary","prepend-icon":"mdi:mdi-plus",onClick:i},{default:l(()=>[C("Add Row")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}}),ql=k("h3",null,"Rooms",-1),wl=P({__name:"Venue",props:{modelValue:{required:!0},modelModifiers:{}},emits:M(["deleted"],["update:modelValue"]),setup(_,{emit:r}){const a=G(),d=r,s=q(_,"modelValue"),u=g(Y(s.value)),o=g([]),n=g(!1),t=g(!1);a.getVenueRooms(u.value.VenueUUID).then(f=>{o.value=f}),W(u.value,()=>{t.value=!0});const i=({callback:f})=>{n.value=!0,a.saveVenue(u.value).then(()=>{n.value=!1,t.value=!1,s.value=u.value,f&&f("Venue Saved")}).catch(()=>{n.value=!1,f&&f("Failed to Saved Venue")})},c=({callback:f})=>{n.value=!0,a.deleteVenue(u.value.VenueUUID).then(v=>{n.value=!1,v?f&&(f("Venue Deleted"),d("deleted")):f&&f("Failed to Delete Venue")}).catch(()=>{f&&(f("Failed to Delete Venue"),n.value=!1)})},m=()=>{const f={ID:0,RoomUUID:w(),VenueID:u.value.ID,VenueUUID:u.value.VenueUUID,Order:o.value.length+1,Name:"New Room",Notes:"",MaximumCapacity:1,MinimumCapacity:1,Costs:[]};a.saveRoom(f).then(v=>{v&&o.value.push(v)})},V=(f,v)=>{a.deleteRoom(o.value[v].RoomUUID).then(U=>{U&&o.value.splice(v,1)})};return(f,v)=>(p(),y(ve,null,{default:l(()=>[e(ce,null,{default:l(()=>[C(R(u.value.Name),1)]),_:1}),e(pe,null,{default:l(()=>[e(A,{"no-gutters":""},{default:l(()=>[e(D,{cols:"12"},{default:l(()=>[e(F,{label:T(O).formLabelName,name:"name",variant:"outlined",modelValue:u.value.Name,"onUpdate:modelValue":v[0]||(v[0]=U=>u.value.Name=U)},null,8,["label","modelValue"])]),_:1}),e(D,{cols:"12"},{default:l(()=>[e(fe,{label:T(O).formLabelDescription,name:"description",variant:"outlined",modelValue:u.value.Description,"onUpdate:modelValue":v[1]||(v[1]=U=>u.value.Description=U)},null,8,["label","modelValue"])]),_:1}),e(D,{class:"text-right",cols:"12"},{default:l(()=>[e(Q,{class:"mr-2",color:"red-darken-3",label:"Delete",onClick:c}),e(Q,{enabled:t.value,timeout:"7",onClick:i},null,8,["enabled"])]),_:1})]),_:1}),ql,(p(!0),E($,null,K(o.value,(U,I)=>(p(),y(te,{variant:"elevation",elevation:"6",key:`venue-room-${U.ID}`},{default:l(()=>[o.value&&o.value[I]?(p(),y(Ml,{key:0,modelValue:o.value[I],"onUpdate:modelValue":x=>o.value[I]=x,onDeleted:x=>V(x,I)},null,8,["modelValue","onUpdate:modelValue","onDeleted"])):S("",!0)]),_:2},1024))),128)),e(te,{class:"ma-2"},{default:l(()=>[e(N,{color:"primary","prepend-icon":"mdi:mdi-plus",onClick:m},{default:l(()=>[C("Add Room")]),_:1})]),_:1})]),_:1})]),_:1}))}}),Ll=k("h3",null,"Venues",-1),Kl=k("p",null," Venues and the rooms they supply to the organisation, this is internal data not seen by attendees. ",-1),Gl=k("p",null," Attendee options are configured via the accommodation tab. ",-1),Bl=P({__name:"VenuesEditorView",props:{modelValue:{required:!0},modelModifiers:{}},emits:M(["close","pageTitle","refresh"],["update:modelValue"]),setup(_,{emit:r}){const a=G(),d=r,s=q(_,"modelValue");d("pageTitle","Venues");const u=g([]);a.getConventionVenues(s.value.ConventionUUID).then(t=>{u.value=t});const o=()=>{const t={ID:0,VenueUUID:w(),ConventionID:s.value.ID,ConventionUUID:s.value.ConventionUUID,Order:u.value.length+1,Name:"New Venue",Description:"",Rooms:[]};a.saveVenue(t).then(i=>{i&&u.value.push(i)})},n=t=>{u.value.splice(t,1)};return(t,i)=>(p(),E($,null,[e(j,{fluid:"",class:"px-0"},{default:l(()=>[e(A,null,{default:l(()=>[e(D,null,{default:l(()=>[Ll]),_:1})]),_:1})]),_:1}),Kl,Gl,e(te,null,{default:l(()=>[e(me,{variant:"accordion"},{default:l(()=>[(p(!0),E($,null,K(u.value,(c,m)=>(p(),y(wl,{key:`venues-${c.ID}`,modelValue:u.value[m],"onUpdate:modelValue":V=>u.value[m]=V,onDeleted:V=>n(m)},null,8,["modelValue","onUpdate:modelValue","onDeleted"]))),128))]),_:1}),e(te,{class:"pa-2"},{default:l(()=>[e(N,{color:"primary",onClick:o},{default:l(()=>[C("Add Venue")]),_:1})]),_:1})]),_:1})],64))}}),Yl=k("p",{title:"Automatically calculated",class:"text-grey-lighten-1"},"Applicable Tickets:",-1),Hl=P({__name:"AccommodationCost",props:M({convention:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:M(["deleted"],["update:modelValue"]),setup(_,{emit:r}){const a=r,d=q(_,"modelValue"),s=g([]);G().getConventionTickets(_.convention.ConventionUUID).then(i=>{i&&(s.value=i)});const o=[{title:"Per Room",value:"PER_ROOM"},{title:"Per Person",value:"PER_PERSON"}],n=()=>{a("deleted")},t=le(()=>s.value.filter(i=>(i.Type===L.TICKET_TYPE_TICKET||i.Type===L.TICKET_TYPE_ADD_ON)&&i.RequiresAccommodation&&i.DateStart===d.value.DateStart&&i.DateEnd===d.value.DateEnd));return(i,c)=>(p(),E($,null,[e(A,{class:"align-center",dense:""},{default:l(()=>[e(D,{class:"flex-grow-0 flex-shrink-1 text-no-wrap font-italic"},{default:l(()=>[Yl]),_:1}),e(D,{class:"flex-grow-1"},{default:l(()=>[e(we,null,{default:l(()=>[(p(!0),E($,null,K(t.value,m=>(p(),y(Le,{key:m.ID,title:"Automatically calculated",disabled:""},{default:l(()=>[C(R(m.Name),1)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1}),e(A,{dense:""},{default:l(()=>[e(D,{cols:"12",sm:"6",md:"3"},{default:l(()=>[e(F,{label:T(O).formLabelDateStart,type:"date",variant:"outlined",modelValue:d.value.DateStart,"onUpdate:modelValue":c[0]||(c[0]=m=>d.value.DateStart=m)},null,8,["label","modelValue"])]),_:1}),e(D,{cols:"12",sm:"6",md:"3"},{default:l(()=>[e(F,{label:T(O).formLabelDateEnd,type:"date",variant:"outlined",modelValue:d.value.DateEnd,"onUpdate:modelValue":c[1]||(c[1]=m=>d.value.DateEnd=m)},null,8,["label","modelValue"])]),_:1}),e(D,{cols:"5",sm:"6",md:"3"},{default:l(()=>[e(F,{label:T(O).formLabelPrice,type:"number","prepend-inner-icon":"mdi:mdi-currency-gbp",variant:"outlined",modelValue:d.value.Price,"onUpdate:modelValue":c[2]||(c[2]=m=>d.value.Price=m),modelModifiers:{number:!0}},null,8,["label","modelValue"])]),_:1}),e(D,{cols:"5",sm:"4",md:"2"},{default:l(()=>[e(de,{label:T(O).formLabelPriceType,variant:"outlined",modelValue:d.value.Type,"onUpdate:modelValue":c[3]||(c[3]=m=>d.value.Type=m),items:o,"item-value":"value","item-title":"title"},null,8,["label","modelValue"])]),_:1}),e(D,{cols:"2",sm:"2",md:"1",class:"text-right"},{default:l(()=>[e(N,{color:"red",icon:"mdi:mdi-minus",onClick:n})]),_:1})]),_:1})],64))}}),jl=k("h4",null," Room Pool ",-1),zl=k("p",{class:"mb-4"}," Hotel rooms that can be used for this accommodation option. ",-1),Jl=k("p",null," Pool total: ",-1),Xl=k("h4",null," Accommodation Costs ",-1),Wl=k("p",{class:"mb-4"}," How much the attendee is charged by the convention for the accommodation. ",-1),Zl=P({__name:"Accommodation",props:M({convention:{},venues:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:M(["deleted"],["update:modelValue"]),setup(_,{emit:r}){const a=G(),d=r,s=q(_,"modelValue"),u=g(Y(s.value)),o=le(()=>_.venues.map(m=>m.Rooms.map(V=>({title:` ${m.Name} - ${V.Name}`,value:V}))).flat()),n=()=>{u.value.Costs||(u.value.Costs=[]),u.value.Costs.push({ID:0,CostUUID:w(),Availability:0,DateStart:"",DateEnd:"",Price:0,Type:Ce.PER_ROOM})},t=m=>{u.value.Costs.splice(m,1)},i=({callback:m})=>{a.deleteAccommodation(u.value.AccommodationUUID).then(V=>{V?m&&(m("Accommodation Deleted"),d("deleted")):m&&m("Failed to Delete Accommodation")}).catch(()=>{m&&m("Failed to Delete Accommodation")})},c=({callback:m})=>{a.saveAccommodation(u.value).then(V=>{V?(u.value.ID=V.ID,s.value=V,m&&m("Accommodation Saved")):m&&m("Failed to Save Accommodation")}).catch(()=>{m&&m("Failed to Save Accommodation")})};return(m,V)=>(p(),y(ve,null,{default:l(()=>[e(ce,null,{default:l(()=>[C(R(u.value.Name),1)]),_:1}),e(pe,null,{default:l(()=>[e(te,null,{default:l(()=>[e(A,null,{default:l(()=>[e(D,null,{default:l(()=>[e(F,{modelValue:u.value.Name,"onUpdate:modelValue":V[0]||(V[0]=f=>u.value.Name=f),label:"Name",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1})]),_:1}),e(A,null,{default:l(()=>[e(D,null,{default:l(()=>[jl,zl,e(de,{clearable:!0,modelValue:u.value.Pool,"onUpdate:modelValue":V[1]||(V[1]=f=>u.value.Pool=f),items:o.value,label:"Select",multiple:"",hint:"Pick appropriate rooms","persistent-hint":"",variant:"outlined","item-title":"title","item-value":"value",eager:!0},null,8,["modelValue","items"]),Jl,k("p",null,[e(Z,{label:"Required Tags",variant:"outlined",modelValue:u.value.RequiredTags,"onUpdate:modelValue":V[2]||(V[2]=f=>u.value.RequiredTags=f),convention:m.convention,organisation:m.convention.OrganisationUUID,chips:!0,clearable:!0,hint:"Tags that a user must have to select this accommodation."},null,8,["modelValue","convention","organisation"])]),Xl,Wl,u.value.Costs?(p(!0),E($,{key:0},K(u.value.Costs,(f,v)=>(p(),y(Hl,{key:`venue-room-${u.value.ID}-cost-${f.ID}`,convention:m.convention,modelValue:u.value.Costs[v],"onUpdate:modelValue":U=>u.value.Costs[v]=U,onDeleted:U=>t(v)},null,8,["convention","modelValue","onUpdate:modelValue","onDeleted"]))),128)):S("",!0)]),_:1})]),_:1}),e(A,{"no-gutters":""},{default:l(()=>[e(D,{class:"text-left"},{default:l(()=>[e(N,{color:"primary","prepend-icon":"mdi:mdi-plus",onClick:n},{default:l(()=>[C("Add Row")]),_:1})]),_:1}),e(D,{class:"text-right"},{default:l(()=>[e(Q,{class:"mr-2",color:"red-darken-3",label:"Delete",onClick:i}),e(Q,{onClick:c})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}))}}),Ql=k("h3",null,"Accommodation",-1),et=k("p",null," Accommodation options presented to attendees, these are effectively virtual room types which are linked to the available room pools created in the venues tab. ",-1),lt=k("p",null," Use the venues tab to configure internal data about the venues and room supply. ",-1),tt=P({__name:"AccommodationEditorView",props:{modelValue:{required:!0},modelModifiers:{}},emits:["update:modelValue"],setup(_){const r=G(),a=q(_,"modelValue"),d=g([]),s=g([]);r.getConventionAccommodation(a.value.ConventionUUID).then(n=>{n&&(d.value=n)}),r.getConventionVenues(a.value.ConventionUUID).then(n=>{n&&(s.value=n)});const u=()=>{const n={ID:0,AccommodationUUID:w(),ConventionID:a.value.ID,ConventionUUID:a.value.ConventionUUID,Order:d.value.length+1,Name:"New Accommodation Option",Pool:[],Costs:[],RequiredTags:[]};r.saveAccommodation(n).then(t=>{t&&d.value.push(t)})},o=n=>{d.value.splice(n,1)};return(n,t)=>(p(),E($,null,[e(j,{fluid:!0,class:"px-0"},{default:l(()=>[e(A,null,{default:l(()=>[e(D,null,{default:l(()=>[Ql]),_:1})]),_:1})]),_:1}),et,lt,e(te,null,{default:l(()=>[e(me,{variant:"accordion"},{default:l(()=>[(p(!0),E($,null,K(d.value,(i,c)=>(p(),y(Zl,{key:i.AccommodationUUID,convention:a.value,venues:s.value,modelValue:d.value[c],"onUpdate:modelValue":m=>d.value[c]=m,onDeleted:m=>o(c)},null,8,["convention","venues","modelValue","onUpdate:modelValue","onDeleted"]))),128))]),_:1}),e(te,{class:"pa-2"},{default:l(()=>[e(N,{color:"primary",onClick:u},{default:l(()=>[C("Add Accommodation")]),_:1})]),_:1})]),_:1})],64))}}),at=P({__name:"EditFieldDialogExtras",props:{modelValue:{required:!0},modelModifiers:{}},emits:["update:modelValue"],setup(_){const r=q(_,"modelValue"),a=be.getInstance(),d=g([]),s=g([]);return a==null||a.getConventionExtras(r.value.ConventionUUID).then(u=>{d.value=u;const o=r.value.Values.find(n=>n.Title==="SelectedExtras");if(o)try{s.value=JSON.parse(o.Value)}catch{}}),W(s,()=>{const u=r.value.Values.find(o=>o.Title==="SelectedExtras");if(u)u.Value=JSON.stringify(s.value);else{const o={ID:0,FieldValueUUID:w(),FieldID:r.value.ID,FieldUUID:r.value.FieldUUID,Title:"SelectedExtras",Value:JSON.stringify(s.value)};r.value.Values.push(o)}}),(u,o)=>(p(!0),E($,null,K(d.value,n=>(p(),y(z,{key:n.ExtraUUID,modelValue:s.value,"onUpdate:modelValue":o[0]||(o[0]=t=>s.value=t),label:n.Name,value:n.ExtraUUID,name:r.value.Name,"hide-details":""},null,8,["modelValue","label","value","name"]))),128))}}),ot=P({__name:"EditFieldDialogInterests",props:{modelValue:{required:!0},modelModifiers:{}},emits:["update:modelValue"],setup(_){const r=q(_,"modelValue"),a=be.getInstance(),d=g([]),s=g([]);return a==null||a.getConventionInterests(r.value.ConventionUUID).then(u=>{d.value=u;const o=r.value.Values.find(n=>n.Title==="SelectedInterests");if(o)try{s.value=JSON.parse(o.Value)}catch{}}),W(s,()=>{const u=r.value.Values.find(o=>o.Title==="SelectedInterests");if(u)u.Value=JSON.stringify(s.value);else{const o={ID:0,FieldValueUUID:w(),FieldID:r.value.ID,FieldUUID:r.value.FieldUUID,Title:"SelectedInterests",Value:JSON.stringify(s.value)};r.value.Values.push(o)}}),(u,o)=>(p(!0),E($,null,K(d.value,n=>(p(),y(z,{key:n.InterestUUID,modelValue:s.value,"onUpdate:modelValue":o[0]||(o[0]=t=>s.value=t),label:n.Name,value:n.InterestUUID,name:r.value.Name,"hide-details":""},null,8,["modelValue","label","value","name"]))),128))}}),nt=P({__name:"EditFieldDialogTickets",props:{modelValue:{required:!0},modelModifiers:{}},emits:["update:modelValue"],setup(_){const r=q(_,"modelValue"),a=be.getInstance(),d=g([]),s=g([]);return a==null||a.getConventionTickets(r.value.ConventionUUID).then(u=>{d.value=u;const o=r.value.Values.find(n=>n.Title==="SelectedTickets");if(o)try{s.value=JSON.parse(o.Value)}catch{}}),W(s,()=>{const u=r.value.Values.find(o=>o.Title==="SelectedTickets");if(u)u.Value=JSON.stringify(s.value);else{const o={ID:0,FieldValueUUID:w(),FieldID:r.value.ID,FieldUUID:r.value.FieldUUID,Title:"SelectedTickets",Value:JSON.stringify(s.value)};r.value.Values.push(o)}}),(u,o)=>(p(!0),E($,null,K(d.value.filter(n=>n&&n.Type===T(L).TICKET_TYPE_GROUP),n=>(p(),y(z,{key:n.TicketUUID,modelValue:s.value,"onUpdate:modelValue":o[0]||(o[0]=t=>s.value=t),label:n.Name,value:n.TicketUUID,name:r.value.Name,"hide-details":""},null,8,["modelValue","label","value","name"]))),128))}}),ut=k("h5",null,"Display Options",-1),it=k("h5",null,"Accommodation Choices",-1),dt=P({__name:"EditFieldDialogAccommodation",props:{modelValue:{required:!0},modelModifiers:{}},emits:["update:modelValue"],setup(_){const r=q(_,"modelValue"),a=be.getInstance(),d=g([]),s=g(r.value.Values.map(n=>n.Value)),u=g({sharing:!1});try{const n=JSON.parse(r.value.Data);n&&(u.value=n)}catch{}const o=()=>{r.value.Data=JSON.stringify(u.value),r.value.Values=s.value.map(n=>{var t,i,c;return{ID:0,FieldValueUUID:w(),FieldID:((t=r.value)==null?void 0:t.ID)||0,FieldUUID:((i=r.value)==null?void 0:i.FieldUUID)||"",Title:((c=d.value.find(m=>m.AccommodationUUID==n))==null?void 0:c.Name)||"",Value:n}})};return a==null||a.getConventionAccommodation(r.value.ConventionUUID).then(n=>{n&&(d.value=n)}),(n,t)=>(p(),E($,null,[ut,e(z,{label:"Show Sharing Options",modelValue:u.value.sharing,"onUpdate:modelValue":t[0]||(t[0]=i=>u.value.sharing=i),"hide-details":"",onChange:o},null,8,["modelValue"]),it,(p(!0),E($,null,K(d.value,i=>(p(),y(z,{key:i.ID,modelValue:s.value,"onUpdate:modelValue":t[1]||(t[1]=c=>s.value=c),label:i.Name,value:i.AccommodationUUID,"hide-details":"",onChange:o},null,8,["modelValue","label","value"]))),128))],64))}}),st=P({__name:"EditFieldDialogAge",props:M({convention:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(_){var c,m,V;const r=q(_,"modelValue"),a=new Date,d=a.getFullYear(),s=(a.getMonth()+1).toLocaleString(navigator.language,{minimumIntegerDigits:2}),u=a.getDate().toLocaleString(navigator.language,{minimumIntegerDigits:2}),o=g(parseInt(((c=r.value.Values.find(f=>f.Title==="MIN_AGE"))==null?void 0:c.Value)||"18")),n=g(((m=r.value.Values.find(f=>f.Title==="BEFORE_DATE"))==null?void 0:m.Value)||`${d}-${s}-${u}`),t=g(((V=r.value.Values.find(f=>f.Title==="UNDER_AGE_APPLY_TAG"))==null?void 0:V.Value)||""),i=()=>{var f,v,U,I,x,h;r.value.Values=[{ID:0,FieldValueUUID:w(),FieldID:((f=r.value)==null?void 0:f.ID)||0,FieldUUID:((v=r.value)==null?void 0:v.FieldUUID)||"",Title:"MIN_AGE",Value:o.value.toString()},{ID:0,FieldValueUUID:w(),FieldID:((U=r.value)==null?void 0:U.ID)||0,FieldUUID:((I=r.value)==null?void 0:I.FieldUUID)||"",Title:"BEFORE_DATE",Value:n.value},{ID:0,FieldValueUUID:w(),FieldID:((x=r.value)==null?void 0:x.ID)||0,FieldUUID:((h=r.value)==null?void 0:h.FieldUUID)||"",Title:"UNDER_AGE_APPLY_TAG",Value:t.value}]};return i(),(f,v)=>(p(),y(j,{class:"pl-0 pr-0",fluid:!0},{default:l(()=>[e(A,null,{default:l(()=>[e(D,{cols:"12",sm:"6"},{default:l(()=>[e(F,{modelValue:o.value,"onUpdate:modelValue":v[0]||(v[0]=U=>o.value=U),modelModifiers:{number:!0},type:"number",label:"Minimum Age",variant:"outlined",onChange:i},null,8,["modelValue"])]),_:1}),e(D,{cols:"12",sm:"6"},{default:l(()=>[e(F,{modelValue:n.value,"onUpdate:modelValue":v[1]||(v[1]=U=>n.value=U),type:"date",label:"Date to attain minimum age by",variant:"outlined",onChange:i},null,8,["modelValue"])]),_:1})]),_:1}),e(A,null,{default:l(()=>[e(D,null,{default:l(()=>[e(Z,{modelValue:t.value,"onUpdate:modelValue":v[2]||(v[2]=U=>t.value=U),convention:f.convention,chips:!0,clearable:!0,variant:"outlined",label:`Tags applied to users under ${o.value} at time of data entry`,onChange:i},null,8,["modelValue","convention","label"])]),_:1})]),_:1})]),_:1}))}}),rt=P({__name:"EditFieldDialogHTML",props:{modelValue:{required:!0},modelModifiers:{}},emits:["update:modelValue"],setup(_){const r=q(_,"modelValue"),a=g({html:""});try{const s=JSON.parse(r.value.Data);s&&(a.value=s)}catch{}const d=()=>{r.value.Data=JSON.stringify(a.value)};return(s,u)=>(p(),y(fe,{variant:"outlined",label:"Raw HTML",modelValue:a.value.html,"onUpdate:modelValue":u[0]||(u[0]=o=>a.value.html=o),onKeydown:d,onChange:d},null,8,["modelValue"]))}}),mt=k("h5",{class:"my-2"},"Tags & Labels",-1),vt=k("h5",{class:"my-2"},"Dimensions",-1),ct=k("h5",{class:"my-2"},"Limits",-1),pt=k("h5",{class:"my-2"},"Costs",-1),ft=P({__name:"EditFieldDialogBadgeImage",props:{modelValue:{required:!0},modelModifiers:{}},emits:["update:modelValue"],setup(_){const r=q(_,"modelValue"),a=g({charge:0,free:0,height:0,label:!1,maximum:0,tags:[],width:0});try{a.value=je(r.value.Data)}catch{}const d=()=>{r.value.Data=JSON.stringify(a.value)};return(s,u)=>(p(),E($,null,[mt,e(A,null,{default:l(()=>[e(D,{cols:"12",sm:"6",md:"4"},{default:l(()=>[e(Z,{label:"Badge Tags",variant:"outlined",modelValue:a.value.tags,"onUpdate:modelValue":u[0]||(u[0]=o=>a.value.tags=o),convention:r.value.ConventionUUID,chips:"",clearable:"",hint:"Tags that apply to this badge.","input-type":T(Je).UUID_ARRAY,onChange:d},null,8,["modelValue","convention","input-type"])]),_:1}),e(D,{cols:"12",sm:"6",md:"4"},{default:l(()=>[e(z,{modelValue:a.value.label,"onUpdate:modelValue":u[1]||(u[1]=o=>a.value.label=o),label:"Allow Custom Label",variant:"outlined","hide-details":"",onChange:d},null,8,["modelValue"])]),_:1})]),_:1}),vt,e(A,null,{default:l(()=>[e(D,{cols:"12",sm:"6",md:"4"},{default:l(()=>[e(F,{modelValue:a.value.width,"onUpdate:modelValue":u[2]||(u[2]=o=>a.value.width=o),modelModifiers:{number:!0},label:"Width",variant:"outlined","hide-details":"",type:"number",step:"10",min:"0",onChange:d},null,8,["modelValue"])]),_:1}),e(D,{cols:"12",sm:"6",md:"4"},{default:l(()=>[e(F,{modelValue:a.value.height,"onUpdate:modelValue":u[3]||(u[3]=o=>a.value.height=o),modelModifiers:{number:!0},label:"Height",variant:"outlined","hide-details":"",type:"number",step:"10",min:"0",onChange:d},null,8,["modelValue"])]),_:1})]),_:1}),ct,e(A,null,{default:l(()=>[e(D,{cols:"12",sm:"6",md:"4"},{default:l(()=>[e(F,{modelValue:a.value.maximum,"onUpdate:modelValue":u[4]||(u[4]=o=>a.value.maximum=o),modelModifiers:{number:!0},label:"Maximum Badges",hint:"Zero = Unlimited",variant:"outlined",type:"number",min:"0",onChange:d},null,8,["modelValue"])]),_:1})]),_:1}),pt,e(A,null,{default:l(()=>[e(D,{cols:"12",sm:"6",md:"4"},{default:l(()=>[e(F,{modelValue:a.value.charge,"onUpdate:modelValue":u[5]||(u[5]=o=>a.value.charge=o),modelModifiers:{number:!0},label:"Charge Per Badge",prefix:T(O).currencySymbol,variant:"outlined","hide-details":"",type:"number",min:"0",onChange:d},null,8,["modelValue","prefix"])]),_:1}),e(D,{cols:"12",sm:"6",md:"4"},{default:l(()=>[e(F,{modelValue:a.value.free,"onUpdate:modelValue":u[6]||(u[6]=o=>a.value.free=o),modelModifiers:{number:!0},label:"Free Badges",variant:"outlined","hide-details":"",type:"number",min:"0",onChange:d},null,8,["modelValue"])]),_:1})]),_:1})],64))}}),Vt=k("h4",null,"Badge Image Options",-1),Ut={key:0},Tt={key:1},Dt=k("h4",null,"Accommodation",-1),_t=k("h4",null,"Age",-1),It=k("h4",null,"Additional Purchases",-1),yt=k("h4",null,"Available Interests",-1),gt=k("h4",null,"Tickets",-1),Ct=k("h4",{class:"mb-3"},"Field Preview",-1),bt=P({__name:"EditFieldDialog",props:M({convention:{},field:{},title:{}},{modelValue:{type:Boolean,required:!0},modelModifiers:{}}),emits:M(["update:field"],["update:modelValue"]),setup(_,{emit:r}){const a=_,{convention:d,title:s=""}=a,u=r,o=q(_,"modelValue"),n=Ve(a,u,void 0,void 0,"field"),t=g(Y(n.value)),i=g(""),c=g(t.value.Type);W(n,()=>{t.value=Y(n.value)});const m=()=>{o.value=!1},V=()=>{t.value=Y(n.value)},f=()=>{n.value=t.value},v=()=>{t.value.Values.push({ID:0,FieldValueUUID:w(),FieldID:t.value.ID,FieldUUID:t.value.FieldUUID,Title:"",Value:""})},U=x=>{t.value.Values.splice(x,1)},I=()=>{i.value="",t.value.Values=[]};return W(c,(x,h)=>{x!==h&&(t.value.Type=x,I())}),(x,h)=>(p(),y(Ne,{modelValue:o.value,"onUpdate:modelValue":h[16]||(h[16]=b=>o.value=b),onReset:V,onSave:f,title:T(s),color:"primary",persistent:!0,fullscreen:!0},{default:l(()=>[e(j,{class:"pa-0",fluid:!0},{default:l(()=>[e(A,null,{default:l(()=>[e(D,{cols:"12"},{default:l(()=>[e(j,{class:"pa-0",fluid:!0},{default:l(()=>[e(A,null,{default:l(()=>[e(D,{cols:"12",sm:"6",md:"4"},{default:l(()=>[e(F,{modelValue:t.value.Name,"onUpdate:modelValue":h[0]||(h[0]=b=>t.value.Name=b),label:"Internal name",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),e(D,{cols:"12",sm:"6",md:"4"},{default:l(()=>[e(F,{modelValue:t.value.Label,"onUpdate:modelValue":h[1]||(h[1]=b=>t.value.Label=b),label:"Label",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),e(D,{cols:"12",sm:"6",md:"4"},{default:l(()=>[e(F,{modelValue:t.value.Hint,"onUpdate:modelValue":h[2]||(h[2]=b=>t.value.Hint=b),label:"Hint",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),e(D,{cols:"12",sm:"6",md:"4"},{default:l(()=>[e(F,{modelValue:t.value.Placeholder,"onUpdate:modelValue":h[3]||(h[3]=b=>t.value.Placeholder=b),label:"Placeholder",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),e(D,{cols:"12",sm:"6",md:"4"},{default:l(()=>[e(de,{modelValue:c.value,"onUpdate:modelValue":h[4]||(h[4]=b=>c.value=b),label:"Type",variant:"outlined",items:T(xe),"hide-details":""},null,8,["modelValue","items"])]),_:1}),t.value.Type===T(B).SELECT||t.value.Type===T(B).CHECKBOX||t.value.Type===T(B).BADGE_IMAGE?(p(),y(D,{key:0,cols:"12",sm:"6",md:"4",class:"py-0"},{default:l(()=>[t.value.Type===T(B).SELECT||t.value.Type===T(B).CHECKBOX?(p(),y(z,{key:0,modelValue:t.value.Multiple,"onUpdate:modelValue":h[5]||(h[5]=b=>t.value.Multiple=b),label:"Multiple Items",hint:"Can select multiple items from list","hide-details":"",density:"compact"},null,8,["modelValue"])):t.value.Type===T(B).BADGE_IMAGE?(p(),y(z,{key:1,modelValue:t.value.Multiple,"onUpdate:modelValue":h[6]||(h[6]=b=>t.value.Multiple=b),label:"Custom Fields",hint:"Enable additional badge fields","hide-details":""},null,8,["modelValue"])):S("",!0),t.value.Type===T(B).SELECT?(p(),y(z,{key:2,modelValue:t.value.Autofill,"onUpdate:modelValue":h[7]||(h[7]=b=>t.value.Autofill=b),label:"Searchable List","hide-details":"",density:"compact"},null,8,["modelValue"])):S("",!0)]),_:1})):S("",!0)]),_:1}),t.value.Type===T(B).BADGE_IMAGE?(p(),y(A,{key:0},{default:l(()=>[e(D,null,{default:l(()=>[Vt,e(ft,{modelValue:t.value,"onUpdate:modelValue":h[8]||(h[8]=b=>t.value=b)},null,8,["modelValue"])]),_:1})]),_:1})):S("",!0),t.value.Type===T(B).SELECT||t.value.Type===T(B).CHECKBOX&&t.value.Multiple||t.value.Type===T(B).RADIO||t.value.Type===T(B).BADGE_IMAGE&&t.value.Multiple?(p(),y(A,{key:1},{default:l(()=>[e(D,null,{default:l(()=>[t.value.Type===T(B).BADGE_IMAGE?(p(),E("h4",Ut,"Custom Fields")):(p(),E("h4",Tt,"Values")),e(j,{fluid:!0,class:"px-0"},{default:l(()=>[(p(!0),E($,null,K(t.value.Values,(b,J)=>(p(),y(A,{key:b.ID},{default:l(()=>[e(D,{cols:"12",sm:"5",md:"6"},{default:l(()=>[e(F,{modelValue:b.Title,"onUpdate:modelValue":H=>b.Title=H,label:"Display",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(D,{cols:"9",sm:"5",md:"5"},{default:l(()=>[e(F,{modelValue:b.Value,"onUpdate:modelValue":H=>b.Value=H,label:"Internal Value",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(D,{cols:"3",sm:"2",md:"1",class:"d-flex align-center"},{default:l(()=>[e(N,{icon:"mdi:mdi-window-close",size:"small",color:"red",onClick:H=>U(J)},null,8,["onClick"])]),_:2},1024)]),_:2},1024))),128)),e(A,null,{default:l(()=>[e(D,null,{default:l(()=>[e(N,{"prepend-icon":"mdi:mdi-plus",color:"primary",onClick:v},{default:l(()=>[C("Add Item")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})):t.value.Type===T(B).ACCOMMODATION?(p(),y(A,{key:2},{default:l(()=>[e(D,null,{default:l(()=>[Dt,e(dt,{modelValue:t.value,"onUpdate:modelValue":h[9]||(h[9]=b=>t.value=b)},null,8,["modelValue"])]),_:1})]),_:1})):t.value.Type===T(B).AGE?(p(),y(A,{key:3},{default:l(()=>[e(D,null,{default:l(()=>[_t,e(st,{modelValue:t.value,"onUpdate:modelValue":h[10]||(h[10]=b=>t.value=b),convention:T(d)},null,8,["modelValue","convention"])]),_:1})]),_:1})):t.value.Type===T(B).EXTRAS?(p(),y(A,{key:4},{default:l(()=>[e(D,null,{default:l(()=>[It,e(at,{modelValue:t.value,"onUpdate:modelValue":h[11]||(h[11]=b=>t.value=b)},null,8,["modelValue"])]),_:1})]),_:1})):t.value.Type===T(B).HTML?(p(),y(A,{key:5},{default:l(()=>[e(D,null,{default:l(()=>[e(rt,{modelValue:t.value,"onUpdate:modelValue":h[12]||(h[12]=b=>t.value=b)},null,8,["modelValue"])]),_:1})]),_:1})):t.value.Type===T(B).INTERESTS?(p(),y(A,{key:6},{default:l(()=>[e(D,null,{default:l(()=>[yt,e(ot,{modelValue:t.value,"onUpdate:modelValue":h[13]||(h[13]=b=>t.value=b)},null,8,["modelValue"])]),_:1})]),_:1})):t.value.Type===T(B).TICKET?(p(),y(A,{key:7},{default:l(()=>[e(D,null,{default:l(()=>[gt,e(nt,{modelValue:t.value,"onUpdate:modelValue":h[14]||(h[14]=b=>t.value=b)},null,8,["modelValue"])]),_:1})]),_:1})):S("",!0)]),_:1})]),_:1}),e(D,{cols:"12"},{default:l(()=>[e(te,{elevation:"5",class:"pa-2",color:"text-center"},{default:l(()=>[Ct,e(Pe,{admin:!0,field:t.value,convention:T(d),modelValue:i.value,"onUpdate:modelValue":h[15]||(h[15]=b=>i.value=b)},null,8,["field","convention","modelValue"])]),_:1})]),_:1})]),_:1})]),_:1})]),actions:l(()=>[e(N,{color:"blue-darken-1",variant:"text",onClick:m},{default:l(()=>[C(" Cancel ")]),_:1}),e(N,{color:"blue-darken-1",variant:"text",onClick:V},{default:l(()=>[C(" Reset ")]),_:1}),e(ae),e(N,{color:"blue-darken-1",variant:"text",onClick:f},{default:l(()=>[C(" Save ")]),_:1})]),_:1},8,["modelValue","title"]))}}),Et=P({__name:"FieldEditor",props:{modelValue:{required:!0},modelModifiers:{}},emits:M(["refresh"],["update:modelValue"]),setup(_){const r=q(_,"modelValue"),a=G(),d=g(!1),s=g(!1),u=g([{key:"Label",title:"Label",align:"start",sortable:!0},{key:"Name",title:"Internal Name",align:"start",sortable:!0},{key:"Type",title:"Type",align:"start",sortable:!0},{key:"actions",title:"Actions",sortable:!1}]),o=g([]);a.getConventionFields(r.value.ConventionUUID).then(b=>{b&&(o.value=b)});const n=g(-1),t=g({ID:0,FieldUUID:w(),ConventionID:r.value.ID,ConventionUUID:r.value.ConventionUUID,Autofill:!1,Hint:"",Label:"",Multiple:!1,Name:"",Placeholder:"",Type:"TEXT",Values:[],Data:""}),i=le(()=>n.value===-1?"New Field":"Edit Field"),c=()=>({ID:0,FieldUUID:w(),ConventionID:r.value.ID,ConventionUUID:r.value.ConventionUUID,Autofill:!1,Hint:"",Label:"",Multiple:!1,Name:"",Placeholder:"",Type:"TEXT",Values:[],Data:""}),m=g(c()),V=()=>{m.value.FieldUUID=w(),t.value=Object.assign({},c()),n.value=-1,d.value=!0},f=b=>{n.value=o.value.indexOf(b),t.value=Object.assign({},b),d.value=!0},v=b=>{n.value=o.value.indexOf(b),t.value=Object.assign({},b),s.value=!0},U=()=>{a.deleteField(t.value.FieldUUID).then(b=>{b&&(o.value.splice(n.value,1),x())})},I=()=>{d.value=!1,ye(()=>{t.value=Object.assign({},m.value),n.value=-1})},x=()=>{s.value=!1,ye(()=>{t.value=Object.assign({},m.value),n.value=-1})},h=()=>{a.saveField(t.value).then(b=>{b&&(n.value>-1?Object.assign(o.value[n.value],b):o.value.push(b),I())})};return(b,J)=>(p(),y(qe,{headers:u.value,items:o.value,"sort-by":[{key:"calories",order:"asc"}],class:"elevation-1"},{top:l(()=>[e(ne,{color:"primary"},{default:l(()=>[e(ie,null,{default:l(()=>[C("Field Editor")]),_:1}),e(Ge,{class:"mx-4",inset:!0,vertical:!0}),e(ae),e(N,{dark:"",class:"mb-2","prepend-icon":"mdi:mdi-pencil",onClick:V},{default:l(()=>[C(" New Item ")]),_:1}),e(Ke,{modelValue:s.value,"onUpdate:modelValue":J[0]||(J[0]=H=>s.value=H),onDelete:U},null,8,["modelValue"])]),_:1}),d.value?(p(),y(bt,{key:0,modelValue:d.value,"onUpdate:modelValue":J[1]||(J[1]=H=>d.value=H),field:t.value,"onUpdate:field":[J[2]||(J[2]=H=>t.value=H),h],title:i.value,convention:r.value},null,8,["modelValue","field","title","convention"])):S("",!0)]),"item.actions":l(({item:H})=>[e(X,{size:"small",class:"me-2",onClick:Be=>f(H)},{default:l(()=>[C(" mdi:mdi-pencil ")]),_:2},1032,["onClick"]),e(X,{size:"small",onClick:Be=>v(H)},{default:l(()=>[C(" mdi:mdi-delete ")]),_:2},1032,["onClick"])]),_:1},8,["headers","items"]))}}),kt=(_,r)=>{const a=Ve(_,r),d=Ve(_,r,void 0,void 0,"item"),s=g(Y(d.value));return W(d,()=>{s.value=Y(d.value)}),{state:a,model:d,close:()=>{a.value=!1},reset:()=>{d.value=Y(s.value)},save:()=>{r("save")}}},ht=P({__name:"EditItemDialog",props:{item:{},modelValue:{type:Boolean},title:{},cardClass:{}},emits:["update:modelValue","update:item","save"],setup(_,{emit:r}){const a=_,d=r,{state:s,model:u,close:o,reset:n,save:t}=kt(a,d);return(i,c)=>(p(),y(Ne,{modelValue:T(s),"onUpdate:modelValue":c[0]||(c[0]=m=>Ie(s)?s.value=m:null),onReset:T(n),onSave:T(t),title:i.title,color:"primary","card-class":i.cardClass,fullscreen:!0,persistent:!0},{toolbarButtons:l(()=>[he(i.$slots,"toolbarButtons")]),actions:l(()=>[e(N,{color:"blue-darken-1",variant:"text",onClick:T(o)},{default:l(()=>[C(" Cancel ")]),_:1},8,["onClick"]),e(N,{color:"blue-darken-1",variant:"text",onClick:T(n)},{default:l(()=>[C(" Reset ")]),_:1},8,["onClick"]),e(ae),e(N,{color:"blue-darken-1",variant:"text",onClick:T(t)},{default:l(()=>[C(" Save ")]),_:1},8,["onClick"])]),default:l(()=>[he(i.$slots,"default")]),_:3},8,["modelValue","onReset","onSave","title","card-class"]))}}),$t={class:"pa-0 border-0 ma-0"},At=k("legend",{class:"mb-2"},"Field Settings",-1),Ft={class:"pa-0 border-0 ma-0"},Nt=k("legend",{class:"text-blue-accent-2 mb-2"},"Field Preview",-1),St=P({__name:"EditFormField",props:M({convention:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(_){const r=q(_,"modelValue"),a=G(),d=g([]),s=g([]),u=g(""),o=n=>{var t;r.value.Field=(t=s.value.find(i=>i.value===n))==null?void 0:t.field};return a.getConventionFields(_.convention.ConventionUUID).then(n=>{n&&(d.value=n,s.value=n.map(t=>({title:`${t.Label} (${(xe.find(i=>i.value===t.Type)||{title:""}).title})`,value:t.FieldUUID,field:t})),o(r.value.FieldUUID))}),(n,t)=>(p(),y(A,null,{default:l(()=>[e(D,{cols:"12",md:"6"},{default:l(()=>[k("fieldset",$t,[At,e(A,null,{default:l(()=>[e(D,{cols:"12"},{default:l(()=>[e(de,{modelValue:r.value.FieldUUID,"onUpdate:modelValue":[t[0]||(t[0]=i=>r.value.FieldUUID=i),o],items:s.value,"item-title":"title","item-value":"value",label:"Field",variant:"outlined","hide-details":""},null,8,["modelValue","items"])]),_:1}),e(D,{cols:"6",sm:"4"},{default:l(()=>[e(F,{modelValue:r.value.MinLength,"onUpdate:modelValue":t[1]||(t[1]=i=>r.value.MinLength=i),modelModifiers:{number:!0},label:"Min Length",type:"number",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),e(D,{cols:"6",sm:"4"},{default:l(()=>[e(F,{modelValue:r.value.MaxLength,"onUpdate:modelValue":t[2]||(t[2]=i=>r.value.MaxLength=i),modelModifiers:{number:!0},label:"Max Length",type:"number",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),e(D,{cols:"12",sm:"4"},{default:l(()=>[e(z,{modelValue:r.value.Required,"onUpdate:modelValue":t[3]||(t[3]=i=>r.value.Required=i),modelModifiers:{boolean:!0},label:"Required","hide-details":""},null,8,["modelValue"])]),_:1})]),_:1})])]),_:1}),r.value.FieldUUID&&r.value.Field?(p(),y(D,{key:0,cols:"12",md:"6"},{default:l(()=>[k("fieldset",Ft,[Nt,r.value.Field?(p(),y(Pe,{key:0,admin:!0,field:r.value.Field,"persistent-hint":!0,required:r.value.Required,convention:n.convention,modelValue:u.value,"onUpdate:modelValue":t[4]||(t[4]=i=>u.value=i)},null,8,["field","required","convention","modelValue"])):S("",!0)])]),_:1})):S("",!0)]),_:1}))}}),Rt={class:"d-none d-sm-block"},xt=P({__name:"EditFormSectionFields",props:M({convention:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(_){const r=q(_,"modelValue"),a=()=>{var d;return{ID:0,SectionFieldUUID:w(),SectionID:r.value.ID,SectionUUID:r.value.SectionUUID,FieldID:0,FieldUUID:"",Order:(((d=r.value.Fields)==null?void 0:d.length)||0)+1,MinLength:0,MaxLength:0,Required:!1,Value:""}};return(d,s)=>r.value.Fields!==void 0?(p(),y(Oe,{key:0,modelValue:r.value.Fields,"onUpdate:modelValue":s[0]||(s[0]=u=>r.value.Fields=u),closeable:!1,title:"Fields","new-item":a,class:"mt-4",label:"name","label-parent":"Field","slot-name-prefix":"field"},Se({_:2},[K(r.value.Fields,(u,o)=>({name:`field_${o}_title`,fn:l(()=>[u.Field?(p(),E($,{key:0},[C(R(u.Field.Label)+" ("+R(u.Field.Name)+") ",1),k("template",Rt,[C("  ["+R(u.Field.Type)+"] ",1)])],64)):(p(),E($,{key:1},[C("New Field")],64))])})),K(r.value.Fields,(u,o)=>({name:`field_${o}`,fn:l(()=>[e(St,{modelValue:r.value.Fields[o],"onUpdate:modelValue":n=>r.value.Fields[o]=n,convention:d.convention,style:{margin:"0 -24px"}},null,8,["modelValue","onUpdate:modelValue","convention"])])}))]),1032,["modelValue"])):S("",!0)}}),Pt=P({__name:"EditFormSections",props:M({convention:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(_){const r=q(_,"modelValue"),a=()=>{const d={ID:0,SectionUUID:w(),FormID:r.value.ID,FormUUID:r.value.FormUUID,Order:0,Name:"New Section",Heading:"",Description:"",Fields:[],DefaultValue:"",State:{ID:0,SectionStateUUID:w(),SectionID:0,SectionUUID:"",Edit:!0}};return d.State.SectionID=d.ID,d.State.SectionUUID=d.SectionUUID,d};return(d,s)=>(p(),y(Oe,{modelValue:r.value.Sections,"onUpdate:modelValue":s[0]||(s[0]=u=>r.value.Sections=u),"new-item":a,closeable:!1,title:"Sections","slot-name-prefix":"section"},Se({_:2},[K(r.value.Sections,(u,o)=>({name:`section_${o}`,fn:l(()=>[e(A,null,{default:l(()=>[e(D,{cols:"12",sm:"6"},{default:l(()=>[e(F,{modelValue:u.Name,"onUpdate:modelValue":n=>u.Name=n,label:"Internal Name",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(D,{cols:"12",sm:"6"},{default:l(()=>[e(F,{modelValue:u.Heading,"onUpdate:modelValue":n=>u.Heading=n,label:"Section Heading",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024),e(A,null,{default:l(()=>[e(D,{cols:"12"},{default:l(()=>[e(fe,{modelValue:u.Description,"onUpdate:modelValue":n=>u.Description=n,label:"Section Text",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024),u.Fields?(p(),y(xt,{key:0,modelValue:r.value.Sections[o],"onUpdate:modelValue":n=>r.value.Sections[o]=n,convention:d.convention},null,8,["modelValue","onUpdate:modelValue","convention"])):S("",!0)])}))]),1032,["modelValue"]))}}),Ot=P({__name:"FormRendererPopup",props:M({admin:{type:Boolean},convention:{},form:{},title:{},cardClass:{},preview:{type:Boolean}},{modelValue:{type:Boolean,required:!0},modelModifiers:{}}),emits:M(["update:form"],["update:modelValue"]),setup(_,{emit:r}){const a=_,{admin:d=!1,convention:s,title:u="",cardClass:o=""}=a,n=r,t=q(_,"modelValue"),i=Ve(a,n,void 0,void 0,"form"),c=g(Y(i.value));W(i,()=>{c.value=Y(i.value)});const m=()=>{t.value=!1};return(V,f)=>(p(),y(Ne,{modelValue:t.value,"onUpdate:modelValue":f[1]||(f[1]=v=>t.value=v),title:T(u),color:"primary","card-class":T(o)},{toolbarButtons:l(()=>[he(V.$slots,"toolbarButtons")]),actions:l(()=>[e(N,{color:"blue-darken-1",variant:"text",onClick:m},{default:l(()=>[C(" Close ")]),_:1})]),default:l(()=>[e(ze,{modelValue:c.value,"onUpdate:modelValue":f[0]||(f[0]=v=>c.value=v),admin:T(d),convention:T(s),preview:V.preview},null,8,["modelValue","admin","convention","preview"])]),_:3},8,["modelValue","title","card-class"]))}}),Mt=k("template",{class:"d-none d-sm-inline"},[C("Preview")],-1),qt=P({__name:"EditFormDialog",props:M({convention:{},form:{}},{modelValue:{type:Boolean,required:!0},modelModifiers:{}}),emits:M(["update:form"],["update:modelValue"]),setup(_,{emit:r}){const a=_,{convention:d}=a,s=q(_,"modelValue"),u=r,o=G(),n=Ve(a,u,void 0,void 0,"form"),t=g(!1),i=g(Y(n.value));W(n,()=>{i.value=Y(n.value)});const c=()=>{o.saveForm(i.value).then(V=>{V&&(n.value=V,s.value=!1)})},m=()=>{t.value=!0};return(V,f)=>(p(),y(ht,{modelValue:s.value,"onUpdate:modelValue":f[14]||(f[14]=v=>s.value=v),item:i.value,"onUpdate:item":f[15]||(f[15]=v=>i.value=v),onSave:c,"card-class":"pa-0"},{toolbarButtons:l(()=>[e(ll,null,{default:l(()=>[e(N,{"prepend-icon":"mdi:mdi-developer-board",onClick:m},{default:l(()=>[Mt]),_:1})]),_:1})]),default:l(()=>[e(me,null,{default:l(()=>[e(ve,{class:"mt-0"},{default:l(()=>[e(ce,null,{default:l(()=>[C("General Settings")]),_:1}),e(pe,null,{default:l(()=>[e(A,null,{default:l(()=>[e(D,{cols:"12"},{default:l(()=>[e(j,{class:"pa-0",fluid:!0},{default:l(()=>[e(A,null,{default:l(()=>[e(D,{cols:"12",sm:"6"},{default:l(()=>[e(F,{modelValue:i.value.Name,"onUpdate:modelValue":f[0]||(f[0]=v=>i.value.Name=v),label:"Internal name",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),e(D,{cols:"12",sm:"6"},{default:l(()=>[e(F,{modelValue:i.value.Heading,"onUpdate:modelValue":f[1]||(f[1]=v=>i.value.Heading=v),label:"Form Heading",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),e(D,{cols:"12"},{default:l(()=>[e(fe,{modelValue:i.value.Description,"onUpdate:modelValue":f[2]||(f[2]=v=>i.value.Description=v),label:"Pre-form Text",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),e(D,{cols:"12",sm:"6"},{default:l(()=>[e(de,{modelValue:i.value.Type,"onUpdate:modelValue":f[3]||(f[3]=v=>i.value.Type=v),label:"Type",variant:"outlined",items:T(Qe),"hide-details":""},null,8,["modelValue","items"])]),_:1}),e(D,{cols:"12",sm:"6"},{default:l(()=>[e(F,{modelValue:i.value.NotificationEmail,"onUpdate:modelValue":f[4]||(f[4]=v=>i.value.NotificationEmail=v),label:"Notification Email",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),e(D,{cols:"12",sm:"6",class:"d-none"},{default:l(()=>[e(F,{modelValue:i.value.State.Stage,"onUpdate:modelValue":f[5]||(f[5]=v=>i.value.State.Stage=v),modelModifiers:{number:!0},label:"Stage",variant:"outlined","hide-details":"",type:"number"},null,8,["modelValue"])]),_:1}),e(D,{cols:"6"},{default:l(()=>[e(z,{modelValue:i.value.State.New,"onUpdate:modelValue":f[6]||(f[6]=v=>i.value.State.New=v),label:"Allow New Entries"},null,8,["modelValue"])]),_:1}),e(D,{cols:"6"},{default:l(()=>[e(z,{modelValue:i.value.State.Edit,"onUpdate:modelValue":f[7]||(f[7]=v=>i.value.State.Edit=v),label:"Allow Editing Submissions"},null,8,["modelValue"])]),_:1}),e(D,{cols:"6"},{default:l(()=>[e(z,{modelValue:i.value.State.Independent,"onUpdate:modelValue":f[8]||(f[8]=v=>i.value.State.Independent=v),label:"Independent of Registration Form"},null,8,["modelValue"])]),_:1})]),_:1}),e(A,null,{default:l(()=>[e(D,{cols:"12"},{default:l(()=>[e(Z,{label:"Required Tags",variant:"outlined",modelValue:i.value.RequiredTags,"onUpdate:modelValue":f[9]||(f[9]=v=>i.value.RequiredTags=v),convention:T(d),organisation:T(d).OrganisationUUID,chips:"",clearable:"",hint:"Tags that a user must have to see this form. (Any one)"},null,8,["modelValue","convention","organisation"])]),_:1})]),_:1}),e(A,null,{default:l(()=>[e(D,{cols:"12"},{default:l(()=>[e(Me,{label:"Required Groups",variant:"outlined",modelValue:i.value.RequiredGroupMemberships,"onUpdate:modelValue":f[10]||(f[10]=v=>i.value.RequiredGroupMemberships=v),convention:T(d),organisation:T(d).OrganisationUUID,chips:"",clearable:"",hint:"Groups that a user must be in to see this form. (Any one)"},null,8,["modelValue","convention","organisation"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),i.value?(p(),y(Pt,{key:0,modelValue:i.value,"onUpdate:modelValue":f[11]||(f[11]=v=>i.value=v),convention:T(d),style:{"border-radius":"0"}},null,8,["modelValue","convention"])):S("",!0),t.value?(p(),y(Ot,{key:1,modelValue:t.value,"onUpdate:modelValue":f[12]||(f[12]=v=>t.value=v),form:i.value,"onUpdate:form":f[13]||(f[13]=v=>i.value=v),admin:!0,convention:T(d),title:"Form Preview",preview:!0,"card-class":"pa-0"},null,8,["modelValue","form","convention"])):S("",!0)]),_:1},8,["modelValue","item"]))}}),wt=(_,r)=>{const a=g(!1),d=g(!1),s=g(_),u=g(-1),o=g(r),n=g(r),t=le(()=>u.value===-1?"New Form":"Edit Form"),i=()=>{s.value=_},c=I=>{u.value=s.value.indexOf(I),o.value=Object.assign({},I),a.value=!0},m=I=>{u.value=s.value.indexOf(I),o.value=Object.assign({},I),d.value=!0},V=()=>{d.value=!1,ye(()=>{o.value=Object.assign({},n.value),u.value=-1}).then()},f=()=>{s.value.splice(u.value,1),V()},v=()=>{a.value=!1,ye(()=>{o.value=Object.assign({},n.value),u.value=-1}).then()},U=()=>{u.value>-1?Object.assign(s.value[u.value],o.value):s.value.push(o.value),v()};return W(a,I=>{I||v()}),W(d,I=>{I||V()}),{collection:s,defaultItem:n,dialog:a,dialogDelete:d,editedItem:o,formTitle:t,reset:i,editItem:c,deleteItem:m,deleteItemConfirm:f,close:v,save:U}},Lt=P({__name:"FormEditor",props:{modelValue:{required:!0},modelModifiers:{}},emits:M(["refresh"],["update:modelValue"]),setup(_){const r=q(_,"modelValue"),a=G(),d=g([{key:"Name",title:"Form Name",align:"start",sortable:!0},{key:"Type",title:"Type",align:"start",sortable:!0},{key:"actions",title:"Actions",sortable:!1}]),s=g([]),u=g([]);a.getConventionFields(r.value.ConventionUUID).then(x=>{s.value=x}),a.getConventionForms(r.value.ConventionUUID).then(x=>{u.value=x});const o={ID:0,FormUUID:w(),ConventionID:r.value.ID,ConventionUUID:r.value.ConventionUUID,ParentID:0,ParentUUID:ge,Name:"",Heading:"",Description:"",Type:el.FORM_TYPE_ADDITIONAL,Sections:[],State:{ID:0,FormStateUUID:w(),FormID:0,FormUUID:ge,New:!1,Edit:!1,Stage:0,Independent:!1},RequiredGroupMemberships:[],RequiredTags:[],NotificationEmail:""};o.State.FormUUID=o.FormUUID;const{collection:n,defaultItem:t,dialog:i,dialogDelete:c,editedItem:m,editItem:V,deleteItem:f,deleteItemConfirm:v,save:U}=wt(u,o);n.value.forEach(x=>{x.Sections.forEach(h=>{var b;(b=h.Fields)==null||b.forEach(J=>{J.Field=s.value.find(H=>H.ID===J.FieldID)})})});const I=x=>{a.deleteForm(x.FormUUID).then(h=>{h&&f(x)})};return(x,h)=>(p(),y(qe,{headers:d.value,items:T(n),"sort-by":[{key:"calories",order:"asc"}],class:"elevation-1"},{top:l(()=>[e(ne,{color:"primary"},{default:l(()=>[e(ie,null,{default:l(()=>[C("Form Editor")]),_:1}),e(Ge,{class:"mx-4",inset:!0,vertical:!0}),e(ae),e(N,{dark:"",class:"mb-2","prepend-icon":"mdi:mdi-pencil",onClick:h[0]||(h[0]=b=>{m.value=Object.assign({},T(t)),i.value=!0})},{default:l(()=>[C(" New Item ")]),_:1}),e(Ke,{modelValue:T(c),"onUpdate:modelValue":h[1]||(h[1]=b=>Ie(c)?c.value=b:null),onDelete:T(v)},null,8,["modelValue","onDelete"])]),_:1}),T(i)?(p(),y(qt,{key:0,modelValue:T(i),"onUpdate:modelValue":h[2]||(h[2]=b=>Ie(i)?i.value=b:null),form:T(m),"onUpdate:form":[h[3]||(h[3]=b=>Ie(m)?m.value=b:null),T(U)],convention:r.value},null,8,["modelValue","form","onUpdate:form","convention"])):S("",!0)]),"item.actions":l(({item:b})=>[e(X,{size:"small",class:"me-2",onClick:J=>T(V)(b)},{default:l(()=>[C(" mdi:mdi-pencil ")]),_:2},1032,["onClick"]),e(X,{size:"small",onClick:J=>I(b)},{default:l(()=>[C(" mdi:mdi-delete ")]),_:2},1032,["onClick"])]),_:1},8,["headers","items"]))}}),ha=P({__name:"ConventionEditorView",emits:["pageTitle","refresh"],setup(_,{emit:r}){const a=r,d=Ye(),s=G(),o=g({ID:0,ConventionUUID:ge,Accommodation:[],Description:"",DetailLink:"",Extras:[],Interests:[],Logo:"",Name:"",OrganisationID:0,OrganisationUUID:"",Slug:"",Tickets:[],Visible:!1}),n=g();W(n,()=>{i.value.find(m=>m.id===n.value&&m.title==="General")&&t()});const t=()=>{s.getConvention(d.params.convention.toString()).then(c=>{c?(o.value=c,a("pageTitle",`Convention Editor - ${o.value.Name}`)):a("pageTitle","Convention Editor - New Convention")})},i=g([{id:w(),title:"Accommodation",component:ue(tt),model:o},{id:w(),title:"Additional Purchases",component:ue(vl),model:o},{id:w(),title:"Fields",component:ue(Et),model:o},{id:w(),title:"Forms",component:ue(Lt),model:o},{id:w(),title:"Interests",component:ue(Ul),model:o},{id:w(),title:"Tickets",component:ue(Nl),model:o},{id:w(),title:"Venues",component:ue(Bl),model:o}]);return a("pageTitle","Convention Editor"),t(),(c,m)=>(p(),E("div",null,[o.value&&o.value.ConventionUUID!==T(ge)?(p(),E($,{key:0},[e(ne,{color:"blue-darken-4"},{default:l(()=>[e(al,{modelValue:n.value,"onUpdate:modelValue":m[0]||(m[0]=V=>n.value=V),"show-arrows":""},{default:l(()=>[(p(!0),E($,null,K(i.value,V=>(p(),y(ol,{key:V.id,value:V.id},{default:l(()=>[C(R(V.title),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(tl,{modelValue:n.value,"onUpdate:modelValue":m[1]||(m[1]=V=>n.value=V),disabled:!0},{default:l(()=>[(p(!0),E($,null,K(i.value,V=>(p(),y(nl,{key:V.id,value:V.id},{default:l(()=>[V.id===n.value?(p(),y(re,{key:0,class:"pa-2"},{default:l(()=>[(p(),y(He(V.component),{modelValue:V.model,"onUpdate:modelValue":f=>V.model=f},null,8,["modelValue","onUpdate:modelValue"]))]),_:2},1024)):S("",!0)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])],64)):S("",!0)]))}});export{ha as default};
