import{p as _e,an as je,n as Me,ae as sl,r as A,s as Ae,u as Ee,e as oe,w as J,E as xe,v as u,H as _,x as ue,N as x,aA as rl,ah as dl,I as me,a1 as ee,a2 as ve,a5 as Pe,K as s,R as E,U as Y,O as H,M as r,Z as z,L as y,Q as M,S as m,a3 as Ue,P as We,ar as Re,$ as Ze,Y as ml,ac as Be,a as vl,ax as cl,J as fl,aB as Ge}from"./index-000f83e7.js";import{F as ae}from"./form-e2a93b7c.js";import{a as pl}from"./submission-56c4c4f1.js";import{V as de,u as we}from"./VCheckbox-8e499af8.js";import{s as Te}from"./index-71069b21.js";import{f as gl,V as ie,a as W,e as be,d as De,c as Qe}from"./VList-fe8ce993.js";import{a as Q,V as N}from"./VRow-af61584d.js";import{m as hl,u as Ul,a as bl,b as yl,V as $e}from"./VSelect-85fcd757.js";import{d as Il,u as Vl,e as Oe,T as Dl,s as He}from"./filter-e231810a.js";import{v as Tl,u as qe,V as ke,z as kl,j as Cl}from"./VContainer-3ede021b.js";import{c as Sl}from"./copyToClipboard-54de8978.js";import{a as Al,e as El,_ as Ye}from"./VChip-43700778.js";import{V as ne}from"./VBtn-738d644b.js";import{k as Rl,l as Ol,j as Ll,V as ye,m as $l,f as Ke,n as _l}from"./VTextField-4fd7650b.js";import{V as Ml}from"./VTextarea-ba5ae5ad.js";import{m as Pl}from"./VAvatar-f8b506f3.js";import{V as wl,m as ql,a as el,b as Fl,c as Nl}from"./VCheckboxBtn-dbba9ec2.js";import{G as xl}from"./userData-08e33203.js";import{v as Le}from"./v4-a960c1f4.js";import{e as Bl,V as Gl,a as Hl,c as Yl}from"./VCard-b0dadb2d.js";import{V as Kl}from"./VForm-20037e02.js";const Xe=(t,I,d)=>{if(d>=t.length){let R=d-t.length+1;for(;R--;)t.push(void 0)}t.splice(d,0,t.splice(I,1)[0])};var X=(t=>(t.ACCOMMODATION="ACCOMMODATION",t.AGE="AGE",t.CHECKBOX="CHECKBOX",t.DATE="DATE",t.EXTRAS="EXTRAS",t.INTERESTS="INTERESTS",t.RADIO="RADIO",t.SELECT="SELECT",t.TEXT="TEXT",t.TEXTAREA="TEXTAREA",t.TICKET="TICKET",t.NUMBER="NUMBER",t))(X||{});const Ht=[{title:"Accommodation",value:"ACCOMMODATION"},{title:"Additional Purchase",value:"EXTRAS"},{title:"Age Check",value:"AGE"},{title:"Button",value:"RADIO"},{title:"Checkbox",value:"CHECKBOX"},{title:"Date",value:"DATE"},{title:"Dropdown",value:"SELECT"},{title:"Interests",value:"INTERESTS"},{title:"Text",value:"TEXT"},{title:"Textarea",value:"TEXTAREA"},{title:"Ticket",value:"TICKET"},{title:"Number",value:"NUMBER"}];function Xl(t,I,d){if(I==null)return t;if(Array.isArray(I))throw new Error("Multiple matches is not implemented");return typeof I=="number"&&~I?u(_,null,[u("span",{class:"v-autocomplete__unmask"},[t.substr(0,I)]),u("span",{class:"v-autocomplete__mask"},[t.substr(I,d)]),u("span",{class:"v-autocomplete__unmask"},[t.substr(I+d)])]):t}const Jl=_e({autoSelectFirst:{type:[Boolean,String]},search:String,...Il({filterKeys:["title"]}),...hl(),...je(Rl({modelValue:null}),["validationValue","dirty","appendInnerIcon"]),...Pl({transition:!1})},"VAutocomplete"),Je=Me()({name:"VAutocomplete",props:Jl(),emits:{"update:focused":t=>!0,"update:search":t=>!0,"update:modelValue":t=>!0,"update:menu":t=>!0},setup(t,I){let{slots:d}=I;const{t:R}=sl(),V=A(),g=Ae(!1),D=Ae(!0),p=A(!1),c=A(),P=Ee(t,"menu"),l=oe({get:()=>P.value,set:h=>{var F;P.value&&!h&&((F=c.value)!=null&&F.ΨopenChildren)||(P.value=h)}}),v=Ae(-1),k=oe(()=>{var h;return(h=V.value)==null?void 0:h.color}),{items:f,transformIn:o,transformOut:i}=gl(t),{textColorClasses:n,textColorStyles:e}=Tl(k),a=Ee(t,"search",""),b=Ee(t,"modelValue",[],h=>o(h===null?[null]:dl(h)),h=>{const F=i(h);return t.multiple?F:F[0]??null}),C=Ol(),{filteredItems:S,getMatches:B}=Vl(t,f,()=>D.value?"":a.value),U=oe(()=>b.value.map(h=>f.value.find(F=>t.valueComparator(F.value,h.value))||h)),$=oe(()=>t.hideSelected?S.value.filter(h=>!U.value.some(F=>F.value===h.value)):S.value),Z=oe(()=>U.value.map(h=>h.props.value)),ce=oe(()=>U.value[v.value]),fe=oe(()=>{var F;return(t.autoSelectFirst===!0||t.autoSelectFirst==="exact"&&a.value===((F=$.value[0])==null?void 0:F.title))&&$.value.length>0&&!D.value&&!p.value}),Ie=oe(()=>t.hideNoData&&!f.value.length||t.readonly||(C==null?void 0:C.isReadonly.value)),se=A(),{onListScroll:O,onListKeydown:L}=Ul(se,V);function T(h){t.openOnClear&&(l.value=!0),a.value=""}function q(){Ie.value||(l.value=!0)}function pe(h){Ie.value||(g.value&&(h.preventDefault(),h.stopPropagation()),l.value=!l.value)}function ll(h){var he,w,j;if(t.readonly||C!=null&&C.isReadonly.value)return;const F=V.value.selectionStart,K=Z.value.length;if((v.value>-1||["Enter","ArrowDown","ArrowUp"].includes(h.key))&&h.preventDefault(),["Enter","ArrowDown"].includes(h.key)&&(l.value=!0),["Escape"].includes(h.key)&&(l.value=!1),["Enter","Escape","Tab"].includes(h.key)&&(fe.value&&["Enter","Tab"].includes(h.key)&&ge(S.value[0]),D.value=!0),h.key==="ArrowDown"&&fe.value&&((he=se.value)==null||he.focus("next")),!!t.multiple){if(["Backspace","Delete"].includes(h.key)){if(v.value<0){h.key==="Backspace"&&!a.value&&(v.value=K-1);return}const G=v.value;ce.value&&ge(ce.value),v.value=G>=K-1?K-2:G}if(h.key==="ArrowLeft"){if(v.value<0&&F>0)return;const G=v.value>-1?v.value-1:K-1;U.value[G]?v.value=G:(v.value=-1,V.value.setSelectionRange((w=a.value)==null?void 0:w.length,(j=a.value)==null?void 0:j.length))}if(h.key==="ArrowRight"){if(v.value<0)return;const G=v.value+1;U.value[G]?v.value=G:(v.value=-1,V.value.setSelectionRange(0,0))}}}function tl(h){a.value=h.target.value}function al(){var h;g.value&&(D.value=!0,(h=V.value)==null||h.focus())}function nl(h){g.value=!0,setTimeout(()=>{p.value=!0})}function ol(h){p.value=!1}function il(h){(h==null||h===""&&!t.multiple)&&(b.value=[])}const Ve=Ae(!1);function ge(h){if(t.multiple){const F=Z.value.findIndex(K=>t.valueComparator(K,h.value));if(F===-1)b.value=[...b.value,h];else{const K=[...b.value];K.splice(F,1),b.value=K}}else b.value=[h],Ve.value=!0,a.value=h.title,l.value=!1,D.value=!0,xe(()=>Ve.value=!1)}return J(g,(h,F)=>{var K;h!==F&&(h?(Ve.value=!0,a.value=t.multiple?"":String(((K=U.value.at(-1))==null?void 0:K.props.title)??""),D.value=!0,xe(()=>Ve.value=!1)):(!t.multiple&&!a.value?b.value=[]:fe.value&&!p.value&&!U.value.some(he=>{let{value:w}=he;return w===$.value[0].value})&&ge($.value[0]),l.value=!1,a.value="",v.value=-1))}),J(a,h=>{!g.value||Ve.value||(h&&(l.value=!0),D.value=!h)}),qe(()=>{const h=!!(t.chips||d.chip),F=!!(!t.hideNoData||$.value.length||d["prepend-item"]||d["append-item"]||d["no-data"]),K=b.value.length>0,[he]=ye.filterProps(t);return u(ye,ue({ref:V},he,{modelValue:a.value,"onUpdate:modelValue":il,focused:g.value,"onUpdate:focused":w=>g.value=w,validationValue:b.externalValue,dirty:K,onInput:tl,class:["v-autocomplete",`v-autocomplete--${t.multiple?"multiple":"single"}`,{"v-autocomplete--active-menu":l.value,"v-autocomplete--chips":!!t.chips,"v-autocomplete--selection-slot":!!d.selection,"v-autocomplete--selecting-index":v.value>-1},t.class],style:t.style,readonly:t.readonly,placeholder:K?void 0:t.placeholder,"onClick:clear":T,"onMousedown:control":q,onKeydown:ll}),{...d,default:()=>u(_,null,[u(bl,ue({ref:c,modelValue:l.value,"onUpdate:modelValue":w=>l.value=w,activator:"parent",contentClass:"v-autocomplete__content",disabled:Ie.value,eager:t.eager,maxHeight:310,openOnClick:!1,closeOnContentClick:!1,transition:t.transition,onAfterLeave:al},t.menuProps),{default:()=>[F&&u(ie,{ref:se,selected:Z.value,selectStrategy:t.multiple?"independent":"single-independent",onMousedown:w=>w.preventDefault(),onKeydown:L,onFocusin:nl,onFocusout:ol,onScrollPassive:O,tabindex:"-1"},{default:()=>{var w,j,G;return[(w=d["prepend-item"])==null?void 0:w.call(d),!$.value.length&&!t.hideNoData&&(((j=d["no-data"])==null?void 0:j.call(d))??u(W,{title:R(t.noDataText)},null)),u(yl,{renderless:!0,items:$.value},{default:re=>{var Ne;let{item:le,index:te,itemRef:ul}=re;const Fe=ue(le.props,{ref:ul,key:te,active:fe.value&&te===0?!0:void 0,onClick:()=>ge(le)});return((Ne=d.item)==null?void 0:Ne.call(d,{item:le,index:te,props:Fe}))??u(W,Fe,{prepend:Ce=>{let{isSelected:Se}=Ce;return u(_,null,[t.multiple&&!t.hideSelected?u(wl,{key:le.value,modelValue:Se,ripple:!1,tabindex:"-1"},null):void 0,le.props.prependIcon&&u(ke,{icon:le.props.prependIcon},null)])},title:()=>{var Ce,Se;return D.value?le.title:Xl(le.title,(Ce=B(le))==null?void 0:Ce.title,((Se=a.value)==null?void 0:Se.length)??0)}})}}),(G=d["append-item"])==null?void 0:G.call(d)]}})]}),U.value.map((w,j)=>{var le;function G(te){te.stopPropagation(),te.preventDefault(),ge(w)}const re={"onClick:close":G,onMousedown(te){te.preventDefault(),te.stopPropagation()},modelValue:!0,"onUpdate:modelValue":void 0};return u("div",{key:w.value,class:["v-autocomplete__selection",j===v.value&&["v-autocomplete__selection--selected",n.value]],style:j===v.value?e.value:{}},[h?d.chip?u(kl,{key:"chip-defaults",defaults:{VChip:{closable:t.closableChips,size:"small",text:w.title}}},{default:()=>{var te;return[(te=d.chip)==null?void 0:te.call(d,{item:w,index:j,props:re})]}}):u(Al,ue({key:"chip",closable:t.closableChips,size:"small",text:w.title},re),null):((le=d.selection)==null?void 0:le.call(d,{item:w,index:j}))??u("span",{class:"v-autocomplete__selection-text"},[w.title,t.multiple&&j<U.value.length-1&&u("span",{class:"v-autocomplete__selection-comma"},[x(",")])])])})]),"append-inner":function(){var re;for(var w=arguments.length,j=new Array(w),G=0;G<w;G++)j[G]=arguments[G];return u(_,null,[(re=d["append-inner"])==null?void 0:re.call(d,...j),t.menuIcon?u(ke,{class:"v-autocomplete__menu-icon",icon:t.menuIcon,onMousedown:pe,onClick:rl},null):void 0])}})}),Ll({isFocused:g,isPristine:D,menu:l,search:a,filteredItems:S,select:ge},V)}}),zl={class:"extrasList"},jl=me({__name:"Extras",props:ee({convention:{},disabled:{type:Boolean},hint:{},label:{},name:{},items:{},persistentHint:{type:Boolean},required:{type:Boolean},errorMessages:{}},{modelValue:{required:!0}}),emits:ee(["change"],["update:modelValue"]),setup(t,{emit:I}){const d=t,{convention:R,disabled:V=!1}=d,g=ve(t,"modelValue"),D=Pe.getInstance(),p=A({});try{p.value=JSON.parse(g.value)}catch{}const c=A([]),P=A([]);J(d,()=>{v()}),J(p.value,f=>{for(const o in f)if(f[o].checked){const i=c.value.map(n=>{var e;return(e=n.Options)==null?void 0:e.find(a=>a.OptionUUID===o)});if(i&&i.length>0)try{const n=i[0];f[o].choiceId===""&&n&&n.Choices&&n.Choices.length>0&&(f[o].choiceId=n.Choices[0].TagUUID),f[o].price=n==null?void 0:n.Price}catch{}}else f[o].choiceId="",f[o].price=0;g.value=JSON.stringify(f),k()});const l=oe({get:()=>c.value.map(f=>f.ExtraUUID),set:()=>{}}),v=()=>{var o;const f=((o=d.items.find(i=>i.Title==="SelectedExtras"))==null?void 0:o.Value)||"[]";try{const i=JSON.parse(f);c.value=P.value.filter(n=>i.find(e=>e===n.ExtraUUID))||[],l.value=[...c.value.map(n=>n.ExtraUUID)],c.value.forEach(n=>{var e;(e=n.Options)==null||e.forEach(a=>{p.value[a.OptionUUID]||(p.value[a.OptionUUID]={choiceId:"",checked:!1})})})}catch{}};"Extras"in R&&R.Extras.length?(P.value=R.Extras,v()):"ConventionUUID"in R&&(D==null||D.getAvailableConventionExtras(R.ConventionUUID).then(f=>{f&&(P.value=f,v())}));const k=(f=void 0)=>{setTimeout(()=>I("change",f),100)};return(f,o)=>(s(),E("div",zl,[Y("h4",null,H(f.label),1),u(ie,{opened:l.value,"onUpdate:opened":o[0]||(o[0]=i=>l.value=i)},{default:r(()=>[(s(!0),E(_,null,z(c.value,i=>(s(),y(Qe,{key:i.ExtraUUID,value:i.ExtraUUID},{activator:r(({props:n})=>[u(W,ue({"prepend-icon":"mdi:mdi-group","append-icon":""},n),{default:r(()=>[i.Name?(s(),y(be,{key:0},{default:r(()=>[Y("strong",null,H(i.Name),1)]),_:2},1024)):M("",!0),i.Description?(s(),y(De,{key:1,class:"mt-2 d-inline"},{default:r(()=>[x(H(i.Description),1)]),_:2},1024)):M("",!0)]),_:2},1040)]),default:r(()=>[i.Options?(s(!0),E(_,{key:0},z(i.Options,n=>(s(),y(W,{key:n.OptionUUID,class:"override-pl"},{default:r(()=>[u(Q,null,{default:r(()=>[u(N,{cols:"12",sm:"6"},{default:r(()=>[u(de,{label:`${n.Name} ${n.Price&&n.Price!==0?`(${m(Te).currencySymbol}${n.Price})`:""}`,modelValue:p.value[n.OptionUUID].checked,"onUpdate:modelValue":e=>p.value[n.OptionUUID].checked=e,disabled:m(V),"hide-details":"",onChange:k},null,8,["label","modelValue","onUpdate:modelValue","disabled"])]),_:2},1024),n.Choices&&n.Choices.length>1&&p.value[n.OptionUUID].checked?(s(),y(N,{key:0,cols:"12",sm:"6"},{default:r(()=>[u($e,{items:n.Choices.sort((e,a)=>e.Title.localeCompare(a.Title)).map(e=>({value:e.TagUUID,title:e.Title})),modelValue:p.value[n.OptionUUID].choiceId,"onUpdate:modelValue":e=>p.value[n.OptionUUID].choiceId=e,"item-value":"value","item-title":"title",variant:"outlined",disabled:m(V),"hide-details":"",onChange:k},null,8,["items","modelValue","onUpdate:modelValue","disabled"])]),_:2},1024)):M("",!0)]),_:2},1024)]),_:2},1024))),128)):M("",!0)]),_:2},1032,["value"]))),128))]),_:1},8,["opened"])]))}});const Wl={class:"interestList"},Zl=me({__name:"Interests",props:ee({convention:{},disabled:{type:Boolean},hint:{},label:{},name:{},items:{},persistentHint:{type:Boolean},required:{type:Boolean},errorMessages:{}},{modelValue:{required:!0}}),emits:ee(["change"],["update:modelValue"]),setup(t,{emit:I}){const d=t,{convention:R,disabled:V=!1}=d,g=ve(t,"modelValue"),D=Pe.getInstance(),p=A({});try{p.value=JSON.parse(g.value)}catch{}const c=A([]),P=A([]);J(p.value,f=>{g.value=JSON.stringify(f)});const l=A([]),v=()=>{var o;const f=((o=d.items.find(i=>i.Title==="SelectedInterests"))==null?void 0:o.Value)||"[]";try{const i=JSON.parse(f);c.value=P.value.filter(n=>i.find(e=>e===n.InterestUUID))||[],l.value=[...c.value.map(n=>n.InterestUUID)]}catch{}};"ConventionUUID"in R&&(D==null||D.getConventionInterests(R.ConventionUUID).then(f=>{f&&(P.value=f,v())})),J(d,()=>{v()});const k=(f=void 0)=>{setTimeout(()=>I("change",f),100)};return(f,o)=>(s(),E("div",Wl,[Y("h4",null,H(f.label),1),u(ie,{opened:l.value,"onUpdate:opened":o[0]||(o[0]=i=>l.value=i)},{default:r(()=>[(s(!0),E(_,null,z(c.value,i=>(s(),y(W,{key:i.InterestUUID},{default:r(()=>[u(Q,null,{default:r(()=>[u(N,null,{default:r(()=>[u(de,{label:`${i.Name} ${i.Price&&i.Price>0?`(${m(Te).currencySymbol}${i.Price})`:""}`,modelValue:p.value[i.InterestUUID],"onUpdate:modelValue":n=>p.value[i.InterestUUID]=n,disabled:m(V),messages:i.Description,onChange:k},null,8,["label","modelValue","onUpdate:modelValue","disabled","messages"])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1},8,["opened"])]))}});const Ql={class:"ticketList"},et={key:0,class:"text-orange-darken-1"},lt=me({__name:"Tickets",props:ee({admin:{type:Boolean},convention:{},disabled:{type:Boolean},hint:{},label:{},name:{},items:{},persistentHint:{type:Boolean},registrationGroup:{},required:{type:Boolean},errorMessages:{}},{modelValue:{required:!0}}),emits:ee(["change"],["update:modelValue"]),setup(t,{emit:I}){const d=t,{admin:R=!1,convention:V,disabled:g=!1}=d,D=ve(t,"modelValue"),p=Pe.getInstance(),c=A({Ticket:[],AddonsChecked:[],ComponentsChecked:[]});try{c.value=JSON.parse(D.value),"ticket"in c.value&&(c.value.Ticket=c.value.ticket),"addonsChecked"in c.value&&(c.value.AddonsChecked=c.value.addonsChecked),"componentsChecked"in c.value&&(c.value.ComponentsChecked=c.value.componentsChecked)}catch{}const P=A([]),l=A([]);J(c.value,e=>{D.value=JSON.stringify(e)});const v=A([]),k=A({required:(e,a=void 0)=>()=>{if(a==null){if(c.value.Ticket.length===0&&d.required)return"Must select at least one ticket option.";if(e&&e.ComponentsRequired>0&&c.value.Ticket.includes(e.TicketUUID||"")){let b=0;if(e.TicketComponents.forEach(C=>{c.value.ComponentsChecked.forEach(S=>{C.TicketUUID===S&&(b+=1)})}),b<e.ComponentsRequired)return`Must select ticket ${e.ComponentsRequired} component${e.ComponentsRequired===1?"":"s"}`}}return!0}}),f=()=>{var a;const e=((a=d.items.find(b=>b.Title==="SelectedTickets"))==null?void 0:a.Value)||"[]";try{const b=JSON.parse(e);P.value=l.value.filter(C=>C.Type==="TICKET_TYPE_GROUP"&&b.find(S=>S===C.TicketUUID))||[],v.value=[...P.value.filter(C=>C.Type==="TICKET_TYPE_GROUP").map(C=>C.TicketUUID)]}catch{}};if("ConventionUUID"in V)if(R)p==null||p.getConventionTickets(V.ConventionUUID).then(e=>{e&&(l.value=e,f())});else{const e=d.items.find(a=>a.Title==="SelectedTickets");e&&(p==null||p.getFieldTickets(e.FieldUUID).then(a=>{a&&(l.value=a,f())}))}J(d,()=>{f()});const o=e=>{c.value.Ticket.length>1&&c.value.Ticket.shift(),c.value.ComponentsChecked=[];const a=[];P.value.forEach(b=>{(c.value.Ticket.includes(b.TicketUUID)||c.value.ComponentsChecked.includes(b.TicketUUID))&&a.push(...b.AddonTickets.map(C=>C.TicketUUID))}),c.value.AddonsChecked=c.value.AddonsChecked.filter(b=>a.includes(b)),n(e)},i=e=>{const a=l.value.find(b=>b.TicketUUID===c.value.Ticket[0]);if(a)for(;c.value.ComponentsChecked.length>a.ComponentsRequired;)c.value.ComponentsChecked.shift();n(e)},n=(e=void 0)=>{setTimeout(()=>I("change",e),100)};return(e,a)=>{var b;return s(),E("div",Ql,[Y("h4",null,[x(H(e.label)+" ",1),(b=e.registrationGroup)!=null&&b.Registration.Leader?M("",!0):(s(),E("small",et,"(controlled by group leader)"))]),u(ie,{opened:v.value,"onUpdate:opened":a[4]||(a[4]=C=>v.value=C)},{default:r(()=>[(s(!0),E(_,null,z(m(Oe)(P.value.filter(C=>C.Type===m(Dl).TICKET_TYPE_GROUP)),C=>(s(),E(_,{key:C.TicketUUID},[C.Tickets.length>0?(s(),y(Qe,{key:0,value:C.TicketUUID},{activator:r(({props:S})=>[u(W,ue(S,{"prepend-icon":"mdi:mdi-group"}),{default:r(()=>[u(be,null,{default:r(()=>[Y("strong",null,H(C.Name),1)]),_:2},1024),u(De,{class:"d-inline"},{default:r(()=>[x(H(C.Description),1)]),_:2},1024)]),_:2},1040)]),default:r(()=>[(s(!0),E(_,null,z(C.Tickets,S=>(s(),y(W,{key:S.TicketUUID,class:"override-pl"},{default:r(()=>{var B;return[u(De,{class:"d-inline"},{default:r(()=>[x(H(S.Description),1)]),_:2},1024),u(de,{modelValue:c.value.Ticket,"onUpdate:modelValue":a[0]||(a[0]=U=>c.value.Ticket=U),value:S.TicketUUID,onChange:o,rules:[k.value.required(S)],"validate-on":"submit",disabled:m(g)||!((B=e.registrationGroup)!=null&&B.Registration.Leader)},{label:r(()=>[u(ke,{icon:S.RequiresAccommodation?"mdi:mdi-home":S.ComponentsRequired>0?"mdi:mdi-ticket-confirmation":"mdi:mdi-ticket",class:"mx-2"},null,8,["icon"]),x(" "+H(`${S.Name} ${S.Price>0?`(${m(Te).currencySymbol}${S.Price})`:""}`),1)]),_:2},1032,["modelValue","value","rules","disabled"]),c.value.Ticket.length>0&&S.TicketUUID===c.value.Ticket[0]?(s(),E(_,{key:0},[S.AddonTickets.length?(s(),y(ie,{key:0},{default:r(()=>[(s(!0),E(_,null,z(m(Oe)(S.AddonTickets),U=>(s(),E(_,{key:U==null?void 0:U.TicketUUID},[U?(s(),y(W,{key:0},{default:r(()=>[u(be,null,{default:r(()=>{var $;return[u(de,{modelValue:c.value.AddonsChecked,"onUpdate:modelValue":a[1]||(a[1]=Z=>c.value.AddonsChecked=Z),value:U.TicketUUID,onChange:a[2]||(a[2]=Z=>{c.value.ComponentsChecked=[],n(Z)}),disabled:m(g)||!(($=e.registrationGroup)!=null&&$.Registration.Leader)},{label:r(()=>[u(ke,{icon:U.RequiresAccommodation?"mdi:mdi-home-plus":U.ComponentsRequired>0?"mdi:mdi-ticket-confirmation":"mdi:mdi-ticket",class:"mx-2"},null,8,["icon"]),x(" "+H(`${U.Name} ${U.Price>0?`(${m(Te).currencySymbol}${U.Price})`:""}`),1)]),_:2},1032,["modelValue","value","disabled"])]}),_:2},1024),u(De,{class:"d-inline"},{default:r(()=>[x(H(U.Description),1)]),_:2},1024)]),_:2},1024)):M("",!0)],64))),128))]),_:2},1024)):M("",!0),S.TicketComponents.length?(s(),y(ie,{key:1},{default:r(()=>[(s(!0),E(_,null,z(m(Oe)(S.TicketComponents),U=>(s(),E(_,{key:U==null?void 0:U.TicketUUID},[U?(s(),y(W,{key:0},{default:r(()=>[u(be,null,{default:r(()=>{var $;return[u(de,{modelValue:c.value.ComponentsChecked,"onUpdate:modelValue":a[3]||(a[3]=Z=>c.value.ComponentsChecked=Z),value:U.TicketUUID,onChange:i,rules:[k.value.required(S,U)],"validate-on":"submit",disabled:m(g)||!(($=e.registrationGroup)!=null&&$.Registration.Leader)},{label:r(()=>[u(ke,{icon:U.RequiresAccommodation?"mdi:mdi-home-plus":U.ComponentsRequired>0?"mdi:mdi-ticket-confirmation":"mdi:mdi-ticket",class:"mx-2"},null,8,["icon"]),x(" "+H(`${U.Name} ${U.Price>0?`(${m(Te).currencySymbol}${U.Price})`:""}`),1)]),_:2},1032,["modelValue","value","rules","disabled"])]}),_:2},1024),u(De,null,{default:r(()=>[x(H(U.Description),1)]),_:2},1024)]),_:2},1024)):M("",!0)],64))),128))]),_:2},1024)):M("",!0)],64)):M("",!0)]}),_:2},1024))),128))]),_:2},1032,["value"])):M("",!0)],64))),128))]),_:1},8,["opened"])])}}});const tt={key:0},at=Y("strong",null,"Your Sharing Group",-1),nt=["href","onClick"],ot=Y("br",null,null,-1),it=Y("small",null,"Link will be copied to clipboard for you to paste (ctrl+v) in to message or email",-1),ut=Y("strong",null,"Your Groups Accommodation",-1),st=Y("br",null,null,-1),rt=Y("small",null,"(in order of preference, controlled by group leader)",-1),dt=Y("strong",null,"Accommodation Options",-1),mt=Y("br",null,null,-1),vt=Y("strong",null,"Your Chosen Accommodation",-1),ct=Y("small",null,"(in order of preference)",-1),ft=me({__name:"Accommodation",props:ee({admin:{type:Boolean},convention:{},data:{},disabled:{type:Boolean},hint:{},items:{},label:{},name:{},persistentHint:{type:Boolean},registrationGroup:{},required:{type:Boolean},errorMessages:{}},{modelValue:{required:!0}}),emits:ee(["change","update:items"],["update:modelValue"]),setup(t,{emit:I}){const d=t,{admin:R=!1,convention:V,disabled:g}=d,D=ve(t,"modelValue"),p=we(d,I,void 0,void 0,"items"),c=Ze(),P=ml.getInstance(),l=A(Ue(D.value)),v=A([]),k=A(),f=A({sharing:!1}),o=()=>{try{const O=JSON.parse(d.data);O&&(f.value=O)}catch{}};o(),J(d,()=>{o(),d.registrationGroup&&(v.value=d.registrationGroup.Members,k.value=d.registrationGroup.Registration)}),J(l,O=>{D.value=Ue(O)},{deep:!0});const i=A(""),n=A(!1),e=()=>{var O;(O=k.value)!=null&&O.Leader&&c.getRegistrationInvite(V.ConventionUUID).then(L=>{if(L){const T=new URL(location.href);T.searchParams.set("token",L),i.value=T.toString()}})},a=()=>{Sl(i.value),e(),n.value=!0,setTimeout(()=>n.value=!1,2200)},b=()=>{P.emit("registration.group.leave")},C=O=>{P.emit("registration.group.remove.member",O)},S=A([]);J(p,()=>{B()});const B=()=>{R?c.getConventionAccommodation(V.ConventionUUID).then(O=>{S.value=O.filter(L=>!!(p!=null&&p.value.find(T=>T.Value===L.AccommodationUUID)))||[]}):p.value.length>0&&c.getFieldAccommodation(p.value[0].FieldUUID).then(O=>{S.value=O.filter(L=>!!(p!=null&&p.value.find(T=>T.Value===L.AccommodationUUID)))||[]})};B(),(()=>{var O;if(d.registrationGroup)if(v.value=d.registrationGroup.Members,k.value=d.registrationGroup.Registration,(O=k.value)!=null&&O.Leader)e();else try{l.value=JSON.parse(d.registrationGroup.AccommodationData)}catch{}})();const $=A({column:0,id:""}),Z=()=>{!g&&!l.value.includes($.value.id)&&($.value.column===0&&$.value.id!==""&&l.value.push($.value.id),se())},ce=()=>{const O=l.value.findIndex(L=>L===$.value.id);!g&&O>=0&&(l.value.splice(O,1),se())},fe=()=>{if(g||$.value.column!==1)return;const O=l.value.findIndex(L=>L===$.value.id);O<=0||(Xe(l.value,O,O-1),se())},Ie=()=>{if(g||$.value.column!==1)return;const O=l.value.findIndex(L=>L===$.value.id);O>=l.value.length-1||(Xe(l.value,O,O+1),se())},se=(O=void 0)=>{setTimeout(()=>I("change",O),100)};return(O,L)=>(s(),E(_,null,[Y("h4",null,H(O.label),1),u(Q,null,{default:r(()=>[u(N,{cols:"12"},{default:r(()=>{var T;return[v.value&&k.value&&f.value.sharing?(s(),E("div",tt,[at,!m(g)&&((T=v.value.find(q=>q.IsLeader))==null?void 0:T.UUID)!==k.value.RegistrationUUID?(s(),y(ne,{key:0,color:"red",variant:"text",onClick:b},{default:r(()=>[x("(leave group)")]),_:1})):M("",!0),u(ie,null,{default:r(()=>[u(W,null,{default:r(()=>{var q;return[u(be,{class:"float-left pr-2 font-weight-bold"},{default:r(()=>[x(" Leader: ")]),_:1}),x(" "+H((q=v.value.find(pe=>pe.IsLeader))==null?void 0:q.Name),1)]}),_:1}),(s(!0),E(_,null,z(v.value,q=>(s(),E(_,{key:q.UUID},[q.IsLeader?M("",!0):(s(),y(W,{key:0},{append:r(()=>[k.value.Leader?(s(),y(ne,{key:0,icon:"mdi:mdi-close-circle",size:"xs",color:"red",title:"Remove Member",onClick:pe=>C(q.UUID),disabled:m(g)},null,8,["onClick","disabled"])):M("",!0)]),default:r(()=>[u(be,{class:"float-left pr-2"},{default:r(()=>[x(" Member: ")]),_:1}),x(" "+H(q.Name),1)]),_:2},1024))],64))),128))]),_:1}),u(El,{modelValue:n.value,"onUpdate:modelValue":L[0]||(L[0]=q=>n.value=q),message:"Invite Link Copied",timeout:2e3},null,8,["modelValue"]),i.value&&k.value.Leader&&!m(g)?(s(),E(_,{key:1},[u(ne,{color:"blue"},{default:r(()=>[Y("a",{href:i.value,onClick:We(a,["prevent"]),class:"text-white text-decoration-none"}," Get Invite Link ",8,nt)]),_:1}),ot,it],64)):M("",!0)])):M("",!0)]}),_:1})]),_:1}),k.value&&!k.value.Leader?(s(),y(Q,{key:0},{default:r(()=>[u(N,{cols:"10",md:"5"},{default:r(()=>[ut,st,rt,u(ie,null,{default:r(()=>[(s(!0),E(_,null,z(l.value.map(T=>S.value.find(q=>q.AccommodationUUID==T)).filter(T=>T!==void 0),(T,q)=>(s(),E(_,null,[T?(s(),y(W,{key:T.AccommodationUUID,title:`${q+1}. ${T.Name}`,class:Re($.value.column===1&&$.value.id===T.AccommodationUUID?"bg-blue-accent-3":"border-dashed border")},null,8,["title","class"])):M("",!0)],64))),256))]),_:1})]),_:1})]),_:1})):(s(),y(Q,{key:1},{default:r(()=>[u(N,{cols:"12",md:"5"},{default:r(()=>[dt,mt,u(ie,null,{default:r(()=>[(s(!0),E(_,null,z(S.value,T=>(s(),y(W,{key:T.AccommodationUUID,title:T.Name,class:Re($.value.column===0&&$.value.id===T.AccommodationUUID?"bg-blue-accent-3":"border-dashed border"),onClick:q=>$.value={column:0,id:T.AccommodationUUID},"append-icon":m(g)?"":"mdi:mdi-gesture-tap",onDblclick:L[1]||(L[1]=q=>Z())},null,8,["title","class","onClick","append-icon"]))),128))]),_:1})]),_:1}),m(g)?M("",!0):(s(),y(N,{key:0,cols:"12",md:"1"},{default:r(()=>[u(Q,{class:"d-md-none"},{default:r(()=>[u(N,{cols:"12",class:"text-center"},{default:r(()=>[u(ne,{icon:"mdi:mdi-arrow-down",size:"small",onClick:L[2]||(L[2]=T=>Z()),color:"primary",title:"Select"}),x("   "),u(ne,{icon:"mdi:mdi-arrow-up",size:"small",onClick:L[3]||(L[3]=T=>ce()),color:"secondary",title:"Remove"})]),_:1})]),_:1}),u(Q,{class:"d-none d-md-flex h-100 align-content-center"},{default:r(()=>[u(N,{cols:"12"},{default:r(()=>[u(ne,{icon:"mdi:mdi-arrow-right",size:"small",onClick:L[4]||(L[4]=T=>Z()),color:"primary",title:"Select"})]),_:1}),u(N,{cols:"12"},{default:r(()=>[u(ne,{icon:"mdi:mdi-arrow-left",size:"small",onClick:L[5]||(L[5]=T=>ce()),color:"secondary",title:"Remove"})]),_:1})]),_:1})]),_:1})),u(N,{cols:"10",md:"5"},{default:r(()=>[vt,u(ie,null,{default:r(()=>[(s(!0),E(_,null,z(l.value.map(T=>S.value.find(q=>q.AccommodationUUID==T)).filter(T=>T!==void 0),(T,q)=>(s(),E(_,null,[T?(s(),y(W,{key:T.AccommodationUUID,title:`${q+1}. ${T.Name}`,class:Re($.value.column===1&&$.value.id===T.AccommodationUUID?"bg-blue-accent-3":"border-dashed border"),onClick:pe=>$.value={column:1,id:(T==null?void 0:T.AccommodationUUID)||""},"append-icon":m(g)?"":"mdi:mdi-gesture-tap",onDblclick:L[6]||(L[6]=pe=>ce())},null,8,["title","class","onClick","append-icon"])):M("",!0)],64))),256))]),_:1}),ct]),_:1}),m(g)?M("",!0):(s(),y(N,{key:1,cols:"2",md:"1"},{default:r(()=>[u(Q,{class:"d-flex h-100 align-content-center mt-3"},{default:r(()=>[u(N,{cols:"12"},{default:r(()=>[u(ne,{icon:"mdi:mdi-arrow-up",size:"small",onClick:L[7]||(L[7]=T=>fe()),color:"primary",title:"Higher Priority"})]),_:1}),u(N,{cols:"12"},{default:r(()=>[u(ne,{icon:"mdi:mdi-arrow-down",size:"small",onClick:L[8]||(L[8]=T=>Ie()),color:"secondary",title:"Lower Priority"})]),_:1})]),_:1})]),_:1}))]),_:1}))],64))}}),pt=me({__name:"AgeCheck",props:ee({disabled:{type:Boolean},hint:{},label:{},name:{},items:{},persistentHint:{type:Boolean},required:{type:Boolean},errorMessages:{}},{modelValue:{required:!0}}),emits:ee(["blur","change","update:items"],["update:modelValue"]),setup(t,{emit:I}){const d=t,R=we(d,I,void 0,void 0,"items"),V=ve(t,"modelValue"),g=A({required:l=>!d.required||!!l||"Required.",min:l=>{var a,b;const v=new Date,k=v.getFullYear(),f=(v.getMonth()+1).toLocaleString("en-US",{minimumIntegerDigits:2}),o=v.getDate().toLocaleString("en-US",{minimumIntegerDigits:2}),i=((a=R.value.find(C=>C.Title=="MIN_AGE"))==null?void 0:a.Value)||"18",n=((b=R.value.find(C=>C.Title=="BEFORE_DATE"))==null?void 0:b.Value)||`${k}-${f}-${o}`,e=c(n);return p(l,n,parseInt(i))||`You must be at least ${i} years old by ${e.toLocaleDateString(navigator.language,{timeZone:"UTC"})}.`}}),D=()=>(I("blur"),!(g.value.min(V.value||"")!==!0||g.value.required(V.value||"")!==!0)),p=(l,v,k)=>{if(l>=v)return!1;const f=c(l),i=c(v).getTime()-f.getTime(),n=1e3*60*60*24*365.25;return i/n>=k},c=l=>{const[v,k,f]=l.split("-");return new Date(parseInt(v),parseInt(k)-1,parseInt(f))},P=(l=void 0)=>{setTimeout(()=>I("change",l),100)};return(l,v)=>(s(),y(ye,{modelValue:V.value,"onUpdate:modelValue":v[0]||(v[0]=k=>V.value=k),type:"date",hint:l.hint||"",label:l.label||"",name:l.name||"",variant:"outlined",disabled:l.disabled||!1,"persistent-hint":l.persistentHint||!1,"error-messages":l.errorMessages||"",rules:[g.value.required,g.value.min],onBlur:D,onChange:P},null,8,["modelValue","hint","label","name","disabled","persistent-hint","error-messages","rules"]))}}),gt=_e({...ql({falseIcon:"$radioOff",trueIcon:"$radioOn"})},"VRadio"),ht=Me()({name:"VRadio",props:gt(),setup(t,I){let{slots:d}=I;return qe(()=>u(el,ue(t,{class:["v-radio",t.class],style:t.style,type:"radio"}),d)),{}}});const Ut=_e({height:{type:[Number,String],default:"auto"},...$l(),...je(Fl(),["multiple"]),trueIcon:{type:Be,default:"$radioOn"},falseIcon:{type:Be,default:"$radioOff"},type:{type:String,default:"radio"}},"VRadioGroup"),bt=Me()({name:"VRadioGroup",inheritAttrs:!1,props:Ut(),emits:{"update:modelValue":t=>!0},setup(t,I){let{attrs:d,slots:R}=I;const V=vl(),g=oe(()=>t.id||`radio-group-${V}`),D=Ee(t,"modelValue");return qe(()=>{const[p,c]=cl(d),[P,l]=Ke.filterProps(t),[v,k]=el.filterProps(t),f=R.label?R.label({label:t.label,props:{for:g.value}}):t.label;return u(Ke,ue({class:["v-radio-group",t.class],style:t.style},p,P,{modelValue:D.value,"onUpdate:modelValue":o=>D.value=o,id:g.value}),{...R,default:o=>{let{id:i,messagesId:n,isDisabled:e,isReadonly:a}=o;return u(_,null,[f&&u(_l,{id:i.value},{default:()=>[f]}),u(Nl,ue(v,{id:i.value,"aria-describedby":n.value,defaultsTarget:"VRadio",trueIcon:t.trueIcon,falseIcon:t.falseIcon,type:t.type,disabled:e.value,readonly:a.value,"aria-labelledby":f?i.value:void 0,multiple:!1},c,{modelValue:D.value,"onUpdate:modelValue":b=>D.value=b}),R)])}})}),{}}}),ze=me({__name:"FormField",props:ee({admin:{type:Boolean},convention:{},name:{},field:{},disabled:{type:Boolean},maxLength:{},minLength:{},persistentHint:{type:Boolean},registrationGroup:{},required:{type:Boolean}},{modelValue:{required:!0}}),emits:ee(["change","input","update:field"],["update:modelValue"]),setup(t,{emit:I}){const d=t,{admin:R=!1,disabled:V=!1,persistentHint:g=!1,required:D=!1}=d,p=A(""),c=ve(t,"modelValue"),P=we(d,I,void 0,void 0,"field"),l=A(Ue(P.value)),v=A({maxlength:n=>!d.maxLength||n.length<=d.maxLength||`Maximum length is ${d.maxLength} characters. (Current length: ${n.length})`,minlength:n=>!d.minLength||n.length>=d.minLength||`Minimum length is ${d.minLength} characters. (Current length: ${n.length})`,required:n=>!d.required||!!n||"Required field."}),k=A(!1),f=A([]),o=A("");try{const n=JSON.parse(c.value);Array.isArray(n)?f.value=n:typeof n=="boolean"?k.value=n:o.value=c.value}catch{k.value=!1,f.value=[],o.value=c.value}J(k,()=>{c.value=JSON.stringify(k.value),I("input")}),J(f,()=>{c.value=JSON.stringify(f.value),I("input"),l.value.Type===X.SELECT&&I("change")},{deep:!0}),J(o,()=>{c.value=o.value,I("input"),l.value.Type===X.SELECT&&I("change")}),J(P.value,()=>{l.value.Type!==P.value.Type?(l.value=Ue(P.value),k.value=!1,f.value=[],o.value=""):l.value=Ue(P.value)});const i=(n=void 0)=>{I("change",n)};return(n,e)=>l.value.Type===m(X).TEXT?(s(),y(ye,{key:0,modelValue:o.value,"onUpdate:modelValue":e[0]||(e[0]=a=>o.value=a),name:n.name,hint:l.value.Hint,label:`${l.value.Label}${m(D)?"*":""}`,placeholder:l.value.Placeholder,variant:"outlined",disabled:m(V)||!1,"persistent-hint":m(g)||!1,"error-messages":p.value,rules:[v.value.maxlength,v.value.minlength,v.value.required],onChange:i},null,8,["modelValue","name","hint","label","placeholder","disabled","persistent-hint","error-messages","rules"])):l.value.Type===m(X).DATE?(s(),y(ye,{key:1,modelValue:o.value,"onUpdate:modelValue":e[1]||(e[1]=a=>o.value=a),type:"date",name:n.name,hint:l.value.Hint,label:l.value.Label,placeholder:l.value.Placeholder,variant:"outlined",disabled:m(V)||!1,"persistent-hint":m(g)||!1,"error-messages":p.value,rules:[v.value.maxlength,v.value.minlength,v.value.required],onChange:i},null,8,["modelValue","name","hint","label","placeholder","disabled","persistent-hint","error-messages","rules"])):l.value.Type===m(X).NUMBER?(s(),y(ye,{key:2,modelValue:o.value,"onUpdate:modelValue":e[2]||(e[2]=a=>o.value=a),type:"number",name:n.name,hint:l.value.Hint,label:l.value.Label,placeholder:l.value.Placeholder,variant:"outlined",disabled:m(V)||!1,"persistent-hint":m(g)||!1,"error-messages":p.value,rules:[v.value.maxlength,v.value.minlength,v.value.required],onChange:i},null,8,["modelValue","name","hint","label","placeholder","disabled","persistent-hint","error-messages","rules"])):l.value.Type===m(X).TEXTAREA?(s(),y(Ml,{key:3,modelValue:o.value,"onUpdate:modelValue":e[3]||(e[3]=a=>o.value=a),name:n.name,hint:l.value.Hint,label:l.value.Label,placeholder:l.value.Placeholder,variant:"outlined",disabled:m(V)||!1,"persistent-hint":m(g)||!1,"error-messages":p.value,rules:[v.value.maxlength,v.value.minlength,v.value.required],onChange:i},null,8,["modelValue","name","hint","label","placeholder","disabled","persistent-hint","error-messages","rules"])):l.value.Type===m(X).CHECKBOX?(s(),E(_,{key:4},[l.value.Multiple?(s(!0),E(_,{key:0},z(l.value.Values,a=>(s(),y(de,{key:a.ID,modelValue:f.value,"onUpdate:modelValue":e[4]||(e[4]=b=>f.value=b),name:n.name,hint:l.value.Hint,label:a.Title,value:a.Value,disabled:m(V)||!1,"persistent-hint":m(g),"error-messages":p.value,rules:[v.value.required],onChange:i},null,8,["modelValue","name","hint","label","value","disabled","persistent-hint","error-messages","rules"]))),128)):(s(),y(de,{key:1,modelValue:k.value,"onUpdate:modelValue":e[5]||(e[5]=a=>k.value=a),name:n.name,hint:l.value.Hint,label:l.value.Label,disabled:m(V)||!1,"persistent-hint":m(g),"error-messages":p.value,required:m(D),rules:[a=>!m(D)||!!a||"You must tick to continue!"],onChange:i},null,8,["modelValue","name","hint","label","disabled","persistent-hint","error-messages","required","rules"]))],64)):l.value.Type===m(X).SELECT?(s(),E(_,{key:5},[!l.value.Autofill&&l.value.Multiple?(s(),y($e,{key:0,modelValue:f.value,"onUpdate:modelValue":e[6]||(e[6]=a=>f.value=a),name:n.name,hint:l.value.Hint,label:l.value.Label,multiple:"",items:l.value.Values,"item-title":"Title","item-value":"Value",variant:"outlined",disabled:m(V)||!1,"persistent-hint":m(g)||!1,"error-messages":p.value,rules:[v.value.required]},null,8,["modelValue","name","hint","label","items","disabled","persistent-hint","error-messages","rules"])):l.value.Autofill&&l.value.Multiple?(s(),y(Je,{key:1,modelValue:f.value,"onUpdate:modelValue":e[7]||(e[7]=a=>f.value=a),name:n.name,hint:l.value.Hint,label:l.value.Label,multiple:"",items:l.value.Values,"item-title":"Title","item-value":"Value",variant:"outlined",disabled:m(V)||!1,"persistent-hint":m(g)||!1,"error-messages":p.value,rules:[v.value.required]},null,8,["modelValue","name","hint","label","items","disabled","persistent-hint","error-messages","rules"])):l.value.Autofill?l.value.Autofill?(s(),y(Je,{key:3,modelValue:o.value,"onUpdate:modelValue":e[9]||(e[9]=a=>o.value=a),name:n.name,hint:l.value.Hint,label:l.value.Label,items:l.value.Values,"item-title":"Title","item-value":"Value",variant:"outlined",disabled:m(V)||!1,"persistent-hint":m(g)||!1,"error-messages":p.value,rules:[v.value.required]},null,8,["modelValue","name","hint","label","items","disabled","persistent-hint","error-messages","rules"])):M("",!0):(s(),y($e,{key:2,modelValue:o.value,"onUpdate:modelValue":e[8]||(e[8]=a=>o.value=a),name:n.name,hint:l.value.Hint,label:l.value.Label,items:l.value.Values,"item-title":"Title","item-value":"Value",variant:"outlined",disabled:m(V)||!1,"persistent-hint":m(g)||!1,"error-messages":p.value,rules:[v.value.required]},null,8,["modelValue","name","hint","label","items","disabled","persistent-hint","error-messages","rules"]))],64)):l.value.Type===m(X).RADIO?(s(),y(bt,{key:6,modelValue:o.value,"onUpdate:modelValue":e[10]||(e[10]=a=>o.value=a),name:n.name,hint:l.value.Hint,label:l.value.Label,disabled:m(V)||!1,"persistent-hint":m(g),"error-messages":p.value,rules:[v.value.required],onChange:i},{default:r(()=>[(s(!0),E(_,null,z(l.value.Values,a=>(s(),y(ht,{key:a.Value,label:a.Title,value:a.Value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","name","hint","label","disabled","persistent-hint","error-messages","rules"])):l.value.Type===m(X).ACCOMMODATION?(s(),y(ft,{key:7,modelValue:f.value,"onUpdate:modelValue":e[11]||(e[11]=a=>f.value=a),name:n.name,admin:m(R),convention:n.convention,"registration-group":n.registrationGroup,data:n.field.Data,hint:l.value.Hint,label:l.value.Label,items:l.value.Values,disabled:m(V)||!1,"persistent-hint":m(g),"error-messages":p.value,onChange:i},null,8,["modelValue","name","admin","convention","registration-group","data","hint","label","items","disabled","persistent-hint","error-messages"])):l.value.Type===m(X).AGE?(s(),y(pt,{key:8,modelValue:o.value,"onUpdate:modelValue":e[12]||(e[12]=a=>o.value=a),name:n.name,hint:l.value.Hint,label:l.value.Label,items:l.value.Values,disabled:m(V)||!1,"persistent-hint":m(g),"error-messages":p.value,onChange:i},null,8,["modelValue","name","hint","label","items","disabled","persistent-hint","error-messages"])):l.value.Type===m(X).EXTRAS?(s(),y(jl,{key:9,modelValue:o.value,"onUpdate:modelValue":e[13]||(e[13]=a=>o.value=a),convention:n.convention,name:n.name,hint:l.value.Hint,label:l.value.Label,items:l.value.Values,disabled:m(V)||!1,"persistent-hint":m(g),"error-messages":p.value,required:m(D),onChange:i},null,8,["modelValue","convention","name","hint","label","items","disabled","persistent-hint","error-messages","required"])):l.value.Type===m(X).INTERESTS?(s(),y(Zl,{key:10,modelValue:o.value,"onUpdate:modelValue":e[14]||(e[14]=a=>o.value=a),convention:n.convention,name:n.name,hint:l.value.Hint,label:l.value.Label,items:l.value.Values,disabled:m(V)||!1,"persistent-hint":m(g),"error-messages":p.value,required:m(D),onChange:i},null,8,["modelValue","convention","name","hint","label","items","disabled","persistent-hint","error-messages","required"])):l.value.Type===m(X).TICKET?(s(),y(lt,{key:11,modelValue:o.value,"onUpdate:modelValue":e[15]||(e[15]=a=>o.value=a),admin:m(R),convention:n.convention,name:n.name,"registration-group":n.registrationGroup,hint:l.value.Hint,label:l.value.Label,items:l.value.Values,disabled:m(V)||!1,"persistent-hint":m(g),"error-messages":p.value,required:m(D),onChange:i},null,8,["modelValue","admin","convention","name","registration-group","hint","label","items","disabled","persistent-hint","error-messages","required"])):M("",!0)}}),yt={key:0,class:"my-2 text-white text-center"},It=["innerHTML"],Vt=["innerHTML"],Yt=me({__name:"FormRenderer",props:ee({admin:{type:Boolean},convention:{},data:{},editable:{type:Boolean},preview:{type:Boolean},registrationGroup:{}},{modelValue:{required:!0}}),emits:["update:modelValue"],setup(t){const I=ve(t,"modelValue");He(I.value.Sections),I.value.Sections.forEach(o=>{o.Fields&&He(o.Fields)});const d=A(),R=xl(),V=Ze(),g=A(!1),D=A(!1),p=A(!1),c=A((()=>{if(t.data!==void 0){const i=Ue(t.data);return I.value.Sections.forEach(n=>{n.Fields&&n.Fields.forEach(e=>{const a=t.data.Data.find(b=>b.SectionFieldUUID===e.SectionFieldUUID&&b.SectionFieldUUID==e.SectionFieldUUID);if(a)e.Value=a.Data;else{const b={ID:0,SubmissionDataUUID:Le(),SubmissionID:t.data.ID,SubmissionUUID:t.data.SubmissionUUID,SectionID:n.ID,SectionUUID:n.SectionUUID,SectionFieldID:e.ID,SectionFieldUUID:e.SectionFieldUUID,Data:e.Value,CreatedAt:"",DeletedAt:"",UpdatedAt:""};i.Data.push(b)}})}),i}const o={ID:0,SubmissionUUID:Le(),FormID:I.value.ID,FormUUID:I.value.FormUUID,UserID:(R==null?void 0:R.ID)||0,UserUUID:(R==null?void 0:R.UserUUID)||"",Data:[],Status:pl.SUBMISSION_STATUS_OPEN,CreatedAt:"",DeletedAt:"",UpdatedAt:""};return o.Data=I.value.Sections.map(i=>i.Fields?i.Fields.map(n=>({ID:0,SubmissionDataUUID:Le(),SubmissionID:o.ID,SubmissionUUID:o.SubmissionUUID,SectionID:i.ID,SectionUUID:i.SectionUUID,SectionFieldID:n.ID,SectionFieldUUID:n.SectionFieldUUID,Data:n.Value,CreatedAt:"",DeletedAt:"",UpdatedAt:""})):[]).flat(),o})()),P=(o,i,n)=>{const e=c.value.Data.find(a=>a.SectionUUID===o&&a.SectionFieldUUID===i);e&&(e.Data=n)},l=(o,i,n,e)=>o&&o.Type===ae.FORM_TYPE_REGISTRATION?i?`/register/${t.convention.Slug||t.convention.ConventionUUID}/accommodation`:n?`/register/${t.convention.Slug||t.convention.ConventionUUID}/dealer`:e?`/register/${t.convention.Slug||t.convention.ConventionUUID}/badgeForm`:"/":o&&o.Type===ae.FORM_TYPE_ACCOMMODATION?n?`/register/${t.convention.Slug||t.convention.ConventionUUID}/dealer`:e?`/register/${t.convention.Slug||t.convention.ConventionUUID}/badge`:"/":o&&o.Type===ae.FORM_TYPE_DEALER?e?`/register/${t.convention.Slug||t.convention.ConventionUUID}/badge`:"/":(o&&o.Type===ae.FORM_TYPE_BADGE,"/"),v=({callback:o})=>{V.getRegistrationByConvention(t.convention.ConventionUUID).then(i=>{o&&o("Loading"),V.getAvailableConventionForms(t.convention.ConventionUUID).then(n=>{i.Submissions.forEach((B,U)=>{B.Form||(i.Submissions[U].Form=n.find($=>$.FormUUID===B.FormUUID))});const e=i.Submissions.find(B=>B.FormUUID===c.value.FormUUID),a=i.Submissions.find(B=>{var U;return((U=B.Form)==null?void 0:U.Type)===ae.FORM_TYPE_ACCOMMODATION}),b=i.Submissions.find(B=>{var U;return((U=B.Form)==null?void 0:U.Type)===ae.FORM_TYPE_DEALER}),C=i.Submissions.find(B=>{var U;return((U=B.Form)==null?void 0:U.Type)===ae.FORM_TYPE_BADGE}),S=l(e==null?void 0:e.Form,a==null?void 0:a.Form,b==null?void 0:b.Form,C==null?void 0:C.Form);Ge.push(S)})})},k=({callback:o})=>{var i;(i=d.value)==null||i.validate().then(n=>{n.valid?V.saveSubmission(c.value).then(e=>{e?setTimeout(()=>{f(e,o,1)},1e3):o&&o("Failed to process request")}).catch(()=>{o&&o("Failed to process request")}):o&&o("Errors in form detected, please review and try again.")})},f=(o,i,n=1)=>{V.checkSubmission(o).then(e=>{if(e)if(e.Ready&&e.Submission){if(g.value=!1,c.value=e.Submission,i&&i("Saved"),e.Forms&&e.Forms.length>0){const a=e.Forms.find(U=>U.FormUUID===c.value.FormUUID),b=e.Forms.find(U=>U.Type===ae.FORM_TYPE_ACCOMMODATION),C=e.Forms.find(U=>U.Type===ae.FORM_TYPE_DEALER),S=e.Forms.find(U=>U.Type===ae.FORM_TYPE_BADGE),B=l(a,b,C,S);Ge.push(B)}}else{if(n>5&&(g.value=!0),n>10&&(D.value=!0),n>20&&(p.value=!0),n>60){i&&(g.value=!1,D.value=!1,p.value=!1,i("A problem was encountered during saving, please check form and try again."));return}setTimeout(()=>{f(o,i,n+1)},n<20?1e3*n:2e4)}else i&&(g.value=!1,D.value=!1,p.value=!1,i("A problem was encountered during saving, please check form and try again."))}).catch(()=>{i&&(g.value=!1,D.value=!1,p.value=!1,i("A problem was encountered during saving, please check form and try again."))})};return(o,i)=>{const n=fl("router-link");return s(),y(Cl,null,{default:r(()=>[u(Kl,{ref_key:"formValidator",ref:d,onSubmit:i[0]||(i[0]=We(()=>{},["prevent"]))},{default:r(()=>[I.value.Heading?(s(),E("h1",yt,H(I.value.Heading),1)):M("",!0),I.value.Description?(s(),E("div",{key:1,class:"my-2 form-description-container pa-5 border rounded-lg",innerHTML:I.value.Description},null,8,It)):M("",!0),(s(!0),E(_,null,z(I.value.Sections,e=>(s(),y(Bl,{key:`section_${I.value.ID}.${e.ID}`,class:"my-4 section-container rounded-lg",elevation:"4"},{default:r(()=>[e.Heading?(s(),y(Gl,{key:0},{default:r(()=>[x(H(e.Heading),1)]),_:2},1024)):M("",!0),e.Description?(s(),y(Hl,{key:1,class:"text-wrap"},{default:r(()=>[Y("div",{innerHTML:e.Description},null,8,Vt)]),_:2},1024)):M("",!0),e.Fields?(s(),y(Yl,{key:2},{default:r(()=>[(s(!0),E(_,null,z(e.Fields,a=>(s(),E(_,{key:`field_${I.value.ID}.${e.ID}.${a.ID}`},[a.Field?(s(),y(Q,{key:0},{default:r(()=>[u(N,null,{default:r(()=>[o.editable?(s(),y(ze,{key:0,field:a.Field,modelValue:a.Value,"onUpdate:modelValue":b=>a.Value=b,admin:o.admin,convention:o.convention,"registration-group":o.registrationGroup,required:a.Required,"min-length":a.MinLength,"max-length":a.MaxLength,"persistent-hint":!0,onChange:b=>P(e.SectionUUID,a.SectionFieldUUID,a.Value)},null,8,["field","modelValue","onUpdate:modelValue","admin","convention","registration-group","required","min-length","max-length","onChange"])):(s(),y(ze,{key:1,field:a.Field,modelValue:a.Value,"onUpdate:modelValue":b=>a.Value=b,admin:o.admin,convention:o.convention,"registration-group":o.registrationGroup,required:a.Required,"min-length":a.MinLength,"max-length":a.MaxLength,"persistent-hint":!0,disabled:"",onChange:b=>P(e.SectionUUID,a.SectionFieldUUID,a.Value)},null,8,["field","modelValue","onUpdate:modelValue","admin","convention","registration-group","required","min-length","max-length","onChange"]))]),_:2},1024)]),_:2},1024)):M("",!0)],64))),128))]),_:2},1024)):M("",!0)]),_:2},1024))),128)),o.preview?M("",!0):(s(),E(_,{key:2},[u(Q,null,{default:r(()=>[u(N,{class:"text-right"},{default:r(()=>[u(n,{to:{name:"Home"},class:"text-decoration-none text-white"},{default:r(()=>[u(ne,{color:"red"},{default:r(()=>[x("Cancel")]),_:1})]),_:1})]),_:1}),o.editable?(s(),y(N,{key:0,class:"text-left"},{default:r(()=>[u(Ye,{onClick:k,type:"submit"})]),_:1})):(s(),y(N,{key:1,class:"text-left"},{default:r(()=>[u(Ye,{onClick:v,type:"submit",label:"Next",color:"green"})]),_:1}))]),_:1}),g.value?(s(),y(Q,{key:0},{default:r(()=>[u(N,{class:"bg-red-accent-4 border rounded-lg text-center mb-2"},{default:r(()=>[x(" Your request is currently queued for processing. Please be patient as this may take a while. ")]),_:1})]),_:1})):M("",!0),D.value?(s(),y(Q,{key:1},{default:r(()=>[u(N,{class:"bg-red-accent-4 border rounded-lg text-center mb-2"},{default:r(()=>[x(" Honestly! It really is being handled by our systems, the web browser window will continue, to monitor progress whilst it remains open. ")]),_:1})]),_:1})):M("",!0),p.value?(s(),y(Q,{key:2},{default:r(()=>[u(N,{class:"bg-red-accent-4 border rounded-lg text-center mb-2"},{default:r(()=>[x(" Jesus titty fucking christ! Why are there so many of you, this is ridiculous. ")]),_:1})]),_:1})):M("",!0)],64))]),_:1},512)]),_:1})}}});export{Ht as F,Je as V,ze as _,X as a,Yt as b};
