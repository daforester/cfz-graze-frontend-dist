import{i as de,M as se,N as ve,r as U,n as s,B as k,q as S,v as t,F as q,y as M,x as G,f as e,Q as ue,A as w,P as _e,D as Y,C as A,a0 as ia,m as ua,k as Ke,w as Te,G as Vt,H as kt,_ as Rt,Z as Me,c as It,a1 as Ct,a2 as Ot,O as Je,U as Mt,a3 as ra,b as da,E as st,z as Ve,V as ma}from"./index-4xYgdkuk.js";import{_ as ca,D as fa,a as va,b as Ua,c as pa,d as ga,e as Ta,f as ya,g as _a,h as Ia,A as fe,u as nt,i as Da,P as Aa,j as Dt,L as Sa,M as Ea,U as ha,k as B,l as Ee,m as ba,n as Va,o as Z}from"./useTokenManager-YIXyjolc.js";import{d as ka,b as Lt,c as Ra}from"./FormRenderer.vue_vue_type_style_index_0_lang-h4p87ohu.js";import{F as re,a as Ca}from"./form-0fJbSFPv.js";import{b as Oa,c as wt,d as At,S as Ma}from"./submission-40fey8Hx.js";import{G as dt}from"./group-7fhbY6WJ.js";import{C as mt}from"./canDo-8w-iwWYc.js";import{_ as ct}from"./ModelDialog.vue_vue_type_script_setup_true_lang-apOlX0I_.js";import{a as ke,c as Nt,V as ft,b as La}from"./VList-pzsIS5D0.js";import{V as W}from"./VBtn-nEpVgtCI.js";import{V as Ft}from"./VAvatar-y17-wQdN.js";import{s as wa}from"./sortSubmissions-NKScr9xj.js";import{V as it,u as Na}from"./VSpacer-P0VeEwOm.js";import{u as Pt}from"./useModel-Tk3M0y9M.js";import{V as $t,b as Yt,_ as Gt,a as ut}from"./VTabs-Cpp2G5Ti.js";import{u as Fa,P as Pa}from"./useDisplayTransactions-r_K5rqBK.js";import{G as Qe}from"./userData-SUa2peUG.js";import{a as vt,V as Ut,c as je,e as Le,d as $a}from"./VCard-urNdGsWd.js";import{V as ae,a as V}from"./VRow-Oxnn8QB6.js";import{_ as rt,a as Ya}from"./SaveButton.vue_vue_type_script_setup_true_lang-BlbXD-HM.js";import{V as oe}from"./VSelect-YZABySN7.js";import{V as xt,a as me}from"./VContainer-idBlWw-g.js";import{V as Ga,a as xa}from"./VAlert-Lk_mHMK3.js";import{V as Oe}from"./VCheckbox-GRXoYX3Q.js";import{a as Se,V as Bt}from"./VWindowItem-1LIRjTd6.js";import{S as Ba}from"./setupLogin-GASzdLXU.js";import{_ as qa}from"./SelectGroups.vue_vue_type_script_setup_true_lang-AP5EDQXj.js";import{_ as Ha}from"./DeleteDialog.vue_vue_type_script_setup_true_lang-WfhOTd1W.js";import{V as ee}from"./VTextField-ozhsr0ft.js";import{v as ye}from"./v4-yQnnJER4.js";import{V as qt}from"./VDialog-Jh5_yO6e.js";import{c as za}from"./copyToClipboard-aCoRGJiH.js";import{u as Ka}from"./useAvatar-K3kVN0Cx.js";import{V as Ja}from"./forwardRefs-hvhJWHEi.js";import{u as ze}from"./nil-rxyd0N8M.js";import{a as Qa}from"./VTable-yK9iNvEt.js";import{V as St,a as ja}from"./VToolbar-gn4a3g6g.js";import{V as Wa}from"./VDataTableServer-g9PArtja.js";import{V as Xa,a as Za,b as el,c as tl,e as al}from"./VDataTable-Uq3-5FMQ.js";import"./canEditRegistrations-PHKxD3Wu.js";import"./VAutocomplete-az6BX3mx.js";import"./filter-DVZn3oYe.js";import"./VCheckboxBtn-Jb8ySQZ2.js";import"./VChip-UjoYyCBJ.js";import"./VDivider-wLg9up-4.js";import"./VTextarea-VqsE7Zly.js";import"./VForm-YXi4cMlk.js";import"./VNavigationDrawer-52YV84ZZ.js";import"./scopeId-A-hmXfQ-.js";import"./index-OKsbKlsK.js";import"./VFileInput-kdcjGNTf.js";import"./createSimpleFunctional-j-ujQ2df.js";import"./VToolbarItems-LNVf4ihN.js";import"./VOverlay-Y8ej_Na_.js";const ll=()=>({ID:0,UserUUID:"",DisplayName:"",Handle:"",Credentials:[],Additional:{FirstName:"",LastName:"",DOB:"",Email:""},Data:"",Groups:[],Tags:[]}),ol=E=>E===void 0?!1:mt(E,dt.GROUP_TYPE_SYSTEM).ManageUsers,nl=de({__name:"DataTableItemPanel",props:se({accommodations:{},cardClass:{},convention:{},extras:{},forms:{},interests:{},tickets:{},venues:{},layouts:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:se(["openActions","showForm"],["update:modelValue"]),setup(E,{emit:N}){const f=N,p=ve(E,"modelValue"),T=U(),y=_e(),m=U(),a=U(!1),u=D=>{const _={AdminLayoutUUID:D.AdminLayoutUUID,Limit:1,RegistrationUUID:p.value.RegistrationUUID};y.searchConventionRegistrations(p.value.ConventionUUID,_).then(b=>{b&&b.Total>0&&(T.value=b.Registrations[0],m.value=D,a.value=!0)})},r=D=>{f("openActions",D)},h=(D,_,b)=>{f("showForm",D,_,b)};return(D,_)=>(s(),k("div",null,[D.layouts?(s(),S(ft,{key:0},{default:t(()=>[(s(!0),k(q,null,ue(D.layouts,b=>(s(),S(ke,{key:b.AdminLayoutUUID,class:"d-block pa-0 ma-0"},{default:t(()=>[e(Nt,{style:{"text-overflow":"inherit"},class:"overflow-visible text-wrap"},{default:t(()=>[e(W,{"prepend-icon":"mdi:mdi-page-layout-body",variant:"flat",onClick:K=>u(b)},{default:t(()=>[G(M(b.Name),1)]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024))),128))]),_:1})):w("",!0),a.value&&m.value&&T.value?(s(),S(ct,{key:1,modelValue:a.value,"onUpdate:modelValue":_[2]||(_[2]=b=>a.value=b),"hide-extension":!0,fullscreen:!0,title:`#${T.value.Reference} ${T.value.User.DisplayName} - ${m.value.Name} `,scrollable:!0,"card-class":"pa-0","card-style":"margin-bottom: -52px"},{default:t(()=>[e(ca,{accommodations:D.accommodations,convention:D.convention,extras:D.extras,forms:D.forms,interests:D.interests,tickets:D.tickets,venues:D.venues,layout:m.value,"onUpdate:layout":_[0]||(_[0]=b=>m.value=b),modelValue:T.value,"onUpdate:modelValue":_[1]||(_[1]=b=>T.value=b),onOpenActions:r,onShowForm:h},null,8,["accommodations","convention","extras","forms","interests","tickets","venues","layout","modelValue"])]),_:1},8,["modelValue","title"])):w("",!0)]))}}),sl={class:"text-grey-lighten-1"},il={key:0,class:"mb-2"},ul=Y("strong",null,"Email",-1),rl=Y("br",null,null,-1),dl={key:1,class:"mb-2"},ml=Y("strong",null,"Telegram",-1),cl=Y("br",null,null,-1),fl={key:0,class:"text-blue text-center"},vl={key:1,class:"text-red text-center"},Ul={key:2,class:"text-orange text-center"},pl={key:3,class:"text-orange text-center"},gl={key:4,class:"text-orange text-center"},Tl={key:5,class:"text-orange text-center"},yl={key:6,class:"text-green text-center"},_l={key:0},Il={key:0},Dl=Y("strong",null,"Total:",-1),Al=de({__name:"RegListRow",props:se({header:{},accommodations:{},convention:{},extras:{},forms:{},interests:{},item:{},tickets:{},user:{},venues:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:se(["openActions","openPayments","openTags","reload","showForm","switchUser"],["update:modelValue"]),setup(E,{emit:N}){const f=N,p=ve(E,"modelValue"),T=(a,u)=>{f("showForm",{registration:a,form:u})},y=a=>{f("openActions",a)},m=a=>{f("switchUser",a)};return(a,u)=>a.header.type==="ACCOMMODATION"&&a.accommodations.length>0&&a.item.raw[a.header.key]?(s(),S(fa,{key:0,value:a.item.raw[a.header.key].Data,accommodations:a.accommodations,convention:a.convention,forms:a.forms,tickets:a.tickets,venues:a.venues,registration:a.item.raw[a.header.key].Registration},null,8,["value","accommodations","convention","forms","tickets","venues","registration"])):a.header.type==="EXTRAS"&&a.extras.length>0?(s(),S(va,{key:1,value:a.item.raw[a.header.key],extras:a.extras},null,8,["value","extras"])):a.header.type==="INTERESTS"&&a.interests.length>0?(s(),S(Ua,{key:2,value:a.item.raw[a.header.key],interests:a.interests},null,8,["value","interests"])):a.header.type==="TICKET"&&a.tickets.length>0?(s(),S(pa,{key:3,value:a.item.raw[a.header.key],tickets:a.tickets},null,8,["value","tickets"])):a.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_CHECKIN_STATUS"?(s(),S(ga,{key:4,convention:a.convention,"show-controls":!1,modelValue:a.item.raw.registration,"onUpdate:modelValue":u[0]||(u[0]=r=>a.item.raw.registration=r)},null,8,["convention","modelValue"])):a.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_SUBMISSION_STATUS"||a.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_ACCOMMODATION_FORM"||a.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_ADMIN_FORM"||a.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_DEALER_FORM"||a.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_BADGE_FORM"||a.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_REGISTRATION_FORM"?(s(),k(q,{key:5},[Y("ul",null,[(s(!0),k(q,null,ue(a.forms.filter(r=>r.Type===A(re).FORM_TYPE_ADMIN&&a.item.raw[a.header.key].findIndex(h=>h.Form.ID===r.ID)<0),r=>(s(),k("li",{key:r.Heading},[Y("strong",sl,M(r.Heading),1),e(W,{class:"text-grey-lighten-1",icon:"mdi:mdi-form-select",title:"Edit Submitted Data",variant:"flat",onClick:h=>T(a.item.raw.registration,r)},null,8,["onClick"])]))),128))]),Y("ul",null,[(s(!0),k(q,null,ue(a.item.raw[a.header.key],r=>(s(),k("li",{key:r.Heading},[Y("strong",null,[G(M(r.Heading),1),r.Form.Type!==A(re).FORM_TYPE_ADMIN?(s(),k(q,{key:0},[G(": ")],64)):w("",!0)]),r.Form.Type!==A(re).FORM_TYPE_ADMIN?(s(),k("span",{key:0,class:ia(A(Oa)(r.Submission.Status))},M(A(wt)(r.Submission.Status)),3)):w("",!0),e(W,{icon:"mdi:mdi-form-select",title:"Edit Submitted Data",variant:"flat",onClick:h=>T(r.Registration,r.Form)},null,8,["onClick"])]))),128))])],64)):a.header.type==="LAYOUT_ITEM_SOURCE_USER.USER_DATA_SOURCE_AVATAR"?(s(),S(Ft,{key:6,class:"rounded-circle",src:a.item.raw[a.header.key],height:"32",width:"32"},null,8,["src"])):a.header.type==="LAYOUT_ITEM_SOURCE_USER.USER_DATA_SOURCE_CONTACTS"?(s(),k(q,{key:7},[a.item.raw[a.header.key].email?(s(),k("p",il,[ul,rl,G(M(a.item.raw[a.header.key].email),1)])):w("",!0),a.item.raw[a.header.key].telegram?(s(),k("p",dl,[ml,cl,G(M(a.item.raw[a.header.key].telegram),1)])):w("",!0)],64)):a.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_PAYMENT_STATUS"?(s(),k(q,{key:8},[a.item.raw[a.header.key]=="NOT_REQUIRED"?(s(),k("div",fl,"No Payment Requested")):a.item.raw[a.header.key]=="MISSING_REQUIRED"?(s(),k("div",vl,"Partner Payment Not Requested")):a.item.raw[a.header.key]=="AWAITING_PARTNER"?(s(),k("div",Ul,"Awaiting Partner Payment")):a.item.raw[a.header.key]=="ALL_REQUIRED"?(s(),k("div",pl,"Awaiting Payments")):a.item.raw[a.header.key]=="REQUIRED"?(s(),k("div",gl,"Awaiting Payment")):a.item.raw[a.header.key]=="ADDITIONAL_REQUIRED"?(s(),k("div",Tl,"Awaiting Additional Payments")):(s(),k("div",yl,"Completed"))],64)):a.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_REGISTRATION_ACTIONS"?(s(),k(q,{key:9},[e(W,{icon:"mdi:mdi-briefcase",variant:"flat",onClick:u[1]||(u[1]=r=>y(a.item.raw[a.header.key]))}),A(ol)(a.user)?(s(),S(W,{key:0,icon:"mdi:mdi-account-switch-outline",variant:"flat",onClick:u[2]||(u[2]=r=>m(a.item.raw[a.header.key]))})):w("",!0)],64)):a.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_REGISTRATION_GROUP"?(s(),k(q,{key:10},[a.item.raw[a.header.key].length===1?(s(),k("em",_l," Not in a group ")):(s(),k(q,{key:1},[Y("ul",null,[(s(!0),k(q,null,ue(a.item.raw[a.header.key],r=>(s(),k("li",{key:r.UUID,class:"ml-0"},[G(" #"+M(r.Reference)+" : "+M(r.Name)+" ",1),r.IsLeader?(s(),k("strong",Il,"(Leader)")):w("",!0)]))),128))]),Dl,G(" "+M(a.item.raw[a.header.key].length),1)],64))],64)):a.header.type==="LAYOUT_ITEM_SOURCE_META.META_DATA_SOURCE_DATA_LAYOUT"?(s(),k(q,{key:11},[p.value.registration?(s(),S(nl,{key:0,accommodations:a.accommodations,convention:a.convention,extras:a.extras,forms:a.forms,interests:a.interests,tickets:a.tickets,venues:a.venues,layouts:a.item.raw[a.header.key].Layouts,modelValue:p.value.registration,"onUpdate:modelValue":u[3]||(u[3]=r=>p.value.registration=r),onOpenActions:y,onShowForm:T},null,8,["accommodations","convention","extras","forms","interests","tickets","venues","layouts","modelValue"])):w("",!0)],64)):(s(),k(q,{key:12},[G(M(a.item.raw[a.header.key]),1)],64))}}),Et=de({__name:"RegistrationActionTabs",props:se({alignTabs:{},class:{},fixedTabs:{type:Boolean},showArrows:{type:[String,Boolean]},tabs:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(E){const N=E,f=ve(E,"modelValue");return(p,T)=>(s(),S($t,ua({modelValue:f.value,"onUpdate:modelValue":T[0]||(T[0]=y=>f.value=y)},N),{default:t(()=>[(s(!0),k(q,null,ue(p.tabs,y=>(s(),S(Yt,{value:y.value,key:y.value},{default:t(()=>[G(M(y.label),1)]),_:2},1032,["value"]))),128))]),_:1},16,["modelValue"]))}}),Sl=(E=void 0,N)=>E===void 0?!1:mt(E,dt.GROUP_TYPE_CONVENTION,N.ConventionUUID,N).EditPaymentTransactions,We=E=>(Vt("data-v-861debd5"),E=E(),kt(),E),El={class:"mb-4"},hl={class:"v-row"},bl={key:0,class:"v-col v-col-10 py-1 v-row mx-0 pl-0"},Vl={class:"v-col v-col-12 v-col-sm-4 v-col-md-3 font-weight-bold pb-0 pr-0"},kl={class:"v-col v-col-12 v-col-sm-8 v-col-md-9 font-italic pt-0 pt-sm-3 pb-sm-0 pl-sm-0"},Rl={class:"v-col v-col-2 align-self-end text-right py-1 text-no-wrap"},Cl=We(()=>Y("dt",{class:"v-col v-col-9 py-1 font-weight-bold totals"}," Total Charges ",-1)),Ol={class:"v-col v-col-3 align-self-end text-right py-1 totals text-no-wrap"},Ml=We(()=>Y("dt",{class:"v-col v-col-9 py-1 font-weight-bold"}," Applied Total ",-1)),Ll={class:"v-col v-col-3 align-self-end text-right py-1 text-no-wrap"},wl=We(()=>Y("dt",{class:"v-col v-col-9 py-1 font-weight-bold"}," Currently Paid ",-1)),Nl={class:"v-col v-col-3 align-self-end text-right py-1 text-no-wrap"},Fl=We(()=>Y("dt",{class:"v-col v-col-9 py-1 font-weight-bold totals"}," Balance ",-1)),Pl={class:"v-col v-col-3 align-self-end text-right py-1 totals text-no-wrap"},$l=de({__name:"PaymentActions",props:se({forms:{},title:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(E){const N=U(!1),f=U(),p=U([]),T=U(new Date().getTime()),y=U(!1),m=ve(E,"modelValue"),a=U(Ke(m.value));Te(m,()=>{a.value=Ke(m.value)});const u=_e();u.getConvention(m.value.ConventionUUID).then(_=>{_&&(y.value=Sl(Qe(),_))});const r=()=>{u.generateRegistrationCharges(m.value.RegistrationUUID,!1).then(_=>{_&&(p.value=_.PaymentTransactions,f.value=_.Registration,T.value=new Date().getTime())}).catch(()=>{})};r();const h=()=>{u.generateRegistrationCharges(m.value.RegistrationUUID,!0).then(_=>{_&&(p.value=_.PaymentTransactions,f.value=_.Registration,T.value=new Date().getTime())})},{totalCharges:D}=Fa();return(_,b)=>(s(),S(Le,null,{default:t(()=>[e(Ut,null,{default:t(()=>[e(vt,null,{default:t(()=>[G(" Payments (#"+M(m.value.Reference)+" "+M(m.value.User.DisplayName)+") ",1)]),_:1})]),_:1}),e(je,null,{default:t(()=>[f.value?(s(),k(q,{key:0},[Y("h3",El,"#"+M(f.value.Reference)+" "+M(f.value.User.DisplayName),1),Y("dl",hl,[(s(!0),k(q,null,ue(p.value,K=>(s(),k(q,{key:K.PaymentTransactionUUID},[K.Type===A(Pa).PAYMENT_TRANSACTION_TYPE_CHARGE?(s(),k("dt",bl,[Y("div",Vl,M(K.Description.split(":")[0])+": ",1),Y("div",kl,M(K.Description.split(":")[1]),1)])):w("",!0),Y("dd",Rl," £"+M(K.Amount),1)],64))),128)),Cl,Y("dd",Ol," £"+M(A(D)(p.value)),1),Ml,Y("dd",Ll," £"+M(f.value.Total),1),wl,Y("dd",Nl," £"+M(f.value.Paid),1),Fl,Y("dd",Pl," £"+M(f.value.Total-f.value.Paid),1)]),e(ae,{class:"flex-row-reverse"},{default:t(()=>[e(V,{class:"text-right"},{default:t(()=>[e(W,{color:"primary",onClick:h},{default:t(()=>[G("Apply Charges")]),_:1})]),_:1}),!N.value&&y.value?(s(),S(V,{key:0},{default:t(()=>[e(W,{color:"secondary",onClick:b[0]||(b[0]=K=>N.value=!0)},{default:t(()=>[G("Transaction Entry")]),_:1})]),_:1})):w("",!0)]),_:1})],64)):w("",!0),e(Ta,{"can-edit":y.value,registration:m.value,"show-editor":N.value,onCloseEditor:b[1]||(b[1]=K=>N.value=!1),updated:T.value,onChange:r},null,8,["can-edit","registration","show-editor","updated"])]),_:1})]),_:1}))}}),Yl=Rt($l,[["__scopeId","data-v-861debd5"]]),Gl=de({__name:"RegistrationFormStatus",props:se({forms:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(E){const N=_e(),f=ve(E,"modelValue"),p=(T,y)=>{const m=f.value.Submissions.find(a=>a.SubmissionUUID==y);if(!m){T&&T("Submission not found");return}N.setSubmissionStatus(y,m.Status).then(a=>{a?(f.value.Submissions.forEach((u,r)=>{f.value.Submissions[r].Status=u.Status}),T&&T("Status Saved")):T&&T("Status not saved")}).catch(()=>{T&&T("Status not saved")})};return(T,y)=>(s(),S(Le,null,{default:t(()=>[e(Ut,null,{default:t(()=>[e(vt,null,{default:t(()=>[G("Status (#"+M(f.value.Reference)+" "+M(f.value.User.DisplayName)+")",1)]),_:1})]),_:1}),e(je,null,{default:t(()=>[e(ft,null,{default:t(()=>[(s(!0),k(q,null,ue(f.value.Submissions,m=>(s(),S(ke,{key:m.SubmissionUUID,class:"pa-0"},{default:t(()=>[e(ae,{class:"py-2 align-center"},{default:t(()=>[e(V,{cols:"9",sm:"10",md:"10",lg:"9"},{default:t(()=>{var a;return[e(oe,{modelValue:m.Status,"onUpdate:modelValue":u=>m.Status=u,items:A(At),"item-text":"title","item-value":"value",variant:"outlined","hide-details":"",label:((a=T.forms.find(u=>u.FormUUID==m.FormUUID))==null?void 0:a.Name)||""},{selection:t(()=>[e(xt,{class:"mr-4 d-none d-sm-inline"},{default:t(()=>{var u;return[G(M((u=A(At).find(r=>r.value===m.Status))==null?void 0:u.icon),1)]}),_:2},1024),G(" "+M(A(wt)(m.Status)),1)]),item:t(({item:u,props:{onClick:r}})=>[e(ke,{title:u.title,"prepend-icon":u.raw.icon,onClick:r},null,8,["title","prepend-icon","onClick"])]),_:2},1032,["modelValue","onUpdate:modelValue","items","label"])]}),_:2},1024),e(V,{cols:"3",sm:"2",md:"2",lg:"1"},{default:t(()=>[e(rt,{class:"d-none d-sm-inline-flex",title:"Save","prepend-icon":"mdi:mdi-content-save",color:"warning",onClick:a=>p(a.callback,m.SubmissionUUID)},null,8,["onClick"]),e(rt,{class:"d-sm-none",size:"35",icon:"mdi:mdi-content-save",color:"warning",onClick:a=>p(a.callback,m.SubmissionUUID)},null,8,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1}))}}),xl=E=>(Vt("data-v-a4024c39"),E=E(),kt(),E),Bl=xl(()=>Y("p",null,"Any tags controlled through registration form fields will be reset when the applicable form is saved. If you don't know what you're doing here, don't touch!",-1)),ql={class:"mb-4"},Hl=de({__name:"RegistrationTags",props:se({title:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(E){const N=_e(),f=ve(E,"modelValue"),p=U(Ke(f.value)),T=U(!1),y=U(p.value.Tags);Te(f,()=>{p.value=Ke(f.value)});const m=({callback:a})=>{const u=[],r=[];p.value.Tags.forEach(h=>{y.value.find(_=>_.TagUUID===h.TagUUID)||u.push(h.TagUUID)}),y.value.forEach(h=>{p.value.Tags.find(_=>h.TagUUID===_.TagUUID)||r.push(h.TagUUID)}),N.updateRegistrationTags(u,r,p.value.RegistrationUUID).then(h=>{h?a&&(a("Tags Saved"),f.value.Tags=h.Tags):a&&a("Error Saving Tags")}).catch(()=>{a&&a("Error Saving Tags")})};return(a,u)=>(s(),S(Le,null,{default:t(()=>[e(Ut,null,{default:t(()=>[e(vt,null,{default:t(()=>[G("Tags (#"+M(p.value.Reference)+" "+M(p.value.User.DisplayName)+")",1)]),_:1})]),_:1}),e(je,null,{default:t(()=>[e(Ga,{class:"my-4"},{default:t(()=>[e(xa,null,{default:t(()=>[G("Caution")]),_:1}),Bl]),_:1}),Y("h3",ql,"#"+M(p.value.Reference)+" "+M(p.value.User.DisplayName),1),e(Gt,{modelValue:p.value.Tags,"onUpdate:modelValue":u[0]||(u[0]=r=>p.value.Tags=r),convention:p.value.ConventionUUID,"show-key":!0,chips:!0,"show-uuid":T.value},null,8,["modelValue","convention","show-uuid"])]),_:1}),e($a,{class:"px-4 align-start"},{default:t(()=>[e(Oe,{label:"Show UUID",modelValue:T.value,"onUpdate:modelValue":u[1]||(u[1]=r=>T.value=r)},null,8,["modelValue"]),e(rt,{onClick:m,variant:"flat"})]),_:1})]),_:1}))}}),zl=Rt(Hl,[["__scopeId","data-v-a4024c39"]]),ht=de({__name:"RegistrationActionWindows",props:se({accommodations:{},convention:{},extras:{},forms:{},interests:{},registration:{},tickets:{},venues:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:se(["update:registration"],["update:modelValue"]),setup(E,{emit:N}){const f=E,p=ve(E,"modelValue"),y=Pt(f,N,void 0,void 0,"registration");return(m,a)=>(s(),S(Bt,{modelValue:p.value,"onUpdate:modelValue":a[3]||(a[3]=u=>p.value=u),disabled:!0,touch:!1},{default:t(()=>[e(Se,{value:"badges"},{default:t(()=>[p.value=="badges"?(s(),S(me,{key:0,class:"pa-0 mx-0",fluid:!0},{default:t(()=>[e(ya,{convention:m.convention,registration:A(y)},null,8,["convention","registration"])]),_:1})):w("",!0)]),_:1}),e(Se,{value:"emails"},{default:t(()=>[p.value=="emails"?(s(),S(me,{key:0,class:"pa-0 mx-0",fluid:!0},{default:t(()=>[e(_a,{registration:A(y)},null,8,["registration"])]),_:1})):w("",!0)]),_:1}),e(Se,{value:"notes"},{default:t(()=>[p.value=="notes"?(s(),S(me,{key:0,class:"pa-0 mx-0",fluid:!0},{default:t(()=>[e(Ia,{convention:m.convention,expanded:!1,registration:A(y)},null,8,["convention","registration"])]),_:1})):w("",!0)]),_:1}),e(Se,{value:"payments"},{default:t(()=>[p.value=="payments"?(s(),S(me,{key:0,class:"pa-0 mx-0",fluid:!0},{default:t(()=>[e(Yl,{modelValue:A(y),"onUpdate:modelValue":a[0]||(a[0]=u=>Me(y)?y.value=u:null),forms:m.forms,title:"Registration Payments"},null,8,["modelValue","forms"])]),_:1})):w("",!0)]),_:1}),e(Se,{value:"status"},{default:t(()=>[p.value=="status"?(s(),S(me,{key:0,class:"pa-0 mx-0",fluid:!0},{default:t(()=>[e(Gl,{modelValue:A(y),"onUpdate:modelValue":a[1]||(a[1]=u=>Me(y)?y.value=u:null),forms:m.forms},null,8,["modelValue","forms"])]),_:1})):w("",!0)]),_:1}),e(Se,{value:"tags"},{default:t(()=>[p.value=="tags"?(s(),S(me,{key:0,class:"pa-0 mx-0",fluid:!0},{default:t(()=>[e(zl,{modelValue:A(y),"onUpdate:modelValue":a[2]||(a[2]=u=>Me(y)?y.value=u:null),title:"Registration Tags"},null,8,["modelValue"])]),_:1})):w("",!0)]),_:1})]),_:1},8,["modelValue"]))}}),Kl=(E,N)=>E===void 0?!1:mt(E,dt.GROUP_TYPE_CONVENTION,N.ConventionUUID,N).ViewPaymentTransactions,Jl={key:0},Ql={key:1},bt=de({__name:"RegistrationActions",props:se({accommodations:{},convention:{},extras:{},forms:{},interests:{},registration:{},tickets:{},title:{},useDialog:{type:Boolean},venues:{}},{modelValue:{type:Boolean,required:!0},modelModifiers:{}}),emits:se(["update:registration"],["update:modelValue"]),setup(E,{emit:N}){const f=E,p=ve(E,"modelValue"),y=Pt(f,N,void 0,void 0,"registration"),m=U("notes"),a=Qe(),u=[{label:"Badge",value:"badges"},{label:"Emails",value:"emails"},{label:"Notes",value:"notes"},{label:"Status",value:"status"},{label:"Tags",value:"tags"}];return Kl(a,f.convention)&&u.splice(2,0,{label:"Payments",value:"payments"}),(r,h)=>r.useDialog?(s(),k("div",Jl,[e(ct,{modelValue:p.value,"onUpdate:modelValue":h[3]||(h[3]=D=>p.value=D),title:r.title,"show-close-action":!0,color:"primary","close-action-label":"Close",persistent:!0,"retain-focus":!1,scrollable:!0,fullscreen:"","card-class":"ma-0 pa-0"},{extension:t(()=>[e(Et,{modelValue:m.value,"onUpdate:modelValue":h[0]||(h[0]=D=>m.value=D),tabs:u,"show-arrows":!0},null,8,["modelValue"])]),default:t(()=>[e(ht,{modelValue:m.value,"onUpdate:modelValue":h[1]||(h[1]=D=>m.value=D),registration:A(y),"onUpdate:registration":h[2]||(h[2]=D=>Me(y)?y.value=D:null),accommodations:r.accommodations,convention:r.convention,extras:r.extras,forms:r.forms,interests:r.interests,tabs:u,tickets:r.tickets,venues:r.venues},null,8,["modelValue","registration","accommodations","convention","extras","forms","interests","tickets","venues"])]),_:1},8,["modelValue","title"])])):(s(),k("div",Ql,[e(Et,{modelValue:m.value,"onUpdate:modelValue":h[4]||(h[4]=D=>m.value=D),tabs:u,"show-arrows":!0},null,8,["modelValue"]),e(ht,{modelValue:m.value,"onUpdate:modelValue":h[5]||(h[5]=D=>m.value=D),registration:A(y),"onUpdate:registration":h[6]||(h[6]=D=>Me(y)?y.value=D:null),accommodations:r.accommodations,convention:r.convention,extras:r.extras,forms:r.forms,interests:r.interests,tabs:u,tickets:r.tickets,venues:r.venues},null,8,["modelValue","registration","accommodations","convention","extras","forms","interests","tickets","venues"])]))}}),jl=(E,N=500,f=!1)=>{let p;return(...T)=>{const m=function(){p=void 0,f||E.apply(void 0,T)},a=f&&!p;clearTimeout(p),p=setTimeout(m,N),a&&E.apply(void 0,T)}},Ht=(E,N)=>{E.forEach(f=>{f.Items.forEach(p=>{(p.SectionField==null||p.SectionField.Field==null)&&N.find(T=>{T.Sections.find(y=>{if(y.Fields){const m=y.Fields.find(a=>a.SectionFieldUUID===p.SectionFieldUUID);if(m)return p.SectionField=m,!0}})})})})},Wl={base:"#f44336",lighten5:"#ffebee",lighten4:"#ffcdd2",lighten3:"#ef9a9a",lighten2:"#e57373",lighten1:"#ef5350",darken1:"#e53935",darken2:"#d32f2f",darken3:"#c62828",darken4:"#b71c1c",accent1:"#ff8a80",accent2:"#ff5252",accent3:"#ff1744",accent4:"#d50000"},Xl={base:"#e91e63",lighten5:"#fce4ec",lighten4:"#f8bbd0",lighten3:"#f48fb1",lighten2:"#f06292",lighten1:"#ec407a",darken1:"#d81b60",darken2:"#c2185b",darken3:"#ad1457",darken4:"#880e4f",accent1:"#ff80ab",accent2:"#ff4081",accent3:"#f50057",accent4:"#c51162"},Zl={base:"#9c27b0",lighten5:"#f3e5f5",lighten4:"#e1bee7",lighten3:"#ce93d8",lighten2:"#ba68c8",lighten1:"#ab47bc",darken1:"#8e24aa",darken2:"#7b1fa2",darken3:"#6a1b9a",darken4:"#4a148c",accent1:"#ea80fc",accent2:"#e040fb",accent3:"#d500f9",accent4:"#aa00ff"},eo={base:"#673ab7",lighten5:"#ede7f6",lighten4:"#d1c4e9",lighten3:"#b39ddb",lighten2:"#9575cd",lighten1:"#7e57c2",darken1:"#5e35b1",darken2:"#512da8",darken3:"#4527a0",darken4:"#311b92",accent1:"#b388ff",accent2:"#7c4dff",accent3:"#651fff",accent4:"#6200ea"},to={base:"#3f51b5",lighten5:"#e8eaf6",lighten4:"#c5cae9",lighten3:"#9fa8da",lighten2:"#7986cb",lighten1:"#5c6bc0",darken1:"#3949ab",darken2:"#303f9f",darken3:"#283593",darken4:"#1a237e",accent1:"#8c9eff",accent2:"#536dfe",accent3:"#3d5afe",accent4:"#304ffe"},ao={base:"#2196f3",lighten5:"#e3f2fd",lighten4:"#bbdefb",lighten3:"#90caf9",lighten2:"#64b5f6",lighten1:"#42a5f5",darken1:"#1e88e5",darken2:"#1976d2",darken3:"#1565c0",darken4:"#0d47a1",accent1:"#82b1ff",accent2:"#448aff",accent3:"#2979ff",accent4:"#2962ff"},lo={base:"#03a9f4",lighten5:"#e1f5fe",lighten4:"#b3e5fc",lighten3:"#81d4fa",lighten2:"#4fc3f7",lighten1:"#29b6f6",darken1:"#039be5",darken2:"#0288d1",darken3:"#0277bd",darken4:"#01579b",accent1:"#80d8ff",accent2:"#40c4ff",accent3:"#00b0ff",accent4:"#0091ea"},oo={base:"#00bcd4",lighten5:"#e0f7fa",lighten4:"#b2ebf2",lighten3:"#80deea",lighten2:"#4dd0e1",lighten1:"#26c6da",darken1:"#00acc1",darken2:"#0097a7",darken3:"#00838f",darken4:"#006064",accent1:"#84ffff",accent2:"#18ffff",accent3:"#00e5ff",accent4:"#00b8d4"},no={base:"#009688",lighten5:"#e0f2f1",lighten4:"#b2dfdb",lighten3:"#80cbc4",lighten2:"#4db6ac",lighten1:"#26a69a",darken1:"#00897b",darken2:"#00796b",darken3:"#00695c",darken4:"#004d40",accent1:"#a7ffeb",accent2:"#64ffda",accent3:"#1de9b6",accent4:"#00bfa5"},so={base:"#4caf50",lighten5:"#e8f5e9",lighten4:"#c8e6c9",lighten3:"#a5d6a7",lighten2:"#81c784",lighten1:"#66bb6a",darken1:"#43a047",darken2:"#388e3c",darken3:"#2e7d32",darken4:"#1b5e20",accent1:"#b9f6ca",accent2:"#69f0ae",accent3:"#00e676",accent4:"#00c853"},io={base:"#8bc34a",lighten5:"#f1f8e9",lighten4:"#dcedc8",lighten3:"#c5e1a5",lighten2:"#aed581",lighten1:"#9ccc65",darken1:"#7cb342",darken2:"#689f38",darken3:"#558b2f",darken4:"#33691e",accent1:"#ccff90",accent2:"#b2ff59",accent3:"#76ff03",accent4:"#64dd17"},uo={base:"#cddc39",lighten5:"#f9fbe7",lighten4:"#f0f4c3",lighten3:"#e6ee9c",lighten2:"#dce775",lighten1:"#d4e157",darken1:"#c0ca33",darken2:"#afb42b",darken3:"#9e9d24",darken4:"#827717",accent1:"#f4ff81",accent2:"#eeff41",accent3:"#c6ff00",accent4:"#aeea00"},ro={base:"#ffeb3b",lighten5:"#fffde7",lighten4:"#fff9c4",lighten3:"#fff59d",lighten2:"#fff176",lighten1:"#ffee58",darken1:"#fdd835",darken2:"#fbc02d",darken3:"#f9a825",darken4:"#f57f17",accent1:"#ffff8d",accent2:"#ffff00",accent3:"#ffea00",accent4:"#ffd600"},mo={base:"#ffc107",lighten5:"#fff8e1",lighten4:"#ffecb3",lighten3:"#ffe082",lighten2:"#ffd54f",lighten1:"#ffca28",darken1:"#ffb300",darken2:"#ffa000",darken3:"#ff8f00",darken4:"#ff6f00",accent1:"#ffe57f",accent2:"#ffd740",accent3:"#ffc400",accent4:"#ffab00"},co={base:"#ff9800",lighten5:"#fff3e0",lighten4:"#ffe0b2",lighten3:"#ffcc80",lighten2:"#ffb74d",lighten1:"#ffa726",darken1:"#fb8c00",darken2:"#f57c00",darken3:"#ef6c00",darken4:"#e65100",accent1:"#ffd180",accent2:"#ffab40",accent3:"#ff9100",accent4:"#ff6d00"},fo={base:"#ff5722",lighten5:"#fbe9e7",lighten4:"#ffccbc",lighten3:"#ffab91",lighten2:"#ff8a65",lighten1:"#ff7043",darken1:"#f4511e",darken2:"#e64a19",darken3:"#d84315",darken4:"#bf360c",accent1:"#ff9e80",accent2:"#ff6e40",accent3:"#ff3d00",accent4:"#dd2c00"},vo={base:"#795548",lighten5:"#efebe9",lighten4:"#d7ccc8",lighten3:"#bcaaa4",lighten2:"#a1887f",lighten1:"#8d6e63",darken1:"#6d4c41",darken2:"#5d4037",darken3:"#4e342e",darken4:"#3e2723"},Uo={base:"#607d8b",lighten5:"#eceff1",lighten4:"#cfd8dc",lighten3:"#b0bec5",lighten2:"#90a4ae",lighten1:"#78909c",darken1:"#546e7a",darken2:"#455a64",darken3:"#37474f",darken4:"#263238"},po={base:"#9e9e9e",lighten5:"#fafafa",lighten4:"#f5f5f5",lighten3:"#eeeeee",lighten2:"#e0e0e0",lighten1:"#bdbdbd",darken1:"#757575",darken2:"#616161",darken3:"#424242",darken4:"#212121"},go={black:"#000000",white:"#ffffff",transparent:"#ffffff00"},To={red:Wl,pink:Xl,purple:Zl,deepPurple:eo,indigo:to,blue:ao,lightBlue:lo,cyan:oo,teal:no,green:so,lightGreen:io,lime:uo,yellow:ro,amber:mo,orange:co,deepOrange:fo,brown:vo,blueGrey:Uo,grey:po,shades:go},yo=Y("h4",null,"Grid Size (Max 12)",-1),_o={key:0,class:"text-warning text-right pl-1"},Io=de({__name:"EditAdminLayout",props:se({convention:{},layouts:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:se(["change","delete"],["update:modelValue"]),setup(E,{emit:N}){const f=ve(E,"modelValue"),p=U([]),T=_e(),y=N,m=U(Object.assign({},...E.layouts.map(F=>F.Panels.map(L=>L.Items.map(c=>{if(!c.Meta)return{};const H={};return Object.entries(c.Meta).forEach(i=>{Array.isArray(i[1])?(H[`${c.LayoutItemUUID}.${i[0]}`]=[],i[1].forEach(X=>{H[`${c.LayoutItemUUID}.${i[0]}`].push(X.toString())})):i[1]!==void 0&&i[1]!==null&&(H[`${c.LayoutItemUUID}.${i[0]}`]=[i[1].toString()])}),H}))).flat(2))),a=U(`
Are you sure you wish to delete this layout? All panels relating to it will be
removed and can not be recovered. This action can not be undone once saved.
You will have to create a new layout.
`),u=U(!1),r=U([]);T.getConventionTags(E.convention.ConventionUUID).then(F=>{F&&(r.value=F)}).catch(()=>{});const h=()=>({ID:0,LayoutPanelUUID:ye(),AdminLayoutID:f.value.ID,AdminLayoutUUID:f.value.AdminLayoutUUID,Name:"",Order:f.value.Panels.length+1,Items:[],PanelStyle:Dt.PANEL_STYLE_FLEX,RequiredFormType:re.FORM_TYPE_NIL,RequiredGroupMemberships:[],RequiredRegistrationTags:[],Meta:{}}),D=F=>()=>({ID:0,LayoutItemUUID:ye(),LayoutPanelID:F.ID,LayoutPanelUUID:F.LayoutPanelUUID,Label:"",SourceType:Ee.LAYOUT_ITEM_SOURCE_FORM,SectionFieldID:void 0,SectionFieldUUID:void 0,SectionField:void 0,MetaField:void 0,UserField:void 0,Align:"",Order:F.Items.length+1,DefaultSort:!1,Meta:{}}),_=(F,L)=>{F.Meta[L]=m.value[`${F.LayoutItemUUID}.${L}`]},b=F=>{const L=p.value.find(c=>c.value===F.SectionFieldUUID);L&&(F.SectionFieldID=L.object.ID,F.SectionField=L.object)};T.getConventionForms(f.value.ConventionUUID).then(F=>{F&&(F.forEach(L=>L.Sections.forEach(c=>c.Fields&&p.value.push(...c.Fields.map(H=>{var X;return{title:`${L.Name} - ${c.Name} - ${(X=H.Field)==null?void 0:X.Name}`,value:H.SectionFieldUUID,object:H}})))),p.value.sort(ka("title")),Ht(f.value.Panels,F))});const K=It(()=>{switch(f.value.Type){case fe.ADMIN_LAYOUT_PANELS:return"Panels";case fe.ADMIN_LAYOUT_TABLE:return"Tabs"}return"Unknown"});Te(f,()=>{y("change")},{deep:!0});const le=It(()=>{const F=/([a-zA-Z]+)(\d+)/;return Object.entries(To).map(([L,c])=>Object.entries(c).map(([H,i])=>{const X=F.exec(H);return!X||X.length<3?void 0:{Title:`${nt(L).split(/(?=[A-Z])/).join(" ")} ${nt(X[1])} ${nt(X[2])}`,CSSName:`${L}-${X[1]}-${X[2]}`,Value:i}})).flat().filter(L=>!!L).sort((L,c)=>L.Title>c.Title?1:L.Title==c.Title?0:-1)});return(F,L)=>(s(),S(me,{class:"px-0 mx-0",fluid:!0},{default:t(()=>[e(ae,null,{default:t(()=>[e(V,{cols:"12",sm:"6"},{default:t(()=>[e(ee,{modelValue:f.value.Name,"onUpdate:modelValue":L[0]||(L[0]=c=>f.value.Name=c),label:"Name",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),e(V,{cols:"12",sm:"6"},{default:t(()=>[e(oe,{modelValue:f.value.Type,"onUpdate:modelValue":L[1]||(L[1]=c=>f.value.Type=c),label:"Layout Type",items:A(Da),"item-title":"title","item-value":"value",variant:"outlined","hide-details":""},null,8,["modelValue","items"])]),_:1}),f.value.Type==A(fe).ADMIN_LAYOUT_PANELS?(s(),S(V,{key:0,cols:"12",sm:"6"},{default:t(()=>[e(oe,{modelValue:f.value.RunnerLayoutUUID,"onUpdate:modelValue":L[2]||(L[2]=c=>f.value.RunnerLayoutUUID=c),clearable:!0,items:F.layouts.filter(c=>c.Type===A(fe).ADMIN_LAYOUT_PANELS)||[],multiple:!1,label:"Runner Display (Optional)","item-title":"Name","item-value":"AdminLayoutUUID",variant:"outlined","hide-details":""},null,8,["modelValue","items"])]),_:1})):w("",!0)]),_:1}),e(ae,null,{default:t(()=>[e(V,null,{default:t(()=>[e(ut,{modelValue:f.value.Panels,"onUpdate:modelValue":L[3]||(L[3]=c=>f.value.Panels=c),"new-item":h,closeable:!1,title:K.value,label:"Name","slot-name-prefix":"panel"},Je({_:2},[ue(f.value.Panels,(c,H)=>({name:`panel_${H}`,fn:t(()=>[e(me,{class:"px-0 mx-0",fluid:!0},{default:t(()=>[e(ae,null,{default:t(()=>[e(V,{cols:"12",sm:"6"},{default:t(()=>[e(ee,{modelValue:c.Name,"onUpdate:modelValue":i=>c.Name=i,label:"Name",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),f.value.Type===A(fe).ADMIN_LAYOUT_PANELS?(s(),S(V,{key:0,cols:"12",sm:"6"},{default:t(()=>[e(oe,{modelValue:c.PanelStyle,"onUpdate:modelValue":i=>c.PanelStyle=i,items:A(Aa),clearable:!0,label:"Panel Style",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"])]),_:2},1024)):w("",!0),e(V,{cols:"12",sm:"6"},{default:t(()=>[e(oe,{modelValue:c.RequiredFormType,"onUpdate:modelValue":i=>c.RequiredFormType=i,items:A(Ca),clearable:!0,label:"Required Form",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"])]),_:2},1024),e(V,{cols:"12",sm:"6"},{default:t(()=>[e(qa,{label:"Required Groups",variant:"outlined",modelValue:c.RequiredGroupMemberships,"onUpdate:modelValue":i=>c.RequiredGroupMemberships=i,convention:f.value.ConventionUUID,chips:"",clearable:"",hint:"Groups that a user must be in to see this panel. (Any one)"},null,8,["modelValue","onUpdate:modelValue","convention"])]),_:2},1024),e(V,{cols:"12",sm:"6"},{default:t(()=>[e(Gt,{label:"Registration Tags",variant:"outlined",modelValue:c.RequiredRegistrationTags,"onUpdate:modelValue":i=>c.RequiredRegistrationTags=i,convention:f.value.ConventionUUID,chips:"",clearable:"",hint:"Tags that a registration must have to appear in results. (Any one)"},null,8,["modelValue","onUpdate:modelValue","convention"])]),_:2},1024)]),_:2},1024),f.value.Type===A(fe).ADMIN_LAYOUT_PANELS&&c.PanelStyle===A(Dt).PANEL_STYLE_FLEX?(s(),S(ae,{key:0},{default:t(()=>[e(V,{cols:"12",class:"py-0 my-0"},{default:t(()=>[yo]),_:1}),e(V,{cols:"6",sm:"4",lg:"2"},{default:t(()=>[e(ee,{modelValue:c.Meta.cols,"onUpdate:modelValue":i=>c.Meta.cols=i,modelModifiers:{number:!0},clearable:!0,"hide-details":"",label:"Default",type:"number",min:"1",max:"12"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(V,{cols:"6",sm:"4",lg:"2"},{default:t(()=>[e(ee,{modelValue:c.Meta.cols_xs,"onUpdate:modelValue":i=>c.Meta.cols_xs=i,modelModifiers:{number:!0},clearable:!0,"hide-details":"",label:"XS",type:"number",min:"1",max:"12"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(V,{cols:"6",sm:"4",lg:"2"},{default:t(()=>[e(ee,{modelValue:c.Meta.cols_sm,"onUpdate:modelValue":i=>c.Meta.cols_sm=i,modelModifiers:{number:!0},clearable:!0,"hide-details":"",label:"SM",type:"number",min:"1",max:"12"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(V,{cols:"6",sm:"4",lg:"2"},{default:t(()=>[e(ee,{modelValue:c.Meta.cols_md,"onUpdate:modelValue":i=>c.Meta.cols_md=i,modelModifiers:{number:!0},clearable:!0,"hide-details":"",label:"MD",type:"number",min:"1",max:"12"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(V,{cols:"6",sm:"4",lg:"2"},{default:t(()=>[e(ee,{modelValue:c.Meta.cols_lg,"onUpdate:modelValue":i=>c.Meta.cols_lg=i,modelModifiers:{number:!0},clearable:!0,"hide-details":"",label:"LG",type:"number",min:"1",max:"12"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(V,{cols:"6",sm:"4",lg:"2"},{default:t(()=>[e(ee,{modelValue:c.Meta.cols_xl,"onUpdate:modelValue":i=>c.Meta.cols_xl=i,modelModifiers:{number:!0},clearable:!0,"hide-details":"",label:"XL",type:"number",min:"1",max:"12"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)):w("",!0)]),_:2},1024),e(ut,{modelValue:c.Items,"onUpdate:modelValue":i=>c.Items=i,"new-item":D(c),closeable:!1,title:"Items",label:"Label","slot-name-prefix":"item"},Je({_:2},[ue(c.Items,(i,X)=>({name:`item_${X}`,fn:t(()=>[e(me,{class:"px-0 mx-0",fluid:!0},{default:t(()=>{var ne,ce;return[e(ae,null,{default:t(()=>[e(V,{cols:"12",sm:"6"},{default:t(()=>[e(ee,{modelValue:i.Label,"onUpdate:modelValue":o=>i.Label=o,label:"Name",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024),e(ae,null,{default:t(()=>[e(V,{cols:"12",sm:"6"},{default:t(()=>[e(oe,{modelValue:i.SourceType,"onUpdate:modelValue":o=>i.SourceType=o,label:"Source Type",items:A(Sa),"item-title":"title","item-value":"value",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"])]),_:2},1024),e(V,{cols:"12",sm:"6"},{default:t(()=>[i.SourceType==="LAYOUT_ITEM_SOURCE_FORM"?(s(),S(oe,{key:0,modelValue:i.SectionFieldUUID,"onUpdate:modelValue":o=>i.SectionFieldUUID=o,label:"Form Data",items:p.value,"item-title":"title","item-value":"value",variant:"outlined","hide-details":"",onBlur:o=>b(i)},null,8,["modelValue","onUpdate:modelValue","items","onBlur"])):i.SourceType==="LAYOUT_ITEM_SOURCE_META"?(s(),S(oe,{key:1,modelValue:i.MetaField,"onUpdate:modelValue":o=>i.MetaField=o,label:"Miscellaneous Data",items:A(Ea),"item-title":"title","item-value":"value",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"])):i.SourceType==="LAYOUT_ITEM_SOURCE_USER"?(s(),S(oe,{key:2,modelValue:i.UserField,"onUpdate:modelValue":o=>i.UserField=o,label:"User Profile Data",items:A(ha),"item-title":"title","item-value":"value",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"])):w("",!0)]),_:2},1024)]),_:2},1024),F.layouts&&i.SourceType==="LAYOUT_ITEM_SOURCE_FORM"&&((ce=(ne=i.SectionField)==null?void 0:ne.Field)==null?void 0:ce.Type)===A(Lt).TEXT?(s(),S(ae,{key:0},{default:t(()=>[e(V,{cols:"12",xs:"6",sm:"6",lg:"3"},{default:t(()=>[e(Oe,{modelValue:i.Meta.DirectEdit,"onUpdate:modelValue":o=>i.Meta.DirectEdit=o,label:"Direct Edit","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(V,{cols:"12",xs:"6",sm:"6",lg:"3"},{default:t(()=>[e(oe,{modelValue:i.Meta.DirectEditPermission,"onUpdate:modelValue":o=>i.Meta.DirectEditPermission=o,label:"Minimum Permission Required",items:["View","Edit"],"hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)):w("",!0),F.layouts&&i.SourceType==="LAYOUT_ITEM_SOURCE_META"&&i.MetaField===A(B).META_DATA_SOURCE_BADGE_DISPLAY?(s(),S(ae,{key:1},{default:t(()=>[e(V,{cols:"6",sm:"4",lg:"2"},{default:t(()=>[e(Oe,{modelValue:i.Meta.HideDownloadButton,"onUpdate:modelValue":o=>i.Meta.HideDownloadButton=o,label:"Hide Download Button"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(V,{cols:"6",sm:"4",lg:"2"},{default:t(()=>[e(Oe,{modelValue:i.Meta.HideNFCButton,"onUpdate:modelValue":o=>i.Meta.HideNFCButton=o,label:"Hide NFC Button"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)):w("",!0),F.layouts&&i.SourceType==="LAYOUT_ITEM_SOURCE_META"&&i.MetaField===A(B).META_DATA_SOURCE_DATA_LAYOUT?(s(),S(ae,{key:2},{default:t(()=>[e(V,{cols:"6",sm:"4",lg:"2"},{default:t(()=>[e(oe,{modelValue:m.value[`${i.LayoutItemUUID}.LayoutUUID`],"onUpdate:modelValue":[o=>m.value[`${i.LayoutItemUUID}.LayoutUUID`]=o,o=>_(i,"LayoutUUID")],clearable:!0,items:F.layouts.filter(o=>o.Type===A(fe).ADMIN_LAYOUT_PANELS)||[],multiple:!0,label:"Data Display","item-title":"Name","item-value":"AdminLayoutUUID",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"])]),_:2},1024)]),_:2},1024)):w("",!0),F.layouts&&i.SourceType==="LAYOUT_ITEM_SOURCE_META"&&i.MetaField===A(B).META_DATA_SOURCE_TAGS?(s(),S(ae,{key:3},{default:t(()=>[e(V,{cols:"6",sm:"6",md:"6",lg:"6"},{default:t(()=>[e(oe,{modelValue:m.value[`${i.LayoutItemUUID}.Tags`],"onUpdate:modelValue":[o=>m.value[`${i.LayoutItemUUID}.Tags`]=o,o=>_(i,"Tags")],clearable:!0,items:r.value||[],multiple:!0,chips:!0,label:"Tags to Display","item-title":"Title","item-value":"TagUUID",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"]),!m.value[i.LayoutItemUUID]||m.value[i.LayoutItemUUID].length===0?(s(),k("small",_o," Will show all tags ")):w("",!0)]),_:2},1024),e(V,{cols:"6"},{default:t(()=>[e(oe,{modelValue:i.Meta.TagColour,"onUpdate:modelValue":o=>i.Meta.TagColour=o,items:le.value,label:"Colour","item-title":"Title","item-value":"Value",variant:"outlined","hide-details":""},{selection:t(({item:o})=>[e(W,{size:"x-small",color:o.raw.Value,class:"mr-2"},null,8,["color"]),G(" "+M(o.title),1)]),item:t(({props:o,item:g})=>[e(ke,Ot(Ct(o)),{prepend:t(()=>[e(W,{size:"x-small",color:g.raw.Value,class:"mr-2"},null,8,["color"])]),_:2},1040)]),_:2},1032,["modelValue","onUpdate:modelValue","items"])]),_:2},1024)]),_:2},1024)):w("",!0),f.value.Type===A(fe).ADMIN_LAYOUT_TABLE&&(i.SourceType!==A(Ee).LAYOUT_ITEM_SOURCE_META||i.MetaField!==A(B).META_DATA_SOURCE_DATA_LAYOUT)?(s(),S(ae,{key:4},{default:t(()=>[e(V,null,{default:t(()=>[e(Oe,{modelValue:i.DefaultSort,"onUpdate:modelValue":o=>i.DefaultSort=o,label:"Default Sort","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)):w("",!0)]}),_:2},1024)])}))]),1032,["modelValue","onUpdate:modelValue","new-item"])])}))]),1032,["modelValue","title"])]),_:1})]),_:1}),e(ae,null,{default:t(()=>[e(V,null,{default:t(()=>[e(W,{onClick:L[4]||(L[4]=c=>u.value=!0),"prepend-icon":"mdi:mdi-delete",color:"red-darken-4"},{default:t(()=>[G("Delete Layout")]),_:1})]),_:1})]),_:1}),u.value?(s(),S(Ha,{key:0,modelValue:u.value,"onUpdate:modelValue":L[5]||(L[5]=c=>u.value=c),message:a.value,title:"Delete Layout",subtitle:"Removes this layout and all it's panels",onDelete:L[6]||(L[6]=c=>y("delete"))},null,8,["modelValue","message"])):w("",!0)]),_:1}))}}),Do=de({__name:"EditAdminLayouts",props:se({title:{},convention:{}},{modelValue:{type:Boolean,required:!0},modelModifiers:{}}),emits:se(["save"],["update:modelValue"]),setup(E,{emit:N}){const f=ve(E,"modelValue"),p=N,T=U([]),y=U([]),m=U([]),a=_e(),u=()=>({ID:0,AdminLayoutUUID:ye(),ConventionID:E.convention.ID,ConventionUUID:E.convention.ConventionUUID,Name:"New Layout",Type:fe.ADMIN_LAYOUT_PANELS,Panels:[]}),r=()=>{let D=!1;[...new Set(m.value)].forEach(b=>{const K=T.value.findIndex(le=>le.AdminLayoutUUID===b);K<0||K>=T.value.length||(a.saveAdminLayout(T.value[K]).then(le=>{le&&T.value.splice(K,1,le)}).catch(()=>{}),D=!0)}),y.value.forEach(b=>{a.deleteAdminLayout(b).catch(()=>{})}),y.value=[],m.value=[],D&&p("save")},h=D=>{const _=T.value.findIndex(b=>b.AdminLayoutUUID===D.AdminLayoutUUID);_<0||_>=T.value.length||(T.value[_].ID>0&&y.value.push(D.AdminLayoutUUID),T.value.splice(_,1))};return a.getConventionAdminLayouts(E.convention.ConventionUUID).then(D=>{D&&(T.value=D)}).catch(()=>[]),(D,_)=>(s(),S(qt,{modelValue:f.value,"onUpdate:modelValue":_[2]||(_[2]=b=>f.value=b),scrollable:!0,"retain-focus":!0,persistent:!0,fullscreen:!0},{default:t(()=>[e(ut,{modelValue:T.value,"onUpdate:modelValue":_[0]||(_[0]=b=>T.value=b),"new-item":u,closeable:!0,"show-delete":!1,"show-save":!0,"has-order":!1,title:D.title,label:"Name","slot-name-prefix":"panel",onClose:_[1]||(_[1]=b=>f.value=!1),onSave:r},Je({_:2},[ue(T.value,(b,K)=>({name:`panel_${K}`,fn:t(()=>[e(me,{class:"px-0 mx-0",fluid:!0},{default:t(()=>[e(ae,null,{default:t(()=>[e(V,{cols:"12"},{default:t(()=>[e(Io,{modelValue:T.value[K],"onUpdate:modelValue":le=>T.value[K]=le,convention:D.convention,layouts:T.value,onChange:le=>m.value.push(b.AdminLayoutUUID),onDelete:le=>h(b)},null,8,["modelValue","onUpdate:modelValue","convention","layouts","onChange","onDelete"])]),_:2},1024)]),_:2},1024)]),_:2},1024)])}))]),1032,["modelValue","title"])]),_:1},8,["modelValue"]))}}),Ao=["href","onClick"],So=Y("strong",null,"Expires:",-1),Eo=de({__name:"OperatorSocket",setup(E){const N=_e(),f=st.getInstance(),p=Qe(),T=Ka(),y=U(!1),m=ba({mode:"host",wsUri:N.getRunnerSocketURL()}),a=Va(),u=U(!1),r=U(!1),h=U([]),D=Mt(),_=U("Connecting"),b=U([{title:"- Select Duration -",value:-1},{title:"No Expiry",value:0},{title:"5 Minutes",value:5*60*1e3},{title:"30 Minutes",value:30*60*1e3},{title:"1 Hour",value:60*60*1e3},{title:"1.5 Hours",value:90*60*1e3},{title:"2 Hours",value:120*60*1e3},{title:"3 Hours",value:180*60*1e3},{title:"4 Hours",value:240*60*1e3},{title:"5 Hours",value:300*60*1e3},{title:"6 Hours",value:360*60*1e3}]),K=o=>{if(o.editing=!1,o.timer&&clearTimeout(o.timer),!o.selectedDuration){o.expires=void 0,o.timer=void 0;return}const g=new Date;g.setTime(new Date().getTime()+o.selectedDuration),o.expires=g,le(o),i()},le=o=>{if(o.expires){if(o.timer&&clearTimeout(o.timer),typeof o.expires=="number"){const g=new Date;g.setTime(o.expires),o.expires=g}o.expires&&"getTime"in o.expires&&(o.timer=setTimeout(()=>{o.timer&&clearTimeout(o.timer),c(o)},o.expires.getTime()-Date.now()))}};m.on("authenticated",()=>{u.value=!0;const o={Key:"",Mode:"host",UserUUID:(p==null?void 0:p.UserUUID)||""},g={Command:"SET_MODE",Params:new Map,Data:JSON.stringify(o)};m.JSON(g)}),m.on("auth_failed",()=>{u.value=!1,_.value="Access Denied"}),m.on("badge_serial_update",o=>{f.emit("badge_serial_update",o)}),m.on("close",()=>{_.value="Disconnected"}),m.on("open",()=>{const o=a.getTokenByService("GrazeAPI");_.value="Authenticating",m.send(`AUTH ${o==null?void 0:o.AccessToken}`)}),m.on("runner_connected",o=>{const g=o,I=h.value.find(J=>J.key==g.Key);if(!I){F(g.Key,g.UserUUID);return}const P=ll();P.DisplayName=g.DisplayName,P.UserUUID=g.UserUUID,I.users.find(J=>J.UserUUID==P.UserUUID)||I.users.push(P)}),m.on("runner_disconnected",o=>{const g=o,I=h.value.find(J=>J.key==g.Key);if(!I)return;const P=I.users.findIndex(J=>J.UserUUID==g.UserUUID);P<0||I.users.splice(P,1)}),m.on("started",()=>{h.value.forEach(o=>{const g={Key:o.key},I={Command:"ADD_KEY",Params:new Map,Data:JSON.stringify(g)};m.JSON(I)}),_.value="Connected"}),ra(()=>{H(),st.getInstance().on("layout_opened",g=>{const I=g;if(!m||!u.value||!I||!I.AdminLayoutUUID||!I.RegistrationUUID)return;const P={Command:"OPEN_LAYOUT",Params:new Map,Data:JSON.stringify(I)};m.JSON(P)})}),da(()=>{m.destroy()});const F=(o,g)=>{const P={Command:"KICK_RUNNER",Params:new Map,Data:JSON.stringify({DisplayName:"",Key:o,UserUUID:g})};m.JSON(P)},L=()=>{const o=ye(),I={Command:"ADD_KEY",Params:new Map,Data:JSON.stringify({Key:o})};m.JSON(I),h.value.push({key:o,name:"New Session",users:[]}),i()},c=o=>{const g=h.value.findIndex(J=>J==o);if(g<0)return;const I={Key:o.key},P={Command:"REMOVE_KEY",Params:new Map,Data:JSON.stringify(I)};m.JSON(P),h.value.splice(g,1),i()},H=()=>{const o=sessionStorage.getItem("collaboration.sessions");o&&(h.value=JSON.parse(o),h.value.forEach(g=>{typeof g.expires!="number"&&(g.expires=0),le(g)}))},i=()=>{const o=[];h.value.forEach(g=>{o.push({name:g.name,expires:typeof g.expires=="number"?g.expires:g.expires?g.expires.getTime():0,key:g.key,users:[]})}),sessionStorage.setItem("collaboration.sessions",JSON.stringify(o))},X=o=>{const g=D.resolve({name:"RunnerView",params:{user:p==null?void 0:p.UserUUID,session:o.key}}),I=new URL(location.href);return I.pathname=g.href,I.toString()},ne=o=>{const g=X(o);return za(g),r.value=!0,g},ce=o=>{if(typeof o=="number"){const J=new Date;J.setTime(o),o=J}const g=o.getTime()-Date.now(),I=Math.floor(g/(1e3*60*60)),P=Math.floor(g%(1e3*60*60)/(1e3*60));return I==0&&P==0?`${Math.floor(g%6e4/1e3)}s`:`${I}hr${I!=1?"s":""} ${P}min${P!=1?"s":""}`};return(o,g)=>u.value?(s(),k(q,{key:0},[e(W,{icon:"mdi:mdi-link-variant",onClick:g[0]||(g[0]=I=>y.value=!0)}),e(ct,{modelValue:y.value,"onUpdate:modelValue":g[4]||(g[4]=I=>y.value=I),"hide-extension":!0,"show-save-action":!1,"show-delete-action":!1,"show-reset-action":!1,title:"Collaboration",subtitle:`Connection Status: ${_.value}`},{actions:t(()=>[e(it),e(W,{color:"primary",variant:"flat","prepend-icon":"mdi:mdi-link-variant-plus",onClick:L},{default:t(()=>[G(" Create Session ")]),_:1})]),default:t(()=>[e(ft,null,{default:t(()=>[(s(!0),k(q,null,ue(h.value,I=>(s(),S(La,{key:I.key,value:I.key},{activator:t(({props:P})=>[e(ke,Ot(Ct(P)),{default:t(()=>[e(Nt,null,{default:t(()=>[e(ae,null,{default:t(()=>[e(V,{style:{"max-width":"84px"}},{default:t(()=>[Y("a",{href:ne(I),onClick:Ve(J=>ne(I),["prevent","stop"]),class:"text-white text-decoration-none"},[e(W,{variant:"flat",size:"x-small",icon:"mdi:mdi-link-variant",color:"success",class:"mr-2",title:"Copy Link"})],8,Ao),e(W,{variant:"flat",size:"x-small",icon:"mdi:mdi-link-variant-remove",color:"error",class:"mr-2",title:"Terminate",onClick:Ve(J=>c(I),["stop"])},null,8,["onClick"])]),_:2},1024),e(V,null,{default:t(()=>[e(ee,{modelValue:I.name,"onUpdate:modelValue":J=>I.name=J,"hide-details":"",variant:"plain",density:"compact",onChange:i,onClick:g[1]||(g[1]=Ve(()=>{},["stop"])),onKeydown:g[2]||(g[2]=Ve(()=>{},["stop"]))},{append:t(()=>[G(M(I.users.length),1)]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),default:t(()=>[I.editing?(s(),S(oe,{key:0,label:"Duration",items:b.value,density:"compact","hide-details":!0,modelValue:I.selectedDuration,"onUpdate:modelValue":[P=>I.selectedDuration=P,P=>K(I)],modelModifiers:{number:!0}},null,8,["items","modelValue","onUpdate:modelValue"])):I.expires?(s(),k(q,{key:1},[Y("small",null,[So,G(" "+M(ce(I.expires)),1)]),e(W,{onClick:P=>{I.selectedDuration=-1,I.editing=!0},variant:"text",color:"primary",density:"compact",size:"small"},{default:t(()=>[G(" (Change Expiry) ")]),_:2},1032,["onClick"])],64)):(s(),S(W,{key:2,onClick:P=>{I.selectedDuration=-1,I.editing=!0},variant:"text",color:"primary",density:"compact",size:"small"},{default:t(()=>[G(" (Set Expiry) ")]),_:2},1032,["onClick"])),(s(!0),k(q,null,ue(I.users,P=>(s(),S(ke,{key:`${I.key}.${P.UserUUID}`},{append:t(()=>[e(W,{variant:"flat",size:"small",icon:"mdi:mdi-account-network-off",title:"Disconnect User",onClick:J=>F(I.key,P.UserUUID)},null,8,["onClick"])]),prepend:t(()=>[e(Ft,{src:A(T)(P.UserUUID),class:"rounded-circle mr-2 pt-4 d-inline-block",height:"32",width:"32"},null,8,["src"])]),default:t(()=>[G(" "+M(P.DisplayName),1)]),_:2},1024))),128))]),_:2},1032,["value"]))),128))]),_:1}),e(Ya,{modelValue:r.value,"onUpdate:modelValue":g[3]||(g[3]=I=>r.value=I),message:"Invite Link Copied",timeout:2e3},null,8,["modelValue"])]),_:1},8,["modelValue","subtitle"])],64)):w("",!0)}}),ho=["colspan"],bo={style:{opacity:"var(--v-medium-emphasis-opacity)"}},kn=de({__name:"RegistrationsView",emits:["pageTitle"],setup(E,{emit:N}){var yt;const f=Na();N("pageTitle","Registration Manager");const T=ma(),y=Mt(),m=U(!0);let a=((yt=T.params.convention)==null?void 0:yt.toString())||"";const u=U({ID:0,ConventionUUID:ye(),OrganisationID:0,OrganisationUUID:ze,Name:"New Convention",Description:"",DetailLink:"",Logo:"",Slug:"",Accommodation:[],Tickets:[],Extras:[],Interests:[],Visible:!1}),r=_e(),h=st.getInstance(),D=U([]),_=U({ID:0,AdminLayoutUUID:ye(),ConventionID:u.value.ID,ConventionUUID:u.value.ConventionUUID,Name:"Registration Table",RunnerLayoutUUID:ze,Type:fe.ADMIN_LAYOUT_TABLE,Panels:[]}),b=U([]),K=U([]),le=U([]),F=U([]),L=U([]),c=U([]),H=U(1),i=U(10),X=U([]),ne=U(0),ce=U(!1),o=U(""),g=U(""),I=U(""),P=U(""),J=U({FieldUUID:"591c9bca-c78c-4e97-8aef-bc596ef472fb",Value:""}),Xe=U({FieldUUID:"50189b21-6c55-4c99-a38f-7740a01ec4a4",Value:""}),Ze=U({FieldUUID:"1523ef15-f2c3-46b9-a687-dcd7bc2c0a50",Value:""}),et=U({FieldUUID:"926d43c6-a743-4ab7-bef2-060d762d37a9",Value:""}),zt=U(new Map([["591c9bca-c78c-4e97-8aef-bc596ef472fb",J.value],["50189b21-6c55-4c99-a38f-7740a01ec4a4",Xe.value],["1523ef15-f2c3-46b9-a687-dcd7bc2c0a50",Ze.value],["926d43c6-a743-4ab7-bef2-060d762d37a9",et.value]])),we=U(""),Ne=U(""),Fe=U([]),Pe=U([]),$e=U([]),Ye=U([]),Ge=U([]),xe=U([]),Ue=U(0),ie=U(),Ie=U(!1),pt=U(!1),Kt=U(!1),Be=U(),gt=U(),Re=U(),he=U(!1),Jt=Qe(),te=jl(()=>{g.value=Date.now().toString()});Te(o,n=>{const l=c.value.find(v=>v.uuid===n);if(l){const v=l.headers.find(d=>d.defaultSort===!0);v&&(X.value=[{key:v.key,order:"asc"}],Fe.value=[{key:v.key,order:"asc"}])}qe({page:1,itemsPerPage:i.value,sortBy:Fe.value})}),Te(Ue,n=>{n===8&&Tt()}),Te(we,()=>{te()}),Te(Ne,()=>{te()});const Qt=()=>{b.value=[],le.value=[],F.value=[],c.value=[];try{r.getConventionAdminLayoutByName(u.value.ConventionUUID,"Registration Table").then(n=>{Ue.value+=1,n?_.value=n:(_.value.ConventionID=u.value.ID,_.value.ConventionUUID=u.value.ConventionUUID)})}catch{_.value.ConventionID=u.value.ID,_.value.ConventionUUID=u.value.ConventionUUID}try{r.getConventionAdminLayouts(u.value.ConventionUUID).then(n=>{Ue.value+=1,n&&(n.forEach(l=>{l.Panels.sort((v,d)=>v.Order>d.Order?1:v.Order===d.Order?0:-1),l.Panels.forEach(v=>{v.Items.sort((d,Q)=>d.Order>Q.Order?1:d.Order===Q.Order?0:-1)})}),le.value=n)})}catch{}try{r.getConventionForms(u.value.ConventionUUID).then(n=>{Ue.value+=1,n&&(b.value=n)})}catch{}try{r.getConventionAccommodation(u.value.ConventionUUID).then(n=>{Ue.value+=1,n&&(Pe.value=n)})}catch{}try{r.getConventionVenues(u.value.ConventionUUID).then(n=>{Ue.value+=1,n&&(xe.value=n)})}catch{}try{r.getConventionExtras(u.value.ConventionUUID).then(n=>{Ue.value+=1,n&&($e.value=n)})}catch{}try{r.getConventionInterests(u.value.ConventionUUID).then(n=>{Ue.value+=1,n&&(Ye.value=n)})}catch{}try{r.getConventionTickets(u.value.ConventionUUID).then(n=>{Ue.value+=1,n&&(Ge.value=n)})}catch{}try{r.getConventionGroups(u.value.ConventionUUID).then(n=>{n&&(K.value=n.sort((l,v)=>l.Name.localeCompare(v.Name)))})}catch{}try{r.getConventionTags(u.value.ConventionUUID).then(n=>{n&&(L.value=n.sort((l,v)=>l.Title.localeCompare(v.Title)).map(l=>(l.Title=`${l.Title} [${l.Key}]`,l)))})}catch{}},qe=({page:n,itemsPerPage:l,sortBy:v})=>{m.value=!0,H.value=n,X.value=v;const d=c.value.find(j=>j.uuid==o.value),Q=d==null?void 0:d.layout.Items;let z="",De="";if(v&&Q&&v.length>=1){const j=Q.find(at=>at.LayoutItemUUID==v[0].key);switch(De=v[0].order||"asc",j==null?void 0:j.MetaField){case B.META_DATA_SOURCE_ACCOMMODATION_FORM:z="submission.status";break;case B.META_DATA_SOURCE_BADGE_FORM:z="submission.status";break;case B.META_DATA_SOURCE_DEALER_FORM:z="submission.status";break;case B.META_DATA_SOURCE_REGISTRATION_FORM:z="submission.status";break;case B.META_DATA_SOURCE_REGISTRATION_REFERENCE:z="reference";break;case B.META_DATA_SOURCE_SUBMISSION_DATE:z="created";break;case B.META_DATA_SOURCE_SUBMISSION_STATUS:z="submission.status";break}switch(j==null?void 0:j.UserField){case Z.USER_DATA_SOURCE_DISPLAY_NAME:z="user.display_name";break;case Z.USER_DATA_SOURCE_EMAIL:z="user.email";break;case Z.USER_DATA_SOURCE_FIRST_NAME:z="user.firstname";break;case Z.USER_DATA_SOURCE_HANDLE:z="user.handle";break;case Z.USER_DATA_SOURCE_LAST_NAME:z="user.lastname";break}}try{const j={Direction:De,Limit:l,Offset:(n-1)*l,Order:z};d&&(j.PanelUUID=d==null?void 0:d.layout.LayoutPanelUUID),(d==null?void 0:d.layout.RequiredFormType)===re.FORM_TYPE_ACCOMMODATION&&(j.Accommodation=!0),(d==null?void 0:d.layout.RequiredFormType)===re.FORM_TYPE_BADGE&&(j.Badge=!0),(d==null?void 0:d.layout.RequiredFormType)===re.FORM_TYPE_DEALER&&(j.Dealer=!0),(d==null?void 0:d.layout.RequiredFormType)===re.FORM_TYPE_REGISTRATION&&(j.Registration=!0),j.GroupUUID=we.value||ze,j.TagUUID=Ne.value||ze,j.Email=P.value,j.Reference=I.value,j.FieldValues=Array.from(zt.value.values());const at=g.value;r.searchConventionRegistrations(u.value.ConventionUUID,j).then(lt=>{lt&&at===g.value&&(ne.value=lt.Total,F.value=lt.Registrations,c.value.forEach(ot=>{const sa=ot.layout;ot.items=F.value.map(C=>{const He=[];let pe;C.Leader?pe=C:pe=C.Primary,He.push({Name:pe.User.DisplayName,UUID:pe.UserUUID,UserUUID:pe.User.UserUUID,IsLeader:!0,Reference:pe.Reference,Paid:pe.Paid,Total:pe.Total}),He.push(...pe.Members.map(ge=>({Name:ge.User.DisplayName,UUID:ge.UserUUID,UserUUID:ge.User.UserUUID,IsLeader:!1,Reference:ge.Reference,Paid:ge.Paid,Total:ge.Total})));const $={};return ot.headers.forEach(ge=>{var _t;const R=sa.Items.find(Ce=>Ce.LayoutItemUUID===ge.key);if(R){if(R.SourceType==="LAYOUT_ITEM_SOURCE_FORM"&&R.SectionField)C.Submissions.forEach(Ce=>{const be=Ce.Data.find(O=>O.SectionFieldUUID===R.SectionFieldUUID);if(be){ge.type===Lt.ACCOMMODATION?$[R.LayoutItemUUID]={Data:be.Data,Registration:C}:$[R.LayoutItemUUID]=be.Data;return}});else if(R.SourceType==="LAYOUT_ITEM_SOURCE_USER"&&R.UserField)switch(R.UserField){case Z.USER_DATA_SOURCE_AVATAR:$[R.LayoutItemUUID]=f.GetProfileImageURL(C.UserUUID);break;case Z.USER_DATA_SOURCE_CONTACTS:$[R.LayoutItemUUID]={},C.User.Generated&&C.User.Generated.telegram_handle&&($[R.LayoutItemUUID].telegram=`@${C.User.Generated.telegram_handle}`),$[R.LayoutItemUUID].email=C.User.Additional.Email;break;case Z.USER_DATA_SOURCE_DISPLAY_NAME:$[R.LayoutItemUUID]=C.User.DisplayName;break;case Z.USER_DATA_SOURCE_EMAIL:$[R.LayoutItemUUID]=C.User.Additional.Email;break;case Z.USER_DATA_SOURCE_HANDLE:$[R.LayoutItemUUID]=C.User.Handle;break;case Z.USER_DATA_SOURCE_DATE_OF_BIRTH:$[R.LayoutItemUUID]=C.User.Additional.DOB;break;case Z.USER_DATA_SOURCE_FIRST_NAME:$[R.LayoutItemUUID]=C.User.Additional.FirstName;break;case Z.USER_DATA_SOURCE_LAST_NAME:$[R.LayoutItemUUID]=C.User.Additional.LastName;break;case Z.USER_DATA_SOURCE_TELEGRAM:C.User.Generated&&C.User.Generated.telegram_handle?$[R.LayoutItemUUID]=`@${C.User.Generated.telegram_handle}`:$[R.LayoutItemUUID]="";break}else if(R.SourceType==="LAYOUT_ITEM_SOURCE_META"&&R.MetaField){const Ce=(_t=b.value.find(O=>O.Type===re.FORM_TYPE_REGISTRATION))==null?void 0:_t.FormUUID,be=C.Submissions.find(O=>O.FormUUID===Ce);switch(R.MetaField){case B.META_DATA_SOURCE_REGISTRATION_ACTIONS:$[R.LayoutItemUUID]=C;break;case B.META_DATA_SOURCE_REGISTRATION_GROUP:$[R.LayoutItemUUID]=He;break;case B.META_DATA_SOURCE_REGISTRATION_REFERENCE:$[R.LayoutItemUUID]=C.Reference;break;case B.META_DATA_SOURCE_SUBMISSION_DATE:if(be){const O=new Date(be.CreatedAt||"");$[R.LayoutItemUUID]=`${O.getFullYear()}-${(O.getMonth()+1).toString().padStart(2,"0")}-${O.getDate().toString().padStart(2,"0")} ${O.getHours().toString().padStart(2,"0")}:${O.getMinutes().toString().padStart(2,"0")}:${O.getSeconds().toString().padStart(2,"0")}`}else{const O=new Date(C.CreatedAt||"");$[R.LayoutItemUUID]=`${O.getFullYear()}-${(O.getMonth()+1).toString().padStart(2,"0")}-${O.getDate().toString().padStart(2,"0")} ${O.getHours().toString().padStart(2,"0")}:${O.getMinutes().toString().padStart(2,"0")}:${O.getSeconds().toString().padStart(2,"0")}`}break;case B.META_DATA_SOURCE_ACCOMMODATION_FORM:$[R.LayoutItemUUID]=C.Submissions.map(O=>{const x=b.value.find(Ae=>Ae.FormUUID===O.FormUUID);return{Heading:x==null?void 0:x.Heading,Form:x,Submission:O,Registration:C}}).filter(O=>{var x;return((x=O.Form)==null?void 0:x.Type)===re.FORM_TYPE_ACCOMMODATION});break;case B.META_DATA_SOURCE_BADGE_FORM:$[R.LayoutItemUUID]=C.Submissions.map(O=>{const x=b.value.find(Ae=>Ae.FormUUID===O.FormUUID);return{Heading:x==null?void 0:x.Heading,Form:x,Submission:O,Registration:C}}).filter(O=>{var x;return((x=O.Form)==null?void 0:x.Type)===re.FORM_TYPE_BADGE});break;case B.META_DATA_SOURCE_DEALER_FORM:$[R.LayoutItemUUID]=C.Submissions.map(O=>{const x=b.value.find(Ae=>Ae.FormUUID===O.FormUUID);return{Heading:x==null?void 0:x.Heading,Form:x,Submission:O,Registration:C}}).filter(O=>{var x;return((x=O.Form)==null?void 0:x.Type)===re.FORM_TYPE_DEALER});break;case B.META_DATA_SOURCE_PAYMENT_STATUS:if(C.Paid===0&&C.Total)$[R.LayoutItemUUID]="REQUIRED";else if(C.Total>C.Paid)$[R.LayoutItemUUID]="ADDITIONAL_REQUIRED";else{const O=He.find(x=>x.Paid===0&&(x.Total||0)>0);if(O){C.Total===0&&O.Total===0?$[R.LayoutItemUUID]="NOT_REQUIRED":C.Total===0&&O.Total||C.Total>0&&O.Total===0?$[R.LayoutItemUUID]="MISSING_REQUIRED":C.Paid>=C.Total?$[R.LayoutItemUUID]="AWAITING_PARTNER":$[R.LayoutItemUUID]="ALL_REQUIRED";break}else C.Total===0?$[R.LayoutItemUUID]="NOT_REQUIRED":$[R.LayoutItemUUID]="COMPLETE"}break;case B.META_DATA_SOURCE_SUBMISSION_STATUS:wa(C.Submissions,b.value),$[R.LayoutItemUUID]=C.Submissions.map(O=>{const x=b.value.find(Ae=>Ae.FormUUID===O.FormUUID);return{Heading:x==null?void 0:x.Heading,Form:x,Submission:O,Registration:C}});break;case B.META_DATA_SOURCE_DATA_LAYOUT:$[R.LayoutItemUUID]={Registration:C,Layouts:le.value.filter(O=>{if(R.Meta&&R.Meta.LayoutUUID&&Array.isArray(R.Meta.LayoutUUID))return R.Meta.LayoutUUID.includes(O.AdminLayoutUUID)})};break}}}}),{key:C.RegistrationUUID,registration:C,...$}})}),m.value=!1)})}catch{}},jt=n=>{ce.value=!1,n&&(_.value=n,Tt())},Tt=()=>{Ht(_.value.Panels,b.value),_.value.Panels.length>0&&(c.value=[],_.value.Panels.forEach(n=>{const l={uuid:ye(),order:n.Order,name:n.Name,headers:[],items:[],layout:n};n.Items.sort((v,d)=>v.Order>d.Order?1:v.Order==d.Order?0:-1),l.headers=n.Items.filter(v=>v.SourceType!=Ee.LAYOUT_ITEM_SOURCE_META||v.MetaField!=B.META_DATA_SOURCE_REGISTRATION_TOOLS_DROP).map(v=>{var d,Q;return{key:v.LayoutItemUUID,title:v.Label||((Q=(d=v.SectionField)==null?void 0:d.Field)==null?void 0:Q.Label)||"",align:v.Align==="end"?"end":"start",sortable:Zt(v),type:Wt(v),defaultSort:v.DefaultSort,meta:v.Meta}}),c.value.push(l)}),c.value=c.value.sort((n,l)=>n.order>l.order?1:n.order==l.order?0:-1)),(o.value==null||o.value=="")&&c.value.length>0&&(o.value=c.value[0].uuid)};a?r.getConvention(a).then(n=>{n&&(u.value=n,_.value.ConventionID=u.value.ID,_.value.ConventionUUID=u.value.ConventionUUID,Qt())}).catch(()=>{y.push("/")}):y.push("/");const Wt=n=>{var l,v;if(n.SourceType===Ee.LAYOUT_ITEM_SOURCE_META)return`${n.SourceType}.${n.MetaField}`;if(n.SourceType===Ee.LAYOUT_ITEM_SOURCE_FORM)return(v=(l=n.SectionField)==null?void 0:l.Field)==null?void 0:v.Type;if(n.SourceType===Ee.LAYOUT_ITEM_SOURCE_USER)return`${n.SourceType}.${n.UserField}`},Xt=()=>{const n=c.value.find(l=>l.uuid===o.value);return n?!!n.layout.Items.find(l=>l.SourceType==Ee.LAYOUT_ITEM_SOURCE_META&&l.MetaField==B.META_DATA_SOURCE_REGISTRATION_TOOLS_DROP):!1},Zt=n=>{const l=[B.META_DATA_SOURCE_ACCOMMODATION_FORM,B.META_DATA_SOURCE_BADGE_FORM,B.META_DATA_SOURCE_DEALER_FORM,B.META_DATA_SOURCE_REGISTRATION_FORM,B.META_DATA_SOURCE_REGISTRATION_REFERENCE,B.META_DATA_SOURCE_SUBMISSION_DATE,B.META_DATA_SOURCE_SUBMISSION_STATUS],v=[Z.USER_DATA_SOURCE_DISPLAY_NAME,Z.USER_DATA_SOURCE_EMAIL,Z.USER_DATA_SOURCE_HANDLE,Z.USER_DATA_SOURCE_DATE_OF_BIRTH,Z.USER_DATA_SOURCE_FIRST_NAME,Z.USER_DATA_SOURCE_LAST_NAME];return l.includes(n.MetaField)||v.includes(n.UserField)},ea=n=>{ie.value=n,Ie.value=!0},ta=n=>{ie.value=n,pt.value=!0},aa=n=>{ie.value=n,Kt.value=!0};Te(Ie,n=>{n||(ie.value=void 0)}),Te(pt,n=>{n||(ie.value=void 0)});const tt=async(n="")=>{gt.value=await r.getRegistrationGroup(n)},la=({registration:n,form:l})=>{const v={FormUUID:l.FormUUID,Limit:1,RegistrationUUID:n.RegistrationUUID};r.searchConventionRegistrations(n.ConventionUUID,v).then(d=>{if(d&&d.Total>0){if(ie.value=d.Registrations[0],!ie.value)return;tt(n.RegistrationUUID).then(()=>{var Q,z;ie.value&&((Q=ie.value)!=null&&Q.Submissions)&&(Re.value=(z=ie.value)==null?void 0:z.Submissions.find(De=>De.FormUUID===l.FormUUID)),Re.value||(Re.value=oa(l,n)),Be.value=l,he.value=!0})}})},oa=(n,l)=>({ID:0,SubmissionUUID:ye(),FormID:n.ID,FormUUID:n.FormUUID,Form:n,UserID:l.UserID,UserUUID:l.UserUUID,RegistrationID:l.ID,RegistrationUUID:l.RegistrationUUID,Registration:l,Data:[],Status:Ma.SUBMISSION_STATUS_NULL}),na=n=>{r.switchUser(n.UserUUID).then(l=>{l&&Ba(l.tokens,l.user,y,!1)}).catch(l=>{console.error(l)})};return h.on("registration.group.leave",n=>{r.leaveRegistrationGroup(n).then(l=>{l&&tt(n).then(()=>{h.emit("registration.group.left",l)})})}),h.on("registration.group.remove.member",n=>{r.leaveRegistrationGroup(n).then(l=>{l&&tt(n).then(()=>{h.emit("registration.group.left",l)})})}),(n,l)=>(s(),S(Qa,null,{default:t(()=>[e(St,{color:"blue-darken-4"},{default:t(()=>[e($t,{modelValue:o.value,"onUpdate:modelValue":l[0]||(l[0]=v=>o.value=v),"show-arrows":""},{default:t(()=>[(s(!0),k(q,null,ue(c.value,v=>(s(),S(Yt,{key:v.uuid,value:v.uuid},{default:t(()=>[G(M(v.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"]),e(it),e(Eo),e(W,{icon:"mdi:mdi-cog-outline",onClick:l[1]||(l[1]=v=>ce.value=!0)})]),_:1}),e(Bt,{modelValue:o.value,"onUpdate:modelValue":l[23]||(l[23]=v=>o.value=v),disabled:!0,touch:!1},{default:t(()=>[(s(!0),k(q,null,ue(c.value,v=>(s(),S(Se,{key:v.uuid,value:v.uuid},{default:t(()=>[v.uuid===o.value?(s(),S(Le,{key:0,class:"pa-2"},{default:t(()=>[e(Wa,{expanded:D.value,"onUpdate:expanded":l[19]||(l[19]=d=>D.value=d),page:H.value,"onUpdate:page":l[20]||(l[20]=d=>H.value=d),"items-per-page":i.value,"onUpdate:itemsPerPage":l[21]||(l[21]=d=>i.value=d),"sort-by":Fe.value,"onUpdate:sortBy":l[22]||(l[22]=d=>Fe.value=d),headers:v.headers,"items-length":ne.value,items:v.items,"item-value":"key",loading:m.value,search:g.value,"onUpdate:options":qe,"show-expand":Xt()},Je({top:t(()=>[e(Xa,{class:"mb-3"},{default:t(()=>[e(Za,null,{default:t(()=>[e(el,{color:"secondary",class:"font-weight-bold pb-0 pt-0"},{default:t(()=>[e(V,{class:"pa-0"},{default:t(()=>[G(" Search Criteria "),e(xt,{class:"pl-5",icon:"mdi:mdi-credit-card-search-outline"})]),_:1}),e(V,{class:"d-none d-sm-block pa-0",cols:"0"},{default:t(()=>[e(ee,{modelValue:I.value,"onUpdate:modelValue":l[2]||(l[2]=d=>I.value=d),label:"Badge No.",clearable:!0,"hide-details":"",variant:"plain",onClick:l[3]||(l[3]=Ve(()=>{},["stop"])),"onClick:clear":A(te),onInput:A(te)},null,8,["modelValue","onClick:clear","onInput"])]),_:1}),e(V,{class:"d-none d-md-block pa-0"},{default:t(()=>[e(ee,{modelValue:J.value.Value,"onUpdate:modelValue":l[4]||(l[4]=d=>J.value.Value=d),label:"Furry Name",clearable:!0,"hide-details":"",variant:"plain",onClick:l[5]||(l[5]=Ve(()=>{},["stop"])),"onClick:clear":A(te),onInput:A(te)},null,8,["modelValue","onClick:clear","onInput"])]),_:1})]),_:1}),e(tl,{class:"pt-2"},{default:t(()=>[e(ae,null,{default:t(()=>[e(V,{cols:"12",sm:"6",md:"3",lg:"2",xl:"1"},{default:t(()=>[e(ee,{modelValue:I.value,"onUpdate:modelValue":l[6]||(l[6]=d=>I.value=d),label:"Badge No.",clearable:!0,"hide-details":"",variant:"outlined","onClick:clear":A(te),onInput:A(te)},null,8,["modelValue","onClick:clear","onInput"])]),_:1}),e(V,{cols:"12",sm:"6",md:"4",lg:"5",xl:"2"},{default:t(()=>[e(ee,{modelValue:J.value.Value,"onUpdate:modelValue":l[7]||(l[7]=d=>J.value.Value=d),label:"Furry Name",clearable:!0,"hide-details":"",variant:"outlined","onClick:clear":A(te),onInput:A(te)},null,8,["modelValue","onClick:clear","onInput"])]),_:1}),e(V,{cols:"12",sm:"12",md:"5",lg:"5",xl:"3"},{default:t(()=>[e(ee,{modelValue:P.value,"onUpdate:modelValue":l[8]||(l[8]=d=>P.value=d),label:"E-mail",clearable:!0,"hide-details":"",variant:"outlined","onClick:clear":A(te),onInput:A(te)},null,8,["modelValue","onClick:clear","onInput"])]),_:1}),e(V,{cols:"12",sm:"6",md:"4",lg:"4",xl:"2"},{default:t(()=>[e(ee,{modelValue:Xe.value.Value,"onUpdate:modelValue":l[9]||(l[9]=d=>Xe.value.Value=d),label:"Legal Forename",clearable:!0,"hide-details":"",variant:"outlined","onClick:clear":A(te),onInput:A(te)},null,8,["modelValue","onClick:clear","onInput"])]),_:1}),e(V,{cols:"12",sm:"6",md:"4",lg:"4",xl:"2"},{default:t(()=>[e(ee,{modelValue:Ze.value.Value,"onUpdate:modelValue":l[10]||(l[10]=d=>Ze.value.Value=d),label:"Legal Surname",clearable:!0,"hide-details":"",variant:"outlined","onClick:clear":A(te),onInput:A(te)},null,8,["modelValue","onClick:clear","onInput"])]),_:1}),e(V,{cols:"12",sm:"12",md:"4",lg:"4",xl:"2"},{default:t(()=>[e(ee,{modelValue:et.value.Value,"onUpdate:modelValue":l[11]||(l[11]=d=>et.value.Value=d),type:"date",label:"Date of Birth",clearable:!0,"hide-details":"",variant:"outlined","onClick:clear":A(te),onInput:A(te)},null,8,["modelValue","onClick:clear","onInput"])]),_:1}),e(V,{cols:"12",sm:"6",md:"6",lg:"6",xl:"6"},{default:t(()=>[e(oe,{modelValue:we.value,"onUpdate:modelValue":l[12]||(l[12]=d=>we.value=d),label:"Permission Groups",clearable:!0,"hide-details":"",variant:"outlined",items:K.value,"item-value":"GroupUUID","item-title":"Name"},null,8,["modelValue","items"])]),_:1}),e(V,{cols:"12",sm:"6",md:"6",lg:"6",xl:"6"},{default:t(()=>[e(oe,{modelValue:Ne.value,"onUpdate:modelValue":l[13]||(l[13]=d=>Ne.value=d),label:"Tags",clearable:!0,"hide-details":"",variant:"outlined",items:L.value,"item-value":"TagUUID","item-title":"Title"},null,8,["modelValue","items"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),"expanded-row":t(({columns:d,internalItem:Q})=>[Y("tr",null,[Y("td",{colspan:d.length},[e(bt,{modelValue:Ie.value,"onUpdate:modelValue":l[15]||(l[15]=z=>Ie.value=z),registration:Q.raw.registration,"onUpdate:registration":z=>Q.raw.registration=z,accommodations:Pe.value,convention:u.value,extras:$e.value,forms:b.value,interests:Ye.value,tickets:Ge.value,title:`Registration Controls (#${Q.raw.registration.Reference} ${Q.raw.registration.User.DisplayName})`,"use-dialog":!1,venues:xe.value,style:{"max-width":"calc(100vw - 48px)"},class:"ml-auto mr-0"},null,8,["modelValue","registration","onUpdate:registration","accommodations","convention","extras","forms","interests","tickets","title","venues"])],8,ho)])]),"item.data-table-expand":t(({internalItem:d})=>[D.value.findIndex(Q=>Q===d.key)>=0?(s(),S(W,{key:0,"append-icon":"mdi:mdi-chevron-up",size:"xs",variant:"flat",onClick:Q=>D.value.splice(D.value.findIndex(z=>z===d.key),1)},{default:t(()=>[d.raw.registration.Notes&&d.raw.registration.Notes.length>0?(s(),k(q,{key:0},[G(M(d.raw.registration.Notes.length),1)],64)):w("",!0)]),_:2},1032,["onClick"])):(s(),S(W,{key:1,"append-icon":"mdi:mdi-chevron-down",size:"xs",variant:"flat",onClick:Q=>D.value.push(d.key)},{default:t(()=>[d.raw.registration.Notes&&d.raw.registration.Notes.length>0?(s(),k(q,{key:0},[G(M(d.raw.registration.Notes.length),1)],64)):w("",!0)]),_:2},1032,["onClick"]))]),bottom:t(()=>[e(me,{fluid:!0},{default:t(()=>[e(ae,{class:"align-center"},{default:t(()=>[e(V,{cols:"12",lg:"7","order-lg":"3",xl:"8"},{default:t(()=>[e(al,{modelValue:H.value,"onUpdate:modelValue":l[16]||(l[16]=d=>H.value=d),modelModifiers:{number:!0},length:Math.ceil(ne.value/i.value)},null,8,["modelValue","length"])]),_:1}),e(V,{cols:"6",sm:"4",md:"2",lg:"2",xl:"1","order-lg":"1"},{default:t(()=>[e(oe,{modelValue:i.value,"onUpdate:modelValue":l[17]||(l[17]=d=>i.value=d),density:"compact","hide-details":"","item-title":"title","item-value":"value",label:"Items per page",min:"-1",max:"100",type:"number",variant:"outlined",items:[{title:"10",value:10},{title:"25",value:25},{title:"50",value:50},{title:"100",value:100},{title:"All",value:-1}]},null,8,["modelValue"])]),_:1}),e(V,{cols:"6",sm:"3",md:"2",lg:"1",xl:"1","order-lg":"2"},{default:t(()=>[e(ee,{modelValue:H.value,"onUpdate:modelValue":l[18]||(l[18]=d=>H.value=d),modelModifiers:{number:!0},density:"compact","hide-details":"",label:"Page",min:"1",max:Math.ceil(ne.value/i.value),type:"number",variant:"outlined"},null,8,["modelValue","max"])]),_:1}),e(V,{class:"text-right",cols:"12",sm:"5",md:"8",lg:"2",xl:"2","order-lg":"4"},{default:t(()=>[Y("span",bo,[i.value===-1?(s(),k(q,{key:0},[G(" 1-"+M(ne.value)+" of "+M(ne.value),1)],64)):(s(),k(q,{key:1},[G(M((H.value-1)*i.value+1)+" - "+M(H.value*i.value>=ne.value?ne.value:H.value*i.value)+" of "+M(ne.value),1)],64))])]),_:1})]),_:1})]),_:1})]),_:2},[ue(v.headers,d=>({name:`item.${d.key}`,fn:t(({internalItem:Q,index:z})=>[e(Al,{header:d,item:Q,accommodations:Pe.value,convention:u.value,extras:$e.value,forms:b.value,interests:Ye.value,tickets:Ge.value,user:A(Jt),venues:xe.value,modelValue:v.items[z],"onUpdate:modelValue":De=>v.items[z]=De,onOpenActions:ea,onOpenPayments:ta,onOpenTags:aa,onReload:l[14]||(l[14]=De=>qe({page:H.value,itemsPerPage:i.value,sortBy:X.value})),onSwitchUser:na,onShowForm:la},null,8,["header","item","accommodations","convention","extras","forms","interests","tickets","user","venues","modelValue","onUpdate:modelValue"])])}))]),1032,["expanded","page","items-per-page","sort-by","headers","items-length","items","loading","search","show-expand"])]),_:2},1024)):w("",!0)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"]),ce.value?(s(),S(Do,{key:0,title:"Edit Layouts",modelValue:ce.value,"onUpdate:modelValue":l[24]||(l[24]=v=>ce.value=v),convention:u.value,onSave:jt},null,8,["modelValue","convention"])):w("",!0),ie.value?(s(),k(q,{key:1},[Ie.value?(s(),S(bt,{key:0,modelValue:Ie.value,"onUpdate:modelValue":l[25]||(l[25]=v=>Ie.value=v),registration:ie.value,"onUpdate:registration":l[26]||(l[26]=v=>ie.value=v),accommodations:Pe.value,convention:u.value,extras:$e.value,forms:b.value,interests:Ye.value,tickets:Ge.value,title:`Registration Controls (#${ie.value.Reference} ${ie.value.User.DisplayName})`,"use-dialog":!0,venues:xe.value},null,8,["modelValue","registration","accommodations","convention","extras","forms","interests","tickets","title","venues"])):w("",!0)],64)):w("",!0),he.value&&Re.value&&Be.value?(s(),S(qt,{key:2,modelValue:he.value,"onUpdate:modelValue":l[30]||(l[30]=v=>he.value=v),scrollable:!0,fullscreen:!0,persistent:!0},{default:t(()=>[e(Le,{class:"bg-red-darken-4"},{default:t(()=>[e(St,{color:"error"},{default:t(()=>[e(ja,null,{default:t(()=>[G("Submission Editor - Admin Mode")]),_:1}),e(it),e(Ja,null,{default:t(()=>[e(W,{icon:"mdi:mdi-window-close",onClick:l[27]||(l[27]=v=>he.value=!1)})]),_:1})]),_:1}),e(je,null,{default:t(()=>[e(Ra,{modelValue:Be.value,"onUpdate:modelValue":l[28]||(l[28]=v=>Be.value=v),admin:!0,convention:u.value,data:Re.value,editable:!0,"registration-group":gt.value,onClose:l[29]||(l[29]=v=>{he.value=!1,qe({page:H.value,itemsPerPage:i.value,sortBy:X.value})})},null,8,["modelValue","convention","data","registration-group"])]),_:1})]),_:1})]),_:1},8,["modelValue"])):w("",!0)]),_:1}))}});export{kn as default};
