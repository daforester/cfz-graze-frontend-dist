import{s as x}from"./index-26b71cef.js";import{I as O,a0 as P,a1 as M,r as C,K as G,M as c,N as y,O as l,v as e,P as g,W as U,S as R,e as ee,V as b,H as $,a3 as Y,a4 as K,Q as S,X as k,R as se,x as Ee,w as H,a8 as be,E as ye,a9 as he,aa as _e,a2 as Ae,a7 as Be,s as ue,ab as je}from"./index-1cbd3703.js";import{m as Ne,a as Fe,s as Se,V as ze,T as w,b as He,F as Pe,c as J,_ as xe,d as Je}from"./FormRenderer.vue_vue_type_style_index_0_lang-41a1df6d.js";import{_ as le,a as Oe,V as re,b as me,c as ve,d as ce,e as qe,f as we,g as Xe,h as We,i as Qe,j as Ze}from"./VWindowItem-6e2cacb8.js";import{_ as Q}from"./SaveButton.vue_vue_type_script_setup_true_lang-24b01d68.js";import{e as pe,c as Ve}from"./VCard-7dec29e0.js";import{V as N}from"./VBtn-d4938346.js";import{V as z,j}from"./VContainer-9c35531d.js";import{a as ie,V as ne}from"./VToolbar-8df886dc.js";import{V as ae}from"./scopeId-d93862fe.js";import{V as Ue}from"./VToolbarItems-6f5c86e5.js";import{V as A}from"./VTextField-e6c19400.js";import{V as Te}from"./VDialog-293afca0.js";import{V as ke,d as Z,a as oe,b as $e}from"./VList-1d2d2822.js";import{V as F,a as D}from"./VRow-39495368.js";import{v as q}from"./v4-a960c1f4.js";import{V as De}from"./VTextarea-a851c24d.js";import{V as de}from"./copyToClipboard-b127db97.js";import{V as X,u as fe}from"./VCheckbox-c9501d5e.js";import{V as Me,a as Le}from"./VChip-3d810921.js";import{V as el,a as te}from"./VTable-51843fee.js";import{_ as Ke}from"./DeleteDialog.vue_vue_type_script_setup_true_lang-0b8d8ee0.js";import{_ as Re}from"./ModelDialog.vue_vue_type_script_setup_true_lang-c40a7427.js";import{V as Ye}from"./VDivider-69edf1a0.js";import{a as ll,F as tl}from"./form-29fd1dbb.js";import{V as al}from"./forwardRefs-44d10831.js";import{u as Ce}from"./nil-d01db1aa.js";import"./submission-6136b51d.js";import"./VAvatar-6d8fa1e6.js";import"./userData-4ccdf546.js";import"./VForm-97f9dd33.js";import"./createSimpleFunctional-436f0f0f.js";var ge=(T=>(T.PER_ROOM="PER_ROOM",T.PER_PERSON="PER_PERSON",T))(ge||{});const ol=O({__name:"EditConventionExtraOptions",props:P({convention:{}},{modelValue:{}}),emits:P(["close"],["update:modelValue"]),setup(T,{emit:s}){const a=M(T,"modelValue"),m=C(G(a.value)),i=()=>{a.value=m.value,s("close")};return(n,u)=>(c(),y(pe,null,{default:l(()=>[e(ne,{dark:"",color:"primary"},{default:l(()=>[e(N,{icon:"",dark:"",onClick:u[0]||(u[0]=t=>s("close"))},{default:l(()=>[e(z,null,{default:l(()=>[g("mdi:mdi-close")]),_:1})]),_:1}),e(ie,null,{default:l(()=>[g("Edit Option Choice")]),_:1}),e(ae),e(Ue,null,{default:l(()=>[e(N,{variant:"text",onClick:i},{default:l(()=>[g(" Apply ")]),_:1})]),_:1})]),_:1}),e(Ve,{class:"pa-0"},{default:l(()=>[e(j,null,{default:l(()=>[e(A,{label:U(x).formLabelName,type:"text",variant:"outlined",modelValue:m.value.Name,"onUpdate:modelValue":u[1]||(u[1]=t=>m.value.Name=t)},null,8,["label","modelValue"]),e(A,{label:U(x).formLabelDescription,type:"text",variant:"outlined",modelValue:m.value.Description,"onUpdate:modelValue":u[2]||(u[2]=t=>m.value.Description=t)},null,8,["label","modelValue"]),e(A,{label:U(x).formLabelPrice,type:"text",variant:"outlined","prepend-icon":U(x).currencyIcon,modelValue:m.value.Price,"onUpdate:modelValue":u[3]||(u[3]=t=>m.value.Price=t),modelModifiers:{number:!0},hint:"Adds additional charges for selecting this option"},null,8,["label","prepend-icon","modelValue"]),m.value.Choices?(c(),y(le,{key:0,modelValue:m.value.Choices,"onUpdate:modelValue":u[4]||(u[4]=t=>m.value.Choices=t),convention:n.convention,hint:"Sub-options (tags) that a user may choose from."},null,8,["modelValue","convention"])):R("",!0)]),_:1})]),_:1})]),_:1}))}}),nl=k("h3",null,"Options",-1),ul=O({__name:"EditConventionExtra",props:P({convention:{}},{modelValue:{required:!0}}),emits:["update:modelValue"],setup(T){const s=M(T,"modelValue"),a=C(G(s.value)),m=C(!1),i=C(0),n=Y(),u=C([""]),t=C([]),o=C([]);T.convention&&(n.getConventionTags(T.convention.ConventionUUID).then(V=>{o.value=V.sort((I,_)=>I.Title.localeCompare(_.Title))}),n.getOrganisationTags(T.convention.OrganisationUUID).then(V=>{t.value=V.sort((I,_)=>I.Title.localeCompare(_.Title))}));const v=ee(()=>[...t.value,...o.value]),r=({callback:V})=>{n.saveExtra(a.value).then(I=>{I?(s.value=I,V&&V("Extra Saved")):V&&V("Failed to Save Extra")}).catch(()=>{V&&V("Failed to Save Extra")})},d=V=>{var I;V.Options||(V.Options=[]),V.Options.push({ID:0,OptionUUID:q(),ExtraID:V.ID,ExtraUUID:V.ExtraUUID,Order:((I=V.Options)==null?void 0:I.length)+1,Name:"",Description:"",Price:0,Choices:[]})},p=(V,I)=>{V.Options&&V.Options.splice(I,1)},f=V=>{if(V.Choices&&V.Choices.length>0)return V.Choices.map(I=>{const _=v.value.find(E=>E.TagUUID===I.TagUUID);if(_)return _.Title}).join(", ")};return(V,I)=>(c(),b($,null,[e(j,{class:"px-0"},{default:l(()=>[e(A,{label:U(x).formLabelName,type:"text",variant:"outlined",modelValue:a.value.Name,"onUpdate:modelValue":I[0]||(I[0]=_=>a.value.Name=_)},null,8,["label","modelValue"]),e(A,{label:U(x).formLabelDescription,type:"text",variant:"outlined",modelValue:a.value.Description,"onUpdate:modelValue":I[1]||(I[1]=_=>a.value.Description=_)},null,8,["label","modelValue"]),e(le,{modelValue:a.value.AppliesTags,"onUpdate:modelValue":I[2]||(I[2]=_=>a.value.AppliesTags=_),convention:V.convention,organisation:V.convention.OrganisationUUID,hint:"Tags a user acquires by selecting any option within this addon purchase."},null,8,["modelValue","convention","organisation"]),e(le,{label:"Required Tags",variant:"outlined",modelValue:a.value.RequiredTags,"onUpdate:modelValue":I[3]||(I[3]=_=>a.value.RequiredTags=_),convention:V.convention,organisation:V.convention.OrganisationUUID,chips:"",clearable:"",hint:"Tags that a user must have to see this form. (Any one)"},null,8,["modelValue","convention","organisation"]),e(Oe,{label:"Required Groups",variant:"outlined",modelValue:a.value.RequiredGroupMemberships,"onUpdate:modelValue":I[4]||(I[4]=_=>a.value.RequiredGroupMemberships=_),convention:V.convention,organisation:V.convention.OrganisationUUID,chips:"",clearable:"",hint:"Groups that a user must be in to see this form. (Any one)"},null,8,["modelValue","convention","organisation"]),nl,e(ke,{opened:u.value,"onUpdate:opened":I[5]||(I[5]=_=>u.value=_)},{default:l(()=>[(c(!0),b($,null,K(a.value.Options,(_,E)=>(c(),b($,{key:_.ID},[_?(c(),y(oe,{key:0,"prepend-icon":"mdi:mdi-ticket-percent",title:`${_.Name} ${_.Price&&_.Price>0?`(${U(x).currencySymbol}${_.Price})`:""}`},{append:l(()=>[e(N,{color:"red",icon:"mdi:mdi-close",size:"x-small",class:"mr-1",onClick:h=>p(a.value,E)},null,8,["onClick"]),e(N,{color:"primary",icon:"mdi:mdi-pencil",size:"x-small",onClick:h=>{m.value=!0,i.value=E}},null,8,["onClick"])]),default:l(()=>[_.Choices&&_.Choices.length>0?(c(),y(Z,{key:0},{default:l(()=>[g(" Options: "+S(f(_)),1)]),_:2},1024)):R("",!0)]),_:2},1032,["title"])):R("",!0)],64))),128))]),_:1},8,["opened"]),e(N,{color:"primary",onClick:I[6]||(I[6]=_=>d(a.value))},{default:l(()=>[g("Add Option")]),_:1}),e(F,null,{default:l(()=>[e(D,{class:"text-right"},{default:l(()=>[e(Q,{onClick:r})]),_:1})]),_:1})]),_:1}),e(Te,{modelValue:m.value,"onUpdate:modelValue":I[9]||(I[9]=_=>m.value=_),scrollable:""},{default:l(()=>[e(ol,{modelValue:a.value.Options[i.value],"onUpdate:modelValue":I[7]||(I[7]=_=>a.value.Options[i.value]=_),convention:V.convention,onClose:I[8]||(I[8]=_=>m.value=!1)},null,8,["modelValue","convention"])]),_:1},8,["modelValue"])],64))}}),il=O({__name:"EditConventionExtras",props:P({convention:{}},{modelValue:{required:!0}}),emits:P(["close"],["update:modelValue"]),setup(T,{emit:s}){const a=M(T,"modelValue"),m=Y(),i=()=>{const t={ID:0,ExtraUUID:q(),ConventionID:T.convention.ID,ConventionUUID:T.convention.ConventionUUID,Order:a.value.length+1,Name:"New Extra",Description:"",AppliesTags:[],RequiredTags:[],RequiredGroupMemberships:[],Options:[]};m.saveExtra(t).then(o=>{o&&a.value.push(o)})},n=t=>{m.deleteExtra(a.value[t].ExtraUUID).then(o=>{o&&a.value.splice(t,1)})},u=(...t)=>{t.forEach(o=>{o>=0&&o<a.value.length&&m.saveExtra(a.value[o])})};return(t,o)=>(c(),y(pe,null,{default:l(()=>[e(ne,{dark:"",color:"primary"},{default:l(()=>[e(ie,null,{default:l(()=>[g("Edit Extras")]),_:1}),e(ae),e(Ue,null,{default:l(()=>[e(N,{variant:"text",onClick:i},{default:l(()=>[g(" Add ")]),_:1}),e(N,{icon:"",dark:"",onClick:o[0]||(o[0]=v=>s("close"))},{default:l(()=>[e(z,null,{default:l(()=>[g("mdi:mdi-close")]),_:1})]),_:1})]),_:1})]),_:1}),e(Ve,{class:"pa-0"},{default:l(()=>[e(re,null,{default:l(()=>[(c(!0),b($,null,K(a.value,(v,r)=>(c(),y(me,{key:v.ID,class:"mt-0"},{default:l(()=>[e(ve,null,{actions:l(({expanded:d})=>[e(N,{icon:"mdi:mdi-close",size:"x-small",color:"red",class:"mr-1",onClick:p=>n(r)},null,8,["onClick"]),e(z,{class:"align-self-center text-h5",icon:d?"mdi:mdi-chevron-up":"mdi:mdi-chevron-down",variant:"flat",size:"x-small"},null,8,["icon"])]),default:l(()=>[e(N,{icon:"mdi:mdi-menu-up",size:"x-small",color:"primary",class:"mr-1",onClick:se(d=>{U(Ne)(v,a.value),u(r,r-1)},["stop"])},null,8,["onClick"]),e(N,{icon:"mdi:mdi-menu-down",size:"x-small",color:"secondary",class:"mr-4",onClick:se(d=>{U(Fe)(v,a.value),u(r,r+1)},["stop"])},null,8,["onClick"]),g(" "+S(v.Name)+" ",1)]),_:2},1024),e(ce,{class:"px-0"},{default:l(()=>[e(ul,{convention:t.convention,modelValue:a.value[r],"onUpdate:modelValue":d=>a.value[r]=d},null,8,["convention","modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1}))}}),dl=k("h3",null,"Additional Purchases",-1),sl=k("p",null,"These are global ticket addons that are not tied to any particular ticket type.",-1),rl=O({__name:"Extras",props:{modelValue:{required:!0}},emits:["update:modelValue"],setup(T){const s=M(T,"modelValue"),a=C([]),m=Y(),i=C([""]),n=C(!1),u=o=>{if(o.Choices&&o.Choices.length>0)return o.Choices.map(v=>v.Title).join(", ")},t=()=>{n.value=!1};return m==null||m.getConventionExtras(s.value.ConventionUUID||"").then(o=>{o&&(a.value=o)}),(o,v)=>(c(),b($,null,[e(j,{fluid:!0,class:"px-0"},{default:l(()=>[e(F,null,{default:l(()=>[e(D,null,{default:l(()=>[dl]),_:1}),e(D,{class:"text-right"},{default:l(()=>[e(N,{color:"primary",onClick:v[0]||(v[0]=r=>n.value=!0)},{default:l(()=>[g("Edit")]),_:1})]),_:1})]),_:1})]),_:1}),sl,e(ke,{opened:i.value,"onUpdate:opened":v[1]||(v[1]=r=>i.value=r)},{default:l(()=>[(c(!0),b($,null,K(a.value,r=>(c(),y($e,{key:r.ID,value:r.ID},{activator:l(({props:d})=>[e(oe,Ee(d,{"prepend-icon":"mdi:mdi-group",title:r.Name}),null,16,["title"])]),default:l(()=>[r.Options?(c(!0),b($,{key:0},K(r.Options,d=>(c(),y(oe,{key:d.ID,"prepend-icon":"mdi:mdi-ticket-percent",title:`${d.Name} ${d.Price&&d.Price>0?`(${U(x).currencySymbol}${d.Price})`:""}`},{default:l(()=>[d.Choices&&d.Choices.length>0?(c(),y(Z,{key:0},{default:l(()=>[g(" Options: "+S(u(d)),1)]),_:2},1024)):R("",!0)]),_:2},1032,["title"]))),128)):R("",!0)]),_:2},1032,["value"]))),128))]),_:1},8,["opened"]),e(Te,{modelValue:n.value,"onUpdate:modelValue":v[3]||(v[3]=r=>n.value=r),scrollable:!0,persistent:!0,fullscreen:!0},{default:l(()=>[e(il,{modelValue:a.value,"onUpdate:modelValue":v[2]||(v[2]=r=>a.value=r),convention:s.value,onClose:t},null,8,["modelValue","convention"])]),_:1},8,["modelValue"])],64))}}),ml=O({__name:"EditConventionInterest",props:P({convention:{}},{modelValue:{required:!0}}),emits:["update:modelValue"],setup(T){const s=M(T,"modelValue"),a=C(G(s.value)),m=Y(),i=({callback:n})=>{m.saveInterest(a.value).then(u=>{u?(s.value=u,n&&n("Interest Saved")):n&&n("Failed to Save Interest")}).catch(()=>{n&&n("Failed to Save Interest")})};return(n,u)=>(c(),y(j,{class:"px-0"},{default:l(()=>[e(A,{label:U(x).formLabelName,type:"text",variant:"outlined",modelValue:a.value.Name,"onUpdate:modelValue":u[0]||(u[0]=t=>a.value.Name=t)},null,8,["label","modelValue"]),e(De,{label:U(x).formLabelDescription,type:"text",variant:"outlined",modelValue:a.value.Description,"onUpdate:modelValue":u[1]||(u[1]=t=>a.value.Description=t)},null,8,["label","modelValue"]),R("",!0),e(le,{modelValue:a.value.AppliesTags,"onUpdate:modelValue":u[3]||(u[3]=t=>a.value.AppliesTags=t),convention:n.convention,organisation:n.convention.OrganisationUUID,hint:"Tags that a user acquires by selecting this interest."},null,8,["modelValue","convention","organisation"]),e(F,null,{default:l(()=>[e(D,{class:"text-right"},{default:l(()=>[e(Q,{onClick:i})]),_:1})]),_:1})]),_:1}))}}),vl=O({__name:"EditConventionInterests",props:P({convention:{}},{modelValue:{required:!0}}),emits:P(["close"],["update:modelValue"]),setup(T,{emit:s}){const a=M(T,"modelValue"),m=Y(),i=()=>{const t={ID:0,InterestUUID:q(),ConventionID:T.convention.ID,ConventionUUID:T.convention.ConventionUUID,Order:a.value.length+1,Name:"New Interest",Description:"",Price:0,AppliesTags:[]};m.saveInterest(t).then(o=>{o&&a.value.push(o)})},n=t=>{m.deleteInterest(a.value[t].InterestUUID).then(o=>{o&&a.value.splice(t,1)})},u=(...t)=>{t.forEach(o=>{o>=0&&o<a.value.length&&m.saveInterest(a.value[o])})};return(t,o)=>(c(),y(pe,null,{default:l(()=>[e(ne,{dark:"",color:"primary"},{default:l(()=>[e(ie,null,{default:l(()=>[g("Edit Interests")]),_:1}),e(ae),e(Ue,null,{default:l(()=>[e(N,{variant:"text",onClick:i},{default:l(()=>[g(" Add ")]),_:1}),e(N,{icon:"",dark:"",onClick:o[0]||(o[0]=v=>s("close"))},{default:l(()=>[e(z,null,{default:l(()=>[g("mdi:mdi-close")]),_:1})]),_:1})]),_:1})]),_:1}),e(Ve,{class:"pa-0"},{default:l(()=>[e(re,null,{default:l(()=>[(c(!0),b($,null,K(a.value,(v,r)=>(c(),y(me,{key:v.ID,class:"mt-0"},{default:l(()=>[e(ve,null,{actions:l(({expanded:d})=>[e(Q,{class:"mr-1",color:"red",icon:"mdi:mdi-close",size:"x-small",onClick:p=>n(r)},null,8,["onClick"]),e(z,{class:"align-self-center text-h5",icon:d?"mdi:mdi-chevron-up":"mdi:mdi-chevron-down",variant:"flat",size:"x-small"},null,8,["icon"])]),default:l(()=>[e(N,{icon:"mdi:mdi-menu-up",size:"x-small",color:"primary",class:"mr-1",onClick:se(d=>{U(Ne)(v,a.value),u(r,r-1)},["stop"])},null,8,["onClick"]),e(N,{icon:"mdi:mdi-menu-down",size:"x-small",color:"secondary",class:"mr-4",onClick:se(d=>{U(Fe)(v,a.value),u(r,r+1)},["stop"])},null,8,["onClick"]),g(" "+S(v.Name)+" ",1)]),_:2},1024),e(ce,{class:"px-0"},{default:l(()=>[e(ml,{convention:t.convention,modelValue:a.value[r],"onUpdate:modelValue":d=>a.value[r]=d},null,8,["convention","modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1}))}}),cl=k("h3",null,"Interests",-1),pl=k("p",null,"Attendees can tag themselves for particular things.",-1),fl=O({__name:"Interests",props:{modelValue:{required:!0}},emits:P(["refresh"],["update:modelValue"]),setup(T){const s=M(T,"modelValue"),a=Y(),m=C([]);a.getConventionInterests(s.value.ConventionUUID).then(u=>{Se(u),m.value=u});const i=C([""]),n=C(!1);return(u,t)=>(c(),b($,null,[e(j,{fluid:!0,class:"px-0"},{default:l(()=>[e(F,null,{default:l(()=>[e(D,null,{default:l(()=>[cl]),_:1}),e(D,{class:"text-right"},{default:l(()=>[e(N,{color:"primary",onClick:t[0]||(t[0]=o=>n.value=!0)},{default:l(()=>[g("Edit")]),_:1})]),_:1})]),_:1})]),_:1}),pl,e(ke,{opened:i.value,"onUpdate:opened":t[1]||(t[1]=o=>i.value=o)},{default:l(()=>[(c(!0),b($,null,K(m.value,o=>(c(),y(oe,{key:o.ID,"prepend-icon":"mdi:mdi-checkbox-marked-outline",title:`${o.Name} ${o.Price&&o.Price>0?`(${U(x).currencySymbol}${o.Price})`:""}`},{default:l(()=>[o.Description?(c(),y(Z,{key:0},{default:l(()=>[g(S(o.Description),1)]),_:2},1024)):R("",!0)]),_:2},1032,["title"]))),128))]),_:1},8,["opened"]),e(Te,{modelValue:n.value,"onUpdate:modelValue":t[4]||(t[4]=o=>n.value=o),scrollable:!0,fullscreen:!0,persistent:!0},{default:l(()=>[e(vl,{onClose:t[2]||(t[2]=o=>n.value=!1),convention:s.value,modelValue:m.value,"onUpdate:modelValue":t[3]||(t[3]=o=>m.value=o)},null,8,["convention","modelValue"])]),_:1},8,["modelValue"])],64))}}),Ie=O({__name:"SelectTickets",props:P({chips:{type:Boolean,default:!1},clearable:{type:Boolean,default:!1},hint:{default:"Tickets that belong to this group."},label:{default:"Tickets"},persistentHint:{type:Boolean,default:!1},tickets:{default:()=>[]},variant:{}},{modelValue:{required:!0}}),emits:["update:modelValue"],setup(T){const s=M(T,"modelValue"),a=i=>i.Type===w.TICKET_TYPE_GROUP?"mdi:mdi-group":i.Type===w.TICKET_TYPE_TICKET?i.RequiresAccommodation?"mdi:mdi-home":i.ComponentsRequired>0?"mdi:mdi-ticket-confirmation":"mdi:mdi-ticket":i.Type===w.TICKET_TYPE_TICKET_COMPONENT?"mdi:mdi-cog-outline":i.Type===w.TICKET_TYPE_ADD_ON?"mdi:mdi-home-plus":"mdi:mdi-help",m=ee(()=>T.tickets.map(i=>({title:i.Name,value:s.value.find(n=>n&&n.TicketUUID===i.TicketUUID)||i,props:{appendIcon:a(i)}})));return(i,n)=>(c(),b("div",null,[e(ze,{label:i.label,variant:i.variant||"filled",items:m.value,"item-title":"title","item-value":"value","item-props":"props",modelValue:s.value,"onUpdate:modelValue":n[0]||(n[0]=u=>s.value=u),hint:i.hint,chips:i.chips,clearable:i.clearable,multiple:"","persistent-hint":i.persistentHint},null,8,["label","variant","items","modelValue","hint","chips","clearable","persistent-hint"])]))}}),Vl=k("p",{title:"Automatically calculated",class:"text-grey-lighten-1"},"Applicable Accommodation:",-1),Ul=O({__name:"EditConventionTicket",props:P({accommodation:{default:()=>[]},convention:{},tickets:{default:()=>[]}},{modelValue:{required:!0}}),emits:["update:modelValue"],setup(T){const s=M(T,"modelValue"),a=C(G(s.value)),m=Y(),i=ee(()=>T.tickets.filter(v=>v.Type===w.TICKET_TYPE_TICKET)),n=ee(()=>T.tickets.filter(v=>v.Type===w.TICKET_TYPE_ADD_ON)),u=ee(()=>T.tickets.filter(v=>v.Type===w.TICKET_TYPE_TICKET_COMPONENT)),t=v=>T.accommodation.filter(r=>r.Costs.find(d=>d.DateStart===v.DateStart&&d.DateEnd===v.DateEnd)),o=({callback:v})=>{m.saveTicket(a.value).then(r=>{r?(a.value.ID=r.ID,a.value.TicketUUID=r.TicketUUID,s.value=a.value,v&&v("Ticket Saved")):v&&v("Failed to Save Ticket")}).catch(()=>{v&&v("Failed to Save Ticket")})};return(v,r)=>(c(),y(j,{class:"px-0",fluid:""},{default:l(()=>[e(F,null,{default:l(()=>[e(D,{cols:"12"},{default:l(()=>[e(de,{label:"Ticket Type",variant:"outlined",modelValue:a.value.Type,"onUpdate:modelValue":r[0]||(r[0]=d=>a.value.Type=d),items:U(He),"item-title":"title","item-value":"value","hide-details":""},null,8,["modelValue","items"])]),_:1}),e(D,{cols:"12"},{default:l(()=>[e(A,{label:U(x).formLabelName,type:"text",variant:"outlined",modelValue:a.value.Name,"onUpdate:modelValue":r[1]||(r[1]=d=>a.value.Name=d),"hide-details":""},null,8,["label","modelValue"])]),_:1}),e(D,{cols:"12"},{default:l(()=>[e(A,{label:U(x).formLabelDescription,type:"text",variant:"outlined",modelValue:a.value.Description,"onUpdate:modelValue":r[2]||(r[2]=d=>a.value.Description=d),"hide-details":""},null,8,["label","modelValue"])]),_:1}),a.value.Type!==U(w).TICKET_TYPE_GROUP?(c(),b($,{key:0},[e(D,{cols:"12"},{default:l(()=>[e(X,{label:U(x).formLabelRequiresAccommodation,modelValue:a.value.RequiresAccommodation,"onUpdate:modelValue":r[3]||(r[3]=d=>a.value.RequiresAccommodation=d),"hide-details":""},null,8,["label","modelValue"])]),_:1}),e(D,{cols:"12"},{default:l(()=>[e(A,{label:U(x).formLabelDateStart,type:"date",variant:"outlined",modelValue:a.value.DateStart,"onUpdate:modelValue":r[4]||(r[4]=d=>a.value.DateStart=d),"hide-details":""},null,8,["label","modelValue"])]),_:1}),e(D,{cols:"12"},{default:l(()=>[e(A,{label:U(x).formLabelDateEnd,type:"date",variant:"outlined",modelValue:a.value.DateEnd,"onUpdate:modelValue":r[5]||(r[5]=d=>a.value.DateEnd=d),"hide-details":""},null,8,["label","modelValue"])]),_:1}),e(D,{cols:"12"},{default:l(()=>[e(A,{label:U(x).formLabelPrice,type:"text",variant:"outlined","prepend-inner-icon":U(x).currencyIcon,modelValue:a.value.Price,"onUpdate:modelValue":r[6]||(r[6]=d=>a.value.Price=d),modelModifiers:{number:!0},"persistent-hint":"",hint:"Adds additional charges for selecting this ticket"},null,8,["label","prepend-inner-icon","modelValue"])]),_:1})],64)):(c(),y(D,{key:1,cols:"12"},{default:l(()=>[e(Ie,{label:"Tickets",variant:"outlined",tickets:i.value,modelValue:a.value.Tickets,"onUpdate:modelValue":r[7]||(r[7]=d=>a.value.Tickets=d),chips:"",clearable:"",multiple:"","persistent-hint":"",hint:"Tickets that belong to this group."},null,8,["tickets","modelValue"])]),_:1})),e(D,{cols:"12"},{default:l(()=>[e(le,{label:"Applied Tags",variant:"outlined",modelValue:a.value.AppliesTags,"onUpdate:modelValue":r[8]||(r[8]=d=>a.value.AppliesTags=d),convention:v.convention,organisation:v.convention.OrganisationUUID,chips:"",clearable:"",hint:"Tags that a user acquires by selecting this ticket."},null,8,["modelValue","convention","organisation"])]),_:1}),e(D,{cols:"12"},{default:l(()=>[e(le,{label:"Required Tags",variant:"outlined",modelValue:a.value.RequiredTags,"onUpdate:modelValue":r[9]||(r[9]=d=>a.value.RequiredTags=d),convention:v.convention,organisation:v.convention.OrganisationUUID,chips:"",clearable:"",hint:"Tags that a user must have to see this ticket."},null,8,["modelValue","convention","organisation"])]),_:1}),a.value.Type===U(w).TICKET_TYPE_TICKET?(c(),b($,{key:2},[e(D,{cols:"12"},{default:l(()=>[e(A,{label:"Components Required",type:"number",variant:"outlined",modelValue:a.value.ComponentsRequired,"onUpdate:modelValue":r[10]||(r[10]=d=>a.value.ComponentsRequired=d),modelModifiers:{number:!0},"persistent-hint":"",hint:"How many components must be selected."},null,8,["modelValue"])]),_:1}),e(D,{cols:"12"},{default:l(()=>[e(Ie,{label:"Components",variant:"outlined",tickets:u.value,modelValue:a.value.TicketComponents,"onUpdate:modelValue":r[11]||(r[11]=d=>a.value.TicketComponents=d),chips:"",clearable:"",multiple:"","persistent-hint":"",hint:"Components that are part of this ticket (and others)."},null,8,["tickets","modelValue"])]),_:1}),e(D,{cols:"12"},{default:l(()=>[e(Ie,{label:"Addons",variant:"outlined",tickets:n.value,modelValue:a.value.AddonTickets,"onUpdate:modelValue":r[12]||(r[12]=d=>a.value.AddonTickets=d),chips:"",clearable:"",multiple:"","persistent-hint":"",hint:"Optional ticket addons that apply for this ticket."},null,8,["tickets","modelValue"])]),_:1})],64)):R("",!0),e(D,{cols:"12"},{default:l(()=>[e(Ie,{label:"Disables Tickets",variant:"outlined",tickets:v.tickets,modelValue:a.value.DisablesTickets,"onUpdate:modelValue":r[13]||(r[13]=d=>a.value.DisablesTickets=d),chips:"",clearable:"",multiple:"","persistent-hint":"",hint:"Tickets that are mutually exclusive and can't be selected if this one is."},null,8,["tickets","modelValue"])]),_:1})]),_:1}),t(a.value).length?(c(),y(F,{key:0,class:"align-center",dense:!0},{default:l(()=>[e(D,{class:"flex-grow-0 flex-shrink-1 text-no-wrap font-italic"},{default:l(()=>[Vl]),_:1}),e(D,{class:"flex-grow-1"},{default:l(()=>[e(Me,null,{default:l(()=>[(c(!0),b($,null,K(t(a.value),d=>(c(),y(Le,{key:d.ID,title:"Automatically calculated",disabled:!0},{default:l(()=>[g(S(d.Name),1)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})):R("",!0),e(F,null,{default:l(()=>[e(D,{class:"text-right"},{default:l(()=>[e(Q,{onClick:o})]),_:1})]),_:1})]),_:1}))}}),Tl={class:"pr-2"},Dl={class:"mb-2"},Il={key:0,class:"text-grey-darken-1 font-italic"},_l={key:1,class:"text-red"},yl={key:0,class:"text-grey-darken-1 font-italic"},Cl={key:1,class:"text-red"},gl={key:0,class:"text-grey-darken-1 font-italic"},bl={key:1,class:"text-red"},kl={class:"text-grey-darken-1"},El=O({__name:"EditConventionTickets",props:P({accommodation:{default:()=>[]},convention:{}},{modelValue:{default:[]}}),emits:P(["close"],["update:modelValue"]),setup(T,{emit:s}){const a=M(T,"modelValue"),m=Y(),i=()=>{a.value.push({ID:0,TicketUUID:q(),ConventionID:T.convention.ID,ConventionUUID:T.convention.ConventionUUID,Order:a.value.length+1,Name:"New Ticket",Type:w.TICKET_TYPE_GROUP,Description:"",DateStart:"",DateEnd:"",Price:0,Tickets:[],RequiresAccommodation:!1,AppliesTags:[],RequiredTags:[],RequiredGroupMemberships:[],TicketComponents:[],ComponentsRequired:0,AddonTickets:[],DisablesTickets:[]})},n=t=>{m.deleteTicket(a.value[t].TicketUUID).then(o=>{o&&a.value.splice(t,1)})},u=t=>t.Type===w.TICKET_TYPE_GROUP?"mdi:mdi-group":t.Type===w.TICKET_TYPE_TICKET?t.RequiresAccommodation?"mdi:mdi-home":t.ComponentsRequired>0?"mdi:mdi-ticket-confirmation":"mdi:mdi-ticket":t.Type===w.TICKET_TYPE_TICKET_COMPONENT?"mdi:mdi-cog-outline":t.Type===w.TICKET_TYPE_ADD_ON?"mdi:mdi-home-plus":"mdi:mdi-help";return(t,o)=>(c(),y(pe,null,{default:l(()=>[e(ne,{dark:"",color:"primary"},{default:l(()=>[e(ie,null,{default:l(()=>[g("Edit Tickets")]),_:1}),e(ae),e(Ue,null,{default:l(()=>[e(N,{variant:"text",onClick:i},{default:l(()=>[g(" Add Ticket ")]),_:1}),e(N,{icon:"",dark:"",onClick:o[0]||(o[0]=v=>s("close"))},{default:l(()=>[e(z,null,{default:l(()=>[g("mdi:mdi-close")]),_:1})]),_:1})]),_:1})]),_:1}),e(Ve,{class:"pa-0"},{default:l(()=>[e(re,null,{default:l(()=>[(c(!0),b($,null,K(a.value,(v,r)=>(c(),y(me,{key:v.ID,class:"mt-0"},{default:l(()=>[e(ve,{class:"py-2"},{actions:l(({expanded:d})=>[e(Q,{class:"mr-1",color:"red",icon:"mdi:mdi-close",size:"x-small",onClick:p=>n(r)},null,8,["onClick"]),e(z,{class:"align-self-center text-h5",icon:d?"mdi:mdi-chevron-up":"mdi:mdi-chevron-down",variant:"flat",size:"x-small"},null,8,["icon"])]),default:l(()=>[e(N,{icon:"mdi:mdi-menu-up",size:"x-small",color:"primary",class:"mr-1",onClick:se(d=>U(Ne)(v,a.value),["stop"])},null,8,["onClick"]),e(N,{icon:"mdi:mdi-menu-down",size:"x-small",color:"secondary",class:"mr-4",onClick:se(d=>U(Fe)(v,a.value),["stop"])},null,8,["onClick"]),k("div",Tl,[e(z,{icon:u(v)},null,8,["icon"])]),k("div",null,[k("p",Dl,[g(S(v.Name)+" ",1),v.Type===U(w).TICKET_TYPE_TICKET?(c(),b($,{key:0},[a.value.find(d=>d.Type===U(w).TICKET_TYPE_GROUP&&d.Tickets.find(p=>p&&p.TicketUUID===v.TicketUUID))?(c(),b("span",Il," ("+S(a.value.filter(d=>d.Type===U(w).TICKET_TYPE_GROUP&&d.Tickets.find(p=>p&&p.TicketUUID===v.TicketUUID)).map(d=>d.Name).join(", "))+") ",1)):(c(),b("span",_l," (Ticket does not belong to any categories.) "))],64)):R("",!0),v.Type===U(w).TICKET_TYPE_ADD_ON?(c(),b($,{key:1},[a.value.find(d=>d.Type===U(w).TICKET_TYPE_TICKET&&d.AddonTickets.find(p=>p&&p.TicketUUID===v.TicketUUID))?(c(),b("span",yl," ("+S(a.value.filter(d=>d.Type===U(w).TICKET_TYPE_TICKET&&d.AddonTickets.find(p=>p&&p.TicketUUID===v.TicketUUID)).map(d=>d.Name).join(", "))+") ",1)):(c(),b("span",Cl," (Ticket addon must be associated to at least one ticket.) "))],64)):R("",!0),v.Type===U(w).TICKET_TYPE_TICKET_COMPONENT?(c(),b($,{key:2},[a.value.find(d=>d.Type===U(w).TICKET_TYPE_TICKET&&d.TicketComponents.find(p=>p&&p.TicketUUID===v.TicketUUID))?(c(),b("span",gl," ("+S(a.value.filter(d=>d.Type===U(w).TICKET_TYPE_TICKET&&d.TicketComponents.find(p=>p&&p.TicketUUID===v.TicketUUID)).map(d=>d.Name).join(", "))+") ",1)):(c(),b("span",bl," (Component has not been assigned to any tickets.) "))],64)):R("",!0)]),k("p",kl,[v.Type===U(w).TICKET_TYPE_GROUP?(c(),b($,{key:0},[g("Category")],64)):v.Type===U(w).TICKET_TYPE_TICKET?(c(),b($,{key:1},[g(" Ticket "),v.ComponentsRequired>0?(c(),b($,{key:0},[g(" ("+S(v.ComponentsRequired)+" component"+S(v.ComponentsRequired>1?"s":"")+" required) ",1)],64)):R("",!0)],64)):R("",!0),v.Type===U(w).TICKET_TYPE_TICKET_COMPONENT?(c(),b($,{key:2},[g("Component")],64)):R("",!0),v.Type===U(w).TICKET_TYPE_ADD_ON?(c(),b($,{key:3},[g("Addon")],64)):R("",!0)])])]),_:2},1024),e(ce,{class:"px-0"},{default:l(()=>[e(Ul,{accommodation:t.accommodation,convention:t.convention,tickets:a.value,modelValue:a.value[r],"onUpdate:modelValue":d=>a.value[r]=d},null,8,["accommodation","convention","tickets","modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1}))}}),hl=k("h3",null,"Tickets",-1),$l=k("p",null,"Ticket options, along with all sub-types and options applicable to them.",-1),Nl=O({__name:"Tickets",props:{modelValue:{required:!0}},emits:P(["refresh"],["update:modelValue"]),setup(T){var d;const s=M(T,"modelValue"),a=Y(),m=C([]),i=C([]);a.getConventionTickets(((d=s.value)==null?void 0:d.ConventionUUID)||"").then(p=>{Se(p),m.value=p});const n=C([""]),u=C(!1),t=p=>p.AddonTickets&&p.AddonTickets.map(f=>m.value&&m.value.find(V=>V.ID===f.ID)),o=p=>p.TicketComponents&&p.TicketComponents.map(f=>m.value&&m.value.find(V=>V.ID===f.ID)),v=p=>"",r=p=>i.value.filter(f=>f.Costs.find(V=>V.DateStart===p.DateStart&&V.DateEnd===p.DateEnd)).map(f=>f.Name).join(", ");return(p,f)=>(c(),b($,null,[e(j,{fluid:!0,class:"px-0"},{default:l(()=>[e(F,null,{default:l(()=>[e(D,null,{default:l(()=>[hl]),_:1}),e(D,{class:"text-right"},{default:l(()=>[e(N,{color:"primary",onClick:f[0]||(f[0]=V=>u.value=!0)},{default:l(()=>[g("Edit")]),_:1})]),_:1})]),_:1})]),_:1}),$l,e(ke,{opened:n.value,"onUpdate:opened":f[1]||(f[1]=V=>n.value=V)},{default:l(()=>[(c(!0),b($,null,K(m.value.filter(V=>V.Type===U(w).TICKET_TYPE_GROUP),V=>(c(),y($e,{key:V.ID,value:V.ID},{activator:l(({props:I})=>[e(oe,Ee(I,{"prepend-icon":"mdi:mdi-group",title:V.Name}),null,16,["title"])]),default:l(()=>[(c(!0),b($,null,K(m.value.filter(I=>V.Tickets.find(_=>_&&I&&_.TicketUUID===I.TicketUUID)),I=>(c(),b($,{key:I.ID},[I.AddonTickets&&I.AddonTickets.length?(c(),y($e,{key:0,value:I.ID},{activator:l(({props:_})=>[e(oe,Ee(_,{"prepend-icon":I.RequiresAccommodation?"mdi:mdi-home":I.ComponentsRequired>0?"mdi:mdi-ticket-confirmation":"mdi:mdi-ticket",title:`${I.Name} ${I.Price>0?`(${U(x).currencySymbol}${I.Price})`:""}`}),{default:l(()=>[I.ComponentsRequired>0?(c(),y(Z,{key:0},{default:l(()=>[g(" Options: "+S(o(I).map(E=>E&&E.Name).join(", ")),1)]),_:2},1024)):R("",!0),I.RequiresAccommodation&&r(I)?(c(),y(Z,{key:1},{default:l(()=>[g(" Accommodation: "+S(r(I)),1)]),_:2},1024)):R("",!0)]),_:2},1040,["prepend-icon","title"])]),default:l(()=>[(c(!0),b($,null,K(t(I),_=>(c(),b($,{key:_},[_?(c(),y(oe,{key:0,title:`${_.Name} ${_.Price>0?`(${U(x).currencySymbol}${_.Price})`:""}`,"prepend-icon":"mdi:mdi-home-plus"},{default:l(()=>[_.RequiredTags&&_.RequiredTags.length>0?(c(),y(Z,{key:0},{default:l(()=>[g(" Required Tags: "+S(_.RequiredTags.join(", ")),1)]),_:2},1024)):R("",!0),_.RequiredGroupMemberships&&_.RequiredGroupMemberships.length>0?(c(),y(Z,{key:1},{default:l(()=>[g(" Required Groups: "+S(v(_.RequiredGroupMemberships)),1)]),_:2},1024)):R("",!0),r(_)?(c(),y(Z,{key:2},{default:l(()=>[g(" Accommodation: "+S(r(_)),1)]),_:2},1024)):R("",!0)]),_:2},1032,["title"])):R("",!0)],64))),128))]),_:2},1032,["value"])):(c(),y(oe,{key:1,"prepend-icon":I.RequiresAccommodation?"mdi:mdi-home":I.ComponentsRequired>0?"mdi:mdi-ticket-confirmation":"mdi:mdi-ticket",title:`${I.Name} ${I.Price>0?`(${U(x).currencySymbol}${I.Price})`:""}`},{default:l(()=>[I.ComponentsRequired>0?(c(),y(Z,{key:0},{default:l(()=>[g(" Options: "+S(o(I).map(_=>_&&_.Name).join(", ")),1)]),_:2},1024)):R("",!0)]),_:2},1032,["prepend-icon","title"]))],64))),128))]),_:2},1032,["value"]))),128))]),_:1},8,["opened"]),e(Te,{modelValue:u.value,"onUpdate:modelValue":f[4]||(f[4]=V=>u.value=V),scrollable:!0,fullscreen:!0,persistent:!0},{default:l(()=>[e(El,{onClose:f[2]||(f[2]=V=>u.value=!1),modelValue:m.value,"onUpdate:modelValue":f[3]||(f[3]=V=>m.value=V),accommodation:i.value,convention:s.value},null,8,["modelValue","accommodation","convention"])]),_:1},8,["modelValue"])],64))}}),Fl=O({__name:"VenueRoomCost",props:{modelValue:{required:!0}},emits:P(["deleted"],["update:modelValue"]),setup(T,{emit:s}){const a=M(T,"modelValue"),m=[{title:"Per Room",value:"PER_ROOM"},{title:"Per Person",value:"PER_PERSON"}],i=()=>{s("deleted")};return(n,u)=>(c(),y(F,{dense:""},{default:l(()=>[e(D,{cols:"12",sm:"4",md:"2",lg:"2"},{default:l(()=>[e(A,{label:U(x).formLabelDateStart,type:"date",variant:"outlined",modelValue:a.value.DateStart,"onUpdate:modelValue":u[0]||(u[0]=t=>a.value.DateStart=t)},null,8,["label","modelValue"])]),_:1}),e(D,{cols:"12",sm:"4",md:"2",lg:"2"},{default:l(()=>[e(A,{label:U(x).formLabelDateEnd,type:"date",variant:"outlined",modelValue:a.value.DateEnd,"onUpdate:modelValue":u[1]||(u[1]=t=>a.value.DateEnd=t)},null,8,["label","modelValue"])]),_:1}),e(D,{cols:"6",sm:"4",md:"2",lg:"2"},{default:l(()=>[e(A,{label:U(x).formLabelAvailability,type:"number",variant:"outlined",modelValue:a.value.Availability,"onUpdate:modelValue":u[2]||(u[2]=t=>a.value.Availability=t),modelModifiers:{number:!0}},null,8,["label","modelValue"])]),_:1}),e(D,{cols:"6",sm:"4",md:"2",lg:"2"},{default:l(()=>[e(A,{label:U(x).formLabelPrice,type:"number","prepend-inner-icon":"mdi:mdi-currency-gbp",variant:"outlined",modelValue:a.value.Price,"onUpdate:modelValue":u[3]||(u[3]=t=>a.value.Price=t),modelModifiers:{number:!0}},null,8,["label","modelValue"])]),_:1}),e(D,{cols:"6",sm:"4",md:"3",lg:"3"},{default:l(()=>[e(de,{label:U(x).formLabelPriceType,variant:"outlined",modelValue:a.value.Type,"onUpdate:modelValue":u[4]||(u[4]=t=>a.value.Type=t),items:m,"item-value":"value","item-title":"title"},null,8,["label","modelValue"])]),_:1}),e(D,{cols:"6",sm:"4",md:"1",class:"text-right"},{default:l(()=>[e(N,{color:"red",icon:"mdi:mdi-minus",onClick:i})]),_:1})]),_:1}))}}),Rl=k("strong",null,"Capacity:",-1),Al=k("thead",null,[k("tr",null,[k("th",null,"Date"),k("th",null,"Price"),k("th",null,"Availability")])],-1),Sl={class:"d-flex flex-wrap justify-space-between",style:{gap:"1rem"}},Pl=k("h4",null," Availability & Costs (To Organisation) ",-1),xl=O({__name:"VenueRoom",props:{modelValue:{required:!0}},emits:P(["deleted"],["update:modelValue"]),setup(T,{emit:s}){const a=Y(),m=C(x),i=M(T,"modelValue"),n=C(G(i.value)),u=C(!1),t=p=>{switch(p.Type){case ge.PER_PERSON:return m.value.enumPER_PERSON;case ge.PER_ROOM:return m.value.enumPER_ROOM}return"Unknown"},o=()=>{n.value.Costs||(n.value.Costs=[]),n.value.Costs.push({ID:0,CostUUID:q(),Availability:0,DateStart:"",DateEnd:"",Price:0,Type:"PER_ROOM"})},v=p=>{n.value.Costs.splice(p,1)},r=({callback:p})=>{const f=()=>{p&&p("Failed to Delete Room")},V=()=>{p&&p("Room Deleted")};a.deleteRoom(n.value.RoomUUID).then(I=>{I?(V(),s("deleted",n.value)):f()}).catch(()=>{f()})},d=()=>{a.saveRoom(n.value).then(()=>{i.value=n.value,u.value=!1})};return(p,f)=>(c(),b($,null,[e(j,{fluid:"",class:"pa-1 pa-sm-2"},{default:l(()=>[k("h4",null,S(n.value.Name),1),k("p",null,S(n.value.Notes),1),k("p",null,[Rl,g(" "+S(n.value.MinimumCapacity)+" ",1),n.value.MinimumCapacity!=n.value.MaximumCapacity?(c(),b($,{key:0},[g(" - "+S(n.value.MaximumCapacity),1)],64)):R("",!0)]),e(el,{density:"compact"},{default:l(()=>[Al,k("tbody",null,[(c(!0),b($,null,K(n.value.Costs,V=>(c(),b("tr",{key:`venue-room-${n.value.ID}-cost-${V.ID}`},[k("td",null,S(V.DateStart)+" - "+S(V.DateEnd),1),k("td",null,S(m.value.currencySymbol)+S(V.Price)+" "+S(t(V)),1),k("td",null,S(V.Availability),1)]))),128))])]),_:1}),k("div",Sl,[e(N,{color:"primary","prepend-icon":"mdi:mdi-playlist-edit",onClick:f[0]||(f[0]=V=>u.value=!0)},{default:l(()=>[g("Edit Room")]),_:1}),e(Q,{color:"red-darken-3","prepend-icon":"mdi:mdi-minus",onClick:r},{default:l(()=>[g("Delete Room")]),_:1})])]),_:1}),e(Te,{scrollable:"",modelValue:u.value,"onUpdate:modelValue":f[6]||(f[6]=V=>u.value=V),width:"auto"},{default:l(()=>[e(pe,null,{default:l(()=>[e(ne,{dark:"",color:"primary"},{default:l(()=>[e(N,{icon:"",dark:"",onClick:f[1]||(f[1]=V=>u.value=!1)},{default:l(()=>[e(z,null,{default:l(()=>[g("mdi:mdi-close")]),_:1})]),_:1}),e(ie,null,{default:l(()=>[g("Room Details ("+S(n.value.Name)+")",1)]),_:1}),e(ae),e(Ue,null,{default:l(()=>[e(N,{variant:"text",onClick:d},{default:l(()=>[g(" Save ")]),_:1})]),_:1})]),_:1}),e(Ve,null,{default:l(()=>[e(te,null,{default:l(()=>[e(F,null,{default:l(()=>[e(D,{cols:"12"},{default:l(()=>[e(A,{label:m.value.formLabelName,type:"text",variant:"outlined",modelValue:n.value.Name,"onUpdate:modelValue":f[2]||(f[2]=V=>n.value.Name=V)},null,8,["label","modelValue"])]),_:1})]),_:1}),e(F,null,{default:l(()=>[e(D,null,{default:l(()=>[e(De,{label:m.value.formLabelNotes,variant:"outlined",modelValue:n.value.Notes,"onUpdate:modelValue":f[3]||(f[3]=V=>n.value.Notes=V)},null,8,["label","modelValue"])]),_:1})]),_:1}),e(F,null,{default:l(()=>[e(D,{cols:"12",sm:"6"},{default:l(()=>[e(A,{type:"number",label:m.value.formLabelMinimumCapacity,variant:"outlined",modelValue:n.value.MinimumCapacity,"onUpdate:modelValue":f[4]||(f[4]=V=>n.value.MinimumCapacity=V),modelModifiers:{number:!0}},null,8,["label","modelValue"])]),_:1}),e(D,{cols:"12",sm:"6"},{default:l(()=>[e(A,{type:"number",label:m.value.formLabelMaximumCapacity,variant:"outlined",modelValue:n.value.MaximumCapacity,"onUpdate:modelValue":f[5]||(f[5]=V=>n.value.MaximumCapacity=V),modelModifiers:{number:!0}},null,8,["label","modelValue"])]),_:1})]),_:1}),e(F,null,{default:l(()=>[e(D,null,{default:l(()=>[Pl]),_:1})]),_:1}),(c(!0),b($,null,K(n.value.Costs,(V,I)=>(c(),b($,{key:`venue-room-${n.value.ID}-cost-${V.ID}`},[n.value.Costs&&n.value.Costs[I]?(c(),y(Fl,{key:0,modelValue:n.value.Costs[I],"onUpdate:modelValue":_=>n.value.Costs[I]=_,onDeleted:_=>v(I)},null,8,["modelValue","onUpdate:modelValue","onDeleted"])):R("",!0)],64))),128)),e(N,{color:"primary","prepend-icon":"mdi:mdi-plus",onClick:o},{default:l(()=>[g("Add Row")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}}),Ol=k("h3",null,"Rooms",-1),ql=O({__name:"Venue",props:{modelValue:{required:!0}},emits:P(["deleted"],["update:modelValue"]),setup(T,{emit:s}){const a=Y(),m=M(T,"modelValue"),i=C(G(m.value)),n=C([]),u=C(!1),t=C(!1);a.getVenueRooms(i.value.VenueUUID).then(p=>{n.value=p}),H(i.value,()=>{t.value=!0});const o=({callback:p})=>{u.value=!0,a.saveVenue(i.value).then(()=>{u.value=!1,t.value=!1,m.value=i.value,p&&p("Venue Saved")}).catch(()=>{u.value=!1,p&&p("Failed to Saved Venue")})},v=({callback:p})=>{u.value=!0,a.deleteVenue(i.value.VenueUUID).then(f=>{u.value=!1,f?p&&(p("Venue Deleted"),s("deleted")):p&&p("Failed to Delete Venue")}).catch(()=>{p&&(p("Failed to Delete Venue"),u.value=!1)})},r=()=>{const p={ID:0,RoomUUID:q(),VenueID:i.value.ID,VenueUUID:i.value.VenueUUID,Order:n.value.length+1,Name:"New Room",Notes:"",MaximumCapacity:1,MinimumCapacity:1,Costs:[]};a.saveRoom(p).then(f=>{f&&n.value.push(f)})},d=(p,f)=>{a.deleteRoom(n.value[f].RoomUUID).then(V=>{V&&n.value.splice(f,1)})};return(p,f)=>(c(),y(me,null,{default:l(()=>[e(ve,null,{default:l(()=>[g(S(i.value.Name),1)]),_:1}),e(ce,null,{default:l(()=>[e(F,{"no-gutters":""},{default:l(()=>[e(D,{cols:"12"},{default:l(()=>[e(A,{label:U(x).formLabelName,name:"name",variant:"outlined",modelValue:i.value.Name,"onUpdate:modelValue":f[0]||(f[0]=V=>i.value.Name=V)},null,8,["label","modelValue"])]),_:1}),e(D,{cols:"12"},{default:l(()=>[e(De,{label:U(x).formLabelDescription,name:"description",variant:"outlined",modelValue:i.value.Description,"onUpdate:modelValue":f[1]||(f[1]=V=>i.value.Description=V)},null,8,["label","modelValue"])]),_:1}),e(D,{class:"text-right",cols:"12"},{default:l(()=>[e(Q,{class:"mr-2",color:"red-darken-3",label:"Delete",onClick:v}),e(Q,{enabled:t.value,timeout:"7",onClick:o},null,8,["enabled"])]),_:1})]),_:1}),Ol,(c(!0),b($,null,K(n.value,(V,I)=>(c(),y(te,{variant:"elevation",elevation:"6",key:`venue-room-${V.ID}`},{default:l(()=>[n.value&&n.value[I]?(c(),y(xl,{key:0,modelValue:n.value[I],"onUpdate:modelValue":_=>n.value[I]=_,onDeleted:_=>d(_,I)},null,8,["modelValue","onUpdate:modelValue","onDeleted"])):R("",!0)]),_:2},1024))),128)),e(te,{class:"ma-2"},{default:l(()=>[e(N,{color:"primary","prepend-icon":"mdi:mdi-plus",onClick:r},{default:l(()=>[g("Add Room")]),_:1})]),_:1})]),_:1})]),_:1}))}}),wl=k("h3",null,"Venues",-1),Ml=k("p",null," Venues and the rooms they supply to the organisation, this is internal data not seen by attendees. ",-1),Ll=k("p",null," Attendee options are configured via the accommodation tab. ",-1),Kl=O({__name:"VenuesEditorView",props:{modelValue:{required:!0}},emits:P(["close","pageTitle","refresh"],["update:modelValue"]),setup(T,{emit:s}){const a=Y(),m=M(T,"modelValue");s("pageTitle","Venues");const i=C([]);a.getConventionVenues(m.value.ConventionUUID).then(t=>{i.value=t});const n=()=>{const t={ID:0,VenueUUID:q(),ConventionID:m.value.ID,ConventionUUID:m.value.ConventionUUID,Order:i.value.length+1,Name:"New Venue",Description:"",Rooms:[]};a.saveVenue(t).then(o=>{o&&i.value.push(o)})},u=t=>{i.value.splice(t,1)};return(t,o)=>(c(),b($,null,[e(j,{fluid:"",class:"px-0"},{default:l(()=>[e(F,null,{default:l(()=>[e(D,null,{default:l(()=>[wl]),_:1})]),_:1})]),_:1}),Ml,Ll,e(te,null,{default:l(()=>[e(re,{variant:"accordion"},{default:l(()=>[(c(!0),b($,null,K(i.value,(v,r)=>(c(),y(ql,{key:`venues-${v.ID}`,modelValue:i.value[r],"onUpdate:modelValue":d=>i.value[r]=d,onDeleted:d=>u(r)},null,8,["modelValue","onUpdate:modelValue","onDeleted"]))),128))]),_:1}),e(te,{class:"pa-2"},{default:l(()=>[e(N,{color:"primary",onClick:n},{default:l(()=>[g("Add Venue")]),_:1})]),_:1})]),_:1})],64))}}),Yl=k("p",{title:"Automatically calculated",class:"text-grey-lighten-1"},"Applicable Tickets:",-1),Gl=O({__name:"AccommodationCost",props:P({convention:{}},{modelValue:{required:!0}}),emits:P(["deleted"],["update:modelValue"]),setup(T,{emit:s}){const a=M(T,"modelValue"),m=C([]);Y().getConventionTickets(T.convention.ConventionUUID).then(o=>{o&&(m.value=o)});const n=[{title:"Per Room",value:"PER_ROOM"},{title:"Per Person",value:"PER_PERSON"}],u=()=>{s("deleted")},t=ee(()=>m.value.filter(o=>(o.Type===w.TICKET_TYPE_TICKET||o.Type===w.TICKET_TYPE_ADD_ON)&&o.RequiresAccommodation&&o.DateStart===a.value.DateStart&&o.DateEnd===a.value.DateEnd));return(o,v)=>(c(),b($,null,[e(F,{class:"align-center",dense:""},{default:l(()=>[e(D,{class:"flex-grow-0 flex-shrink-1 text-no-wrap font-italic"},{default:l(()=>[Yl]),_:1}),e(D,{class:"flex-grow-1"},{default:l(()=>[e(Me,null,{default:l(()=>[(c(!0),b($,null,K(t.value,r=>(c(),y(Le,{key:r.ID,title:"Automatically calculated",disabled:""},{default:l(()=>[g(S(r.Name),1)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1}),e(F,{dense:""},{default:l(()=>[e(D,{cols:"12",sm:"6",md:"3"},{default:l(()=>[e(A,{label:U(x).formLabelDateStart,type:"date",variant:"outlined",modelValue:a.value.DateStart,"onUpdate:modelValue":v[0]||(v[0]=r=>a.value.DateStart=r)},null,8,["label","modelValue"])]),_:1}),e(D,{cols:"12",sm:"6",md:"3"},{default:l(()=>[e(A,{label:U(x).formLabelDateEnd,type:"date",variant:"outlined",modelValue:a.value.DateEnd,"onUpdate:modelValue":v[1]||(v[1]=r=>a.value.DateEnd=r)},null,8,["label","modelValue"])]),_:1}),e(D,{cols:"5",sm:"6",md:"3"},{default:l(()=>[e(A,{label:U(x).formLabelPrice,type:"number","prepend-inner-icon":"mdi:mdi-currency-gbp",variant:"outlined",modelValue:a.value.Price,"onUpdate:modelValue":v[2]||(v[2]=r=>a.value.Price=r),modelModifiers:{number:!0}},null,8,["label","modelValue"])]),_:1}),e(D,{cols:"5",sm:"4",md:"2"},{default:l(()=>[e(de,{label:U(x).formLabelPriceType,variant:"outlined",modelValue:a.value.Type,"onUpdate:modelValue":v[3]||(v[3]=r=>a.value.Type=r),items:n,"item-value":"value","item-title":"title"},null,8,["label","modelValue"])]),_:1}),e(D,{cols:"2",sm:"2",md:"1",class:"text-right"},{default:l(()=>[e(N,{color:"red",icon:"mdi:mdi-minus",onClick:u})]),_:1})]),_:1})],64))}}),Bl=k("h4",null," Room Pool ",-1),jl=k("p",{class:"mb-4"}," Hotel rooms that can be used for this accommodation option. ",-1),zl=k("p",null," Pool total: ",-1),Hl=k("h4",null," Accommodation Costs ",-1),Jl=k("p",{class:"mb-4"}," How much the attendee is charged by the convention for the accommodation. ",-1),Xl=O({__name:"Accommodation",props:P({convention:{},venues:{}},{modelValue:{required:!0}}),emits:P(["deleted"],["update:modelValue"]),setup(T,{emit:s}){const a=Y(),m=M(T,"modelValue"),i=C(G(m.value)),n=ee(()=>T.venues.map(r=>r.Rooms.map(d=>({title:` ${r.Name} - ${d.Name}`,value:d}))).flat()),u=()=>{i.value.Costs||(i.value.Costs=[]),i.value.Costs.push({ID:0,CostUUID:q(),Availability:0,DateStart:"",DateEnd:"",Price:0,Type:ge.PER_ROOM})},t=r=>{i.value.Costs.splice(r,1)},o=({callback:r})=>{a.deleteAccommodation(i.value.AccommodationUUID).then(d=>{d?r&&(r("Accommodation Deleted"),s("deleted")):r&&r("Failed to Delete Accommodation")}).catch(()=>{r&&r("Failed to Delete Accommodation")})},v=({callback:r})=>{a.saveAccommodation(i.value).then(d=>{d?(i.value.ID=d.ID,m.value=d,r&&r("Accommodation Saved")):r&&r("Failed to Save Accommodation")}).catch(()=>{r&&r("Failed to Save Accommodation")})};return(r,d)=>(c(),y(me,null,{default:l(()=>[e(ve,null,{default:l(()=>[g(S(i.value.Name),1)]),_:1}),e(ce,null,{default:l(()=>[e(te,null,{default:l(()=>[e(F,null,{default:l(()=>[e(D,null,{default:l(()=>[e(A,{modelValue:i.value.Name,"onUpdate:modelValue":d[0]||(d[0]=p=>i.value.Name=p),label:"Name",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1})]),_:1}),e(F,null,{default:l(()=>[e(D,null,{default:l(()=>[Bl,jl,e(de,{clearable:!0,modelValue:i.value.Pool,"onUpdate:modelValue":d[1]||(d[1]=p=>i.value.Pool=p),items:n.value,label:"Select",multiple:"",hint:"Pick appropriate rooms","persistent-hint":"",variant:"outlined","item-title":"title","item-value":"value",eager:!0},null,8,["modelValue","items"]),zl,k("p",null,[e(le,{label:"Required Tags",variant:"outlined",modelValue:i.value.RequiredTags,"onUpdate:modelValue":d[2]||(d[2]=p=>i.value.RequiredTags=p),convention:r.convention,organisation:r.convention.OrganisationUUID,chips:!0,clearable:!0,hint:"Tags that a user must have to select this accommodation."},null,8,["modelValue","convention","organisation"])]),Hl,Jl,i.value.Costs?(c(!0),b($,{key:0},K(i.value.Costs,(p,f)=>(c(),y(Gl,{key:`venue-room-${i.value.ID}-cost-${p.ID}`,convention:r.convention,modelValue:i.value.Costs[f],"onUpdate:modelValue":V=>i.value.Costs[f]=V,onDeleted:V=>t(f)},null,8,["convention","modelValue","onUpdate:modelValue","onDeleted"]))),128)):R("",!0)]),_:1})]),_:1}),e(F,{"no-gutters":""},{default:l(()=>[e(D,{class:"text-left"},{default:l(()=>[e(N,{color:"primary","prepend-icon":"mdi:mdi-plus",onClick:u},{default:l(()=>[g("Add Row")]),_:1})]),_:1}),e(D,{class:"text-right"},{default:l(()=>[e(Q,{class:"mr-2",color:"red-darken-3",label:"Delete",onClick:o}),e(Q,{onClick:v})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}))}}),Wl=k("h3",null,"Accommodation",-1),Ql=k("p",null," Accommodation options presented to attendees, these are effectively virtual room types which are linked to the available room pools created in the venues tab. ",-1),Zl=k("p",null," Use the venues tab to configure internal data about the venues and room supply. ",-1),et=O({__name:"AccommodationEditorView",props:{modelValue:{required:!0}},emits:["update:modelValue"],setup(T){const s=Y(),a=M(T,"modelValue"),m=C([]),i=C([]);s.getConventionAccommodation(a.value.ConventionUUID).then(t=>{t&&(m.value=t)}),s.getConventionVenues(a.value.ConventionUUID).then(t=>{t&&(i.value=t)});const n=()=>{const t={ID:0,AccommodationUUID:q(),ConventionID:a.value.ID,ConventionUUID:a.value.ConventionUUID,Order:m.value.length+1,Name:"New Accommodation Option",Pool:[],Costs:[],RequiredTags:[]};s.saveAccommodation(t).then(o=>{o&&m.value.push(o)})},u=t=>{m.value.splice(t,1)};return(t,o)=>(c(),b($,null,[e(j,{fluid:!0,class:"px-0"},{default:l(()=>[e(F,null,{default:l(()=>[e(D,null,{default:l(()=>[Wl]),_:1})]),_:1})]),_:1}),Ql,Zl,e(te,null,{default:l(()=>[e(re,{variant:"accordion"},{default:l(()=>[(c(!0),b($,null,K(m.value,(v,r)=>(c(),y(Xl,{key:v.AccommodationUUID,convention:a.value,venues:i.value,modelValue:m.value[r],"onUpdate:modelValue":d=>m.value[r]=d,onDeleted:d=>u(r)},null,8,["convention","venues","modelValue","onUpdate:modelValue","onDeleted"]))),128))]),_:1}),e(te,{class:"pa-2"},{default:l(()=>[e(N,{color:"primary",onClick:n},{default:l(()=>[g("Add Accommodation")]),_:1})]),_:1})]),_:1})],64))}}),lt=O({__name:"EditFieldDialogExtras",props:{modelValue:{required:!0}},emits:["update:modelValue"],setup(T){const s=M(T,"modelValue"),a=be.getInstance(),m=C([]),i=C([]);return a==null||a.getConventionExtras(s.value.ConventionUUID).then(n=>{m.value=n;const u=s.value.Values.find(t=>t.Title==="SelectedExtras");if(u)try{i.value=JSON.parse(u.Value)}catch{}}),H(i,()=>{const n=s.value.Values.find(u=>u.Title==="SelectedExtras");if(n)n.Value=JSON.stringify(i.value);else{const u={ID:0,FieldValueUUID:q(),FieldID:s.value.ID,FieldUUID:s.value.FieldUUID,Title:"SelectedExtras",Value:JSON.stringify(i.value)};s.value.Values.push(u)}}),(n,u)=>(c(!0),b($,null,K(m.value,t=>(c(),y(X,{key:t.ExtraUUID,modelValue:i.value,"onUpdate:modelValue":u[0]||(u[0]=o=>i.value=o),label:t.Name,value:t.ExtraUUID,name:s.value.Name,"hide-details":""},null,8,["modelValue","label","value","name"]))),128))}}),tt=O({__name:"EditFieldDialogInterests",props:{modelValue:{required:!0}},emits:["update:modelValue"],setup(T){const s=M(T,"modelValue"),a=be.getInstance(),m=C([]),i=C([]);return a==null||a.getConventionInterests(s.value.ConventionUUID).then(n=>{m.value=n;const u=s.value.Values.find(t=>t.Title==="SelectedInterests");if(u)try{i.value=JSON.parse(u.Value)}catch{}}),H(i,()=>{const n=s.value.Values.find(u=>u.Title==="SelectedInterests");if(n)n.Value=JSON.stringify(i.value);else{const u={ID:0,FieldValueUUID:q(),FieldID:s.value.ID,FieldUUID:s.value.FieldUUID,Title:"SelectedInterests",Value:JSON.stringify(i.value)};s.value.Values.push(u)}}),(n,u)=>(c(!0),b($,null,K(m.value,t=>(c(),y(X,{key:t.InterestUUID,modelValue:i.value,"onUpdate:modelValue":u[0]||(u[0]=o=>i.value=o),label:t.Name,value:t.InterestUUID,name:s.value.Name,"hide-details":""},null,8,["modelValue","label","value","name"]))),128))}}),at=O({__name:"EditFieldDialogTickets",props:{modelValue:{required:!0}},emits:["update:modelValue"],setup(T){const s=M(T,"modelValue"),a=be.getInstance(),m=C([]),i=C([]);return a==null||a.getConventionTickets(s.value.ConventionUUID).then(n=>{m.value=n;const u=s.value.Values.find(t=>t.Title==="SelectedTickets");if(u)try{i.value=JSON.parse(u.Value)}catch{}}),H(i,()=>{const n=s.value.Values.find(u=>u.Title==="SelectedTickets");if(n)n.Value=JSON.stringify(i.value);else{const u={ID:0,FieldValueUUID:q(),FieldID:s.value.ID,FieldUUID:s.value.FieldUUID,Title:"SelectedTickets",Value:JSON.stringify(i.value)};s.value.Values.push(u)}}),(n,u)=>(c(!0),b($,null,K(m.value.filter(t=>t&&t.Type===U(w).TICKET_TYPE_GROUP),t=>(c(),y(X,{key:t.TicketUUID,modelValue:i.value,"onUpdate:modelValue":u[0]||(u[0]=o=>i.value=o),label:t.Name,value:t.TicketUUID,name:s.value.Name,"hide-details":""},null,8,["modelValue","label","value","name"]))),128))}}),ot=k("h5",null,"Display Options",-1),nt=k("h5",null,"Accommodation Choices",-1),ut=O({__name:"EditFieldDialogAccommodation",props:{modelValue:{required:!0}},emits:["update:modelValue"],setup(T){const s=M(T,"modelValue"),a=be.getInstance(),m=C([]),i=C(s.value.Values.map(t=>t.Value)),n=C({sharing:!1});try{const t=JSON.parse(s.value.Data);t&&(n.value=t)}catch{}const u=()=>{s.value.Data=JSON.stringify(n.value),s.value.Values=i.value.map(t=>{var o,v,r;return{ID:0,FieldValueUUID:q(),FieldID:((o=s.value)==null?void 0:o.ID)||0,FieldUUID:((v=s.value)==null?void 0:v.FieldUUID)||"",Title:((r=m.value.find(d=>d.AccommodationUUID==t))==null?void 0:r.Name)||"",Value:t}})};return a==null||a.getConventionAccommodation(s.value.ConventionUUID).then(t=>{t&&(m.value=t)}),(t,o)=>(c(),b($,null,[ot,e(X,{label:"Show Sharing Options",modelValue:n.value.sharing,"onUpdate:modelValue":o[0]||(o[0]=v=>n.value.sharing=v),"hide-details":"",onChange:u},null,8,["modelValue"]),nt,(c(!0),b($,null,K(m.value,v=>(c(),y(X,{key:v.ID,modelValue:i.value,"onUpdate:modelValue":o[1]||(o[1]=r=>i.value=r),label:v.Name,value:v.AccommodationUUID,"hide-details":"",onChange:u},null,8,["modelValue","label","value"]))),128))],64))}}),it=O({__name:"EditFieldDialogAge",props:P({convention:{}},{modelValue:{required:!0}}),emits:["update:modelValue"],setup(T){var r,d,p;const s=M(T,"modelValue"),a=new Date,m=a.getFullYear(),i=(a.getMonth()+1).toLocaleString(navigator.language,{minimumIntegerDigits:2}),n=a.getDate().toLocaleString(navigator.language,{minimumIntegerDigits:2}),u=C(parseInt(((r=s.value.Values.find(f=>f.Title==="MIN_AGE"))==null?void 0:r.Value)||"18")),t=C(((d=s.value.Values.find(f=>f.Title==="BEFORE_DATE"))==null?void 0:d.Value)||`${m}-${i}-${n}`),o=C(((p=s.value.Values.find(f=>f.Title==="UNDER_AGE_APPLY_TAG"))==null?void 0:p.Value)||""),v=()=>{var f,V,I,_,E,h;s.value.Values=[{ID:0,FieldValueUUID:q(),FieldID:((f=s.value)==null?void 0:f.ID)||0,FieldUUID:((V=s.value)==null?void 0:V.FieldUUID)||"",Title:"MIN_AGE",Value:u.value.toString()},{ID:0,FieldValueUUID:q(),FieldID:((I=s.value)==null?void 0:I.ID)||0,FieldUUID:((_=s.value)==null?void 0:_.FieldUUID)||"",Title:"BEFORE_DATE",Value:t.value},{ID:0,FieldValueUUID:q(),FieldID:((E=s.value)==null?void 0:E.ID)||0,FieldUUID:((h=s.value)==null?void 0:h.FieldUUID)||"",Title:"UNDER_AGE_APPLY_TAG",Value:o.value}]};return v(),(f,V)=>(c(),y(j,{class:"pl-0 pr-0",fluid:!0},{default:l(()=>[e(F,null,{default:l(()=>[e(D,{cols:"12",sm:"6"},{default:l(()=>[e(A,{modelValue:u.value,"onUpdate:modelValue":V[0]||(V[0]=I=>u.value=I),modelModifiers:{number:!0},type:"number",label:"Minimum Age",variant:"outlined",onChange:v},null,8,["modelValue"])]),_:1}),e(D,{cols:"12",sm:"6"},{default:l(()=>[e(A,{modelValue:t.value,"onUpdate:modelValue":V[1]||(V[1]=I=>t.value=I),type:"date",label:"Date to attain minimum age by",variant:"outlined",onChange:v},null,8,["modelValue"])]),_:1})]),_:1}),e(F,null,{default:l(()=>[e(D,null,{default:l(()=>[e(le,{modelValue:o.value,"onUpdate:modelValue":V[2]||(V[2]=I=>o.value=I),convention:f.convention,chips:!0,clearable:!0,variant:"outlined",label:`Tags applied to users under ${u.value} at time of data entry`,onChange:v},null,8,["modelValue","convention","label"])]),_:1})]),_:1})]),_:1}))}}),dt=k("h4",null,"Values",-1),st=k("h4",null,"Accommodation",-1),rt=k("h4",null,"Age",-1),mt=k("h4",null,"Additional Purchases",-1),vt=k("h4",null,"Available Interests",-1),ct=k("h4",null,"Tickets",-1),pt=k("h4",{class:"mb-3"},"Field Preview",-1),ft=O({__name:"EditFieldDialog",props:P({convention:{},field:{},title:{}},{modelValue:{type:Boolean,required:!0}}),emits:P(["update:field"],["update:modelValue"]),setup(T,{emit:s}){const a=T,{convention:m,title:i=""}=a,n=M(T,"modelValue"),u=fe(a,s,void 0,void 0,"field"),t=C(G(u.value)),o=C(""),v=C(t.value.Type);H(u,()=>{t.value=G(u.value)});const r=()=>{n.value=!1},d=()=>{t.value=G(u.value)},p=()=>{u.value=t.value},f=()=>{t.value.Values.push({ID:0,FieldValueUUID:q(),FieldID:t.value.ID,FieldUUID:t.value.FieldUUID,Title:"",Value:""})},V=_=>{t.value.Values.splice(_,1)},I=()=>{o.value="",t.value.Values=[]};return H(v,(_,E)=>{_!==E&&(t.value.Type=_,I())}),(_,E)=>(c(),y(Re,{modelValue:n.value,"onUpdate:modelValue":E[13]||(E[13]=h=>n.value=h),onReset:d,onSave:p,title:U(i),color:"primary",persistent:!0,fullscreen:!0},{default:l(()=>[e(j,{class:"pa-0",fluid:!0},{default:l(()=>[e(F,null,{default:l(()=>[e(D,{cols:"12"},{default:l(()=>[e(j,{class:"pa-0",fluid:!0},{default:l(()=>[e(F,null,{default:l(()=>[e(D,{cols:"12",sm:"6",md:"4"},{default:l(()=>[e(A,{modelValue:t.value.Name,"onUpdate:modelValue":E[0]||(E[0]=h=>t.value.Name=h),label:"Internal name",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),e(D,{cols:"12",sm:"6",md:"4"},{default:l(()=>[e(A,{modelValue:t.value.Label,"onUpdate:modelValue":E[1]||(E[1]=h=>t.value.Label=h),label:"Label",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),e(D,{cols:"12",sm:"6",md:"4"},{default:l(()=>[e(A,{modelValue:t.value.Hint,"onUpdate:modelValue":E[2]||(E[2]=h=>t.value.Hint=h),label:"Hint",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),e(D,{cols:"12",sm:"6",md:"4"},{default:l(()=>[e(A,{modelValue:t.value.Placeholder,"onUpdate:modelValue":E[3]||(E[3]=h=>t.value.Placeholder=h),label:"Placeholder",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),e(D,{cols:"12",sm:"6",md:"4"},{default:l(()=>[e(de,{modelValue:v.value,"onUpdate:modelValue":E[4]||(E[4]=h=>v.value=h),label:"Type",variant:"outlined",items:U(Pe),"hide-details":""},null,8,["modelValue","items"])]),_:1}),t.value.Type===U(J).SELECT||t.value.Type===U(J).CHECKBOX?(c(),y(D,{key:0,cols:"12",sm:"6",md:"4",class:"py-0"},{default:l(()=>[e(X,{modelValue:t.value.Multiple,"onUpdate:modelValue":E[5]||(E[5]=h=>t.value.Multiple=h),label:"Multiple Items",hint:"Can select multiple items from list","hide-details":"",density:"compact"},null,8,["modelValue"]),t.value.Type===U(J).SELECT?(c(),y(X,{key:0,modelValue:t.value.Autofill,"onUpdate:modelValue":E[6]||(E[6]=h=>t.value.Autofill=h),label:"Searchable List","hide-details":"",density:"compact"},null,8,["modelValue"])):R("",!0)]),_:1})):R("",!0)]),_:1}),t.value.Type===U(J).SELECT||t.value.Type===U(J).CHECKBOX&&t.value.Multiple||t.value.Type===U(J).RADIO?(c(),y(F,{key:0},{default:l(()=>[e(D,null,{default:l(()=>[dt,e(j,{fluid:!0,class:"px-0"},{default:l(()=>[(c(!0),b($,null,K(t.value.Values,(h,L)=>(c(),y(F,{key:h.ID},{default:l(()=>[e(D,{cols:"12",sm:"5",md:"6"},{default:l(()=>[e(A,{modelValue:h.Title,"onUpdate:modelValue":B=>h.Title=B,label:"Display",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(D,{cols:"9",sm:"5",md:"5"},{default:l(()=>[e(A,{modelValue:h.Value,"onUpdate:modelValue":B=>h.Value=B,label:"Internal Value",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(D,{cols:"3",sm:"2",md:"1",class:"d-flex align-center"},{default:l(()=>[e(N,{icon:"mdi:mdi-window-close",size:"small",color:"red",onClick:B=>V(L)},null,8,["onClick"])]),_:2},1024)]),_:2},1024))),128)),e(F,null,{default:l(()=>[e(D,null,{default:l(()=>[e(N,{"prepend-icon":"mdi:mdi-plus",color:"primary",onClick:f},{default:l(()=>[g("Add Item")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})):t.value.Type===U(J).ACCOMMODATION?(c(),y(F,{key:1},{default:l(()=>[e(D,null,{default:l(()=>[st,e(ut,{modelValue:t.value,"onUpdate:modelValue":E[7]||(E[7]=h=>t.value=h)},null,8,["modelValue"])]),_:1})]),_:1})):t.value.Type===U(J).AGE?(c(),y(F,{key:2},{default:l(()=>[e(D,null,{default:l(()=>[rt,e(it,{modelValue:t.value,"onUpdate:modelValue":E[8]||(E[8]=h=>t.value=h),convention:U(m)},null,8,["modelValue","convention"])]),_:1})]),_:1})):t.value.Type===U(J).EXTRAS?(c(),y(F,{key:3},{default:l(()=>[e(D,null,{default:l(()=>[mt,e(lt,{modelValue:t.value,"onUpdate:modelValue":E[9]||(E[9]=h=>t.value=h)},null,8,["modelValue"])]),_:1})]),_:1})):t.value.Type===U(J).INTERESTS?(c(),y(F,{key:4},{default:l(()=>[e(D,null,{default:l(()=>[vt,e(tt,{modelValue:t.value,"onUpdate:modelValue":E[10]||(E[10]=h=>t.value=h)},null,8,["modelValue"])]),_:1})]),_:1})):t.value.Type===U(J).TICKET?(c(),y(F,{key:5},{default:l(()=>[e(D,null,{default:l(()=>[ct,e(at,{modelValue:t.value,"onUpdate:modelValue":E[11]||(E[11]=h=>t.value=h)},null,8,["modelValue"])]),_:1})]),_:1})):R("",!0)]),_:1})]),_:1}),e(D,{cols:"12"},{default:l(()=>[e(te,{elevation:"5",class:"pa-2",color:"text-center"},{default:l(()=>[pt,e(xe,{admin:!0,field:t.value,convention:U(m),modelValue:o.value,"onUpdate:modelValue":E[12]||(E[12]=h=>o.value=h)},null,8,["field","convention","modelValue"])]),_:1})]),_:1})]),_:1})]),_:1})]),actions:l(()=>[e(N,{color:"blue-darken-1",variant:"text",onClick:r},{default:l(()=>[g(" Cancel ")]),_:1}),e(N,{color:"blue-darken-1",variant:"text",onClick:d},{default:l(()=>[g(" Reset ")]),_:1}),e(ae),e(N,{color:"blue-darken-1",variant:"text",onClick:p},{default:l(()=>[g(" Save ")]),_:1})]),_:1},8,["modelValue","title"]))}}),Vt=O({__name:"FieldEditor",props:{modelValue:{required:!0}},emits:P(["refresh"],["update:modelValue"]),setup(T){const s=M(T,"modelValue"),a=Y(),m=C(!1),i=C(!1),n=C([{key:"Label",title:"Label",align:"start",sortable:!0},{key:"Name",title:"Internal Name",align:"start",sortable:!0},{key:"Type",title:"Type",align:"start",sortable:!0},{key:"actions",title:"Actions",sortable:!1}]),u=C([]);a.getConventionFields(s.value.ConventionUUID).then(L=>{L&&(u.value=L)});const t=C(-1),o=C({ID:0,FieldUUID:q(),ConventionID:s.value.ID,ConventionUUID:s.value.ConventionUUID,Autofill:!1,Hint:"",Label:"",Multiple:!1,Name:"",Placeholder:"",Type:"TEXT",Values:[],Data:""}),v=ee(()=>t.value===-1?"New Field":"Edit Field"),r=()=>({ID:0,FieldUUID:q(),ConventionID:s.value.ID,ConventionUUID:s.value.ConventionUUID,Autofill:!1,Hint:"",Label:"",Multiple:!1,Name:"",Placeholder:"",Type:"TEXT",Values:[],Data:""}),d=C(r()),p=()=>{d.value.FieldUUID=q(),o.value=Object.assign({},r()),t.value=-1,m.value=!0},f=L=>{t.value=u.value.indexOf(L),o.value=Object.assign({},L),m.value=!0},V=L=>{t.value=u.value.indexOf(L),o.value=Object.assign({},L),i.value=!0},I=()=>{a.deleteField(o.value.FieldUUID).then(L=>{L&&(u.value.splice(t.value,1),E())})},_=()=>{m.value=!1,ye(()=>{o.value=Object.assign({},d.value),t.value=-1})},E=()=>{i.value=!1,ye(()=>{o.value=Object.assign({},d.value),t.value=-1})},h=()=>{a.saveField(o.value).then(L=>{L&&(t.value>-1?Object.assign(u.value[t.value],L):u.value.push(L),_())})};return(L,B)=>(c(),y(U(qe),{headers:n.value,items:u.value,"sort-by":[{key:"calories",order:"asc"}],class:"elevation-1"},{top:l(()=>[e(ne,{color:"primary"},{default:l(()=>[e(ie,null,{default:l(()=>[g("Field Editor")]),_:1}),e(Ye,{class:"mx-4",inset:!0,vertical:!0}),e(ae),e(N,{dark:"",class:"mb-2","prepend-icon":"mdi:mdi-pencil",onClick:p},{default:l(()=>[g(" New Item ")]),_:1}),e(Ke,{modelValue:i.value,"onUpdate:modelValue":B[0]||(B[0]=W=>i.value=W),onDelete:I},null,8,["modelValue"])]),_:1}),m.value?(c(),y(ft,{key:0,modelValue:m.value,"onUpdate:modelValue":B[1]||(B[1]=W=>m.value=W),field:o.value,"onUpdate:field":[B[2]||(B[2]=W=>o.value=W),h],title:v.value,convention:s.value},null,8,["modelValue","field","title","convention"])):R("",!0)]),"item.actions":l(({item:W})=>[e(z,{size:"small",class:"me-2",onClick:Ge=>f(W.raw)},{default:l(()=>[g(" mdi:mdi-pencil ")]),_:2},1032,["onClick"]),e(z,{size:"small",onClick:Ge=>V(W.raw)},{default:l(()=>[g(" mdi:mdi-delete ")]),_:2},1032,["onClick"])]),_:1},8,["headers","items"]))}}),Ut=(T,s)=>{const a=fe(T,s),m=fe(T,s,void 0,void 0,"item"),i=C(G(m.value));return H(m,()=>{i.value=G(m.value)}),{state:a,model:m,close:()=>{a.value=!1},reset:()=>{m.value=G(i.value)},save:()=>{s("save")}}},Tt=O({__name:"EditItemDialog",props:{item:{},modelValue:{type:Boolean},title:{},cardClass:{}},emits:["update:modelValue","update:item","save"],setup(T,{emit:s}){const a=T,{state:m,model:i,close:n,reset:u,save:t}=Ut(a,s);return(o,v)=>(c(),y(Re,{modelValue:U(m),"onUpdate:modelValue":v[0]||(v[0]=r=>_e(m)?m.value=r:null),onReset:U(u),onSave:U(t),title:o.title,color:"primary","card-class":o.cardClass,fullscreen:!0,persistent:!0},{toolbarButtons:l(()=>[he(o.$slots,"toolbarButtons")]),actions:l(()=>[e(N,{color:"blue-darken-1",variant:"text",onClick:U(n)},{default:l(()=>[g(" Cancel ")]),_:1},8,["onClick"]),e(N,{color:"blue-darken-1",variant:"text",onClick:U(u)},{default:l(()=>[g(" Reset ")]),_:1},8,["onClick"]),e(ae),e(N,{color:"blue-darken-1",variant:"text",onClick:U(t)},{default:l(()=>[g(" Save ")]),_:1},8,["onClick"])]),default:l(()=>[he(o.$slots,"default")]),_:3},8,["modelValue","onReset","onSave","title","card-class"]))}}),Dt={class:"pa-0 border-0 ma-0"},It=k("legend",{class:"mb-2"},"Field Settings",-1),_t={class:"pa-0 border-0 ma-0"},yt=k("legend",{class:"text-blue-accent-2 mb-2"},"Field Preview",-1),Ct=O({__name:"EditFormField",props:P({convention:{}},{modelValue:{required:!0}}),emits:["update:modelValue"],setup(T){const s=M(T,"modelValue"),a=Y(),m=C([]),i=C([]),n=C(""),u=t=>{var o;s.value.Field=(o=i.value.find(v=>v.value===t))==null?void 0:o.field};return a.getConventionFields(T.convention.ConventionUUID).then(t=>{t&&(m.value=t,i.value=t.map(o=>({title:`${o.Label} (${(Pe.find(v=>v.value===o.Type)||{title:""}).title})`,value:o.FieldUUID,field:o})),u(s.value.FieldUUID))}),(t,o)=>(c(),y(F,null,{default:l(()=>[e(D,{cols:"12",md:"6"},{default:l(()=>[k("fieldset",Dt,[It,e(F,null,{default:l(()=>[e(D,{cols:"12"},{default:l(()=>[e(de,{modelValue:s.value.FieldUUID,"onUpdate:modelValue":[o[0]||(o[0]=v=>s.value.FieldUUID=v),u],items:i.value,"item-title":"title","item-value":"value",label:"Field",variant:"outlined","hide-details":""},null,8,["modelValue","items"])]),_:1}),e(D,{cols:"6",sm:"4"},{default:l(()=>[e(A,{modelValue:s.value.MinLength,"onUpdate:modelValue":o[1]||(o[1]=v=>s.value.MinLength=v),modelModifiers:{number:!0},label:"Min Length",type:"number",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),e(D,{cols:"6",sm:"4"},{default:l(()=>[e(A,{modelValue:s.value.MaxLength,"onUpdate:modelValue":o[2]||(o[2]=v=>s.value.MaxLength=v),modelModifiers:{number:!0},label:"Max Length",type:"number",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),e(D,{cols:"12",sm:"4"},{default:l(()=>[e(X,{modelValue:s.value.Required,"onUpdate:modelValue":o[3]||(o[3]=v=>s.value.Required=v),modelModifiers:{boolean:!0},label:"Required","hide-details":""},null,8,["modelValue"])]),_:1})]),_:1})])]),_:1}),s.value.FieldUUID&&s.value.Field?(c(),y(D,{key:0,cols:"12",md:"6"},{default:l(()=>[k("fieldset",_t,[yt,s.value.Field?(c(),y(xe,{key:0,admin:!0,field:s.value.Field,"persistent-hint":!0,required:s.value.Required,convention:t.convention,modelValue:n.value,"onUpdate:modelValue":o[4]||(o[4]=v=>n.value=v)},null,8,["field","required","convention","modelValue"])):R("",!0)])]),_:1})):R("",!0)]),_:1}))}}),gt={class:"d-none d-sm-block"},bt=O({__name:"EditFormSectionFields",props:P({convention:{}},{modelValue:{required:!0}}),emits:["update:modelValue"],setup(T){const s=M(T,"modelValue"),a=()=>{var m;return{ID:0,SectionFieldUUID:q(),SectionID:s.value.ID,SectionUUID:s.value.SectionUUID,FieldID:0,FieldUUID:"",Order:(((m=s.value.Fields)==null?void 0:m.length)||0)+1,MinLength:0,MaxLength:0,Required:!1,Value:""}};return(m,i)=>s.value.Fields!==void 0?(c(),y(we,{key:0,modelValue:s.value.Fields,"onUpdate:modelValue":i[0]||(i[0]=n=>s.value.Fields=n),closeable:!1,title:"Fields","new-item":a,class:"mt-4",label:"name","label-parent":"Field","slot-name-prefix":"field"},Ae({_:2},[K(s.value.Fields,(n,u)=>({name:`field_${u}_title`,fn:l(()=>[n.Field?(c(),b($,{key:0},[g(S(n.Field.Label)+" ("+S(n.Field.Name)+") ",1),k("template",gt,[g("  ["+S(n.Field.Type)+"] ",1)])],64)):(c(),b($,{key:1},[g("New Field")],64))])})),K(s.value.Fields,(n,u)=>({name:`field_${u}`,fn:l(()=>[e(Ct,{modelValue:s.value.Fields[u],"onUpdate:modelValue":t=>s.value.Fields[u]=t,convention:m.convention,style:{margin:"0 -24px"}},null,8,["modelValue","onUpdate:modelValue","convention"])])}))]),1032,["modelValue"])):R("",!0)}}),kt=O({__name:"EditFormSections",props:P({convention:{}},{modelValue:{required:!0}}),emits:["update:modelValue"],setup(T){const s=M(T,"modelValue"),a=()=>{const m={ID:0,SectionUUID:q(),FormID:s.value.ID,FormUUID:s.value.FormUUID,Order:0,Name:"New Section",Heading:"",Description:"",Fields:[],DefaultValue:"",State:{ID:0,SectionStateUUID:q(),SectionID:0,SectionUUID:"",Edit:!0}};return m.State.SectionID=m.ID,m.State.SectionUUID=m.SectionUUID,m};return(m,i)=>(c(),y(we,{modelValue:s.value.Sections,"onUpdate:modelValue":i[0]||(i[0]=n=>s.value.Sections=n),"new-item":a,closeable:!1,title:"Sections","slot-name-prefix":"section"},Ae({_:2},[K(s.value.Sections,(n,u)=>({name:`section_${u}`,fn:l(()=>[e(F,null,{default:l(()=>[e(D,{cols:"12",sm:"6"},{default:l(()=>[e(A,{modelValue:n.Name,"onUpdate:modelValue":t=>n.Name=t,label:"Internal Name",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(D,{cols:"12",sm:"6"},{default:l(()=>[e(A,{modelValue:n.Heading,"onUpdate:modelValue":t=>n.Heading=t,label:"Section Heading",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024),e(F,null,{default:l(()=>[e(D,{cols:"12"},{default:l(()=>[e(De,{modelValue:n.Description,"onUpdate:modelValue":t=>n.Description=t,label:"Section Text",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024),n.Fields?(c(),y(bt,{key:0,modelValue:s.value.Sections[u],"onUpdate:modelValue":t=>s.value.Sections[u]=t,convention:m.convention},null,8,["modelValue","onUpdate:modelValue","convention"])):R("",!0)])}))]),1032,["modelValue"]))}}),Et=O({__name:"FormRendererPopup",props:P({admin:{type:Boolean},convention:{},form:{},title:{},cardClass:{},preview:{type:Boolean}},{modelValue:{type:Boolean,required:!0}}),emits:P(["update:form"],["update:modelValue"]),setup(T,{emit:s}){const a=T,{admin:m=!1,convention:i,title:n="",cardClass:u=""}=a,t=M(T,"modelValue"),o=fe(a,s,void 0,void 0,"form"),v=C(G(o.value));H(o,()=>{v.value=G(o.value)});const r=()=>{t.value=!1};return(d,p)=>(c(),y(Re,{modelValue:t.value,"onUpdate:modelValue":p[1]||(p[1]=f=>t.value=f),title:U(n),color:"primary","card-class":U(u)},{toolbarButtons:l(()=>[he(d.$slots,"toolbarButtons")]),actions:l(()=>[e(N,{color:"blue-darken-1",variant:"text",onClick:r},{default:l(()=>[g(" Close ")]),_:1})]),default:l(()=>[e(Je,{modelValue:v.value,"onUpdate:modelValue":p[0]||(p[0]=f=>v.value=f),admin:U(m),convention:U(i),preview:d.preview},null,8,["modelValue","admin","convention","preview"])]),_:3},8,["modelValue","title","card-class"]))}}),ht=k("template",{class:"d-none d-sm-inline"},[g("Preview")],-1),$t=O({__name:"EditFormDialog",props:P({convention:{},form:{}},{modelValue:{type:Boolean,required:!0}}),emits:P(["update:form"],["update:modelValue"]),setup(T,{emit:s}){const a=T,{convention:m}=a,i=M(T,"modelValue"),n=Y(),u=fe(a,s,void 0,void 0,"form"),t=C(!1),o=C(G(u.value));H(u,()=>{o.value=G(u.value)});const v=()=>{n.saveForm(o.value).then(d=>{d&&(u.value=d,i.value=!1)})},r=()=>{t.value=!0};return(d,p)=>(c(),y(Tt,{modelValue:i.value,"onUpdate:modelValue":p[13]||(p[13]=f=>i.value=f),item:o.value,"onUpdate:item":p[14]||(p[14]=f=>o.value=f),onSave:v,"card-class":"pa-0"},{toolbarButtons:l(()=>[e(al,null,{default:l(()=>[e(N,{"prepend-icon":"mdi:mdi-developer-board",onClick:r},{default:l(()=>[ht]),_:1})]),_:1})]),default:l(()=>[e(re,null,{default:l(()=>[e(me,{class:"mt-0"},{default:l(()=>[e(ve,null,{default:l(()=>[g("General Settings")]),_:1}),e(ce,null,{default:l(()=>[e(F,null,{default:l(()=>[e(D,{cols:"12"},{default:l(()=>[e(j,{class:"pa-0",fluid:!0},{default:l(()=>[e(F,null,{default:l(()=>[e(D,{cols:"12",sm:"6"},{default:l(()=>[e(A,{modelValue:o.value.Name,"onUpdate:modelValue":p[0]||(p[0]=f=>o.value.Name=f),label:"Internal name",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),e(D,{cols:"12",sm:"6"},{default:l(()=>[e(A,{modelValue:o.value.Heading,"onUpdate:modelValue":p[1]||(p[1]=f=>o.value.Heading=f),label:"Form Heading",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),e(D,{cols:"12"},{default:l(()=>[e(De,{modelValue:o.value.Description,"onUpdate:modelValue":p[2]||(p[2]=f=>o.value.Description=f),label:"Pre-form Text",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),e(D,{cols:"12",sm:"6"},{default:l(()=>[e(de,{modelValue:o.value.Type,"onUpdate:modelValue":p[3]||(p[3]=f=>o.value.Type=f),label:"Type",variant:"outlined",items:U(ll),"hide-details":""},null,8,["modelValue","items"])]),_:1}),e(D,{cols:"12",sm:"6"},{default:l(()=>[e(A,{modelValue:o.value.NotificationEmail,"onUpdate:modelValue":p[4]||(p[4]=f=>o.value.NotificationEmail=f),label:"Notification Email",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),e(D,{cols:"12",sm:"6",class:"d-none"},{default:l(()=>[e(A,{modelValue:o.value.State.Stage,"onUpdate:modelValue":p[5]||(p[5]=f=>o.value.State.Stage=f),modelModifiers:{number:!0},label:"Stage",variant:"outlined","hide-details":"",type:"number"},null,8,["modelValue"])]),_:1}),e(D,{cols:"6"},{default:l(()=>[e(X,{modelValue:o.value.State.New,"onUpdate:modelValue":p[6]||(p[6]=f=>o.value.State.New=f),label:"Allow New Entries"},null,8,["modelValue"])]),_:1}),e(D,{cols:"6"},{default:l(()=>[e(X,{modelValue:o.value.State.Edit,"onUpdate:modelValue":p[7]||(p[7]=f=>o.value.State.Edit=f),label:"Allow Editing Submissions"},null,8,["modelValue"])]),_:1})]),_:1}),e(F,null,{default:l(()=>[e(D,{cols:"12"},{default:l(()=>[e(le,{label:"Required Tags",variant:"outlined",modelValue:o.value.RequiredTags,"onUpdate:modelValue":p[8]||(p[8]=f=>o.value.RequiredTags=f),convention:U(m),organisation:U(m).OrganisationUUID,chips:"",clearable:"",hint:"Tags that a user must have to see this form. (Any one)"},null,8,["modelValue","convention","organisation"])]),_:1})]),_:1}),e(F,null,{default:l(()=>[e(D,{cols:"12"},{default:l(()=>[e(Oe,{label:"Required Groups",variant:"outlined",modelValue:o.value.RequiredGroupMemberships,"onUpdate:modelValue":p[9]||(p[9]=f=>o.value.RequiredGroupMemberships=f),convention:U(m),organisation:U(m).OrganisationUUID,chips:"",clearable:"",hint:"Groups that a user must be in to see this form. (Any one)"},null,8,["modelValue","convention","organisation"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),o.value?(c(),y(kt,{key:0,modelValue:o.value,"onUpdate:modelValue":p[10]||(p[10]=f=>o.value=f),convention:U(m),style:{"border-radius":"0"}},null,8,["modelValue","convention"])):R("",!0),t.value?(c(),y(Et,{key:1,modelValue:t.value,"onUpdate:modelValue":p[11]||(p[11]=f=>t.value=f),form:o.value,"onUpdate:form":p[12]||(p[12]=f=>o.value=f),admin:!0,convention:U(m),title:"Form Preview",preview:!0,"card-class":"pa-0"},null,8,["modelValue","form","convention"])):R("",!0)]),_:1},8,["modelValue","item"]))}}),Nt=(T,s)=>{const a=C(!1),m=C(!1),i=C(T),n=C(-1),u=C(s),t=C(s),o=ee(()=>n.value===-1?"New Form":"Edit Form"),v=()=>{i.value=T},r=_=>{n.value=i.value.indexOf(_),u.value=Object.assign({},_),a.value=!0},d=_=>{n.value=i.value.indexOf(_),u.value=Object.assign({},_),m.value=!0},p=()=>{m.value=!1,ye(()=>{u.value=Object.assign({},t.value),n.value=-1}).then()},f=()=>{i.value.splice(n.value,1),p()},V=()=>{a.value=!1,ye(()=>{u.value=Object.assign({},t.value),n.value=-1}).then()},I=()=>{n.value>-1?Object.assign(i.value[n.value],u.value):i.value.push(u.value),V()};return H(a,_=>{_||V()}),H(m,_=>{_||p()}),{collection:i,defaultItem:t,dialog:a,dialogDelete:m,editedItem:u,formTitle:o,reset:v,editItem:r,deleteItem:d,deleteItemConfirm:f,close:V,save:I}},Ft=O({__name:"FormEditor",props:{modelValue:{required:!0}},emits:P(["refresh"],["update:modelValue"]),setup(T){const s=M(T,"modelValue"),a=Y(),m=C([{key:"Name",title:"Form Name",align:"start",sortable:!0},{key:"Type",title:"Type",align:"start",sortable:!0},{key:"actions",title:"Actions",sortable:!1}]),i=C([]),n=C([]);a.getConventionFields(s.value.ConventionUUID).then(E=>{i.value=E}),a.getConventionForms(s.value.ConventionUUID).then(E=>{n.value=E});const u={ID:0,FormUUID:q(),ConventionID:s.value.ID,ConventionUUID:s.value.ConventionUUID,ParentID:0,ParentUUID:Ce,Name:"",Heading:"",Description:"",Type:tl.FORM_TYPE_ADDITIONAL,Sections:[],State:{ID:0,FormStateUUID:q(),FormID:0,FormUUID:Ce,New:!1,Edit:!1,Stage:0},RequiredGroupMemberships:[],RequiredTags:[],NotificationEmail:""};u.State.FormUUID=u.FormUUID;const{collection:t,defaultItem:o,dialog:v,dialogDelete:r,editedItem:d,editItem:p,deleteItem:f,deleteItemConfirm:V,save:I}=Nt(n,u);t.value.forEach(E=>{E.Sections.forEach(h=>{var L;(L=h.Fields)==null||L.forEach(B=>{B.Field=i.value.find(W=>W.ID===B.FieldID)})})});const _=E=>{a.deleteForm(E.FormUUID).then(h=>{h&&f(E)})};return(E,h)=>(c(),y(U(qe),{headers:m.value,items:U(t),"sort-by":[{key:"calories",order:"asc"}],class:"elevation-1"},{top:l(()=>[e(ne,{color:"primary"},{default:l(()=>[e(ie,null,{default:l(()=>[g("Form Editor")]),_:1}),e(Ye,{class:"mx-4",inset:!0,vertical:!0}),e(ae),e(N,{dark:"",class:"mb-2","prepend-icon":"mdi:mdi-pencil",onClick:h[0]||(h[0]=L=>{d.value=Object.assign({},U(o)),v.value=!0})},{default:l(()=>[g(" New Item ")]),_:1}),e(Ke,{modelValue:U(r),"onUpdate:modelValue":h[1]||(h[1]=L=>_e(r)?r.value=L:null),onDelete:U(V)},null,8,["modelValue","onDelete"])]),_:1}),U(v)?(c(),y($t,{key:0,modelValue:U(v),"onUpdate:modelValue":h[2]||(h[2]=L=>_e(v)?v.value=L:null),form:U(d),"onUpdate:form":[h[3]||(h[3]=L=>_e(d)?d.value=L:null),U(I)],convention:s.value},null,8,["modelValue","form","onUpdate:form","convention"])):R("",!0)]),"item.actions":l(({item:L})=>[e(z,{size:"small",class:"me-2",onClick:B=>U(p)(L.raw)},{default:l(()=>[g(" mdi:mdi-pencil ")]),_:2},1032,["onClick"]),e(z,{size:"small",onClick:B=>_(L.raw)},{default:l(()=>[g(" mdi:mdi-delete ")]),_:2},1032,["onClick"])]),_:1},8,["headers","items"]))}}),ra=O({__name:"ConventionEditorView",emits:["pageTitle","refresh"],setup(T,{emit:s}){const a=Be(),m=Y(),n=C({ID:0,ConventionUUID:Ce,Accommodation:[],Description:"",DetailLink:"",Extras:[],Interests:[],Logo:"",Name:"",OrganisationID:0,OrganisationUUID:"",Slug:"",Tickets:[],Visible:!1}),u=C();H(u,()=>{o.value.find(r=>r.id===u.value&&r.title==="General")&&t()});const t=()=>{m.getConvention(a.params.convention.toString()).then(v=>{v?(n.value=v,s("pageTitle",`Convention Editor - ${n.value.Name}`)):s("pageTitle","Convention Editor - New Convention")})},o=C([{id:q(),title:"Accommodation",component:ue(et),model:n},{id:q(),title:"Additional Purchases",component:ue(rl),model:n},{id:q(),title:"Fields",component:ue(Vt),model:n},{id:q(),title:"Forms",component:ue(Ft),model:n},{id:q(),title:"Interests",component:ue(fl),model:n},{id:q(),title:"Tickets",component:ue(Nl),model:n},{id:q(),title:"Venues",component:ue(Kl),model:n}]);return s("pageTitle","Convention Editor"),t(),(v,r)=>n.value&&n.value.ConventionUUID!==U(Ce)?(c(),b($,{key:0},[e(ne,{color:"blue-darken-4"},{default:l(()=>[e(Xe,{modelValue:u.value,"onUpdate:modelValue":r[0]||(r[0]=d=>u.value=d),"show-arrows":""},{default:l(()=>[(c(!0),b($,null,K(o.value,d=>(c(),y(We,{key:d.id,value:d.id},{default:l(()=>[g(S(d.title),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(Ze,{modelValue:u.value,"onUpdate:modelValue":r[1]||(r[1]=d=>u.value=d),disabled:!0},{default:l(()=>[(c(!0),b($,null,K(o.value,d=>(c(),y(Qe,{key:d.id,value:d.id},{default:l(()=>[d.id===u.value?(c(),y(pe,{key:0,class:"pa-2"},{default:l(()=>[(c(),y(je(d.component),{modelValue:d.model,"onUpdate:modelValue":p=>d.model=p},null,8,["modelValue","onUpdate:modelValue"]))]),_:2},1024)):R("",!0)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])],64)):R("",!0)}});export{ra as default};
